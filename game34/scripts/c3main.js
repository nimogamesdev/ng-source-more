import "./../csv-parse-sync.js";
import "./../csv-stringify-sync.js";
import "./../box2d.wasm.js";
// Generated by Construct, the game and animation creation tool
// Visit: https://www.construct.net

var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__require=(e=>"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(e,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):e)((function(e){if("undefined"!=typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')})),__commonJS=(e,t)=>function(){return t||(0,e[__getOwnPropNames(e)[0]])((t={exports:{}}).exports,t),t.exports},__copyProps=(e,t,s,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of __getOwnPropNames(t))__hasOwnProp.call(e,i)||i===s||__defProp(e,i,{get:()=>t[i],enumerable:!(n=__getOwnPropDesc(t,i))||n.enumerable});return e},__toESM=(e,t,s)=>(s=null!=e?__create(__getProtoOf(e)):{},__copyProps(!t&&e&&e.__esModule?s:__defProp(s,"default",{value:e,enumerable:!0}),e)),require_c3runtime=__commonJS({"file-map:scripts/c3runtime.js"(exports,module){{let e=function(e){ARRAY_TYPE=e},n=function(e){return e*degree},h=function(e,t){return Math.abs(e-t)<=EPSILON*Math.max(1,Math.abs(e),Math.abs(t))},_=function(){var e=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},u=function(e){var t=new ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},p=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},m=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},g=function(e,t,s,n){var i=new ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=s,i[3]=n,i},I=function(e,t,s,n,i){return e[0]=t,e[1]=s,e[2]=n,e[3]=i,e},S=function(e,t){if(e===t){var s=t[1];e[1]=t[2],e[2]=s}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},y=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=s*r-i*n;return a?(a=1/a,e[0]=r*a,e[1]=-n*a,e[2]=-i*a,e[3]=s*a,e):null},b=function(e,t){var s=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=s,e},G=function(e){return e[0]*e[3]-e[2]*e[1]},v=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=s[0],l=s[1],c=s[2],h=s[3];return e[0]=n*o+r*l,e[1]=i*o+a*l,e[2]=n*c+r*h,e[3]=i*c+a*h,e},x=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=Math.sin(s),l=Math.cos(s);return e[0]=n*l+r*o,e[1]=i*l+a*o,e[2]=n*-o+r*l,e[3]=i*-o+a*l,e},T=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=s[0],l=s[1];return e[0]=n*o,e[1]=i*o,e[2]=r*l,e[3]=a*l,e},C=function(e,t){var s=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=s,e[2]=-s,e[3]=n,e},w=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},P=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},A=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},R=function(e,t,s,n){return e[2]=n[2]/n[0],s[0]=n[0],s[1]=n[1],s[3]=n[3]-e[2]*s[1],[e,t,s]},D=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e},E=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e},M=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},k=function(e,t){var s=e[0],n=e[1],i=e[2],r=e[3],a=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(s-a)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(a))&&Math.abs(n-o)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-l)<=EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(r-c)<=EPSILON*Math.max(1,Math.abs(r),Math.abs(c))},L=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e},F=function(e,t,s,n){return e[0]=t[0]+s[0]*n,e[1]=t[1]+s[1]*n,e[2]=t[2]+s[2]*n,e[3]=t[3]+s[3]*n,e},B=function(){var e=new ARRAY_TYPE(6);return ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},O=function(e){var t=new ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},N=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},W=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},V=function(e,t,s,n,i,r){var a=new ARRAY_TYPE(6);return a[0]=e,a[1]=t,a[2]=s,a[3]=n,a[4]=i,a[5]=r,a},j=function(e,t,s,n,i,r,a){return e[0]=t,e[1]=s,e[2]=n,e[3]=i,e[4]=r,e[5]=a,e},U=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],l=s*r-n*i;return l?(l=1/l,e[0]=r*l,e[1]=-n*l,e[2]=-i*l,e[3]=s*l,e[4]=(i*o-r*a)*l,e[5]=(n*a-s*o)*l,e):null},H=function(e){return e[0]*e[3]-e[1]*e[2]},z=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=s[0],h=s[1],_=s[2],u=s[3],d=s[4],p=s[5];return e[0]=n*c+r*h,e[1]=i*c+a*h,e[2]=n*_+r*u,e[3]=i*_+a*u,e[4]=n*d+r*p+o,e[5]=i*d+a*p+l,e},X=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=Math.sin(s),h=Math.cos(s);return e[0]=n*h+r*c,e[1]=i*h+a*c,e[2]=n*-c+r*h,e[3]=i*-c+a*h,e[4]=o,e[5]=l,e},Y=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=s[0],h=s[1];return e[0]=n*c,e[1]=i*c,e[2]=r*h,e[3]=a*h,e[4]=o,e[5]=l,e},q=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=s[0],h=s[1];return e[0]=n,e[1]=i,e[2]=r,e[3]=a,e[4]=n*c+r*h+o,e[5]=i*c+a*h+l,e},J=function(e,t){var s=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=s,e[2]=-s,e[3]=n,e[4]=0,e[5]=0,e},K=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},$=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},Z=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},Q=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},ee=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e},te=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e[4]=t[4]-s[4],e[5]=t[5]-s[5],e},se=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*s,e[5]=t[5]*s,e},ne=function(e,t,s,n){return e[0]=t[0]+s[0]*n,e[1]=t[1]+s[1]*n,e[2]=t[2]+s[2]*n,e[3]=t[3]+s[3]*n,e[4]=t[4]+s[4]*n,e[5]=t[5]+s[5]*n,e},ie=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},re=function(e,t){var s=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],l=t[0],c=t[1],h=t[2],_=t[3],u=t[4],d=t[5];return Math.abs(s-l)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(n-c)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-h)<=EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(r-_)<=EPSILON*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(a-u)<=EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(o-d)<=EPSILON*Math.max(1,Math.abs(o),Math.abs(d))},ae=function(){var e=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},oe=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},le=function(e){var t=new ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},ce=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},he=function(e,t,s,n,i,r,a,o,l){var c=new ARRAY_TYPE(9);return c[0]=e,c[1]=t,c[2]=s,c[3]=n,c[4]=i,c[5]=r,c[6]=a,c[7]=o,c[8]=l,c},_e=function(e,t,s,n,i,r,a,o,l,c){return e[0]=t,e[1]=s,e[2]=n,e[3]=i,e[4]=r,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e},ue=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},de=function(e,t){if(e===t){var s=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=s,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},pe=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],_=h*a-o*c,u=-h*r+o*l,d=c*r-a*l,p=s*_+n*u+i*d;return p?(p=1/p,e[0]=_*p,e[1]=(-h*n+i*c)*p,e[2]=(o*n-i*a)*p,e[3]=u*p,e[4]=(h*s-i*l)*p,e[5]=(-o*s+i*r)*p,e[6]=d*p,e[7]=(-c*s+n*l)*p,e[8]=(a*s-n*r)*p,e):null},fe=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8];return e[0]=a*h-o*c,e[1]=i*c-n*h,e[2]=n*o-i*a,e[3]=o*l-r*h,e[4]=s*h-i*l,e[5]=i*r-s*o,e[6]=r*c-a*l,e[7]=n*l-s*c,e[8]=s*a-n*r,e},me=function(e){var t=e[0],s=e[1],n=e[2],i=e[3],r=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*(c*r-a*l)+s*(-c*i+a*o)+n*(l*i-r*o)},ge=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=t[8],u=s[0],d=s[1],p=s[2],f=s[3],m=s[4],g=s[5],I=s[6],S=s[7],y=s[8];return e[0]=u*n+d*a+p*c,e[1]=u*i+d*o+p*h,e[2]=u*r+d*l+p*_,e[3]=f*n+m*a+g*c,e[4]=f*i+m*o+g*h,e[5]=f*r+m*l+g*_,e[6]=I*n+S*a+y*c,e[7]=I*i+S*o+y*h,e[8]=I*r+S*l+y*_,e},Ie=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=t[8],u=s[0],d=s[1];return e[0]=n,e[1]=i,e[2]=r,e[3]=a,e[4]=o,e[5]=l,e[6]=u*n+d*a+c,e[7]=u*i+d*o+h,e[8]=u*r+d*l+_,e},Se=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=t[8],u=Math.sin(s),d=Math.cos(s);return e[0]=d*n+u*a,e[1]=d*i+u*o,e[2]=d*r+u*l,e[3]=d*a-u*n,e[4]=d*o-u*i,e[5]=d*l-u*r,e[6]=c,e[7]=h,e[8]=_,e},ye=function(e,t,s){var n=s[0],i=s[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},be=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},Ge=function(e,t){var s=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=s,e[2]=0,e[3]=-s,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},ve=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},xe=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},Te=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=s+s,o=n+n,l=i+i,c=s*a,h=n*a,_=n*o,u=i*a,d=i*o,p=i*l,f=r*a,m=r*o,g=r*l;return e[0]=1-_-p,e[3]=h-g,e[6]=u+m,e[1]=h+g,e[4]=1-c-p,e[7]=d-f,e[2]=u-m,e[5]=d+f,e[8]=1-c-_,e},Ce=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],_=t[9],u=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],I=s*o-n*a,S=s*l-i*a,y=s*c-r*a,b=n*l-i*o,G=n*c-r*o,v=i*c-r*l,x=h*f-_*p,T=h*m-u*p,C=h*g-d*p,w=_*m-u*f,P=_*g-d*f,A=u*g-d*m,R=I*A-S*P+y*w+b*C-G*T+v*x;return R?(R=1/R,e[0]=(o*A-l*P+c*w)*R,e[1]=(l*C-a*A-c*T)*R,e[2]=(a*P-o*C+c*x)*R,e[3]=(i*P-n*A-r*w)*R,e[4]=(s*A-i*C+r*T)*R,e[5]=(n*C-s*P-r*x)*R,e[6]=(f*v-m*G+g*b)*R,e[7]=(m*y-p*v-g*S)*R,e[8]=(p*G-f*y+g*I)*R,e):null},we=function(e,t,s){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/s,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},Pe=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},Ae=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Re=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e[6]=t[6]+s[6],e[7]=t[7]+s[7],e[8]=t[8]+s[8],e},De=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e[4]=t[4]-s[4],e[5]=t[5]-s[5],e[6]=t[6]-s[6],e[7]=t[7]-s[7],e[8]=t[8]-s[8],e},Ee=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*s,e},Me=function(e,t,s,n){return e[0]=t[0]+s[0]*n,e[1]=t[1]+s[1]*n,e[2]=t[2]+s[2]*n,e[3]=t[3]+s[3]*n,e[4]=t[4]+s[4]*n,e[5]=t[5]+s[5]*n,e[6]=t[6]+s[6]*n,e[7]=t[7]+s[7]*n,e[8]=t[8]+s[8]*n,e},ke=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},Le=function(e,t){var s=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],_=t[0],u=t[1],d=t[2],p=t[3],f=t[4],m=t[5],g=t[6],I=t[7],S=t[8];return Math.abs(s-_)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(n-u)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-d)<=EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(r-p)<=EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(a-f)<=EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(o-m)<=EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-g)<=EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(c-I)<=EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-S)<=EPSILON*Math.max(1,Math.abs(h),Math.abs(S))},Fe=function(){var e=new ARRAY_TYPE(16);return ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},Be=function(e){var t=new ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Oe=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Ne=function(e,t,s,n,i,r,a,o,l,c,h,_,u,d,p,f){var m=new ARRAY_TYPE(16);return m[0]=e,m[1]=t,m[2]=s,m[3]=n,m[4]=i,m[5]=r,m[6]=a,m[7]=o,m[8]=l,m[9]=c,m[10]=h,m[11]=_,m[12]=u,m[13]=d,m[14]=p,m[15]=f,m},We=function(e,t,s,n,i,r,a,o,l,c,h,_,u,d,p,f,m){return e[0]=t,e[1]=s,e[2]=n,e[3]=i,e[4]=r,e[5]=a,e[6]=o,e[7]=l,e[8]=c,e[9]=h,e[10]=_,e[11]=u,e[12]=d,e[13]=p,e[14]=f,e[15]=m,e},Ve=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},je=function(e,t){if(e===t){var s=t[1],n=t[2],i=t[3],r=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=s,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=r,e[11]=t[14],e[12]=i,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},Ue=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],_=t[9],u=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],I=s*o-n*a,S=s*l-i*a,y=s*c-r*a,b=n*l-i*o,G=n*c-r*o,v=i*c-r*l,x=h*f-_*p,T=h*m-u*p,C=h*g-d*p,w=_*m-u*f,P=_*g-d*f,A=u*g-d*m,R=I*A-S*P+y*w+b*C-G*T+v*x;return R?(R=1/R,e[0]=(o*A-l*P+c*w)*R,e[1]=(i*P-n*A-r*w)*R,e[2]=(f*v-m*G+g*b)*R,e[3]=(u*G-_*v-d*b)*R,e[4]=(l*C-a*A-c*T)*R,e[5]=(s*A-i*C+r*T)*R,e[6]=(m*y-p*v-g*S)*R,e[7]=(h*v-u*y+d*S)*R,e[8]=(a*P-o*C+c*x)*R,e[9]=(n*C-s*P-r*x)*R,e[10]=(p*G-f*y+g*I)*R,e[11]=(_*y-h*G-d*I)*R,e[12]=(o*T-a*w-l*x)*R,e[13]=(s*w-n*T+i*x)*R,e[14]=(f*S-p*b-m*I)*R,e[15]=(h*b-_*S+u*I)*R,e):null},He=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],l=t[6],c=t[7],h=t[8],_=t[9],u=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],I=s*o-n*a,S=s*l-i*a,y=s*c-r*a,b=n*l-i*o,G=n*c-r*o,v=i*c-r*l,x=h*f-_*p,T=h*m-u*p,C=h*g-d*p,w=_*m-u*f,P=_*g-d*f,A=u*g-d*m;return e[0]=o*A-l*P+c*w,e[1]=i*P-n*A-r*w,e[2]=f*v-m*G+g*b,e[3]=u*G-_*v-d*b,e[4]=l*C-a*A-c*T,e[5]=s*A-i*C+r*T,e[6]=m*y-p*v-g*S,e[7]=h*v-u*y+d*S,e[8]=a*P-o*C+c*x,e[9]=n*C-s*P-r*x,e[10]=p*G-f*y+g*I,e[11]=_*y-h*G-d*I,e[12]=o*T-a*w-l*x,e[13]=s*w-n*T+i*x,e[14]=f*S-p*b-m*I,e[15]=h*b-_*S+u*I,e},ze=function(e){var t=e[0],s=e[1],n=e[2],i=e[3],r=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[9],_=e[10],u=e[11],d=e[12],p=e[13],f=e[14],m=t*a-s*r,g=t*o-n*r,I=s*o-n*a,S=c*p-h*d,y=c*f-_*d,b=h*f-_*p;return l*(t*b-s*y+n*S)-i*(r*b-a*y+o*S)+e[15]*(c*I-h*g+_*m)-u*(d*I-p*g+f*m)},Xe=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=t[8],u=t[9],d=t[10],p=t[11],f=t[12],m=t[13],g=t[14],I=t[15],S=s[0],y=s[1],b=s[2],G=s[3];return e[0]=S*n+y*o+b*_+G*f,e[1]=S*i+y*l+b*u+G*m,e[2]=S*r+y*c+b*d+G*g,e[3]=S*a+y*h+b*p+G*I,S=s[4],y=s[5],b=s[6],G=s[7],e[4]=S*n+y*o+b*_+G*f,e[5]=S*i+y*l+b*u+G*m,e[6]=S*r+y*c+b*d+G*g,e[7]=S*a+y*h+b*p+G*I,S=s[8],y=s[9],b=s[10],G=s[11],e[8]=S*n+y*o+b*_+G*f,e[9]=S*i+y*l+b*u+G*m,e[10]=S*r+y*c+b*d+G*g,e[11]=S*a+y*h+b*p+G*I,S=s[12],y=s[13],b=s[14],G=s[15],e[12]=S*n+y*o+b*_+G*f,e[13]=S*i+y*l+b*u+G*m,e[14]=S*r+y*c+b*d+G*g,e[15]=S*a+y*h+b*p+G*I,e},Ye=function(e,t,s){var n,i,r,a,o,l,c,h,_,u,d,p,f=s[0],m=s[1],g=s[2];return t===e?(e[12]=t[0]*f+t[4]*m+t[8]*g+t[12],e[13]=t[1]*f+t[5]*m+t[9]*g+t[13],e[14]=t[2]*f+t[6]*m+t[10]*g+t[14],e[15]=t[3]*f+t[7]*m+t[11]*g+t[15]):(n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=t[8],u=t[9],d=t[10],p=t[11],e[0]=n,e[1]=i,e[2]=r,e[3]=a,e[4]=o,e[5]=l,e[6]=c,e[7]=h,e[8]=_,e[9]=u,e[10]=d,e[11]=p,e[12]=n*f+o*m+_*g+t[12],e[13]=i*f+l*m+u*g+t[13],e[14]=r*f+c*m+d*g+t[14],e[15]=a*f+h*m+p*g+t[15]),e},qe=function(e,t,s){var n=s[0],i=s[1],r=s[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Je=function(e,t,s,n){var i,r,a,o,l,c,h,_,u,d,p,f,m,g,I,S,y,b,G,v,x,T,C,w,P=n[0],A=n[1],R=n[2],D=Math.hypot(P,A,R);return D<EPSILON?null:(P*=D=1/D,A*=D,R*=D,i=Math.sin(s),a=1-(r=Math.cos(s)),o=t[0],l=t[1],c=t[2],h=t[3],_=t[4],u=t[5],d=t[6],p=t[7],f=t[8],m=t[9],g=t[10],I=t[11],S=P*P*a+r,y=A*P*a+R*i,b=R*P*a-A*i,G=P*A*a-R*i,v=A*A*a+r,x=R*A*a+P*i,T=P*R*a+A*i,C=A*R*a-P*i,w=R*R*a+r,e[0]=o*S+_*y+f*b,e[1]=l*S+u*y+m*b,e[2]=c*S+d*y+g*b,e[3]=h*S+p*y+I*b,e[4]=o*G+_*v+f*x,e[5]=l*G+u*v+m*x,e[6]=c*G+d*v+g*x,e[7]=h*G+p*v+I*x,e[8]=o*T+_*C+f*w,e[9]=l*T+u*C+m*w,e[10]=c*T+d*C+g*w,e[11]=h*T+p*C+I*w,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},Ke=function(e,t,s){var n=Math.sin(s),i=Math.cos(s),r=t[4],a=t[5],o=t[6],l=t[7],c=t[8],h=t[9],_=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=r*i+c*n,e[5]=a*i+h*n,e[6]=o*i+_*n,e[7]=l*i+u*n,e[8]=c*i-r*n,e[9]=h*i-a*n,e[10]=_*i-o*n,e[11]=u*i-l*n,e},$e=function(e,t,s){var n=Math.sin(s),i=Math.cos(s),r=t[0],a=t[1],o=t[2],l=t[3],c=t[8],h=t[9],_=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i-c*n,e[1]=a*i-h*n,e[2]=o*i-_*n,e[3]=l*i-u*n,e[8]=r*n+c*i,e[9]=a*n+h*i,e[10]=o*n+_*i,e[11]=l*n+u*i,e},Ze=function(e,t,s){var n=Math.sin(s),i=Math.cos(s),r=t[0],a=t[1],o=t[2],l=t[3],c=t[4],h=t[5],_=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=r*i+c*n,e[1]=a*i+h*n,e[2]=o*i+_*n,e[3]=l*i+u*n,e[4]=c*i-r*n,e[5]=h*i-a*n,e[6]=_*i-o*n,e[7]=u*i-l*n,e},Qe=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},et=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},tt=function(e,t,s){var n,i,r,a=s[0],o=s[1],l=s[2],c=Math.hypot(a,o,l);return c<EPSILON?null:(a*=c=1/c,o*=c,l*=c,n=Math.sin(t),r=1-(i=Math.cos(t)),e[0]=a*a*r+i,e[1]=o*a*r+l*n,e[2]=l*a*r-o*n,e[3]=0,e[4]=a*o*r-l*n,e[5]=o*o*r+i,e[6]=l*o*r+a*n,e[7]=0,e[8]=a*l*r+o*n,e[9]=o*l*r-a*n,e[10]=l*l*r+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},st=function(e,t){var s=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=s,e[7]=0,e[8]=0,e[9]=-s,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},nt=function(e,t){var s=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-s,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=s,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},it=function(e,t){var s=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=s,e[2]=0,e[3]=0,e[4]=-s,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rt=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=n+n,l=i+i,c=r+r,h=n*o,_=n*l,u=n*c,d=i*l,p=i*c,f=r*c,m=a*o,g=a*l,I=a*c;return e[0]=1-(d+f),e[1]=_+I,e[2]=u-g,e[3]=0,e[4]=_-I,e[5]=1-(h+f),e[6]=p+m,e[7]=0,e[8]=u+g,e[9]=p-m,e[10]=1-(h+d),e[11]=0,e[12]=s[0],e[13]=s[1],e[14]=s[2],e[15]=1,e},at=function(e,t){var s=new ARRAY_TYPE(3),n=-t[0],i=-t[1],r=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=n*n+i*i+r*r+a*a;return _>0?(s[0]=2*(o*a+h*n+l*r-c*i)/_,s[1]=2*(l*a+h*i+c*n-o*r)/_,s[2]=2*(c*a+h*r+o*i-l*n)/_):(s[0]=2*(o*a+h*n+l*r-c*i),s[1]=2*(l*a+h*i+c*n-o*r),s[2]=2*(c*a+h*r+o*i-l*n)),rt(e,t,s),e},ot=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},lt=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[4],a=t[5],o=t[6],l=t[8],c=t[9],h=t[10];return e[0]=Math.hypot(s,n,i),e[1]=Math.hypot(r,a,o),e[2]=Math.hypot(l,c,h),e},ct=function(e,t){var s=new ARRAY_TYPE(3);lt(s,t);var n=1/s[0],i=1/s[1],r=1/s[2],a=t[0]*n,o=t[1]*i,l=t[2]*r,c=t[4]*n,h=t[5]*i,_=t[6]*r,u=t[8]*n,d=t[9]*i,p=t[10]*r,f=a+h+p,m=0;return f>0?(m=2*Math.sqrt(f+1),e[3]=.25*m,e[0]=(_-d)/m,e[1]=(u-l)/m,e[2]=(o-c)/m):a>h&&a>p?(m=2*Math.sqrt(1+a-h-p),e[3]=(_-d)/m,e[0]=.25*m,e[1]=(o+c)/m,e[2]=(u+l)/m):h>p?(m=2*Math.sqrt(1+h-a-p),e[3]=(u-l)/m,e[0]=(o+c)/m,e[1]=.25*m,e[2]=(_+d)/m):(m=2*Math.sqrt(1+p-a-h),e[3]=(o-c)/m,e[0]=(u+l)/m,e[1]=(_+d)/m,e[2]=.25*m),e},ht=function(e,t,s,n){t[0]=n[12],t[1]=n[13],t[2]=n[14];var i=n[0],r=n[1],a=n[2],o=n[4],l=n[5],c=n[6],h=n[8],_=n[9],u=n[10];s[0]=Math.hypot(i,r,a),s[1]=Math.hypot(o,l,c),s[2]=Math.hypot(h,_,u);var d=1/s[0],p=1/s[1],f=1/s[2],m=i*d,g=r*p,I=a*f,S=o*d,y=l*p,b=c*f,G=h*d,v=_*p,x=u*f,T=m+y+x,C=0;return T>0?(C=2*Math.sqrt(T+1),e[3]=.25*C,e[0]=(b-v)/C,e[1]=(G-I)/C,e[2]=(g-S)/C):m>y&&m>x?(C=2*Math.sqrt(1+m-y-x),e[3]=(b-v)/C,e[0]=.25*C,e[1]=(g+S)/C,e[2]=(G+I)/C):y>x?(C=2*Math.sqrt(1+y-m-x),e[3]=(G-I)/C,e[0]=(g+S)/C,e[1]=.25*C,e[2]=(b+v)/C):(C=2*Math.sqrt(1+x-m-y),e[3]=(g-S)/C,e[0]=(G+I)/C,e[1]=(b+v)/C,e[2]=.25*C),e},_t=function(e,t,s,n){var i=t[0],r=t[1],a=t[2],o=t[3],l=i+i,c=r+r,h=a+a,_=i*l,u=i*c,d=i*h,p=r*c,f=r*h,m=a*h,g=o*l,I=o*c,S=o*h,y=n[0],b=n[1],G=n[2];return e[0]=(1-(p+m))*y,e[1]=(u+S)*y,e[2]=(d-I)*y,e[3]=0,e[4]=(u-S)*b,e[5]=(1-(_+m))*b,e[6]=(f+g)*b,e[7]=0,e[8]=(d+I)*G,e[9]=(f-g)*G,e[10]=(1-(_+p))*G,e[11]=0,e[12]=s[0],e[13]=s[1],e[14]=s[2],e[15]=1,e},ut=function(e,t,s,n,i){var r=t[0],a=t[1],o=t[2],l=t[3],c=r+r,h=a+a,_=o+o,u=r*c,d=r*h,p=r*_,f=a*h,m=a*_,g=o*_,I=l*c,S=l*h,y=l*_,b=n[0],G=n[1],v=n[2],x=i[0],T=i[1],C=i[2],w=(1-(f+g))*b,P=(d+y)*b,A=(p-S)*b,R=(d-y)*G,D=(1-(u+g))*G,E=(m+I)*G,M=(p+S)*v,k=(m-I)*v,L=(1-(u+f))*v;return e[0]=w,e[1]=P,e[2]=A,e[3]=0,e[4]=R,e[5]=D,e[6]=E,e[7]=0,e[8]=M,e[9]=k,e[10]=L,e[11]=0,e[12]=s[0]+x-(w*x+R*T+M*C),e[13]=s[1]+T-(P*x+D*T+k*C),e[14]=s[2]+C-(A*x+E*T+L*C),e[15]=1,e},dt=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=s+s,o=n+n,l=i+i,c=s*a,h=n*a,_=n*o,u=i*a,d=i*o,p=i*l,f=r*a,m=r*o,g=r*l;return e[0]=1-_-p,e[1]=h+g,e[2]=u-m,e[3]=0,e[4]=h-g,e[5]=1-c-p,e[6]=d+f,e[7]=0,e[8]=u+m,e[9]=d-f,e[10]=1-c-_,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},pt=function(e,t,s,n,i,r,a){var o=1/(s-t),l=1/(i-n),c=1/(r-a);return e[0]=2*r*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*r*l,e[6]=0,e[7]=0,e[8]=(s+t)*o,e[9]=(i+n)*l,e[10]=(a+r)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*r*2*c,e[15]=0,e},ft=function(e,t,s,n,i){var r=1/Math.tan(t/2);if(e[0]=r/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0){var a=1/(n-i);e[10]=(i+n)*a,e[14]=2*i*n*a}else e[10]=-1,e[14]=-2*n;return e},mt=function(e,t,s,n,i){var r=1/Math.tan(t/2);if(e[0]=r/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0){var a=1/(n-i);e[10]=i*a,e[14]=i*n*a}else e[10]=-1,e[14]=-n;return e},gt=function(e,t,s,n){var i=Math.tan(t.upDegrees*Math.PI/180),r=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),o=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+o),c=2/(i+r);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-o)*l*.5,e[9]=(i-r)*c*.5,e[10]=n/(s-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*s/(s-n),e[15]=0,e},It=function(e,t,s,n,i,r,a){var o=1/(t-s),l=1/(n-i),c=1/(r-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+s)*o,e[13]=(i+n)*l,e[14]=(a+r)*c,e[15]=1,e},St=function(e,t,s,n,i,r,a){var o=1/(t-s),l=1/(n-i),c=1/(r-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=c,e[11]=0,e[12]=(t+s)*o,e[13]=(i+n)*l,e[14]=r*c,e[15]=1,e},yt=function(e,t,s,n){var i,r,a,o,l,c,h,_,u,d,p=t[0],f=t[1],m=t[2],g=n[0],I=n[1],S=n[2],y=s[0],b=s[1],G=s[2];return Math.abs(p-y)<EPSILON&&Math.abs(f-b)<EPSILON&&Math.abs(m-G)<EPSILON?Ve(e):(h=p-y,_=f-b,u=m-G,i=I*(u*=d=1/Math.hypot(h,_,u))-S*(_*=d),r=S*(h*=d)-g*u,a=g*_-I*h,(d=Math.hypot(i,r,a))?(i*=d=1/d,r*=d,a*=d):(i=0,r=0,a=0),o=_*a-u*r,l=u*i-h*a,c=h*r-_*i,(d=Math.hypot(o,l,c))?(o*=d=1/d,l*=d,c*=d):(o=0,l=0,c=0),e[0]=i,e[1]=o,e[2]=h,e[3]=0,e[4]=r,e[5]=l,e[6]=_,e[7]=0,e[8]=a,e[9]=c,e[10]=u,e[11]=0,e[12]=-(i*p+r*f+a*m),e[13]=-(o*p+l*f+c*m),e[14]=-(h*p+_*f+u*m),e[15]=1,e)},bt=function(e,t,s,n){var i=t[0],r=t[1],a=t[2],o=n[0],l=n[1],c=n[2],h=i-s[0],_=r-s[1],u=a-s[2],d=h*h+_*_+u*u;d>0&&(h*=d=1/Math.sqrt(d),_*=d,u*=d);var p=l*u-c*_,f=c*h-o*u,m=o*_-l*h;return(d=p*p+f*f+m*m)>0&&(p*=d=1/Math.sqrt(d),f*=d,m*=d),e[0]=p,e[1]=f,e[2]=m,e[3]=0,e[4]=_*m-u*f,e[5]=u*p-h*m,e[6]=h*f-_*p,e[7]=0,e[8]=h,e[9]=_,e[10]=u,e[11]=0,e[12]=i,e[13]=r,e[14]=a,e[15]=1,e},Gt=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},vt=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},xt=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e[6]=t[6]+s[6],e[7]=t[7]+s[7],e[8]=t[8]+s[8],e[9]=t[9]+s[9],e[10]=t[10]+s[10],e[11]=t[11]+s[11],e[12]=t[12]+s[12],e[13]=t[13]+s[13],e[14]=t[14]+s[14],e[15]=t[15]+s[15],e},Tt=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e[4]=t[4]-s[4],e[5]=t[5]-s[5],e[6]=t[6]-s[6],e[7]=t[7]-s[7],e[8]=t[8]-s[8],e[9]=t[9]-s[9],e[10]=t[10]-s[10],e[11]=t[11]-s[11],e[12]=t[12]-s[12],e[13]=t[13]-s[13],e[14]=t[14]-s[14],e[15]=t[15]-s[15],e},Ct=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12]*s,e[13]=t[13]*s,e[14]=t[14]*s,e[15]=t[15]*s,e},wt=function(e,t,s,n){return e[0]=t[0]+s[0]*n,e[1]=t[1]+s[1]*n,e[2]=t[2]+s[2]*n,e[3]=t[3]+s[3]*n,e[4]=t[4]+s[4]*n,e[5]=t[5]+s[5]*n,e[6]=t[6]+s[6]*n,e[7]=t[7]+s[7]*n,e[8]=t[8]+s[8]*n,e[9]=t[9]+s[9]*n,e[10]=t[10]+s[10]*n,e[11]=t[11]+s[11]*n,e[12]=t[12]+s[12]*n,e[13]=t[13]+s[13]*n,e[14]=t[14]+s[14]*n,e[15]=t[15]+s[15]*n,e},Pt=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},At=function(e,t){var s=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=e[8],_=e[9],u=e[10],d=e[11],p=e[12],f=e[13],m=e[14],g=e[15],I=t[0],S=t[1],y=t[2],b=t[3],G=t[4],v=t[5],x=t[6],T=t[7],C=t[8],w=t[9],P=t[10],A=t[11],R=t[12],D=t[13],E=t[14],M=t[15];return Math.abs(s-I)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(n-S)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(S))&&Math.abs(i-y)<=EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(r-b)<=EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(a-G)<=EPSILON*Math.max(1,Math.abs(a),Math.abs(G))&&Math.abs(o-v)<=EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(l-x)<=EPSILON*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(c-T)<=EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(h-C)<=EPSILON*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(_-w)<=EPSILON*Math.max(1,Math.abs(_),Math.abs(w))&&Math.abs(u-P)<=EPSILON*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(d-A)<=EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(p-R)<=EPSILON*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(f-D)<=EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(m-E)<=EPSILON*Math.max(1,Math.abs(m),Math.abs(E))&&Math.abs(g-M)<=EPSILON*Math.max(1,Math.abs(g),Math.abs(M))},Rt=function(){var e=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e},Dt=function(e){var t=new ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},Et=function(e){var t=e[0],s=e[1],n=e[2];return Math.hypot(t,s,n)},Mt=function(e,t,s){var n=new ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=s,n},kt=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},Lt=function(e,t,s,n){return e[0]=t,e[1]=s,e[2]=n,e},Ft=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e},Bt=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e},Ot=function(e,t,s){return e[0]=t[0]*s[0],e[1]=t[1]*s[1],e[2]=t[2]*s[2],e},Nt=function(e,t,s){return e[0]=t[0]/s[0],e[1]=t[1]/s[1],e[2]=t[2]/s[2],e},Wt=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},Vt=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},jt=function(e,t,s){return e[0]=Math.min(t[0],s[0]),e[1]=Math.min(t[1],s[1]),e[2]=Math.min(t[2],s[2]),e},Ut=function(e,t,s){return e[0]=Math.max(t[0],s[0]),e[1]=Math.max(t[1],s[1]),e[2]=Math.max(t[2],s[2]),e},Ht=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},zt=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e},Xt=function(e,t,s,n){return e[0]=t[0]+s[0]*n,e[1]=t[1]+s[1]*n,e[2]=t[2]+s[2]*n,e},Yt=function(e,t){var s=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(s,n,i)},qt=function(e,t){var s=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return s*s+n*n+i*i},Jt=function(e){var t=e[0],s=e[1],n=e[2];return t*t+s*s+n*n},Kt=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},$t=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},Zt=function(e,t){var s=t[0],n=t[1],i=t[2],r=s*s+n*n+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},Qt=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},es=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=s[0],o=s[1],l=s[2];return e[0]=i*l-r*o,e[1]=r*a-n*l,e[2]=n*o-i*a,e},ts=function(e,t,s,n){var i=t[0],r=t[1],a=t[2];return e[0]=i+n*(s[0]-i),e[1]=r+n*(s[1]-r),e[2]=a+n*(s[2]-a),e},ss=function(e,t,s,n){var i=Math.acos(Math.min(Math.max(Qt(t,s),-1),1)),r=Math.sin(i),a=Math.sin((1-n)*i)/r,o=Math.sin(n*i)/r;return e[0]=a*t[0]+o*s[0],e[1]=a*t[1]+o*s[1],e[2]=a*t[2]+o*s[2],e},ns=function(e,t,s,n,i,r){var a=r*r,o=a*(2*r-3)+1,l=a*(r-2)+r,c=a*(r-1),h=a*(3-2*r);return e[0]=t[0]*o+s[0]*l+n[0]*c+i[0]*h,e[1]=t[1]*o+s[1]*l+n[1]*c+i[1]*h,e[2]=t[2]*o+s[2]*l+n[2]*c+i[2]*h,e},is=function(e,t,s,n,i,r){var a=1-r,o=a*a,l=r*r,c=o*a,h=3*r*o,_=3*l*a,u=l*r;return e[0]=t[0]*c+s[0]*h+n[0]*_+i[0]*u,e[1]=t[1]*c+s[1]*h+n[1]*_+i[1]*u,e[2]=t[2]*c+s[2]*h+n[2]*_+i[2]*u,e},rs=function(e,t){t=t||1;var s=2*RANDOM()*Math.PI,n=2*RANDOM()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(s)*i,e[1]=Math.sin(s)*i,e[2]=n*t,e},as=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=s[3]*n+s[7]*i+s[11]*r+s[15];return a=a||1,e[0]=(s[0]*n+s[4]*i+s[8]*r+s[12])/a,e[1]=(s[1]*n+s[5]*i+s[9]*r+s[13])/a,e[2]=(s[2]*n+s[6]*i+s[10]*r+s[14])/a,e},os=function(e,t,s){var n=t[0],i=t[1],r=t[2];return e[0]=n*s[0]+i*s[3]+r*s[6],e[1]=n*s[1]+i*s[4]+r*s[7],e[2]=n*s[2]+i*s[5]+r*s[8],e},ls=function(e,t,s){var n=s[0],i=s[1],r=s[2],a=s[3],o=t[0],l=t[1],c=t[2],h=i*c-r*l,_=r*o-n*c,u=n*l-i*o,d=i*u-r*_,p=r*h-n*u,f=n*_-i*h,m=2*a;return h*=m,_*=m,u*=m,d*=2,p*=2,f*=2,e[0]=o+h+d,e[1]=l+_+p,e[2]=c+u+f,e},cs=function(e,t,s,n){var i=[],r=[];return i[0]=t[0]-s[0],i[1]=t[1]-s[1],i[2]=t[2]-s[2],r[0]=i[0],r[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),r[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=r[0]+s[0],e[1]=r[1]+s[1],e[2]=r[2]+s[2],e},hs=function(e,t,s,n){var i=[],r=[];return i[0]=t[0]-s[0],i[1]=t[1]-s[1],i[2]=t[2]-s[2],r[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),r[1]=i[1],r[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=r[0]+s[0],e[1]=r[1]+s[1],e[2]=r[2]+s[2],e},_s=function(e,t,s,n){var i=[],r=[];return i[0]=t[0]-s[0],i[1]=t[1]-s[1],i[2]=t[2]-s[2],r[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),r[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),r[2]=i[2],e[0]=r[0]+s[0],e[1]=r[1]+s[1],e[2]=r[2]+s[2],e},us=function(e,t){var s=e[0],n=e[1],i=e[2],r=t[0],a=t[1],o=t[2],l=Math.sqrt((s*s+n*n+i*i)*(r*r+a*a+o*o)),c=l&&Qt(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))},ds=function(e){return e[0]=0,e[1]=0,e[2]=0,e},ps=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},fs=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},ms=function(e,t){var s=e[0],n=e[1],i=e[2],r=t[0],a=t[1],o=t[2];return Math.abs(s-r)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(r))&&Math.abs(n-a)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-o)<=EPSILON*Math.max(1,Math.abs(i),Math.abs(o))},gs=function(){var e=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e},Is=function(e){var t=new ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Ss=function(e,t,s,n){var i=new ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=s,i[3]=n,i},ys=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},bs=function(e,t,s,n,i){return e[0]=t,e[1]=s,e[2]=n,e[3]=i,e},Gs=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e},vs=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e[2]=t[2]-s[2],e[3]=t[3]-s[3],e},xs=function(e,t,s){return e[0]=t[0]*s[0],e[1]=t[1]*s[1],e[2]=t[2]*s[2],e[3]=t[3]*s[3],e},Ts=function(e,t,s){return e[0]=t[0]/s[0],e[1]=t[1]/s[1],e[2]=t[2]/s[2],e[3]=t[3]/s[3],e},Cs=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},ws=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},Ps=function(e,t,s){return e[0]=Math.min(t[0],s[0]),e[1]=Math.min(t[1],s[1]),e[2]=Math.min(t[2],s[2]),e[3]=Math.min(t[3],s[3]),e},As=function(e,t,s){return e[0]=Math.max(t[0],s[0]),e[1]=Math.max(t[1],s[1]),e[2]=Math.max(t[2],s[2]),e[3]=Math.max(t[3],s[3]),e},Rs=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},Ds=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e},Es=function(e,t,s,n){return e[0]=t[0]+s[0]*n,e[1]=t[1]+s[1]*n,e[2]=t[2]+s[2]*n,e[3]=t[3]+s[3]*n,e},Ms=function(e,t){var s=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],r=t[3]-e[3];return Math.hypot(s,n,i,r)},ks=function(e,t){var s=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],r=t[3]-e[3];return s*s+n*n+i*i+r*r},Ls=function(e){var t=e[0],s=e[1],n=e[2],i=e[3];return Math.hypot(t,s,n,i)},Fs=function(e){var t=e[0],s=e[1],n=e[2],i=e[3];return t*t+s*s+n*n+i*i},Bs=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},Os=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},Ns=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=s*s+n*n+i*i+r*r;return a>0&&(a=1/Math.sqrt(a)),e[0]=s*a,e[1]=n*a,e[2]=i*a,e[3]=r*a,e},Ws=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},Vs=function(e,t,s,n){var i=s[0]*n[1]-s[1]*n[0],r=s[0]*n[2]-s[2]*n[0],a=s[0]*n[3]-s[3]*n[0],o=s[1]*n[2]-s[2]*n[1],l=s[1]*n[3]-s[3]*n[1],c=s[2]*n[3]-s[3]*n[2],h=t[0],_=t[1],u=t[2],d=t[3];return e[0]=_*c-u*l+d*o,e[1]=-h*c+u*a-d*r,e[2]=h*l-_*a+d*i,e[3]=-h*o+_*r-u*i,e},js=function(e,t,s,n){var i=t[0],r=t[1],a=t[2],o=t[3];return e[0]=i+n*(s[0]-i),e[1]=r+n*(s[1]-r),e[2]=a+n*(s[2]-a),e[3]=o+n*(s[3]-o),e},Us=function(e,t){var s,n,i,r,a,o;t=t||1;do{a=(s=2*RANDOM()-1)*s+(n=2*RANDOM()-1)*n}while(a>=1);do{o=(i=2*RANDOM()-1)*i+(r=2*RANDOM()-1)*r}while(o>=1);var l=Math.sqrt((1-a)/o);return e[0]=t*s,e[1]=t*n,e[2]=t*i*l,e[3]=t*r*l,e},Hs=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3];return e[0]=s[0]*n+s[4]*i+s[8]*r+s[12]*a,e[1]=s[1]*n+s[5]*i+s[9]*r+s[13]*a,e[2]=s[2]*n+s[6]*i+s[10]*r+s[14]*a,e[3]=s[3]*n+s[7]*i+s[11]*r+s[15]*a,e},zs=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=s[0],o=s[1],l=s[2],c=s[3],h=c*n+o*r-l*i,_=c*i+l*n-a*r,u=c*r+a*i-o*n,d=-a*n-o*i-l*r;return e[0]=h*c+d*-a+_*-l-u*-o,e[1]=_*c+d*-o+u*-a-h*-l,e[2]=u*c+d*-l+h*-o-_*-a,e[3]=t[3],e},Xs=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},Ys=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},qs=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},Js=function(e,t){var s=e[0],n=e[1],i=e[2],r=e[3],a=t[0],o=t[1],l=t[2],c=t[3];return Math.abs(s-a)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(a))&&Math.abs(n-o)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-l)<=EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(r-c)<=EPSILON*Math.max(1,Math.abs(r),Math.abs(c))},Ks=function(){var e=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e},$s=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},Zs=function(e,t,s){s*=.5;var n=Math.sin(s);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(s),e},Qs=function(e,t){var s=2*Math.acos(t[3]),n=Math.sin(s/2);return n>EPSILON?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),s},en=function(e,t){var s=dot$2(e,t);return Math.acos(2*s*s-1)},tn=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=s[0],l=s[1],c=s[2],h=s[3];return e[0]=n*h+a*o+i*c-r*l,e[1]=i*h+a*l+r*o-n*c,e[2]=r*h+a*c+n*l-i*o,e[3]=a*h-n*o-i*l-r*c,e},sn=function(e,t,s){s*=.5;var n=t[0],i=t[1],r=t[2],a=t[3],o=Math.sin(s),l=Math.cos(s);return e[0]=n*l+a*o,e[1]=i*l+r*o,e[2]=r*l-i*o,e[3]=a*l-n*o,e},nn=function(e,t,s){s*=.5;var n=t[0],i=t[1],r=t[2],a=t[3],o=Math.sin(s),l=Math.cos(s);return e[0]=n*l-r*o,e[1]=i*l+a*o,e[2]=r*l+n*o,e[3]=a*l-i*o,e},rn=function(e,t,s){s*=.5;var n=t[0],i=t[1],r=t[2],a=t[3],o=Math.sin(s),l=Math.cos(s);return e[0]=n*l+i*o,e[1]=i*l-n*o,e[2]=r*l+a*o,e[3]=a*l-r*o,e},an=function(e,t){var s=t[0],n=t[1],i=t[2];return e[0]=s,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-s*s-n*n-i*i)),e},on=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=Math.sqrt(s*s+n*n+i*i),o=Math.exp(r),l=a>0?o*Math.sin(a)/a:0;return e[0]=s*l,e[1]=n*l,e[2]=i*l,e[3]=o*Math.cos(a),e},cn=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=Math.sqrt(s*s+n*n+i*i),o=a>0?Math.atan2(a,r)/a:0;return e[0]=s*o,e[1]=n*o,e[2]=i*o,e[3]=.5*Math.log(s*s+n*n+i*i+r*r),e},hn=function(e,t,s){return cn(e,t),scale$2(e,e,s),on(e,e),e},_n=function(e,t,s,n){var i,r,a,o,l,c=t[0],h=t[1],_=t[2],u=t[3],d=s[0],p=s[1],f=s[2],m=s[3];return(r=c*d+h*p+_*f+u*m)<0&&(r=-r,d=-d,p=-p,f=-f,m=-m),1-r>EPSILON?(i=Math.acos(r),a=Math.sin(i),o=Math.sin((1-n)*i)/a,l=Math.sin(n*i)/a):(o=1-n,l=n),e[0]=o*c+l*d,e[1]=o*h+l*p,e[2]=o*_+l*f,e[3]=o*u+l*m,e},un=function(e){var t=RANDOM(),s=RANDOM(),n=RANDOM(),i=Math.sqrt(1-t),r=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*s),e[1]=i*Math.cos(2*Math.PI*s),e[2]=r*Math.sin(2*Math.PI*n),e[3]=r*Math.cos(2*Math.PI*n),e},dn=function(e,t){var s=t[0],n=t[1],i=t[2],r=t[3],a=s*s+n*n+i*i+r*r,o=a?1/a:0;return e[0]=-s*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e},pn=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},fn=function(e,t){var s,n=t[0]+t[4]+t[8];if(n>0)s=Math.sqrt(n+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var r=(i+1)%3,a=(i+2)%3;s=Math.sqrt(t[3*i+i]-t[3*r+r]-t[3*a+a]+1),e[i]=.5*s,s=.5/s,e[3]=(t[3*r+a]-t[3*a+r])*s,e[r]=(t[3*r+i]+t[3*i+r])*s,e[a]=(t[3*a+i]+t[3*i+a])*s}return e},mn=function(e,t,s,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ANGLE_ORDER,r=Math.PI/360;t*=r,n*=r,s*=r;var a=Math.sin(t),o=Math.cos(t),l=Math.sin(s),c=Math.cos(s),h=Math.sin(n),_=Math.cos(n);switch(i){case"xyz":e[0]=a*c*_+o*l*h,e[1]=o*l*_-a*c*h,e[2]=o*c*h+a*l*_,e[3]=o*c*_-a*l*h;break;case"xzy":e[0]=a*c*_-o*l*h,e[1]=o*l*_-a*c*h,e[2]=o*c*h+a*l*_,e[3]=o*c*_+a*l*h;break;case"yxz":e[0]=a*c*_+o*l*h,e[1]=o*l*_-a*c*h,e[2]=o*c*h-a*l*_,e[3]=o*c*_+a*l*h;break;case"yzx":e[0]=a*c*_+o*l*h,e[1]=o*l*_+a*c*h,e[2]=o*c*h-a*l*_,e[3]=o*c*_-a*l*h;break;case"zxy":e[0]=a*c*_-o*l*h,e[1]=o*l*_+a*c*h,e[2]=o*c*h+a*l*_,e[3]=o*c*_-a*l*h;break;case"zyx":e[0]=a*c*_-o*l*h,e[1]=o*l*_+a*c*h,e[2]=o*c*h-a*l*_,e[3]=o*c*_+a*l*h;break;default:throw new Error("Unknown angle order "+i)}return e},gn=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},In=function(e,t){return Math.abs(Ws(e,t))>=1-EPSILON},Sn=function(){var e=new ARRAY_TYPE(8);return ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},yn=function(e){var t=new ARRAY_TYPE(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},bn=function(e,t,s,n,i,r,a,o){var l=new ARRAY_TYPE(8);return l[0]=e,l[1]=t,l[2]=s,l[3]=n,l[4]=i,l[5]=r,l[6]=a,l[7]=o,l},Gn=function(e,t,s,n,i,r,a){var o=new ARRAY_TYPE(8);o[0]=e,o[1]=t,o[2]=s,o[3]=n;var l=.5*i,c=.5*r,h=.5*a;return o[4]=l*n+c*s-h*t,o[5]=c*n+h*e-l*s,o[6]=h*n+l*t-c*e,o[7]=-l*e-c*t-h*s,o},vn=function(e,t,s){var n=.5*s[0],i=.5*s[1],r=.5*s[2],a=t[0],o=t[1],l=t[2],c=t[3];return e[0]=a,e[1]=o,e[2]=l,e[3]=c,e[4]=n*c+i*l-r*o,e[5]=i*c+r*a-n*l,e[6]=r*c+n*o-i*a,e[7]=-n*a-i*o-r*l,e},xn=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},Tn=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},Cn=function(e,t){var s=Ks();ct(s,t);var n=new ARRAY_TYPE(3);return ot(n,t),vn(e,s,n),e},wn=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},Pn=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},An=function(e,t,s,n,i,r,a,o,l){return e[0]=t,e[1]=s,e[2]=n,e[3]=i,e[4]=r,e[5]=a,e[6]=o,e[7]=l,e},Rn=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},Dn=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},En=function(e,t){var s=t[4],n=t[5],i=t[6],r=t[7],a=-t[0],o=-t[1],l=-t[2],c=t[3];return e[0]=2*(s*c+r*a+n*l-i*o),e[1]=2*(n*c+r*o+i*a-s*l),e[2]=2*(i*c+r*l+s*o-n*a),e},Mn=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=.5*s[0],l=.5*s[1],c=.5*s[2],h=t[4],_=t[5],u=t[6],d=t[7];return e[0]=n,e[1]=i,e[2]=r,e[3]=a,e[4]=a*o+i*c-r*l+h,e[5]=a*l+r*o-n*c+_,e[6]=a*c+n*l-i*o+u,e[7]=-n*o-i*l-r*c+d,e},kn=function(e,t,s){var n=-t[0],i=-t[1],r=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=o*a+h*n+l*r-c*i,u=l*a+h*i+c*n-o*r,d=c*a+h*r+o*i-l*n,p=h*a-o*n-l*i-c*r;return sn(e,t,s),n=e[0],i=e[1],r=e[2],a=e[3],e[4]=_*a+p*n+u*r-d*i,e[5]=u*a+p*i+d*n-_*r,e[6]=d*a+p*r+_*i-u*n,e[7]=p*a-_*n-u*i-d*r,e},Ln=function(e,t,s){var n=-t[0],i=-t[1],r=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=o*a+h*n+l*r-c*i,u=l*a+h*i+c*n-o*r,d=c*a+h*r+o*i-l*n,p=h*a-o*n-l*i-c*r;return nn(e,t,s),n=e[0],i=e[1],r=e[2],a=e[3],e[4]=_*a+p*n+u*r-d*i,e[5]=u*a+p*i+d*n-_*r,e[6]=d*a+p*r+_*i-u*n,e[7]=p*a-_*n-u*i-d*r,e},Fn=function(e,t,s){var n=-t[0],i=-t[1],r=-t[2],a=t[3],o=t[4],l=t[5],c=t[6],h=t[7],_=o*a+h*n+l*r-c*i,u=l*a+h*i+c*n-o*r,d=c*a+h*r+o*i-l*n,p=h*a-o*n-l*i-c*r;return rn(e,t,s),n=e[0],i=e[1],r=e[2],a=e[3],e[4]=_*a+p*n+u*r-d*i,e[5]=u*a+p*i+d*n-_*r,e[6]=d*a+p*r+_*i-u*n,e[7]=p*a-_*n-u*i-d*r,e},Bn=function(e,t,s){var n=s[0],i=s[1],r=s[2],a=s[3],o=t[0],l=t[1],c=t[2],h=t[3];return e[0]=o*a+h*n+l*r-c*i,e[1]=l*a+h*i+c*n-o*r,e[2]=c*a+h*r+o*i-l*n,e[3]=h*a-o*n-l*i-c*r,o=t[4],l=t[5],c=t[6],h=t[7],e[4]=o*a+h*n+l*r-c*i,e[5]=l*a+h*i+c*n-o*r,e[6]=c*a+h*r+o*i-l*n,e[7]=h*a-o*n-l*i-c*r,e},On=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=s[0],l=s[1],c=s[2],h=s[3];return e[0]=n*h+a*o+i*c-r*l,e[1]=i*h+a*l+r*o-n*c,e[2]=r*h+a*c+n*l-i*o,e[3]=a*h-n*o-i*l-r*c,o=s[4],l=s[5],c=s[6],h=s[7],e[4]=n*h+a*o+i*c-r*l,e[5]=i*h+a*l+r*o-n*c,e[6]=r*h+a*c+n*l-i*o,e[7]=a*h-n*o-i*l-r*c,e},Nn=function(e,t,s,n){if(Math.abs(n)<EPSILON)return wn(e,t);var i=Math.hypot(s[0],s[1],s[2]);n*=.5;var r=Math.sin(n),a=r*s[0]/i,o=r*s[1]/i,l=r*s[2]/i,c=Math.cos(n),h=t[0],_=t[1],u=t[2],d=t[3];e[0]=h*c+d*a+_*l-u*o,e[1]=_*c+d*o+u*a-h*l,e[2]=u*c+d*l+h*o-_*a,e[3]=d*c-h*a-_*o-u*l;var p=t[4],f=t[5],m=t[6],g=t[7];return e[4]=p*c+g*a+f*l-m*o,e[5]=f*c+g*o+m*a-p*l,e[6]=m*c+g*l+p*o-f*a,e[7]=g*c-p*a-f*o-m*l,e},Wn=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e[2]=t[2]+s[2],e[3]=t[3]+s[3],e[4]=t[4]+s[4],e[5]=t[5]+s[5],e[6]=t[6]+s[6],e[7]=t[7]+s[7],e},Vn=function(e,t,s){var n=t[0],i=t[1],r=t[2],a=t[3],o=s[4],l=s[5],c=s[6],h=s[7],_=t[4],u=t[5],d=t[6],p=t[7],f=s[0],m=s[1],g=s[2],I=s[3];return e[0]=n*I+a*f+i*g-r*m,e[1]=i*I+a*m+r*f-n*g,e[2]=r*I+a*g+n*m-i*f,e[3]=a*I-n*f-i*m-r*g,e[4]=n*h+a*o+i*c-r*l+_*I+p*f+u*g-d*m,e[5]=i*h+a*l+r*o-n*c+u*I+p*m+d*f-_*g,e[6]=r*h+a*c+n*l-i*o+d*I+p*g+_*m-u*f,e[7]=a*h-n*o-i*l-r*c+p*I-_*f-u*m-d*g,e},jn=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e},Un=function(e,t,s,n){var i=1-n;return dot$1(t,s)<0&&(n=-n),e[0]=t[0]*i+s[0]*n,e[1]=t[1]*i+s[1]*n,e[2]=t[2]*i+s[2]*n,e[3]=t[3]*i+s[3]*n,e[4]=t[4]*i+s[4]*n,e[5]=t[5]*i+s[5]*n,e[6]=t[6]*i+s[6]*n,e[7]=t[7]*i+s[7]*n,e},Hn=function(e,t){var s=squaredLength$1(t);return e[0]=-t[0]/s,e[1]=-t[1]/s,e[2]=-t[2]/s,e[3]=t[3]/s,e[4]=-t[4]/s,e[5]=-t[5]/s,e[6]=-t[6]/s,e[7]=t[7]/s,e},zn=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},Xn=function(e,t){var s=squaredLength$1(t);if(s>0){s=Math.sqrt(s);var n=t[0]/s,i=t[1]/s,r=t[2]/s,a=t[3]/s,o=t[4],l=t[5],c=t[6],h=t[7],_=n*o+i*l+r*c+a*h;e[0]=n,e[1]=i,e[2]=r,e[3]=a,e[4]=(o-n*_)/s,e[5]=(l-i*_)/s,e[6]=(c-r*_)/s,e[7]=(h-a*_)/s}return e},Yn=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},qn=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},Jn=function(e,t){var s=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],l=e[6],c=e[7],h=t[0],_=t[1],u=t[2],d=t[3],p=t[4],f=t[5],m=t[6],g=t[7];return Math.abs(s-h)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(n-_)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-u)<=EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(r-d)<=EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(a-p)<=EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-f)<=EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(l-m)<=EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(c-g)<=EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},Kn=function(){var e=new ARRAY_TYPE(2);return ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e},$n=function(e){var t=new ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},Zn=function(e,t){var s=new ARRAY_TYPE(2);return s[0]=e,s[1]=t,s},Qn=function(e,t){return e[0]=t[0],e[1]=t[1],e},ei=function(e,t,s){return e[0]=t,e[1]=s,e},ti=function(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e},si=function(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e},ni=function(e,t,s){return e[0]=t[0]*s[0],e[1]=t[1]*s[1],e},ii=function(e,t,s){return e[0]=t[0]/s[0],e[1]=t[1]/s[1],e},ri=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},ai=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},oi=function(e,t,s){return e[0]=Math.min(t[0],s[0]),e[1]=Math.min(t[1],s[1]),e},li=function(e,t,s){return e[0]=Math.max(t[0],s[0]),e[1]=Math.max(t[1],s[1]),e},ci=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},hi=function(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e},_i=function(e,t,s,n){return e[0]=t[0]+s[0]*n,e[1]=t[1]+s[1]*n,e},ui=function(e,t){var s=t[0]-e[0],n=t[1]-e[1];return Math.hypot(s,n)},di=function(e,t){var s=t[0]-e[0],n=t[1]-e[1];return s*s+n*n},pi=function(e){var t=e[0],s=e[1];return Math.hypot(t,s)},fi=function(e){var t=e[0],s=e[1];return t*t+s*s},mi=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},gi=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},Ii=function(e,t){var s=t[0],n=t[1],i=s*s+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e},Si=function(e,t){return e[0]*t[0]+e[1]*t[1]},yi=function(e,t,s){var n=t[0]*s[1]-t[1]*s[0];return e[0]=e[1]=0,e[2]=n,e},bi=function(e,t,s,n){var i=t[0],r=t[1];return e[0]=i+n*(s[0]-i),e[1]=r+n*(s[1]-r),e},Gi=function(e,t){t=t||1;var s=2*RANDOM()*Math.PI;return e[0]=Math.cos(s)*t,e[1]=Math.sin(s)*t,e},vi=function(e,t,s){var n=t[0],i=t[1];return e[0]=s[0]*n+s[2]*i,e[1]=s[1]*n+s[3]*i,e},xi=function(e,t,s){var n=t[0],i=t[1];return e[0]=s[0]*n+s[2]*i+s[4],e[1]=s[1]*n+s[3]*i+s[5],e},Ti=function(e,t,s){var n=t[0],i=t[1];return e[0]=s[0]*n+s[3]*i+s[6],e[1]=s[1]*n+s[4]*i+s[7],e},Ci=function(e,t,s){var n=t[0],i=t[1];return e[0]=s[0]*n+s[4]*i+s[12],e[1]=s[1]*n+s[5]*i+s[13],e},wi=function(e,t,s,n){var i=t[0]-s[0],r=t[1]-s[1],a=Math.sin(n),o=Math.cos(n);return e[0]=i*o-r*a+s[0],e[1]=i*a+r*o+s[1],e},Pi=function(e,t){var s=e[0],n=e[1],i=t[0],r=t[1],a=Math.sqrt((s*s+n*n)*(i*i+r*r)),o=a&&(s*i+n*r)/a;return Math.acos(Math.min(Math.max(o,-1),1))},Ai=function(e){return e[0]=0,e[1]=0,e},Ri=function(e){return"vec2("+e[0]+", "+e[1]+")"},Di=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Ei=function(e,t){var s=e[0],n=e[1],i=t[0],r=t[1];return Math.abs(s-i)<=EPSILON*Math.max(1,Math.abs(s),Math.abs(i))&&Math.abs(n-r)<=EPSILON*Math.max(1,Math.abs(n),Math.abs(r))};setMatrixArrayType=e,toRadian=n,equals$9=h,create$8=_,clone$8=u,copy$8=p,identity$5=m,fromValues$8=g,set$8=I,transpose$2=S,invert$5=y,adjoint$2=b,determinant$3=G,multiply$8=v,rotate$4=x,scale$8=T,fromRotation$4=C,fromScaling$3=w,str$8=P,frob$3=A,LDU=R,add$8=D,subtract$6=E,exactEquals$8=M,equals$8=k,multiplyScalar$3=L,multiplyScalarAndAdd$3=F,create$7=B,clone$7=O,copy$7=N,identity$4=W,fromValues$7=V,set$7=j,invert$4=U,determinant$2=H,multiply$7=z,rotate$3=X,scale$7=Y,translate$3=q,fromRotation$3=J,fromScaling$2=K,fromTranslation$3=$,str$7=Z,frob$2=Q,add$7=ee,subtract$5=te,multiplyScalar$2=se,multiplyScalarAndAdd$2=ne,exactEquals$7=ie,equals$7=re,create$6=ae,fromMat4$1=oe,clone$6=le,copy$6=ce,fromValues$6=he,set$6=_e,identity$3=ue,transpose$1=de,invert$3=pe,adjoint$1=fe,determinant$1=me,multiply$6=ge,translate$2=Ie,rotate$2=Se,scale$6=ye,fromTranslation$2=be,fromRotation$2=Ge,fromScaling$1=ve,fromMat2d=xe,fromQuat$1=Te,normalFromMat4=Ce,projection=we,str$6=Pe,frob$1=Ae,add$6=Re,subtract$4=De,multiplyScalar$1=Ee,multiplyScalarAndAdd$1=Me,exactEquals$6=ke,equals$6=Le,create$5=Fe,clone$5=Be,copy$5=Oe,fromValues$5=Ne,set$5=We,identity$2=Ve,transpose=je,invert$2=Ue,adjoint=He,determinant=ze,multiply$5=Xe,translate$1=Ye,scale$5=qe,rotate$1=Je,rotateX$3=Ke,rotateY$3=$e,rotateZ$3=Ze,fromTranslation$1=Qe,fromScaling=et,fromRotation$1=tt,fromXRotation=st,fromYRotation=nt,fromZRotation=it,fromRotationTranslation$1=rt,fromQuat2=at,getTranslation$1=ot,getScaling=lt,getRotation=ct,decompose=ht,fromRotationTranslationScale=_t,fromRotationTranslationScaleOrigin=ut,fromQuat=dt,frustum=pt,perspectiveNO=ft,perspectiveZO=mt,perspectiveFromFieldOfView=gt,orthoNO=It,orthoZO=St,lookAt=yt,targetTo=bt,str$5=Gt,frob=vt,add$5=xt,subtract$3=Tt,multiplyScalar=Ct,multiplyScalarAndAdd=wt,exactEquals$5=Pt,equals$5=At,create$4=Rt,clone$4=Dt,length$4=Et,fromValues$4=Mt,copy$4=kt,set$4=Lt,add$4=Ft,subtract$2=Bt,multiply$4=Ot,divide$2=Nt,ceil$2=Wt,floor$2=Vt,min$2=jt,max$2=Ut,round$2=Ht,scale$4=zt,scaleAndAdd$2=Xt,distance$2=Yt,squaredDistance$2=qt,squaredLength$4=Jt,negate$2=Kt,inverse$2=$t,normalize$4=Zt,dot$4=Qt,cross$2=es,lerp$4=ts,slerp$1=ss,hermite=ns,bezier=is,random$3=rs,transformMat4$2=as,transformMat3$1=os,transformQuat$1=ls,rotateX$2=cs,rotateY$2=hs,rotateZ$2=_s,angle$1=us,zero$2=ds,str$4=ps,exactEquals$4=fs,equals$4=ms,create$3=gs,clone$3=Is,fromValues$3=Ss,copy$3=ys,set$3=bs,add$3=Gs,subtract$1=vs,multiply$3=xs,divide$1=Ts,ceil$1=Cs,floor$1=ws,min$1=Ps,max$1=As,round$1=Rs,scale$3=Ds,scaleAndAdd$1=Es,distance$1=Ms,squaredDistance$1=ks,length$3=Ls,squaredLength$3=Fs,negate$1=Bs,inverse$1=Os,normalize$3=Ns,dot$3=Ws,cross$1=Vs,lerp$3=js,random$2=Us,transformMat4$1=Hs,transformQuat=zs,zero$1=Xs,str$3=Ys,exactEquals$3=qs,equals$3=Js,create$2=Ks,identity$1=$s,setAxisAngle=Zs,getAxisAngle=Qs,getAngle=en,multiply$2=tn,rotateX$1=sn,rotateY$1=nn,rotateZ$1=rn,calculateW=an,exp=on,ln=cn,pow=hn,slerp=_n,random$1=un,invert$1=dn,conjugate$1=pn,fromMat3=fn,fromEuler=mn,str$2=gn,equals$2=In,create$1=Sn,clone$1=yn,fromValues$1=bn,fromRotationTranslationValues=Gn,fromRotationTranslation=vn,fromTranslation=xn,fromRotation=Tn,fromMat4=Cn,copy$1=wn,identity=Pn,set$1=An,getDual=Rn,setDual=Dn,getTranslation=En,translate=Mn,rotateX=kn,rotateY=Ln,rotateZ=Fn,rotateByQuatAppend=Bn,rotateByQuatPrepend=On,rotateAroundAxis=Nn,add$1=Wn,multiply$1=Vn,scale$1=jn,lerp$1=Un,invert=Hn,conjugate=zn,normalize$1=Xn,str$1=Yn,exactEquals$1=qn,equals$1=Jn,create=Kn,clone=$n,fromValues=Zn,copy=Qn,set=ei,add=ti,subtract=si,multiply=ni,divide=ii,ceil=ri,floor=ai,min=oi,max=li,round=ci,scale=hi,scaleAndAdd=_i,distance=ui,squaredDistance=di,length=pi,squaredLength=fi,negate=mi,inverse=gi,normalize=Ii,dot=Si,cross=yi,lerp=bi,random=Gi,transformMat2=vi,transformMat2d=xi,transformMat3=Ti,transformMat4=Ci,rotate=wi,angle=Pi,zero=Ai,str=Ri,exactEquals=Di,equals=Ei,EPSILON=1e-6,ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,RANDOM=Math.random,ANGLE_ORDER="zyx",degree=Math.PI/180,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),common={__proto__:null,EPSILON:EPSILON,get ARRAY_TYPE(){return ARRAY_TYPE},RANDOM:RANDOM,ANGLE_ORDER:ANGLE_ORDER,setMatrixArrayType:e,toRadian:n,equals:h},mul$8=v,sub$6=E,mat2=Object.freeze({__proto__:null,create:_,clone:u,copy:p,identity:m,fromValues:g,set:I,transpose:S,invert:y,adjoint:b,determinant:G,multiply:v,rotate:x,scale:T,fromRotation:C,fromScaling:w,str:P,frob:A,LDU:R,add:D,subtract:E,exactEquals:M,equals:k,multiplyScalar:L,multiplyScalarAndAdd:F,mul:mul$8,sub:sub$6}),mul$7=z,sub$5=te,mat2d=Object.freeze({__proto__:null,create:B,clone:O,copy:N,identity:W,fromValues:V,set:j,invert:U,determinant:H,multiply:z,rotate:X,scale:Y,translate:q,fromRotation:J,fromScaling:K,fromTranslation:$,str:Z,frob:Q,add:ee,subtract:te,multiplyScalar:se,multiplyScalarAndAdd:ne,exactEquals:ie,equals:re,mul:mul$7,sub:sub$5}),mul$6=ge,sub$4=De,mat3=Object.freeze({__proto__:null,create:ae,fromMat4:oe,clone:le,copy:ce,fromValues:he,set:_e,identity:ue,transpose:de,invert:pe,adjoint:fe,determinant:me,multiply:ge,translate:Ie,rotate:Se,scale:ye,fromTranslation:be,fromRotation:Ge,fromScaling:ve,fromMat2d:xe,fromQuat:Te,normalFromMat4:Ce,projection:we,str:Pe,frob:Ae,add:Re,subtract:De,multiplyScalar:Ee,multiplyScalarAndAdd:Me,exactEquals:ke,equals:Le,mul:mul$6,sub:sub$4}),perspective=ft,ortho=It,mul$5=Xe,sub$3=Tt,mat4=Object.freeze({__proto__:null,create:Fe,clone:Be,copy:Oe,fromValues:Ne,set:We,identity:Ve,transpose:je,invert:Ue,adjoint:He,determinant:ze,multiply:Xe,translate:Ye,scale:qe,rotate:Je,rotateX:Ke,rotateY:$e,rotateZ:Ze,fromTranslation:Qe,fromScaling:et,fromRotation:tt,fromXRotation:st,fromYRotation:nt,fromZRotation:it,fromRotationTranslation:rt,fromQuat2:at,getTranslation:ot,getScaling:lt,getRotation:ct,decompose:ht,fromRotationTranslationScale:_t,fromRotationTranslationScaleOrigin:ut,fromQuat:dt,frustum:pt,perspectiveNO:ft,perspective:perspective,perspectiveZO:mt,perspectiveFromFieldOfView:gt,orthoNO:It,ortho:ortho,orthoZO:St,lookAt:yt,targetTo:bt,str:Gt,frob:vt,add:xt,subtract:Tt,multiplyScalar:Ct,multiplyScalarAndAdd:wt,exactEquals:Pt,equals:At,mul:mul$5,sub:sub$3}),sub$2=Bt,mul$4=Ot,div$2=Nt,dist$2=Yt,sqrDist$2=qt,len$4=Et,sqrLen$4=Jt,t=Rt(),forEach$2=function(e,s,n,i,r,a){var o,l;for(s||(s=3),n||(n=0),l=i?Math.min(i*s+n,e.length):e.length,o=n;o<l;o+=s)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],r(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e},vec3=Object.freeze({__proto__:null,create:Rt,clone:Dt,length:Et,fromValues:Mt,copy:kt,set:Lt,add:Ft,subtract:Bt,multiply:Ot,divide:Nt,ceil:Wt,floor:Vt,min:jt,max:Ut,round:Ht,scale:zt,scaleAndAdd:Xt,distance:Yt,squaredDistance:qt,squaredLength:Jt,negate:Kt,inverse:$t,normalize:Zt,dot:Qt,cross:es,lerp:ts,slerp:ss,hermite:ns,bezier:is,random:rs,transformMat4:as,transformMat3:os,transformQuat:ls,rotateX:cs,rotateY:hs,rotateZ:_s,angle:us,zero:ds,str:ps,exactEquals:fs,equals:ms,sub:sub$2,mul:mul$4,div:div$2,dist:dist$2,sqrDist:sqrDist$2,len:len$4,sqrLen:sqrLen$4,forEach:forEach$2}),sub$1=vs,mul$3=xs,div$1=Ts,dist$1=Ms,sqrDist$1=ks,len$3=Ls,sqrLen$3=Fs,forEach$1=function(){var e=gs();return function(t,s,n,i,r,a){var o,l;for(s||(s=4),n||(n=0),l=i?Math.min(i*s+n,t.length):t.length,o=n;o<l;o+=s)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],r(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}}(),vec4=Object.freeze({__proto__:null,create:gs,clone:Is,fromValues:Ss,copy:ys,set:bs,add:Gs,subtract:vs,multiply:xs,divide:Ts,ceil:Cs,floor:ws,min:Ps,max:As,round:Rs,scale:Ds,scaleAndAdd:Es,distance:Ms,squaredDistance:ks,length:Ls,squaredLength:Fs,negate:Bs,inverse:Os,normalize:Ns,dot:Ws,cross:Vs,lerp:js,random:Us,transformMat4:Hs,transformQuat:zs,zero:Xs,str:Ys,exactEquals:qs,equals:Js,sub:sub$1,mul:mul$3,div:div$1,dist:dist$1,sqrDist:sqrDist$1,len:len$3,sqrLen:sqrLen$3,forEach:forEach$1}),clone$2=Is,fromValues$2=Ss,copy$2=ys,set$2=bs,add$2=Gs,mul$2=tn,scale$2=Ds,dot$2=Ws,lerp$2=js,length$2=Ls,len$2=length$2,squaredLength$2=Fs,sqrLen$2=squaredLength$2,normalize$2=Ns,exactEquals$2=qs,rotationTo=function(){var e=Rt(),t=Mt(1,0,0),s=Mt(0,1,0);return function(n,i,r){var a=Qt(i,r);return a<-.999999?(es(e,t,i),len$4(e)<1e-6&&es(e,s,i),Zt(e,e),Zs(n,e,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(es(e,i,r),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+a,normalize$2(n,n))}}(),sqlerp=function(){var e=Ks(),t=Ks();return function(s,n,i,r,a,o){return _n(e,n,a,o),_n(t,i,r,o),_n(s,e,t,2*o*(1-o)),s}}(),setAxes=function(){var e=ae();return function(t,s,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-s[0],e[5]=-s[1],e[8]=-s[2],normalize$2(t,fn(t,e))}}(),quat=Object.freeze({__proto__:null,create:Ks,identity:$s,setAxisAngle:Zs,getAxisAngle:Qs,getAngle:en,multiply:tn,rotateX:sn,rotateY:nn,rotateZ:rn,calculateW:an,exp:on,ln:cn,pow:hn,slerp:_n,random:un,invert:dn,conjugate:pn,fromMat3:fn,fromEuler:mn,str:gn,clone:clone$2,fromValues:fromValues$2,copy:copy$2,set:set$2,add:add$2,mul:mul$2,scale:scale$2,dot:dot$2,lerp:lerp$2,length:length$2,len:len$2,squaredLength:squaredLength$2,sqrLen:sqrLen$2,normalize:normalize$2,exactEquals:exactEquals$2,equals:In,rotationTo:rotationTo,sqlerp:sqlerp,setAxes:setAxes}),getReal=copy$2,setReal=copy$2,mul$1=Vn,dot$1=dot$2,length$1=length$2,len$1=length$1,squaredLength$1=squaredLength$2,sqrLen$1=squaredLength$1,quat2=Object.freeze({__proto__:null,create:Sn,clone:yn,fromValues:bn,fromRotationTranslationValues:Gn,fromRotationTranslation:vn,fromTranslation:xn,fromRotation:Tn,fromMat4:Cn,copy:wn,identity:Pn,set:An,getReal:getReal,getDual:Rn,setReal:setReal,setDual:Dn,getTranslation:En,translate:Mn,rotateX:kn,rotateY:Ln,rotateZ:Fn,rotateByQuatAppend:Bn,rotateByQuatPrepend:On,rotateAroundAxis:Nn,add:Wn,multiply:Vn,mul:mul$1,scale:jn,dot:dot$1,lerp:Un,invert:Hn,conjugate:zn,length:length$1,len:len$1,squaredLength:squaredLength$1,sqrLen:sqrLen$1,normalize:Xn,str:Yn,exactEquals:qn,equals:Jn}),len=pi,sub=si,mul=ni,div=ii,dist=ui,sqrDist=di,sqrLen=fi,forEach=function(){var e=Kn();return function(t,s,n,i,r,a){var o,l;for(s||(s=2),n||(n=0),l=i?Math.min(i*s+n,t.length):t.length,o=n;o<l;o+=s)e[0]=t[o],e[1]=t[o+1],r(e,e,a),t[o]=e[0],t[o+1]=e[1];return t}}(),vec2=Object.freeze({__proto__:null,create:Kn,clone:$n,fromValues:Zn,copy:Qn,set:ei,add:ti,subtract:si,multiply:ni,divide:ii,ceil:ri,floor:ai,min:oi,max:li,round:ci,scale:hi,scaleAndAdd:_i,distance:ui,squaredDistance:di,length:pi,squaredLength:fi,negate:mi,inverse:gi,normalize:Ii,dot:Si,cross:yi,lerp:bi,random:Gi,transformMat2:vi,transformMat2d:xi,transformMat3:Ti,transformMat4:Ci,rotate:wi,angle:Pi,zero:Ai,str:Ri,exactEquals:Di,equals:Ei,len:len,sub:sub,mul:mul,div:div,dist:dist,sqrDist:sqrDist,sqrLen:sqrLen,forEach:forEach}),globalThis.glMatrix=common,globalThis.glMatrix.mat2=mat2,globalThis.glMatrix.mat2d=mat2d,globalThis.glMatrix.mat3=mat3,globalThis.glMatrix.mat4=mat4,globalThis.glMatrix.quat=quat,globalThis.glMatrix.quat2=quat2,globalThis.glMatrix.vec2=vec2,globalThis.glMatrix.vec3=vec3,globalThis.glMatrix.vec4=vec4}var t,EPSILON,ARRAY_TYPE,RANDOM,ANGLE_ORDER,degree,common,mul$8,sub$6,mat2,mul$7,sub$5,mat2d,mul$6,sub$4,mat3,perspective,ortho,mul$5,sub$3,mat4,sub$2,mul$4,div$2,dist$2,sqrDist$2,len$4,sqrLen$4,forEach$2,vec3,sub$1,mul$3,div$1,dist$1,sqrDist$1,len$3,sqrLen$3,forEach$1,vec4,clone$2,fromValues$2,copy$2,set$2,add$2,mul$2,scale$2,dot$2,lerp$2,length$2,len$2,squaredLength$2,sqrLen$2,normalize$2,exactEquals$2,rotationTo,sqlerp,setAxes,quat,getReal,setReal,mul$1,dot$1,length$1,len$1,squaredLength$1,sqrLen$1,quat2,len,sub,mul,div,dist,sqrDist,sqrLen,forEach,vec2,setMatrixArrayType,toRadian,equals$9,create$8,clone$8,copy$8,identity$5,fromValues$8,set$8,transpose$2,invert$5,adjoint$2,determinant$3,multiply$8,rotate$4,scale$8,fromRotation$4,fromScaling$3,str$8,frob$3,LDU,add$8,subtract$6,exactEquals$8,equals$8,multiplyScalar$3,multiplyScalarAndAdd$3,create$7,clone$7,copy$7,identity$4,fromValues$7,set$7,invert$4,determinant$2,multiply$7,rotate$3,scale$7,translate$3,fromRotation$3,fromScaling$2,fromTranslation$3,str$7,frob$2,add$7,subtract$5,multiplyScalar$2,multiplyScalarAndAdd$2,exactEquals$7,equals$7,create$6,fromMat4$1,clone$6,copy$6,fromValues$6,set$6,identity$3,transpose$1,invert$3,adjoint$1,determinant$1,multiply$6,translate$2,rotate$2,scale$6,fromTranslation$2,fromRotation$2,fromScaling$1,fromMat2d,fromQuat$1,normalFromMat4,projection,str$6,frob$1,add$6,subtract$4,multiplyScalar$1,multiplyScalarAndAdd$1,exactEquals$6,equals$6,create$5,clone$5,copy$5,fromValues$5,set$5,identity$2,transpose,invert$2,adjoint,determinant,multiply$5,translate$1,scale$5,rotate$1,rotateX$3,rotateY$3,rotateZ$3,fromTranslation$1,fromScaling,fromRotation$1,fromXRotation,fromYRotation,fromZRotation,fromRotationTranslation$1,fromQuat2,getTranslation$1,getScaling,getRotation,decompose,fromRotationTranslationScale,fromRotationTranslationScaleOrigin,fromQuat,frustum,perspectiveNO,perspectiveZO,perspectiveFromFieldOfView,orthoNO,orthoZO,lookAt,targetTo,str$5,frob,add$5,subtract$3,multiplyScalar,multiplyScalarAndAdd,exactEquals$5,equals$5,create$4,clone$4,length$4,fromValues$4,copy$4,set$4,add$4,subtract$2,multiply$4,divide$2,ceil$2,floor$2,min$2,max$2,round$2,scale$4,scaleAndAdd$2,distance$2,squaredDistance$2,squaredLength$4,negate$2,inverse$2,normalize$4,dot$4,cross$2,lerp$4,slerp$1,hermite,bezier,random$3,transformMat4$2,transformMat3$1,transformQuat$1,rotateX$2,rotateY$2,rotateZ$2,angle$1,zero$2,str$4,exactEquals$4,equals$4,create$3,clone$3,fromValues$3,copy$3,set$3,add$3,subtract$1,multiply$3,divide$1,ceil$1,floor$1,min$1,max$1,round$1,scale$3,scaleAndAdd$1,distance$1,squaredDistance$1,length$3,squaredLength$3,negate$1,inverse$1,normalize$3,dot$3,cross$1,lerp$3,random$2,transformMat4$1,transformQuat,zero$1,str$3,exactEquals$3,equals$3,create$2,identity$1,setAxisAngle,getAxisAngle,getAngle,multiply$2,rotateX$1,rotateY$1,rotateZ$1,calculateW,exp,ln,pow,slerp,random$1,invert$1,conjugate$1,fromMat3,fromEuler,str$2,equals$2,create$1,clone$1,fromValues$1,fromRotationTranslationValues,fromRotationTranslation,fromTranslation,fromRotation,fromMat4,copy$1,identity,set$1,getDual,setDual,getTranslation,translate,rotateX,rotateY,rotateZ,rotateByQuatAppend,rotateByQuatPrepend,rotateAroundAxis,add$1,multiply$1,scale$1,lerp$1,invert,conjugate,normalize$1,str$1,exactEquals$1,equals$1,create,clone,fromValues,copy,set,add,subtract,multiply,divide,ceil,floor,min,max,round,scale,scaleAndAdd,distance,squaredDistance,length,squaredLength,negate,inverse,normalize,dot,cross,lerp,random,transformMat2,transformMat2d,transformMat3,transformMat4,rotate,angle,zero,str,exactEquals,equals,tmpPoint1,tmpPoint2,tmpLine1,tmpLine2,lineInt,lineSegmentsIntersect,triangleArea,isLeft,isLeftOn,isRight,isRightOn,collinear,sqdist,polygonAt,polygonClear,polygonAppend,polygonMakeCCW,polygonReverse,polygonIsReflex,polygonCanSee,polygonCanSee2,polygonCopy,polygonGetCutEdges,polygonDecomp,polygonSlice,polygonIsSimple,getIntersectionPoint,polygonQuickDecomp,polygonRemoveCollinearPoints,polygonRemoveDuplicatePoints,scalar_eq,points_eq,ReadBrandList,RunTest,GetWindowsNTVersionName,s,a,c,i,l,f,d,r,a,o,arrayFlat,assertFail,isValidTypeChange,logDefendedObjectWarning,CheckDefendedObjectsUsedCorrectly,getObjectPropertySet,VerifyObjectPropertiesConsistent,isNegativeZero,padTwoDigits,hueToRGB,RequireStringOrNumber,SetNewCallback,DoAsyncifiedWork,DoNextAsyncifiedJob,ClearTimeCache,CheckActiveIdleTimeouts,lookupHtmlEntity,bbToHtmlReplacerFunc,IsWordBreakWhiteSpace,IsOpeningCJKPunctiationChar,IsContinuingCJKPunctuationChar,WordBreakTrimEnd,IsNewline,PlaneFromPoints,IsInFrontOfPlane,IsPointInFrontOfPlane,interpolateQuad,GetFormatSpecifiers,fillOrStrokeRect,ptToPx,getOffsetParam,CheckPendingPolls,SortZOrderList,GetDispatcher,MakeIWorldInstanceClass,GetDispatcher,GetTimelineState,GetTimelineState,GetTweenState,getActual,GetTypeFromFileExtension,AddScript,SortByInstLastCachedZIndex,SortByInstLastCachedZIndex,SortByInstZElevation,vec3EqualsXYZ,MaybePrepareLayerDraw,SortSolArray,IsSolArrayIdentical,NoActions,WrapIndex,GetExpressionFunc,EvalParams,EvalParams,GetInst,GetWorldInfo,GetInst_SDKv2,GetWorldInfo_SDKv2,GetObjectClass,GetLayer,CollMemory_Add,CollMemory_Remove,CollMemory_RemoveInstance,CollMemory_Get,DoOverlapCondition,FinishCollisionConditionPicking,FinishCollisionCondition,PickByUID_Normal,PickByUID_Inverted,GetNextParamMap,ValidateInternalAPIToken,ForEachOrdered_SortInstances,SortZOrderList,SortInstancesByValue,ResizeArray,DoForEachTrigger,CompareValues,GetAudioSdkInstance,GetAudioDOMInterface,IsExpressionType,GetTouchSdkInstance,CloneDrawable,GetSdkInstance,GetParticleEngine,randomOffset,getIndexForEase,ValidateTags,SetObjectTypeCollisionsEnabled,UnwrapIWorldInstance,CloneVec2,SplitConvexPolysOver8Points,SplitConvexPoly,unaryminus,bothNumbers,add,subtract,multiply,divide,mod,pow,and,or;{let Mi=function(e,t,s){s=s||0;var n,i,r,a,o,l,c,h=[0,0];return n=e[1][1]-e[0][1],i=e[0][0]-e[1][0],r=n*e[0][0]+i*e[0][1],a=t[1][1]-t[0][1],o=t[0][0]-t[1][0],l=a*t[0][0]+o*t[0][1],rr(c=n*o-a*i,0,s)||(h[0]=(o*r-i*l)/c,h[1]=(n*l-a*r)/c),h},ki=function(e,t,s,n){var i=t[0]-e[0],r=t[1]-e[1],a=n[0]-s[0],o=n[1]-s[1];if(a*r-o*i==0)return!1;var l=(i*(s[1]-e[1])+r*(e[0]-s[0]))/(a*r-o*i),c=(a*(e[1]-s[1])+o*(s[0]-e[0]))/(o*i-a*r);return l>=0&&l<=1&&c>=0&&c<=1},Li=function(e,t,s){return(t[0]-e[0])*(s[1]-e[1])-(s[0]-e[0])*(t[1]-e[1])},Fi=function(e,t,s){return Li(e,t,s)>0},Bi=function(e,t,s){return Li(e,t,s)>=0},Oi=function(e,t,s){return Li(e,t,s)<0},Ni=function(e,t,s){return Li(e,t,s)<=0},Wi=function(e,t,s,n){if(n){var i=tmpPoint1,r=tmpPoint2;i[0]=t[0]-e[0],i[1]=t[1]-e[1],r[0]=s[0]-t[0],r[1]=s[1]-t[1];var a=i[0]*r[0]+i[1]*r[1],o=Math.sqrt(i[0]*i[0]+i[1]*i[1]),l=Math.sqrt(r[0]*r[0]+r[1]*r[1]);return Math.acos(a/(o*l))<n}return 0===Li(e,t,s)},Vi=function(e,t){var s=t[0]-e[0],n=t[1]-e[1];return s*s+n*n},ji=function(e,t){var s=e.length;return e[t<0?t%s+s:t%s]},Ui=function(e){e.length=0},Hi=function(e,t,s,n){for(var i=s;i<n;i++)e.push(t[i])},zi=function(e){for(var t=0,s=e,n=1;n<e.length;++n)(s[n][1]<s[t][1]||s[n][1]===s[t][1]&&s[n][0]>s[t][0])&&(t=n);return!Fi(ji(e,t-1),ji(e,t),ji(e,t+1))&&(Xi(e),!0)},Xi=function(e){for(var t=[],s=e.length,n=0;n!==s;n++)t.push(e.pop());for(n=0;n!==s;n++)e[n]=t[n]},Yi=function(e,t){return Oi(ji(e,t-1),ji(e,t),ji(e,t+1))},qi=function(e,t,s){var n,i,r=tmpLine1,a=tmpLine2;if(Bi(ji(e,t+1),ji(e,t),ji(e,s))&&Ni(ji(e,t-1),ji(e,t),ji(e,s)))return!1;i=Vi(ji(e,t),ji(e,s));for(var o=0;o!==e.length;++o)if((o+1)%e.length!==t&&o!==t&&Bi(ji(e,t),ji(e,s),ji(e,o+1))&&Ni(ji(e,t),ji(e,s),ji(e,o))&&(r[0]=ji(e,t),r[1]=ji(e,s),a[0]=ji(e,o),a[1]=ji(e,o+1),n=Mi(r,a),Vi(ji(e,t),n)<i))return!1;return!0},Ji=function(e,t,s){for(var n=0;n!==e.length;++n)if(n!==t&&n!==s&&(n+1)%e.length!==t&&(n+1)%e.length!==s&&ki(ji(e,t),ji(e,s),ji(e,n),ji(e,n+1)))return!1;return!0},Ki=function(e,t,s,n){var i=n||[];if(Ui(i),t<s)for(var r=t;r<=s;r++)i.push(e[r]);else{for(r=0;r<=s;r++)i.push(e[r]);for(r=t;r<e.length;r++)i.push(e[r])}return i},$i=function(e){for(var t=[],s=[],n=[],i=[],r=Number.MAX_VALUE,a=0;a<e.length;++a)if(Yi(e,a))for(var o=0;o<e.length;++o)if(qi(e,a,o)){s=$i(Ki(e,a,o,i)),n=$i(Ki(e,o,a,i));for(var l=0;l<n.length;l++)s.push(n[l]);s.length<r&&(t=s,r=s.length,t.push([ji(e,a),ji(e,o)]))}return t},Zi=function(e){var t=$i(e);return t.length>0?Qi(e,t):[e]},Qi=function(e,t){if(0===t.length)return[e];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2===t[0].length&&t[0][0]instanceof Array){for(var s=[e],n=0;n<t.length;n++)for(var i=t[n],r=0;r<s.length;r++){var a=Qi(s[r],i);if(a){s.splice(r,1),s.push(a[0],a[1]);break}}return s}return i=t,n=e.indexOf(i[0]),r=e.indexOf(i[1]),-1!==n&&-1!==r&&[Ki(e,n,r),Ki(e,r,n)]},er=function(e){var t,s=e;for(t=0;t<s.length-1;t++)for(var n=0;n<t-1;n++)if(ki(s[t],s[t+1],s[n],s[n+1]))return!1;for(t=1;t<s.length-2;t++)if(ki(s[0],s[s.length-1],s[t],s[t+1]))return!1;return!0},tr=function(e,t,s,n,i){i=i||0;var r=t[1]-e[1],a=e[0]-t[0],o=r*e[0]+a*e[1],l=n[1]-s[1],c=s[0]-n[0],h=l*s[0]+c*s[1],_=r*c-l*a;return rr(_,0,i)?[0,0]:[(c*o-a*h)/_,(r*h-l*o)/_]},sr=function(e,t,s,n,i,r,a){r=r||100,a=a||0,i=i||25,t=void 0!==t?t:[],s=s||[],n=n||[];var o=[0,0],l=[0,0],c=[0,0],h=0,_=0,u=0,d=0,p=0,f=0,m=0,g=[],I=[],S=e,y=e;if(y.length<3)return t;if(++a>r)return console.warn("quickDecomp: max level ("+r+") reached."),t;for(var b=0;b<e.length;++b)if(Yi(S,b)){s.push(S[b]),h=_=Number.MAX_VALUE;for(var G=0;G<e.length;++G)Fi(ji(S,b-1),ji(S,b),ji(S,G))&&Ni(ji(S,b-1),ji(S,b),ji(S,G-1))&&(c=tr(ji(S,b-1),ji(S,b),ji(S,G),ji(S,G-1)),Oi(ji(S,b+1),ji(S,b),c)&&(u=Vi(S[b],c))<_&&(_=u,l=c,f=G)),Fi(ji(S,b+1),ji(S,b),ji(S,G+1))&&Ni(ji(S,b+1),ji(S,b),ji(S,G))&&(c=tr(ji(S,b+1),ji(S,b),ji(S,G),ji(S,G+1)),Fi(ji(S,b-1),ji(S,b),c)&&(u=Vi(S[b],c))<h&&(h=u,o=c,p=G));if(f===(p+1)%e.length)c[0]=(l[0]+o[0])/2,c[1]=(l[1]+o[1])/2,n.push(c),b<p?(Hi(g,S,b,p+1),g.push(c),I.push(c),0!==f&&Hi(I,S,f,S.length),Hi(I,S,0,b+1)):(0!==b&&Hi(g,S,b,S.length),Hi(g,S,0,p+1),g.push(c),I.push(c),Hi(I,S,f,b+1));else{if(f>p&&(p+=e.length),d=Number.MAX_VALUE,p<f)return t;for(G=f;G<=p;++G)Bi(ji(S,b-1),ji(S,b),ji(S,G))&&Ni(ji(S,b+1),ji(S,b),ji(S,G))&&(u=Vi(ji(S,b),ji(S,G)))<d&&Ji(S,b,G)&&(d=u,m=G%e.length);b<m?(Hi(g,S,b,m+1),0!==m&&Hi(I,S,m,y.length),Hi(I,S,0,b+1)):(0!==b&&Hi(g,S,b,y.length),Hi(g,S,0,m+1),Hi(I,S,m,b+1))}return g.length<I.length?(sr(g,t,s,n,i,r,a),sr(I,t,s,n,i,r,a)):(sr(I,t,s,n,i,r,a),sr(g,t,s,n,i,r,a)),t}return t.push(e),t},nr=function(e,t){for(var s=0,n=e.length-1;e.length>3&&n>=0;--n)Wi(ji(e,n-1),ji(e,n),ji(e,n+1),t)&&(e.splice(n%e.length,1),s++);return s},ir=function(e,t){for(var s=e.length-1;s>=1;--s)for(var n=e[s],i=s-1;i>=0;--i)ar(n,e[i],t)&&e.splice(s,1)},rr=function(e,t,s){return s=s||0,Math.abs(e-t)<=s},ar=function(e,t,s){return rr(e[0],t[0],s)&&rr(e[1],t[1],s)};lineInt=Mi,lineSegmentsIntersect=ki,triangleArea=Li,isLeft=Fi,isLeftOn=Bi,isRight=Oi,isRightOn=Ni,collinear=Wi,sqdist=Vi,polygonAt=ji,polygonClear=Ui,polygonAppend=Hi,polygonMakeCCW=zi,polygonReverse=Xi,polygonIsReflex=Yi,polygonCanSee=qi,polygonCanSee2=Ji,polygonCopy=Ki,polygonGetCutEdges=$i,polygonDecomp=Zi,polygonSlice=Qi,polygonIsSimple=er,getIntersectionPoint=tr,polygonQuickDecomp=sr,polygonRemoveCollinearPoints=nr,polygonRemoveDuplicatePoints=ir,scalar_eq=rr,points_eq=ar,tmpPoint1=[],tmpPoint2=[],tmpLine1=[],tmpLine2=[],self.polyDecomp={decomp:Zi,quickDecomp:sr,isSimple:er,removeCollinearPoints:nr,removeDuplicatePoints:ir,makeCCW:zi}}{let lr=!1,cr=!1,hr="dev";const _r=Symbol("Construct internal API token");let ur=16;const dr=self.C3=class{constructor(){throw TypeError("static class can't be instantiated")}static _GetInternalAPIToken(){if(ur<=0)throw new Error("cannot obtain internal API token");return--ur,_r}static SetReady(){lr=!0}static IsReady(){return lr}static SetAppStarted(){cr=!0}static HasAppStarted(){return cr}static SetBuildMode(e){hr=e}static GetBuildMode(){return hr}static IsReleaseBuild(){return"final"===hr}};dr.isDebug=!1,dr.isDebugDefend=!1,dr.hardwareConcurrency=navigator.hardwareConcurrency||2,self.C3X={}}{const pr=self.C3;pr.QueryParser=class{constructor(e){this._queryString=e,this._parameters=new Map,this._Parse()}_Parse(){let e=this._queryString;(e.startsWith("?")||e.startsWith("#"))&&(e=e.substr(1));const t=e.split("&");for(const e of t)this._ParseParameter(e)}_ParseParameter(e){if(!e)return;if(!e.includes("="))return void this._parameters.set(e,null);const t=e.indexOf("="),s=decodeURIComponent(e.substring(0,t)),n=decodeURIComponent(e.substring(t+1));this._parameters.set(s,n)}LogAll(){for(const e of this._parameters)console.log("[QueryParser] Parameter '"+e[0]+"' = "+(null===e[1]?"null":"'"+e[1]+"'"))}Has(e){return this._parameters.has(e)}Get(e){const t=this._parameters.get(e);return void 0===t?null:t}ClearHash(){history.replaceState("",document.title,location.pathname+location.search)}Reparse(e){this._queryString=e,this._parameters.clear(),this._Parse()}},pr.QueryString=new pr.QueryParser(location.search),pr.LocationHashString=new pr.QueryParser(location.hash),pr.QueryString.Has("perf")&&(pr.isPerformanceProfiling=!0),"dev"!==pr.QueryString.Get("mode")&&pr.SetBuildMode("final")}{let fr=function(e){const t=parseFloat(e);return Ir.get(t)||(t>=13?"11":"NT "+e)};GetWindowsNTVersionName=fr;const mr=self.C3,gr="(unknown)";mr.Platform={OS:gr,OSVersion:gr,Browser:gr,BrowserVersion:gr,BrowserVersionNumber:NaN,BrowserEngine:gr,Context:"browser",IsDesktop:!0,IsMobile:!1,IsAppleOS:!1,IsIpadOS:!1,GetDetailedInfo:async()=>{}};const Ir=new Map([[5,"2000"],[5.1,"XP"],[5.2,"XP"],[6,"Vista"],[6.1,"7"],[6.2,"8"],[6.3,"8.1"],[10,"10"]]),Sr=navigator.userAgent,yr=navigator.userAgentData;if(yr&&yr.brands.length>0){let Gr=function(e){let t="",s="",n="",i="";for(const r of e){const e=vr.get(r.brand);!t&&e&&(t=e,s=r.version);const a=xr.get(r.brand);!n&&a&&(n=a,i=r.version)}t||"Chromium"!==n||(mr.Platform.Browser="Chromium",mr.Platform.BrowserVersion=i),mr.Platform.Browser=t||gr,mr.Platform.BrowserVersion=s||gr,mr.Platform.BrowserEngine=n||gr};ReadBrandList=Gr,mr.Platform.OS=yr.platform,mr.Platform.IsMobile=yr.mobile,mr.Platform.IsDesktop=!mr.Platform.IsMobile;const vr=new Map([["Google Chrome","Chrome"],["Microsoft Edge","Edge"],["Opera","Opera"],["Opera GX","Opera GX"],["Mozilla Firefox","Firefox"],["Apple Safari","Safari"],["NW.js","NW.js"]]),xr=new Map([["Chromium","Chromium"],["Gecko","Gecko"],["WebKit","WebKit"]]);Gr(yr.brands);let Tr=!1;mr.Platform.GetDetailedInfo=async()=>{if(!Tr)try{const e=await navigator.userAgentData.getHighEntropyValues(["platformVersion","fullVersionList"]);Gr(e.fullVersionList),"Windows"===mr.Platform.OS?mr.Platform.OSVersion=fr(e.platformVersion):mr.Platform.OSVersion=e.platformVersion,Tr=!0}catch(e){console.warn("Failed to get detailed user agent information: ",e)}}}else{let Cr=function(e,t){const s=Array.isArray(e)?e:[e];for(const e of s){const s=e.exec(Sr);if(s){t(s);break}}};RunTest=Cr,Cr(/windows\s+nt\s+([\d\.]+)/i,(e=>{mr.Platform.OS="Windows";const t=e[1];mr.Platform.OSVersion=fr(t)})),Cr(/mac\s+os\s+x\s+([\d\._]+)/i,(e=>{mr.Platform.OS="macOS",mr.Platform.OSVersion=e[1].replace(/_/g,".")})),Cr(/CrOS/,(()=>{mr.Platform.OS="Chrome OS"})),Cr(/linux|openbsd|freebsd|netbsd/i,(()=>{mr.Platform.OS="Linux"})),Cr(/android/i,(()=>{mr.Platform.OS="Android"})),Cr(/android\s+([\d\.]+)/i,(e=>{mr.Platform.OS="Android",mr.Platform.OSVersion=e[1]})),mr.Platform.OS===gr&&(Cr(/(iphone|ipod|ipad)/i,(e=>{mr.Platform.OS="iOS"})),Cr([/iphone\s+os\s+([\d\._]+)/i,/ipad[^)]*os\s+([\d\._]+)/i],(e=>{mr.Platform.OS="iOS",mr.Platform.OSVersion=e[1].replace(/_/g,".")})));const wr=/chrome\//i.test(Sr),Pr=/chromium\//i.test(Sr),Ar=/edg\//i.test(Sr),Rr=/OPR\//.test(Sr),Dr=/nwjs/i.test(Sr),Er=/safari\//i.test(Sr),Mr=/webkit/i.test(Sr);Ar||Rr||Cr(/chrome\/([\d\.]+)/i,(e=>{mr.Platform.Browser="Chrome",mr.Platform.BrowserVersion=e[1],mr.Platform.BrowserEngine="Chromium"})),Cr(/edg\/([\d\.]+)/i,(e=>{mr.Platform.Browser="Edge",mr.Platform.BrowserVersion=e[1],mr.Platform.BrowserEngine="Chromium"})),Cr(/OPR\/([\d\.]+)/,(e=>{mr.Platform.Browser="Opera",mr.Platform.BrowserVersion=e[1],mr.Platform.BrowserEngine="Chromium"})),Cr(/chromium\/([\d\.]+)/i,(e=>{mr.Platform.Browser="Chromium",mr.Platform.BrowserVersion=e[1],mr.Platform.BrowserEngine="Chromium"})),Cr(/nwjs\/[0-9.]+/i,(e=>{mr.Platform.Browser="NW.js",mr.Platform.BrowserVersion=e[1],mr.Platform.BrowserEngine="Chromium",mr.Platform.Context="nwjs"})),Cr(/firefox\/([\d\.]+)/i,(e=>{mr.Platform.Browser="Firefox",mr.Platform.BrowserVersion=e[1],mr.Platform.BrowserEngine="Gecko"})),!Er||wr||Pr||Ar||Rr||Dr||(mr.Platform.Browser="Safari",mr.Platform.BrowserEngine="WebKit",Cr(/version\/([\d\.]+)/i,(e=>{mr.Platform.BrowserVersion=e[1]})),Cr(/crios\/([\d\.]+)/i,(e=>{mr.Platform.Browser="Chrome for iOS",mr.Platform.BrowserVersion=e[1]})),Cr(/fxios\/([\d\.]+)/i,(e=>{mr.Platform.Browser="Firefox for iOS",mr.Platform.BrowserVersion=e[1]})),Cr(/edgios\/([\d\.]+)/i,(e=>{mr.Platform.Browser="Edge for iOS",mr.Platform.BrowserVersion=e[1]}))),mr.Platform.BrowserEngine===gr&&Mr&&(mr.Platform.BrowserEngine="WebKit"),"Android"===mr.Platform.OS&&"Safari"===mr.Platform.Browser&&(mr.Platform.Browser="Stock");const kr=new Set(["Windows","macOS","Linux","Chrome OS"]).has(mr.Platform.OS)||"nwjs"===mr.Platform.Context;mr.Platform.IsDesktop=kr,mr.Platform.IsMobile=!kr}"Chrome"===mr.Platform.Browser&&"browser"===mr.Platform.Context&&/wv\)/.test(Sr)&&(mr.Platform.Context="webview"),"nwjs"!==mr.Platform.Context&&"undefined"!=typeof window&&(window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches||navigator.standalone)&&(mr.Platform.Context="webapp"),mr.Platform.BrowserVersionNumber=parseFloat(mr.Platform.BrowserVersion);const br="macOS"===mr.Platform.OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2;br&&(mr.Platform.OS="iOS",mr.Platform.OSVersion=mr.Platform.BrowserVersion,mr.Platform.IsDesktop=!1,mr.Platform.IsMobile=!0,mr.Platform.IsIpadOS=!0),mr.Platform.IsAppleOS="macOS"===mr.Platform.OS||"iOS"===mr.Platform.OS}{let Lr=function(e){return new Promise(((t,s)=>{e.onsuccess=()=>t(e.result),e.onerror=()=>s(e.error)}))},Fr=function(e){return new Promise(((t,s)=>{e.oncomplete=()=>t(),e.onerror=()=>s(e.error),e.onabort=()=>s(e.error)}))},Br=function(e,t){return Yr(e,t)},Or=function(e,t){return Yr(e,t,!0)},Nr=function(e){Wr(e);let t=Hr.get(e);return t instanceof Promise||(t=qr(e),Hr.set(e,t),t.catch((t=>Hr.delete(e)))),t},Wr=function(e){if("string"!=typeof e)throw new TypeError("expected string")},Vr=function(e,t){const s=e.objectStore(Ur).openCursor();return new Promise((e=>{const n=[];s.onsuccess=s=>{const i=s.target.result;if(i){switch(t){case"entries":n.push([i.key,i.value]);break;case"keys":n.push(i.key);break;case"values":n.push(i.value)}i.continue()}else e(n)}}))};s=Lr,a=Fr,c=Br,i=Or,l=Nr,f=Wr,d=Vr;const jr=2,Ur="keyvaluepairs",Hr=new Map,zr="undefined"!=typeof IDBObjectStore&&"function"==typeof IDBObjectStore.prototype.getAll,Xr="undefined"!=typeof IDBObjectStore&&"function"==typeof IDBObjectStore.prototype.getAllKeys;async function Yr(e,t,s=!1,n=!0){const i=await Nr(e);try{return t(i.transaction([Ur],s?"readwrite":"readonly"))}catch(i){if(n&&"InvalidStateError"===i.name)return Hr.delete(e),Yr(e,t,s,!1);throw i}}async function qr(e){Wr(e);const t=indexedDB.open(e,jr);return t.addEventListener("upgradeneeded",(t=>{try{t.target.result.createObjectStore(Ur)}catch(t){console.error(`Failed to create objectstore for database ${e}`,t)}})),Lr(t)}class Jr{constructor(e){Wr(e),this.name=e}async ready(){await Nr(this.name)}set(e,t){return Wr(e),Or(this.name,(async s=>{const n=Lr(s.objectStore(Ur).put(t,e)),i=Fr(s);await Promise.all([i,n])}))}get(e){return Wr(e),Br(this.name,(async t=>{const s=Lr(t.objectStore(Ur).get(e)),n=Fr(t),[i,r]=await Promise.all([n,s]);return r}))}delete(e){return Wr(e),Or(this.name,(async t=>{const s=Lr(t.objectStore(Ur).delete(e)),n=Fr(t);await Promise.all([n,s])}))}clear(){return Or(this.name,(async e=>{const t=Lr(e.objectStore(Ur).clear()),s=Fr(e);await Promise.all([s,t])}))}keys(){return Br(this.name,(async e=>{let t;t=Xr?Lr(e.objectStore(Ur).getAllKeys()):Vr(e,"keys");const s=Fr(e),[n,i]=await Promise.all([s,t]);return i}))}values(){return Br(this.name,(async e=>{let t;t=zr?Lr(e.objectStore(Ur).getAll()):Vr(e,"values");const s=Fr(e),[n,i]=await Promise.all([s,t]);return i}))}entries(){return Br(this.name,(async e=>{const t=Vr(e,"entries"),s=Fr(e),[n,i]=await Promise.all([s,t]);return i}))}}self.KVStorageContainer=Jr}{let Kr=function(e){throw new Error(`"${e}" is not implemented`)},$r=function(e){if("function"==typeof e)throw new Error("localforage callback API is not implemented; please use the promise API instead")},Zr=function(e){return"object"==typeof e?new Promise((t=>{const{port1:s,port2:n}=new MessageChannel;n.onmessage=e=>t(e.data),s.postMessage(e)})):Promise.resolve(e)};r=Kr,a=$r,o=Zr;const Qr=self.KVStorageContainer,ea=[/no available storage method found/i,/an attempt was made to break through the security policy of the user agent/i,/the user denied permission to access the database/i,/a mutation operation was attempted on a database that did not allow mutations/i,/idbfactory\.open\(\) called in an invalid security context/i];class ta{constructor(e){this._inst=e,this._isInMemory=!this._inst,this._isInMemory||"undefined"!=typeof indexedDB||(this._isInMemory=!0,console.warn("Unable to use local storage because IndexedDB API is not available")),this._memoryStorage=new Map}_MaybeSwitchToMemoryFallback(e){if(!this._isInMemory)for(const t of ea)if(e&&t.test(e.message)){console.error("Unable to use local storage, reverting to in-memory store: ",e,e.message),this._isInMemory=!0;break}}async _getItemFallback(e){const t=this._memoryStorage.get(e),s=await Zr(t);return void 0===s?null:s}async _setItemFallback(e,t){t=await Zr(t),this._memoryStorage.set(e,t)}_removeItemFallback(e){this._memoryStorage.delete(e)}_clearFallback(){this._memoryStorage.clear()}_keysFallback(){return Array.from(this._memoryStorage.keys())}IsInMemory(){return this._isInMemory}GetMemoryStorage(){return this._memoryStorage}SetMemoryStorage(e){this._memoryStorage=e}async getItem(e,t){if($r(t),this._isInMemory)return await this._getItemFallback(e);let s;try{s=await this._inst.get(e)}catch(t){return this._MaybeSwitchToMemoryFallback(t),this._isInMemory?await this._getItemFallback(e):(console.error(`Error reading '${e}' from storage, returning null: `,t),null)}return void 0===s?null:s}async setItem(e,t,s){if($r(s),void 0===t&&(t=null),this._isInMemory)await this._setItemFallback(e,t);else try{await this._inst.set(e,t)}catch(s){if(this._MaybeSwitchToMemoryFallback(s),!this._isInMemory)throw s;await this._setItemFallback(e,t)}}async removeItem(e,t){if($r(t),this._isInMemory)this._removeItemFallback(e);else try{await this._inst.delete(e)}catch(t){this._MaybeSwitchToMemoryFallback(t),this._isInMemory?this._removeItemFallback(e):console.error(`Error removing '${e}' from storage: `,t)}}async clear(e){if($r(e),this._isInMemory)this._clearFallback();else try{await this._inst.clear()}catch(e){this._MaybeSwitchToMemoryFallback(e),this._isInMemory?this._clearFallback():console.error("Error clearing storage: ",e)}}async keys(e){if($r(e),this._isInMemory)return this._keysFallback();let t=[];try{t=await this._inst.keys()}catch(e){if(this._MaybeSwitchToMemoryFallback(e),this._isInMemory)return this._keysFallback();console.error("Error getting storage keys: ",e)}return t}ready(e){return $r(e),this._isInMemory?Promise.resolve(!0):this._inst.ready()}createInstance(e){if(e.forceInMemoryFallback)return new ta(null);{const t=e.name;if("string"!=typeof t)throw new TypeError("invalid store name");const s=new Qr(t);return new ta(s)}}length(e){Kr("localforage.length()")}key(e,t){Kr("localforage.key()")}iterate(e,t){Kr("localforage.iterate()")}setDriver(e){Kr("localforage.setDriver()")}config(e){Kr("localforage.config()")}defineDriver(e){Kr("localforage.defineDriver()")}driver(){Kr("localforage.driver()")}supports(e){Kr("localforage.supports()")}dropInstance(){Kr("localforage.dropInstance()")}}self.localforage=new ta(new Qr("localforage"))}{const sa=self.C3;if(sa.Supports={},sa.Supports.WebAnimations=(()=>{try{if("undefined"==typeof document)return!1;const e=document.createElement("div");return void 0!==e.animate&&void 0!==e.animate([{opacity:"0"},{opacity:"1"}],1e3).reverse}catch(e){return!1}})(),sa.Supports.DialogElement="undefined"!=typeof HTMLDialogElement,sa.Supports.RequestIdleCallback=!!self.requestIdleCallback,sa.Supports.ImageBitmap=!!self.createImageBitmap,sa.Supports.ImageBitmapOptions=!1,sa.Supports.ImageBitmapOptionsResize=!1,sa.Supports.ImageBitmap){try{self.createImageBitmap(new ImageData(32,32),{premultiplyAlpha:"none"}).then((()=>{sa.Supports.ImageBitmapOptions=!0})).catch((()=>{sa.Supports.ImageBitmapOptions=!1}))}catch(na){sa.Supports.ImageBitmapOptions=!1}try{self.createImageBitmap(new ImageData(32,32),{resizeWidth:10,resizeHeight:10}).then((e=>{sa.Supports.ImageBitmapOptionsResize=10===e.width&&10===e.height})).catch((()=>{sa.Supports.ImageBitmapOptionsResize=!1}))}catch(ia){sa.Supports.ImageBitmapOptionsResize=!1}}if(sa.Supports.ClipboardReadText=!(!navigator.clipboard||!navigator.clipboard.readText),sa.Supports.PermissionsQuery=!(!navigator.permissions||!navigator.permissions.query),sa.Supports.ClipboardPermissionsQuery=!1,sa.Supports.PermissionsQuery){const ra={name:"clipboard-read"};navigator.permissions.query(ra).then((()=>{sa.Supports.ClipboardPermissionsQuery=!0})).catch((()=>{sa.Supports.ClipboardPermissionsQuery=!1}))}sa.Supports.AsyncClipboardApi=!!(navigator.permissions&&navigator.clipboard&&self.ClipboardItem),sa.Supports.Proxies="undefined"!=typeof Proxy,sa.Supports.DownloadAttribute="undefined"!=typeof document&&void 0!==document.createElement("a").download,sa.Supports.Fetch="function"==typeof fetch,sa.Supports.PersistentStorage=!!(self.isSecureContext&&"Opera"!==sa.Platform.Browser&&navigator.storage&&navigator.storage.persist),sa.Supports.StorageQuotaEstimate=!!(self.isSecureContext&&navigator.storage&&navigator.storage.estimate),sa.Supports.Fullscreen=(()=>{if("undefined"==typeof document)return!1;if("iOS"===sa.Platform.OS)return!1;const e=document.documentElement;return!!(e.requestFullscreen||e.msRequestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullscreen)})(),sa.Supports.ImageDecoder=void 0!==self.ImageDecoder,sa.Supports.WebCodecs=!!self.VideoEncoder,sa.Supports.NativeFileSystemAPI=!!self.showOpenFilePicker,sa.Supports.QueryLocalFonts=!!self.queryLocalFonts,sa.Supports.UserActivation=!!navigator.userActivation,sa.Supports.CanvasToBlobWebP=!1,(async()=>{let e;"undefined"==typeof document?e=new OffscreenCanvas(32,32):(e=document.createElement("canvas"),e.width=32,e.height=32);const t=e.getContext("2d");t.fillStyle="blue",t.fillRect(0,0,32,32);let s=null;try{e.convertToBlob?s=await e.convertToBlob({type:"image/webp",quality:1}):e.toBlob&&(s=await new Promise((t=>e.toBlob(t,"image/webp",1)))),sa.Supports.CanvasToBlobWebP=s&&"image/webp"===s.type}catch(e){sa.Supports.CanvasToBlobWebP=!1}})()}{const aa=self.C3;if(!String.prototype.trimStart){const oa=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*/;String.prototype.trimStart=function(){return this.replace(oa,"")}}if(!String.prototype.trimEnd){const la=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimEnd=function(){return this.replace(la,"")}}if(String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(aa.EscapeRegex(e),"g"),t)}),Array.prototype.values||(Array.prototype.values=function*(){for(const e of this)yield e}),!Array.prototype.flat){let ca=function(e,t){return e.reduce(((e,s)=>t>0&&Array.isArray(s)?(Array.prototype.push.apply(e,ca(s,t-1)),e):(e.push(s),e)),[])};arrayFlat=ca,Array.prototype.flat=function(e=1){return ca(this,e)}}Array.prototype.at||(Array.prototype.at=function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]}),String.prototype.at||(String.prototype.at=function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]}),RegExp.escape||(RegExp.escape=function(e){return String(e).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}),Set.prototype.isSubsetOf||(Set.prototype.isSubsetOf=function(e){if(!(e instanceof Set))throw new TypeError("argument must be a Set");for(const t of this)if(!e.has(t))return!1;return!0}),navigator.storage&&!navigator.storage.estimate&&navigator.webkitTemporaryStorage&&navigator.webkitTemporaryStorage.queryUsageAndQuota&&(navigator.storage.estimate=function(){return new Promise(((e,t)=>navigator.webkitTemporaryStorage.queryUsageAndQuota(((t,s)=>e({usage:t,quota:s})),t)))}),void 0===self.isSecureContext&&(self.isSecureContext="https:"===location.protocol),void 0===self.globalThis&&(self.globalThis=self)}{let ha=function(e){let t="Assertion failure: "+e+"\n\nStack trace:\n"+_a.GetCallStack();console.error(t)};assertFail=ha;const _a=self.C3;self.assert=function(e,t){e||ha(t)}}{const ua=self.C3,da=self.C3X;ua.IsNumber=function(e){return"number"==typeof e},ua.IsFiniteNumber=function(e){return ua.IsNumber(e)&&isFinite(e)},ua.RequireNumber=function(e){if(!ua.IsNumber(e))throw new TypeError("expected number")},ua.RequireOptionalNumber=function(e){ua.IsNullOrUndefined(e)},ua.RequireNumberInRange=function(e,t,s){if(!ua.IsNumber(e)||isNaN(e)||t>e||s<e)throw new RangeError("number outside of range")},ua.RequireAllNumber=function(...e){for(let t of e);},ua.RequireFiniteNumber=function(e){if(!ua.IsFiniteNumber(e))throw new TypeError("expected finite number")},ua.RequireOptionalFiniteNumber=function(e){ua.IsNullOrUndefined(e)},ua.RequireAllFiniteNumber=function(...e){for(let t of e);},ua.IsString=function(e){return"string"==typeof e},ua.RequireString=function(e){if(!ua.IsString(e))throw new TypeError("expected string")},ua.RequireOptionalString=function(e){ua.IsNullOrUndefined(e)},ua.RequireAllString=function(...e){for(let t of e);},ua.IsSimpleObject=function(e){if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return t?t.constructor===Object:null===t},ua.RequireSimpleObject=function(e){if(!ua.IsSimpleObject(e))throw new TypeError("expected simple object")},ua.RequireOptionalSimpleObject=function(e){if(!ua.IsNullOrUndefined(e)&&!ua.IsSimpleObject(e))throw new TypeError("expected simple object")},ua.IsObject=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)},ua.RequireObject=function(e){if(!ua.IsObject(e))throw new TypeError("expected object")},ua.RequireOptionalObject=function(e){ua.IsNullOrUndefined(e)},ua.RequireAllObject=function(...e){for(let t of e);},ua.IsFileLike=function(e){return ua.WeakIsInstanceOf(e,Blob)&&"string"==typeof e.name},ua.RequireFileLike=function(e){if(!ua.IsFileLike(e))throw new TypeError("expected file")},ua.RequireOptionalFileLike=function(e){ua.IsNullOrUndefined(e)},ua.IsArray=function(e){return Array.isArray(e)},ua.RequireArray=function(e){if(!ua.IsArray(e))throw new TypeError("expected array")},ua.RequireOptionalArray=function(e){ua.IsNullOrUndefined(e)},ua.RequireAllArray=function(...e){for(let t of e);},ua.Is2DArray=function(e){return!(!ua.IsArray(e)||e.length&&!ua.IsArray(e[0]))},ua.Require2DArray=function(e){if(!ua.Is2DArray(e))throw new TypeError("expected 2d array");for(let t of e)if(!ua.IsArray(t))throw new TypeError("expected 2d array")},ua.RequireOptional2DArray=function(e){ua.IsNullOrUndefined(e)},ua.IsFunction=function(e){return"function"==typeof e},ua.RequireFunction=function(e,t){if(!ua.IsFunction(e))throw new TypeError("expected function");if(!ua.IsNullOrUndefined(t)&&e!==t)throw new TypeError("expected same function reference")},ua.RequireOptionalFunction=function(e){ua.IsNullOrUndefined(e)},ua.RequireAllFunction=function(...e){for(let t of e);},ua.RequireAnyFunction=function(e,...t){if(!ua.IsFunction(e))throw new TypeError("expected function");if(!t.length)throw new Error("missing comparison functions");for(let s of t)if(!ua.IsNullOrUndefined(s)&&e===s)return;throw new TypeError("expected same function reference")},ua.RequireOptionalAllFunction=function(...e){if(!ua.IsNullOrUndefined(e))for(let t of e);},ua.IsInstanceOf=function(e,t){return e instanceof t},ua.IsInstanceOfAny=function(e,...t){for(let s of t)if(ua.IsInstanceOf(e,s))return!0;return!1},ua.RequireInstanceOf=function(e,t){if(!ua.IsInstanceOf(e,t))throw new TypeError("unexpected type")},ua.RequireOptionalInstanceOf=function(e,t){ua.IsNullOrUndefined(e)},ua.RequireAllInstanceOf=function(e,...t){for(let e of t);},ua.RequireAnyInstanceOf=function(e,...t){if(!ua.IsInstanceOfAny(e,...t))throw new TypeError("unexpected type")},ua.RequireAnyOptionalInstanceOf=function(e,...t){if(!ua.IsNullOrUndefined(e)&&!ua.IsInstanceOfAny(e,...t))throw new TypeError("unexpected type")},ua.IsArrayOf=function(e,t){for(let s of e)if(!ua.IsInstanceOf(s,t))return!1;return!0},ua.IsArrayOfFiniteNumbers=function(e){for(let t of e)if(!ua.IsFiniteNumber(t))return!1;return!0},ua.RequireArrayOf=function(e,t){for(let t of e);},ua.RequireOptionalArrayOf=function(e,t){if(!ua.IsNullOrUndefined(e))for(let t of e);},ua.RequireOptionalArrayOfFunctions=function(e,t){if(!ua.IsNullOrUndefined(e))for(let t of e);},ua.RequireArrayOfAny=function(e,...t){for(let t of e);},ua.RequireOptionalArrayOfAny=function(e,...t){if(!ua.IsNullOrUndefined(e))for(let t of e);},ua.IsDOMNode=function(e,t){return!(ua.IsNullOrUndefined(e)||!ua.IsString(e.nodeName))&&(!t||ua.equalsNoCase(e.nodeName,t))},ua.RequireDOMNode=function(e,t){if(ua.IsNullOrUndefined(e)||!ua.IsString(e.nodeName))throw new TypeError("expected DOM node");if(t&&!ua.equalsNoCase(e.nodeName,t))throw new TypeError(`expected DOM '${t}' node`)},ua.RequireOptionalDOMNode=function(e,t){ua.IsNullOrUndefined(e)},ua.IsHTMLElement=function(e,t){return!(ua.IsNullOrUndefined(e)||!ua.IsString(e.tagName))&&(!t||ua.equalsNoCase(e.tagName,t))},ua.RequireHTMLElement=function(e,t){if(ua.IsNullOrUndefined(e)||!ua.IsString(e.tagName))throw new TypeError("expected HTML element");if(t&&!ua.equalsNoCase(e.tagName,t))throw new TypeError(`expected HTML '${t}' element`)},ua.RequireOptionalHTMLElement=function(e,t){ua.IsNullOrUndefined(e)},ua.IsDrawable=function(e){return ua.IsHTMLElement(e,"img")||ua.IsHTMLElement(e,"canvas")||ua.IsHTMLElement(e,"video")||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap},ua.RequireDrawable=function(e){if(!ua.IsDrawable(e))throw new TypeError("expected drawable")},ua.RequireOptionalDrawable=function(e){ua.IsNullOrUndefined(e)},ua.IsDrawableOrImageData=function(e){return e instanceof ImageData||ua.IsDrawable(e)},ua.RequireDrawableOrImageData=function(e){if(!ua.IsDrawableOrImageData(e))throw new TypeError("expected drawable or image data")},ua.RequireOptionalDrawableOrImageData=function(e){if(!ua.IsNullOrUndefined(e)&&!ua.IsDrawableOrImageData(e))throw new TypeError("expected drawable or image data")},ua.IsStringLike=function(e){return"string"==typeof e||ua.HtmlString&&e instanceof ua.HtmlString||e instanceof ua.BBString},ua.RequireStringLike=function(e){if(!ua.IsStringLike(e))throw new TypeError("expected string-like")},ua.RequireOptionalStringLike=function(e){ua.IsNullOrUndefined(e)},ua.RequireAllStringLike=function(...e){for(let t of e);},ua.RequireOverride=function(){throw new Error("must be overridden")},ua.NotYetImplemented=function(){throw new Error("not yet implemented")},ua.IsGeneratorFunction=function(e){return e.constructor===function*(){}.constructor},ua.RequireGeneratorFunction=function(e){if(!ua.IsGeneratorFunction(e))throw new Error("expected generator function")},ua.IsIterable=function(e){return"function"===e[Symbol.iterator]},ua.RequireIterable=function(e){if(!ua.IsIterable(e))throw new Error("expected iterable")},ua.IsDefined=function(e){return!ua.IsNullOrUndefined(e)},ua.IsNullOrUndefined=function(e){return null==e},ua.AreArrayElementsOfSameType=function(e){let t=e[0].constructor;for(let s of e)if(s.constructor!==t)return!1;return t},ua.AreArrayElementsOfType=function(e,t){for(let s of e)if(!(s instanceof t))return!1;return!0};const pa=Object.getPrototypeOf(Uint8Array);ua.IsTypedArray=function(e){return ua.IsInstanceOf(e,pa)},ua.RequireTypedArray=function(e){},ua.WeakRequireTypedArray=function(e){ua.WeakRequireInstanceOf(e,pa)},ua.WeakRequireAnyInstanceOf=function(e,...t){if(!ua.WeakIsAnyInstanceOf(e,...t))throw new TypeError("unexpected type")},ua.WeakIsAnyInstanceOf=function(e,...t){for(const s of t)if(ua.WeakIsInstanceOf(e,s))return!0;return!1},ua.WeakRequireInstanceOf=function(e,t){if(!ua.WeakIsInstanceOf(e,t))throw new TypeError("unexpected type")},ua.WeakIsInstanceOf=function(e,t){for(;e=Object.getPrototypeOf(e);)if(e.constructor.name===t.name)return!0;return!1},da.RequireNumber=ua.RequireNumber,da.RequireOptionalNumber=ua.RequireOptionalNumber,da.RequireFiniteNumber=ua.RequireFiniteNumber,da.RequireOptionalFiniteNumber=ua.RequireOptionalFiniteNumber,da.RequireString=ua.RequireString,da.RequireOptionalString=ua.RequireOptionalString,da.RequireObject=ua.RequireObject,da.RequireOptionalObject=ua.RequireOptionalObject,da.RequireArray=ua.RequireArray,da.RequireOptionalArray=ua.RequireOptionalArray,da.RequireFunction=ua.RequireFunction,da.RequireOptionalFunction=ua.RequireOptionalFunction,da.RequireInstanceOf=ua.RequireInstanceOf,da.RequireOptionalInstanceOf=ua.RequireOptionalInstanceOf,da.IsNullOrUndefined=ua.IsNullOrUndefined}{let fa=function(e,t){let s=ya.getType(e),n=ya.getType(t);return"null"===s||"null"===n||"undefined"!==s&&"undefined"!==n&&s===n},ma=function(e){console.warn("[Defence] "+e+" @",ya.GetCallStack())},ga=function(){if(Pa=-1,va.size>0||xa.size>0){let e=[...new Set([...va.keys()].map((e=>ya.getName(e))))].join(",");console.warn(`An object derived from DefendedBase was not protected with debugDefend(). This will disable some checks. See the coding guidelines! Possible affected class names: ${e}`),va.clear(),xa.clear()}},Ia=function(e){let t=new Set;for(let s in e)t.add(s);return t},Sa=function(e,t){let s=Ia(t),n=Aa.get(e);if(n){let t=[];for(let e of n.values())s.has(e)?s.delete(e):t.push(e);ya.appendArray(t,[...s]),t.length&&console.warn(`[Defence] '${ya.getName(e)}' constructor creates inconsistent properties: ${t.join(", ")}`)}else Aa.set(e,s)};isValidTypeChange=fa,logDefendedObjectWarning=ma,CheckDefendedObjectsUsedCorrectly=ga,getObjectPropertySet=Ia,VerifyObjectPropertiesConsistent=Sa;const ya=self.C3,ba=new Map;let Ga;ya.ColorLog=function(e,t){console.log(`%c${e}`,`font-weight: bold; color:${t}`)},ya.RafLog=function(e,...t){ba.has(e)||ba.set(e,-1),-1===ba.get(e)&&ba.set(e,requestAnimationFrame((()=>{console.log(`%c${e}`,"font-weight: bold",...t),ba.set(e,-1)})))},ya.StartMeasure=function(e){performance.mark(e),Ga||(Ga=new Map),Ga.has(e)||Ga.set(e,{current:0,total:0,average:0,calls:1,toString:function(){return`${e} :: current => ${this.current.toPrecision(3)} :: average => ${this.average.toPrecision(3)} :: calls => ${this.calls}`}})},ya.EndMeasure=function(e){performance.measure(`measure-${e}`,e);const t=performance.getEntriesByName(`measure-${e}`)[0],s=Ga.get(e);s.current=t.duration,s.total+=s.current,s.average=s.total/s.calls,console.log(s.toString()),s.calls++,performance.clearMarks(e),performance.clearMeasures(`measure-${e}`)},ya.GetCallStack=function(){return(new Error).stack},ya.Debugger=function(){},ya.cast=function(e,t){return e&&e instanceof t?e:null},ya.getName=function(e){return void 0===e?"undefined":null===e?"null":"boolean"==typeof e?"<boolean>":ya.IsNumber(e)?"<number>":ya.IsString(e)?"<string>":ya.IsArray(e)?"<array>":"symbol"==typeof e?"<"+e.toString()+">":ya.IsFunction(e)?e.name&&"Function"!==e.name?e.name:"<anonymous function>":"object"==typeof e?e.constructor&&e.constructor.name&&"Object"!==e.constructor.name?e.constructor.name:"<anonymous object>":"<unknown>"},ya.getType=function(e){return null===e?"null":Array.isArray(e)?"array":typeof e},ya.range=function*(e,t){if(!isFinite(Math.abs(e-t)))throw new Error("Invalid parameters");if(e>t)for(let s=e-1;s>=t;s--)yield s;else for(let s=e;s<t;s++)yield s};let va=new Map,xa=new Map,Ta=new WeakMap,Ca=new WeakMap;ya.DefendHandler={};const wa=new Set(["then","splice"]);ya.DefendHandler.get=function(e,t){return t in e||"symbol"==typeof t||wa.has(t)||ma(`Accessed missing property '${t}' from defended object '${ya.getName(e)}', returning undefined`),Ca.has(e)&&"symbol"!=typeof t&&!wa.has(t)&&ma(`Accessed property '${t}' on a released object '${ya.getName(e)}'\nObject was originally released at: ${Ca.get(e)})\nCall stack at access: `),e[t]},ya.DefendHandler.set=function(e,t,s){return t in e||va.has(e)||ma(`Set non-existent property '${t}' to '${s}' on defended object '${ya.getName(e)}'`),fa(e[t],s)||va.has(e)||ma(`Set '${ya.getType(e[t])}' property '${t}' to type '${ya.getType(s)}' on defended object '${ya.getName(e)}'`),Ca.has(e)&&ma(`Set property '${t}' on a released object '${ya.getName(e)}'\nObject was originally released at: ${Ca.get(e)})\nCall stack at access: `),e[t]=s,!0},ya.DefendHandler.deleteProperty=function(e,t){throw new ReferenceError(`Cannot delete property '${t}' from defended object '${ya.getName(e)}'`)},ya.DefendHandler.defineProperty=function(e,t,s){throw new ReferenceError(`Cannot define property '${t}' on defended object '${ya.getName(e)}'`)},ya.DefendHandler.enumerate=function(e){throw new ReferenceError(`Cannot enumerate defended object '${ya.getName(e)}'`)};let Pa=-1;ya.DefendedBase=class{constructor(){if(!ya.isDebugDefend||!ya.Supports.Proxies)return;let e=new.target,t=Object.create(e.prototype),s=new Proxy(t,ya.DefendHandler);return va.set(t,s),xa.set(s,t),Ta.set(s,t),-1===Pa&&(Pa=requestAnimationFrame(ga)),s}},ya.debugDefend=function(e){if(ya.isDebugDefend&&ya.Supports.Proxies&&e instanceof ya.DefendedBase){if(!xa.has(e))return e;let t=xa.get(e);return xa.delete(e),va.delete(t),e}return ya.isDebug?Object.seal(e):e},ya.New=function(e,...t){let s;try{s=new e(...t)}catch(e){throw xa.clear(),va.clear(),e}return ya.isDebugDefend&&Sa(e,s),ya.debugDefend(s)},ya.Release=function(e){let t=Ta.get(e);t&&Ca.set(t,ya.GetCallStack())},ya.WasReleased=function(e){let t=Ta.get(e);return!!t&&!!Ca.get(t)};let Aa=new Map;ya.PerfMark=class{constructor(e){this._name="",e&&this.start(e)}start(e){ya.isPerformanceProfiling&&(this._name=e,performance.mark(this._name+"-Start"))}end(){ya.isPerformanceProfiling&&(performance.mark(this._name+"-End"),performance.measure(this._name,this._name+"-Start",this._name+"-End"))}next(e){ya.isPerformanceProfiling&&(this.end(),this._name=e,performance.mark(this._name+"-Start"))}}}{let Ra=function(e){return 0===e&&1/e<0};isNegativeZero=Ra;const Da=self.C3,Ea=2*Math.PI,Ma=Math.PI/180,ka=180/Math.PI;Da.wrap=function(e,t,s){e=Math.floor(e),t=Math.floor(t);const n=(s=Math.floor(s))-t;if(0===n)return s;if(e<t){const i=s-(t-e)%n;return i===s?0:i}return t+(e-t)%n},Da.mapToRange=function(e,t,s,n,i){const r=s-t;return 0===r&&0===n?e:(e-t)*(i-n)/r+n},Da.normalize=function(e,t,s){return t-s==0?1:(e-t)/(s-t)},Da.clamp=function(e,t,s){return e<t?t:e>s?s:e},Da.clampAngle=function(e){return(e%=Ea)<0&&(e+=Ea),e},Da.toRadians=function(e){return e*Ma},Da.toDegrees=function(e){return e*ka},Da.hypot2DFast=function(e,t){return Math.sqrt(e*e+t*t)},Da.hypot3DFast=function(e,t,s){return Math.sqrt(e*e+t*t+s*s)},Da.distanceTo=function(e,t,s,n){return Da.hypot2DFast(s-e,n-t)},Da.distanceSquared=function(e,t,s,n){const i=s-e,r=n-t;return i*i+r*r},Da.angleTo=function(e,t,s,n){return Math.atan2(n-t,s-e)},Da.angleDiff=function(e,t){if(e===t)return 0;let s=Math.sin(e),n=Math.cos(e),i=s*Math.sin(t)+n*Math.cos(t);return i>=1?0:i<=-1?Math.PI:Math.acos(i)},Da.angleRotate=function(e,t,s){let n=Math.sin(e),i=Math.cos(e),r=Math.sin(t),a=Math.cos(t);return Math.acos(n*r+i*a)>s?i*r-n*a>0?Da.clampAngle(e+s):Da.clampAngle(e-s):Da.clampAngle(t)},Da.angleClockwise=function(e,t){let s=Math.sin(e);return Math.cos(e)*Math.sin(t)-s*Math.cos(t)<=0},Da.angleLerp=function(e,t,s,n=0){let i=Da.angleDiff(e,t);const r=Ea*n;return Da.angleClockwise(t,e)?Da.clampAngle(e+(i+r)*s):Da.clampAngle(e-(i+r)*s)},Da.angleLerpClockwise=function(e,t,s,n=0){const i=Da.angleDiff(e,t),r=Ea*n;return Da.angleClockwise(t,e)?Da.clampAngle(e+(i+r)*s):Da.clampAngle(e+(Ea-i+r)*s)},Da.angleLerpAntiClockwise=function(e,t,s,n=0){const i=Da.angleDiff(e,t),r=Ea*n;return Da.angleClockwise(t,e)?Da.clampAngle(e-(-Ea+i-r)*s):Da.clampAngle(e-(i+r)*s)},Da.angleReflect=function(e,t){const s=Da.angleDiff(e,t);return Da.angleClockwise(e,t)?Da.clampAngle(t-s):Da.clampAngle(t+s)},Da.lerp=function(e,t,s){return e+s*(t-e)},Da.unlerp=function(e,t,s){return e===t?0:(s-e)/(t-e)},Da.relerp=function(e,t,s,n,i){return Da.lerp(n,i,Da.unlerp(e,t,s))},Da.qarp=function(e,t,s,n){return Da.lerp(Da.lerp(e,t,n),Da.lerp(t,s,n),n)},Da.cubic=function(e,t,s,n,i){return Da.lerp(Da.qarp(e,t,s,i),Da.qarp(t,s,n,i),i)},Da.cosp=function(e,t,s){return(e+t+(e-t)*Math.cos(s*Math.PI))/2},Da.isPOT=function(e){return e>0&&!(e-1&e)},Da.nextHighestPowerOfTwo=function(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1},Da.roundToNearestFraction=function(e,t){return Math.round(e*t)/t},Da.floorToNearestFraction=function(e,t){return Math.floor(e*t)/t},Da.roundToDp=function(e,t){t=Math.max(Math.floor(t),0);const s=Math.pow(10,t);return Math.round(e*s)/s},Da.countDecimals=function(e){return Math.floor(e)!==e&&e.toString().split(".")[1].length||0},Da.toFixed=function(e,t){let s=e.toFixed(t),n=s.length-1;for(;n>=0&&"0"===s.charAt(n);--n);return n>=0&&"."===s.charAt(n)&&--n,n<0?s:s.substr(0,n+1)},Da.PackRGB=function(e,t,s){return Da.clamp(e,0,255)|Da.clamp(t,0,255)<<8|Da.clamp(s,0,255)<<16};const La=1024,Fa=1023,Ba=16384,Oa=8191,Na=-8192;Da.PackRGBAEx=function(e,t,s,n){return(e=Da.clamp(Math.floor(1024*e),-8192,8191))<0&&(e+=16384),(t=Da.clamp(Math.floor(1024*t),-8192,8191))<0&&(t+=16384),(s=Da.clamp(Math.floor(1024*s),-8192,8191))<0&&(s+=16384),-(16384*e*16384*1024+16384*t*1024+1024*s+(n=Da.clamp(Math.floor(1023*n),0,1023)))},Da.PackRGBEx=function(e,t,s){return Da.PackRGBAEx(e,t,s,1)},Da.GetRValue=function(e){if(e>=0)return(255&e)/255;{let t=Math.floor(-e/274877906944);return t>8191&&(t-=16384),t/1024}},Da.GetGValue=function(e){if(e>=0)return((65280&e)>>8)/255;{let t=Math.floor(-e%274877906944/16777216);return t>8191&&(t-=16384),t/1024}},Da.GetBValue=function(e){if(e>=0)return((16711680&e)>>16)/255;{let t=Math.floor(-e%16777216/1024);return t>8191&&(t-=16384),t/1024}},Da.GetAValue=function(e){return Ra(e)?0:e>=0?1:Math.floor(-e%1024)/1023},Da.greatestCommonDivisor=function(e,t){for(e=Math.floor(e),t=Math.floor(t);0!==t;){let s=t;t=e%t,e=s}return e};const Wa=[[3,2],[4,3],[5,4],[5,3],[6,5],[14,9],[16,9],[16,10],[21,9]];Da.getAspectRatio=function(e,t){if((e=Math.floor(e))===(t=Math.floor(t)))return[1,1];for(let s of Wa){let n=e/s[0]*s[1];if(Math.abs(t-n)<1)return s.slice(0);if(n=e/s[1]*s[0],Math.abs(t-n)<1)return[s[1],s[0]]}let s=Da.greatestCommonDivisor(e,t);return[e/s,t/s]},Da.segmentsIntersect=function(e,t,s,n,i,r,a,o){const l=Math.min(e,s),c=Math.max(e,s),h=Math.min(i,a),_=Math.max(i,a);if(c<h||l>_)return!1;const u=Math.min(t,n),d=Math.max(t,n),p=Math.min(r,o),f=Math.max(r,o);if(d<p||u>f)return!1;const m=i-e+a-s,g=r-t+o-n,I=s-e,S=n-t,y=a-i,b=o-r,G=Math.abs(S*y-b*I),v=y*g-b*m;if(Math.abs(v)>G)return!1;const x=I*g-S*m;return Math.abs(x)<=G},Da.segmentsIntersectPreCalc=function(e,t,s,n,i,r,a,o,l,c,h,_){const u=Math.min(l,h),d=Math.max(l,h);if(r<u||i>d)return!1;const p=Math.min(c,_),f=Math.max(c,_);if(o<p||a>f)return!1;const m=l-e+h-s,g=c-t+_-n,I=s-e,S=n-t,y=h-l,b=_-c,G=Math.abs(S*y-b*I),v=y*g-b*m;if(Math.abs(v)>G)return!1;const x=I*g-S*m;return Math.abs(x)<=G},Da.segmentIntersectsQuad=function(e,t,s,n,i){const r=Math.min(e,s),a=Math.max(e,s),o=Math.min(t,n),l=Math.max(t,n),c=i.getTlx(),h=i.getTly(),_=i.getTrx(),u=i.getTry(),d=i.getBrx(),p=i.getBry(),f=i.getBlx(),m=i.getBly();return Da.segmentsIntersectPreCalc(e,t,s,n,r,a,o,l,c,h,_,u)||Da.segmentsIntersectPreCalc(e,t,s,n,r,a,o,l,_,u,d,p)||Da.segmentsIntersectPreCalc(e,t,s,n,r,a,o,l,d,p,f,m)||Da.segmentsIntersectPreCalc(e,t,s,n,r,a,o,l,f,m,c,h)},Da.segmentIntersectsAnyN=function(e,t,s,n,i){const r=Math.min(e,s),a=Math.max(e,s),o=Math.min(t,n),l=Math.max(t,n);let c=0;for(let h=i.length-4;c<=h;c+=2)if(Da.segmentsIntersectPreCalc(e,t,s,n,r,a,o,l,i[c],i[c+1],i[c+2],i[c+3]))return!0;return Da.segmentsIntersectPreCalc(e,t,s,n,r,a,o,l,i[c],i[c+1],i[0],i[1])};const Va=2,ja=1e-6;Da.rayIntersect=function(e,t,s,n,i,r,a,o){const l=s-e,c=o-r,h=l*c-(n-t)*(a-i);if(0===h)return 2;const _=((t-n)*(a-e)+l*(o-t))/h;return 0<_&&_<1.000001?(c*(a-e)+(i-a)*(o-t))/h:2},Da.rayIntersectExtended=function(e,t,s,n,i,r,a,o,l){const c=(a-i)*l,h=(o-r)*l;return Da.rayIntersect(e,t,s,n,i-c,r-h,a+c,o+h)},Da.isPointInTriangleInclusive=function(e,t,s,n,i,r,a,o){const l=i-s,c=r-n,h=a-s,_=o-n,u=e-s,d=t-n,p=l*l+c*c,f=l*h+c*_,m=l*u+c*d,g=h*h+_*_,I=h*u+_*d,S=1/(p*g-f*f),y=(g*m-f*I)*S,b=(p*I-f*m)*S;return y>=0&&b>=0&&y+b<=1},Da.triangleCartesianToBarycentric=function(e,t,s,n,i,r,a,o){const l=i-s,c=r-n,h=a-s,_=o-n,u=e-s,d=t-n,p=l*l+c*c,f=l*h+c*_,m=h*h+_*_,g=u*l+d*c,I=u*h+d*_,S=p*m-f*f,y=(m*g-f*I)/S,b=(p*I-f*g)/S;return[1-y-b,y,b]},Da.triangleBarycentricToCartesian3d=function(e,t,s,n,i,r,a,o,l,c,h,_){return[e*n+t*a+s*c,e*i+t*o+s*h,e*r+t*l+s*_]}}{const Ua=self.C3;let Ha=null,za="";if("undefined"!=typeof document){Ha=document;const $a=document.querySelector("base");za=$a&&$a.hasAttribute("href")?$a.getAttribute("href"):"",za&&(za.startsWith("/")&&(za=za.substr(1)),za.endsWith("/")||(za+="/"))}Ua.GetBaseHref=function(){return za},Ua.GetBaseURL=function(){if(!Ha)return"";const e=Ha.location;return Ua.GetPathFromURL(e.origin+e.pathname)+za},Ua.GetPathFromURL=function(e){if(!e.length)return e;if(e.endsWith("/")||e.endsWith("\\"))return e;const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return-1===t?"":e.substr(0,t+1)},Ua.GetFilenameFromURL=function(e){if(!e.length)return e;if(e.endsWith("/")||e.endsWith("\\"))return"";const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return-1===t?e:e.substr(t+1)},Ua.GetFileExtension=function(e){let t=e.lastIndexOf(".");return t<1?"":e.substr(t)},Ua.SetFileExtension=function(e,t){const s=e.lastIndexOf(".");return-1===s?e+"."+t:e.substr(0,s+1)+t},Ua.GetFileNamePart=function(e){let t=e.lastIndexOf(".");return t<1?e:e.substr(0,t)},Ua.NormalizeFileSeparator=function(e){return e.replace(/\\/g,"/")},Ua.IsFileExtension=function(e,t){return t===(e?Ua.GetFileExtension(e).slice(1):"")},Ua.FileNameEquals=function(e,t){let s,n;return Ua.IsFileLike(e)&&(s=Ua.GetFileNamePart(e.name)),Ua.IsString(e)&&(s=Ua.GetFileNamePart(e)),Ua.IsFileLike(t)&&(n=Ua.GetFileNamePart(t.name)),Ua.IsString(t)&&(n=Ua.GetFileNamePart(t)),s===n},Ua.ParseFilePath=function(e){e=Ua.NormalizeFileSeparator(e);let t=/^\w\:\//.exec(e);t?(t=t[0],"/"!==(e=e.slice(3))[0]&&(e="/"+e)):t="",(e=e.replace(/\/{2,}/g,"/")).length>1&&"/"===e.slice(-1)&&(e=e.slice(0,-1));const s=e.lastIndexOf("/")+1;let n,i="",r=e,a="";s>0&&(i=e.slice(0,s),r=e.slice(s)),n=r;const o=r.lastIndexOf(".");return o>0&&(a=r.slice(o),n=r.slice(0,-a.length)),{dir:i,base:r,name:n,root:t,ext:a,full:t+i+r}},Ua.Wait=function(e,t){return new Promise(((s,n)=>{self.setTimeout(s,e,t)}))},Ua.swallowException=function(e){try{e()}catch(e){Ua.isDebug&&console.warn("Swallowed exception: ",e)}},Ua.noop=function(){},Ua.equalsNoCase=function(e,t){return"string"==typeof e&&"string"==typeof t&&(e===t||e.normalize().toLowerCase()===t.normalize().toLowerCase())},Ua.equalsCase=function(e,t){return"string"==typeof e&&"string"==typeof t&&(e===t||e.normalize()===t.normalize())},Ua.typedArraySet16=function(e,t,s){e[s++]=t[0],e[s++]=t[1],e[s++]=t[2],e[s++]=t[3],e[s++]=t[4],e[s++]=t[5],e[s++]=t[6],e[s++]=t[7],e[s++]=t[8],e[s++]=t[9],e[s++]=t[10],e[s++]=t[11],e[s++]=t[12],e[s++]=t[13],e[s++]=t[14],e[s]=t[15]},Ua.truncateArray=function(e,t){e.length=t},Ua.clearArray=function(e){e&&0!==e.length&&Ua.truncateArray(e,0)},Ua.clear2DArray=function(e){if(e){for(let t=0;t<e.length;t++){let s=e[t];Ua.truncateArray(s,0)}Ua.truncateArray(e,0)}},Ua.extendArray=function(e,t,s){t|=0;const n=e.length;if(!(t<=n))for(let i=n;i<t;++i)e.push(s)},Ua.resizeArray=function(e,t,s){t|=0;const n=e.length;t<n?Ua.truncateArray(e,t):t>n&&Ua.extendArray(e,t,s)},Ua.shallowAssignArray=function(e,t){Ua.clearArray(e),Ua.appendArray(e,t)},Ua.appendArray=function(e,t){if(t.length<1e4)e.push(...t);else for(let s=0,n=t.length;s<n;++s)e.push(t[s])},Ua.arrayRemove=function(e,t){if((t=Math.floor(t))<0||t>=e.length)return;let s=e.length-1;for(let n=t;n<s;++n)e[n]=e[n+1];Ua.truncateArray(e,s)},Ua.arrayFindRemove=function(e,t){let s=e.indexOf(t);s>=0&&e.splice(s,1)},Ua.arraysEqual=function(e,t){let s=e.length;if(t.length!==s)return!1;for(let n=0;n<s;++n)if(e[n]!==t[n])return!1;return!0},Ua.arrayFilterOut=function(e,t){let s=[],n=0;for(let i=0,r=e.length;i<r;++i){let r=e[i];t(r)?s.push(r):(e[n]=r,++n)}return Ua.truncateArray(e,n),s},Ua.arrayRemoveAllInSet=function(e,t){const s=e.length;let n=0;for(let s=0,i=e.length;s<i;++s){let i=e[s];t.has(i)||(e[n++]=i)}return Ua.truncateArray(e,n),s-n},Ua.isArrayIndexInBounds=function(e,t){return e===Math.floor(e)&&e>=0&&e<t.length},Ua.validateArrayIndex=function(e,t){if(!Ua.isArrayIndexInBounds(e,t))throw new RangeError("array index out of bounds")},Ua.cloneArray=function(e){return e.slice()},Ua.deepCloneArray=function(e,t){let s=[];for(let n of e)if(Ua.IsObject(n)){let e=t(n);if(!e)throw new Error("missing clone");if(e.constructor!==n.constructor)throw new Error("object is not a clone");s.push(e)}else Ua.IsArray(n)?s.push(Ua.deepCloneArray(n,t)):s.push(n);return s},Ua.clone2DArray=function(e){let t=[];for(let s of e)t.push(s.slice());return t},Ua.splitStringAndNormalize=function(e,t=" "){return e?e.split(t).map((e=>e.trim())).filter((e=>!!e)):[]},Ua.filterSet=function(e,t,s){const n=new Set;for(const i of e.values())t(i)&&(s?n.add(s(i)):n.add(i));return n},Ua.mergeSets=function(e,t){return e.union?e.union(t):new Set([...e,...t])},Ua.mergeSetsInPlace=function(e,t){for(const s of t)e.add(s);return e},Ua.first=function(e){for(let t of e)return t;return null},Ua.xor=function(e,t){return!e!=!t},Ua.compare=function(e,t,s){switch(t){case 0:return e===s;case 1:return e!==s;case 2:return e<s;case 3:return e<=s;case 4:return e>s;case 5:return e>=s;default:return!1}},Ua.hasAnyOwnProperty=function(e){for(let t in e)if(e.hasOwnProperty(t))return!0;return!1},Ua.PromiseAllWithProgress=function(e,t){return e.length?new Promise(((s,n)=>{const i=[];let r=0,a=!1;for(let o=0,l=e.length;o<l;++o)i.push(void 0),e[o].then((n=>{a||(i[o]=n,++r,r===e.length?s(i):t(r,e.length))})).catch((e=>{a=!0,n(e)}))})):Promise.resolve([])};let Xa=[];Ua.AddLibraryMemoryCallback=function(e){Xa.push(e)},Ua.GetEstimatedLibraryMemoryUsage=function(){let e=0;for(let t of Xa)e+=t();return Math.floor(e)};let Ya=1;const qa=new Map,Ja=new MessageChannel;Ja.port2.onmessage=function(e){const t=e.data,s=qa.get(t);qa.delete(t),s&&s(performance.now())},Ua.RequestUnlimitedAnimationFrame=function(e){const t=Ya++;return qa.set(t,e),Ja.port1.postMessage(t),t},Ua.CancelUnlimitedAnimationFrame=function(e){qa.delete(e)},Ua.PostTask=Ua.RequestUnlimitedAnimationFrame,Ua.WaitForNextTask=function(){return new Promise((e=>Ua.PostTask(e)))};const Ka=new Set;Ua.RequestPostAnimationFrame=function(e){const t=self.requestAnimationFrame((async s=>{await Ua.WaitForNextTask(),Ka.has(t)&&(Ka.delete(t),e(s))}));return Ka.add(t),t},Ua.CancelPostAnimationFrame=function(e){Ka.has(e)&&(self.cancelAnimationFrame(e),Ka.delete(e))}}{const Za=self.C3;Za.IsAbsoluteURL=function(e){return/^(?:[a-z\-]+:)?\/\//.test(e)||"data:"===e.substr(0,5)||"blob:"===e.substr(0,5)},Za.IsRelativeURL=function(e){return!Za.IsAbsoluteURL(e)},Za.ThrowIfNotOk=function(e){if(!e.ok)throw new Error(`fetch '${e.url}' response returned ${e.status} ${e.statusText}`)},Za.FetchOk=function(e,t){return fetch(e,t).then((e=>(Za.ThrowIfNotOk(e),e)))},Za.FetchText=function(e){return Za.FetchOk(e).then((e=>e.text()))},Za.FetchJson=function(e){return Za.FetchOk(e).then((e=>e.json()))},Za.FetchBlob=function(e){return Za.FetchOk(e).then((e=>e.blob()))},Za.FetchArrayBuffer=function(e){return Za.FetchOk(e).then((e=>e.arrayBuffer()))},Za.FetchImage=function(e){return new Promise(((t,s)=>{const n=new Image;n.onload=()=>t(n),n.onerror=e=>s(e),n.src=e}))},Za.BlobToArrayBuffer=function(e){return"function"==typeof e.arrayBuffer?e.arrayBuffer():new Promise(((t,s)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>s(n.error),n.readAsArrayBuffer(e)}))},Za.BlobToString=function(e){return"function"==typeof e.text?e.text():new Promise(((t,s)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>s(n.error),n.readAsText(e)}))},Za.BlobToJson=function(e){return Za.BlobToString(e).then((e=>JSON.parse(e)))},Za.BlobToImage=async function(e,t){let s=URL.createObjectURL(e);try{const e=await Za.FetchImage(s);return URL.revokeObjectURL(s),s="",t&&"function"==typeof e.decode&&await e.decode(),e}finally{s&&URL.revokeObjectURL(s)}},Za.CreateCanvas=function(e,t){if("undefined"!=typeof document&&"function"==typeof document.createElement){const s=document.createElement("canvas");return s.width=e,s.height=t,s}return new OffscreenCanvas(e,t)},Za.CanvasToBlob=function(e,t,s){if("number"!=typeof s&&(s=1),t=t||"image/png",s=Za.clamp(s,0,1),e.convertToBlob)return e.convertToBlob({type:t,quality:s});if(e.toBlob)return new Promise((n=>e.toBlob(n,t,s)));throw new Error("could not convert canvas to blob")},Za.DrawableToBlob=function(e,t,s){const n=Za.CreateCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),Za.CanvasToBlob(n,t,s)},Za.ImageDataToBlob=function(e,t,s){if(Za.Supports.ImageBitmapOptions)return createImageBitmap(e,{premultiplyAlpha:"none"}).then((e=>Za.DrawableToBlob(e,t,s)));if(Za.Supports.ImageBitmap)return createImageBitmap(e).then((e=>Za.DrawableToBlob(e,t,s)));{const n=Za.CreateCanvas(e.width,e.height);return n.getContext("2d").putImageData(e,0,0),Za.CanvasToBlob(n,t,s)}},Za.CopySet=function(e,t){e.clear();for(const s of t)e.add(s)},Za.MapToObject=function(e){const t=Object.create(null);for(const[s,n]of e.entries())t[s]=n;return t},Za.ObjectToMap=function(e,t){t.clear();for(const[s,n]of Object.entries(e))t.set(s,n)},Za.ToSuperJSON=function e(t){if("object"==typeof t&&null!==t){if(t instanceof Set)return{_c3type_:"set",data:[...t].map((t=>e(t)))};if(t instanceof Map)return{_c3type_:"map",data:[...t].map((t=>[t[0],e(t[1])]))};{const s=Object.create(null);for(const[n,i]of Object.entries(t))s[n]=e(i);return s}}return t},Za.FromSuperJSON=function e(t){if("object"==typeof t&null!==t){if("set"===t._c3type_)return new Set(t.data.map((t=>e(t))));if("map"===t._c3type_)return new Map(t.data.map((t=>[t[0],e(t[1])])));{const s=Object.create(null);for(const[n,i]of Object.entries(t))s[n]=e(i);return s}}return t},Za.CSSToCamelCase=function(e){if(e.startsWith("--"))return e;let t="",s=!1,n=0;for(const i of e)"-"===i?n>0&&(s=!0):s?(t+=i.toUpperCase(),s=!1):t+=i,++n;return t},Za.IsIterator=function(e){return"object"==typeof e&&"function"==typeof e.next},Za.MakeFilledArray=function(e,t){const s=[];if("function"==typeof t)for(let n=0;n<e;++n)s.push(t());else for(let n=0;n<e;++n)s.push(t);return s}}{let Qa=function(e){return 0===e.length?"00":1===e.length?"0"+e:e},eo=function(e,t,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+6*(t-e)*s:s<.5?t:s<2/3?e+(t-e)*(2/3-s)*6:e};padTwoDigits=Qa,hueToRGB=eo;const to=self.C3,so=/([0-9.]+),([0-9.]+)\%?,([0-9.]+)\%?/i,no=/([0-9.]+),([0-9.]+)\%?,([0-9.]+)\%?,([0-9.])/i;to.Color=class{constructor(e,t,s,n){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,this._r=0,this._g=0,this._b=0,this._a=0,e instanceof to.Color?this.set(e):this.setRgba(e||0,t||0,s||0,n||0)}setRgb(e,t,s){return this._r=+e,this._g=+t,this._b=+s,this.clamp(),this}setRgba(e,t,s,n){return this._r=+e,this._g=+t,this._b=+s,this._a=+n,this.clamp(),this}set(e){return this._r=e._r,this._g=e._g,this._b=e._b,this._a=e._a,this}copy(e){return this.set(e)}add(e){this._r+=e._r,this._g+=e._g,this._b+=e._b,this._a+=e._a,this.clamp()}addRgb(e,t,s,n=0){this._r+=+e,this._g+=+t,this._b+=+s,this._a+=+n,this.clamp()}diff(e){this.setR(Math.max(this._r,e._r)-Math.min(this._r,e._r)),this.setG(Math.max(this._g,e._g)-Math.min(this._g,e._g)),this.setB(Math.max(this._b,e._b)-Math.min(this._b,e._b)),this.setA(Math.max(this._a,e._a)-Math.min(this._a,e._a)),this.clamp()}copyRgb(e){this._r=e._r,this._g=e._g,this._b=e._b}setR(e){this._r=to.clamp(+e,0,1)}getR(){return this._r}setG(e){this._g=to.clamp(+e,0,1)}getG(){return this._g}setB(e){this._b=to.clamp(+e,0,1)}getB(){return this._b}setA(e){this._a=to.clamp(+e,0,1)}getA(){return this._a}clone(){return to.New(to.Color,this._r,this._g,this._b,this._a)}toArray(){return[this._r,this._g,this._b,this._a]}toTypedArray(){return new Float64Array(this.toArray())}writeToTypedArray(e,t){e[t++]=this._r,e[t++]=this._g,e[t++]=this._b,e[t]=this._a}writeRGBToTypedArray(e,t){e[t++]=this._r,e[t++]=this._g,e[t]=this._b}equals(e){return this._r===e._r&&this._g===e._g&&this._b===e._b&&this._a===e._a}equalsIgnoringAlpha(e){return this._r===e._r&&this._g===e._g&&this._b===e._b}equalsRgb(e,t,s){return this._r===e&&this._g===t&&this._b===s}equalsRgba(e,t,s,n){return this._r===e&&this._g===t&&this._b===s&&this._a===n}equalsF32Array(e,t){return e[t]===Math.fround(this._r)&&e[t+1]===Math.fround(this._g)&&e[t+2]===Math.fround(this._b)&&e[t+3]===Math.fround(this._a)}equalsRGBF32Array(e,t){return e[t]===Math.fround(this._r)&&e[t+1]===Math.fround(this._g)&&e[t+2]===Math.fround(this._b)}multiply(e){this._r*=e._r,this._g*=e._g,this._b*=e._b,this._a*=e._a}multiplyAlpha(e){this._r*=e,this._g*=e,this._b*=e,this._a*=e}premultiply(){return this._r*=this._a,this._g*=this._a,this._b*=this._a,this}unpremultiply(){return this._r/=this._a,this._g/=this._a,this._b/=this._a,this}clamp(){return this._r=to.clamp(this._r,0,1),this._g=to.clamp(this._g,0,1),this._b=to.clamp(this._b,0,1),this._a=to.clamp(this._a,0,1),this}setFromRgbValue(e){this._r=to.GetRValue(e),this._g=to.GetGValue(e),this._b=to.GetBValue(e),this._a=to.GetAValue(e)}getCssRgb(e,t,s){return`rgb(${100*(to.IsFiniteNumber(e)?e:this.getR())}%, ${100*(to.IsFiniteNumber(t)?t:this.getG())}%, ${100*(to.IsFiniteNumber(s)?s:this.getB())}%)`}getCssRgba(e,t,s,n){return`rgba(${100*(to.IsFiniteNumber(e)?e:this.getR())}%, ${100*(to.IsFiniteNumber(t)?t:this.getG())}%, ${100*(to.IsFiniteNumber(s)?s:this.getB())}%, ${to.IsFiniteNumber(n)?n:this.getA()})`}toHexString(){const e=Math.round(255*this.getR()),t=Math.round(255*this.getG()),s=Math.round(255*this.getB());return"#"+Qa(e.toString(16))+Qa(t.toString(16))+Qa(s.toString(16))}parseHexString(e){if("string"!=typeof e)return!1;let t,s,n;if("#"===(e=e.trim()).charAt(0)&&(e=e.substr(1)),3===e.length)t=parseInt(e[0],16)/15,s=parseInt(e[1],16)/15,n=parseInt(e[2],16)/15;else{if(6!==e.length)return!1;t=parseInt(e.substr(0,2),16)/255,s=parseInt(e.substr(2,2),16)/255,n=parseInt(e.substr(4,2),16)/255}return isFinite(t)&&this.setR(t),isFinite(s)&&this.setG(s),isFinite(n)&&this.setB(n),this.setA(1),!0}toCommaSeparatedRgb(){return`${Math.round(255*this.getR())}, ${Math.round(255*this.getG())}, ${Math.round(255*this.getB())}`}toRgbArray(){return[Math.round(255*this.getR()),Math.round(255*this.getG()),Math.round(255*this.getB())]}parseCommaSeparatedRgb(e){if("string"!=typeof e)return!1;const t=(e=e.replace(/^rgb\(|\)|%/,"")).split(",");if(t.length<3)return!1;const s=parseInt(t[0].trim(),10)/255,n=parseInt(t[1].trim(),10)/255,i=parseInt(t[2].trim(),10)/255;return isFinite(s)&&this.setR(s),isFinite(n)&&this.setG(n),isFinite(i)&&this.setB(i),this.setA(1),!0}parseCommaSeparatedPercentageRgb(e){if("string"!=typeof e)return!1;const t=(e=e.replace(/^rgb\(|\)|%/,"")).split(",");if(t.length<3)return!1;const s=parseInt(t[0].trim(),10)/100,n=parseInt(t[1].trim(),10)/100,i=parseInt(t[2].trim(),10)/100;return isFinite(s)&&this.setR(s),isFinite(n)&&this.setG(n),isFinite(i)&&this.setB(i),this.setA(1),!0}parseCommaSeparatedRgba(e){if("string"!=typeof e)return!1;const t=(e=e.replace(/^rgba\(|\)|%/,"")).split(",");if(t.length<4)return!1;const s=parseInt(t[0].trim(),10)/255,n=parseInt(t[1].trim(),10)/255,i=parseInt(t[2].trim(),10)/255,r=parseFloat(t[3].trim());return isFinite(s)&&this.setR(s),isFinite(n)&&this.setG(n),isFinite(i)&&this.setB(i),isFinite(r)&&this.setA(r),!0}parseCommaSeparatedPercentageRgba(e){if("string"!=typeof e)return!1;const t=(e=e.replace(/^rgba\(|\)|%/,"")).split(",");if(t.length<4)return!1;const s=parseInt(t[0].trim(),10)/100,n=parseInt(t[1].trim(),10)/100,i=parseInt(t[2].trim(),10)/100,r=parseFloat(t[3].trim());return isFinite(s)&&this.setR(s),isFinite(n)&&this.setG(n),isFinite(i)&&this.setB(i),isFinite(r)&&this.setA(r),!0}parseString(e){if("string"!=typeof e)return!1;if((e=e.replace(/\s+/,"")).includes(",")){if(e.startsWith("rgb("))return e.includes("%")?this.parseCommaSeparatedPercentageRgb(e):this.parseCommaSeparatedRgb(e);if(e.startsWith("rgba("))return e.includes("%")?this.parseCommaSeparatedPercentageRgba(e):this.parseCommaSeparatedRgba(e);if(e.startsWith("hsl(")||e.startsWith("hsla("))return this.parseHSLString(e);{const t=e.split(",");return e.includes("%")?3===t.length?this.parseCommaSeparatedPercentageRgb(e):4===t.length&&this.parseCommaSeparatedPercentageRgba(e):3===t.length?this.parseCommaSeparatedRgb(e):4===t.length&&this.parseCommaSeparatedRgba(e)}}return this.parseHexString(e)}toJSON(){return[this._r,this._g,this._b,this._a]}setFromHSLA(e,t,s,n){let i,r,a;if(e%=360,t=to.clamp(t,0,100),s=to.clamp(s,0,100),n=to.clamp(n,0,1),e/=360,s/=100,0==(t/=100))i=r=a=s;else{const n=s<.5?s*(1+t):s+t-s*t,o=2*s-n;i=eo(o,n,e+1/3),r=eo(o,n,e),a=eo(o,n,e-1/3)}return this.setR(i),this.setG(r),this.setB(a),this.setA(n),this}parseHSLString(e){const t=e.replace(/ |hsl|hsla|\(|\)|;/gi,""),s=so.exec(t),n=no.exec(t);return s&&4===s.length?(this.setFromHSLA(+s[1],+s[2],+s[3],1),!0):!(!n||5!==n.length||(this.setFromHSLA(+s[1],+s[2],+s[3],+s[4]),0))}toHSLAString(){const e=this._r,t=this._g,s=this._b,n=this._a;return`hsla(${to.Color.GetHue(e,t,s)}, ${to.Color.GetSaturation(e,t,s)}%, ${to.Color.GetLuminosity(e,t,s)}%, ${n})`}toHSLAArray(){const e=this._r,t=this._g,s=this._b;return[to.Color.GetHue(e,t,s),to.Color.GetSaturation(e,t,s),to.Color.GetLuminosity(e,t,s),this._a]}setFromJSON(e){Array.isArray(e)&&(e.length<3||(this._r=e[0],this._g=e[1],this._b=e[2],e.length>=4?this._a=e[3]:this._a=1))}set r(e){this.setR(e)}get r(){return this.getR()}set g(e){this.setG(e)}get g(){return this.getG()}set b(e){this.setB(e)}get b(){return this.getB()}set a(e){this.setA(e)}get a(){return this.getA()}setAtIndex(e,t){switch(e){case 0:this.setR(t);break;case 1:this.setG(t);break;case 2:this.setB(t);break;case 3:this.setA(t);break;default:throw new RangeError("invalid color index")}}getAtIndex(e){switch(e){case 0:return this.getR();case 1:return this.getG();case 2:return this.getB();case 3:return this.getA();default:throw new RangeError("invalid color index")}}static Equals(e,t){let s,n;if(Array.isArray(e))s=new to.Color,s.setFromJSON(e);else{if(!(e instanceof to.Color))throw new Error("unexpected type");s=e}if(Array.isArray(t))n=new to.Color,n.setFromJSON(t);else{if(!(t instanceof to.Color))throw new Error("unexpected type");n=t}return s.equals(n)}static DiffChannel(e,t){return to.clamp(Math.max(e,t)-Math.min(e,t),0,1)}static Diff(e,t){const s=new to.Color;return s.setR(Math.max(e._r,t._r)-Math.min(e._r,t._r)),s.setG(Math.max(e._g,t._g)-Math.min(e._g,t._g)),s.setB(Math.max(e._b,t._b)-Math.min(e._b,t._b)),s.setA(Math.max(e._a,t._a)-Math.min(e._a,t._a)),s}static DiffNoAlpha(e,t){const s=new to.Color(0,0,0,1);return s.setR(Math.max(e._r,t._r)-Math.min(e._r,t._r)),s.setG(Math.max(e._g,t._g)-Math.min(e._g,t._g)),s.setB(Math.max(e._b,t._b)-Math.min(e._b,t._b)),s}static GetHue(e,t,s){const n=Math.max(e,t,s),i=Math.min(e,t,s);if(n===i)return 0;let r=0;switch(n){case e:r=(t-s)/(n-i)+(t<s?6:0);break;case t:r=(s-e)/(n-i)+2;break;case s:r=(e-t)/(n-i)+4}return Math.round(r/6*360)}static GetSaturation(e,t,s){const n=Math.max(e,t,s),i=Math.min(e,t,s);if(n===i)return 0;const r=n-i,a=(n+i)/2>.5?r/(2-n-i):r/(n+i);return Math.round(100*a)}static GetLuminosity(e,t,s){const n=Math.max(e,t,s),i=(n+Math.min(e,t,s))/2;return n?Math.round(100*i):0}},to.Color.White=Object.freeze(to.New(to.Color,1,1,1,1)),to.Color.Black=Object.freeze(to.New(to.Color,0,0,0,1)),to.Color.TransparentBlack=Object.freeze(to.New(to.Color,0,0,0,0))}{const io=self.C3;io.Vector2=class{constructor(e,t){this._x=0,this._y=0,e instanceof io.Vector2?this.copy(e):this.set(e||0,t||0)}set(e,t){this._x=+e,this._y=+t}copy(e){this._x=e._x,this._y=e._y}equals(e){return this._x===e._x&&this._y===e._y}equalsValues(e,t){return this._x===e&&this._y===t}equalsF32Array(e,t){return e[t]===Math.fround(this._x)&&e[t+1]===Math.fround(this._y)}setX(e){this._x=+e}getX(){return this._x}setY(e){this._y=+e}getY(){return this._y}toArray(){return[this._x,this._y]}toTypedArray(){return new Float64Array(this.toArray())}writeToTypedArray(e,t){e[t++]=this._x,e[t]=this._y}offset(e,t){this._x+=+e,this._y+=+t}scale(e,t){this._x*=e,this._y*=t}divide(e,t){this._x/=e,this._y/=t}round(){this._x=Math.round(this._x),this._y=Math.round(this._y)}floor(){this._x=Math.floor(this._x),this._y=Math.floor(this._y)}ceil(){this._x=Math.ceil(this._x),this._y=Math.ceil(this._y)}angle(){return io.angleTo(0,0,this._x,this._y)}lengthSquared(){return this._x*this._x+this._y*this._y}length(){return io.hypot2DFast(this._x,this._y)}rotatePrecalc(e,t){const s=this._x*t-this._y*e;this._y=this._y*t+this._x*e,this._x=s}rotate(e){0!==e&&this.rotatePrecalc(Math.sin(e),Math.cos(e))}rotateAbout(e,t,s){0===e||t===this._x&&s===this._y||(this._x-=t,this._y-=s,this.rotatePrecalc(Math.sin(e),Math.cos(e)),this._x+=+t,this._y+=+s)}move(e,t){0!==t&&(this._x+=Math.cos(e)*t,this._y+=Math.sin(e)*t)}normalize(){const e=this.length();0!==e&&1!==e&&(this._x/=e,this._y/=e)}clamp(e,t){this._x=io.clamp(this._x,e,t),this._y=io.clamp(this._y,e,t)}dot(e){return this._x*e._x+this._y*e._y}reverse(){this._x=-this._x,this._y=-this._y}perp(){let e=this._x;return this._x=this._y,this._y=-e,this}}}{const ro=self.C3;ro.Rect=class{constructor(e,t,s,n){this._left=NaN,this._top=NaN,this._right=NaN,this._bottom=NaN,this._left=0,this._top=0,this._right=0,this._bottom=0,e instanceof ro.Rect?this.copy(e):this.set(e||0,t||0,s||0,n||0)}set(e,t,s,n){this._left=+e,this._top=+t,this._right=+s,this._bottom=+n}setWH(e,t,s,n){e=+e,t=+t,this._left=e,this._top=t,this._right=e+ +s,this._bottom=t+ +n}copy(e){this._left=+e._left,this._top=+e._top,this._right=+e._right,this._bottom=+e._bottom}clone(){return new ro.Rect(this._left,this._top,this._right,this._bottom)}static Merge(e,t){const s=new ro.Rect;return s.setLeft(Math.min(e._left,t._left)),s.setTop(Math.min(e._top,t._top)),s.setRight(Math.max(e._right,t._right)),s.setBottom(Math.max(e._bottom,t._bottom)),s}static FromObject(e){return new ro.Rect(e.left,e.top,e.right,e.bottom)}equals(e){return this._left===e._left&&this._top===e._top&&this._right===e._right&&this._bottom===e._bottom}equalsWH(e,t,s,n){return this._left===e&&this._top===t&&this.width()===s&&this.height()===n}equalsF32Array(e,t){return e[t]===Math.fround(this._left)&&e[t+1]===Math.fround(this._top)&&e[t+2]===Math.fround(this._right)&&e[t+3]===Math.fround(this._bottom)}setLeft(e){this._left=+e}getLeft(){return this._left}setTop(e){this._top=+e}getTop(){return this._top}setRight(e){this._right=+e}getRight(){return this._right}setBottom(e){this._bottom=+e}getBottom(){return this._bottom}toArray(){return[this._left,this._top,this._right,this._bottom]}toTypedArray(){return new Float64Array(this.toArray())}toDOMRect(){return new DOMRect(this._left,this._top,this.width(),this.height())}static fromDOMRect(e){return ro.New(ro.Rect,e.left,e.top,e.right,e.bottom)}writeToTypedArray(e,t){e[t++]=this._left,e[t++]=this._top,e[t++]=this._right,e[t]=this._bottom}writeAsQuadToTypedArray(e,t){e[t++]=this._left,e[t++]=this._top,e[t++]=this._right,e[t++]=this._top,e[t++]=this._right,e[t++]=this._bottom,e[t++]=this._left,e[t]=this._bottom}writeAsQuadToTypedArray3D(e,t,s){e[t++]=this._left,e[t++]=this._top,e[t++]=s,e[t++]=this._right,e[t++]=this._top,e[t++]=s,e[t++]=this._right,e[t++]=this._bottom,e[t++]=s,e[t++]=this._left,e[t++]=this._bottom,e[t]=s}width(){return this._right-this._left}height(){return this._bottom-this._top}midX(){return(this._left+this._right)/2}midY(){return(this._top+this._bottom)/2}offset(e,t){e=+e,t=+t,this._left+=e,this._top+=t,this._right+=e,this._bottom+=t}offsetLeft(e){this._left+=+e}offsetTop(e){this._top+=+e}offsetRight(e){this._right+=+e}offsetBottom(e){this._bottom+=+e}toSquare(e){if("x"!==e)throw new Error("invalid axis, only 'x' supported");this._top<this._bottom?this._left<this._right?this._bottom=this._top+this.width():this._bottom=this._top-this.width():this._left<this._right?this._bottom=this._top-this.width():this._bottom=this._top+this.width()}inflate(e,t){e=+e,t=+t,this._left-=e,this._top-=t,this._right+=e,this._bottom+=t}deflate(e,t){e=+e,t=+t,this._left+=e,this._top+=t,this._right-=e,this._bottom-=t}multiply(e,t){this._left*=e,this._top*=t,this._right*=e,this._bottom*=t}divide(e,t){this._left/=e,this._top/=t,this._right/=e,this._bottom/=t}mirrorAround(e){this._left=+e-this._left,this._right=+e-this._right}flipAround(e){this._top=+e-this._top,this._bottom=+e-this._bottom}rotate90DegreesAround(e,t){const s=this.width(),n=this.height(),i=this.getLeft()+s*e,r=this.getTop()+n*t;this.setWH(i-n*t,r-s*e,n,s)}swapLeftRight(){const e=this._left;this._left=this._right,this._right=e}swapTopBottom(){const e=this._top;this._top=this._bottom,this._bottom=e}shuntY(e){const t=this._top;this._top=+e-this._bottom,this._bottom=+e-t}round(){this._left=Math.round(this._left),this._top=Math.round(this._top),this._right=Math.round(this._right),this._bottom=Math.round(this._bottom)}roundInner(){this._left=Math.ceil(this._left),this._top=Math.ceil(this._top),this._right=Math.floor(this._right),this._bottom=Math.floor(this._bottom)}roundOuter(){this._left=Math.floor(this._left),this._top=Math.floor(this._top),this._right=Math.ceil(this._right),this._bottom=Math.ceil(this._bottom)}floor(){this._left=Math.floor(this._left),this._top=Math.floor(this._top),this._right=Math.floor(this._right),this._bottom=Math.floor(this._bottom)}ceil(){this._left=Math.ceil(this._left),this._top=Math.ceil(this._top),this._right=Math.ceil(this._right),this._bottom=Math.ceil(this._bottom)}clamp(e,t,s,n){this._left=Math.max(this._left,+e),this._top=Math.max(this._top,+t),this._right=Math.min(this._right,+s),this._bottom=Math.min(this._bottom,+n)}clampBoth(e,t,s,n){e=+e,t=+t,s=+s,n=+n,this._left=ro.clamp(this._left,e,s),this._top=ro.clamp(this._top,t,n),this._right=ro.clamp(this._right,e,s),this._bottom=ro.clamp(this._bottom,t,n)}normalize(){this._left>this._right&&this.swapLeftRight(),this._top>this._bottom&&this.swapTopBottom()}intersectsRect(e){return!(e._right<this._left||e._bottom<this._top||e._left>this._right||e._top>this._bottom)}intersectsRectOffset(e,t,s){return!(e._right+t<this._left||e._bottom+s<this._top||e._left+t>this._right||e._top+s>this._bottom)}containsPoint(e,t){return e>=this._left&&e<=this._right&&t>=this._top&&t<=this._bottom}containsRect(e){return e._left>=this._left&&e._top>=this._top&&e._right<=this._right&&e._bottom<=this._bottom}expandToContain(e){e._left<this._left&&(this._left=+e._left),e._top<this._top&&(this._top=+e._top),e._right>this._right&&(this._right=+e._right),e._bottom>this._bottom&&(this._bottom=+e._bottom)}lerpInto(e){this._left=ro.lerp(e._left,e._right,this._left),this._top=ro.lerp(e._top,e._bottom,this._top),this._right=ro.lerp(e._left,e._right,this._right),this._bottom=ro.lerp(e._top,e._bottom,this._bottom)}}}{const ao=self.C3;ao.Quad=class{constructor(e,t,s,n,i,r,a,o){this._tlx=NaN,this._tly=NaN,this._trx=NaN,this._try=NaN,this._brx=NaN,this._bry=NaN,this._blx=NaN,this._bly=NaN,this._tlx=0,this._tly=0,this._trx=0,this._try=0,this._brx=0,this._bry=0,this._blx=0,this._bly=0,e instanceof ao.Quad?this.copy(e):this.set(e||0,t||0,s||0,n||0,i||0,r||0,a||0,o||0)}set(e,t,s,n,i,r,a,o){this._tlx=+e,this._tly=+t,this._trx=+s,this._try=+n,this._brx=+i,this._bry=+r,this._blx=+a,this._bly=+o}setRect(e,t,s,n){this.set(e,t,s,t,s,n,e,n)}copy(e){this._tlx=e._tlx,this._tly=e._tly,this._trx=e._trx,this._try=e._try,this._brx=e._brx,this._bry=e._bry,this._blx=e._blx,this._bly=e._bly}equals(e){return this._tlx===e._tlx&&this._tly===e._tly&&this._trx===e._trx&&this._try===e._try&&this._brx===e._brx&&this._bry===e._bry&&this._blx===e._blx&&this._bly===e._bly}setTlx(e){this._tlx=+e}getTlx(){return this._tlx}setTly(e){this._tly=+e}getTly(){return this._tly}setTrx(e){this._trx=+e}getTrx(){return this._trx}setTry(e){this._try=+e}getTry(){return this._try}setBrx(e){this._brx=+e}getBrx(){return this._brx}setBry(e){this._bry=+e}getBry(){return this._bry}setBlx(e){this._blx=+e}getBlx(){return this._blx}setBly(e){this._bly=+e}getBly(){return this._bly}toDOMQuad(){return new DOMQuad(new DOMPoint(this._tlx,this._tly),new DOMPoint(this._trx,this._try),new DOMPoint(this._brx,this._bry),new DOMPoint(this._blx,this._bly))}static fromDOMQuad(e){return ao.New(ao.Quad,e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y,e.p4.x,e.p4.y)}toArray(){return[this._tlx,this._tly,this._trx,this._try,this._brx,this._bry,this._blx,this._bly]}toTypedArray(){return new Float64Array(this.toArray())}writeToTypedArray(e,t){e[t++]=this._tlx,e[t++]=this._tly,e[t++]=this._trx,e[t++]=this._try,e[t++]=this._brx,e[t++]=this._bry,e[t++]=this._blx,e[t]=this._bly}writeToTypedArray3D(e,t,s){e[t++]=this._tlx,e[t++]=this._tly,e[t++]=s,e[t++]=this._trx,e[t++]=this._try,e[t++]=s,e[t++]=this._brx,e[t++]=this._bry,e[t++]=s,e[t++]=this._blx,e[t++]=this._bly,e[t]=s}offset(e,t){e=+e,t=+t,this._tlx+=e,this._tly+=t,this._trx+=e,this._try+=t,this._brx+=e,this._bry+=t,this._blx+=e,this._bly+=t}round(){this._tlx=Math.round(this._tlx),this._tly=Math.round(this._tly),this._trx=Math.round(this._trx),this._try=Math.round(this._try),this._brx=Math.round(this._brx),this._bry=Math.round(this._bry),this._blx=Math.round(this._blx),this._bly=Math.round(this._bly)}floor(){this._tlx=Math.floor(this._tlx),this._tly=Math.floor(this._tly),this._trx=Math.floor(this._trx),this._try=Math.floor(this._try),this._brx=Math.floor(this._brx),this._bry=Math.floor(this._bry),this._blx=Math.floor(this._blx),this._bly=Math.floor(this._bly)}ceil(){this._tlx=Math.ceil(this._tlx),this._tly=Math.ceil(this._tly),this._trx=Math.ceil(this._trx),this._try=Math.ceil(this._try),this._brx=Math.ceil(this._brx),this._bry=Math.ceil(this._bry),this._blx=Math.ceil(this._blx),this._bly=Math.ceil(this._bly)}setFromRect(e){this._tlx=e._left,this._tly=e._top,this._trx=e._right,this._try=e._top,this._brx=e._right,this._bry=e._bottom,this._blx=e._left,this._bly=e._bottom}setFromRotatedRect(e,t){0===t?this.setFromRect(e):this.setFromRotatedRectPrecalc(e,Math.sin(t),Math.cos(t))}setFromRotatedRectPrecalc(e,t,s){const n=e._left*t,i=e._top*t,r=e._right*t,a=e._bottom*t,o=e._left*s,l=e._top*s,c=e._right*s,h=e._bottom*s;this._tlx=o-i,this._tly=l+n,this._trx=c-i,this._try=l+r,this._brx=c-a,this._bry=h+r,this._blx=o-a,this._bly=h+n}getBoundingBox(e){e.set(Math.min(this._tlx,this._trx,this._brx,this._blx),Math.min(this._tly,this._try,this._bry,this._bly),Math.max(this._tlx,this._trx,this._brx,this._blx),Math.max(this._tly,this._try,this._bry,this._bly))}containsPoint(e,t){let s=this._trx-this._tlx,n=this._try-this._tly;const i=this._brx-this._tlx,r=this._bry-this._tly,a=e-this._tlx,o=t-this._tly;let l=s*s+n*n,c=s*i+n*r,h=s*a+n*o;const _=i*i+r*r,u=i*a+r*o;let d=1/(l*_-c*c),p=(_*h-c*u)*d,f=(l*u-c*h)*d;return p>=0&&f>0&&p+f<1||(s=this._blx-this._tlx,n=this._bly-this._tly,l=s*s+n*n,c=s*i+n*r,h=s*a+n*o,d=1/(l*_-c*c),p=(_*h-c*u)*d,f=(l*u-c*h)*d,p>=0&&f>0&&p+f<1)}midX(){return(this._tlx+this._trx+this._brx+this._blx)/4}midY(){return(this._tly+this._try+this._bry+this._bly)/4}intersectsSegment(e,t,s,n){return!(!this.containsPoint(e,t)&&!this.containsPoint(s,n))||ao.segmentIntersectsQuad(e,t,s,n,this)}intersectsQuad(e){let t=e.midX(),s=e.midY();if(this.containsPoint(t,s))return!0;if(t=this.midX(),s=this.midY(),e.containsPoint(t,s))return!0;const n=this._tlx,i=this._tly,r=this._trx,a=this._try,o=this._brx,l=this._bry,c=this._blx,h=this._bly;return ao.segmentIntersectsQuad(n,i,r,a,e)||ao.segmentIntersectsQuad(r,a,o,l,e)||ao.segmentIntersectsQuad(o,l,c,h,e)||ao.segmentIntersectsQuad(c,h,n,i,e)}rotatePointsAnticlockwise(){const e=this._tlx,t=this._tly;this._tlx=this._trx,this._tly=this._try,this._trx=this._brx,this._try=this._bry,this._brx=this._blx,this._bry=this._bly,this._blx=e,this._bly=t}mirror(){this._swap(0,2),this._swap(1,3),this._swap(6,4),this._swap(7,5)}flip(){this._swap(0,6),this._swap(1,7),this._swap(2,4),this._swap(3,5)}diag(){this._swap(2,6),this._swap(3,7)}_swap(e,t){const s=this._getAtIndex(e);this._setAtIndex(e,this._getAtIndex(t)),this._setAtIndex(t,s)}_getAtIndex(e){switch(e){case 0:return this._tlx;case 1:return this._tly;case 2:return this._trx;case 3:return this._try;case 4:return this._brx;case 5:return this._bry;case 6:return this._blx;case 7:return this._bly;default:throw new RangeError("invalid quad point index")}}_setAtIndex(e,t){switch(t=+t,e){case 0:this._tlx=t;break;case 1:this._tly=t;break;case 2:this._trx=t;break;case 3:this._try=t;break;case 4:this._brx=t;break;case 5:this._bry=t;break;case 6:this._blx=t;break;case 7:this._bly=t;break;default:throw new RangeError("invalid quad point index")}}}}{const oo=self.C3,lo=self.assert,co=[0,0,1,0,1,1,0,1],ho=oo.New(oo.Quad);oo.CollisionPoly=class extends oo.DefendedBase{constructor(e,t=!0){super(),e||(e=co),this._ptsArr=Float64Array.from(e),this._bbox=new oo.Rect,this._isBboxChanged=!0,this._enabled=t}Release(){}pointsArr(){return this._ptsArr}pointCount(){return this._ptsArr.length/2}setPoints(e){this._ptsArr.length===e.length?this._ptsArr.set(e):this._ptsArr=Float64Array.from(e),this._isBboxChanged=!0}setDefaultPoints(){this.setPoints(co)}copy(e){this.setPoints(e._ptsArr)}setBboxChanged(){this._isBboxChanged=!0}_updateBbox(){if(!this._isBboxChanged)return;const e=this._ptsArr;let t=e[0],s=e[1],n=t,i=s;for(let r=0,a=e.length;r<a;r+=2){const a=e[r],o=e[r+1];a<t&&(t=a),a>n&&(n=a),o<s&&(s=o),o>i&&(i=o)}this._bbox.set(t,s,n,i),this._isBboxChanged=!1}setFromRect(e,t,s){let n=this._ptsArr;8!==n.length&&(n=new Float64Array(8),this._ptsArr=n),n[0]=e.getLeft()-t,n[1]=e.getTop()-s,n[2]=e.getRight()-t,n[3]=e.getTop()-s,n[4]=e.getRight()-t,n[5]=e.getBottom()-s,n[6]=e.getLeft()-t,n[7]=e.getBottom()-s,this._bbox.copy(e),0===t&&0===s||this._bbox.offset(-t,-s),this._isBboxChanged=!1}setFromQuad(e,t,s){ho.copy(e),ho.offset(t,s),this.setPoints(ho.toArray()),this._isBboxChanged=!0}transform(e,t,s){let n=0,i=1;0!==s&&(n=Math.sin(s),i=Math.cos(s)),this.transformPrecalc(e,t,n,i)}transformPrecalc(e,t,s,n){const i=this._ptsArr;for(let r=0,a=i.length;r<a;r+=2){const a=r+1,o=i[r]*e,l=i[a]*t;i[r]=o*n-l*s,i[a]=l*n+o*s}this._isBboxChanged=!0}offset(e,t){const s=this._ptsArr;for(let n=0,i=s.length;n<i;n+=2)s[n]+=e,s[n+1]+=t}containsPoint(e,t){const s=this._ptsArr;if(e===s[0]&&t===s[1])return!0;this._updateBbox();const n=this._bbox,i=n.getLeft()-110,r=n.getTop()-101,a=n.getRight()+131,o=n.getBottom()+120;let l=0,c=0,h=0,_=0,u=0,d=0,p=0,f=0;i<e?(l=i,h=e):(l=e,h=i),r<t?(c=r,_=t):(c=t,_=r),a<e?(u=a,p=e):(u=e,p=a),o<t?(d=o,f=t):(d=t,f=o);let m=0,g=0;for(let n=0,I=s.length;n<I;n+=2){const S=(n+2)%I,y=s[n],b=s[n+1],G=s[S],v=s[S+1];oo.segmentsIntersectPreCalc(i,r,e,t,l,h,c,_,y,b,G,v)&&++m,oo.segmentsIntersectPreCalc(a,o,e,t,u,p,d,f,y,b,G,v)&&++g}return m%2==1||g%2==1}intersectsPoly(e,t,s){const n=e._ptsArr,i=this._ptsArr;if(this.containsPoint(n[0]+t,n[1]+s))return!0;if(e.containsPoint(i[0]-t,i[1]-s))return!0;for(let e=0,r=i.length;e<r;e+=2){const a=(e+2)%r,o=i[e],l=i[e+1],c=i[a],h=i[a+1];let _=0,u=0,d=0,p=0;o<c?(_=o,d=c):(_=c,d=o),l<h?(u=l,p=h):(u=h,p=l);for(let e=0,i=n.length;e<i;e+=2){const r=(e+2)%i,a=n[e]+t,f=n[e+1]+s,m=n[r]+t,g=n[r+1]+s;if(oo.segmentsIntersectPreCalc(o,l,c,h,_,d,u,p,a,f,m,g))return!0}}return!1}intersectsSegment(e,t,s,n,i,r){if(this.containsPoint(s-e,n-t))return!0;if(this.containsPoint(i-e,r-t))return!0;let a=0,o=0,l=0,c=0;s<i?(a=s,l=i):(a=i,l=s),n<r?(o=n,c=r):(o=r,c=n);const h=this._ptsArr;for(let _=0,u=h.length;_<u;_+=2){const d=(_+2)%u,p=h[_]+e,f=h[_+1]+t,m=h[d]+e,g=h[d+1]+t;if(oo.segmentsIntersectPreCalc(s,n,i,r,a,l,o,c,p,f,m,g))return!0}return!1}mirror(e){const t=this._ptsArr;for(let s=0,n=t.length;s<n;s+=2)t[s]=2*e-t[s];this._isBboxChanged=!0}flip(e){const t=this._ptsArr;for(let s=0,n=t.length;s<n;s+=2){const n=s+1;t[n]=2*e-t[n]}this._isBboxChanged=!0}diag(){const e=this._ptsArr;for(let t=0,s=e.length;t<s;t+=2){const s=t+1,n=e[t];e[t]=e[s],e[s]=n}this._isBboxChanged=!0}GetMidX(){const e=this._ptsArr;let t=0;for(let s=0,n=e.length;s<n;s+=2)t+=e[s];return t/this.pointCount()}GetMidY(){const e=this._ptsArr;let t=0;for(let s=0,n=e.length;s<n;s+=2)t+=e[s+1];return t/this.pointCount()}GetPointsArray(){return this._ptsArr}GetPointCount(){return this.pointCount()}IsEnabled(){return this._enabled}}}{const _o=self.C3;_o.PairMap=class extends _o.DefendedBase{constructor(e){if(super(),this._firstMap=new Map,e)for(const[t,s,n]of e)this.Set(t,s,n)}Release(){this.Clear(),this._firstMap=null}IsEmpty(){return 0===this._firstMap.size}Clear(){const e=this._firstMap;for(const t of e.values())t.clear();e.clear()}Set(e,t,s){const n=this._firstMap;let i=n.get(e);i||(i=new Map,n.set(e,i)),i.set(t,s)}Get(e,t){const s=this._firstMap.get(e);return s?s.get(t):s}Has(e,t){const s=this._firstMap.get(e);return!!s&&s.has(t)}Delete(e,t){const s=this._firstMap,n=s.get(e);if(!n)return!1;const i=n.delete(t);return i&&0===n.size&&s.delete(e),i}DeleteEither(e){const t=this._firstMap,s=t.get(e);s&&(s.clear(),t.delete(e));for(const[s,n]of t.entries())n.delete(e)&&0===n.size&&t.delete(s)}GetSize(){let e=0;for(const t of this._firstMap.values())e+=t.size;return e}*values(){for(const e of this._firstMap.values())yield*e.values()}*keyPairs(){for(const[e,t]of this._firstMap.entries())for(const s of t.keys())yield[e,s]}*entries(){for(const[e,t]of this._firstMap.entries())for(const[s,n]of t.entries())yield[e,s,n]}}}{const uo=self.C3;uo.ArraySet=class extends uo.DefendedBase{constructor(){super(),this._set=new Set,this._arr=[],this._needToRebuildArray=!1}Release(){this.Clear()}Clear(){this._set.clear(),uo.clearArray(this._arr),this._needToRebuildArray=!1}Add(e){this._set.has(e)||(this._set.add(e),this._needToRebuildArray||this._arr.push(e))}Has(e){return this._set.has(e)}Delete(e){this._set.delete(e)&&(this._needToRebuildArray=!0)}GetSize(){return this._set.size}IsEmpty(){return 0===this._set.size}GetArray(){return this._needToRebuildArray&&(this._RebuildArray(),this._needToRebuildArray=!1),this._arr}_RebuildArray(){const e=this._arr;uo.clearArray(e);for(const t of this._set)e.push(t)}}}{const po=self.C3,fo=new Map,mo=new Map,go=new Map,Io=new Map,So=new Map,yo=new Map,bo=new Map,Go=new Map,vo=new Map;vo.set("linear","noease"),vo.set("default","noease");const xo=["default","noease","easeinquad","easeoutquad","easeinoutquad","easeincubic","easeoutcubic","easeinoutcubic","easeinquart","easeoutquart","easeinoutquart","easeinquint","easeoutquint","easeinoutquint","easeinsine","easeoutsine","easeinoutsine","easeinexpo","easeoutexpo","easeinoutexpo","easeincirc","easeoutcirc","easeinoutcirc","easeinelastic","easeoutelastic","easeinoutelastic","easeinback","easeoutback","easeinoutback","easeinbounce","easeoutbounce","easeinoutbounce"],To=["default","noease","quad","cubic","quart","quint","sine","expo","circ","elastic","back","bounce"],Co=new Map([["linear","noease"],["in-sine","easeinsine"],["out-sine","easeoutsine"],["in-out-sine","easeinoutsine"],["in-elastic","easeinelastic"],["out-elastic","easeoutelastic"],["in-out-elastic","easeinoutelastic"],["in-back","easeinback"],["out-back","easeoutback"],["in-out-back","easeinoutback"],["in-bounce","easeinbounce"],["out-bounce","easeoutbounce"],["in-out-bounce","easeinoutbounce"],["in-cubic","easeincubic"],["out-cubic","easeoutcubic"],["in-out-cubic","easeinoutcubic"],["in-quadratic","easeinquad"],["out-quadratic","easeoutquad"],["in-out-quadratic","easeinoutquad"],["in-quartic","easeinquart"],["out-quartic","easeoutquart"],["in-out-quartic","easeinoutquart"],["in-quintic","easeinquint"],["out-quintic","easeoutquint"],["in-out-quintic","easeinoutquint"],["in-circular","easeincirc"],["out-circular","easeoutcirc"],["in-out-circular","easeinoutcirc"],["in-exponential","easeinexpo"],["out-exponential","easeoutexpo"],["in-out-exponential","easeinoutexpo"]]);self.Ease=class e{constructor(){}static InheritEase(){return"default"}static DefaultEase(){return"noease"}static ToInternal(e){return Co.get(e)}static GetEditorEaseNames(t,...s){let n,i;this._CreateEaseMap(),t?(go.has(t)||go.set(t,new Map),n=go.get(t),i=[...n.keys()].filter((s=>!e.GetEditorEaseData(s,t)||e.GetEditorEaseData(s,t).transition.IsForAnyPurpose()))):(n=So,i=[...n.keys()]);const r=i.sort();return[...mo.keys()].concat(r).filter((e=>!s.includes(e)))}static GetRuntimeEaseNames(){this._CreateEaseMap();const e=[...So.keys()];return e.sort(),[...mo.keys()].concat(e)}static GetCustomRuntimeEaseNames(){this._CreateEaseMap();const e=[...So.keys()];return e.sort(),e}static IsPredefinedTranslatedName(e){for(const t of xo)if(self.lang(`ui.bars.timeline.eases.${t}`)===e)return!0;for(const t of To)if(self.lang(`ui.bars.timeline.short-eases.${t}`)===e)return!0}static IsNamePredefined(e){return this._CreateEaseMap(),[...mo.keys()].includes(e)}static _GetEase(t){const s=vo.get(t);return s?fo.get(s):e.IsNamePredefined(t)?fo.get(t):bo.has(t)?bo.get(t):void 0}static GetBuiltInTransition(e){return this._CreateEaseMap(),Go.get(e)}static GetEditorEase(t,s){this._CreateEaseMap();const n=e._GetEase(t);if(n)return n;if(!s)throw new Error("missing ease function");return go.get(s).get(t)}static GetEditorEaseData(e,t){this._CreateEaseMap();const s=Io.get(t);if(s)return s.get(e)}static HasEditorEase(t,s){return this._CreateEaseMap(),!!e._GetEase(t)||!!go.get(s).get(t)}static GetRuntimeEase(t){this._CreateEaseMap();return e._GetEase(t)||So.get(t)}static GetRuntimeEaseData(e){return this._CreateEaseMap(),yo.get(e)}static GetEaseFromIndex(e){return this._CreateEaseMap(),this.GetRuntimeEaseNames()[e]}static GetIndexForEase(e,t){return this._CreateEaseMap(),this.GetEditorEaseNames(t).indexOf(e)}static GetIndexForEaseAtRuntime(e){return this.GetIndexForEase(e)}static _CreateEaseMap(){0===fo.size&&(this._AddPredifinedEase("default",(()=>{})),this._AddPredifinedEase("noease",[{x:0,y:0,sax:.336,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.336,eay:0,se:!1,ee:!0}],!0),this._AddPredifinedEase("easeinsine",[{x:0,y:0,sax:.485,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.038,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutsine",[{x:0,y:0,sax:.038,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.485,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutsine",[{x:0,y:0,sax:.336,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.336,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinelastic",[{x:0,y:0,sax:.018,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.116,y:.002,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.266,y:-.005,sax:.024,say:0,eax:-.021,eay:0,se:!0,ee:!0},{x:.416,y:.016,sax:.024,say:0,eax:-.026,eay:0,se:!0,ee:!0},{x:.566,y:-.045,sax:.061,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.716,y:.132,sax:.072,say:-.004,eax:-.045,eay:0,se:!0,ee:!0},{x:.866,y:-.373,sax:.06,say:0,eax:-.049,eay:-.002,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.038,eay:-.263,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutelastic",[{x:0,y:0,sax:.038,say:.263,eax:0,eay:0,se:!0,ee:!1},{x:.136,y:1.373,sax:.049,say:.002,eax:-.06,eay:0,se:!0,ee:!0},{x:.286,y:.868,sax:.045,say:0,eax:-.072,eay:.004,se:!0,ee:!0},{x:.436,y:1.045,sax:.025,say:0,eax:-.061,eay:0,se:!0,ee:!0},{x:.586,y:.984,sax:.026,say:0,eax:-.024,eay:0,se:!0,ee:!0},{x:.736,y:1.005,sax:.021,say:0,eax:-.024,eay:0,se:!0,ee:!0},{x:.886,y:.998,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.018,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutelastic",[{x:0,y:0,sax:.025,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.067,y:.001,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.18,y:-.005,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.292,y:.025,sax:.053,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.405,y:-.118,sax:.069,say:0,eax:-.027,eay:0,se:!0,ee:!0},{x:.597,y:1.118,sax:.027,say:0,eax:-.069,eay:0,se:!0,ee:!0},{x:.71,y:.975,sax:.025,say:0,eax:-.053,eay:0,se:!0,ee:!0},{x:.822,y:1.005,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.935,y:.999,sax:.025,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.025,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinback",[{x:0,y:0,sax:.35,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.34,eay:-1.579,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutback",[{x:0,y:0,sax:.34,say:1.579,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.35,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutback",[{x:0,y:0,sax:.035,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.242,y:-.1,sax:.258,say:0,eax:-.025,eay:0,se:!0,ee:!0},{x:.76,y:1.1,sax:.025,say:0,eax:-.26,eay:0,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.035,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinbounce",[{x:0,y:0,sax:.033,say:.025,eax:0,eay:0,se:!0,ee:!1},{x:.092,y:0,sax:.026,say:.078,eax:-.033,eay:.025,se:!0,ee:!0},{x:.274,y:0,sax:.097,say:.319,eax:-.026,eay:.078,se:!0,ee:!0},{x:.637,y:0,sax:.105,say:.625,eax:-.097,eay:.319,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.125,eay:-.004,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutbounce",[{x:0,y:0,sax:.125,say:.004,eax:0,eay:0,se:!0,ee:!1},{x:.365,y:1,sax:.097,say:-.319,eax:-.105,eay:-.625,se:!0,ee:!0},{x:.728,y:1,sax:.026,say:-.078,eax:-.097,eay:-.319,se:!0,ee:!0},{x:.91,y:1,sax:.033,say:-.025,eax:-.026,eay:-.078,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.033,eay:-.025,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutbounce",[{x:0,y:0,sax:.01,say:.006,eax:0,eay:0,se:!0,ee:!1},{x:.046,y:0,sax:.021,say:.038,eax:-.01,eay:.006,se:!0,ee:!0},{x:.137,y:0,sax:.059,say:.158,eax:-.021,eay:.038,se:!0,ee:!0},{x:.319,y:0,sax:.117,say:.744,eax:-.059,eay:.158,se:!0,ee:!0},{x:.683,y:1,sax:.059,say:-.158,eax:-.117,eay:-.744,se:!0,ee:!0},{x:.865,y:1,sax:.021,say:-.038,eax:-.059,eay:-.158,se:!0,ee:!0},{x:.956,y:1,sax:.01,say:-.006,eax:-.021,eay:-.038,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.01,eay:-.006,se:!1,ee:!0}]),this._AddPredifinedEase("easeincubic",[{x:0,y:0,sax:.75,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.138,eay:-.321,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutcubic",[{x:0,y:0,sax:.138,say:.321,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.75,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutcubic",[{x:0,y:0,sax:.285,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.5,y:.5,sax:.081,say:.272,eax:-.081,eay:-.272,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.285,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinquad",[{x:0,y:0,sax:.4,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.178,eay:-.392,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutquad",[{x:0,y:0,sax:.178,say:.392,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.4,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutquad",[{x:0,y:0,sax:.25,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.5,y:.5,sax:.03,say:.065,eax:-.03,eay:-.065,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.25,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinquart",[{x:0,y:0,sax:.25,say:1,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.5,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutquart",[{x:0,y:0,sax:.5,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.25,eay:-1,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutquart",[{x:0,y:0,sax:.765,say:.03,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.765,eay:-.03,se:!1,ee:!0}]),this._AddPredifinedEase("easeinquint",[{x:0,y:0,sax:.6,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.2,eay:-1,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutquint",[{x:0,y:0,sax:.2,say:1,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.6,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutquint",[{eax:0,eay:0,ee:!1,sax:.84,say:0,se:!0,x:0,y:0},{eax:-.84,eay:0,ee:!0,sax:0,say:0,se:!1,x:1,y:1}]),this._AddPredifinedEase("easeincirc",[{x:0,y:0,sax:.25,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.024,eay:-.808,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutcirc",[{x:0,y:0,sax:.024,say:.808,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.25,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutcirc",[{x:0,y:0,sax:.125,say:0,eax:0,eay:0,se:!0,ee:!1},{x:.5,y:.5,sax:.02,say:.428,eax:-.02,eay:-.428,se:!0,ee:!0},{x:1,y:1,sax:0,say:0,eax:-.125,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinexpo",[{x:0,y:0,sax:.66,say:0,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.14,eay:-1,se:!1,ee:!0}]),this._AddPredifinedEase("easeoutexpo",[{x:0,y:0,sax:.14,say:1,eax:0,eay:0,se:!0,ee:!1},{x:1,y:1,sax:0,say:0,eax:-.66,eay:0,se:!1,ee:!0}]),this._AddPredifinedEase("easeinoutexpo",[{eax:0,eay:0,ee:!1,sax:.345,say:0,se:!0,x:0,y:0},{eax:-.06,eay:-.5,ee:!0,sax:.06,say:.5,se:!0,x:.5,y:.5},{eax:-.335,eay:0,ee:!0,sax:0,say:0,se:!1,x:1,y:1}]),this._AddPrivateCustomEase("cubicbezier",this.EaseCubicBezier),this._AddPrivateCustomEase("spline",this.EaseSpline))}static _AddPredifinedEase(t,s,n=!1){if("function"==typeof s)e._AddEase(t,s,"predefined");else{if(!po.IsArray(s))throw new Error("unexpected arguments");if(self.BuiltInTransition){const i=po.New(self.BuiltInTransition,t,n);i.SetFromJson(s),e._AddEase(t,((e,t,s,n)=>i.Interpolate(e,t,s,n)),"predefined"),Go.set(t,i)}else{const i=po.New(po.Transition,[t,s.map((e=>[e.x,e.y,e.sax,e.say,e.eax,e.eay,e.se,e.ee]))],!1);i.MakeLinear(n),e._AddEase(t,((e,t,s,n)=>i.Interpolate(e,t,s,n)),"predefined")}}}static _AddPrivateCustomEase(t,s){e._AddEase(t,s,"private")}static AddCustomEase(t,s,n,i){this._CreateEaseMap(),e._AddEase(t,s,"custom",n,i)}static RemoveCustomEase(e,t){if(this.IsNamePredefined(e))return;if([...bo.keys()].includes(e))return;const s=go.get(t);s&&s.delete(e);const n=Io.get(t);n&&n.delete(e)}static _AddEase(e,t,s,n,i){switch(s){case"predefined":fo.set(e,t),mo.set(e,t);break;case"custom":n?(go.has(n)||go.set(n,new Map),Io.has(n)||Io.set(n,new Map),go.get(n).set(e,t),Io.get(n).set(e,i)):(So.set(e,t),yo.set(e,i));break;case"private":fo.set(e,t),bo.set(e,t);break;default:throw new Error("unexpected ease mode")}}static NoEase(e,t,s,n){return 0===n?t:s*e/n+t}static EaseCubicBezier(e,t,s,n,i){return t+3*e*(s-t)+3*e**2*(t+n-2*s)+e**3*(i-t+3*s-3*n)}static EaseSpline(e,t,s,n,i,r,a,o,l,c){if(n===i&&r===a)return e;const h=Oo(e,t,n,r,o,c),_=Mo(s,i,a,l),u=ko(s,i,a,l),d=Lo(s,i,a,l);return Fo(h,_,u,d)}static GetBezierSamples(e,t,s,n){const i=[],r=Mo(e,t,s,n),a=ko(e,t,s,n),o=Lo(e,t,s,n);for(let e=0;e<wo;++e){const t=Fo(e*Po,r,a,o);i.push(t)}return i}};const wo=11,Po=1/(wo-1),Ao=4,Ro=.01,Do=1e-7,Eo=10,Mo=(e,t,s,n)=>n-3*s+3*t-e,ko=(e,t,s,n)=>3*s-6*t+3*e,Lo=(e,t,s,n)=>3*(t-e),Fo=(e,t,s,n)=>((t*e+s)*e+n)*e,Bo=(e,t,s,n)=>3*t*e*e+2*s*e+n,Oo=(e,t,s,n,i,r)=>{if(1==e)return 1;let a=0,o=1,l=r[o],c=wo-1;for(r[wo-1];o!=c&&l<=e;)o++,l=r[o],a+=Po;o--,l=r[o];let h=a+(e-l)/(r[o+1]-l)*Po;const _=Mo(t,s,n,i),u=ko(t,s,n,i),d=Lo(t,s,n,i),p=Bo(h,_,u,d);if(0===p)return h;if(p>=.01){for(let t=0;t<4;++t)h-=(Fo(h,_,u,d)-e)/Bo(h,_,u,d);return h}{let t,s,n=a,i=a+Po,r=0;do{h=n+(i-n)/2;let a=Fo(h,_,u,d)-e;a>0?i=h:n=h,t=Math.abs(a)>1e-7,s=++r<10}while(t&&s);return h}}}{let No=function(e){Wo.IsString(e)};RequireStringOrNumber=No;const Wo=self.C3;Wo.ProbabilityTable=class{constructor(e){this._items=[],this._name=e||"",this._totalWeight=0}Release(){this.Clear(),this._items=null}GetName(){return this._name}Clear(){Wo.clear2DArray(this._items),this._totalWeight=0}GetTotalWeight(){return this._totalWeight}Sample(e=Math.random()*this.GetTotalWeight()){let t=0;for(const[s,n]of this._items)if(t+=s,e<t)return n;return 0}HasItems(){return!!this._items.length}AddItem(e,t){No(t),this._totalWeight+=e,this._items.push([e,t])}RemoveItem(e,t){No(t);const s=0===e;for(let n=0;n<this._items.length;n++){const i=this._items[n],r=s||i[0]===e,a=i[1]===t;if(r&&a){this._items.splice(n,1),this._totalWeight-=i[0];break}}}asJSON(){return JSON.stringify(this._items)}static fromJSON(e,t){const s=new Wo.ProbabilityTable(t),n=JSON.parse(e);for(const e of n){const t=e[0],n=e[1];s.AddItem(t,n)}return s}}}{const Vo=self.C3;let jo=0;Vo.ScreenReaderText=class{constructor(e,t){this._runtime=e,this._text=t,this._id=jo++,this._runtime.PostComponentMessageToDOM("runtime","screen-reader-text",{type:"create",id:this._id,text:this._text})}Release(){this._runtime.PostComponentMessageToDOM("runtime","screen-reader-text",{type:"release",id:this._id}),this._runtime=null,this._text="",this._id=-1}SetText(e){this._text!==e&&(this._text=e,this._runtime.PostComponentMessageToDOM("runtime","screen-reader-text",{type:"update",id:this._id,text:this._text}))}}}{const Uo=self.C3;Uo.Event=class{constructor(e,t){this.type=e,this.cancelable=!!t,this.defaultPrevented=!1,this.propagationStopped=!1,this.isAsync=!1}preventDefault(){if(!this.cancelable)throw new Error(`event '${this.type}' is not cancelable`);this.defaultPrevented=!0}stopPropagation(){if(!this.cancelable)throw new Error(`event '${this.type}' cannot be stopped`);if(this.isAsync)throw new Error(`cannot stop async event '${this.type}' propagation`);this.propagationStopped=!0}}}{const Ho=self.C3,zo=self.assert;Ho.Event.Handler=class extends Ho.DefendedBase{constructor(e){super(),this._type=e,this._captureListeners=[],this._captureListenersSet=new Set,this._listeners=[],this._listenersSet=new Set,this._fireDepth=0,this._queueModifyListeners=[]}Release(){this._fireDepth>0||(Ho.clearArray(this._captureListeners),this._captureListenersSet.clear(),Ho.clearArray(this._listeners),this._listenersSet.clear(),Ho.clearArray(this._queueModifyListeners),Ho.Release(this))}_AddListener(e,t){if(this._IsFiring())this._queueModifyListeners.push({op:"add",func:e,capture:t});else if(t){if(this._captureListenersSet.has(e))return;this._captureListeners.push(e),this._captureListenersSet.add(e)}else{if(this._listenersSet.has(e))return;this._listeners.push(e),this._listenersSet.add(e)}}_RemoveListener(e,t){this._IsFiring()?this._queueModifyListeners.push({op:"remove",func:e,capture:t}):t?this._captureListenersSet.has(e)&&(this._captureListenersSet.delete(e),Ho.arrayFindRemove(this._captureListeners,e)):this._listenersSet.has(e)&&(this._listenersSet.delete(e),Ho.arrayFindRemove(this._listeners,e))}_IsEmpty(){return!this._captureListeners.length&&!this._listeners.length}_IsFiring(){return this._fireDepth>0}_ProcessQueuedListeners(){const e=new Set,t=new Set;for(const s of this._queueModifyListeners)if("add"===s.op)this._AddListener(s.func,s.capture),s.capture?t.delete(s.func):e.delete(s.func);else{if("remove"!==s.op)throw new Error("invalid op");s.capture?(this._captureListenersSet.delete(s.func),t.add(s.func)):(this._listenersSet.delete(s.func),e.add(s.func))}Ho.arrayRemoveAllInSet(this._listeners,e),Ho.arrayRemoveAllInSet(this._captureListeners,t),Ho.clearArray(this._queueModifyListeners)}_FireCancellable(e){this._IncreaseFireDepth();let t=!1;for(let s=0,n=this._captureListeners.length;s<n;++s)if(this._captureListeners[s](e),e.propagationStopped){t=!0;break}if(!t)for(let t=0,s=this._listeners.length;t<s&&(this._listeners[t](e),!e.propagationStopped);++t);return this._DecreaseFireDepth(),!e.defaultPrevented}_FireNonCancellable(e){this._IncreaseFireDepth();for(let t=0,s=this._captureListeners.length;t<s;++t)this._captureListeners[t](e);for(let t=0,s=this._listeners.length;t<s;++t)this._listeners[t](e);return this._DecreaseFireDepth(),!0}_IncreaseFireDepth(){this._fireDepth++}_DecreaseFireDepth(){this._fireDepth--,0===this._fireDepth&&this._queueModifyListeners.length>0&&this._ProcessQueuedListeners()}SetDelayRemoveEventsEnabled(e){e?this._IncreaseFireDepth():this._DecreaseFireDepth()}_FireAsync(e){let t=[];for(let s=0,n=this._captureListeners.length;s<n;++s){let n=this._captureListeners[s];t.push(Ho.Asyncify((()=>n(e))))}for(let s=0,n=this._listeners.length;s<n;++s){let n=this._listeners[s];t.push(Ho.Asyncify((()=>n(e))))}return Promise.all(t).then((()=>!e.defaultPrevented))}_FireAndWait_AsyncOptional(e){const t=[];this._IncreaseFireDepth();for(let s=0,n=this._captureListeners.length;s<n;++s){const n=this._captureListeners[s](e);n instanceof Promise&&t.push(n)}for(let s=0,n=this._listeners.length;s<n;++s){const n=this._listeners[s](e);n instanceof Promise&&t.push(n)}return this._DecreaseFireDepth(),t.length?Promise.all(t).then((()=>!e.defaultPrevented)):!e.defaultPrevented}async _FireAndWaitAsync(e){return await this._FireAndWait_AsyncOptional(e)}async _FireAndWaitAsyncSequential(e){this._IncreaseFireDepth();for(let t=0,s=this._captureListeners.length;t<s;++t){const s=this._captureListeners[t](e);s instanceof Promise&&await s}for(let t=0,s=this._listeners.length;t<s;++t){const s=this._listeners[t](e);s instanceof Promise&&await s}return this._DecreaseFireDepth(),!e.defaultPrevented}*_FireAsGenerator(e){this._IncreaseFireDepth();for(let t=0,s=this._captureListeners.length;t<s;++t){const s=this._captureListeners[t](e);Ho.IsIterator(s)&&(yield*s)}for(let t=0,s=this._listeners.length;t<s;++t){const s=this._listeners[t](e);Ho.IsIterator(s)&&(yield*s)}this._DecreaseFireDepth()}}}{const Xo=self.C3;Xo.Event.Dispatcher=class extends Xo.DefendedBase{constructor(){super(),this._eventHandlers=new Map,this._dispatcherWasReleased=!1}Release(){if(this._dispatcherWasReleased)throw new Error("already released");this.ClearEvents(),this._dispatcherWasReleased=!0,Xo.Release(this)}WasReleased(){return this._dispatcherWasReleased}ClearEvents(){if(this._eventHandlers){for(let e of this._eventHandlers.values())e.Release();this._eventHandlers.clear()}}_GetHandlerByType(e,t){let s=this._eventHandlers.get(e);return s||(t?(s=Xo.New(Xo.Event.Handler,e),this._eventHandlers.set(e,s),s):null)}HasAnyHandlerFor(e){return this._eventHandlers.has(e)}addEventListener(e,t,s){this._GetHandlerByType(e,!0)._AddListener(t,!!s)}removeEventListener(e,t,s){let n=this._GetHandlerByType(e,!1);n&&(n._RemoveListener(t,!!s),n._IsEmpty()&&this._eventHandlers.delete(e))}dispatchEvent(e){const t=this._GetHandlerByType(e.type,!1);return!t||(e.cancelable?t._FireCancellable(e):t._FireNonCancellable(e))}dispatchEventAsync(e){const t=this._GetHandlerByType(e.type,!1);return t?(e.isAsync=!0,t._FireAsync(e)):Promise.resolve(!0)}async dispatchEventAndClearAsync(e){const t=this._GetHandlerByType(e.type,!1);if(!t)return!0;this._eventHandlers.delete(e.type),e.isAsync=!0;const s=await t._FireAsync(e);return t.Release(),s}async dispatchEventAndWaitAsync(e){const t=this._GetHandlerByType(e.type,!1);return!t||await t._FireAndWaitAsync(e)}dispatchEventAndWait_AsyncOptional(e){const t=this._GetHandlerByType(e.type,!1);return!t||t._FireAndWait_AsyncOptional(e)}async dispatchEventAndWaitAsyncSequential(e){const t=this._GetHandlerByType(e.type,!1);return!t||await t._FireAndWaitAsyncSequential(e)}dispatchGeneratorEvent(e){const t=this._GetHandlerByType(e.type,!1);if(!t)return null;if(e.cancelable)throw new Error("not supported");return t._FireAsGenerator(e)}SetDelayRemoveEventsEnabled(e){for(const t of this._eventHandlers.values())t.SetDelayRemoveEventsEnabled(e)}}}{let Yo=function(e){sl=el&&0===nl?requestIdleCallback(qo,{timeout:35}):setTimeout(qo,nl>0?1:e)},qo=function(e){if(sl=-1,!tl.length)return;let t=performance.now(),s=t,n=0,i=0;do{Jo(tl.shift()),s=performance.now(),++n,i=(s-t)/n*1.1}while(tl.length&&(el&&0===nl&&void 0!==e?i<e.timeRemaining():s-t+i<12));if(-1===sl&&tl.length){let e=s-t;Yo(Math.max(16-e,4))}},Jo=function(e){let t;try{t=e.func()}catch(t){return void e.reject(t)}e.resolve(t)};SetNewCallback=Yo,DoAsyncifiedWork=qo,DoNextAsyncifiedJob=Jo;const Ko=self.C3,$o=12,Zo=16,Qo=35,el="undefined"!=typeof requestIdleCallback;let tl=[],sl=-1,nl=0,il=Ko.QueryString.Has("disable-asyncify");il&&console.warn("[Asyncify] Asyncify has been disabled due to disable-asyncify in the query string. Some work will now be done synchronously."),Ko.Asyncify=function(e){let t=null;return Ko.isDebug&&(t=Ko.GetCallStack()),new Promise(((s,n)=>{tl.push({func:e,resolve:s,reject:n,stack:t}),il?Jo(tl.pop()):-1===sl&&Yo(16)}))},Ko.Asyncify.SetHighThroughputMode=function(e){if(e)++nl;else if(--nl,nl<0)throw new Error("already turned off high throughput mode")}}{let rl=function(){hl=-1},al=function(){_l=-1,ul=-1;let e=Date.now();for(let t of dl)if(t._CheckTimeout(e)){let e=t._GetDeadline();(-1===ul||e<ul)&&(ul=e)}else dl.delete(t);if(-1!==ul){let t=Math.max(ul-e+100,1e3);_l=self.setTimeout(al,t)}};ClearTimeCache=rl,CheckActiveIdleTimeouts=al;const ol=self.C3,ll=1e3,cl=100;let hl=-1;ol.FastGetDateNow=function(){return-1===hl&&(hl=Date.now(),self.setTimeout(rl,16)),hl};let _l=-1,ul=-1,dl=new Set;ol.IdleTimeout=class{constructor(e,t){this._callback=e,this._timeout=1e3*t,this._deadline=0,this._isActive=!1}Reset(){let e=ol.FastGetDateNow();this._deadline=e+this._timeout,this._isActive||(dl.add(this),this._isActive=!0),-1===_l?(ul=this._deadline,_l=self.setTimeout(al,this._timeout+100)):this._deadline<ul&&ul>e+1e3&&(self.clearTimeout(_l),ul=this._deadline,_l=self.setTimeout(al,this._timeout+100))}_CheckTimeout(e){return!(e>=this._deadline&&(this._callback()?(this._deadline=e+this._timeout,0):(this._isActive=!1,1)))}_GetDeadline(){return this._deadline}Cancel(){this._isActive&&(dl.delete(this),this._isActive=!1,0===dl.size&&-1!==_l&&(self.clearTimeout(_l),_l=-1,ul=-1))}Release(){this.Cancel(),this._callback=null}}}{const pl=self.C3;pl.Disposable=class e{constructor(e){this._disposed=!1,this._disposeAction=e}Dispose(){this._disposed||(this._disposed=!0,this._disposeAction&&(this._disposeAction(),this._disposeAction=null))}IsDisposed(){return this._disposed}Release(){this.Dispose()}static Release(t){return new e((()=>t.Release()))}static From(e,t,s,n,i){if("string"!=typeof t&&!Array.isArray(t))throw new TypeError("expected string or array");if(null==n)n=!1;else if("boolean"!=typeof n&&"object"!=typeof n)throw new TypeError("invalid event listener options");if(i&&(s=s.bind(i)),Array.isArray(t)||t.includes(" ")){"string"==typeof t&&(t=t.split(" "));const i=new pl.CompositeDisposable;for(const r of t)e.addEventListener(r,s,n),i.Add(pl.New(pl.Disposable,(()=>e.removeEventListener(r,s,n))));return i}return e.addEventListener(t,s,n),pl.New(pl.Disposable,(()=>e.removeEventListener(t,s,n)))}},pl.StubDisposable=class extends pl.Disposable{SetAction(e){this._disposeAction=e}},pl.CompositeDisposable=class extends pl.Disposable{constructor(...e){super(),this._disposables=new Set;for(let t of e)this.Add(t)}Add(...e){if(this._disposed)throw new Error("already disposed");for(let t of e)this._disposables.add(t)}Remove(e){if(this._disposed)throw new Error("already disposed");this._disposables.delete(e)}RemoveAll(){if(this._disposed)throw new Error("already disposed");if(this._disposables){for(let e of this._disposables)e.Dispose();this._disposables.clear()}}IsDisposed(){return this._disposed}Dispose(){if(this._disposed)throw new Error("already disposed");this._disposed=!0;for(let e of this._disposables)e.Dispose();this._disposables.clear(),this._disposables=null}Release(){this.Dispose()}}}{const fl=self.C3;fl.KahanSum=class extends fl.DefendedBase{constructor(){super(),this._c=0,this._y=0,this._t=0,this._sum=0}Add(e){e=+e,this._y=e-this._c,this._t=this._sum+this._y,this._c=this._t-this._sum-this._y,this._sum=this._t}Subtract(e){this._sum-=+e}Get(){return this._sum}Reset(){this._c=0,this._y=0,this._t=0,this._sum=0}Set(e){this._c=0,this._y=0,this._t=0,this._sum=+e}Copy(e){this._c=e._c,this._y=e._y,this._t=e._t,this._sum=e._sum}Release(){}}}{const ml=self.C3,gl={},Il=!0,Sl=!1;gl.RBnode=function(e){this.tree=e,this.right=this.tree.sentinel,this.left=this.tree.sentinel,this.parent=null,this.color=!1,this.key=null},gl.RedBlackSet=function(e){this.size=0,this.sentinel=new gl.RBnode(this),this.sentinel.color=!1,this.root=this.sentinel,this.root.parent=this.sentinel,this.compare=e||this.default_compare},gl.RedBlackSet.prototype.default_compare=function(e,t){return e<t?-1:t<e?1:0},gl.RedBlackSet.prototype.clone=function(){var e=new gl.RedBlackSet(this.compare);return e.insertAll(this),e},gl.RedBlackSet.prototype.clear=function(){this.size=0,this.sentinel=new gl.RBnode(this),this.sentinel.color=!1,this.root=this.sentinel,this.root.parent=this.sentinel},gl.RedBlackSet.prototype.leftRotate=function(e){var t=e.right;e.right=t.left,t.left!=this.sentinel&&(t.left.parent=e),t.parent=e.parent,e.parent==this.sentinel?this.root=t:e==e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t},gl.RedBlackSet.prototype.rightRotate=function(e){var t=e.left;e.left=t.right,t.right!=this.sentinel&&(t.right.parent=e),t.parent=e.parent,e.parent==this.sentinel?this.root=t:e==e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t},gl.RedBlackSet.prototype.insert=function(e){if(this.contains(e))this.get_(e).key=e;else{var t=new gl.RBnode(this);t.key=e;for(var s=this.sentinel,n=this.root;n!=this.sentinel;)s=n,n=this.compare(t.key,n.key)<0?n.left:n.right;t.parent=s,s==this.sentinel?this.root=t:this.compare(t.key,s.key)<0?s.left=t:s.right=t,t.left=this.sentinel,t.right=this.sentinel,t.color=Il,this.insertFixup(t),this.size++}},gl.RedBlackSet.prototype.insertFixup=function(e){for(;e!=this.sentinel&&e!=this.root&&e.parent.color==Il;){var t;e.parent==e.parent.parent.left?(t=e.parent.parent.right).color==Il?(e.parent.color=!1,t.color=!1,e.parent.parent.color=Il,e=e.parent.parent):(e==e.parent.right&&(e=e.parent,this.leftRotate(e)),e.parent.color=!1,e.parent.parent.color=Il,e.parent.parent!=this.sentinel&&this.rightRotate(e.parent.parent)):(t=e.parent.parent.left).color==Il?(e.parent.color=!1,t.color=!1,e.parent.parent.color=Il,e=e.parent.parent):(e==e.parent.left&&(e=e.parent,this.rightRotate(e)),e.parent.color=!1,e.parent.parent.color=Il,e.parent.parent!=this.sentinel&&this.leftRotate(e.parent.parent))}this.root.color=!1},gl.RedBlackSet.prototype.delete_=function(e){var t,s;(s=(t=e.left==this.sentinel||e.right==this.sentinel?e:this.successor_(e)).left!=this.sentinel?t.left:t.right).parent=t.parent,t.parent==this.sentinel?this.root=s:t==t.parent.left?t.parent.left=s:t.parent.right=s,t!=e&&(e.key=t.key),0==t.color&&this.deleteFixup(s),this.size--},gl.RedBlackSet.prototype.deleteFixup=function(e){for(;e!=this.root&&0==e.color;){var t;e==e.parent.left?((t=e.parent.right).color==Il&&(t.color=!1,e.parent.color=Il,this.leftRotate(e.parent),t=e.parent.right),0==t.left.color&&0==t.right.color?(t.color=Il,e=e.parent):(0==t.right.color&&(t.left.color=!1,t.color=Il,this.rightRotate(t),t=e.parent.right),t.color=e.parent.color,e.parent.color=!1,t.right.color=!1,this.leftRotate(e.parent),e=this.root)):((t=e.parent.left).color==Il&&(t.color=!1,e.parent.color=Il,this.rightRotate(e.parent),t=e.parent.left),0==t.right.color&&0==t.left.color?(t.color=Il,e=e.parent):(0==t.left.color&&(t.right.color=!1,t.color=Il,this.leftRotate(t),t=e.parent.left),t.color=e.parent.color,e.parent.color=!1,t.left.color=!1,this.rightRotate(e.parent),e=this.root))}e.color=!1},gl.RedBlackSet.prototype.remove=function(e){var t=this.get_(e);if(t!=this.sentinel){var s=t.key;return this.delete_(t),s}return null},gl.RedBlackSet.prototype.removeSwapped=function(e,t){this.remove(t)},gl.RedBlackSet.prototype.min=function(e){for(;e.left!=this.sentinel;)e=e.left;return e},gl.RedBlackSet.prototype.max=function(e){for(;e.right!=this.sentinel;)e=e.right;return e},gl.RedBlackSet.prototype.successor_=function(e){if(e.right!=this.sentinel)return this.min(e.right);for(var t=e.parent;t!=this.sentinel&&e==t.right;)e=t,t=t.parent;return t},gl.RedBlackSet.prototype.predeccessor_=function(e){if(e.left!=this.sentinel)return this.max(e.left);for(var t=e.parent;t!=this.sentinel&&e==t.left;)e=t,t=t.parent;return t},gl.RedBlackSet.prototype.successor=function(e){if(this.size>0){var t=this.get_(e);if(t==this.sentinel)return null;if(t.right!=this.sentinel)return this.min(t.right).key;for(var s=t.parent;s!=this.sentinel&&t==s.right;)t=s,s=s.parent;return s!=this.sentinel?s.key:null}return null},gl.RedBlackSet.prototype.predecessor=function(e){if(this.size>0){var t=this.get_(e);if(t==this.sentinel)return null;if(t.left!=this.sentinel)return this.max(t.left).key;for(var s=t.parent;s!=this.sentinel&&t==s.left;)t=s,s=s.parent;return s!=this.sentinel?s.key:null}return null},gl.RedBlackSet.prototype.getMin=function(){return this.min(this.root).key},gl.RedBlackSet.prototype.getMax=function(){return this.max(this.root).key},gl.RedBlackSet.prototype.get_=function(e){for(var t=this.root;t!=this.sentinel&&0!=this.compare(t.key,e);)t=this.compare(e,t.key)<0?t.left:t.right;return t},gl.RedBlackSet.prototype.contains=function(e){return null!=this.get_(e).key},gl.RedBlackSet.prototype.getValues=function(){var e=[];return this.forEach((function(t){e.push(t)})),e},gl.RedBlackSet.prototype.insertAll=function(e){if("array"==gl.typeOf(e))for(var t=0;t<e.length;t++)this.insert(e[t]);else if("function"==gl.typeOf(e.forEach))e.forEach(this.insert,this);else if("function"==gl.typeOf(e.getValues)){var s=e.getValues();for(t=0;t<s.length;t++)this.insert(s[t])}else if("object"==gl.typeOf(e))for(var n in e)this.insert(e[n])},gl.RedBlackSet.prototype.removeAll=function(e){if("array"==gl.typeOf(e))for(var t=0;t<e.length;t++)this.remove(e[t]);else if("function"==gl.typeOf(e.forEach))e.forEach(this.removeSwapped,this);else if("function"==gl.typeOf(e.getValues)){var s=e.getValues();for(t=0;t<s.length;t++)this.remove(s[t])}else if("object"==gl.typeOf(e))for(var n in e)this.remove(e[n])},gl.RedBlackSet.prototype.containsAll=function(e){if("array"==gl.typeOf(e)){for(var t=0;t<e.length;t++)if(!this.contains(e[t]))return!1;return!0}if("function"==gl.typeOf(e.forEach))return e.every(this.contains,this);if("function"==gl.typeOf(e.getValues)){var s=e.getValues();for(t=0;t<s.length;t++)if(!this.contains(s[t]))return!1;return!0}if("object"==gl.typeOf(e)){for(var n in e)if(!this.contains(e[n]))return!1;return!0}},gl.RedBlackSet.prototype.range=function(e,t){var s=[];return this.traverseFromTo((function(e){s.push(e)}),e,t),s},gl.RedBlackSet.prototype.traverse=function(e,t){if(!this.isEmpty())for(var s=this.min(this.root);s!=this.sentinel;){if(e.call(t,s.key,this))return;s=this.successor_(s)}},gl.RedBlackSet.prototype.traverseFrom=function(e,t,s){if(!this.isEmpty())for(var n=this.get_(t);n!=this.sentinel;){if(e.call(s,n.key,this))return;n=this.successor_(n)}},gl.RedBlackSet.prototype.traverseTo=function(e,t,s){if(!this.isEmpty())for(var n=this.min(this.root),i=this.get_(t);n!=i;){if(e.call(s,n.key,this))return;n=this.successor_(n)}},gl.RedBlackSet.prototype.traverseFromTo=function(e,t,s,n){if(!this.isEmpty())for(var i=this.get_(t),r=this.get_(s);i!=r;){if(e.call(n,i.key,this))return;i=this.successor_(i)}},gl.RedBlackSet.prototype.traverseBackwards=function(e,t){if(!this.isEmpty())for(var s=this.max(this.root);s!=this.sentinel;){if(e.call(t,s.key,this))return;s=this.predeccessor_(s)}},gl.RedBlackSet.prototype.forEach=function(e,t){if(!this.isEmpty())for(var s=this.min(this.root);s!=this.sentinel;s=this.successor_(s))e.call(t,s.key,s.key,this)},gl.RedBlackSet.prototype.some=function(e,t){if(this.isEmpty())return!1;for(var s=this.min(this.root);s!=this.sentinel;s=this.successor_(s))if(e.call(t,s.key,s.key,this))return!0;return!1},gl.RedBlackSet.prototype.every=function(e,t){if(this.isEmpty())return!1;for(var s=this.min(this.root);s!=this.sentinel;s=this.successor_(s))if(!e.call(t,s.key,s.key,this))return!1;return!0},gl.RedBlackSet.prototype.map=function(e,t){var s=[];if(this.isEmpty())return s;for(var n=this.min(this.root);n!=this.sentinel;n=this.successor_(n))s.push(e.call(t,n.key,n.key,this));return s},gl.RedBlackSet.prototype.filter=function(e,t){var s=[];if(this.isEmpty())return s;for(var n=this.min(this.root);n!=this.sentinel;n=this.successor_(n))e.call(t,n.key,n.key,this)&&s.push(n.key);return s},gl.RedBlackSet.prototype.getCount=function(){return this.size},gl.RedBlackSet.prototype.isEmpty=function(){return 0==this.size},gl.RedBlackSet.prototype.isSubsetOf=function(e){var t=gl.getCount(e);if(this.getCount()>t)return!1;var s=0;if(this.isEmpty())return!0;for(var n=this.min(this.root);n!=this.sentinel;n=this.successor_(n))gl.contains.call(e,e,n.key)&&s++;return s==this.getCount()},gl.RedBlackSet.prototype.intersection=function(e){var t=new gl.RedBlackSet(this.compare);if(this.isEmpty())return t;for(var s=this.min(this.root);s!=this.sentinel;s=this.successor_(s))e.contains.call(e,s.key,s.key,this)&&t.insert(s.key);return t},ml.RedBlackSet=class extends ml.DefendedBase{constructor(e){super(),this._rbSet=new gl.RedBlackSet(e),this._enableQueue=!1,this._queueInsert=new Set,this._queueRemove=new Set}Add(e){this._enableQueue?this._rbSet.contains(e)?this._queueRemove.delete(e):this._queueInsert.add(e):this._rbSet.insert(e)}Remove(e){this._enableQueue?this._rbSet.contains(e)?this._queueRemove.add(e):this._queueInsert.delete(e):this._rbSet.remove(e)}Has(e){return this._enableQueue?!!this._queueInsert.has(e)||!this._queueRemove.has(e)&&this._rbSet.contains(e):this._rbSet.contains(e)}Clear(){this._rbSet.clear(),this._queueInsert.clear(),this._queueRemove.clear()}toArray(){if(this._enableQueue)throw new Error("cannot be used in queueing mode");return this._rbSet.getValues()}GetSize(){return this._rbSet.getCount()+this._queueInsert.size-this._queueRemove.size}IsEmpty(){return 0===this.GetSize()}Front(){if(this.IsEmpty())throw new Error("empty set");if(this._enableQueue)throw new Error("cannot be used in queueing mode");const e=this._rbSet;return e.min(e.root).key}Shift(){if(this.IsEmpty())throw new Error("empty set");if(this._enableQueue)throw new Error("cannot be used in queueing mode");const e=this.Front();return this.Remove(e),e}SetQueueingEnabled(e){if(e=!!e,this._enableQueue!==e&&(this._enableQueue=e,!e)){for(const e of this._queueRemove)this._rbSet.remove(e);this._queueRemove.clear();for(const e of this._queueInsert)this._rbSet.insert(e);this._queueInsert.clear()}}ForEach(e){this._rbSet.forEach(e)}*values(){if(this.IsEmpty())return;const e=this._rbSet;for(let t=e.min(e.root);t!=e.sentinel;t=e.successor_(t))yield t.key}[Symbol.iterator](){return this.values()}}}{const yl=self.C3;yl.PromiseThrottle=class{constructor(e=yl.hardwareConcurrency){this._maxParallel=e,this._queue=[],this._activeCount=0}Add(e){return new Promise(((t,s)=>{this._queue.push({func:e,resolve:t,reject:s}),this._MaybeStartNext()}))}_FindInQueue(e){for(let t=0,s=this._queue.length;t<s;++t)if(this._queue[t].func===e)return t;return-1}RemoveAndResolve(e,t){const s=this._FindInQueue(e);if(-1===s)throw new Error("cannot find promise to resolve");this._queue[s].resolve(t),this._queue.splice(s,1)}RemoveAndReject(e,t){const s=this._FindInQueue(e);if(-1===s)throw new Error("cannot find promise to reject");this._queue[s].reject(t),this._queue.splice(s,1)}async _MaybeStartNext(){if(!this._queue.length)return;if(this._activeCount>=this._maxParallel)return;this._activeCount++;const e=this._queue.shift();try{const t=await e.func();e.resolve(t)}catch(t){e.reject(t)}this._activeCount--,this._MaybeStartNext()}static async Batch(e,t){const s=[];let n=!1;const i=async e=>{let i;for(;i=t.pop();){if(n)return;try{s.push(await i())}catch(e){throw n=!0,e}}},r=[];for(;e--;)r.push(i());return await Promise.all(r),s}}}{const bl=self.C3;bl.RateLimiter=class{constructor(e,t,s){this._callback=e,this._interval=t,this._intervalOnBattery=s||2*t,this._timerId=-1,this._lastCallTime=-1/0,this._timerCallFunc=()=>this._OnTimer(),this._ignoreReset=!1,this._canRunImmediate=!1,this._callbackArguments=null}SetCanRunImmediate(e){this._canRunImmediate=!!e}_GetInterval(){return void 0!==bl.Battery&&bl.Battery.IsOnBatteryPower()?this._intervalOnBattery:this._interval}Call(...e){if(-1!==this._timerId)return;this._callbackArguments=e;let t=bl.FastGetDateNow(),s=t-this._lastCallTime,n=this._GetInterval();s>=n&&this._canRunImmediate?(this._lastCallTime=t,this._RunCallback()):this._timerId=self.setTimeout(this._timerCallFunc,Math.max(n-s,4))}_RunCallback(){this._ignoreReset=!0;const e=this._callbackArguments;this._callbackArguments=null,e?this._callback(...e):this._callback(),this._ignoreReset=!1}Reset(){this._ignoreReset||(this._CancelTimer(),this._callbackArguments=null,this._lastCallTime=bl.FastGetDateNow())}_OnTimer(){this._timerId=-1,this._lastCallTime=bl.FastGetDateNow(),this._RunCallback()}_CancelTimer(){-1!==this._timerId&&(self.clearTimeout(this._timerId),this._timerId=-1)}Release(){this._CancelTimer(),this._callback=null,this._callbackArguments=null,this._timerCallFunc=null}}}{const Gl=self.C3;Gl.SVGRasterManager=class{constructor(){this._images=new Map,this._allowNpotSurfaces=!1,this._getBaseSizeCallback=null,this._rasterAtSizeCallback=null,this._releaseResultCallback=null,this._redrawCallback=null}SetNpotSurfaceAllowed(e){this._allowNpotSurfaces=!!e}IsNpotSurfaceAllowed(){return this._allowNpotSurfaces}SetGetBaseSizeCallback(e){this._getBaseSizeCallback=e}GetBaseSize(e){if(!this._getBaseSizeCallback)throw new Error("no get base size callback set");return this._getBaseSizeCallback(e)}SetRasterAtSizeCallback(e){this._rasterAtSizeCallback=e}RasterAtSize(e,t,s,n,i,r){if(!this._rasterAtSizeCallback)throw new Error("no raster at size callback set");return this._rasterAtSizeCallback(e,t,s,n,i,r)}SetReleaseResultCallback(e){this._releaseResultCallback=e}ReleaseResult(e){if(!this._releaseResultCallback)throw new Error("no release result callback set");this._releaseResultCallback(e)}SetRedrawCallback(e){this._redrawCallback=e}Redraw(){if(!this._redrawCallback)throw new Error("no redraw callback set");this._redrawCallback()}AddImage(e){let t=this._images.get(e);return t||(t=Gl.New(Gl.SVGRasterImage,this,e),this._images.set(e,t)),t.IncReference(),t}_RemoveImage(e){this._images.delete(e.GetDataSource())}OnTexturesChanged(){for(const e of this._images.values())e.ReleaseRasterizedResult(),e.ForceRasterAgain()}}}{const vl=self.C3,xl=4096;vl.SVGRasterImage=class{constructor(e,t){this._manager=e,this._dataSource=t,this._refCount=0,this._baseWidth=0,this._baseHeight=0,this._getBaseSizePromise=this._manager.GetBaseSize(t).then((e=>{this._manager&&(this._baseWidth=e[0],this._baseHeight=e[1],this._manager.Redraw())})).catch((e=>{console.error("[SVG] Error loading SVG: ",e),this._hadError=!0,this._manager&&this._manager.Redraw()})),this._rasterSurfaceWidth=0,this._rasterSurfaceHeight=0,this._rasterImageWidth=0,this._rasterImageHeight=0,this._isRasterizing=!1,this._rasterizedResult=null,this._forceRaster=!1,this._hadError=!1}Release(){if(this._refCount<=0)throw new Error("already released");this._refCount--,0===this._refCount&&this._Release()}ReleaseRasterizedResult(){this._rasterizedResult&&(this._manager.ReleaseResult(this._rasterizedResult),this._rasterizedResult=null)}_Release(){this.ReleaseRasterizedResult(),this._manager._RemoveImage(this),this._manager=null}GetDataSource(){return this._dataSource}IncReference(){this._refCount++}HasReferences(){return this._refCount>0}GetRasterizedResult(){return this._rasterizedResult}ForceRasterAgain(){this._forceRaster=!0}async StartRasterForSize(e,t,s){if(0===t||0===s||this._hadError)return;if(this._isRasterizing)return;let n=vl.nextHighestPowerOfTwo(Math.ceil(t)),i=vl.nextHighestPowerOfTwo(Math.ceil(s));const r=Math.max(n,i);if(r>4096){const e=4096/r;t*=e,s*=e,n=Math.min(Math.ceil(n*e),4096),i=Math.min(Math.ceil(i*e),4096)}if(t<n&&s<i){const e=t/s;n/i>e?(t=i*e,s=i):(t=n,s=n/e)}if(this._manager.IsNpotSurfaceAllowed()&&(n=Math.ceil(t),i=Math.ceil(s)),n<=this._rasterSurfaceWidth&&i<=this._rasterSurfaceHeight&&!this._forceRaster)return;this._isRasterizing=!0,this._rasterSurfaceWidth=n,this._rasterSurfaceHeight=i;const a=await this._manager.RasterAtSize(this._dataSource,e,this._rasterSurfaceWidth,this._rasterSurfaceHeight,t,s);this._manager&&(this.ReleaseRasterizedResult(),this._rasterizedResult=a,this._rasterImageWidth=t,this._rasterImageHeight=s,this._isRasterizing=!1,this._forceRaster=!1,this._manager.Redraw())}WhenBaseSizeReady(){return this._getBaseSizePromise}GetBaseWidth(){return this._baseWidth}GetBaseHeight(){return this._baseHeight}GetRasterWidth(){return this._rasterImageWidth}GetRasterHeight(){return this._rasterImageHeight}HadError(){return this._hadError}}}{let Tl=function(e){return Dl.get(e)};lookupHtmlEntity=Tl;const Cl=self.C3;Cl.UTF8_BOM="\ufeff";const wl=new Set("0123456789");Cl.IsNumericChar=function(e){return wl.has(e)};const Pl=new Set(" \t\n\r\u2028\u2029");Cl.IsWhitespaceChar=function(e){return Pl.has(e)},Cl.FilterWhitespace=function(e){return[...e].filter((e=>!Cl.IsWhitespaceChar(e))).join("")},Cl.IsStringAllWhitespace=function(e){for(const t of e)if(!Cl.IsWhitespaceChar(t))return!1;return!0},Cl.IsCharArrayAllWhitespace=function(e){for(const t of e)if(!Cl.IsWhitespaceChar(t))return!1;return!0},Cl.IsUnprintableChar=function(e){return 1===e.length&&e.charCodeAt(0)<32},Cl.FilterUnprintableChars=function(e){return[...e].filter((e=>!Cl.IsUnprintableChar(e))).join("")};let Al=null;try{Al=new RegExp("\\p{P}(?<=[\\u3000-\\u303F\\uFF00-\\uFFEF])","u")}catch(t){console.warn("Unable to detect CJK punctuation: ",t)}Cl.IsCJKPunctuationChar=function(e){return!Cl.IsWhitespaceChar(e)&&Al&&Al.test(e)};const Rl=new Set("0123456789.+-e");Cl.IsStringNumber=function(e){if(!(e=e.trim()).length)return!1;let t=e.charAt(0);if("-"!==t&&!wl.has(t))return!1;for(let t of e)if(!Rl.has(t))return!1;return!0},Cl.RemoveTrailingDigits=function(e){let t=e.length;for(;t>0;){let s=e.charAt(t-1);if(!Cl.IsNumericChar(s))break;--t}return e.substr(0,t)},Cl.IncrementNumberAtEndOf=function(e){let t=Cl.RemoveTrailingDigits(e),s=e.substr(t.length);return s=s?(parseInt(s,10)+1).toString():"2",t+s};const Dl=new Map([["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#39;"]]),El=/[&<>"']/g;Cl.EscapeHTML=function(e){return e.replace(El,Tl)},Cl.EscapeJS=function(e){let t=Cl.ReplaceAll(e,"\\","\\\\");return t=Cl.ReplaceAll(t,'"','\\"'),t=Cl.ReplaceAll(t,"\t","\\t"),t=Cl.ReplaceAll(t,"\r",""),Cl.ReplaceAll(t,"\n","\\n")},Cl.EscapeXML=function(e){let t=Cl.ReplaceAll(e,"&","&amp;");return t=Cl.ReplaceAll(t,"<","&lt;"),t=Cl.ReplaceAll(t,">","&gt;"),Cl.ReplaceAll(t,'"',"&quot;")};const Ml=/[-[\]{}()*+?.,\\^$|#\s]/g;Cl.EscapeRegex=function(e){return e.replace(Ml,"\\$&")},Cl.CountCharsInString=function(e,t){let s=0;for(const n of e)n===t&&++s;return s},Cl.StringPosToLineNumber=function(e,t){let s=0,n=0;for(;s<t;){if(s=e.indexOf("\n",s),-1===s)return n;n++,s++}return n},Cl.FindAll=function(e,t,s=!1){if(!t)return[];s||(e=e.toLowerCase(),t=t.toLowerCase());const n=t.length;let i=0,r=0,a=[];for(;(r=e.indexOf(t,i))>-1;)a.push(r),i=r+n;return a},Cl.ReplaceAll=function(e,t,s){return e.replaceAll(t,(()=>s))},Cl.ReplaceAllCaseInsensitive=function(e,t,s){return e.replace(new RegExp(Cl.EscapeRegex(t),"gi"),(()=>s))},Cl.SetElementContent=function(e,t){"string"==typeof t?e.textContent=t:t.isPlainText()?e.textContent=t.toString():(e.innerHTML=t.toHTML(),t instanceof Cl.BBString&&t.attachLinkHandlers(e))},Cl.StringLikeEquals=function(e,t){return e instanceof Cl.HtmlString||e instanceof Cl.BBString?e.equals(t):t instanceof Cl.HtmlString||t instanceof Cl.BBString?t.equals(e):e===t},Cl.StringSubstitute=function(e,...t){let s=e;for(let n=0,i=t.length;n<i;++n){const i=`{${n}}`;if(!e.includes(i))throw new Error(`missing placeholder '${i}' in string substitution`);s=s.replace(i,t[n].toString())}return s},Cl.StringSubstituteAllowMissing=function(e,...t){let s=e,n=-1,i=-1;for(let r=0,a=t.length;r<a;++r){const a=`{${r}}`;e.includes(a)?(i=r,s=s.replace(a,t[r].toString())):-1===n&&(n=r)}if(n>=0&&i>=0&&n<i)throw new Error(`missing placeholder '${n}' in string substitution`);return s},Cl.StringSubstituteMap=function(e,t){let s=e;for(let[e,n]of Object.entries(t))s=s.replaceAll(e,n.toString());return s},Cl.SortAZ=function(e,t){return e>t?1:e<t?-1:0},Cl.SortAZCaseInsensitive=function(e,t){let s=e.toLowerCase(),n=t.toLowerCase();return s>n?1:s<n?-1:0};const kl=new self.Intl.Segmenter;Cl.SplitGraphemes=function(e){const t=[];for(const s of kl.segment(e))t.push(s.segment);return t},Cl.IterateGraphemes=function*(e){for(const t of kl.segment(e))yield t.segment},Cl.CountGraphemes=function(e){let t=0;for(const s of kl.segment(e))++t;return t};const Ll=1024,Fl=1048576,Bl=1073741824,Ol=1099511627776;Cl.FormatDataSize=function(e,t){let s="common."+(t?"dataRates":"dataSizes")+".";const n=self.langSub;if(e<1024)return n(s+"bytes",e);if(e<1048576){let t=e/1024;return t=t<10?Math.round(10*t)/10:Math.round(t),n(s+"kilobytes",t)}if(e<Bl){let t=e/1048576;return t=t<10?Math.round(10*t)/10:Math.round(t),n(s+"megabytes",t)}if(e<Ol){let t=e/Bl;return t=t<10?Math.round(10*t)/10:Math.round(t),n(s+"gigabytes",t)}{let t=e/Ol;return t=t<10?Math.round(10*t)/10:Math.round(t),n(s+"terabytes",t)}};const Nl={approximate:!1,days:!0,hours:!0,minutes:!0,seconds:!0};Cl.FormatTime=function(e,t){t=Object.assign({},Nl,t),Cl.Lang.PushContext("common.time");const s=[],n=self.lang,i=self.langPluralSub;if(t.days){const t=Math.floor(e/86400);t>0&&(e-=24*t*3600,s.push(i(".days",null,t)))}if(t.hours){const t=Math.floor(e/3600);(t>0||s.length)&&(e-=3600*t,s.push(i(".hours",null,t)))}if(t.minutes){const n=Math.floor(e/60);(n>0||s.length||!t.seconds)&&(e-=60*n,s.push(i(".minutes",null,n)))}if(t.seconds){const t=Math.floor(e%60);s.push(i(".seconds",null,t))}const r=(t.approximate?n(".approx-prefix"):"")+s.join(n(".separator"));return Cl.Lang.PopContext(),r},Cl.ZeroPad=function(e,t){let s=e<0?"-":"",n=(e=Math.abs(e)).toString(),i=t-n.length;for(let e=0;e<i;++e)s+="0";return s+n},Cl.StringToTitleCase=function(e){return e.toLowerCase().replace(/\b\w/g,(e=>e.toUpperCase()))},Cl.CompareVersionStrings=function(e,t){let s=e.split(".").map((e=>e.trim())),n=t.split(".").map((e=>e.trim()));Cl.resizeArray(s,4,"0"),Cl.resizeArray(n,4,"0"),s=s.map((e=>parseInt(e,10))),n=n.map((e=>parseInt(e,10)));for(let e=0;e<4;++e){const t=s[e]-n[e];if(0!==t)return t<0?-1:1}return 0},Cl.CreateGUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=Math.floor(16*Math.random());return("x"===e?t:3&t|8).toString(16)}))},Cl.StringHammingDistance=function(e,t){if(e.length!==t.length)throw new Error("strings must be same length");let s=0;for(let n=0,i=e.length;n<i;++n)e.charAt(n)!==t.charAt(n)&&++s;return s},Cl.StringLevenshteinDistance=function(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;let s,n,i,r,a,o;for(e.length>t.length&&(s=e,e=t,t=s),o=Array(e.length+1),n=0;n<=e.length;n++)o[n]=n;for(n=1;n<=t.length;n++){for(r=n,i=1;i<=e.length;i++)a=t[n-1]===e[i-1]?o[i-1]:Math.min(o[i-1]+1,Math.min(r+1,o[i]+1)),o[i-1]=r,r=a;o[e.length]=r}return o[e.length]}}{let Wl=function(e,t,s){const n=Ul.get(s);if(!n)return"class"===s?t?"</span>":`<span class="bbclass${Jl++}">`:e;if("string"==typeof n){if("a"===n&&0===Yl.length||"abbr"===n&&0===ql.length)return e;if("a"!==n||t){if("abbr"!==n||t)return"<"+t+n+">";{const e=parseInt(s.substring(3),10)-1;if(e<0||e>=ql.length)throw new Error("invalid bbcode tip substitution");const t=ql[e];let n="";if("string"==typeof t?n=t:"function"==typeof t&&(n=t()),"string"!=typeof n)throw new TypeError("invalid bbcode tip");return`<abbr title="${Vl.ReplaceAll(n,'"',"&quot;")}">`}}{const e=parseInt(s.substring(1),10)-1;if(e<0||e>=Yl.length)throw new Error("invalid bbcode link substitution");const t=Yl[e];if("string"==typeof t)return`<a href="${Yl[e]}">`;if("function"==typeof t)return`<a class="bblink${e}">`;throw new TypeError("invalid bbcode link action")}}if(Array.isArray(n)){let e=n[0],s=n[1];return t?"</"+e+">":`<${e} class="${s}">`}};bbToHtmlReplacerFunc=Wl;const Vl=self.C3,jl=self.assert,Ul=new Map([["b","strong"],["i","em"],["s","s"],["u","u"],["sub","sub"],["sup","sup"],["small","small"],["mark","mark"],["code","code"],["a1","a"],["a2","a"],["a3","a"],["a4","a"],["a5","a"],["a6","a"],["a7","a"],["a8","a"],["a9","a"],["tip1","abbr"],["tip2","abbr"],["tip3","abbr"],["tip4","abbr"],["tip5","abbr"],["tip6","abbr"],["tip7","abbr"],["tip8","abbr"],["tip9","abbr"],["bad",["span","bbCodeBad"]],["good",["span","bbCodeGood"]],["info",["span","bbCodeInfo"]],["h1",["span","bbCodeH1"]],["h2",["span","bbCodeH2"]],["h3",["span","bbCodeH3"]],["h4",["span","bbCodeH4"]],["item",["span","bbCodeItem"]]]),Hl=new Set(["icon"]),zl=/\[(\/?)([a-zA-Z0-9]+)\]/g,Xl=/\[(\/?)([^\[\n]*?)\]/g;let Yl=null,ql=null,Jl=0;const Kl=/\n/g;Vl.BBString=class{constructor(e,t){if(this._bbstr=t&&t.noEscape?e:Vl.EscapeHTML(e),this._htmlstr="",this._convertLineBreaks=!1,this._linkActions=[],this._tipList=[],t){if(this._convertLineBreaks=!!t.convertLineBreaks,t.links){if(t.links.length>9)throw new Error("too many links");this._linkActions=t.links}if(t.tips){if(t.tips.length>9)throw new Error("too many tips");this._tipList=t.tips}}this._hasAnyBBtags=this._bbstr.includes("["),this._needsLineBreakConversion=this._convertLineBreaks&&this._bbstr.includes("\n"),this._isPlain=!this._hasAnyBBtags&&!this._needsLineBreakConversion&&!this._bbstr.includes("&"),this._hasParsedFragments=!1,this._fragments=[]}toString(){return this._bbstr}valueOf(){return this._bbstr}isPlainText(){return this._isPlain}toPlainText(){return this._hasAnyBBtags?this._bbstr.replace(zl,""):this._bbstr}toHTML(){if(this._isPlain)return this._bbstr;if(!this._htmlstr&&this._bbstr){let e=this._bbstr;this._hasAnyBBtags&&(Jl=0,Yl=this._linkActions,ql=this._tipList,e=e.replace(zl,Wl),Yl=null,ql=null),this._needsLineBreakConversion&&(e=e.replace(Kl,"<br>")),this._htmlstr=e}return this._htmlstr}attachLinkHandlers(e){if(this._linkActions.length)for(let t=0,s=this._linkActions.length;t<s;++t){const s=this._linkActions[t];if("function"!=typeof s)continue;const n=e.querySelector(".bblink"+t);if(!n)throw new Error("unable to attach BBString link handler");n.onclick=s}}equals(e){return e instanceof Vl.HtmlString?this.toHTML()===e.toHTML():e instanceof Vl.BBString?this._bbstr===e._bbstr:this._bbstr===e}toFragmentList(){if(this._hasParsedFragments)return this._fragments;const e=[],t=this._bbstr,s=[];Xl.lastIndex=0;let n=0,i=null;for(;null!==(i=Xl.exec(t));){const r=i.index;if(r>0&&"\\"===t.charAt(r-1))continue;const a=i[0],o=i[1],l=i[2],c=t.substring(n,r);if(n=r+a.length,c&&e.push({text:c,styles:s.slice(0)}),l)if(o){const e=l.toLowerCase();for(let t=s.length-1;t>=0;--t)if(s[t].tag===e){s.splice(t,1);break}}else{let t=l,n=null;const i=l.indexOf("=");if(-1!==i?(t=l.substring(0,i).toLowerCase(),n=l.substring(i+1)):t=t.toLowerCase(),Hl.has(t)){if("icon"!==t)throw new Error(`unknown self-closing tag ${t}`);e.push({icon:n,styles:s.slice(0)})}else s.push({tag:t,param:n})}}n<t.length&&e.push({text:t.substring(n),styles:s.slice(0)});for(const t of e)t.text&&(t.text=this._ProcessBBCodeEscapeSequences(t.text));return this._fragments=e.map((e=>e.icon?Vl.New(Vl.IconFragment,{icon:e.icon,styles:e.styles}):Vl.New(Vl.TextFragment,{chArr:Vl.SplitGraphemes(e.text),styles:e.styles}))),this._hasParsedFragments=!0,this._fragments}_ProcessBBCodeEscapeSequences(e){return e=Vl.ReplaceAll(e,"\\[","["),Vl.ReplaceAll(e,"\\\\","\\")}static StripTags(e){return Vl.New(Vl.BBString,e,{noEscape:!0}).toPlainText()}static StripAnyTags(e){return e.replace(Xl,"")}}}{let $l=function(e){return""!==e&&""!==e&&sc.IsWhitespaceChar(e)},Zl=function(e){return nc.has(e)},Ql=function(e){return sc.IsCJKPunctuationChar(e)&&!Zl(e)},ec=function(e){for(;e.length>0&&$l(e.at(-1));)e.pop()},tc=function(e){return"\n"===e||"\r\n"===e};IsWordBreakWhiteSpace=$l,IsOpeningCJKPunctiationChar=Zl,IsContinuingCJKPunctuationChar=Ql,WordBreakTrimEnd=ec,IsNewline=tc;const sc=self.C3,nc=new Set("");sc.WordWrap=class{constructor(){this._lines=[],this._iconSet=null}GetLines(){return this._lines}GetLineCount(){return this._lines.length}SetIconSet(e){this._iconSet=e}_MeasureLine(e,t){let s=0,n=0,i=0,r=0,a=0;for(const o of e){if(-1===o.GetWidth()){const e=t(o);o.SetHeight(e.height),o.SetFontBoundingBoxAscent(e.fontBoundingBoxAscent||0),o.SetFontBoundingBoxDescent(e.fontBoundingBoxDescent||0),o.SetTopToAlphabeticDistance(e.topToAlphabeticDistance||0),o.IsText()?o.SetWidth(e.width):o.IsIcon()&&o.CalculateWidthFromHeight(this._iconSet)}s+=o.GetWidth(),n=Math.max(n,o.GetHeight()),i=Math.max(i,o.GetFontBoundingBoxAscent()),r=Math.max(r,o.GetFontBoundingBoxDescent()),a=Math.max(a,o.GetTopToAlphabeticDistance())}return{width:s,height:n,fontBoundingBoxAscent:i,fontBoundingBoxDescent:r,topToAlphabeticDistance:a}}_AddLine(e,t,s,n,i,r){this._lines.push(sc.New(sc.WordWrap.Line,{fragments:e,width:t,height:s,fontBoundingBoxAscent:n,fontBoundingBoxDescent:i,topToAlphabeticDistance:r}))}WordWrap(e,t,s,n,i){if("string"==typeof e&&(e=[sc.New(sc.TextFragment,{chArr:sc.SplitGraphemes(e)})]),sc.clearArray(this._lines),!e.length||1===e.length&&e[0].IsText()&&e[0].IsEmpty()||s<2)return;if(1===e.length){const n=e[0];if(n.IsText()&&n.GetLength()<=100&&!n.HasNewLine()){let{width:e,height:r,fontBoundingBoxAscent:a,fontBoundingBoxDescent:o,topToAlphabeticDistance:l}=t(n);if(e+=i,n.SetWidth(e),n.SetHeight(r),n.SetFontBoundingBoxAscent(a||0),n.SetFontBoundingBoxDescent(o||0),n.SetTopToAlphabeticDistance(l||0),e<=s)return void this._AddLine([n],e,r,a,o,l)}}let r;r="word"===n?this._TokeniseByWord(e):"cjk"===n?this._TokeniseByCJK(e):this._TokeniseByChar(e),this._WrapText(r,t,s,i)}_TokeniseByWord(e){const t=[];let s=[],n=!1;for(const i of e){const e=i.GetStyles();if(i.IsIcon())s.length>0&&t.push(s),t.push([i]),s=[];else for(const r of i.GetCharacterArray())if(tc(r))s.length>0&&t.push(s),t.push([sc.New(sc.TextFragment,{chArr:["\n"],styles:e})]),s=[];else if(0===s.length)s.push(sc.New(sc.TextFragment,{chArr:[r],styles:e})),n=$l(r);else{const i=$l(r);if(i===n){const t=s.at(-1);t.GetStyles()===e?t._AppendChar(r):s.push(sc.New(sc.TextFragment,{chArr:[r],styles:e}))}else t.push(s),s=[sc.New(sc.TextFragment,{chArr:[r],styles:e})],n=i}}return s.length>0&&t.push(s),t}_TokeniseByCJK(e){const t=[];let s=[],n=!1;for(const i of e){const e=i.GetStyles();if(i.IsIcon())s.length>0&&t.push(s),t.push([i]),s=[];else for(const r of i.GetCharacterArray())if(tc(r))s.length>0&&t.push(s),t.push([sc.New(sc.TextFragment,{chArr:["\n"],styles:e})]),s=[];else if(0===s.length)s.push(sc.New(sc.TextFragment,{chArr:[r],styles:e})),n=Zl(r);else if(n||Ql(r)){const t=s.at(-1);t.GetStyles()===e?t._AppendChar(r):s.push(sc.New(sc.TextFragment,{chArr:[r],styles:e})),n=Zl(r)}else t.push(s),s=[sc.New(sc.TextFragment,{chArr:[r],styles:e})],n=Zl(r)}return s.length>0&&t.push(s),t}_TokeniseByChar(e){const t=[];for(const s of e)if(s.IsText()){const e=s.GetCharacterArray();sc.appendArray(t,e.map((e=>[sc.New(sc.TextFragment,{chArr:[e],styles:s.GetStyles()})])))}else t.push([s]);return t}_CopyLine(e){return e.map((e=>e._Clone()))}_AddWordToLine(e,t){const s=e.length?e.at(-1):null;let n=0;s&&s.IsText()&&t[0].IsText()&&t[0].GetStyles()===s.GetStyles()&&(s._Append(t[0].GetCharacterArray()),n=1);for(let s=t.length;n<s;++n){const s=t[n];e.push(s._Clone())}}_WrapText(e,t,s,n){let i=[],r=0,a=0,o=0,l=0,c=0;for(const n of e){if(1===n.length&&n[0].IsText()&&1===n[0].GetLength()&&tc(n[0].GetCharacterArray()[0])){if(0===a){const e=t(sc.New(sc.TextFragment,{chArr:[" "],styles:n[0].GetStyles()}));a=e.height,o=e.fontBoundingBoxAscent||0,l=e.fontBoundingBoxDescent||0,c=e.topToAlphabeticDistance||0}this._AddLine(i,r,a,o,l,c),i=[],r=0,a=0,o=0,l=0,c=0;continue}const e=this._CopyLine(i);this._AddWordToLine(e,n);const h=this._MeasureLine(e,t),_=h.width;if(_>=s)if(i.length>0&&this._AddLine(i,r,a,o,l,c),i=[],n[0].IsText()&&sc.IsCharArrayAllWhitespace(n[0].GetCharacterArray()))r=0,a=0,o=0,l=0,c=0;else{this._AddWordToLine(i,n);const e=this._MeasureLine(i,t);r=e.width,a=e.height,o=e.fontBoundingBoxAscent,l=e.fontBoundingBoxDescent,c=e.topToAlphabeticDistance}else i=e,r=_,a=h.height,o=h.fontBoundingBoxAscent,l=h.fontBoundingBoxDescent,c=h.topToAlphabeticDistance}i.length>0&&this._AddLine(i,r,a,o,l,c),this._TrimLinesTrailingWhitespace(t,n)}_TrimLinesTrailingWhitespace(e,t){for(const s of this._lines){const n=s._GetFragmentsArray();if(!n.length)continue;let i=n.at(-1);if(i.IsText()){const r=i.GetCharacterArray(),a=r.slice(0);if(ec(a),0===a.length)s.OffsetWidth(-i.GetWidth()),n.pop();else if(a.length<r.length){i.SetCharacterArray(a);const t=e(i).width,n=i.GetWidth()-t;i.SetWidth(t),s.OffsetWidth(-n)}0!==t&&n.length>0&&(i=n.at(-1),i.OffsetWidth(t),s.OffsetWidth(t))}}}Clear(){sc.clearArray(this._lines)}GetMaxLineWidth(){return this._lines.reduce(((e,t)=>Math.max(e,t.GetWidth())),0)}GetTotalLineHeight(){return this._lines.reduce(((e,t)=>e+t.GetHeight()),0)}}}{const ic=self.C3;ic.WordWrap.Line=class{constructor(e){this._fragments=e.fragments||[],this._width=e.width||-1,this._height=e.height||-1,this._fontBoundingBoxAscent=e.fontBoundingBoxAscent||-1,this._fontBoundingBoxDescent=e.fontBoundingBoxDescent||-1,this._topToAlphabeticDistance=e.topToAlphabeticDistance||-1,this._posX=0,this._posY=0}fragments(){return this._fragments.values()}*fragmentsReverse(){const e=this._fragments;for(let t=e.length-1;t>=0;--t)yield e[t]}_GetFragmentsArray(){return this._fragments}OffsetWidth(e){this._width+=e}GetWidth(){return this._width}GetHeight(){return this._height}GetFoundBoundingBoxAscent(){return this._fontBoundingBoxAscent}GetFontBoundingBoxDescent(){return this._fontBoundingBoxDescent}GetTopToAlphabeticDistance(){return this._topToAlphabeticDistance}SetPosX(e){this._posX=e}GetPosX(){return this._posX}SetPosY(e){this._posY=e}GetPosY(){return this._posY}}}{const rc=self.C3;rc.FragmentBase=class{constructor(e){this._styles=e.styles||[],this._width=e.width||-1,this._height=e.height||-1,this._fontBoundingBoxAscent=e.fontBoundingBoxAscent||-1,this._fontBoundingBoxDescent=e.fontBoundingBoxDescent||-1,this._topToAlphabeticDistance=e.topToAlphabeticDistance||-1,this._posX=0,this._posY=0}IsText(){return!1}IsIcon(){return!1}GetStyles(){return this._styles}GetStyleTag(e){const t=this._styles;for(let s=t.length-1;s>=0;--s){const n=t[s];if(n.tag===e)return n}return null}HasStyleTag(e){return!!this.GetStyleTag(e)}GetStyleMap(){const e=new Map;for(const t of this._styles)e.set(t.tag,t.param);return e}OffsetWidth(e){this._width+=e}SetWidth(e){this._width=e}GetWidth(){return this._width}SetHeight(e){this._height=e}GetHeight(){return this._height}SetFontBoundingBoxAscent(e){this._fontBoundingBoxAscent=e}GetFontBoundingBoxAscent(){return this._fontBoundingBoxAscent}SetFontBoundingBoxDescent(e){this._fontBoundingBoxDescent=e}GetFontBoundingBoxDescent(){return this._fontBoundingBoxDescent}SetTopToAlphabeticDistance(e){this._topToAlphabeticDistance=e}GetTopToAlphabeticDistance(){return this._topToAlphabeticDistance}SetPosX(e){this._posX=e}GetPosX(){return this._posX}SetPosY(e){this._posY=e}GetPosY(){return this._posY}}}{const ac=self.C3;ac.TextFragment=class extends ac.FragmentBase{constructor(e){super(e),this._chArr=e.chArr}IsText(){return!0}_Append(e){ac.appendArray(this._chArr,e),this._width=-1,this._height=-1,this._fontBoundingBoxAscent=-1,this._fontBoundingBoxDescent=-1,this._topToAlphabeticDistance=-1}_AppendChar(e){this._chArr.push(e)}_Clone(){return ac.New(ac.TextFragment,{chArr:this._chArr.slice(0),styles:this._styles,width:this._width,height:this._height,fontBoundingBoxAscent:this._fontBoundingBoxAscent,fontBoundingBoxDescent:this._fontBoundingBoxDescent,topToAlphabeticDistance:this._topToAlphabeticDistance})}GetCharacterArray(){return this._chArr}SetCharacterArray(e){this._chArr=e}GetLength(){return this._chArr.length}IsEmpty(){return 0===this._chArr.length}HasNewLine(){return this._chArr.includes("\n")}}}{const oc=self.C3;oc.IconFragment=class extends oc.FragmentBase{constructor(e){super(e),this._icon=e.icon}IsIcon(){return!0}GetIconParameter(){return this._icon}_Clone(){return oc.New(oc.IconFragment,{icon:this._icon,styles:this._styles,width:this._width,height:this._height,fontBoundingBoxAscent:this._fontBoundingBoxAscent,fontBoundingBoxDescent:this._fontBoundingBoxDescent,topToAlphabeticDistance:this._topToAlphabeticDistance})}GetTextIcon(e){if(!e)return null;let t=Number(this._icon);return String(t)===this._icon?(t=Math.floor(t),e.GetTextIconByIndex(t)):e.GetTextIconByTag(this._icon)}CalculateWidthFromHeight(e){const t=this.GetTextIcon(e);this._width=t?this._height*t.GetWidth()/t.GetHeight():0}GetDrawable(e){const t=this.GetTextIcon(e);return t?t.GetDrawable():null}GetLength(){return 1}}}{const lc=self.C3;lc.TextIconManager=class{constructor(e){this._iconSets=new Map,this._getIconSetMetaCallback=e.getIconSetMeta,this._getIconSetContentCallback=e.getIconSetContent}Release(){for(const e of this._iconSets.values())e.Release();this._iconSets.clear()}GetIconSet(e){let t=this._iconSets.get(e);if(t)return t;const s=this._getIconSetMetaCallback(e);return t=lc.New(lc.TextIconSet,this,{source:e,iconMeta:s}),this._iconSets.set(e,t),t}HasIconSet(e){return this._iconSets.has(e)}DeleteIconSet(e){const t=this._iconSets.get(e);t&&t.Release(),this._iconSets.delete(e)}async _GetIconSetContent(e){return await this._getIconSetContentCallback(e)}}}{const cc=self.C3;cc.TextIconSet=class{constructor(e,t){this._textIconManager=e,this._source=t.source,this._iconsArray=[],this._iconsByTag=new Map,this._hasStartedLoad=!1,this._isLoading=!1,this._loadPromise=null;const s=t.iconMeta.icons;for(let e=0,t=s.length;e<t;++e){const t=s[e],n=cc.New(cc.TextIcon,this,{index:e,tag:t.tag,source:t.source,width:t.width,height:t.height});this._iconsArray.push(n),t.tag&&this._iconsByTag.set(t.tag.toLowerCase(),n)}}Release(){for(const e of this._iconsArray)e.Release();cc.clearArray(this._iconsArray),this._iconsByTag.clear(),this._textIconManager=null,this._source=null}HasLoaded(){return this._hasStartedLoad}IsLoading(){return this._isLoading}LoadContent(){return this._loadPromise||(this._loadPromise=this._DoLoadContent()),this._loadPromise}async _DoLoadContent(){if(this._hasStartedLoad)return;this._hasStartedLoad=!0,this._isLoading=!0;const e=await this._textIconManager._GetIconSetContent(this._source);if(!this._textIconManager)return;const t=e.icons;for(let e=0,s=Math.min(t.length,this._iconsArray.length);e<s;++e){const s=t[e].drawable;this._iconsArray[e]._SetDrawable(s)}this._isLoading=!1}GetTextIconByIndex(e){return(e=Math.floor(e))<0||e>=this._iconsArray.length?null:this._iconsArray[e]}GetTextIconByTag(e){return this._iconsByTag.get(e.toLowerCase())||null}}}{const hc=self.C3;hc.TextIcon=class{constructor(e,t){this._textIconSet=e,this._source=t.source||null,this._index=t.index,this._tag=t.tag,this._width=t.width,this._height=t.height,this._drawable=null}Release(){this._width=0,this._height=0,this._textIconSet=null}GetSource(){return this._source}GetWidth(){return this._width}GetHeight(){return this._height}_SetDrawable(e){this._drawable=e}GetDrawable(){return this._drawable}}}{let _c=function(e,t,s,n){const i=bc;mc.subtract(Sc,s,t),mc.subtract(yc,e,t),mc.cross(i,Sc,yc),mc.normalize(i,i),n.set(i[0],i[1],i[2],mc.dot(e,i))},uc=function(e,t,s,n,i,r,a){const o=a.x,l=a.y,c=a.z,h=a.w,_=a.xF,u=a.yF,d=a.zF,p=1-_,f=1-u,m=1-d;return o*e*_+o*n*p+l*t*u+l*i*f+c*s*d+c*r*m>=h||o*n*_+o*e*p+l*i*u+l*t*f+c*r*d+c*s*m>h},dc=function(e,t,s,n){return n.x*e+n.y*t+n.z*s>=n.w};PlaneFromPoints=_c,IsInFrontOfPlane=uc,IsPointInFrontOfPlane=dc;const pc=self.C3,fc=self.glMatrix,mc=fc.vec3,gc=fc.vec4,Ic=fc.mat4,Sc=mc.create(),yc=mc.create(),bc=mc.create(),Gc=gc.create(),vc=Ic.create(),xc=mc.create(),Tc=mc.create(),Cc=mc.create(),wc=mc.create(),Pc=mc.create(),Ac=mc.create(),Rc=mc.create(),Dc=mc.create(),Ec=gc.fromValues(0,0,1,1);pc.Gfx={Project(e,t,s,n,i,r,a){const o=n[0]*e+n[4]*t+n[8]*s+n[12],l=n[1]*e+n[5]*t+n[9]*s+n[13],c=n[2]*e+n[6]*t+n[10]*s+n[14],h=n[3]*e+n[7]*t+n[11]*s+n[15];let _=i[0]*o+i[4]*l+i[8]*c+i[12]*h,u=i[1]*o+i[5]*l+i[9]*c+i[13]*h,d=i[2]*o+i[6]*l+i[10]*c+i[14]*h,p=i[3]*o+i[7]*l+i[11]*c+i[15]*h;return 0!==p&&(p=1/p,_*=p,u*=p,d*=p,a[0]=(.5*_+.5)*r[2]+r[0],a[1]=(.5*u+.5)*r[3]+r[1],a[2]=.5*(1+d),!0)},Unproject(e,t,s,n,i,r,a){const o=vc,l=Gc;return Ic.multiply(o,i,n),null!==Ic.invert(o,o)&&(l[0]=(e-r[0])/r[2]*2-1,l[1]=(t-r[1])/r[3]*2-1,l[2]=2*s-1,l[3]=1,gc.transformMat4(l,l,o),0!==l[3]&&(l[3]=1/l[3],a[0]=l[0]*l[3],a[1]=l[1]*l[3],a[2]=l[2]*l[3],!0))},UnprojectScreenToWorldZ(e,t,s,n,i,r,a){const o=Sc,l=yc;if(!pc.Gfx.Unproject(e,t,0,n,i,r,o))return!1;if(!pc.Gfx.Unproject(e,t,1,n,i,r,l))return!1;const c=yc;mc.subtract(c,l,o);const h=bc;mc.set(h,0,0,1);const _=-s,u=mc.dot(h,c);let d=0;if(0===u){if(0!==mc.dot(h,o)+_)return!1}else if(d=-(mc.dot(o,h)+_)/u,d<0)return!1;return mc.scaleAndAdd(a,o,c,d),!0}};class Mc{constructor(){this.x=NaN,this.y=NaN,this.z=NaN,this.w=NaN,this.xF=NaN,this.yF=NaN,this.zF=NaN}set(e,t,s,n){this.x=e,this.y=t,this.z=s,this.w=n,this.xF=e>0?1:0,this.yF=t>0?1:0,this.zF=s>0?1:0}}pc.Gfx.ViewFrustum=class{constructor(){this._leftP=new Mc,this._topP=new Mc,this._rightP=new Mc,this._bottomP=new Mc,this._nearP=new Mc,this._farP=new Mc}CalculatePlanes(e,t){const s=Ec;pc.Gfx.Unproject(0,1,0,e,t,s,xc),pc.Gfx.Unproject(1,1,0,e,t,s,Tc),pc.Gfx.Unproject(0,0,0,e,t,s,Cc),pc.Gfx.Unproject(1,0,0,e,t,s,wc),pc.Gfx.Unproject(0,1,1,e,t,s,Pc),pc.Gfx.Unproject(1,1,1,e,t,s,Ac),pc.Gfx.Unproject(0,0,1,e,t,s,Rc),pc.Gfx.Unproject(1,0,1,e,t,s,Dc),_c(Cc,xc,Pc,this._leftP),_c(xc,Tc,Ac,this._topP),_c(Tc,wc,Dc,this._rightP),_c(wc,Cc,Rc,this._bottomP),_c(Rc,Pc,Ac,this._farP),_c(wc,Tc,xc,this._nearP)}ContainsAABB(e,t,s,n,i,r){return uc(e,t,s,n,i,r,this._leftP)&&uc(e,t,s,n,i,r,this._topP)&&uc(e,t,s,n,i,r,this._rightP)&&uc(e,t,s,n,i,r,this._bottomP)&&uc(e,t,s,n,i,r,this._nearP)&&uc(e,t,s,n,i,r,this._farP)}IsBehindNearPlane(e,t,s){return!dc(e,t,s,this._nearP)}}}{const kc=self.C3,Lc=self.glMatrix,Fc=Lc.vec3,Bc=Lc.vec4,Oc=Lc.mat4,Nc=Oc.create(),Wc=Fc.fromValues(0,0,0),Vc=Fc.fromValues(0,0,0),jc=Fc.fromValues(0,0,0),Uc=Fc.fromValues(0,1,0),Hc=Bc.fromValues(0,0,0,0),zc=new kc.Quad,Xc=new kc.Rect,Yc=new kc.Quad(0,0,1,0,1,1,0,1),qc={nearZ:1,farZ:1e4},Jc=Oc.fromValues(1,0,0,0,0,1,0,0,0,0,.5,0,0,0,.5,1);kc.Gfx.RendererBase=class{constructor(e){e=Object.assign({},qc,e),this._width=0,this._height=0,this._fovY=kc.toRadians(45),this._tan_fovY_2=Math.tan(this._fovY/2),this._matP=Oc.create(),this._matMV=Oc.create(),this._zAxisScale=!1,this._nearZ=e.nearZ,this._farZ=e.farZ,this._allShaderPrograms=[],this._shaderProgramsByName=new Map,this._spTextureFill=null,this._spPoints=null,this._spTilemapFill=null,this._spTileRandomization=null,this._spColorFill=null,this._spLinearGradientFill=null,this._spPenumbraFill=null,this._spHardEllipseFill=null,this._spHardEllipseOutline=null,this._spSmoothEllipseFill=null,this._spSmoothEllipseOutline=null,this._spSmoothLineFill=null,this._stateGroups=new Map,this._currentStateGroup=null,this._blendModeTable=[],this._namedBlendModeMap=new Map,this._baseZ=0,this._currentZ=0,this._lineWidth=1,this._lineWidthStack=[this._lineWidth],this._lineCap=1,this._lineCapStack=[this._lineCap],this._lineOffset=.5,this._lineOffsetStack=[this._lineOffset],this._frameNumber=0,this._enableMipmaps=!0,this._hasMajorPerformanceCaveat=!1}FillIndexBufferData(e){let t=0,s=e.length,n=0;for(;t<s;)e[t++]=n,e[t++]=n+1,e[t++]=n+2,e[t++]=n,e[t++]=n+2,e[t++]=n+3,n+=4}_ClearState(){this._baseZ=0,this._currentZ=0,this._spTextureFill=null,this._spPoints=null,this._spTilemapFill=null,this._spTileRandomization=null,this._spColorFill=null,this._spLinearGradientFill=null,this._spPenumbraFill=null,this._spHardEllipseFill=null,this._spHardEllipseOutline=null,this._spSmoothEllipseFill=null,this._spSmoothEllipseOutline=null,this._spSmoothLineFill=null,this._ClearAllShaderPrograms()}InitState(){this._ClearState(),this._currentStateGroup=null}OnDeviceOrContextLost(){for(const e of this._allShaderPrograms)e.Release();this._ClearState()}GetWidth(){return this._width}GetHeight(){return this._height}GetDefaultCameraZ(e){return this.IsZAxisScaleNormalized()?100:e/(2*this._GetTanFovYDiv2())}GetZAxisScaleFactor(e){return this.IsZAxisScaleNormalized()?e/(2*this._GetTanFovYDiv2())/this.GetDefaultCameraZ(e):1}SetNearZ(e){this._nearZ=e}GetNearZ(){return this._nearZ}SetFarZ(e){this._farZ=e}GetFarZ(){return this._farZ}SetFovY(e){this._fovY=e,this._tan_fovY_2=Math.tan(this._fovY/2)}GetFovY(){return this._fovY}_GetTanFovYDiv2(){return this._tan_fovY_2}SetZAxisScaleNormalized(){this._zAxisScale=!1}SetZAxisScaleRegular(){this._zAxisScale=!0}IsZAxisScaleNormalized(){return!this._zAxisScale}IsZAxisScaleRegular(){return this._zAxisScale}CalculatePerspectiveMatrix(e,t,s=.5,n=.5){const i=this.GetNearZ(),r=this.GetFarZ(),a=this.GetFovY();if(.5===s&&.5===n)this.IsWebGPU()?Oc.perspectiveZO(e,a,t,i,r):Oc.perspective(e,a,t,i,r);else{const a=2*(s=1-s)-2,o=2*s,l=2*n-2,c=2*n,h=this._GetTanFovYDiv2()*i,_=h*t;Oc.frustum(e,a*_,o*_,l*h,c*h,i,r),this.IsWebGPU()&&Oc.mul(e,Jc,e)}}CalculateOrthographicMatrix(e,t,s,n=1){const i=self.devicePixelRatio,r=2*this.GetDefaultCameraZ(s)*i*this._GetTanFovYDiv2()/s,a=t*r/(2*i*n),o=s*r/(2*i*n),l=-a,c=a,h=-o,_=o;this.IsWebGPU()?Oc.orthoZO(e,l,c,h,_,this.GetNearZ(),this.GetFarZ()):Oc.ortho(e,l,c,h,_,this.GetNearZ(),this.GetFarZ())}CalculateLookAtModelView(e,t,s,n,i,r=1){let a=1;this.IsZAxisScaleNormalized()&&(a=200*this._GetTanFovYDiv2()/i);const o=jc;Fc.set(o,a,-a,1);const l=Wc,c=Vc;Fc.multiply(l,t,o),Fc.multiply(c,s,o),Oc.lookAt(e,l,c,n||Uc),o[2]=r,Oc.scale(e,e,o)}CalculateLookAtModelView2(e,t,s,n,i,r,a,o){return Fc.set(Wc,e,t,s),Fc.set(Vc,n,i,r),this.CalculateLookAtModelView(Nc,Wc,Vc,Uc,a,o),Nc}_AddShaderProgram(e){this._allShaderPrograms.push(e),this._shaderProgramsByName.set(e.GetName(),e)}_RemoveShaderProgram(e){const t=this._allShaderPrograms.indexOf(e);-1!==t&&this._allShaderPrograms.splice(t,1),this._shaderProgramsByName.delete(e.GetName())}_ClearAllShaderPrograms(){kc.clearArray(this._allShaderPrograms),this._shaderProgramsByName.clear()}GetShaderProgramByName(e){return this._shaderProgramsByName.get(e)||null}GetTextureFillShaderProgram(){return this._spTextureFill}SetTextureFillMode(){this.SetProgram(this._spTextureFill)}GetPointsRenderingProgram(){return this._spPoints}SetPointsRenderingProgram(){this.SetProgram(this._spPoints)}SetTilemapFillMode(){this.SetProgram(this._spTilemapFill)}SetTileRandomizationMode(){this.SetProgram(this._spTileRandomization)}SetColorFillMode(){this.SetProgram(this._spColorFill)}SetLinearGradientFillMode(){this.SetProgram(this._spLinearGradientFill)}SetPenumbraFillMode(){this.SetProgram(this._spPenumbraFill)}SetHardEllipseFillMode(){this.SetProgram(this._spHardEllipseFill)}SetHardEllipseOutlineMode(){this.SetProgram(this._spHardEllipseOutline)}SetSmoothEllipseFillMode(){this.SetProgram(this._spSmoothEllipseFill)}SetSmoothEllipseOutlineMode(){this.SetProgram(this._spSmoothEllipseOutline)}SetSmoothLineFillMode(){this.SetProgram(this._spSmoothLineFill)}_SetCurrentStateGroup(e){this._currentStateGroup=e}GetCurrentStateGroup(){return this._currentStateGroup}AcquireStateGroup(e,t,s,n){const i=kc.Gfx.StateGroup.MakeKey(e,t,s,n);let r=this._stateGroups.get(i);return r||(r=kc.New(kc.Gfx.StateGroup,this,e,t,s,n),this._stateGroups.set(i,r)),r.AddRef(),r}ReleaseStateGroup(e){e.DecRef(),0===e._GetRefCount()&&(this._currentStateGroup===e&&(this._currentStateGroup=null),this._stateGroups.delete(e.GetKey()),e.Release())}_InitBlendModeData(e){kc.clearArray(this._blendModeTable),this._namedBlendModeMap.clear();let t=0;for(const s of e){const e=s[0],n=s[1],i=s[2];this._blendModeTable.push([n,i]),this._namedBlendModeMap.set(e,{number:t,srcBlend:n,destBlend:i}),t++}}_GetBlendByIndex(e){return this._blendModeTable[e]}GetSrcBlendByIndex(e){return this._GetBlendByIndex(e)[0]}GetDestBlendByIndex(e){return this._GetBlendByIndex(e)[1]}GetNamedBlend(e){const t=this._namedBlendModeMap.get(e);if(void 0===t)throw new Error("invalid blend name");return t}NamedBlendToNumber(e){const t=this._namedBlendModeMap.get(e);if(void 0===t)throw new Error("invalid blend name");return t.number}SetBaseZ(e){this._baseZ=e}GetBaseZ(){return this._baseZ}SetCurrentZ(e){this._currentZ=e,this._currentStateGroup=null}GetCurrentZ(){return this._currentZ}Line(e,t,s,n){const i=kc.angleTo(e,t,s,n),r=Math.sin(i),a=Math.cos(i),o=.5*this._lineWidth,l=r*o,c=a*o,h=this._lineCap;2===h?this.LinePreCalc_LineCap2(e,t,0,s,n,0,l,c):1===h?this.LinePreCalc_LineCap1(e,t,0,s,n,0,l,c):this.LinePreCalc_LineCap0(e,t,0,s,n,0,l,c)}Line3D(e,t,s,n,i,r){const a=kc.angleTo(e,t,n,i),o=Math.sin(a),l=Math.cos(a),c=.5*this._lineWidth,h=o*c,_=l*c,u=this._lineCap;2===u?this.LinePreCalc_LineCap2(e,t,s,n,i,r,h,_):1===u?this.LinePreCalc_LineCap1(e,t,s,n,i,r,h,_):this.LinePreCalc_LineCap0(e,t,s,n,i,r,h,_)}LinePreCalc_LineCap2(e,t,s,n,i,r,a,o){const l=this._lineOffset,c=e+l-o,h=t+l-a,_=n+l+o,u=i+l+a,d=2*o,p=2*a,f=c+a,m=h-o,g=c-a+d,I=h+o+p,S=_+a,y=u-o,b=_-a-d,G=u+o-p;this.Quad3D2(f,m,s,S,y,r,b,G,r,g,I,s,Yc)}LinePreCalc_LineCap1(e,t,s,n,i,r,a,o){const l=this._lineOffset,c=e+l-o,h=t+l-a,_=n+l+o,u=i+l+a,d=c+a,p=h-o,f=c-a,m=h+o,g=_+a,I=u-o,S=_-a,y=u+o;this.Quad3D2(d,p,s,g,I,r,S,y,r,f,m,s,Yc)}LinePreCalc_LineCap0(e,t,s,n,i,r,a,o){const l=this._lineOffset,c=e+l,h=t+l,_=n+l,u=i+l,d=c+a,p=h-o,f=c-a,m=h+o,g=_+a,I=u-o,S=_-a,y=u+o;this.Quad3D2(d,p,s,g,I,r,S,y,r,f,m,s,Yc)}TexturedLine(e,t,s,n,i,r){const a=kc.angleTo(e,t,s,n),o=Math.sin(a),l=Math.cos(a),c=.5*this._lineWidth,h=o*c,_=l*c,u=this._lineCap;2===u?this.TexturedLinePreCalc_LineCap2(e,t,s,n,h,_,i,r):1===u?this.TexturedLinePreCalc_LineCap1(e,t,s,n,h,_,i,r):this.TexturedLinePreCalc_LineCap0(e,t,s,n,h,_,i,r)}TexturedLinePreCalc_LineCap2(e,t,s,n,i,r,a,o){const l=this._lineOffset,c=e+l-r,h=t+l-i,_=s+l+r,u=n+l+i,d=2*r,p=2*i,f=c+i,m=h-r,g=c-i+d,I=h+r+p,S=_+i,y=u-r,b=_-i-d,G=u+r-p;zc.set(f,m,S,y,b,G,g,I),Xc.set(a,0,o,0),this.Quad3(zc,Xc)}TexturedLinePreCalc_LineCap1(e,t,s,n,i,r,a,o){const l=this._lineOffset,c=e+l-r,h=t+l-i,_=s+l+r,u=n+l+i,d=c+i,p=h-r,f=c-i,m=h+r,g=_+i,I=u-r,S=_-i,y=u+r;zc.set(d,p,g,I,S,y,f,m),Xc.set(a,0,o,0),this.Quad3(zc,Xc)}TexturedLinePreCalc_LineCap0(e,t,s,n,i,r,a,o){const l=this._lineOffset,c=e+l,h=t+l,_=s+l,u=n+l,d=c+i,p=h-r,f=c-i,m=h+r,g=_+i,I=u-r,S=_-i,y=u+r;zc.set(d,p,g,I,S,y,f,m),Xc.set(a,0,o,0),this.Quad3(zc,Xc)}LineRect(e,t,s,n){const i=.5*this._lineWidth,r=this._lineCap;2===r?this._LineRectPreCalc_LineCap2(e,t,s,n,i):1===r?this._LineRectPreCalc_LineCap1(e,t,s,n,i):this._LineRectPreCalc_LineCap0(e,t,s,n,i)}_LineRectPreCalc_LineCap2(e,t,s,n,i){this.LinePreCalc_LineCap2(e,t,0,s,t,0,0,i),this.LinePreCalc_LineCap2(s,t,0,s,n,0,i,0),this.LinePreCalc_LineCap2(s,n,0,e,n,0,0,-i),this.LinePreCalc_LineCap2(e,n,0,e,t,0,-i,0)}_LineRectPreCalc_LineCap1(e,t,s,n,i){this.LinePreCalc_LineCap1(e,t,0,s,t,0,0,i),this.LinePreCalc_LineCap1(s,t,0,s,n,0,i,0),this.LinePreCalc_LineCap1(s,n,0,e,n,0,0,-i),this.LinePreCalc_LineCap1(e,n,0,e,t,0,-i,0)}_LineRectPreCalc_LineCap0(e,t,s,n,i){this.LinePreCalc_LineCap0(e,t,0,s,t,0,0,i),this.LinePreCalc_LineCap0(s,t,0,s,n,0,i,0),this.LinePreCalc_LineCap0(s,n,0,e,n,0,0,-i),this.LinePreCalc_LineCap0(e,n,0,e,t,0,-i,0)}LineRect2(e){this.LineRect(e.getLeft(),e.getTop(),e.getRight(),e.getBottom())}LineQuad(e){const t=kc.angleTo(e.getTlx(),e.getTly(),e.getTrx(),e.getTry()),s=Math.sin(t),n=Math.cos(t),i=.5*this._lineWidth,r=s*i,a=n*i,o=this._lineCap;2===o?this._LineQuadPreCalc_LineCap2(e,r,a):1===o?this._LineQuadPreCalc_LineCap1(e,r,a):this._LineQuadPreCalc_LineCap0(e,r,a)}_LineQuadPreCalc_LineCap2(e,t,s){this.LinePreCalc_LineCap2(e.getTlx(),e.getTly(),0,e.getTrx(),e.getTry(),0,t,s),this.LinePreCalc_LineCap2(e.getTrx(),e.getTry(),0,e.getBrx(),e.getBry(),0,s,-t),this.LinePreCalc_LineCap2(e.getBrx(),e.getBry(),0,e.getBlx(),e.getBly(),0,-t,-s),this.LinePreCalc_LineCap2(e.getBlx(),e.getBly(),0,e.getTlx(),e.getTly(),0,-s,t)}_LineQuadPreCalc_LineCap1(e,t,s){this.LinePreCalc_LineCap1(e.getTlx(),e.getTly(),0,e.getTrx(),e.getTry(),0,t,s),this.LinePreCalc_LineCap1(e.getTrx(),e.getTry(),0,e.getBrx(),e.getBry(),0,s,-t),this.LinePreCalc_LineCap1(e.getBrx(),e.getBry(),0,e.getBlx(),e.getBly(),0,-t,-s),this.LinePreCalc_LineCap1(e.getBlx(),e.getBly(),0,e.getTlx(),e.getTly(),0,-s,t)}_LineQuadPreCalc_LineCap0(e,t,s){this.LinePreCalc_LineCap0(e.getTlx(),e.getTly(),0,e.getTrx(),e.getTry(),0,t,s),this.LinePreCalc_LineCap0(e.getTrx(),e.getTry(),0,e.getBrx(),e.getBry(),0,s,-t),this.LinePreCalc_LineCap0(e.getBrx(),e.getBry(),0,e.getBlx(),e.getBly(),0,-t,-s),this.LinePreCalc_LineCap0(e.getBlx(),e.getBly(),0,e.getTlx(),e.getTly(),0,-s,t)}SetLineWidth(e){this._lineWidth=e,this._lineWidthStack[this._lineWidthStack.length-1]=e}GetLineWidth(){return this._lineWidth}PushLineWidth(e){if(this._lineWidthStack.length>=100)throw new Error("pushed too many line widths - check push/pop pairs");this._lineWidthStack.push(e),this._lineWidth=e}PopLineWidth(){if(this._lineWidthStack.length<=1)throw new Error("cannot pop last line width - check push/pop pairs");this._lineWidthStack.pop(),this._lineWidth=this._lineWidthStack.at(-1)}SetLineCapButt(){this._lineCap=0,this._lineCapStack[this._lineCapStack.length-1]=0}SetLineCapSquare(){this._lineCap=1,this._lineCapStack[this._lineCapStack.length-1]=0}SetLineCapZag(){this._lineCap=2,this._lineCapStack[this._lineCapStack.length-1]=0}PushLineCap(e){if("butt"===e)this.PushLineCapButt();else if("square"===e)this.PushLineCapSquare();else{if("zag"!==e)throw new Error("invalid line cap");this.PushLineCapZag()}}PushLineCapButt(){if(this._lineCapStack.length>=100)throw new Error("pushed too many line caps - check push/pop pairs");this._lineCapStack.push(0),this._lineCap=0}PushLineCapSquare(){if(this._lineCapStack.length>=100)throw new Error("pushed too many line caps - check push/pop pairs");this._lineCapStack.push(1),this._lineCap=1}PushLineCapZag(){if(this._lineCapStack.length>=100)throw new Error("pushed too many line caps - check push/pop pairs");this._lineCapStack.push(2),this._lineCap=2}PopLineCap(){if(this._lineCapStack.length<=1)throw new Error("cannot pop last line cap - check push/pop pairs");this._lineCapStack.pop(),this._lineCap=this._lineCapStack.at(-1)}SetLineOffset(e){this._lineOffset=e,this._lineOffsetStack[this._lineOffsetStack.length-1]=e}GetLineOffset(){return this._lineOffset}PushLineOffset(e){if(this._lineOffsetStack.length>=100)throw new Error("pushed too many line offsets - check push/pop pairs");this._lineOffsetStack.push(e),this._lineOffset=e}PopLineOffset(){if(this._lineOffsetStack.length<=1)throw new Error("cannot pop last line offset - check push/pop pairs");this._lineOffsetStack.pop(),this._lineOffset=this._lineOffsetStack.at(-1)}ConvexPoly(e){const t=e.length/2;if(t<3)throw new Error("need at least 3 points");const s=t-2,n=s-1,i=e[0],r=e[1];for(let t=0;t<s;t+=2){const s=2*t,a=e[s+2],o=e[s+3],l=e[s+4],c=e[s+5];if(t===n)this.Quad2(i,r,a,o,l,c,l,c);else{const t=e[s+6],n=e[s+7];this.Quad2(i,r,a,o,l,c,t,n)}}}GetNumVertexComponents(){return 3}Finish(){this.EndBatch(!0),this._frameNumber++}GetFrameNumber(){return this._frameNumber}IncrementFrameNumber(){this._frameNumber++}SetMipmapsEnabled(e){this._enableMipmaps=!!e}AreMipmapsEnabled(){return this._enableMipmaps}SetHasMajorPerformanceCaveat(e){this._hasMajorPerformanceCaveat=!!e}HasMajorPerformanceCaveat(){return this._hasMajorPerformanceCaveat}IsWebGL(){return!1}IsWebGPU(){return!1}GetEstimatedBackBufferMemoryUsage(){}GetEstimatedRenderBufferMemoryUsage(){}GetEstimatedTextureMemoryUsage(){}GetEstimatedTotalMemoryUsage(){return this.GetEstimatedBackBufferMemoryUsage()+this.GetEstimatedRenderBufferMemoryUsage()+this.GetEstimatedTextureMemoryUsage()}CreateRendererText(){return kc.New(kc.Gfx.RendererText,this)}}}{const Kc=self.C3;Kc.Gfx.ShaderProgramBase=class{constructor(e,t){this._name=t.name,this._renderer=e,this._extendBoxHorizontal=t.extendBoxHorizontal||0,this._extendBoxVertical=t.extendBoxVertical||0,this._crossSampling=!!t.crossSampling,this._mustPreDraw=!!t.mustPreDraw,this._preservesOpaqueness=!!t.preservesOpaqueness,this._supports3dDirectRendering=!!t.supports3dDirectRendering,this._animated=!!t.animated,this._blendsBackground=!!t.blendsBackground,this._usesDepth=!!t.usesDepth,this._usesAnySrcRectOrPixelSize=!1,this._needsPostDrawOrExtendBox=this._crossSampling||this._blendsBackground||0!==this._extendBoxHorizontal||0!==this._extendBoxVertical}Release(){this._renderer=null}GetRenderer(){return this._renderer}GetName(){return this._name}ExtendsBox(){return 0!==this._extendBoxHorizontal||0!==this._extendBoxVertical}GetBoxExtendHorizontal(){return this._extendBoxHorizontal}GetBoxExtendVertical(){return this._extendBoxVertical}UsesCrossSampling(){return this._crossSampling}MustPreDraw(){return this._mustPreDraw}PreservesOpaqueness(){return this._preservesOpaqueness}Supports3DDirectRendering(){return this._supports3dDirectRendering}IsAnimated(){return this._animated}BlendsBackground(){return this._blendsBackground}UsesDepth(){return this._usesDepth}UsesAnySrcRectOrPixelSize(){return this._usesAnySrcRectOrPixelSize}NeedsPostDrawOrExtendsBox(){return this._needsPostDrawOrExtendBox}UsesIsSrcTexRotated(){return!1}}}{const $c=self.C3;$c.Gfx.StateGroup=class{constructor(e,t,s,n,i){this._renderer=e,this._refCount=0,this._shaderProgram=null,this._shaderProgramName="",this._blendMode=s,this._color=$c.New($c.Color),this._color.set(n),this._zElevation=i,"string"==typeof t?this._shaderProgramName=t:(this._shaderProgram=t,this._shaderProgramName=this._shaderProgram.GetName())}Release(){if(this._refCount>0)throw new Error("releasing state group still in use");this._renderer=null,this._shaderProgram=null,this._shaderProgramName=""}Apply(){const e=this._renderer;e.SetProgram(this._shaderProgram),e.SetBlendMode(this._blendMode),e.SetColor(this._color),e.SetCurrentZ(this._zElevation),e._SetCurrentStateGroup(this)}GetKey(){return $c.Gfx.StateGroup.MakeKey(this._shaderProgramName,this._blendMode,this._color,this._zElevation)}AddRef(){++this._refCount}DecRef(){--this._refCount}_GetRefCount(){return this._refCount}OnContextLost(){this._shaderProgram=null}OnContextRestored(e){if(this._shaderProgram=e.GetShaderProgramByName(this._shaderProgramName),!this._shaderProgram)throw new Error("failed to restore shader program")}static MakeKey(e,t,s,n){return("string"==typeof e?e:e.GetName())+","+t+","+s.getR()+","+s.getG()+","+s.getB()+","+s.getA()+","+n}}}{let Zc=function(e,t,s){const n=s.getTlx(),i=s.getTly(),r=s.getTrx()-n,a=s.getTry()-i;return[n+r*e+(s.getBlx()-n)*t,i+a*e+(s.getBly()-i)*t]};interpolateQuad=Zc;const Qc=self.C3,eh=Qc.New(Qc.Quad);Qc.Gfx.MeshPoint=class{constructor(e,t,s){this._mesh=e,this._col=t,this._row=s,this._x=NaN,this._y=NaN,this._zElevation=NaN,this._u=NaN,this._v=NaN,this._x=0,this._y=0,this._zElevation=0,this._u=0,this._v=0}_Init(e,t,s,n){this._x=e,this._y=t,this._u=s,this._v=n}GetX(){return this._x}SetX(e){this._x!==e&&(this._x=e,this._mesh._SetPointsChanged())}GetY(){return this._y}SetY(e){this._y!==e&&(this._y=e,this._mesh._SetPointsChanged())}GetZElevation(){return this._zElevation}SetZElevation(e){this._zElevation!==e&&(this._zElevation=Math.max(e,0),this._mesh._SetPointsChanged())}GetU(){return this._u}SetU(e){this._u=e}GetV(){return this._v}SetV(e){this._v=e}_Interpolate_TexRect(e,t,s){[this._x,this._y]=Zc(e._x,e._y,t),this._zElevation=e._zElevation,this._u=Qc.lerp(s.getLeft(),s.getRight(),e._u),this._v=Qc.lerp(s.getTop(),s.getBottom(),e._v)}_Interpolate_TexQuad(e,t,s){[this._x,this._y]=Zc(e._x,e._y,t),this._zElevation=e._zElevation,[this._u,this._v]=Zc(e._u,e._v,s)}SaveToJson(){return{x:this.GetX(),y:this.GetY(),z:this.GetZElevation(),u:this.GetU(),v:this.GetV()}}LoadFromJson(e){this.SetX(e.x),this.SetY(e.y),e.hasOwnProperty("z")&&this.SetZElevation(e.z),this.SetU(e.u),this.SetV(e.v)}GetMesh(){return this._mesh}GetColumn(){return this._col}GetRow(){return this._row}},Qc.Gfx.Mesh=class{constructor(e,t,s){if(e<2||t<2)throw new Error("invalid mesh size");this._hsize=e,this._vsize=t,this._owner=s||null,this._pts=[],this._minX=0,this._minY=0,this._maxX=1,this._maxY=1,this._maxZ=0,this._pointsChanged=!1;const n=e-1,i=t-1;for(let s=0;s<t;++s){const t=[];for(let r=0;r<e;++r){const e=Qc.New(Qc.Gfx.MeshPoint,this,r,s),a=r/n,o=s/i;e._Init(a,o,a,o),t.push(e)}this._pts.push(t)}}Release(){Qc.clearArray(this._pts)}GetHSize(){return this._hsize}GetVSize(){return this._vsize}GetOwner(){return this._owner}_GetPoints(){return this._pts}_SetPointsChanged(){this._pointsChanged=!0}_MaybeComputeBounds(){if(!this._pointsChanged)return;let e=1/0,t=1/0,s=-1/0,n=-1/0,i=0;for(const r of this._pts)for(const a of r){const r=a.GetX(),o=a.GetY();e=Math.min(e,r),t=Math.min(t,o),s=Math.max(s,r),n=Math.max(n,o),i=Math.max(i,a.GetZElevation())}this._minX=e,this._minY=t,this._maxX=s,this._maxY=n,this._maxZ=i,this._pointsChanged=!1}GetMinX(){return this._MaybeComputeBounds(),this._minX}GetMinY(){return this._MaybeComputeBounds(),this._minY}GetMaxX(){return this._MaybeComputeBounds(),this._maxX}GetMaxY(){return this._MaybeComputeBounds(),this._maxY}GetMaxZ(){return this._MaybeComputeBounds(),this._maxZ}HasAnyZElevation(){return this.GetMaxZ()>0}GetMeshPointAt(e,t){return e=Math.floor(e),t=Math.floor(t),e<0||e>=this._hsize||t<0||t>=this._vsize?null:this._pts[t][e]}CalculateTransformedMesh(e,t,s){const n=s instanceof Qc.Rect;if(e.GetHSize()!==this.GetHSize()||e.GetVSize()!==this.GetVSize())throw new Error("source mesh wrong size");const i=e._pts,r=this._pts;for(let e=0,a=r.length;e<a;++e){const a=i[e],o=r[e];for(let e=0,i=o.length;e<i;++e){const i=a[e],r=o[e];n?r._Interpolate_TexRect(i,t,s):r._Interpolate_TexQuad(i,t,s)}}}Draw(e){const t=this._pts;let s=t[0];for(let n=1,i=t.length;n<i;++n){const i=t[n];let r=s[0],a=i[0];for(let t=1,n=i.length;t<n;++t){const n=s[t],o=i[t];eh.set(r.GetU(),r.GetV(),n.GetU(),n.GetV(),o.GetU(),o.GetV(),a.GetU(),a.GetV()),e.Quad3D2(r.GetX(),r.GetY(),r.GetZElevation(),n.GetX(),n.GetY(),n.GetZElevation(),o.GetX(),o.GetY(),o.GetZElevation(),a.GetX(),a.GetY(),a.GetZElevation(),eh),r=n,a=o}s=i}}Outline(e,t){t||(t=(e,t,s)=>[e,t,s]);const s=this._pts;let n=s[0];for(let i=1,r=s.length;i<r;++i){const a=s[i];let o=n[0],l=a[0];for(let s=1,c=a.length;s<c;++s){const h=n[s],_=a[s],[u,d,p]=t(o.GetX(),o.GetY(),o.GetZElevation()),[f,m,g]=t(h.GetX(),h.GetY(),h.GetZElevation()),[I,S,y]=t(_.GetX(),_.GetY(),_.GetZElevation()),[b,G,v]=t(l.GetX(),l.GetY(),l.GetZElevation());e.Line3D(u,d,p,f,m,g),e.Line3D(u,d,p,I,S,y),e.Line3D(u,d,p,b,G,v),s===c-1&&e.Line3D(f,m,g,I,S,y),i===r-1&&e.Line3D(b,G,v,I,S,y),o=h,l=_}n=a}}InsertPolyMeshVertices(e){const t=.001,s=.99999999,n=e.pointsArr(),i=[],r=this.GetHSize()-1,a=this.GetVSize()-1,o=1/r,l=1/a,c=r-1,h=a-1;let _=n[0],u=n[1],d=Qc.clamp(Math.floor(_*r),0,c),p=Qc.clamp(Math.floor(u*a),0,h),f=!0,m=0,g=0,I=0,S=-1;const y=()=>{_=Qc.clamp(Qc.lerp(_,m,I),0,1),u=Qc.clamp(Qc.lerp(u,g,I),0,1),i.push(_,u)};for(let e=0,b=n.length;e<b;e+=2){_=n[e],u=n[e+1],i.push(_,u),d=Qc.clamp(Math.floor(_*r),0,c),p=Qc.clamp(Math.floor(u*a),0,h);const G=(e+2)%b;for(m=n[G],g=n[G+1],S=-1;;){if(i.length>1e6)throw new Error("Too many mesh poly points");const e=d*o,n=p*l,r=(d+1)*o,a=(p+1)*l;if(f=Qc.isPointInTriangleInclusive(_,u,e,n,r,n,r,a),0!==S&&(I=Qc.rayIntersectExtended(_,u,m,g,e,n,r,a,-.001),I>=0&&I<=s))y(),f=!f,S=0;else if(p>0&&2!==S&&(I=Qc.rayIntersectExtended(_,u,m,g,e,n,r,n,t),I>=0&&I<=s))y(),p--,f=!1,S=4;else if(d<c&&3!==S&&(I=Qc.rayIntersectExtended(_,u,m,g,r,n,r,a,t),I>=0&&I<=s))y(),d++,f=!1,S=1;else if(d>0&&1!==S&&(I=Qc.rayIntersectExtended(_,u,m,g,e,n,e,a,t),I>=0&&I<=s))y(),d--,f=!0,S=3;else{if(!(p<h&&4!==S&&(I=Qc.rayIntersectExtended(_,u,m,g,e,a,r,a,t),I>=0&&I<=s)))break;y(),p++,f=!0,S=2}}}return Qc.New(Qc.CollisionPoly,i)}TransformCollisionPoly(e,t){const s=this._TransformPolyPoints(e);this._SimplifyPoly(s),t.setPoints(s)}_TransformPolyPoints(e){const t=[],s=e.pointsArr();for(let e=0,n=s.length;e<n;e+=2){const n=s[e],i=s[e+1],[r,a]=this.TransformPoint(n,i);t.push(r,a)}return t}TransformPoint(e,t){const s=this.GetHSize()-1,n=this.GetVSize()-1,i=1/s,r=1/n,a=Qc.clamp(Math.floor(e*s),0,s-1),o=Qc.clamp(Math.floor(t*n),0,n-1),l=a*i,c=o*r,h=(a+1)*i,_=(o+1)*r,u=this.GetMeshPointAt(a,o),d=this.GetMeshPointAt(a+1,o+1),p=Qc.isPointInTriangleInclusive(e,t,l,c,h,c,h,_),f=p?l+i:l,m=p?c:c+r,g=this.GetMeshPointAt(a+(p?1:0),o+(p?0:1)),[I,S,y]=Qc.triangleCartesianToBarycentric(e,t,l,c,f,m,h,_);return Qc.triangleBarycentricToCartesian3d(I,S,y,u.GetX(),u.GetY(),u.GetZElevation(),g.GetX(),g.GetY(),g.GetZElevation(),d.GetX(),d.GetY(),d.GetZElevation())}_SimplifyPoly(e){const t=[],s=1e-7;let n=e[0],i=e[1],r=n-e.at(-2),a=i-e.at(-1);for(let o=0,l=e.length;o<l;o+=2){const c=(o+2)%l,h=e[c],_=e[c+1],u=h-n,d=_-i,p=Math.abs(u)<s&&Math.abs(r)<s&&Math.sign(d)===Math.sign(a),f=Math.abs(d)<s&&Math.abs(a)<s&&Math.sign(u)===Math.sign(r);(!p&&!f&&Math.abs(u/r-d/a)>.001||0==u&&0===d)&&t.push(n,i),n=h,i=_,r=u,a=d}t.length>=6&&t.length<e.length&&Qc.shallowAssignArray(e,t)}SaveToJson(){return{cols:this.GetHSize(),rows:this.GetVSize(),points:this._pts.map((e=>e.map((e=>e.SaveToJson()))))}}LoadFromJson(e){const t=this.GetHSize(),s=this.GetVSize();if(e.cols!==t||e.rows!==s)throw new Error("mesh data wrong size");const n=e.points;for(let e=0;e<s;++e){const s=n[e];for(let n=0;n<t;++n)this.GetMeshPointAt(n,e).LoadFromJson(s[n])}}}}{let th=function(e,t){let s,n,i,r;switch(e){case"rgba8":s=t.RGBA8,n=t.RGBA,i=t.RGBA,r=t.UNSIGNED_BYTE;break;case"rgb8":s=t.RGB8,n=t.RGB,i=t.RGB,r=t.UNSIGNED_BYTE;break;case"rgba4":s=t.RGBA4,n=t.RGBA,i=t.RGBA,r=t.UNSIGNED_SHORT_4_4_4_4;break;case"rgb5_a1":s=t.RGB5_A1,n=t.RGBA,i=t.RGBA,r=t.UNSIGNED_SHORT_5_5_5_1;break;case"rgb565":s=t.RGB565,n=t.RGB,i=t.RGB,r=t.UNSIGNED_SHORT_5_6_5;break;default:throw new Error("invalid pixel format")}return{sizedinternalformat:s,internalformat:n,format:i,type:r}};GetFormatSpecifiers=th;const sh=self.C3,nh=new Set(["rgba8","rgb8","rgba4","rgb5_a1","rgb565"]),ih=new Set(["nearest","bilinear","trilinear"]),rh=new Set(["default","low","high"]),ah=new Set(["clamp-to-edge","repeat","mirror-repeat"]),oh={wrapX:"clamp-to-edge",wrapY:"clamp-to-edge",sampling:"trilinear",anisotropy:0,pixelFormat:"rgba8",mipMap:!0,mipMapQuality:"default",premultiplyAlpha:!0,isSvg:!1,width:-1,height:-1},lh={premultiplyAlpha:!0,flipY:!1},ch=new Set;sh.Gfx.WebGLRendererTexture=class{constructor(e){this._renderer=e,this._texture=null,this._width=0,this._height=0,this._isStatic=!0,this._wrapX="clamp-to-edge",this._wrapY="clamp-to-edge",this._sampling="trilinear",this._anisotropy=0,this._pixelFormat="rgba8",this._isMipMapped=!1,this._mipMapQuality="default",this._refCount=0}_CreateStatic(e,t){if(!("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||e instanceof ImageData||e instanceof ArrayBuffer||null===e))throw new Error("invalid texture source");if(t=Object.assign({},oh,t),this._texture)throw new Error("already created texture");if(this._wrapX=t.wrapX,this._wrapY=t.wrapY,this._sampling=t.sampling,this._anisotropy=t.anisotropy,this._pixelFormat=t.pixelFormat,this._isMipMapped=!!t.mipMap&&this._renderer.AreMipmapsEnabled(),this._mipMapQuality=t.mipMapQuality,!ah.has(this._wrapX)||!ah.has(this._wrapY))throw new Error("invalid wrap mode");if(!ih.has(this._sampling))throw new Error("invalid sampling");if(!nh.has(this._pixelFormat))throw new Error("invalid pixel format");if(!rh.has(this._mipMapQuality))throw new Error("invalid mipmap quality");if(this._isStatic=!0,e instanceof ArrayBuffer||null===e||t.isSvg){if(this._width=t.width,this._height=t.height,e instanceof ArrayBuffer&&e.byteLength!==this._width*this._height*4)throw new Error("ArrayBuffer wrong size")}else this._width=e.width,this._height=e.height;if(this._width<=0||this._height<=0)throw new Error("invalid texture data size");if(t.isSvg){const t=sh.CreateCanvas(this._width,this._height);t.getContext("2d").drawImage(e,0,0,this._width,this._height),e=t}const s=sh.isPOT(this._width)&&sh.isPOT(this._height),n=this._renderer.GetMaxTextureSize();if(this._width>n||this._height>n)throw new Error("texture data exceeds maximum texture size");const i=this._renderer.GetContext(),r=this._renderer.GetWebGLVersionNumber();this._texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,this._texture),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1);const a=th(this._pixelFormat,i);if(this._renderer.SupportsNPOTTextures()||s||!this._IsTiled())if(r>=2){let t;t=this._isMipMapped?Math.floor(Math.log2(Math.max(this._width,this._height))+1):1,i.texStorage2D(i.TEXTURE_2D,t,a.sizedinternalformat,this._width,this._height),e instanceof ArrayBuffer?i.texSubImage2D(i.TEXTURE_2D,0,0,0,this._width,this._height,a.format,a.type,new Uint8Array(e)):null!==e&&i.texSubImage2D(i.TEXTURE_2D,0,0,0,a.format,a.type,e)}else e instanceof ArrayBuffer?i.texImage2D(i.TEXTURE_2D,0,a.internalformat,this._width,this._height,0,a.format,a.type,new Uint8Array(e)):null===e?i.texImage2D(i.TEXTURE_2D,0,a.internalformat,this._width,this._height,0,a.format,a.type,null):i.texImage2D(i.TEXTURE_2D,0,a.internalformat,a.format,a.type,e);else{if(null===e)throw new Error("cannot pass null data when creating a NPOT tiled texture without NPOT support");if(e instanceof ArrayBuffer&&(e=new ImageData(new Uint8ClampedArray(e),this._width,this._height)),e instanceof ImageData){const t=sh.CreateCanvas(this._width,this._height);t.getContext("2d").putImageData(e,0,0),e=t}const t=sh.CreateCanvas(sh.nextHighestPowerOfTwo(this._width),sh.nextHighestPowerOfTwo(this._height)),s=t.getContext("2d");s.imageSmoothingEnabled="nearest"!==this._sampling,s.drawImage(e,0,0,this._width,this._height,0,0,t.width,t.height),i.texImage2D(i.TEXTURE_2D,0,a.internalformat,a.format,a.type,t)}null!==e&&this._SetTextureParameters(i),i.bindTexture(i.TEXTURE_2D,null),this._renderer._ResetLastTexture(),this._refCount=1,ch.add(this)}_CreateDynamic(e,t,s){if(s=Object.assign({},oh,s),this._texture)throw new Error("already created texture");if(this._wrapX=s.wrapX,this._wrapY=s.wrapY,this._sampling=s.sampling,this._pixelFormat=s.pixelFormat,this._isMipMapped=!!s.mipMap&&this._renderer.AreMipmapsEnabled(),this._mipMapQuality=s.mipMapQuality,!ah.has(this._wrapX)||!ah.has(this._wrapY))throw new Error("invalid wrap mode");if(!ih.has(this._sampling))throw new Error("invalid sampling");if(!nh.has(this._pixelFormat))throw new Error("invalid pixel format");if(!rh.has(this._mipMapQuality))throw new Error("invalid mipmap quality");this._isStatic=!1,this._width=Math.floor(e),this._height=Math.floor(t);const n=sh.isPOT(this._width)&&sh.isPOT(this._height),i=this._renderer.GetMaxTextureSize();if(this._width<=0||this._height<=0)throw new Error("invalid texture size");if(this._width>i||this._height>i)throw new Error("texture exceeds maximum texture size");if(!this._renderer.SupportsNPOTTextures()&&this._IsTiled()&&!n)throw new Error("non-power-of-two tiled textures not supported");const r=this._renderer.GetContext(),a=this._renderer.GetWebGLVersionNumber();this._texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this._texture),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!1);const o=th(this._pixelFormat,r),l=a>=2?o.sizedinternalformat:o.internalformat;r.texImage2D(r.TEXTURE_2D,0,l,this._width,this._height,0,o.format,o.type,null),this._SetTextureParameters(r),r.bindTexture(r.TEXTURE_2D,null),this._renderer._ResetLastTexture(),this._refCount=1,ch.add(this)}_GetMipMapHint(e){if("default"===this._mipMapQuality)return this._isStatic?e.NICEST:e.FASTEST;if("low"===this._mipMapQuality)return e.FASTEST;if("high"===this._mipMapQuality)return e.NICEST;throw new Error("invalid mipmap quality")}_IsTiled(){return"clamp-to-edge"!==this._wrapX||"clamp-to-edge"!==this._wrapY}_GetTextureWrapMode(e,t){if("clamp-to-edge"===t)return e.CLAMP_TO_EDGE;if("repeat"===t)return e.REPEAT;if("mirror-repeat"===t)return e.MIRRORED_REPEAT;throw new Error("invalid wrap mode")}_SetTextureParameters(e){const t=sh.isPOT(this._width)&&sh.isPOT(this._height);if(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,this._GetTextureWrapMode(e,this._wrapX)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,this._GetTextureWrapMode(e,this._wrapY)),"nearest"===this._sampling)e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),this._isMipMapped=!1;else if(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),(t||this._renderer.SupportsNPOTTextures())&&this._isMipMapped){e.hint(e.GENERATE_MIPMAP_HINT,this._GetMipMapHint(e)),e.generateMipmap(e.TEXTURE_2D);const t="trilinear"===this._sampling&&!this._renderer.HasMajorPerformanceCaveat();e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t?e.LINEAR_MIPMAP_LINEAR:e.LINEAR_MIPMAP_NEAREST)}else e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),this._isMipMapped=!1;const s=this._renderer._GetAnisotropicExtension();s&&this._anisotropy>0&&"nearest"!==this._sampling&&e.texParameterf(e.TEXTURE_2D,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(this._anisotropy,this._renderer._GetMaxAnisotropy()))}_Update(e,t){if(!("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||e instanceof ImageData))throw new Error("invalid texture source");if(!this._texture||this._refCount<=0)throw new Error("texture not created");if(this._isStatic)throw new Error("cannot update static texture");t=Object.assign({},lh,t);const s=e.width||e.videoWidth,n=e.height||e.videoHeight,i=this._renderer.GetWebGLVersionNumber(),r=this._renderer.GetContext();r.bindTexture(r.TEXTURE_2D,this._texture),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!!t.flipY);const a=th(this._pixelFormat,r),o=i>=2?a.sizedinternalformat:a.internalformat;try{if(this._width===s&&this._height===n){const t=sh.isPOT(this._width)&&sh.isPOT(this._height);r.texSubImage2D(r.TEXTURE_2D,0,0,0,a.format,a.type,e),(t||this._renderer.SupportsNPOTTextures())&&this._isMipMapped&&(r.hint(r.GENERATE_MIPMAP_HINT,this._GetMipMapHint(r)),r.generateMipmap(r.TEXTURE_2D))}else{this._width=s,this._height=n;const t=sh.isPOT(this._width)&&sh.isPOT(this._height);if(!this._renderer.SupportsNPOTTextures()&&this._IsTiled()&&!t)throw new Error("non-power-of-two tiled textures not supported");r.texImage2D(r.TEXTURE_2D,0,o,a.format,a.type,e),(t||this._renderer.SupportsNPOTTextures())&&this._isMipMapped&&(r.hint(r.GENERATE_MIPMAP_HINT,this._GetMipMapHint(r)),r.generateMipmap(r.TEXTURE_2D))}}catch(e){console.error("Error updating WebGL texture: ",e)}r.bindTexture(r.TEXTURE_2D,null),this._renderer._ResetLastTexture()}_Delete(){if(this._refCount>0)throw new Error("texture still has references");if(!this._texture)throw new Error("already deleted texture");ch.delete(this),this._renderer.GetContext().deleteTexture(this._texture),this._texture=null}IsValid(){return!!this._texture}_GetTexture(){return this._texture}GetRenderer(){return this._renderer}AddReference(){this._refCount++}SubtractReference(){if(this._refCount<=0)throw new Error("no more references");this._refCount--}GetReferenceCount(){return this._refCount}GetWidth(){return this._width}GetHeight(){return this._height}IsStatic(){return this._isStatic}GetEstimatedMemoryUsage(){let e=this._width*this._height;switch(this._pixelFormat){case"rgba8":e*=4;break;case"rgb8":e*=3;break;case"rgba4":case"rgb5_a1":case"rgb565":e*=2}return this._isMipMapped&&(e+=Math.floor(e/3)),e}static OnContextLost(){ch.clear()}static allTextures(){return ch.values()}}}{const hh=self.C3,_h=self.assert,uh=self.glMatrix,dh=uh.vec3,ph=uh.mat4,fh=new Set(["nearest","bilinear","trilinear"]),mh={sampling:"trilinear",alpha:!0,depth:!1,isSampled:!0,isDefaultSize:!0,multisampling:0},gh=new Set;hh.Gfx.WebGLRenderTarget=class{constructor(e){this._renderer=e,this._frameBuffer=null,this._frameBufferNoDepth=null,this._texture=null,this._renderBuffer=null,this._width=0,this._height=0,this._isDefaultSize=!0,this._sampling="trilinear",this._alpha=!0,this._depth=!1,this._isSampled=!0,this._multisampling=0,this._projectionMatrix=ph.create(),this._lastFov=0,this._lastNearZ=0,this._lastFarZ=0}_Create(e,t,s){s=Object.assign({},mh,s);const n=this._renderer.GetWebGLVersionNumber();if(this._texture||this._renderBuffer)throw new Error("already created render target");if(this._sampling=s.sampling,this._alpha=!!s.alpha,this._depth=!!s.depth,this._isSampled=!!s.isSampled,this._isDefaultSize=!!s.isDefaultSize,this._multisampling=s.multisampling,!fh.has(this._sampling))throw new Error("invalid sampling");if(this._multisampling>0&&(n<2||this._isSampled))throw new Error("invalid use of multisampling");if(n<2&&(this._isSampled=!0),this._width=e,this._height=t,this._width<=0||this._height<=0)throw new Error("invalid render target size");this._CalculateProjection();const i=this._renderer.GetContext();if(this._frameBuffer=i.createFramebuffer(),this._depth&&(this._frameBufferNoDepth=i.createFramebuffer()),this._isSampled){this._texture=this._renderer.CreateDynamicTexture(this._width,this._height,{sampling:this._sampling,pixelFormat:this._alpha?"rgba8":"rgb8",mipMap:!1});const e=this._texture._GetTexture();i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0),this._depth&&(i.bindFramebuffer(i.FRAMEBUFFER,this._frameBufferNoDepth),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e,0))}else{this._renderBuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this._renderBuffer);const e=this._alpha?i.RGBA8:i.RGB8;if(this._multisampling>0){const t=i.getInternalformatParameter(i.RENDERBUFFER,e,i.SAMPLES);if(t&&t[0]){const e=t[0];this._multisampling>e&&(this._multisampling=e)}else this._multisampling=0}0===this._multisampling?i.renderbufferStorage(i.RENDERBUFFER,e,this._width,this._height):i.renderbufferStorageMultisample(i.RENDERBUFFER,this._multisampling,e,this._width,this._height),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,this._renderBuffer),this._depth&&(i.bindFramebuffer(i.FRAMEBUFFER,this._frameBufferNoDepth),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,this._renderBuffer)),i.bindRenderbuffer(i.RENDERBUFFER,null)}const r=this._renderer._GetDepthBuffer();this._depth&&r&&(i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),this._renderer._CanSampleDepth()?i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,r,0):i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r)),i.bindFramebuffer(i.FRAMEBUFFER,null),gh.add(this)}_Resize(e,t){if(this._width===e&&this._height===t)return;this._width=e,this._height=t,this._CalculateProjection();const s=this._renderer.GetContext();s.bindFramebuffer(s.FRAMEBUFFER,this._frameBuffer),this._texture?this._texture._Update(new ImageData(this._width,this._height)):(s.bindRenderbuffer(s.RENDERBUFFER,this._renderBuffer),s.renderbufferStorage(s.RENDERBUFFER,this._alpha?s.RGBA8:s.RGB8,this._width,this._height),s.bindRenderbuffer(s.RENDERBUFFER,null));const n=this._renderer._GetDepthBuffer();this._depth&&n&&(this._renderer._CanSampleDepth()?s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,n,0):s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,n)),s.bindFramebuffer(s.FRAMEBUFFER,null)}_Delete(){if(!this._texture&&!this._renderBuffer)throw new Error("already deleted render target");gh.delete(this);const e=this._renderer.GetContext();this._texture?(e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0),this._depth&&(e.bindFramebuffer(e.FRAMEBUFFER,this._frameBufferNoDepth),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)),this._renderer.DeleteTexture(this._texture),this._texture=null):this._renderBuffer&&(e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,null),this._depth&&(e.bindFramebuffer(e.FRAMEBUFFER,this._frameBufferNoDepth),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,null)),e.deleteRenderbuffer(this._renderBuffer),this._renderBuffer=null),e.bindFramebuffer(e.FRAMEBUFFER,null),this._renderer.GetWebGLVersionNumber()>=2&&(e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null)),e.deleteFramebuffer(this._frameBuffer),this._depth&&e.deleteFramebuffer(this._frameBufferNoDepth);const t=this._renderer.GetBatchState();t.currentFramebuffer=null,t.currentFramebufferNoDepth=null,this._frameBuffer=null}_CalculateProjection(){this._renderer.CalculatePerspectiveMatrix(this._projectionMatrix,this._width/this._height),this._lastFov=this._renderer.GetFovY(),this._lastNearZ=this._renderer.GetNearZ(),this._lastFarZ=this._renderer.GetFarZ()}_GetFramebuffer(){return this._frameBuffer}_GetFramebufferNoDepth(){return this._frameBufferNoDepth}GetRenderer(){return this._renderer}GetTexture(){return this._texture}GetProjectionMatrix(){return this._renderer.GetFovY()===this._lastFov&&this._renderer.GetNearZ()===this._lastNearZ&&this._renderer.GetFarZ()===this._lastFarZ||this._CalculateProjection(),this._projectionMatrix}IsLinearSampling(){return"nearest"!==this._sampling}HasAlpha(){return this._alpha}IsSampled(){return this._isSampled}HasDepthBuffer(){return this._depth}GetWidth(){return this._width}GetHeight(){return this._height}IsDefaultSize(){return this._isDefaultSize}GetMultisampling(){return this._multisampling}GetOptions(){const e={sampling:this._sampling,alpha:this._alpha,isSampled:this._isSampled};return this._isDefaultSize||(e.width=this._width,e.height=this._height),e}IsCompatibleWithOptions(e){return"nearest"!==(e=Object.assign({},mh,e)).sampling===this.IsLinearSampling()&&!!e.alpha===this.HasAlpha()&&!!e.depth===this.HasDepthBuffer()&&!(this._renderer.GetWebGLVersionNumber()>=2&&!!e.isSampled!==this.IsSampled())&&("number"==typeof e.width||"number"==typeof e.height?!this.IsDefaultSize()&&this.GetWidth()===Math.floor(e.width)&&this.GetHeight()===Math.floor(e.height):this.IsDefaultSize())}_GetWebGLTexture(){return this._texture?this._texture._GetTexture():null}GetEstimatedMemoryUsage(){return this._texture?this._texture.GetEstimatedMemoryUsage():this._width*this._height*(this._alpha?4:3)}static async DebugReadPixelsToBlob(e,t){const s=await e.ReadBackRenderTargetToImageData(t,!0);return await hh.ImageDataToBlob(s)}static OnContextLost(){gh.clear()}static allRenderTargets(){return gh.values()}static ResizeAll(e,t){for(const s of gh)s.IsDefaultSize()&&s._Resize(e,t)}}}{const Ih=self.C3,Sh=self.glMatrix,yh=Sh.vec3,bh=Sh.mat4,Gh=new Set(["aPos","aTex","aPoints","matP","matMV","samplerFront","samplerBack","samplerDepth","destStart","destEnd","srcStart","srcEnd","srcOriginStart","srcOriginEnd","pixelSize","seconds","devicePixelRatio","layerScale","layerAngle","layoutStart","layoutEnd","color","color2_","pointTexStart","pointTexEnd","zElevation","tileSize","tileSpacing","outlineThickness","zNear","zFar"]);Ih.Gfx.WebGLShaderProgram=class extends Ih.Gfx.ShaderProgramBase{static async Compile(e,t){const s=e.GetContext(),n=t.src,i=t.vertexSrc,r=t.name,a=s.createShader(s.FRAGMENT_SHADER);s.shaderSource(a,n),s.compileShader(a);const o=s.createShader(s.VERTEX_SHADER);s.shaderSource(o,i),s.compileShader(o);const l=s.createProgram();s.attachShader(l,a),s.attachShader(l,o),s.bindAttribLocation(l,0,"aPos"),s.bindAttribLocation(l,1,"aTex"),s.bindAttribLocation(l,2,"aPoints"),s.linkProgram(l);const c=e._GetParallelShaderCompileExtension();if(c?await e._WaitForObjectReady((()=>s.getProgramParameter(l,c.COMPLETION_STATUS_KHR))):await Ih.Wait(5),!s.getShaderParameter(a,s.COMPILE_STATUS)){const e=s.getShaderInfoLog(a);throw s.deleteShader(a),s.deleteShader(o),s.deleteProgram(l),new Error("Error compiling fragment shader: "+e)}if(!s.getShaderParameter(o,s.COMPILE_STATUS)){const e=s.getShaderInfoLog(o);throw s.deleteShader(a),s.deleteShader(o),s.deleteProgram(l),new Error("Error compiling vertex shader: "+e)}if(!s.getProgramParameter(l,s.LINK_STATUS)){const e=s.getProgramInfoLog(l);throw s.deleteShader(a),s.deleteShader(o),s.deleteProgram(l),new Error("Error linking shader program: "+e)}const h=Ih.FilterUnprintableChars(s.getProgramInfoLog(l)||"").trim();return h&&!Ih.IsStringAllWhitespace(h)&&console.info(`[WebGL] Shader program '${r}' compilation log: `,h),s.deleteShader(a),s.deleteShader(o),l}static async Create(e,t){const s=await Ih.Gfx.WebGLShaderProgram.Compile(e,t);return new Ih.Gfx.WebGLShaderProgram(e,s,t)}constructor(e,t,s){super(e,s);const n=e.GetContext(),i=e.GetBatchState();e.EndBatch(),n.useProgram(t),this._gl=n,this._shaderProgram=t,this._isDeviceTransform="<default-device-transform>"===s.name;const r=n.getAttribLocation(t,"aPos"),a=n.getAttribLocation(t,"aTex");this._locAPoints=n.getAttribLocation(t,"aPoints"),-1!==r&&(n.bindBuffer(n.ARRAY_BUFFER,e._vertexBuffer),n.vertexAttribPointer(r,e.GetNumVertexComponents(),n.FLOAT,!1,0,0),n.enableVertexAttribArray(r)),-1!==a&&(n.bindBuffer(n.ARRAY_BUFFER,e._texcoordBuffer),n.vertexAttribPointer(a,2,n.FLOAT,!1,0,0),n.enableVertexAttribArray(a)),-1!==this._locAPoints&&(n.bindBuffer(n.ARRAY_BUFFER,e._pointBuffer),n.vertexAttribPointer(this._locAPoints,4,n.FLOAT,!1,0,0),n.enableVertexAttribArray(this._locAPoints)),n.bindBuffer(n.ARRAY_BUFFER,null),this._uMatP=new Ih.Gfx.WebGLShaderUniform(this,"matP","mat4"),this._uMatMV=new Ih.Gfx.WebGLShaderUniform(this,"matMV","mat4"),this._uColor=new Ih.Gfx.WebGLShaderUniform(this,"color","vec4"),this._uSamplerFront=new Ih.Gfx.WebGLShaderUniform(this,"samplerFront","sampler"),this._uPointTexStart=new Ih.Gfx.WebGLShaderUniform(this,"pointTexStart","vec2"),this._uPointTexEnd=new Ih.Gfx.WebGLShaderUniform(this,"pointTexEnd","vec2"),this._uZElevation=new Ih.Gfx.WebGLShaderUniform(this,"zElevation","float"),this._uTileSize=new Ih.Gfx.WebGLShaderUniform(this,"tileSize","vec2"),this._uTileSpacing=new Ih.Gfx.WebGLShaderUniform(this,"tileSpacing","vec2"),this._uColor2=new Ih.Gfx.WebGLShaderUniform(this,"color2_","vec4"),this._uOutlineThickness=new Ih.Gfx.WebGLShaderUniform(this,"outlineThickness","float"),this._uSamplerBack=new Ih.Gfx.WebGLShaderUniform(this,"samplerBack","sampler"),this._uSamplerDepth=new Ih.Gfx.WebGLShaderUniform(this,"samplerDepth","sampler"),this._uDestStart=new Ih.Gfx.WebGLShaderUniform(this,"destStart","vec2"),this._uDestEnd=new Ih.Gfx.WebGLShaderUniform(this,"destEnd","vec2"),this._uSrcStart=new Ih.Gfx.WebGLShaderUniform(this,"srcStart","vec2"),this._uSrcEnd=new Ih.Gfx.WebGLShaderUniform(this,"srcEnd","vec2"),this._uSrcOriginStart=new Ih.Gfx.WebGLShaderUniform(this,"srcOriginStart","vec2"),this._uSrcOriginEnd=new Ih.Gfx.WebGLShaderUniform(this,"srcOriginEnd","vec2"),this._uPixelSize=new Ih.Gfx.WebGLShaderUniform(this,"pixelSize","vec2"),this._uSeconds=new Ih.Gfx.WebGLShaderUniform(this,"seconds","float"),this._uDevicePixelRatio=new Ih.Gfx.WebGLShaderUniform(this,"devicePixelRatio","float"),this._uLayerScale=new Ih.Gfx.WebGLShaderUniform(this,"layerScale","float"),this._uLayerAngle=new Ih.Gfx.WebGLShaderUniform(this,"layerAngle","float"),this._uLayoutStart=new Ih.Gfx.WebGLShaderUniform(this,"layoutStart","vec2"),this._uLayoutEnd=new Ih.Gfx.WebGLShaderUniform(this,"layoutEnd","vec2"),this._uZNear=new Ih.Gfx.WebGLShaderUniform(this,"zNear","float"),this._uZFar=new Ih.Gfx.WebGLShaderUniform(this,"zFar","float"),this._hasAnyOptionalUniforms=!!(this._uPixelSize.IsUsed()||this._uSeconds.IsUsed()||this._uSamplerBack.IsUsed()||this._uDestStart.IsUsed()||this._uDestEnd.IsUsed()||this._uSrcStart.IsUsed()||this._uSrcEnd.IsUsed()||this._uSrcOriginStart.IsUsed()||this._uSrcOriginEnd.IsUsed()||this._uDevicePixelRatio.IsUsed()||this._uLayerScale.IsUsed()||this._uLayerAngle.IsUsed()||this._uLayoutStart.IsUsed()||this._uLayoutEnd.IsUsed());const o=s.parameters||[];this._uCustomParameters=[],this._usesAnySrcRectOrPixelSize=this._uPixelSize.IsUsed()||this._uSrcStart.IsUsed()||this._uSrcEnd.IsUsed()||this._uSrcOriginStart.IsUsed()||this._uSrcOriginEnd.IsUsed(),this._hasCurrentMatP=!1,this._hasCurrentMatMV=!1,this._uColor.Init4f(1,1,1,1),this._uColor2.Init4f(1,1,1,1),this._uSamplerFront.Init1i(0),this._uSamplerBack.Init1i(1),this._uSamplerDepth.Init1i(2),this._uPointTexStart.Init2f(0,0),this._uPointTexEnd.Init2f(1,1),this._uZElevation.Init1f(0),this._uTileSize.Init2f(0,0),this._uTileSpacing.Init2f(0,0),this._uDestStart.Init2f(0,0),this._uDestEnd.Init2f(1,1),this._uSrcStart.Init2f(0,0),this._uSrcEnd.Init2f(0,0),this._uSrcOriginStart.Init2f(0,0),this._uSrcOriginEnd.Init2f(0,0),this._uPixelSize.Init2f(0,0),this._uDevicePixelRatio.Init1f(1),this._uZNear.Init1f(e.GetNearZ()),this._uZFar.Init1f(e.GetFarZ()),this._uLayerScale.Init1f(1),this._uLayerAngle.Init1f(0),this._uSeconds.Init1f(0),this._uLayoutStart.Init2f(0,0),this._uLayoutEnd.Init2f(0,0),this._uOutlineThickness.Init1f(1);for(const e of o){const t=e[0],s=e[2],n=new Ih.Gfx.WebGLShaderUniform(this,t,s);"color"===s?n.Init3f(0,0,0):n.Init1f(0),this._uCustomParameters.push(n)}this._isDeviceTransform?this._UpdateDeviceTransformUniforms(i.currentMatP):(this.UpdateMatP(i.currentMatP,!0),this.UpdateMatMV(i.currentMV,!0));const l=i.currentShader;n.useProgram(l?l._shaderProgram:null)}Release(){this._gl.deleteProgram(this._shaderProgram),this._shaderProgram=null,this._renderer._RemoveShaderProgram(this),this._gl=null,super.Release()}GetWebGLContext(){return this._gl}GetShaderProgram(){return this._shaderProgram}GetParameterCount(){return this._uCustomParameters.length}GetParameterType(e){return e<0||e>=this._uCustomParameters.length?null:this._uCustomParameters[e].GetType()}AreCustomParametersAlreadySetInBatch(e){for(let t=0,s=e.length;t<s;++t)if(!this._uCustomParameters[t].IsSetToCustomInBatch(e[t]))return!1;return!0}SetCustomParametersInBatch(e){for(let t=0,s=e.length;t<s;++t)this._uCustomParameters[t].SetBatchValueCustom(e[t])}AreOptionalUniformsAlreadySetInBatch(e,t,s,n,i,r,a,o,l,c){return!(this._uSamplerBack.IsUsed()||this._uPixelSize.IsUsed()&&!this._uPixelSize.IsSetTo2InBatch(i,r)||this._uDestStart.IsUsed()&&!this._uDestStart.IsSetTo2InBatch(e.getLeft(),e.getTop())||this._uDestEnd.IsUsed()&&!this._uDestEnd.IsSetTo2InBatch(e.getRight(),e.getBottom())||this._uDevicePixelRatio.IsUsed()&&!this._uDevicePixelRatio.IsSetTo1InBatch(a)||this._uLayerScale.IsUsed()&&!this._uLayerScale.IsSetTo1InBatch(o)||this._uLayerAngle.IsUsed()&&!this._uLayerAngle.IsSetTo1InBatch(l)||this._uSrcStart.IsUsed()&&!this._uSrcStart.IsSetTo2InBatch(t.getLeft(),t.getTop())||this._uSrcEnd.IsUsed()&&!this._uSrcEnd.IsSetTo2InBatch(t.getRight(),t.getBottom())||this._uSrcOriginStart.IsUsed()&&!this._uSrcOriginStart.IsSetTo2InBatch(s.getLeft(),s.getTop())||this._uSrcOriginEnd.IsUsed()&&!this._uSrcOriginEnd.IsSetTo2InBatch(s.getRight(),s.getBottom())||this._uLayoutStart.IsUsed()&&!this._uLayoutStart.IsSetTo2InBatch(n.getLeft(),n.getTop())||this._uLayoutEnd.IsUsed()&&!this._uLayoutEnd.IsSetTo2InBatch(n.getTop(),n.getBottom())||this._uSeconds.IsUsed()&&!this._uSeconds.IsSetTo1InBatch(c))}SetOptionalUniformsInBatch(e,t,s,n,i,r,a,o,l,c){this._uSamplerBack.IsUsed()||(this._uPixelSize.IsUsed()&&this._uPixelSize.SetBatch2(i,r),this._uDestStart.IsUsed()&&this._uDestStart.SetBatch2(e.getLeft(),e.getTop()),this._uDestEnd.IsUsed()&&this._uDestEnd.SetBatch2(e.getRight(),e.getBottom()),this._uDevicePixelRatio.IsUsed()&&this._uDevicePixelRatio.SetBatch1(a),this._uLayerScale.IsUsed()&&this._uLayerScale.SetBatch1(o),this._uLayerAngle.IsUsed()&&this._uLayerAngle.SetBatch1(l),this._uSrcStart.IsUsed()&&this._uSrcStart.SetBatch2(t.getLeft(),t.getTop()),this._uSrcEnd.IsUsed()&&this._uSrcEnd.SetBatch2(t.getRight(),t.getBottom()),this._uSrcOriginStart.IsUsed()&&this._uSrcOriginStart.SetBatch2(s.getLeft(),s.getTop()),this._uSrcOriginEnd.IsUsed()&&this._uSrcOriginEnd.SetBatch2(s.getRight(),s.getBottom()),this._uLayoutStart.IsUsed()&&this._uLayoutStart.SetBatch2(n.getLeft(),n.getTop()),this._uLayoutEnd.IsUsed()&&this._uLayoutEnd.SetBatch2(n.getTop(),n.getBottom()),this._uSeconds.IsUsed()&&this._uSeconds.SetBatch1(c))}UpdateMatP(e,t){this._hasCurrentMatP&&!t||this._isDeviceTransform||(this._uMatP.IsUsed()&&this._uMatP.UpdateMatrix4fv(e),this._hasCurrentMatP=!0)}SetMatPStale(){this._hasCurrentMatP=!1}UpdateMatMV(e,t){this._hasCurrentMatMV&&!t||this._isDeviceTransform||(this._uMatMV.IsUsed()&&this._uMatMV.UpdateMatrix4fv(e),this._hasCurrentMatMV=!0)}SetMatMVStale(){this._hasCurrentMatMV=!1}_UpdateDeviceTransformUniforms(e){if(!this._isDeviceTransform)throw new Error("not device transform shader");this._uMatP.UpdateMatrix4fv(e);const t=this._renderer,s=t.GetWidth()/2,n=t.GetHeight()/2,i=t.CalculateLookAtModelView2(s,n,t.GetDefaultCameraZ(t.GetHeight()),s,n,0,t.GetHeight());this._uMatMV.UpdateMatrix4fv(i)}UpdateColor(e){this._uColor.IsUsed()&&this._uColor.Update4f(e[0],e[1],e[2],e[3])}static GetReservedUniformNames(){return Gh}static _GetConservativeDepthShaderPrefix(e){return e?"\n#extension GL_EXT_conservative_depth : enable\nlayout (depth_greater) out highp float gl_FragDepth;\n\t":""}static GetDefaultVertexShaderSource(e){const t=e?"highp":"mediump";return["attribute highp vec3 aPos;",`attribute ${t} vec2 aTex;`,`varying ${t} vec2 vTex;`,"uniform highp mat4 matP;","uniform highp mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPos, 1.0);","\tvTex = aTex;","}"].join("\n")}static GetDefaultVertexShaderSource_WebGL2(e){const t=e?"highp":"mediump";return["#version 300 es","in highp vec3 aPos;",`in ${t} vec2 aTex;`,`out ${t} vec2 vTex;`,"uniform highp mat4 matP;","uniform highp mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPos, 1.0);","\tvTex = aTex;","}"].join("\n")}static GetTextureFillFragmentShaderSource_WebGL1_NoFragDepth(){return["varying mediump vec2 vTex;","uniform lowp vec4 color;","uniform lowp sampler2D samplerFront;","void main(void) {","\tgl_FragColor = texture2D(samplerFront, vTex) * color;","}"].join("\n")}static GetTextureFillFragmentShaderSource_WebGL1_FragDepthEXT(){return["#extension GL_EXT_frag_depth : enable","varying mediump vec2 vTex;","uniform lowp vec4 color;","uniform lowp sampler2D samplerFront;","void main(void) {","\tgl_FragColor = texture2D(samplerFront, vTex) * color;","\tgl_FragDepthEXT = (gl_FragColor.a == 0.0 ? 1.0 : gl_FragCoord.z);","}"].join("\n")}static GetTextureFillFragmentShaderSource_WebGL2(e){return["#version 300 es",Ih.Gfx.WebGLShaderProgram._GetConservativeDepthShaderPrefix(e),"in mediump vec2 vTex;","out lowp vec4 outColor;","uniform lowp vec4 color;","uniform lowp sampler2D samplerFront;","void main(void) {","\toutColor = texture(samplerFront, vTex) * color;","\tgl_FragDepth = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);","}"].join("\n")}static GetTilemapFragmentShaderSource_WebGL1_NoFragDepth(){return["varying highp vec2 vTex;","uniform lowp vec4 color;","uniform lowp sampler2D samplerFront;","uniform highp vec2 srcStart;","uniform highp vec2 pixelSize;","uniform highp vec2 tileSize;","uniform highp vec2 tileSpacing;","void main(void) {","\thighp vec2 tile = floor(vTex);","\thighp vec2 tex = fract(vTex);","\thighp vec2 tileOrigin = srcStart + tile * (tileSize + tileSpacing);","\thighp vec2 lowerBound = tileOrigin + pixelSize / 2.0;","\thighp vec2 upperBound = tileOrigin + tileSize - pixelSize / 2.0;","\tgl_FragColor = texture2D(samplerFront, clamp(tex, lowerBound, upperBound), -16.0) * color;","}"].join("\n")}static GetTilemapFragmentShaderSource_WebGL1_FragDepthEXT(){return["#extension GL_EXT_frag_depth : enable","varying highp vec2 vTex;","uniform lowp vec4 color;","uniform lowp sampler2D samplerFront;","uniform highp vec2 srcStart;","uniform highp vec2 pixelSize;","uniform highp vec2 tileSize;","uniform highp vec2 tileSpacing;","void main(void) {","\thighp vec2 tile = floor(vTex);","\thighp vec2 tex = fract(vTex);","\thighp vec2 tileOrigin = srcStart + tile * (tileSize + tileSpacing);","\thighp vec2 lowerBound = tileOrigin + pixelSize / 2.0;","\thighp vec2 upperBound = tileOrigin + tileSize - pixelSize / 2.0;","\tgl_FragColor = texture2D(samplerFront, clamp(tex, lowerBound, upperBound), -16.0) * color;","\tgl_FragDepthEXT = (gl_FragColor.a == 0.0 ? 1.0 : gl_FragCoord.z);","}"].join("\n")}static GetTilemapFragmentShaderSource_WebGL2(e){return["#version 300 es",Ih.Gfx.WebGLShaderProgram._GetConservativeDepthShaderPrefix(e),"in highp vec2 vTex;","out lowp vec4 outColor;","uniform lowp vec4 color;","uniform lowp sampler2D samplerFront;","uniform highp vec2 srcStart;","uniform highp vec2 pixelSize;","uniform highp vec2 tileSize;","uniform highp vec2 tileSpacing;","void main(void) {","\thighp vec2 tile = floor(vTex);","\thighp vec2 tex = fract(vTex);","\thighp vec2 tileOrigin = srcStart + tile * (tileSize + tileSpacing);","\thighp vec2 lowerBound = tileOrigin + pixelSize / 2.0;","\thighp vec2 upperBound = tileOrigin + tileSize - pixelSize / 2.0;","\toutColor = texture(samplerFront, clamp(tex, lowerBound, upperBound), -16.0) * color;","\tgl_FragDepth = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);","}"].join("\n")}static GetTileRandomizationFragmentShaderSource(e,t,s,n){let i="";return e>=2?i="#version 300 es\n"+Ih.Gfx.WebGLShaderProgram._GetConservativeDepthShaderPrefix(n):(t&&(i="#extension GL_EXT_frag_depth : enable\n"),s&&(i+="#extension GL_EXT_shader_texture_lod : enable\n",i+="#extension GL_OES_standard_derivatives : enable\n")),i+`\nprecision highp float;\n${e>=2?"in":"varying"} vec2 vTex;\n${e>=2?"out lowp vec4 outColor;":""}\nuniform lowp vec4 color;\nuniform lowp sampler2D samplerFront;\nuniform vec2 pixelSize;\n\nuniform vec2 tileSize;\nuniform vec2 tileSpacing;\nuniform float outlineThickness;\n\nconst float PI = 3.1415926;\n\nlowp vec4 cospVec4(lowp vec4 a, lowp vec4 b, float x)\n{\n\treturn (a + b + (a - b) * cos(x * PI)) / 2.0;\n}\n\nvec3 randVec3(vec2 seed)\n{\n\treturn vec3(fract(sin(dot(seed.xy + vec2(0.1, 0.1), vec2(12.9898,78.233))) * 43758.5453),\n\t\t\t\tfract(sin(dot(seed.yx + vec2(0.1, 0.1), vec2(12.9898,-78.233))) * 43758.5453),\n\t\t\t\tfract(sin(dot(seed.xy + vec2(0.1, 0.1), vec2(-12.9898,-78.233))) * 43758.5453));\n}\n\nlowp vec4 sampleTile(vec2 tile, vec2 uv, vec2 ddx, vec2 ddy)\n{\n\tvec2 posRandom = tileSize;\n\tfloat angleRandom = outlineThickness;\n\t\n\tvec3 rand = (randVec3(floor(tile + 0.5)) - 0.5) * 2.0;\n\t\n\tfloat angle = angleRandom * rand.z * PI;\n\tfloat sin_a = sin(angle);\n\tfloat cos_a = cos(angle);\n\tfloat aspect = pixelSize.x / pixelSize.y;\n\n\tvec2 mid = tile + vec2(0.5, 0.5);\n\tvec2 dp = uv - mid;\n\tdp.x /= aspect;\n\tvec2 r = vec2(dp.x * cos_a - dp.y * sin_a,\n\t\t\t\t  dp.y * cos_a + dp.x * sin_a);\n\tr.x *= aspect;\n\n\tvec2 p = mid + r + (posRandom * rand.xy / 2.0);\n\t\n\t${e>=2?"return textureGrad(samplerFront, p, ddx, ddy);":""}\n\t${e<2&&s?"return texture2DGradEXT(samplerFront, p, ddx, ddy);":""}\n\t${e<2&&!s?"return texture2D(samplerFront, p);":""}\n}\n\nvoid main(void) {\n\t\n\t${e<2?"lowp vec4 outColor;":""}\n\t\n\tfloat blendMarginX = tileSpacing.x;\n\tfloat blendMarginY = tileSpacing.y;\n\t\n\tvec2 tile = floor(vTex);\n\tvec2 tex = fract(vTex);\n\tvec2 ddx = ${e>=2||s?"dFdx(vTex)":"vec2(0.0, 0.0)"};\n\tvec2 ddy = ${e>=2||s?"dFdy(vTex)":"vec2(0.0, 0.0)"};\n\t\n\tvec4 curTile = sampleTile(tile, vTex, ddx, ddy);\n\t\n\tbool inLeftMargin = (tex.x < blendMarginX);\n\tbool inRightMargin = (tex.x > 1.0 - blendMarginX);\n\tbool inTopMargin = (tex.y < blendMarginY);\n\tbool inBottomMargin = (tex.y > 1.0 - blendMarginY);\n\t\n\tif (inLeftMargin)\n\t{\n\t\tlowp vec4 leftTile = sampleTile(tile + vec2(-1.0, 0.0), vTex, ddx, ddy);\n\t\tfloat leftMix = (tex.x / (blendMarginX * 2.0)) + 0.5;\n\t\tlowp vec4 leftMixedTile = cospVec4(leftTile, curTile, leftMix);\n\t\t\n\t\tif (inTopMargin)\n\t\t{\n\t\t\tlowp vec4 topTile =     sampleTile(tile + vec2(0.0,  -1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 topLeftTile = sampleTile(tile + vec2(-1.0, -1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 topLeftMixedTile = cospVec4(topLeftTile, topTile, leftMix);\n\t\t\t\n\t\t\toutColor = cospVec4(topLeftMixedTile, leftMixedTile, (tex.y / (blendMarginY * 2.0)) + 0.5);\n\t\t}\n\t\telse if (inBottomMargin)\n\t\t{\n\t\t\tlowp vec4 bottomTile =     sampleTile(tile + vec2(0.0,  1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 bottomLeftTile = sampleTile(tile + vec2(-1.0, 1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 bottomLeftMixedTile = cospVec4(bottomLeftTile, bottomTile, leftMix);\n\t\t\t\n\t\t\toutColor = cospVec4(leftMixedTile, bottomLeftMixedTile, (tex.y - (1.0 - blendMarginY)) / (blendMarginY * 2.0));\n\t\t}\n\t\telse\n\t\t{\n\t\t\toutColor = leftMixedTile;\n\t\t}\n\t}\n\telse if (inRightMargin)\n\t{\n\t\tlowp vec4 rightTile = sampleTile(tile + vec2(1.0, 0.0), vTex, ddx, ddy);\n\t\tfloat rightMix = (tex.x - (1.0 - blendMarginX)) / (blendMarginX * 2.0);\n\t\tlowp vec4 rightMixedTile = cospVec4(curTile, rightTile, rightMix);\n\t\t\n\t\tif (inTopMargin)\n\t\t{\n\t\t\tlowp vec4 topTile =      sampleTile(tile + vec2(0.0, -1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 topRightTile = sampleTile(tile + vec2(1.0, -1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 topRightMixedTile = cospVec4(topTile, topRightTile, rightMix);\n\t\t\t\n\t\t\toutColor = cospVec4(topRightMixedTile, rightMixedTile, (tex.y / (blendMarginY * 2.0)) + 0.5);\n\t\t}\n\t\telse if (inBottomMargin)\n\t\t{\n\t\t\tlowp vec4 bottomTile =      sampleTile(tile + vec2(0.0, 1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 bottomRightTile = sampleTile(tile + vec2(1.0, 1.0), vTex, ddx, ddy);\n\t\t\tlowp vec4 bottomRightMixedTile = cospVec4(bottomTile, bottomRightTile, rightMix);\n\t\t\t\n\t\t\toutColor = cospVec4(rightMixedTile, bottomRightMixedTile, (tex.y - (1.0 - blendMarginY)) / (blendMarginY * 2.0));\n\t\t}\n\t\telse\n\t\t{\n\t\t\toutColor = rightMixedTile;\n\t\t}\n\t}\n\telse if (inTopMargin)\n\t{\n\t\tlowp vec4 topTile = sampleTile(tile + vec2(0.0, -1.0), vTex, ddx, ddy);\n\t\toutColor = cospVec4(topTile, curTile, (tex.y / (blendMarginY * 2.0)) + 0.5);\n\t}\n\telse if (inBottomMargin)\n\t{\n\t\tlowp vec4 bottomTile = sampleTile(tile + vec2(0.0, 1.0), vTex, ddx, ddy);\n\t\toutColor = cospVec4(curTile, bottomTile, (tex.y - (1.0 - blendMarginY)) / (blendMarginY * 2.0));\n\t}\n\telse\n\t{\n\t\toutColor = curTile;\n\t}\n\t\n\toutColor *= color;\n\t${e<2?"gl_FragColor = outColor;":""}\n\t${e>=2?"gl_FragDepth = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);":""}\n\t${e<2&&t?"gl_FragDepthEXT = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);":""}\n}\n`}static GetPointVertexShaderSource_WebGL1(){return["attribute vec4 aPoints;","varying float pointOpacity;","uniform float zElevation;","uniform mat4 matP;","uniform mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPoints.xy, zElevation, 1.0);","\tgl_PointSize = aPoints.z;","\tpointOpacity = aPoints.w;","}"].join("\n")}static GetPointVertexShaderSource_WebGL2(){return["#version 300 es","in vec4 aPoints;","out float pointOpacity;","uniform float zElevation;","uniform mat4 matP;","uniform mat4 matMV;","void main(void) {","\tgl_Position = matP * matMV * vec4(aPoints.xy, zElevation, 1.0);","\tgl_PointSize = aPoints.z;","\tpointOpacity = aPoints.w;","}"].join("\n")}static GetPointFragmentShaderSource_WebGL1_NoFragDepth(){return["uniform lowp sampler2D samplerFront;","varying lowp float pointOpacity;","uniform mediump vec2 pointTexStart;","uniform mediump vec2 pointTexEnd;","uniform lowp vec4 color;","void main(void) {","\tmediump vec2 pointTexMin = min(pointTexStart, pointTexEnd);","\tmediump vec2 pointTexMax = max(pointTexStart, pointTexEnd);","\tmediump vec2 pointCoord = (pointTexEnd.x > pointTexStart.x ? gl_PointCoord : vec2(1.0 - gl_PointCoord.y, gl_PointCoord.x));","\tgl_FragColor = texture2D(samplerFront, mix(pointTexMin, pointTexMax, pointCoord)) * color * pointOpacity;","}"].join("\n")}static GetPointFragmentShaderSource_WebGL1_FragDepthEXT(){return["#extension GL_EXT_frag_depth : enable","uniform lowp sampler2D samplerFront;","varying lowp float pointOpacity;","uniform mediump vec2 pointTexStart;","uniform mediump vec2 pointTexEnd;","uniform lowp vec4 color;","void main(void) {","\tmediump vec2 pointTexMin = min(pointTexStart, pointTexEnd);","\tmediump vec2 pointTexMax = max(pointTexStart, pointTexEnd);","\tmediump vec2 pointCoord = (pointTexEnd.x > pointTexStart.x ? gl_PointCoord : vec2(1.0 - gl_PointCoord.y, gl_PointCoord.x));","\tgl_FragColor = texture2D(samplerFront, mix(pointTexMin, pointTexMax, pointCoord)) * color * pointOpacity;","\tgl_FragDepthEXT = (gl_FragColor.a == 0.0 ? 1.0 : gl_FragCoord.z);","}"].join("\n")}static GetPointFragmentShaderSource_WebGL2(e){return["#version 300 es",Ih.Gfx.WebGLShaderProgram._GetConservativeDepthShaderPrefix(e),"uniform lowp sampler2D samplerFront;","in lowp float pointOpacity;","uniform mediump vec2 pointTexStart;","uniform mediump vec2 pointTexEnd;","uniform lowp vec4 color;","out lowp vec4 outColor;","void main(void) {","\tmediump vec2 pointTexMin = min(pointTexStart, pointTexEnd);","\tmediump vec2 pointTexMax = max(pointTexStart, pointTexEnd);","\tmediump vec2 pointCoord = (pointTexEnd.x > pointTexStart.x ? gl_PointCoord : vec2(1.0 - gl_PointCoord.y, gl_PointCoord.x));","\toutColor = texture(samplerFront, mix(pointTexMin, pointTexMax, pointCoord)) * color * pointOpacity;","\tgl_FragDepth = (outColor.a == 0.0 ? 1.0 : gl_FragCoord.z);","}"].join("\n")}static GetColorFillFragmentShaderSource(){return["uniform lowp vec4 color;","void main(void) {","\tgl_FragColor = color;","}"].join("\n")}static GetLinearGradientFillFragmentShaderSource(){return["precision lowp float;","varying mediump vec2 vTex;","uniform vec4 color;","uniform vec4 color2_;","vec3 fromLinear(vec3 linearRGB)","{","\tbvec3 cutoff = lessThan(linearRGB, vec3(0.0031308));","\tvec3 higher = vec3(1.055) * pow(abs(linearRGB), vec3(1.0/2.4)) - vec3(0.055);","\tvec3 lower = linearRGB * vec3(12.92);","\treturn mix(higher, lower, vec3(cutoff));","}","vec3 toLinear(vec3 sRGB)","{","\tbvec3 cutoff = lessThan(sRGB, vec3(0.04045));","\tvec3 higher = pow(abs((sRGB + vec3(0.055))/vec3(1.055)), vec3(2.4));","\tvec3 lower = sRGB/vec3(12.92);","\treturn mix(higher, lower, vec3(cutoff));","}","void main(void) {","\tvec3 linearGrad = mix(toLinear(color.rgb), toLinear(color2_.rgb), vTex.x);","\tfloat a = mix(color.a, color2_.a, vTex.x);","\tgl_FragColor = vec4(fromLinear(linearGrad) * a, a);","}"].join("\n")}static GetPenumbraFillFragmentShaderSource(){return["precision lowp float;","varying highp vec2 vTex;","uniform vec4 color;","void main(void) {","\thighp float grad = vTex.x / (1.0 - vTex.y);","\tgl_FragColor = color * (1.0 - (cos(grad * 3.141592653589793) + 1.0) / 2.0);","}"].join("\n")}static GetSmoothLineFillFragmentShaderSource(){return["varying mediump vec2 vTex;","uniform lowp vec4 color;","void main(void) {","\tlowp float f = 1.0 - abs(vTex.y - 0.5) * 2.0;","\tgl_FragColor = color * f;","}"].join("\n")}static GetHardEllipseFillFragmentShaderSource(){return["varying highp vec2 vTex;","uniform lowp vec4 color;","void main(void) {","\thighp vec2 diff = vTex - vec2(0.5, 0.5);","\thighp vec2 diffSq = diff * diff;","\thighp float f = step(diffSq.x + diffSq.y, 0.25);","\tgl_FragColor = color * f;","}"].join("\n")}static GetHardEllipseOutlineFragmentShaderSource(){return["varying highp vec2 vTex;","uniform lowp vec4 color;","uniform highp vec2 pixelSize;","uniform highp float outlineThickness;","void main(void) {","\thighp vec2 diff = vTex - vec2(0.5, 0.5);","\thighp vec2 diffSq = diff * diff;","\thighp float distSq = diffSq.x + diffSq.y;","\thighp vec2 norm = normalize(diff);","\thighp vec2 halfNorm = norm * 0.5;","\thighp float innerF = step(distSq, 0.25);","\thighp vec2 innerEdge = halfNorm - pixelSize * norm * outlineThickness;","\thighp vec2 innerEdgeSq = innerEdge * innerEdge;","\thighp float outerF = step(innerEdgeSq.x + innerEdgeSq.y, distSq);","\tgl_FragColor = color * innerF * outerF;","}"].join("\n")}static GetSmoothEllipseFillFragmentShaderSource(){return["varying highp vec2 vTex;","uniform lowp vec4 color;","uniform highp vec2 pixelSize;","void main(void) {","\thighp vec2 diff = vTex - vec2(0.5, 0.5);","\thighp vec2 diffSq = diff * diff;","\thighp vec2 norm = normalize(diff);","\thighp vec2 halfNorm = norm * 0.5;","\thighp vec2 halfNormSq = halfNorm * halfNorm;","\thighp vec2 innerEdge = halfNorm - pixelSize * norm;","\thighp vec2 innerEdgeSq = innerEdge * innerEdge;","\thighp float f = smoothstep(halfNormSq.x + halfNormSq.y, innerEdgeSq.x + innerEdgeSq.y, diffSq.x + diffSq.y);","\tgl_FragColor = color * f;","}"].join("\n")}static GetSmoothEllipseOutlineFragmentShaderSource(){return["varying highp vec2 vTex;","uniform lowp vec4 color;","uniform highp vec2 pixelSize;","uniform highp float outlineThickness;","void main(void) {","\thighp vec2 diff = vTex - vec2(0.5, 0.5);","\thighp vec2 diffSq = diff * diff;","\thighp float distSq = diffSq.x + diffSq.y;","\thighp vec2 norm = normalize(diff);","\thighp vec2 halfNorm = norm * 0.5;","\thighp vec2 halfNormSq = halfNorm * halfNorm;","\thighp vec2 pxNorm = pixelSize * norm;","\thighp vec2 innerEdge1 = halfNorm - pxNorm;","\thighp vec2 innerEdge1Sq = innerEdge1 * innerEdge1;","\thighp float innerF = smoothstep(halfNormSq.x + halfNormSq.y, innerEdge1Sq.x + innerEdge1Sq.y, distSq);","\thighp vec2 innerEdge2 = halfNorm - pxNorm * outlineThickness;","\thighp vec2 innerEdge2Sq = innerEdge2 * innerEdge2;","\thighp vec2 innerEdge3 = halfNorm - pxNorm * (outlineThickness + 1.0);","\thighp vec2 innerEdge3Sq = innerEdge3 * innerEdge3;","\thighp float outerF = smoothstep(innerEdge3Sq.x + innerEdge3Sq.y, innerEdge2Sq.x + innerEdge2Sq.y, distSq);","\tgl_FragColor = color * innerF * outerF;","}"].join("\n")}}}{const vh=self.C3,xh=self.glMatrix,Th=xh.mat4,Ch=new Map([["float",1],["percent",1],["sampler",1],["vec2",2],["vec3",3],["color",3],["vec4",4],["mat4",16]]);vh.Gfx.WebGLShaderUniform=class{constructor(e,t,s){if(!Ch.has(s))throw new Error("invalid uniform type");this._owner=e,this._gl=this._owner.GetWebGLContext(),this._name=t,this._type=s,this._isColorType="color"===this._type,this._location=this._gl.getUniformLocation(this._owner.GetShaderProgram(),t),this._isUsed=!!this._location;const n=Ch.get(s);this._lastValue=new Float32Array(n),this._lastBatchValue=new Float32Array(n)}Release(){this._owner=null,this._gl=null,this._location=null}IsUsed(){return this._isUsed}GetType(){return this._type}IsColorType(){return this._isColorType}Init1f(e){this.IsUsed()&&(this._lastValue[0]=e,this._lastBatchValue.set(this._lastValue),this._gl.uniform1f(this._location,e))}Init1i(e){this.IsUsed()&&(this._lastValue[0]=e,this._lastBatchValue.set(this._lastValue),this._gl.uniform1i(this._location,e))}Init2f(e,t){this.IsUsed()&&(this._lastValue[0]=e,this._lastValue[1]=t,this._lastBatchValue.set(this._lastValue),this._gl.uniform2f(this._location,e,t))}Init3f(e,t,s){this.IsUsed()&&(this._lastValue[0]=e,this._lastValue[1]=t,this._lastValue[2]=s,this._lastBatchValue.set(this._lastValue),this._gl.uniform3f(this._location,e,t,s))}Init4f(e,t,s,n){this.IsUsed()&&(this._lastValue[0]=e,this._lastValue[1]=t,this._lastValue[2]=s,this._lastValue[3]=n,this._lastBatchValue.set(this._lastValue),this._gl.uniform4f(this._location,e,t,s,n))}Update1f(e){e=Math.fround(e);const t=this._lastValue;t[0]!==e&&(t[0]=e,this._gl.uniform1f(this._location,e))}Update1i(e){const t=this._lastValue;t[0]!==e&&(t[0]=e,this._gl.uniform1i(this._location,e))}Update2f(e,t){e=Math.fround(e),t=Math.fround(t);const s=this._lastValue;s[0]===e&&s[1]===t||(s[0]=e,s[1]=t,this._gl.uniform2f(this._location,e,t))}Update3f(e,t,s){e=Math.fround(e),t=Math.fround(t),s=Math.fround(s);const n=this._lastValue;n[0]===e&&n[1]===t&&n[2]===s||(n[0]=e,n[1]=t,n[2]=s,this._gl.uniform3f(this._location,e,t,s))}Update4f(e,t,s,n){e=Math.fround(e),t=Math.fround(t),s=Math.fround(s),n=Math.fround(n);const i=this._lastValue;i[0]===e&&i[1]===t&&i[2]===s&&i[3]===n||(i[0]=e,i[1]=t,i[2]=s,i[3]=n,this._gl.uniform4f(this._location,e,t,s,n))}UpdateMatrix4fv(e){const t=this._lastValue;Th.exactEquals(t,e)||(vh.typedArraySet16(t,e,0),this._gl.uniformMatrix4fv(this._location,!1,e))}IsSetToCustomInBatch(e){const t=this._lastBatchValue;return this.IsColorType()?t[0]===Math.fround(e.getR())&&t[1]===Math.fround(e.getG())&&t[2]===Math.fround(e.getB()):t[0]===Math.fround(e)}SetBatchValueCustom(e){const t=this._lastBatchValue;this.IsColorType()?(t[0]=e.getR(),t[1]=e.getG(),t[2]=e.getB()):t[0]=e}IsSetTo1InBatch(e){return this._lastBatchValue[0]===Math.fround(e)}IsSetTo2InBatch(e,t){const s=this._lastBatchValue;return s[0]===Math.fround(e)&&s[1]===Math.fround(t)}SetBatch1(e){this._lastBatchValue[0]=e}SetBatch2(e,t){const s=this._lastBatchValue;s[0]=e,s[1]=t}}}{const wh=self.C3,Ph=self.glMatrix,Ah=Ph.vec4,Rh=Ph.mat4,Dh=0,Eh=1,Mh=2,kh=3,Lh=4,Fh=5,Bh=6,Oh=7,Nh=8,Wh=9,Vh=10,jh=11,Uh=12,Hh=13,zh=14,Xh=15,Yh=16,qh=17,Jh=18,Kh=19,$h=20,Zh=21,Qh=22,e_=23,t_=24,s_=25,n_=26,i_=27,r_=28,a_=29;wh.Gfx.BatchState=class{constructor(e){this.renderer=e,this.currentMV=Rh.create(),this.currentMatP=Rh.create(),this.currentFramebuffer=null,this.currentFramebufferNoDepth=null,this.isDepthSamplingEnabled=!1,this.currentColor=Ah.fromValues(1,1,1,1),this.currentShader=null,this.pointTexCoords=new wh.Rect,this.clearColor=wh.New(wh.Color,0,0,0,0)}},wh.Gfx.WebGLBatchJob=class{constructor(e){const t=new ArrayBuffer(96);this._type=0,this._batchState=e,this._gl=e.renderer.GetContext(),this._startIndex=0,this._indexCount=0,this._texParam=null,this._mat4param=new Float32Array(t,0,16),this._colorParam=new Float32Array(t,64,4),this._srcOriginRect=new Float32Array(t,80,4),this._shaderParams=[]}InitQuad(e,t){this._type=1,this._startIndex=e,this._indexCount=t}DoQuad(){const e=this._gl;e.drawElements(e.TRIANGLES,this._indexCount,e.UNSIGNED_SHORT,this._startIndex)}InitSetTexture(e){this._type=2,this._texParam=e}DoSetTexture(){const e=this._gl,t=this._texParam;e.bindTexture(e.TEXTURE_2D,t?t._GetTexture():null)}InitSetColor(e){this._type=3,e.writeToTypedArray(this._colorParam,0)}DoSetColor(){const e=this._colorParam,t=this._batchState;Ah.copy(t.currentColor,e),t.currentShader.UpdateColor(e)}InitSetGradientColor(e){this._type=21,e.writeToTypedArray(this._colorParam,0)}DoSetGradientColor(){const e=this._colorParam,t=this._batchState.currentShader;t._uColor2.IsUsed()&&t._uColor2.Update4f(e[0],e[1],e[2],e[3])}InitSetBlend(e,t){this._type=4,this._startIndex=e,this._indexCount=t}DoSetBlend(){this._gl.blendFunc(this._startIndex,this._indexCount)}InitSetViewport(e,t,s,n){this._type=5;const i=this._colorParam;i[0]=e,i[1]=t,i[2]=s,i[3]=n}DoSetViewport(){const e=this._colorParam;this._gl.viewport(e[0],e[1],e[2],e[3])}InitSetProjection(e){this._type=6,Rh.copy(this._mat4param,e)}DoSetProjection(){const e=this._batchState,t=e.renderer._allShaderPrograms,s=e.currentShader,n=this._mat4param;for(let e=0,i=t.length;e<i;++e){const i=t[e];i===s?i.UpdateMatP(n,!0):i.SetMatPStale()}Rh.copy(e.currentMatP,n)}InitSetModelView(e){this._type=7,Rh.copy(this._mat4param,e)}DoSetModelView(){const e=this._batchState,t=e.renderer._allShaderPrograms,s=e.currentShader,n=this._mat4param;for(let e=0,i=t.length;e<i;++e){const i=t[e];i===s?i.UpdateMatMV(n,!0):i.SetMatMVStale()}Rh.copy(e.currentMV,n)}InitSetRenderTarget(e){this._type=8,this._texParam=e}DoSetRenderTarget(){const e=this._gl,t=this._texParam,s=this._batchState;t?(s.currentFramebuffer=t._GetFramebuffer(),s.currentFramebufferNoDepth=t._GetFramebufferNoDepth(),s.isDepthSamplingEnabled&&s.currentFramebufferNoDepth?e.bindFramebuffer(e.FRAMEBUFFER,s.currentFramebufferNoDepth):e.bindFramebuffer(e.FRAMEBUFFER,s.currentFramebuffer)):(s.currentFramebuffer=null,s.currentFramebufferNoDepth=null,e.bindFramebuffer(e.FRAMEBUFFER,null))}InitClearSurface(e){this._type=9,e.writeToTypedArray(this._mat4param,0)}InitClearSurface2(e,t,s,n){this._type=9;const i=this._mat4param;i[0]=e,i[1]=t,i[2]=s,i[3]=n}DoClearSurface(){const e=this._gl,t=this._mat4param,s=this._batchState.clearColor,n=t[0],i=t[1],r=t[2],a=t[3];s.equalsRgba(n,i,r,a)||(e.clearColor(n,i,r,a),s.setRgba(n,i,r,a)),e.clear(e.COLOR_BUFFER_BIT)}InitSetPointTexCoords(e){this._type=15,e.writeToTypedArray(this._mat4param,0)}DoSetPointTextureCoords(){const e=this._mat4param;this._batchState.pointTexCoords.set(e[0],e[1],e[2],e[3])}InitPoints(e,t){this._type=10,this._startIndex=e,this._indexCount=1,this._mat4param[0]=t}DoPoints(){const e=this._gl,t=this._batchState,s=t.renderer._spPoints;e.useProgram(s._shaderProgram),s.UpdateMatP(t.currentMatP,!1),s.UpdateMatMV(t.currentMV,!1);const n=t.pointTexCoords;s._uPointTexStart.IsUsed()&&s._uPointTexStart.Update2f(n.getLeft(),n.getTop()),s._uPointTexEnd.IsUsed()&&s._uPointTexEnd.Update2f(n.getRight(),n.getBottom());const i=this._mat4param[0];if(s._uZElevation.IsUsed()&&s._uZElevation.Update1f(i),s._uColor.IsUsed()){const e=t.currentColor;s._uColor.Update4f(e[0],e[1],e[2],e[3])}e.drawArrays(e.POINTS,this._startIndex/4,this._indexCount),e.useProgram(t.currentShader._shaderProgram)}InitSetProgram(e){this._type=11,this._texParam=e}DoSetProgram(){const e=this._gl,t=this._batchState,s=this._texParam;if(t.currentShader=s,e.useProgram(s._shaderProgram),s.UpdateMatP(t.currentMatP,!1),s.UpdateMatMV(t.currentMV,!1),s._uColor.IsUsed()){const e=t.currentColor;s._uColor.Update4f(e[0],e[1],e[2],e[3])}}InitSetProgramParameters(){this._type=12}DoSetProgramParameters(){const e=this._batchState.currentShader,t=this._gl,s=this._mat4param,n=this._colorParam,i=this._srcOriginRect;if(e._uSamplerBack.IsUsed()){const e=this._batchState.renderer,s=this._texParam;e._lastTexture1!==s&&(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,s?s._GetTexture():null),e._lastTexture1=s,t.activeTexture(t.TEXTURE0))}e._uPixelSize.IsUsed()&&e._uPixelSize.Update2f(s[0],s[1]),e._uDestStart.IsUsed()&&e._uDestStart.Update2f(s[2],s[3]),e._uDestEnd.IsUsed()&&e._uDestEnd.Update2f(s[4],s[5]),e._uDevicePixelRatio.IsUsed()&&e._uDevicePixelRatio.Update1f(this._indexCount),e._uLayerScale.IsUsed()&&e._uLayerScale.Update1f(s[6]),e._uLayerAngle.IsUsed()&&e._uLayerAngle.Update1f(s[7]),e._uSrcStart.IsUsed()&&e._uSrcStart.Update2f(s[12],s[13]),e._uSrcEnd.IsUsed()&&e._uSrcEnd.Update2f(s[14],s[15]),e._uSrcOriginStart.IsUsed()&&e._uSrcOriginStart.Update2f(i[0],i[1]),e._uSrcOriginEnd.IsUsed()&&e._uSrcOriginEnd.Update2f(i[2],i[3]),e._uLayoutStart.IsUsed()&&e._uLayoutStart.Update2f(n[0],n[1]),e._uLayoutEnd.IsUsed()&&e._uLayoutEnd.Update2f(n[2],n[3]),e._uSeconds.IsUsed()&&e._uSeconds.Update1f(this._startIndex)}InitSetProgramCustomParameters(){this._type=13}DoSetProgramCustomParameters(){const e=this._batchState.currentShader._uCustomParameters,t=this._shaderParams;for(let s=0,n=e.length;s<n;++s){const n=e[s],i=t[s];n.IsColorType()?n.Update3f(i.getR(),i.getG(),i.getB()):n.Update1f(i)}}InitInvalidateFramebuffer(e){this._type=14,this._texParam=e}DoInvalidateFramebuffer(){const e=this._gl,t=this._texParam,s=this._batchState.currentFramebuffer;t!==s&&e.bindFramebuffer(e.FRAMEBUFFER,t),e.invalidateFramebuffer(e.FRAMEBUFFER,[e.COLOR_ATTACHMENT0]),t!==s&&e.bindFramebuffer(e.FRAMEBUFFER,s)}InitBlitFramebuffer(e,t,s){this._type=17;const n=this._mat4param,i=this._batchState.renderer;n[0]=e.GetWidth(),n[1]=e.GetHeight(),n[2]=t?t.GetWidth():i.GetWidth(),n[3]=t?t.GetHeight():i.GetHeight(),n[4]=e.IsLinearSampling()?1:0,n[5]="stretch"===s;const r=this._shaderParams;wh.clearArray(r),r.push(e._GetFramebuffer()),r.push(t?t._GetFramebuffer():null)}DoBlitFramebuffer(){const e=this._mat4param,t=this._shaderParams,s=this._gl,n=e[0],i=e[1],r=e[2],a=e[3],o=0!==e[4],l=0!==e[5],c=t[0],h=t[1];if(s.bindFramebuffer(s.READ_FRAMEBUFFER,c),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,h),l)s.blitFramebuffer(0,0,n,i,0,0,r,a,s.COLOR_BUFFER_BIT,o?s.LINEAR:s.NEAREST);else{const e=Math.min(n,r),t=Math.min(i,a),o=Math.max(i-a,0),l=Math.max(a-i,0);s.blitFramebuffer(0,o,e,t+o,0,l,e,t+l,s.COLOR_BUFFER_BIT,s.NEAREST)}}InitStartQuery(e){this._type=18,this._texParam=e}DoStartQuery(){this._texParam.BeginTimeElapsed(),this._texParam=null}InitEndQuery(e){this._type=19,this._texParam=e}DoEndQuery(){this._texParam.EndTimeElapsed(),this._texParam=null}InitSetEllipseParams(e,t,s){this._type=20;const n=this._mat4param;n[0]=e,n[1]=t,n[2]=s}DoSetEllipseParams(){const e=this._batchState.currentShader,t=this._mat4param;e._uPixelSize.IsUsed()&&e._uPixelSize.Update2f(t[0],t[1]),e._uOutlineThickness.IsUsed()&&e._uOutlineThickness.Update1f(t[2])}InitSetTilemapInfo(e,t,s,n,i,r,a){this._type=16;const o=this._mat4param;e.writeToTypedArray(o,0),o[4]=1/t,o[5]=1/s,o[6]=n/t,o[7]=i/s,o[8]=r/t,o[9]=a/s}DoSetTilemapInfo(){const e=this._batchState.currentShader,t=this._mat4param;e._uSrcStart.IsUsed()&&e._uSrcStart.Update2f(t[0],t[1]),e._uPixelSize.IsUsed()&&e._uPixelSize.Update2f(t[4],t[5]),e._uTileSize.IsUsed()&&e._uTileSize.Update2f(t[6],t[7]),e._uTileSpacing.IsUsed()&&e._uTileSpacing.Update2f(t[8],t[9])}InitSetTileRandomizationInfo(e,t,s,n,i,r,a){this._type=29;const o=this._mat4param;o[0]=1/e,o[1]=1/t,o[2]=s,o[3]=n,o[4]=i,o[5]=r,o[6]=a}DoSetTileRandomizationInfo(){const e=this._batchState.currentShader,t=this._mat4param;e._uPixelSize.IsUsed()&&e._uPixelSize.Update2f(t[0],t[1]),e._uTileSize.IsUsed()&&e._uTileSize.Update2f(t[2],t[3]),e._uOutlineThickness.IsUsed()&&e._uOutlineThickness.Update1f(t[4]),e._uTileSpacing.IsUsed()&&e._uTileSpacing.Update2f(t[5],t[6])}InitClearDepth(e){this._type=22,this._startIndex=e?1:0}DoClearDepth(){const e=this._gl,t=0!==this._startIndex;t||e.depthMask(!0),e.clear(e.DEPTH_BUFFER_BIT),t||e.depthMask(!1)}InitSetDepthEnabled(e){this._type=23,this._startIndex=e?1:0}DoSetDepthEnabled(){const e=this._gl;0===this._startIndex?(e.disable(e.DEPTH_TEST),e.depthMask(!1)):(e.enable(e.DEPTH_TEST),e.depthMask(!0))}InitSetDepthSamplingEnabled(e){this._type=24,this._startIndex=e?1:0}DoSetDepthSamplingEnabled(){const e=this._gl,t=this._batchState,s=t.renderer,n=0!==this._startIndex;t.isDepthSamplingEnabled=n,e.activeTexture(e.TEXTURE2),n?(t.currentFramebufferNoDepth&&e.bindFramebuffer(e.FRAMEBUFFER,t.currentFramebufferNoDepth),e.bindTexture(e.TEXTURE_2D,s._GetDepthBuffer())):(e.bindTexture(e.TEXTURE_2D,null),t.currentFramebufferNoDepth&&e.bindFramebuffer(e.FRAMEBUFFER,t.currentFramebuffer)),e.activeTexture(e.TEXTURE0)}InitCoplanarStartStencilPass(){this._type=25}DoCoplanarStartStencilPass(){const e=this._gl;e.clear(e.STENCIL_BUFFER_BIT),e.enable(e.STENCIL_TEST),e.stencilFunc(e.ALWAYS,1,1),e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.colorMask(!1,!1,!1,!1)}InitCoplanarStartColorPass(){this._type=26}DoCoplanarStartColorPass(){const e=this._gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,1,1),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}InitCoplanarRestore(){this._type=27}DoCoplanarRestore(){const e=this._gl;e.disable(e.STENCIL_TEST)}InitSetScissor(e,t,s,n,i){this._type=28,this._startIndex=e?1:0;const r=this._mat4param;r[0]=t,r[1]=s,r[2]=n,r[3]=i}DoSetScissor(){const e=this._gl,t=this._mat4param;1===this._startIndex?(e.enable(e.SCISSOR_TEST),e.scissor(t[0],t[1],t[2],t[3])):e.disable(e.SCISSOR_TEST)}Run(){switch(this._type){case 1:return void this.DoQuad();case 2:return void this.DoSetTexture();case 3:return void this.DoSetColor();case 4:return void this.DoSetBlend();case 5:return void this.DoSetViewport();case 6:return void this.DoSetProjection();case 7:return void this.DoSetModelView();case 8:return void this.DoSetRenderTarget();case 9:return void this.DoClearSurface();case 10:return void this.DoPoints();case 11:return void this.DoSetProgram();case 12:return void this.DoSetProgramParameters();case 13:return void this.DoSetProgramCustomParameters();case 14:return void this.DoInvalidateFramebuffer();case 15:return void this.DoSetPointTextureCoords();case 16:return void this.DoSetTilemapInfo();case 17:return void this.DoBlitFramebuffer();case 18:return void this.DoStartQuery();case 19:return void this.DoEndQuery();case 20:return void this.DoSetEllipseParams();case 21:return void this.DoSetGradientColor();case 22:return void this.DoClearDepth();case 23:return void this.DoSetDepthEnabled();case 24:return void this.DoSetDepthSamplingEnabled();case 25:return void this.DoCoplanarStartStencilPass();case 26:return void this.DoCoplanarStartColorPass();case 27:return void this.DoCoplanarRestore();case 28:return void this.DoSetScissor();case 29:return void this.DoSetTileRandomizationInfo()}}}}{let o_=function(e,t,s,n,i,r){t?e.strokeRect(s,n,i,r):e.fillRect(s,n,i,r)},l_=function(e){return e*(4/3)},c_=function(e,t){e=e.trim();const s=parseFloat(e);return isFinite(s)?e.endsWith("%")?t*s/100:s:0};fillOrStrokeRect=o_,ptToPx=l_,getOffsetParam=c_;const h_=self.C3,__=4096,u_=4,d_=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),p_={timeout:60},f_=new h_.Color(0,0,0,1),m_=new Set(["left","center","right"]),g_=new Set(["top","center","bottom"]),I_=new Set(["word","cjk","character"]),S_=new Set(["ltr","rtl"]),y_=new Set;h_.FontManager&&h_.FontManager.addEventListener("fontload",(e=>{const t=e.font.GetName();for(const e of y_)(e.IsBBCodeEnabled()||h_.equalsNoCase(e.GetFontName(),t))&&e._SetWordWrapChanged()}));let b_=!1,G_=!1;h_.Gfx.RendererText=class{constructor(e,t){t=Object.assign({},p_,t),this._renderer=e,this._fontName="Arial",this._fontSize=16,this._fontSizeScale=1,this._lineHeight=0,this._isBold=!1,this._isItalic=!1,this._colorStr="black",this._isBBcodeEnabled=!1,this._iconSet=null,this._iconSmoothing=!0,this.onloadfont=null,this._alreadyLoadedFonts=new Set,this._horizontalAlign="left",this._verticalAlign="top",this._text="",this._bbString=null,this._wrappedText=h_.New(h_.WordWrap),this._wrapMode="word",this._textDirection="ltr",this._wordWrapChanged=!1,this._textLayoutChanged=!1,this._drawChanged=!1,this._drawMaxCharCount=-1,this._drawCharCount=0,this._cssWidth=0,this._cssHeight=0,this._width=0,this._height=0,this._zoom=1,this._textCanvas=null,this._textContext=null,this._measureContext=null,this._measureContextTop=null,this._lastCanvasWidth=-1,this._lastCanvasHeight=-1,this._lastTextCanvasFont="",this._lastMeasureCanvasFont="",this._lastTextCanvasFillStyle="",this._lastTextCanvasOpacity=1,this._lastTextCanvasLineWidth=1,this._measureTextCallback=e=>this._MeasureText(e),this._texture=null,this._rcTex=new h_.Rect,this._scaleFactor=1,this._textureTimeout=new h_.IdleTimeout((()=>{this.ReleaseTexture(),this._SetTextCanvasSize(8,8)}),t.timeout),this.ontextureupdate=null,this._wasReleased=!1,y_.add(this)}Release(){this.onloadfont=null,this._alreadyLoadedFonts.clear(),this._iconSet=null,this._bbString=null,this._textCanvas=null,this._textContext=null,this._measureContext=null,this._measureContextTop=null,this._measureTextCallback=null,this._textureTimeout.Release(),this.ontextureupdate=null,this.ReleaseTexture(),this._wrappedText.Clear(),this._wrappedText=null,this._renderer=null,this._wasReleased=!0,y_.delete(this)}_SetDrawChanged(){this._drawChanged=!0}_SetTextLayoutChanged(){this._SetDrawChanged(),this._textLayoutChanged=!0}_SetWordWrapChanged(){this._SetTextLayoutChanged(),this._wordWrapChanged=!0}SetBBCodeEnabled(e){if(e=!!e,this._isBBcodeEnabled===e)return;this._isBBcodeEnabled=e;const t=this._isBBcodeEnabled?"alphabetic":"top";this._textContext&&(this._textContext.textBaseline=t),this._measureContext&&(this._measureContext.textBaseline=t),this._SetWordWrapChanged()}IsBBCodeEnabled(){return this._isBBcodeEnabled}SetIconSet(e){this._iconSet!==e&&(this._iconSet=e,this._wrappedText.SetIconSet(e),this._iconSet&&this._iconSet.IsLoading()&&this._iconSet.LoadContent().then((()=>this._SetDrawChanged())),this._SetWordWrapChanged())}SetIconSmoothing(e){e=!!e,this._iconSmoothing!==e&&(this._iconSmoothing=e,this._SetDrawChanged())}SetFontName(e){e||(e="serif"),this._fontName!==e&&(this._fontName=e,this._SetWordWrapChanged())}GetFontName(){return this._fontName}SetFontSize(e){e<.1&&(e=.1),this._fontSize!==e&&(this._fontSize=e,this._SetWordWrapChanged())}GetFontSize(){return this._fontSize}SetFontSizeScale(e){this._fontSizeScale!==e&&(this._fontSizeScale=e,this._SetWordWrapChanged())}SetLineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this._SetTextLayoutChanged())}GetLineHeight(){return this._lineHeight}SetBold(e){e=!!e,this._isBold!==e&&(this._isBold=e,this._SetWordWrapChanged())}IsBold(){return this._isBold}SetItalic(e){e=!!e,this._isItalic!==e&&(this._isItalic=e,this._SetWordWrapChanged())}IsItalic(){return this._isItalic}SetDrawMaxCharacterCount(e){e=Math.floor(e),this._drawMaxCharCount!==e&&(this._drawMaxCharCount=e,this._SetDrawChanged())}GetDrawMaxCharacterCount(){return this._drawMaxCharCount}_GetFontString(e,t){let s=[];(this._isBold||t.HasStyleTag("b"))&&s.push("bold"),(this._isItalic||t.HasStyleTag("i"))&&s.push("italic");const n=t.GetStyleTag("size"),i=(n?parseFloat(n.param):this._fontSize)*this._fontSizeScale;e?s.push(i+"pt"):s.push(i*this.GetDrawScale()+"pt");let r=this._fontName;const a=t.GetStyleTag("font");return a&&a.param&&(r=a.param,this.onloadfont&&!this._alreadyLoadedFonts.has(r)&&(this.onloadfont(r),this._alreadyLoadedFonts.add(r))),r&&(d_.has(r)?s.push(r):s.push('"'+r+'"')),s.join(" ")}SetColor(e){e instanceof h_.Color&&(e=e.getCssRgb()),this._colorStr!==e&&(this._colorStr=e,this._SetDrawChanged())}SetColorRgb(e,t,s){f_.setRgb(e,t,s),this.SetColor(f_)}SetHorizontalAlignment(e){if(!m_.has(e))throw new Error("invalid horizontal alignment");this._horizontalAlign!==e&&(this._horizontalAlign=e,this._SetTextLayoutChanged())}GetHorizontalAlignment(){return this._horizontalAlign}SetVerticalAlignment(e){if(!g_.has(e))throw new Error("invalid vertical alignment");this._verticalAlign!==e&&(this._verticalAlign=e,this._SetTextLayoutChanged())}GetVerticalAlignment(){return this._verticalAlign}SetWordWrapMode(e){if(!I_.has(e))throw new Error("invalid word wrap mode");this._wrapMode!==e&&(this._wrapMode=e,this._SetWordWrapChanged())}GetWordWrapMode(){return this._wrapMode}SetTextDirection(e){if(!S_.has(e))throw new Error("invalid text direction");this._textDirection!==e&&(this._textDirection=e,this._textContext&&(this._textContext.direction=this._textDirection),this._measureContext&&(this._measureContext.direction=this._textDirection),this._SetWordWrapChanged())}GetTextDirection(){return this._textDirection}SetText(e){this._text!==e&&(this._text=e,this._SetWordWrapChanged())}GetText(){return this._text}GetDrawScale(){return this._scaleFactor*this._zoom*self.devicePixelRatio}SetSize(e,t,s){if(void 0===s&&(s=1),e<=0||e<=0)return;if(this._cssWidth===e&&this._cssHeight===t&&this._zoom===s)return;const n=this._cssWidth;this._cssWidth=e,this._cssHeight=t,this._zoom=s;const i=self.devicePixelRatio;this._width=this._cssWidth*this._zoom*i,this._height=this._cssHeight*this._zoom*i;const r=Math.max(this._width,this._height),a=Math.min(this._renderer.GetMaxTextureSize(),4096);let o=1;r>a&&(o=a/r,this._width=Math.min(this._width*o,a),this._height=Math.min(this._height*o,a)),this._scaleFactor=o,this._cssWidth!==n?this._SetWordWrapChanged():this._SetTextLayoutChanged()}GetWidth(){return this._width}GetHeight(){return this._height}GetZoom(){return this._zoom}GetTextWidth(){return this._UpdateTextMeasurements(),this._wrappedText.GetMaxLineWidth()}GetTextHeight(){return this._UpdateTextMeasurements(),this._wrappedText.GetTotalLineHeight()+this._wrappedText.GetLineCount()*(this._lineHeight+4)-this._lineHeight}GetLengthInGraphemes(){this._UpdateTextMeasurements();let e=0;for(const t of this._wrappedText.GetLines())for(const s of t.fragments())e+=s.GetLength();return e}GetTexture(){return this._textureTimeout.Reset(),this._MaybeUpdate(),this._texture}HitTestFragment(e,t){this._UpdateTextMeasurements();const s=this.GetDrawScale(),n=this._wrappedText.GetLines();for(const i of n){const n=i.GetFontBoundingBoxDescent()*s;if(t>=i.GetPosY()-i.GetHeight()*s+n&&t<i.GetPosY()+n)for(const t of i.fragments())if(e>=t.GetPosX()&&e<t.GetPosX()+t.GetWidth()*s)return t}return null}*fragmentsWithTag(e){this._UpdateTextMeasurements();const t=this._wrappedText.GetLines();for(const s of t)for(const t of s.fragments()){const s=t.GetStyleTag("tag");s&&h_.equalsNoCase(s.param,e)&&(yield t)}}FindFragmentWithTag(e,t){for(const s of this.fragmentsWithTag(e)){if(0===t)return s;--t}return null}CountFragmentsWithTag(e){let t=0;for(const s of this.fragmentsWithTag(e))++t;return t}_MaybeUpdate(){(!this._texture||this._drawChanged||this._textLayoutChanged||this._wordWrapChanged)&&(this._wasReleased||this._width<=0||this._height<=0||(this._drawChanged=!1,this._DoUpdate()))}_DoUpdate(){this._wasReleased||(this._UpdateTextMeasurements(),this._SetTextCanvasSize(Math.max(h_.nextHighestPowerOfTwo(Math.ceil(this._width)),128),Math.max(h_.nextHighestPowerOfTwo(Math.ceil(this._height)),64)),this._DrawTextToCanvas(),this._UpdateTexture(),this._textureTimeout.Reset())}_SetTextCanvasSize(e,t){this._textCanvas||(this._textCanvas=h_.CreateCanvas(16,16));let s=!1;this._lastCanvasWidth===e&&this._lastCanvasHeight===t||(this._lastCanvasWidth=e,this._lastCanvasHeight=t,this._textCanvas.width=e,this._textCanvas.height=t,s=!0),this._textContext||(this._textContext=this._textCanvas.getContext("2d"),s=!0),s?(this._textContext.textBaseline=this._isBBcodeEnabled?"alphabetic":"top",this._textContext.direction=this._textDirection,this._textContext.font=this._lastTextCanvasFont,this._textContext.fillStyle=this._lastTextCanvasFillStyle,this._textContext.strokeStyle=this._lastTextCanvasFillStyle,this._textContext.globalAlpha=this._lastTextCanvasOpacity,this._textContext.lineWidth=this._lastTextCanvasLineWidth):this._textContext.clearRect(0,0,e,t)}_MaybeCreateMeasureContext(){this._measureContext||(this._measureContext=h_.CreateCanvas(16,16).getContext("2d"),this._measureContextTop=h_.CreateCanvas(16,16).getContext("2d"),this._measureContext.textBaseline=this._isBBcodeEnabled?"alphabetic":"top",this._measureContextTop.textBaseline="top",this._measureContext.direction=this._textDirection,this._measureContextTop.direction=this._textDirection)}_SetMeasureFontString(e){this._lastMeasureCanvasFont!==e&&(this._lastMeasureCanvasFont=e,this._measureContext.font=e,this._measureContextTop.font=e)}_SupportsFontBoundingBoxMeasurements(){if(!b_){b_=!0,this._MaybeCreateMeasureContext();const e=this._measureContext.measureText("test");G_="number"==typeof e.fontBoundingBoxAscent&&"number"==typeof e.fontBoundingBoxDescent}return G_}_UpdateTextMeasurements(){this._UpdateWordWrap(),this._UpdateTextLayout()}_UpdateWordWrap(){this._wordWrapChanged&&(this._MaybeCreateMeasureContext(),!this._isBBcodeEnabled||this._bbString&&this._bbString.toString()===this._text||(this._bbString=new h_.BBString(this._text,{noEscape:!0})),this._wrappedText.WordWrap(this._isBBcodeEnabled?this._bbString.toFragmentList():this._text,this._measureTextCallback,this._cssWidth,this._wrapMode,0),this._wordWrapChanged=!1)}_UpdateTextLayout(){this._textLayoutChanged&&(this._LayoutText(),this._textLayoutChanged=!1)}_MeasureText(e){const t=e.IsText()?e.GetCharacterArray().join(""):" ";this._SetMeasureFontString(this._GetFontString(!0,e));const s=e.GetStyleTag("size"),n=(s?parseFloat(s.param):this._fontSize)*this._fontSizeScale,i=this._measureContext.measureText(t);let r=0;if(this._isBBcodeEnabled&&this._SupportsFontBoundingBoxMeasurements()){const e=this._measureContextTop.measureText(t);r=i.fontBoundingBoxAscent-e.fontBoundingBoxAscent}return{width:i.width,height:l_(n),fontBoundingBoxAscent:i.fontBoundingBoxAscent||0,fontBoundingBoxDescent:i.fontBoundingBoxDescent||0,topToAlphabeticDistance:r}}_SetDrawFontString(e){this._lastTextCanvasFont!==e&&(this._lastTextCanvasFont=e,this._textContext.font=e)}_SetDrawCanvasColor(e){this._lastTextCanvasFillStyle!==e&&(this._lastTextCanvasFillStyle=e,this._textContext.fillStyle=e,this._textContext.strokeStyle=e)}_SetDrawCanvasOpacity(e){this._lastTextCanvasOpacity!==e&&(this._lastTextCanvasOpacity=e,this._textContext.globalAlpha=e)}_SetDrawCanvasLineWith(e){this._lastTextCanvasLineWidth!==e&&(this._lastTextCanvasLineWidth=e,this._textContext.lineWidth=e)}_LayoutText(){const e=this.GetDrawScale(),t=(4+this._lineHeight)*e;let s=0;const n=this._wrappedText.GetLines();if(0===n.length)return;for(const e of n){e.SetPosX(NaN),e.SetPosY(NaN);for(const t of e.fragments())t.SetPosX(NaN),t.SetPosY(NaN)}const i=this._isBBcodeEnabled&&this._SupportsFontBoundingBoxMeasurements();let r=n[0].GetHeight()*e;if("center"===this._verticalAlign){const a=n.reduce(((s,n)=>s+n.GetHeight()*e+t),0)-t;s=Math.max(this._height/2-a/2,0),i&&(r=n[0].GetTopToAlphabeticDistance()*e)}else if("bottom"===this._verticalAlign){const r=n.reduce(((s,n)=>s+n.GetHeight()*e+t),0)-this._lineHeight*e,a=i?n.at(-1).GetFontBoundingBoxDescent()*e:0;s=this._height-r-a-2}for(let i=0,a=n.length;i<a;++i){const a=n[i],o=a.GetHeight()*e,l=s;if(this._isBBcodeEnabled){if(s+=0===i?r:o,i>0&&s>this._height-4*e)break}else if(i>0&&s>=this._height-o)break;l>=0&&this._LayoutTextLine(a,s,e),this._isBBcodeEnabled||(s+=o),s+=t}}_LayoutTextLine(e,t,s){let n=0;"center"===this._horizontalAlign?n=Math.floor((this._width-e.GetWidth()*s)/2):"right"===this._horizontalAlign&&(n=this._width-e.GetWidth()*s),e.SetPosX(n),e.SetPosY(t);for(const i of"ltr"===this._textDirection?e.fragments():e.fragmentsReverse())this._LayoutFragment(i,n,t,s),n+=i.GetWidth()*s}_LayoutFragment(e,t,s,n){const i=e.GetStyleTag("offsetx");t+=i?c_(i.param,e.GetHeight())*n:0;const r=e.GetStyleTag("offsety");if(s+=r?c_(r.param,e.GetHeight())*n:0,e.IsIcon()){const t=e.GetStyleTag("iconoffsety");s+=t?c_(t.param,e.GetHeight())*n:.2*e.GetHeight()*n}e.SetPosX(t),e.SetPosY(s)}_DrawTextToCanvas(){this._textContext.imageSmoothingEnabled=this._iconSmoothing,this._textContext.imageSmoothingQuality="high",this._drawCharCount=0;const e=this.GetDrawScale(),t=this._wrappedText.GetLines();for(const s of t)this._DrawTextLine(s,e)}_DrawTextLine(e,t){const s=e.GetPosX(),n=e.GetPosY();if(Number.isFinite(s)&&Number.isFinite(n))for(const s of"ltr"===this._textDirection?e.fragments():e.fragmentsReverse())this._DrawFragment(s,t,e.GetHeight())}_DrawFragment(e,t,s){const n=this._textContext,i=e.GetPosX(),r=e.GetPosY();if(!Number.isFinite(i)||!Number.isFinite(r))return;const a=s/16;let o=e.GetWidth()*t;const l=e.GetHeight()*t,c=e.GetHeight()/16,h=(4+this._lineHeight)*t;let _=e.IsText()?e.GetCharacterArray():null;if(-1!==this._drawMaxCharCount){if(this._drawCharCount>=this._drawMaxCharCount)return;e.IsText()&&this._drawCharCount+_.length>this._drawMaxCharCount&&(_=_.slice(0,this._drawMaxCharCount-this._drawCharCount),o=this._MeasureText(e).width*t),this._drawCharCount+=e.GetLength()}const u=e.GetStyleTag("background"),d=e.HasStyleTag("u"),p=e.HasStyleTag("s");if(e.IsText()&&h_.IsCharArrayAllWhitespace(_)&&!u&&!d&&!p||e.HasStyleTag("hide"))return;const f=e.GetStyleTag("color"),m=e.GetStyleTag("opacity");this._SetDrawCanvasOpacity(m?parseFloat(m.param)/100:1),u&&(this._SetDrawCanvasColor(u.param),n.fillRect(i,r-l,o,l+h));const g=e.GetStyleTag("linethickness"),I=g?parseFloat(g.param):1,S=e.HasStyleTag("stroke");if(S&&this._SetDrawCanvasLineWith(.5*c*I*this.GetDrawScale()),e.IsText()){const t=_.join("");if(this._SetDrawFontString(this._GetFontString(!1,e)),!S){this._SetDrawCanvasLineWith(.5*c*I*this.GetDrawScale());const s=e.GetStyleTag("outlineback");s&&(this._SetDrawCanvasColor(s.param),this._FillOrStrokeText(!0,t,i,r,o))}if(this._SetDrawCanvasColor(f?f.param:this._colorStr),this._FillOrStrokeText(S,t,i,r,o),!S){this._SetDrawCanvasLineWith(.5*c*I*this.GetDrawScale());const s=e.GetStyleTag("outline");s&&(this._SetDrawCanvasColor(s.param),this._FillOrStrokeText(!0,t,i,r,o))}}else if(e.IsIcon()&&e.GetWidth()>0){const t=e.GetDrawable(this._iconSet);t&&n.drawImage(t,i,r-l,o,l)}if(this._SetDrawCanvasColor(f?f.param:this._colorStr),d&&o_(n,S,i,r+t*a,o,t*a*I),p){const e=t*c,s=r-l/4+e/2;n.fillRect(i,s-e*I/2,o,e*I)}}_FillOrStrokeText(e,t,s,n,i){"rtl"===this._textDirection&&(s+=i),e?"Gecko"===h_.Platform.BrowserEngine?this._textContext.strokeText(t,s,n,i):this._textContext.strokeText(t,s,n):"Gecko"===h_.Platform.BrowserEngine?this._textContext.fillText(t,s,n,i):this._textContext.fillText(t,s,n)}_UpdateTexture(){this._renderer.IsContextLost()||(this._texture||(this._texture=this._renderer.CreateDynamicTexture(this._textCanvas.width,this._textCanvas.height,{mipMap:!0,mipMapQuality:"high"})),this._renderer.UpdateTexture(this._textCanvas,this._texture),this._rcTex.set(0,0,this._width/this._texture.GetWidth(),this._height/this._texture.GetHeight()),this.ontextureupdate&&this.ontextureupdate())}GetTexRect(){return this._rcTex}ReleaseTexture(){this._texture&&(this._renderer.IsContextLost()||this._renderer.DeleteTexture(this._texture),this._texture=null)}static OnContextLost(){for(const e of y_)e.ReleaseTexture()}static GetAll(){return y_.values()}}}{const v_=self.C3;class x_{constructor(e){this._gl=e.GetContext(),this._version=e.GetWebGLVersionNumber(),this._timerExt=e._GetDisjointTimerQueryExtension(),this._query=null,this._isActive=!1,this._hasResult=!1,this._result=0,1===this._version?this._query=this._timerExt.createQueryEXT():this._query=this._gl.createQuery()}Release(){this._DeleteQueryObject(),this._gl=null,this._timerExt=null,this._hasResult=!1}_DeleteQueryObject(){this._query&&(1===this._version?this._timerExt.deleteQueryEXT(this._query):this._gl.deleteQuery(this._query),this._query=null)}BeginTimeElapsed(){if(this._isActive)throw new Error("query already active");1===this._version?this._timerExt.beginQueryEXT(this._timerExt.TIME_ELAPSED_EXT,this._query):this._gl.beginQuery(this._timerExt.TIME_ELAPSED_EXT,this._query),this._isActive=!0}EndTimeElapsed(){if(!this._isActive)throw new Error("query not active");1===this._version?this._timerExt.endQueryEXT(this._timerExt.TIME_ELAPSED_EXT):this._gl.endQuery(this._timerExt.TIME_ELAPSED_EXT),this._isActive=!1}CheckForResult(){if(!this._query||this._hasResult||this._isActive)return;let e=!1;e=1===this._version?this._timerExt.getQueryObjectEXT(this._query,this._timerExt.QUERY_RESULT_AVAILABLE_EXT):this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT_AVAILABLE);const t=this._gl.getParameter(this._timerExt.GPU_DISJOINT_EXT);e&&!t&&(1===this._version?this._result=this._timerExt.getQueryObjectEXT(this._query,this._timerExt.QUERY_RESULT_EXT):this._result=this._gl.getQueryParameter(this._query,this._gl.QUERY_RESULT),this._result/=1e9,this._hasResult=!0),(e||t)&&this._DeleteQueryObject()}HasResult(){return this._hasResult}GetResult(){if(!this._hasResult)throw new Error("no result available");return this._result}}v_.Gfx.WebGLTimeElapsedQuery=class{constructor(e){this._renderer=e,this._frameNumber=e.GetFrameNumber(),this._isActive=!1,this._parentQuery=null,this._isNested=!1,this._realQuery=null,this._queries=[]}Release(){for(const e of this._queries)e instanceof x_&&e.Release();v_.clearArray(this._queries),this._parentQuery=null,this._realQuery=null,this._renderer=null}BeginTimeElapsed(){if(this._isActive)throw new Error("query already active");const e=this._renderer._GetTimeQueryStack();e.length>0?(this._isNested=!0,this._parentQuery=e.at(-1),this._parentQuery._EndReal(),this._parentQuery._queries.push(this)):(this._isNested=!1,this._parentQuery=null),this._isActive=!0,e.push(this),this._StartReal()}EndTimeElapsed(){if(!this._isActive)throw new Error("query not active");if(this._renderer._GetTimeQueryStack().pop()!==this)throw new Error("can only end most nested query");this._isActive=!1,this._EndReal(),this._parentQuery&&(this._parentQuery._StartReal(),this._parentQuery=null)}_StartReal(){this._realQuery=v_.New(x_,this._renderer),this._queries.push(this._realQuery),this._realQuery.BeginTimeElapsed()}_EndReal(){this._realQuery.EndTimeElapsed(),this._realQuery=null}CheckForResult(){for(const e of this._queries)e.CheckForResult()}IsNested(){return this._isNested}HasResult(){return this._queries.every((e=>e.HasResult()))}GetResult(){return this._queries.reduce(((e,t)=>e+t.GetResult()),0)}GetFrameNumber(){return this._frameNumber}}}{const T_=self.C3;T_.Gfx.WebGLQueryResultBuffer=class{constructor(e,t=1e3){this._renderer=e,this._maxQueries=t,this._buffer=[],this._renderer._AddQueryResultBuffer(this)}Release(){this.Clear(),this._renderer._RemoveQueryResultBuffer(this),this._renderer=null}Clear(){for(const e of this._buffer)e.Release();T_.clearArray(this._buffer)}AddTimeElapsedQuery(){const e=new T_.Gfx.WebGLTimeElapsedQuery(this._renderer);return this._buffer.push(e),this._buffer.length>this._maxQueries&&this._buffer.shift().Release(),e}CheckForResults(e){for(const t of this._buffer){if(t.GetFrameNumber()>=e)return;if(t.IsNested())return;t.CheckForResult()}}GetFrameRangeResultSum(e,t){if(t<=e)return NaN;let s=0;for(const n of this._buffer){if(n.GetFrameNumber()>=t)break;if(!(n.GetFrameNumber()<e)){if(!n.HasResult())return NaN;s+=n.GetResult()}}return s}DeleteAllBeforeFrameNumber(e){for(let t=0,s=this._buffer.length;t<s;++t){const s=this._buffer[t];if(!(s.GetFrameNumber()<e))return void(t>0&&this._buffer.splice(0,t));s.Release()}}}}{let C_=function(){Y_=-1;for(const e of X_)e.checkFunc()&&(e.resolve(),X_.delete(e));X_.size>0&&(Y_=self.requestAnimationFrame(C_))};CheckPendingPolls=C_;const w_=self.C3,P_=self.assert,A_=self.glMatrix,R_=A_.vec3,D_=A_.vec4,E_=A_.mat4,M_={powerPreference:"default",enableGpuProfiling:!0,alpha:!1,depth:!1,canSampleDepth:!1,maxWebGLVersion:2,failIfMajorPerformanceCaveat:!1},k_=new Set(["default","low-power","high-performance"]),L_=8e3,F_=12e3,B_=8e3,O_=7996,N_=262144,W_=new w_.Quad(0,0,1,0,1,1,0,1),V_=E_.create(),j_=E_.create(),U_=new w_.Quad,H_=new w_.Rect;let z_=null;w_.isDebug&&(self.debug_lose_webgl_context=function(){z_?z_.loseContext():console.warn("WEBGL_lose_context not supported")},self.debug_restore_webgl_context=function(){z_?z_.restoreContext():console.warn("WEBGL_lose_context not supported")});const X_=new Set;let Y_=-1;w_.Gfx.WebGLRenderer=class extends w_.Gfx.RendererBase{constructor(e,t){if(super(t),t=Object.assign({},M_,t),!k_.has(t.powerPreference))throw new Error("invalid power preference");const s={alpha:!!t.alpha,depth:!1,antialias:!1,powerPreference:t.powerPreference,failIfMajorPerformanceCaveat:!!t.failIfMajorPerformanceCaveat};let n=null,i=0;if(t.maxWebGLVersion>=2&&(n=e.getContext("webgl2",s),i=2),n||(n=e.getContext("webgl",s),i=1),!n)throw new Error("renderer-unavailable (could not get WebGL context)");this._gl=n,this._attribs=n.getContextAttributes(),this._versionString=n.getParameter(n.VERSION),this._version=i,this._viewport=D_.create(),this._didChangeTransform=!1,this._bbProjectionMatrix=E_.create(),this._usesDepthBuffer=!!t.depth,this._canSampleDepth=!(!t.depth||!t.canSampleDepth),this._isDepthEnabled=this._usesDepthBuffer,this._isDepthSamplingEnabled=!1,this._depthBuffer=null,this._isAutoSizeDepthBuffer=!0,this._depthBufferWidth=0,this._depthBufferHeight=0,this._vertexBuffer=null,this._texcoordBuffer=null,this._indexBuffer=null,this._pointBuffer=null,this._vertexData=new Float32Array(8e3*this.GetNumVertexComponents()),this._indexData=new Uint16Array(12e3),this._texcoordData=new Float32Array(16e3),this._pointData=new Float32Array(32e3),this._vertexPtr=0,this._texPtr=0,this._pointPtr=0,this._lastVertexPtr=0,this._lastProgram=null,this._spDeviceTransformTextureFill=null,this._batch=[],this._batchPtr=0,this._topOfBatch=0,this._currentRenderTarget=null,this._lastPointZ=0,this._batchState=w_.New(w_.Gfx.BatchState,this),this._lastColor=w_.New(w_.Color,1,1,1,1),this._lastTexture0=null,this._lastTexture1=null,this._lastSrcBlend=0,this._lastDestBlend=0,this._lastPointTexCoords=new w_.Rect,this._lastScissorRect=w_.New(w_.Rect,0,0,-1,-1),this._coplanarMode=0,this._maxTextureSize=-1,this._minPointSize=0,this._maxPointSize=0,this._unmaskedVendor="(unavailable)",this._unmaskedRenderer="(unavailable)",this._extensions=[],this._isInitialisingAfterContextRestored=!1,this._parallelShaderCompileExt=null,this._anisotropicExt=null,this._conservativeDepthExt=null,this._depthTextureExt=null,this._fragDepthExt=null,this._stdDerivativesExt=null,this._textureLodExt=null,this._maxAnisotropy=0,this._isGpuProfilingEnabled=!!t.enableGpuProfiling,this._timerExt=null,this._allQueryResultBuffers=new Set,this._timeQueryStack=[],this.FillIndexBufferData(this._indexData)}IsWebGL(){return!0}async InitState(){super.InitState();const e=this._gl,t=this.GetNumVertexComponents();this._lastColor.setRgba(1,1,1,1),this._lastTexture0=null,this._lastTexture1=null,this._vertexPtr=0,this._pointPtr=0,this._lastVertexPtr=8e3*t-4*t,w_.clearArray(this._batch),this._batchPtr=0,this._topOfBatch=0,this._lastProgram=null,this._currentRenderTarget=null,this._lastPointTexCoords.set(0,0,1,1),this._lastPointZ=0;const s=this._batchState;s.currentShader=null,s.currentFramebuffer=null,s.currentFramebufferNoDepth=null,D_.set(s.currentColor,1,1,1,1),s.clearColor.setRgba(0,0,0,0),s.pointTexCoords.set(0,0,1,1),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._lastSrcBlend=e.ONE,this._lastDestBlend=e.ONE_MINUS_SRC_ALPHA,this._InitBlendModes(e),e.disable(e.CULL_FACE),e.disable(e.STENCIL_TEST),e.disable(e.DITHER),this._usesDepthBuffer?(e.enable(e.DEPTH_TEST),e.depthMask(!0),e.depthFunc(e.LEQUAL)):(e.disable(e.DEPTH_TEST),e.depthMask(!1)),this._isDepthEnabled=this._usesDepthBuffer,this._isDepthSamplingEnabled=!1,this._pointBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._pointBuffer),e.bufferData(e.ARRAY_BUFFER,this._pointData.byteLength,e.DYNAMIC_DRAW),this._vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertexData.byteLength,e.DYNAMIC_DRAW),this._texcoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._texcoordBuffer),e.bufferData(e.ARRAY_BUFFER,this._texcoordData.byteLength,e.DYNAMIC_DRAW),this._indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indexData,e.STATIC_DRAW),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),this._maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE);const n=e.getParameter(e.ALIASED_POINT_SIZE_RANGE);this._minPointSize=n[0],this._maxPointSize=n[1],this._maxPointSize>2048&&(this._maxPointSize=2048),this._extensions=e.getSupportedExtensions();const i=e.getExtension("WEBGL_debug_renderer_info");if(i&&(this._unmaskedVendor=e.getParameter(i.UNMASKED_VENDOR_WEBGL),this._unmaskedRenderer=e.getParameter(i.UNMASKED_RENDERER_WEBGL)),this._parallelShaderCompileExt=e.getExtension("KHR_parallel_shader_compile"),this._version>=2&&("Chromium"!==w_.Platform.BrowserEngine||w_.Platform.BrowserVersionNumber>=135)&&(this._conservativeDepthExt=e.getExtension("EXT_conservative_depth")),w_.isDebug&&(z_=e.getExtension("WEBGL_lose_context")),this._isGpuProfilingEnabled&&(1===this.GetWebGLVersionNumber()?this._timerExt=e.getExtension("EXT_disjoint_timer_query"):this._timerExt=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query")),this._anisotropicExt=e.getExtension("EXT_texture_filter_anisotropic"),this._anisotropicExt?this._maxAnisotropy=e.getParameter(this._anisotropicExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT):this._maxAnisotropy=0,this.GetWebGLVersionNumber()<2&&this._usesDepthBuffer&&this._canSampleDepth&&(this._depthTextureExt=e.getExtension("WEBGL_depth_texture"),!this._depthTextureExt))throw new Error("no depth texture support");this.GetWebGLVersionNumber()<2&&(this._fragDepthExt=e.getExtension("EXT_frag_depth"),this._stdDerivativesExt=e.getExtension("OES_standard_derivatives"),this._textureLodExt=e.getExtension("EXT_shader_texture_lod"));const r=w_.Gfx.WebGLShaderProgram,a=r.GetDefaultVertexShaderSource(!1);let o=r.GetTextureFillFragmentShaderSource_WebGL1_NoFragDepth(),l=a,c=r.GetPointFragmentShaderSource_WebGL1_NoFragDepth(),h=r.GetPointVertexShaderSource_WebGL1(),_=r.GetTilemapFragmentShaderSource_WebGL1_NoFragDepth(),u=r.GetDefaultVertexShaderSource(!0),d=!1;this._usesDepthBuffer&&(this.GetWebGLVersionNumber()<2?this._fragDepthExt&&(o=r.GetTextureFillFragmentShaderSource_WebGL1_FragDepthEXT(),c=r.GetPointFragmentShaderSource_WebGL1_FragDepthEXT(),_=r.GetTilemapFragmentShaderSource_WebGL1_FragDepthEXT(),d=!0):(l=r.GetDefaultVertexShaderSource_WebGL2(),o=r.GetTextureFillFragmentShaderSource_WebGL2(this._SupportsConservativeDepth()),c=r.GetPointFragmentShaderSource_WebGL2(this._SupportsConservativeDepth()),h=r.GetPointVertexShaderSource_WebGL2(),_=r.GetTilemapFragmentShaderSource_WebGL2(this._SupportsConservativeDepth()),u=r.GetDefaultVertexShaderSource_WebGL2(!0)));const p=r.GetTileRandomizationFragmentShaderSource(this.GetWebGLVersionNumber(),d,this._stdDerivativesExt&&this._textureLodExt,this._SupportsConservativeDepth()),f=this.GetWebGLVersionNumber()>=2?r.GetDefaultVertexShaderSource_WebGL2():a,m=[[o,l,"<default>"],[o,l,"<default-device-transform>"],[c,h,"<point>"],[r.GetColorFillFragmentShaderSource(),a,"<fill>"],[r.GetLinearGradientFillFragmentShaderSource(),a,"<lineargradient>"],[r.GetPenumbraFillFragmentShaderSource(),a,"<penumbra>"],[r.GetHardEllipseFillFragmentShaderSource(),a,"<hardellipse>"],[r.GetHardEllipseOutlineFragmentShaderSource(),a,"<hardellipseoutline>"],[r.GetSmoothEllipseFillFragmentShaderSource(),a,"<smoothellipse>"],[r.GetSmoothEllipseOutlineFragmentShaderSource(),a,"<smoothellipseoutline>"],[r.GetSmoothLineFillFragmentShaderSource(),a,"<smoothline>"],[_,u,"<tilemap>"],[p,f,"<tilerandomization>"]],g=await Promise.all(m.map((e=>this.CreateShaderProgram({src:e[0],vertexSrc:e[1],name:e[2]}))));this._spTextureFill=g[0],this._spDeviceTransformTextureFill=g[1],this._spPoints=g[2],this._spColorFill=g[3],this._spLinearGradientFill=g[4],this._spPenumbraFill=g[5],this._spHardEllipseFill=g[6],this._spHardEllipseOutline=g[7],this._spSmoothEllipseFill=g[8],this._spSmoothEllipseOutline=g[9],this._spSmoothLineFill=g[10],this._spTilemapFill=g[11],this._spTileRandomization=g[12],this.SetTextureFillMode()}async CreateShaderProgram(e){const t=await w_.Gfx.WebGLShaderProgram.Create(this,e);return this._AddShaderProgram(t),t}ResetLastProgram(){this._lastProgram=null}SetSize(e,t,s){if(this._width===e&&this._height===t&&!s)return;this.EndBatch();const n=this._gl,i=this._batchState;this._width=e,this._height=t,this._SetViewport(0,0,e,t),this.CalculatePerspectiveMatrix(this._bbProjectionMatrix,e/t),this.SetProjectionMatrix(this._bbProjectionMatrix),this._spDeviceTransformTextureFill&&(n.useProgram(this._spDeviceTransformTextureFill.GetShaderProgram()),this._spDeviceTransformTextureFill._UpdateDeviceTransformUniforms(this._matP),this._lastProgram=this._spDeviceTransformTextureFill,this._batchState.currentShader=this._spDeviceTransformTextureFill),n.bindTexture(n.TEXTURE_2D,null),n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,null),n.activeTexture(n.TEXTURE0),this._lastTexture0=null,this._lastTexture1=null,this._usesDepthBuffer&&this._isAutoSizeDepthBuffer&&this._SetDepthBufferSize(this._width,this._height),this._currentRenderTarget&&this._currentRenderTarget._Resize(this._width,this._height),n.bindFramebuffer(n.FRAMEBUFFER,null),this._currentRenderTarget=null,i.currentFramebuffer=null,i.currentFramebufferNoDepth=null}_SetDepthBufferSize(e,t){const s=this._gl;this._depthBuffer&&this._depthBufferWidth===e&&this._depthBufferHeight===t||(this._canSampleDepth?(this._depthBuffer&&s.deleteTexture(this._depthBuffer),this._depthBuffer=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this._depthBuffer),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),this.GetWebGLVersionNumber()>=2?s.texImage2D(s.TEXTURE_2D,0,s.DEPTH24_STENCIL8,e,t,0,s.DEPTH_STENCIL,s.UNSIGNED_INT_24_8,null):this._depthTextureExt&&s.texImage2D(s.TEXTURE_2D,0,s.DEPTH_STENCIL,e,t,0,s.DEPTH_STENCIL,this._depthTextureExt.UNSIGNED_INT_24_8_WEBGL,null),s.bindTexture(s.TEXTURE_2D,null)):(this._depthBuffer&&s.deleteRenderbuffer(this._depthBuffer),this._depthBuffer=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,this._depthBuffer),s.renderbufferStorage(s.RENDERBUFFER,this._version>=2?s.DEPTH24_STENCIL8:s.DEPTH_STENCIL,e,t),s.bindRenderbuffer(s.RENDERBUFFER,null)),this._depthBufferWidth=e,this._depthBufferHeight=t)}SetFixedSizeDepthBuffer(e,t){this._usesDepthBuffer&&(this._isAutoSizeDepthBuffer=!1,this._SetDepthBufferSize(e,t))}SetAutoSizeDepthBuffer(){this._usesDepthBuffer&&(this._isAutoSizeDepthBuffer=!0,this._SetDepthBufferSize(this._width,this._height))}_SetViewport(e,t,s,n){const i=this._viewport;i[0]===e&&i[1]===t&&i[2]===s&&i[3]===n||(this.PushBatch().InitSetViewport(e,t,s,n),D_.set(i,e,t,s,n),this._topOfBatch=0)}SetFovY(e){super.SetFovY(e),this.CalculatePerspectiveMatrix(this._bbProjectionMatrix,this._width/this._height)}SetNearZ(e){super.SetNearZ(e),this.CalculatePerspectiveMatrix(this._bbProjectionMatrix,this._width/this._height)}SetFarZ(e){super.SetFarZ(e),this.CalculatePerspectiveMatrix(this._bbProjectionMatrix,this._width/this._height)}SetProjectionMatrix(e){E_.exactEquals(this._matP,e)||(this.PushBatch().InitSetProjection(e),E_.copy(this._matP,e),this._topOfBatch=0,this._didChangeTransform=!0)}SetDefaultRenderTargetProjectionState(){let e,t,s;const n=this._currentRenderTarget;null===n?(e=this._bbProjectionMatrix,t=this.GetWidth(),s=this.GetHeight()):(e=n.GetProjectionMatrix(),t=n.GetWidth(),s=n.GetHeight()),this.SetProjectionMatrix(e),this._SetViewport(0,0,t,s)}SetModelViewMatrix(e){E_.exactEquals(this._matMV,e)||(this.PushBatch().InitSetModelView(e),E_.copy(this._matMV,e),this._topOfBatch=0,this._didChangeTransform=!0)}ResetDidChangeTransformFlag(){this._didChangeTransform=!1}DidChangeTransform(){return this._didChangeTransform}GetBatchState(){return this._batchState}PushBatch(){const e=this._batch;return this._batchPtr===e.length&&e.push(new w_.Gfx.WebGLBatchJob(this._batchState)),e[this._batchPtr++]}EndBatch(){0!==this._batchPtr&&(this.IsContextLost()||(this._WriteBuffers(),this._ExecuteBatch(),this._batchPtr=0,this._vertexPtr=0,this._texPtr=0,this._pointPtr=0,this._topOfBatch=0))}_WriteBuffers(){const e=this._gl;this._pointPtr>0&&(e.bindBuffer(e.ARRAY_BUFFER,this._pointBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this._pointData.subarray(0,this._pointPtr))),this._vertexPtr>0&&(e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this._vertexData.subarray(0,this._vertexPtr)),e.bindBuffer(e.ARRAY_BUFFER,this._texcoordBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this._texcoordData.subarray(0,this._texPtr)))}_ExecuteBatch(){const e=this._batch;for(let t=0,s=this._batchPtr;t<s;++t)e[t].Run()}GetOpacity(){return this._lastColor.getA()}SetColorRgba(e,t,s,n){const i=this._lastColor;i.equalsRgba(e,t,s,n)||(i.setRgba(e,t,s,n),this.PushBatch().InitSetColor(i),this._topOfBatch=0,this._currentStateGroup=null)}SetOpacity(e){const t=this._lastColor;t.getA()!==e&&(t.setA(e),this.PushBatch().InitSetColor(t),this._topOfBatch=0,this._currentStateGroup=null)}SetColor(e){const t=this._lastColor;t.equals(e)||(t.set(e),this.PushBatch().InitSetColor(t),this._topOfBatch=0,this._currentStateGroup=null)}ResetColor(){this.SetColorRgba(1,1,1,1)}GetColor(){return this._lastColor}SetTexture(e){e!==this._lastTexture0&&(this.PushBatch().InitSetTexture(e),this._lastTexture0=e,this._topOfBatch=0)}_ResetLastTexture(){this._lastTexture0=null}SetBlendMode(e){const t=this._GetBlendByIndex(e);this._SetBlend(t[0],t[1])}SetNamedBlendMode(e){const t=this.GetNamedBlend(e);this._SetBlend(t.srcBlend,t.destBlend)}_SetBlend(e,t){e===this._lastSrcBlend&&t===this._lastDestBlend||(this.PushBatch().InitSetBlend(e,t),this._lastSrcBlend=e,this._lastDestBlend=t,this._topOfBatch=0,this._currentStateGroup=null)}IsPremultipliedAlphaBlend(){return this._lastSrcBlend===this._gl.ONE&&this._lastDestBlend===this._gl.ONE_MINUS_SRC_ALPHA}SetAlphaBlend(){this._SetBlend(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)}SetNoPremultiplyAlphaBlend(){this._SetBlend(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA)}SetCopyBlend(){this._SetBlend(this._gl.ONE,this._gl.ZERO)}Rect(e){this.Rect2(e.getLeft(),e.getTop(),e.getRight(),e.getBottom())}Rect2(e,t,s,n){this.Quad2(e,t,s,t,s,n,e,n)}_ExtendQuadBatch(){let e=this._vertexPtr;e>=this._lastVertexPtr&&(this.EndBatch(),e=0),1===this._topOfBatch?this._batch[this._batchPtr-1]._indexCount+=6:(this.PushBatch().InitQuad(e,6),this._topOfBatch=1)}_WriteQuadToVertexBuffer(e){e.writeToTypedArray3D(this._vertexData,this._vertexPtr,this._baseZ+this._currentZ),this._vertexPtr+=12}Quad(e){this._ExtendQuadBatch(),this._WriteQuadToVertexBuffer(e),W_.writeToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad2(e,t,s,n,i,r,a,o){this._ExtendQuadBatch();const l=this._vertexData;let c=this._vertexPtr;const h=this._baseZ+this._currentZ;l[c++]=e,l[c++]=t,l[c++]=h,l[c++]=s,l[c++]=n,l[c++]=h,l[c++]=i,l[c++]=r,l[c++]=h,l[c++]=a,l[c++]=o,l[c++]=h,this._vertexPtr=c,W_.writeToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad3(e,t){this._ExtendQuadBatch(),this._WriteQuadToVertexBuffer(e),t.writeAsQuadToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad4(e,t){this._ExtendQuadBatch(),this._WriteQuadToVertexBuffer(e),t.writeToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad3D(e,t,s,n,i,r,a,o,l,c,h,_,u){this._ExtendQuadBatch();const d=this._vertexData;let p=this._vertexPtr;const f=this._baseZ+this._currentZ;d[p++]=e,d[p++]=t,d[p++]=f+s,d[p++]=n,d[p++]=i,d[p++]=f+r,d[p++]=a,d[p++]=o,d[p++]=f+l,d[p++]=c,d[p++]=h,d[p++]=f+_,this._vertexPtr=p,u.writeAsQuadToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}Quad3D2(e,t,s,n,i,r,a,o,l,c,h,_,u){this._ExtendQuadBatch();const d=this._vertexData;let p=this._vertexPtr;const f=this._baseZ+this._currentZ;d[p++]=e,d[p++]=t,d[p++]=f+s,d[p++]=n,d[p++]=i,d[p++]=f+r,d[p++]=a,d[p++]=o,d[p++]=f+l,d[p++]=c,d[p++]=h,d[p++]=f+_,this._vertexPtr=p,u.writeToTypedArray(this._texcoordData,this._texPtr),this._texPtr+=8}DrawMesh(e,t,s){const n=this._vertexData,i=this._texcoordData;if(s.length%3!=0)throw new Error("invalid index buffer length");for(let r=0,a=s.length;r<a;){const a=s[r++],o=s[r++],l=s[r++],c=3*a,h=3*o,_=3*l,u=2*a,d=2*o,p=2*l;this._ExtendQuadBatch();let f=this._vertexPtr,m=this._texPtr;n[f++]=e[c+0],n[f++]=e[c+1],n[f++]=e[c+2],n[f++]=e[h+0],n[f++]=e[h+1],n[f++]=e[h+2],n[f++]=e[_+0],n[f++]=e[_+1],n[f++]=e[_+2],n[f++]=e[_+0],n[f++]=e[_+1],n[f++]=e[_+2],i[m++]=t[u+0],i[m++]=t[u+1],i[m++]=t[d+0],i[m++]=t[d+1],i[m++]=t[p+0],i[m++]=t[p+1],i[m++]=t[p+0],i[m++]=t[p+1],this._vertexPtr=f,this._texPtr=m}}FullscreenQuad(e,t){this.SetCurrentZ(0),E_.copy(V_,this._matP),E_.copy(j_,this._matMV),this.SetDefaultRenderTargetProjectionState();const[s,n]=this.GetRenderTargetSize(this._currentRenderTarget),i=this.CalculateLookAtModelView2(0,0,this.GetDefaultCameraZ(n),0,0,0,n);if(this.SetModelViewMatrix(i),"crop"===e&&this._currentRenderTarget&&t){const e=this._width/2,s=this._height/2,n=t.GetWidth(),i=t.GetHeight(),r=this._currentRenderTarget.GetWidth(),a=this._currentRenderTarget.GetHeight(),o=Math.min(r,n),l=Math.min(a,i),c=Math.max(i-a,0),h=Math.max(a-i,0);H_.set(-e,s-h,-e+o,s-l-h),U_.setFromRect(H_),H_.set(0,c,o,l+c),H_.divide(n,i),this.Quad3(U_,H_)}else{const e=s/2,t=n/2;this.Rect2(-e,t,e,-t)}this.SetProjectionMatrix(V_),this.SetModelViewMatrix(j_)}StartRenderingPoints(e){this._lastPointTexCoords.equals(e)||(this._lastPointTexCoords.copy(e),this.PushBatch().InitSetPointTexCoords(e),this._topOfBatch=0)}FinishRenderingPoints(){}Point(e,t,s,n){this._pointPtr>=7996&&this.EndBatch();let i=this._pointPtr;const r=this._baseZ+this._currentZ;2===this._topOfBatch&&this._lastPointZ===r?this._batch[this._batchPtr-1]._indexCount++:(this.PushBatch().InitPoints(i,r),this._topOfBatch=2,this._lastPointZ=r);const a=this._pointData;a[i++]=e,a[i++]=t,a[i++]=s,a[i++]=n,this._pointPtr=i}SetProgram(e){this._lastProgram!==e&&(this.PushBatch().InitSetProgram(e),this._lastProgram=e,this._topOfBatch=0,this._currentStateGroup=null)}GetProgram(){return this._lastProgram}SetDeviceTransformTextureFillMode(){this.SetProgram(this._spDeviceTransformTextureFill)}SetGradientColor(e){this.PushBatch().InitSetGradientColor(e),this._topOfBatch=0}SetEllipseParams(e,t,s=1){this.PushBatch().InitSetEllipseParams(e,t,s),this._topOfBatch=0}SetTilemapInfo(e,t,s,n,i,r,a){if(this._lastProgram!==this._spTilemapFill)throw new Error("must set tilemap fill mode first");this.PushBatch().InitSetTilemapInfo(e,t,s,n,i,r,a),this._topOfBatch=0}SetTileRandomizationInfo(e,t,s,n,i,r,a){if(this._lastProgram!==this._spTileRandomization)throw new Error("must set tile randomization mode first");this.PushBatch().InitSetTileRandomizationInfo(e,t,s,n,i,r,a),this._topOfBatch=0}SetProgramParameters(e,t,s,n,i,r,a,o,l,c,h){const _=this._lastProgram;if(h%=10800,!_._hasAnyOptionalUniforms||_.AreOptionalUniformsAlreadySetInBatch(t,s,n,i,r,a,o,l,c,h))return;const u=this.PushBatch();u.InitSetProgramParameters(),_.SetOptionalUniformsInBatch(t,s,n,i,r,a,o,l,c,h);const d=u._mat4param;d[0]=r,d[1]=a,t.writeToTypedArray(d,2),d[6]=l,d[7]=c,s.writeToTypedArray(d,12);const p=u._colorParam;i.writeToTypedArray(p,0);const f=p[1];p[1]=p[3],p[3]=f,n.writeToTypedArray(u._srcOriginRect,0),u._startIndex=h,u._indexCount=o,_._uSamplerBack.IsUsed()?u._texParam=e?e.GetTexture():null:u._texParam=null,this._topOfBatch=0}SetProgramCustomParameters(e){const t=this._lastProgram;if(0===e.length||t.AreCustomParametersAlreadySetInBatch(e))return;const s=this.PushBatch();s.InitSetProgramCustomParameters(),t.SetCustomParametersInBatch(e),w_.shallowAssignArray(s._shaderParams,e),this._topOfBatch=0}ClearRgba(e,t,s,n){this.PushBatch().InitClearSurface2(e,t,s,n),this._topOfBatch=0}Clear(e){this.PushBatch().InitClearSurface(e),this._topOfBatch=0}Start(){}Finish(){super.Finish(),this._gl.flush()}ClearDepth(){this._usesDepthBuffer&&this._currentRenderTarget&&this._currentRenderTarget.HasDepthBuffer()&&(this.PushBatch().InitClearDepth(this._isDepthEnabled),this._topOfBatch=0)}SetDepthEnabled(e){e=!!e,this._isDepthEnabled!==e&&this._usesDepthBuffer&&(this._isDepthEnabled=e,this.PushBatch().InitSetDepthEnabled(e),this._topOfBatch=0)}IsDepthEnabled(){return this._isDepthEnabled}_GetDepthBuffer(){return this._depthBuffer}_CanSampleDepth(){return this._canSampleDepth}SetDepthSamplingEnabled(e){if(e=!!e,this._canSampleDepth&&this._isDepthSamplingEnabled!==e){if(e&&this.IsDepthEnabled())throw new Error("depth still enabled");this._isDepthSamplingEnabled=e,this.PushBatch().InitSetDepthSamplingEnabled(e),this._topOfBatch=0}}SetScissorRect(e,t,s,n,i=0){e=Math.floor(e),t=Math.floor(t),s=Math.floor(s),n=Math.floor(n),this._lastScissorRect.equalsWH(e,t,s,n)||(this._lastScissorRect.setWH(e,t,s,n),t=(i||this.GetRenderTargetSize(this.GetRenderTarget())[1])-t-n,this.PushBatch().InitSetScissor(!0,e,t,s,n),this._topOfBatch=0)}RemoveScissorRect(){-1!==this._lastScissorRect.getRight()&&(this._lastScissorRect.set(0,0,-1,-1),this.PushBatch().InitSetScissor(!1,0,0,0,0),this._topOfBatch=0)}CheckForQueryResults(){for(const e of this._allQueryResultBuffers)e.CheckForResults(this._frameNumber)}IsContextLost(){return!this._gl||this._gl.isContextLost()||this._isInitialisingAfterContextRestored}OnContextLost(){super.OnDeviceOrContextLost(),w_.Gfx.WebGLRendererTexture.OnContextLost(),w_.Gfx.WebGLRenderTarget.OnContextLost(),w_.Gfx.RendererText.OnContextLost();for(const e of this._allQueryResultBuffers)e.Clear();this._extensions=[],this._timerExt=null,this._parallelShaderCompileExt=null,this._conservativeDepthExt=null,this._anisotropicExt=null,this._depthTextureExt=null,this._fragDepthExt=null,this._stdDerivativesExt=null,this._textureLodExt=null,this._maxAnisotropy=0,this._unmaskedVendor="(unavailable)",this._unmaskedRenderer="(unavailable)",this._lastProgram=null,this._spDeviceTransformTextureFill=null,this._depthBuffer=null;for(const e of this._stateGroups.values())e.OnContextLost()}async OnContextRestored(){this._isInitialisingAfterContextRestored=!0,await this.InitState(),this._isInitialisingAfterContextRestored=!1;for(const e of this._stateGroups.values())e.OnContextRestored(this);this.SetSize(this._width,this._height,!0)}CreateStaticTexture(e,t){if(this.IsContextLost())throw new Error("context lost");this.EndBatch();const s=w_.New(w_.Gfx.WebGLRendererTexture,this);return s._CreateStatic(e,t),s}async CreateStaticTextureAsync(e,t){if(this.IsContextLost())throw new Error("context lost");if(t=Object.assign({},t),w_.Supports.ImageBitmapOptions){let s=await createImageBitmap(e,{premultiplyAlpha:"premultiply"});const n=t.wrapX&&"clamp-to-edge"!==t.wrapX||t.wrapY&&"clamp-to-edge"!==t.wrapY,i=w_.isPOT(s.width)&&w_.isPOT(s.height);return this.SupportsNPOTTextures()||i||!n?t.premultiplyAlpha=!1:w_.Supports.ImageBitmapOptionsResize?(s=await createImageBitmap(e,{premultiplyAlpha:"premultiply",resizeWidth:w_.nextHighestPowerOfTwo(s.width),resizeHeight:w_.nextHighestPowerOfTwo(s.height)}),t.premultiplyAlpha=!1):s=await createImageBitmap(e,{premultiplyAlpha:"none"}),await w_.Asyncify((()=>this.CreateStaticTexture(s,t)))}if(e instanceof Blob){if("undefined"==typeof Image)throw new Error("texture upload variant not supported in worker");const t=await w_.BlobToImage(e);e=t}return await w_.Asyncify((()=>this.CreateStaticTexture(e,t)))}CreateDynamicTexture(e,t,s){this.EndBatch();const n=w_.New(w_.Gfx.WebGLRendererTexture,this);return n._CreateDynamic(e,t,s),n}UpdateTexture(e,t,s){this.EndBatch(),t._Update(e,s)}DeleteTexture(e){e&&(e.SubtractReference(),e.GetReferenceCount()>0||(this.EndBatch(),e===this._lastTexture0&&(this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._lastTexture0=null),e===this._lastTexture1&&(this._gl.activeTexture(this._gl.TEXTURE1),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.activeTexture(this._gl.TEXTURE0),this._lastTexture1=null),e._Delete()))}CreateRenderTarget(e){let t=this._width,s=this._height,n=!0;if(e&&("number"==typeof e.width&&(t=Math.floor(e.width),n=!1),"number"==typeof e.height&&(s=Math.floor(e.height),n=!1)),t<=0||s<=0)throw new Error("invalid size");this.EndBatch();const i=w_.New(w_.Gfx.WebGLRenderTarget,this);return i._Create(t,s,Object.assign({isDefaultSize:n},e)),this._currentRenderTarget=null,this._batchState.currentFramebuffer=null,this._batchState.currentFramebufferNoDepth=null,i}SetRenderTarget(e,t=!0){e!==this._currentRenderTarget&&(e&&e.IsDefaultSize()&&e._Resize(this._width,this._height),this.PushBatch().InitSetRenderTarget(e),this._currentRenderTarget=e,this._topOfBatch=0,t&&this.SetDefaultRenderTargetProjectionState())}GetRenderTarget(){return this._currentRenderTarget}GetRenderTargetSize(e){return e?[e.GetWidth(),e.GetHeight()]:[this._width,this._height]}CopyRenderTarget(e,t="stretch"){this._version<2||this._currentRenderTarget&&this._currentRenderTarget.GetMultisampling()>0?(this.SetCopyBlend(),this.ResetColor(),this.DrawRenderTarget(e,t)):(this.PushBatch().InitBlitFramebuffer(e,this._currentRenderTarget,t),this._topOfBatch=0)}DrawRenderTarget(e,t="stretch"){const s=e.GetTexture();if(!s)throw new Error("not a texture-backed render target");this.SetTexture(s),this.FullscreenQuad(t,s)}InvalidateRenderTarget(e){this._version<2||(this.PushBatch().InitInvalidateFramebuffer(e._GetFramebuffer()),this._topOfBatch=0)}DeleteRenderTarget(e){this.SetRenderTarget(null),this.EndBatch();const t=e.GetTexture();t===this._lastTexture0&&(this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._lastTexture0=null),t===this._lastTexture1&&(this._gl.activeTexture(this._gl.TEXTURE1),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.activeTexture(this._gl.TEXTURE0),this._lastTexture1=null),e._Delete()}async ReadBackRenderTargetToImageData(e,t,s){this.EndBatch();const n=this._currentRenderTarget;let i,r,a;e?(i=e.GetWidth(),r=e.GetHeight(),a=e._GetFramebuffer()):(i=this.GetWidth(),r=this.GetHeight(),a=null);let o=0,l=0,c=i,h=r;if(s){o=w_.clamp(Math.floor(s.getLeft()),0,i-1),l=w_.clamp(Math.floor(s.getTop()),0,r-1);let e=s.width();e=0===e?i-o:w_.clamp(Math.floor(e),0,i-o);let t=s.height();t=0===t?r-l:w_.clamp(Math.floor(t),0,r-l),c=e,h=t,l=r-(l+h)}const _=this._gl;_.bindFramebuffer(_.FRAMEBUFFER,a);const u=()=>{_.bindFramebuffer(_.FRAMEBUFFER,null),this._currentRenderTarget=null,this._batchState.currentFramebuffer=null,this._batchState.currentFramebufferNoDepth=null,this.SetRenderTarget(n)};let d;if(!t&&this.GetWebGLVersionNumber()>=2){_.bindFramebuffer(_.READ_FRAMEBUFFER,a);const e=_.createBuffer(),t=c*h*4,s=_.PIXEL_PACK_BUFFER;_.bindBuffer(s,e),_.bufferData(s,t,_.STREAM_READ),_.readPixels(o,l,c,h,_.RGBA,_.UNSIGNED_BYTE,0),_.bindFramebuffer(_.READ_FRAMEBUFFER,null),_.bindBuffer(s,null),u();const n=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);await this._WaitForObjectReady((()=>_.getSyncParameter(n,_.SYNC_STATUS)===_.SIGNALED)),_.deleteSync(n),d=new ImageData(c,h),_.bindBuffer(s,e),_.getBufferSubData(s,0,new Uint8Array(d.data.buffer),0,t),_.bindBuffer(s,null),_.deleteBuffer(e)}else d=new ImageData(c,h),_.readPixels(o,l,c,h,_.RGBA,_.UNSIGNED_BYTE,new Uint8Array(d.data.buffer)),u();return d}CoplanarStartStencilPass(){this.SetDepthEnabled(!0),this.PushBatch().InitCoplanarStartStencilPass(),this._topOfBatch=0,this._coplanarMode=1}CoplanarStartColorPass(){this.SetDepthEnabled(!1),this.PushBatch().InitCoplanarStartColorPass(),this._topOfBatch=0,this._coplanarMode=2}IsCoplanarColorPass(){return 2===this._coplanarMode}CoplanarRestoreStandardRendering(){this.SetDepthEnabled(!0),this.PushBatch().InitCoplanarRestore(),this._topOfBatch=0,this._coplanarMode=0}StartQuery(e){this.SupportsGPUProfiling()&&(this.PushBatch().InitStartQuery(e),this._topOfBatch=0)}EndQuery(e){this.SupportsGPUProfiling()&&(this.PushBatch().InitEndQuery(e),this._topOfBatch=0)}_WaitForObjectReady(e){const t=new Promise((t=>X_.add({resolve:t,checkFunc:e})));return-1===Y_&&(Y_=self.requestAnimationFrame(C_)),t}GetEstimatedBackBufferMemoryUsage(){return this._width*this._height*(this._attribs.alpha?4:3)}GetEstimatedRenderBufferMemoryUsage(){let e=0;for(const t of w_.Gfx.WebGLRenderTarget.allRenderTargets())t.GetTexture()||(e+=t.GetEstimatedMemoryUsage());return e}GetEstimatedTextureMemoryUsage(){let e=0;for(const t of w_.Gfx.WebGLRendererTexture.allTextures())e+=t.GetEstimatedMemoryUsage();return e}GetWebGLVersionString(){return this._versionString}GetWebGLVersionNumber(){return this._version}GetDisplayName(){return"webgl"+this.GetWebGLVersionNumber()}SupportsNPOTTextures(){return this.GetWebGLVersionNumber()>=2}GetMaxTextureSize(){return this._maxTextureSize}GetMinPointSize(){return this._minPointSize}GetMaxPointSize(){return this._maxPointSize}GetUnmaskedVendor(){return this._unmaskedVendor}GetUnmaskedRenderer(){return this._unmaskedRenderer}GetWebGLExtensionsAnalyticsString(){if(this.GetWebGLVersionNumber()>=2)return"webgl2";{const e=[];return this._fragDepthExt&&e.push("EXT_frag_depth"),this._stdDerivativesExt&&e.push("OES_standard_derivatives"),this._textureLodExt&&e.push("EXT_shader_texture_lod"),e.length>0?"webgl1:"+e.join(","):"webgl1:none"}}GetExtensions(){return this._extensions}SupportsGPUProfiling(){return!!this._timerExt}_GetDisjointTimerQueryExtension(){return this._timerExt}_GetParallelShaderCompileExtension(){return this._parallelShaderCompileExt}_SupportsConservativeDepth(){return!!this._conservativeDepthExt}_GetAnisotropicExtension(){return this._anisotropicExt}_GetMaxAnisotropy(){return this._maxAnisotropy}_AddQueryResultBuffer(e){this._allQueryResultBuffers.add(e)}_RemoveQueryResultBuffer(e){this._allQueryResultBuffers.delete(e)}_GetTimeQueryStack(){return this._timeQueryStack}GetContext(){return this._gl}_InitBlendModes(e){this._InitBlendModeData([["normal",e.ONE,e.ONE_MINUS_SRC_ALPHA],["additive",e.ONE,e.ONE],["xor",e.ONE,e.ONE_MINUS_SRC_ALPHA],["copy",e.ONE,e.ZERO],["destination-over",e.ONE_MINUS_DST_ALPHA,e.ONE],["source-in",e.DST_ALPHA,e.ZERO],["destination-in",e.ZERO,e.SRC_ALPHA],["source-out",e.ONE_MINUS_DST_ALPHA,e.ZERO],["destination-out",e.ZERO,e.ONE_MINUS_SRC_ALPHA],["source-atop",e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],["destination-atop",e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA]])}CreateWebGLText(){return this.CreateRendererText()}}}{const q_=self.C3,J_={getDrawSize:null,getRenderTarget:null,releaseRenderTarget:null,getTime:null,redraw:null};q_.Gfx.EffectChainManager=class{constructor(e){e=Object.assign({},J_,e),this._cbGetDrawSize=e.getDrawSize,this._cbGetRenderTarget=e.getRenderTarget,this._cbReleaseRenderTarget=e.releaseRenderTarget,this._cbGetTime=e.getTime,this._cbRedraw=e.redraw,this._webgpuBackTexture=null,this._allEffectChains=new Set}_AddEffectChain(e){this._allEffectChains.add(e)}_RemoveEffectChain(e){this._allEffectChains.delete(e)}OnContextLost(){this._webgpuBackTexture=null;for(const e of this._allEffectChains)e.OnContextLost()}GetDrawSize(e){return this._cbGetDrawSize?this._cbGetDrawSize(e):[e.GetWidth(),e.GetHeight()]}GetRenderTarget(e){return this._cbGetRenderTarget(e)}ReleaseRenderTarget(e,t){this._cbReleaseRenderTarget(e,t)}GetTime(){return this._cbGetTime()}Redraw(e){this._cbRedraw(e)}_GetWebGPUBackTexture(e,t,s){return t=Math.floor(t),s=Math.floor(s),!this._webgpuBackTexture||this._webgpuBackTexture.GetWidth()===t&&this._webgpuBackTexture.GetHeight()===s||(e.DeleteTexture(this._webgpuBackTexture),this._webgpuBackTexture=null),null===this._webgpuBackTexture&&(this._webgpuBackTexture=e.CreateStaticTexture(null,{width:t,height:s,sampling:"nearest",mipMap:!1})),this._webgpuBackTexture}}}{const K_=self.C3,$_=self.assert,Z_=self.glMatrix,Q_=Z_.mat4,eu=K_.New(K_.Rect),tu=K_.New(K_.Rect),su=K_.New(K_.Rect),nu=K_.New(K_.Rect),iu=Q_.create(),ru=Q_.create(),au={drawContent:null,getSourceTextureInfo:null,getShaderParameters:null,invalidateRenderTargets:!1},ou={indexMap:null,forcePreDraw:!1,forcePostDraw:!1,is3D:!1,isSourceTextureRotated:!1,isRotatedOrNegativeSizeInstance:!1,useFullSurface:!1};K_.Gfx.EffectChain=class{constructor(e,t){t=Object.assign({},au,t),this._manager=e,this._cbDrawContent=t.drawContent,this._cbGetSourceTextureInfo=t.getSourceTextureInfo,this._cbGetShaderParameters=t.getShaderParameters,this._cbDrawContentHook=null,this._shaderProgramList=[],this._shaderProgramIndices=[],this._steps=[],this._needsRebuild=!1,this._blendMode=0,this._isAnyShaderAnimated=!1,this._isAnyShaderDepthSampling=!1,this._isAnyShaderBackgroundBlending=!1,this._isAnyShaderCrossSampling=!1,this._isAnyIsSrcTexRotated=!1,this._useCopyTextureBackgroundSampling=!1,this._didChangeTransform=!1,this._depthEnabledAtStart=!1,this._coplanarColorPassAtStart=!1,this._canUseFastPath=!1,this._useFullSurface=!1,this._isSourceTextureRotated=!1,this._numTempSurfacesRequired=0,this._renderTargets=[null,null,null],this._invalidateRenderTargets=!!t.invalidateRenderTargets,this._boxExtendHorizontal=0,this._boxExtendVertical=0,this._drawWidth=0,this._drawHeight=0,this._contentObject=null,this._contextObject=null,this._layoutRect=K_.New(K_.Rect),this._drawSurfaceRect=K_.New(K_.Rect),this._rcTexOriginal=K_.New(K_.Rect),this._rcTexBounce=K_.New(K_.Rect),this._rcTexDest=K_.New(K_.Rect),this._devicePixelRatio=1,this._layerScale=1,this._layerAngle=0,this._time=0,this._destRenderTarget=null,this._backTex=null,this._compositOffX=0,this._compositOffY=0,this._compositRtWidth=0,this._compositRtHeight=0,this._updateOwnProjection=!1,this._projectionMatrix=Q_.create(),this._modelViewMatrix=Q_.create(),this._manager._AddEffectChain(this)}Release(){this._manager._RemoveEffectChain(this),K_.clearArray(this._steps),K_.clearArray(this._shaderProgramList),K_.clearArray(this._shaderProgramIndices),this._contentObject=null,this._contextObject=null,this._cbDrawContent=null,this._cbGetSourceTextureInfo=null,this._cbGetShaderParameters=null}OnContextLost(){this._needsRebuild=!0,K_.clearArray(this._steps),K_.clearArray(this._shaderProgramList),K_.clearArray(this._shaderProgramIndices)}NeedsRebuild(){return this._needsRebuild}BuildSteps(e,t){if(t=Object.assign({},ou,t),K_.clearArray(this._steps),this._boxExtendHorizontal=0,this._boxExtendVertical=0,this._isAnyShaderAnimated=!1,this._isAnyShaderDepthSampling=!1,this._isAnyShaderBackgroundBlending=!1,this._isAnyShaderCrossSampling=!1,this._isAnyIsSrcTexRotated=!1,this._useCopyTextureBackgroundSampling=!1,this._numTempSurfacesRequired=0,this._isSourceTextureRotated=!!t.isSourceTextureRotated,this._useFullSurface=!!t.useFullSurface,this._needsRebuild=!1,K_.shallowAssignArray(this._shaderProgramList,e),0===e.length)return;if(t.indexMap){if(t.indexMap.length!==e.length)throw new Error("incorrect indexMap length");K_.shallowAssignArray(this._shaderProgramIndices,t.indexMap)}else{K_.clearArray(this._shaderProgramIndices);for(let t=0,s=e.length;t<s;++t)this._shaderProgramIndices.push(t)}for(const t of e)this._boxExtendHorizontal+=t.GetBoxExtendHorizontal(),this._boxExtendVertical+=t.GetBoxExtendVertical(),t.IsAnimated()&&(this._isAnyShaderAnimated=!0),t.UsesDepth()&&(this._isAnyShaderDepthSampling=!0),t.BlendsBackground()&&(this._isAnyShaderBackgroundBlending=!0),t.UsesCrossSampling()&&(this._isAnyShaderCrossSampling=!0),t.UsesIsSrcTexRotated()&&(this._isAnyIsSrcTexRotated=!0);this._useCopyTextureBackgroundSampling=this._ShouldUseCopyTextureBackgroundSampling(e[0].GetRenderer());const s=this._ShouldPreDraw(e[0],t),n=this._ShouldPostDraw(e.at(-1),t);if(1===e.length&&!s&&!n)return void(this._canUseFastPath=!0);this._canUseFastPath=!1;let i=0;s&&(this._numTempSurfacesRequired=1,this._steps.push(K_.New(K_.Gfx.EffectChain.Step.PreDraw,this,-1,1)),i=1);for(let t=0,r=e.length;t<r;++t)if(0!==t||s){let e=1===i?2:1;t!==r-1||n||(e=0),this._numTempSurfacesRequired=Math.max(this._numTempSurfacesRequired,e),this._steps.push(K_.New(K_.Gfx.EffectChain.Step.Bounce,this,i,e,t)),i=e}else this._numTempSurfacesRequired=1,this._steps.push(K_.New(K_.Gfx.EffectChain.Step.FirstBounce,this,-1,1,t)),i=1;n&&this._steps.push(K_.New(K_.Gfx.EffectChain.Step.PostDraw,this,i,0))}_ShouldPreDraw(e,t){return!!(t.forcePreDraw||e.MustPreDraw()||t.is3D&&!e.Supports3DDirectRendering()||e.UsesDepth()&&!this._useFullSurface||0!==this._boxExtendHorizontal||0!==this._boxExtendVertical)||(e.GetRenderer().IsWebGL()?e.BlendsBackground()&&(t.isRotatedOrNegativeSizeInstance||t.isSourceTextureRotated)||e.UsesAnySrcRectOrPixelSize()&&t.isSourceTextureRotated:e.BlendsBackground()&&!this._useCopyTextureBackgroundSampling&&t.isRotatedOrNegativeSizeInstance)}_ShouldPostDraw(e,t){return!!t.forcePostDraw||(e.GetRenderer().IsWebGL()?e.BlendsBackground()||e.UsesCrossSampling():(e.BlendsBackground()||e.UsesCrossSampling())&&this._UseRenderTargetBackgroundSampling())}_ShouldUseCopyTextureBackgroundSampling(e){return e.IsWebGPU()&&this._isAnyShaderBackgroundBlending&&!this._isAnyShaderCrossSampling}Render(e,t,s){e.IsWebGPU()&&null===t&&(t=e.GetBackbufferRenderTarget()),this._destRenderTarget=t,this._contentObject=s.contentObject||null,this._contextObject=s.contextObject||null,this._blendMode=s.blendMode||0,this._devicePixelRatio=s.devicePixelRatio||1,this._layerScale=s.layerScale||1,this._layerAngle=s.layerAngle||0,this._time="number"==typeof s.time?s.time:this._manager.GetTime(),this._didChangeTransform=!1,e.ResetDidChangeTransformFlag(),this._isAnyShaderAnimated&&this._Redraw();let n=!1;if(this._UseCopyTextureBackgroundSampling()&&(this._CalculateDrawSizeAndRectangles(e,s),n=!0,this._backTex=this._manager._GetWebGPUBackTexture(e,this._drawWidth,this._drawHeight),eu.copy(this._drawSurfaceRect),eu.roundOuter(),e.IsWebGPU()&&e._MaybeDoPendingClearRenderPass(this._destRenderTarget),e.CopyTextureToTexture(this._destRenderTarget.GetTexture(),this._backTex,eu.getLeft(),eu.getTop(),eu.width(),eu.height())),this._canUseFastPath)this._Render_FastPath(e,s);else if(n||this._CalculateDrawSizeAndRectangles(e,s),0!==this._rcTexOriginal.width()||0!==this._rcTexOriginal.height()){e.SetAlphaBlend(),e.ResetColor(),e.SetBaseZ(0),e.SetCurrentZ(0),this._cbDrawContentHook=s.drawContentHook||null,this._compositOffX=s.compositOffX||0,this._compositOffY=s.compositOffY||0,this._compositRtWidth=s.compositRtWidth||0,this._compositRtHeight=s.compositRtHeight||0,this._updateOwnProjection=!!s.updateOwnProjection,this._OnBeforeStartEffectChain(e),this._renderTargets[0]=t,this._renderTargets[1]=this._numTempSurfacesRequired>=1?this._GetRenderTarget():null,this._renderTargets[2]=2===this._numTempSurfacesRequired?this._GetRenderTarget():null;for(const t of this._steps){const s=this._GetRenderTargetForId(t.GetSrcTargetId()),n=this._GetRenderTargetForId(t.GetDestTargetId());e.IsWebGPU()?t.Run_WebGPU(e,s,n):t.Run_WebGL(e,s,n)}e.SetTexture(null),this._renderTargets[1]&&this._ReleaseRenderTarget(this._renderTargets[1]),this._renderTargets[2]&&this._ReleaseRenderTarget(this._renderTargets[2]),this._renderTargets.fill(null),this._OnAfterEndEffectChain(e),this._destRenderTarget=null,this._backTex=null,this._contentObject=null,this._contextObject=null,this._cbDrawContentHook=null}}_CalculateDrawSizeAndRectangles(e,t){const[s,n]=this._manager.GetDrawSize(e);this._SetDrawSize(e,s,n),this._CalculateRectangles(t)}_SetDrawSize(e,t,s){if(t<=0||s<=0)throw new Error("invalid draw size");this._drawWidth===t&&this._drawHeight===s||this._CalculateDeviceTransformMatrices(e,t,s,0,0,this._projectionMatrix,this._modelViewMatrix),this._drawWidth=t,this._drawHeight=s}_CalculateDeviceTransformMatrices(e,t,s,n,i,r,a){const o=t/2+n,l=s/2+i;e.CalculatePerspectiveMatrix(r,t/s);const c=e.CalculateLookAtModelView2(o,l,e.GetDefaultCameraZ(s),o,l,0,s);Q_.copy(a,c)}_CalculateRectangles(e){this._layoutRect.copy(e.layoutRect),e.drawSurfaceRect?this._drawSurfaceRect.copy(e.drawSurfaceRect):this._drawSurfaceRect.set(0,0,this._drawWidth,this._drawHeight),this._rcTexOriginal.copy(this._drawSurfaceRect),this._rcTexOriginal.divide(this._drawWidth,this._drawHeight);const t=this._layerScale*this._devicePixelRatio;this._drawSurfaceRect.inflate(this._boxExtendHorizontal*t,this._boxExtendVertical*t),this._rcTexDest.copy(this._drawSurfaceRect),this._rcTexDest.divide(this._drawWidth,this._drawHeight),this._drawSurfaceRect.clampBoth(0,0,this._drawWidth,this._drawHeight),this._rcTexBounce.copy(this._drawSurfaceRect),this._rcTexBounce.divide(this._drawWidth,this._drawHeight)}_OnBeforeStartEffectChain(e){if(this._depthEnabledAtStart=e.IsDepthEnabled(),this._coplanarColorPassAtStart=e.IsCoplanarColorPass(),this._useFullSurface)e.SetDepthEnabled(!1),this._isAnyShaderDepthSampling&&e.SetDepthSamplingEnabled(!0);else{if(eu.copy(this._drawSurfaceRect),e.IsWebGL()){const e=this._layerScale*this._devicePixelRatio;eu.inflate(Math.max(this._boxExtendHorizontal,1)*e,Math.max(this._boxExtendVertical,1)*e),eu.roundOuter(),eu.clamp(0,0,this._drawWidth,this._drawHeight)}else eu.roundOuter();e.SetScissorRect(eu.getLeft(),eu.getTop(),eu.width(),eu.height(),this._drawHeight)}}_OnAfterEffectChainDrawContent(e){e.ResetColor(),this._useFullSurface||(this._coplanarColorPassAtStart&&e.CoplanarRestoreStandardRendering(),e.SetDepthEnabled(!1),this._isAnyShaderDepthSampling&&e.SetDepthSamplingEnabled(!0)),e.IsWebGPU()&&e.SetNormalizedCoordsProgramVariant(!0)}_OnAfterEndEffectChain(e){e.SetDepthSamplingEnabled(!1),this._coplanarColorPassAtStart&&e.CoplanarStartColorPass(),e.SetDepthEnabled(this._depthEnabledAtStart),this._useFullSurface||e.RemoveScissorRect(),e.IsWebGPU()&&e.SetNormalizedCoordsProgramVariant(!1),this._didChangeTransform=e.DidChangeTransform()}_ClampRcTexDest(){this._rcTexDest.clamp(0,0,1,1)}_GetRenderTargetForId(e){return e<0?null:this._renderTargets[e]}_GetRenderTarget(){return this._manager.GetRenderTarget(this)}_GetDestRenderTarget(){return this._destRenderTarget}_ReleaseRenderTarget(e){this._manager.ReleaseRenderTarget(e,this)}_GetShaderProgramAt(e){return this._shaderProgramList[e]}_DrawContent(e){this._cbDrawContentHook?this._cbDrawContentHook(this,e,(()=>this._cbDrawContent(e,this))):this._cbDrawContent(e,this),this._canUseFastPath||this._OnAfterEffectChainDrawContent(e)}_IsRenderTargetSameSizeAndOffset(e){if(this._useFullSurface)return!0;if(0!==this._compositOffX||0!==this._compositOffY||0!==this._compositRtWidth||0!==this._compositRtHeight)return!1;const[t,s]=e.GetRenderTargetSize(e.GetRenderTarget());return t===this._drawWidth&&s===this._drawHeight}_SetDeviceTransform(e,t){let s=this._projectionMatrix,n=this._modelViewMatrix;if(t&&!this._IsRenderTargetSameSizeAndOffset(e)){let t,i;s=iu,n=ru,0!==this._compositRtWidth&&0!==this._compositRtHeight?[t,i]=[this._compositRtWidth,this._compositRtHeight]:[t,i]=e.GetRenderTargetSize(e.GetRenderTarget()),this._CalculateDeviceTransformMatrices(e,t,i,this._compositOffX,this._compositOffY,s,n),this._useFullSurface||e.RemoveScissorRect()}e.SetProjectionMatrix(s),e.SetModelViewMatrix(n)}_Redraw(){this._manager.Redraw(this)}_GetShaderParameters(e,t){return this._cbGetShaderParameters(this._shaderProgramIndices[e],t)}_SetProgramParameters(e,t){let s=this._rcTexDest,n=this._rcTexBounce,i=this._rcTexOriginal;e.IsWebGL()&&(tu.copy(s),tu.flipAround(1),s=tu,su.copy(n),su.flipAround(1),n=su,nu.copy(i),nu.flipAround(1),i=nu),this._DoSetProgramParameters(e,t,n,i,s,1/this._drawWidth,1/this._drawHeight)}_SetFirstBounceProgramParameters(e,t){let s=this._rcTexBounce,n=this._rcTexOriginal,i=1/this._drawWidth,r=1/this._drawHeight;if(this._cbGetSourceTextureInfo){let{srcTexRect:e,srcWidth:t,srcHeight:a}=this._cbGetSourceTextureInfo(this._contentObject);e||(eu.set(0,0,0,0),e=eu),t||(t=this._drawWidth),a||(a=this._drawHeight),s=e,n=e,i=1/t,r=1/a}else e.IsWebGL()&&(su.copy(s),su.flipAround(1),s=su,nu.copy(n),nu.flipAround(1),n=nu);let a=this._rcTexDest;e.IsWebGL()&&(a=tu,a.copy(this._rcTexDest),a.flipAround(1)),this._DoSetProgramParameters(e,t,s,n,a,i,r),e.IsWebGPU()&&this._isAnyIsSrcTexRotated&&e.SetProgramParameter_IsSrcTexRotated(this._isSourceTextureRotated)}_GetBackTex(e){return this._isAnyShaderBackgroundBlending?e.IsWebGPU()?this._UseCopyTextureBackgroundSampling()?this._backTex:this._destRenderTarget.GetTexture():this._destRenderTarget:null}_DoSetProgramParameters(e,t,s,n,i,r,a){e.SetProgramParameters(this._GetBackTex(e),i,s,n,this._layoutRect,r,a,this._devicePixelRatio,this._layerScale,this._layerAngle,this._time),e.SetProgramCustomParameters(this._GetShaderParameters(t,e))}_Render_FastPath(e,t){const s=this._shaderProgramList[0],n=e.IsDepthEnabled(),i=s.UsesDepth();i&&(e.SetDepthEnabled(!1),e.SetDepthSamplingEnabled(!0),this._rcTexDest.set(0,0,1,1),this._rcTexOriginal.set(0,0,1,1)),e.SetProgram(s),e.SetBlendMode(this._blendMode),e.SetRenderTarget(this._destRenderTarget);let r=0,a=1;if(this._rcTexOriginal.set(0,0,1,1),s.UsesAnySrcRectOrPixelSize()&&this._cbGetSourceTextureInfo){const{srcTexRect:e,srcWidth:t,srcHeight:s}=this._cbGetSourceTextureInfo(this._contentObject);e&&this._rcTexOriginal.copy(e),r=Number.isFinite(t)?1/t:0,a=Number.isFinite(s)?1/s:0}else{const[t,s]=this._manager.GetDrawSize(e);r=1/t,a=1/s}t.layoutRect?this._layoutRect.copy(t.layoutRect):this._layoutRect.set(0,0,0,0),e.SetProgramParameters(this._GetBackTex(e),this._rcTexDest,this._rcTexOriginal,this._rcTexOriginal,this._layoutRect,r,a,this._devicePixelRatio,this._layerScale,this._layerAngle,this._time),e.SetProgramCustomParameters(this._GetShaderParameters(0,e)),e.IsWebGPU()&&this._isAnyIsSrcTexRotated&&e.SetProgramParameter_IsSrcTexRotated(this._isSourceTextureRotated),e.SetBaseZ(0),this._DrawContent(e),i&&(e.SetDepthSamplingEnabled(!1),e.SetDepthEnabled(n))}_UseCopyTextureBackgroundSampling(){return this._useCopyTextureBackgroundSampling}_UseRenderTargetBackgroundSampling(){return!this._useCopyTextureBackgroundSampling}IsAnyShaderBackgroundBlending(){return this._isAnyShaderBackgroundBlending}CanSkipCalculatingDrawSurfaceRect(){return!!this._canUseFastPath&&!this._UseCopyTextureBackgroundSampling()}UseFullSurface(){return this._useFullSurface}GetContentObject(){return this._contentObject}GetContextObject(){return this._contextObject}_GetBlendMode(){return this._blendMode}_UpdateOwnProjection(){return this._updateOwnProjection}DidChangeTransform(){return this._didChangeTransform}_GetDrawSurfaceRect(){return this._drawSurfaceRect}_GetRcTexBounce(){return this._rcTexBounce}_ShouldInvalidateRenderTargets(){return this._invalidateRenderTargets}async DebugLogRenderTargetContents(e,t,s){}}}{const lu=self.C3;lu.Gfx.EffectChain.Step=class{constructor(e,t,s,n=-1){this._effectChain=e,this._srcTargetId=t,this._destTargetId=s,this._index=n}GetEffectChain(){return this._effectChain}GetSrcTargetId(){return this._srcTargetId}GetDestTargetId(){return this._destTargetId}GetIndex(){return this._index}GetShaderProgram(){return this.GetEffectChain()._GetShaderProgramAt(this.GetIndex())}Run_WebGL(e,t,s){}Run_WebGPU(e,t,s){}}}{const cu=self.C3;cu.Gfx.EffectChain.Step.PreDraw=class extends cu.Gfx.EffectChain.Step{constructor(e,t,s,n){super(e,t,s,n)}Run_WebGL(e,t,s){const n=this.GetEffectChain();e.SetAlphaBlend(),e.SetTextureFillMode(),e.SetRenderTarget(s,n._UpdateOwnProjection()),e.ClearRgba(0,0,0,0),n._DrawContent(e),n._ClampRcTexDest()}Run_WebGPU(e,t,s){const n=this.GetEffectChain();e.SetAlphaBlend(),e.SetTextureFillMode(),e.SetRenderTarget(s,!1),e.ClearRgba(0,0,0,0),n._DrawContent(e),n._ClampRcTexDest()}}}{const hu=self.C3,_u=hu.New(hu.Rect),uu=hu.New(hu.Quad);hu.Gfx.EffectChain.Step.PostDraw=class extends hu.Gfx.EffectChain.Step{constructor(e,t,s,n){super(e,t,s,n)}Run_WebGL(e,t,s){const n=this.GetEffectChain();e.SetTextureFillMode(),e.SetRenderTarget(s),n._SetDeviceTransform(e,!0),e.SetBlendMode(n._GetBlendMode()),e.SetTexture(t.GetTexture()),uu.setFromRect(n._GetDrawSurfaceRect()),_u.copy(n._GetRcTexBounce()),_u.flipAround(1),e.Quad3(uu,_u),n._ShouldInvalidateRenderTargets()&&e.InvalidateRenderTarget(t)}Run_WebGPU(e,t,s){const n=this.GetEffectChain();e.SetTextureFillMode(),e.SetRenderTarget(s,!1),n._IsRenderTargetSameSizeAndOffset(e)?uu.setFromRect(n._GetRcTexBounce()):(e.SetNormalizedCoordsProgramVariant(!1),n._SetDeviceTransform(e,!0),uu.setFromRect(n._GetDrawSurfaceRect())),e.SetBackTexture(null),e.SetBlendMode(n._GetBlendMode()),e.SetTexture(t.GetTexture()),n.UseFullSurface()?e.FullscreenQuad():e.Quad3(uu,n._GetRcTexBounce())}}}{const du=self.C3;du.Gfx.EffectChain.Step.FirstBounce=class extends du.Gfx.EffectChain.Step{constructor(e,t,s,n){super(e,t,s,n)}Run_WebGL(e,t,s){const n=this.GetEffectChain();e.SetRenderTarget(s,n._UpdateOwnProjection()),e.ClearRgba(0,0,0,0),e.SetCopyBlend(),e.SetProgram(this.GetShaderProgram()),n._SetFirstBounceProgramParameters(e,this.GetIndex()),n._DrawContent(e),n._ClampRcTexDest()}Run_WebGPU(e,t,s){const n=this.GetEffectChain();e.SetRenderTarget(s,!1),e.ClearRgba(0,0,0,0),e.SetCopyBlend(),e.SetProgram(this.GetShaderProgram()),n._SetFirstBounceProgramParameters(e,this.GetIndex()),n._DrawContent(e),n._ClampRcTexDest()}}}{const pu=self.C3,fu=pu.New(pu.Rect),mu=pu.New(pu.Quad);pu.Gfx.EffectChain.Step.Bounce=class extends pu.Gfx.EffectChain.Step{constructor(e,t,s,n){super(e,t,s,n)}Run_WebGL(e,t,s){const n=this.GetEffectChain();e.SetRenderTarget(s);const i=0===this.GetDestTargetId();i?e.SetBlendMode(n._GetBlendMode()):(e.ClearRgba(0,0,0,0),e.SetCopyBlend()),e.SetProgram(this.GetShaderProgram()),n._SetProgramParameters(e,this.GetIndex()),e.SetTexture(t.GetTexture()),n._SetDeviceTransform(e,i),mu.setFromRect(n._GetDrawSurfaceRect()),fu.copy(n._GetRcTexBounce()),fu.flipAround(1),e.Quad3(mu,fu),n._ShouldInvalidateRenderTargets()&&e.InvalidateRenderTarget(t)}Run_WebGPU(e,t,s){const n=this.GetEffectChain();e.SetRenderTarget(s,!1),0===this.GetDestTargetId()?(e.SetBlendMode(n._GetBlendMode()),e.SetBackTexture(null),n._IsRenderTargetSameSizeAndOffset(e)?mu.setFromRect(n._GetRcTexBounce()):(e.SetNormalizedCoordsProgramVariant(!1),n._SetDeviceTransform(e,!0),mu.setFromRect(n._GetDrawSurfaceRect()))):(e.ClearRgba(0,0,0,0),e.SetCopyBlend(),mu.setFromRect(n._GetRcTexBounce())),e.SetProgram(this.GetShaderProgram()),n._SetProgramParameters(e,this.GetIndex()),e.SetTexture(t.GetTexture()),n.UseFullSurface()?e.FullscreenQuad():e.Quad3(mu,n._GetRcTexBounce())}}}{let gu=function(e,t){const s=e[0]-t[0];return 0!==s?s:e[1]-t[1]};SortZOrderList=gu;const Iu=self.C3,Su=self.C3X;let yu=null;const bu=new Set,Gu=[],vu=[];let xu=!1,Tu=!1,Cu=!1;const wu=new Set(["vsync","unlimited-tick","unlimited-frame"]);self.IRuntime=class{constructor(e){yu=e,Object.defineProperties(this,{assets:{value:yu.GetAssetManager().GetIAssetManager(),writable:!1},collisions:{value:yu.GetCollisionEngine().GetICollisionEngine(),writable:!1},objects:{value:{},writable:!1},globalVars:{value:{},writable:!1},projectName:{value:yu.GetProjectName(),writable:!1},projectVersion:{value:yu.GetProjectVersion(),writable:!1},projectId:{value:yu.GetAppId(),writable:!1},projectUniqueId:{value:yu.GetProjectUniqueId(),writable:!1},exportDate:{value:new Date(yu.GetExportTimestamp()),writable:!1},storage:{value:new self.IStorage(yu),writable:!1},isInWorker:{value:yu.IsInWorker(),writable:!1},viewportWidth:{value:yu.GetOriginalViewportWidth(),writable:!1},viewportHeight:{value:yu.GetOriginalViewportHeight(),writable:!1},sampling:{value:yu.GetSampling(),writable:!1},isPixelRoundingEnabled:{value:yu.IsPixelRoundingEnabled(),writable:!1},platformInfo:{value:new self.IPlatformInfo(e),writable:!1},sdk:{value:new self.ISDKUtils(e),writable:!1}}),yu.UserScriptDispatcher().addEventListener("keydown",(e=>{bu.has(e.key)?e.stopPropagation():bu.add(e.key)})),yu.UserScriptDispatcher().addEventListener("keyup",(e=>bu.delete(e.key))),yu.Dispatcher().addEventListener("window-blur",(()=>bu.clear())),yu.IsInWorker()&&(self.alert=e=>(xu||(xu=!0,console.warn("[Construct] alert() was called from a Web Worker, because the project 'Use worker' setting is enabled. This method is not normally available in a Web Worker. Construct has implemented the alert for you, but note that other features may be missing in worker mode. You may wish to disable 'Use worker', or use a more convenient function like console.log(). For more information please refer to the scripting section of the manual.")),this.alert(e)))}_InitObjects(e){Object.defineProperties(this.objects,e)}_InitGlobalVars(e){Object.defineProperties(this.globalVars,e)}addEventListener(e,t){yu.UserScriptDispatcher().addEventListener(e,t)}removeEventListener(e,t){yu.UserScriptDispatcher().removeEventListener(e,t)}callFunction(e,...t){Su.RequireString(e);const s=yu.GetEventSheetManager(),n=s.GetFunctionBlockByName(e);if(!n)throw new Error(`cannot find function name '${e}'`);if(!n.IsEnabled())return n.GetDefaultReturnValue();if(t.length<n.GetFunctionParameterCount())throw new Error(`not enough function parameters passed for '${e}' (${t.length} passed, ${n.GetFunctionParameterCount()} expected)`);const i=n.GetEventBlock();let r=i.GetSolModifiersIncludingParents();const a=s.GetCurrentEvent();if(a){r=r.slice(0);const e=new Set(r);for(const t of a.GetSolModifiersIncludingParents())e.has(t)||(r.push(t),e.add(t));for(const t of s.GetDynamicSolModifiersSet())e.has(t)||(r.push(t),e.add(t))}return i.RunAsExpressionFunctionCall(r,n.IsCopyPicked(),n.GetReturnType(),n.GetDefaultReturnValue(),...t)}setReturnValue(e){const t=yu.GetEventStack().GetCurrentExpFuncStackFrame();if(!t)throw new Error("not in a function which returns a value");switch(t.GetFunctionReturnType()){case 1:"number"==typeof e&&t.SetFunctionReturnValue(e);break;case 2:"string"==typeof e&&t.SetFunctionReturnValue(e);break;case 3:"number"!=typeof e&&"string"!=typeof e||t.SetFunctionReturnValue(e)}}signal(e){Su.RequireString(e),yu.GetEventSheetManager().Signal(e)}waitForSignal(e){return Su.RequireString(e),yu.GetEventSheetManager().WaitForSignal(e)}getViewportSize(){return[yu.GetOriginalViewportWidth(),yu.GetOriginalViewportHeight()]}get isSuspended(){return yu.IsSuspended()}get dt(){return yu.GetDt()}get dtRaw(){return yu.GetDtRaw()}get gameTime(){return yu.GetGameTime()}get tickCount(){return yu.GetTickCount()}get wallTime(){return yu.GetWallTime()}get timeScale(){return yu.GetTimeScale()}set timeScale(e){Su.RequireFiniteNumber(e),yu.SetTimeScale(e)}get fps(){return Tu||(console.warn("IRuntime.fps is deprecated. Use IRuntime.framesPerSecond instead."),Tu=!0),yu.GetFramesPerSecond()}get framesPerSecond(){return yu.GetFramesPerSecond()}get ticksPerSecond(){return yu.GetTicksPerSecond()}get cpuUtilisation(){return yu.GetMainThreadTime()}get gpuUtilisation(){return yu.GetGPUUtilisation()}get framerateMode(){return yu.GetFramerateMode()}set framerateMode(e){if(!wu.has(e))throw new Error("invalid framerate mode");yu._SetFramerateMode(e)}get minDt(){return yu.GetMinDt()}set minDt(e){Su.RequireFiniteNumber(e),yu.SetMinDt(e)}get maxDt(){return yu.GetMaxDt()}set maxDt(e){yu.SetMaxDt(e)}get loadingProgress(){return yu.GetAssetManager().GetLoadProgress()}get imageLoadingProgress(){return yu.GetAssetManager().GetImageLoadProgress()}random(){return yu.Random()}get layout(){const e=yu.GetMainRunningLayout();if(!e)throw new Error("no layout is running - make sure a layout is loaded before accessing");return e.GetILayout()}getLayout(e){const t=yu.GetLayoutManager();let s=null;if("number"!=typeof e&&"string"!=typeof e)throw new TypeError("expected string or number");if(s=t.GetLayout(e),!s)throw new Error("invalid layout");return s.GetILayout()}getAllLayouts(){return yu.GetLayoutManager().GetAllLayouts().map((e=>e.GetILayout()))}goToLayout(e){const t=yu.GetLayoutManager();let s=null;if("number"!=typeof e&&"string"!=typeof e)throw new TypeError("expected string or number");if(s=t.GetLayout(e),!s)throw new Error("invalid layout");t.IsPendingChangeMainLayout()||t.ChangeMainLayout(s)}get keyboard(){const e=yu._GetCommonScriptInterfaces().keyboard;if(!e)throw new Error("runtime.keyboard used but Keyboard object missing - add it to your project first");return e}get mouse(){const e=yu._GetCommonScriptInterfaces().mouse;if(!e)throw new Error("runtime.mouse used but Mouse object missing - add it to your project first");return e}get touch(){const e=yu._GetCommonScriptInterfaces().touch;if(!e)throw new Error("runtime.touch used but Touch object missing - add it to your project first");return e}get timelineController(){const e=yu._GetCommonScriptInterfaces().timelineController;if(!e)throw new Error("runtime.timelineController used but Timeline Controller object missing - add it to your project first");return e}invokeDownload(e,t){Su.RequireString(e),Su.RequireString(t),yu.InvokeDownload(e,t)}getInstanceByUid(e){Su.RequireFiniteNumber(e);const t=yu.GetInstanceByUID(e);return t?t.GetInterfaceClass():null}sortZOrder(e,t){Su.RequireFunction(t);const s=yu.GetCurrentLayout();for(const t of e){const e=yu._UnwrapIWorldInstance(t),s=e.GetWorldInfo();Gu.push([s.GetLayer().GetIndex(),s.GetZIndex()]),vu.push(e)}if(0===Gu.length)return;Gu.sort(gu),vu.sort(((e,s)=>t(e.GetInterfaceClass(),s.GetInterfaceClass())));let n=!1;for(let e=0,t=Gu.length;e<t;++e){const t=vu[e],i=s.GetLayerByIndex(Gu[e][0]),r=Gu[e][1],a=i._GetInstances();a[r]!==t&&(a[r]=t,t.GetWorldInfo()._SetLayer(i,!0),i.SetZIndicesChanged(t),n=!0)}n&&yu.UpdateRender(),Iu.clearArray(Gu),Iu.clearArray(vu)}async createWorker(e,t){Cu||(console.warn("IRuntime.createWorker() is deprecated. All modern browsers now support nested workers so this method is no longer needed."),Cu=!0);const s=new MessageChannel,n=s.port1,i=s.port2;return await yu.PostComponentMessageToDOMAsync("runtime","script-create-worker",{url:e,opts:t,port2:i},[i]),n}alert(e){return yu.PostComponentMessageToDOMAsync("runtime","alert",{message:e+(yu.IsInWorker()?" [via Web Worker]":"")})}getHTMLLayer(e){return Su.RequireFiniteNumber(e),yu._GetHTMLLayerWrapElement(e)}addLoadPromise(e){yu.AddLoadPromise(e)}async saveCanvasImage(e,t,s){Su.RequireOptionalString(e),Su.RequireOptionalNumber(t),Su.RequireOptionalInstanceOf(s,DOMRect),s||(s=new DOMRect(0,0,0,0));const n=yu.GetCanvasManager();if(!n)return;yu.UpdateRender();const i=await n.SnapshotCanvas(e||"image/png",t,s.x,s.y,s.width,s.height);return await yu.TriggerAsync(Iu.Plugins.System.Cnds.OnCanvasSnapshot,null),i}}}{const Pu=self.C3,Au=self.C3X;let Ru=null;self.IAssetManager=class{constructor(e){Ru=e,Object.defineProperties(this,{isWebMOpusSupported:{value:!0,writable:!1}})}loadImageAsset(e){const t=self.IImageInfo._Unwrap(e);if(!t)throw new Error("invalid IImageInfo");t.LoadAsset(Ru.GetRuntime())}fetchText(e){return Ru.FetchText(e)}fetchJson(e){return Ru.FetchJson(e)}fetchBlob(e){return Ru.FetchBlob(e)}fetchArrayBuffer(e){return Ru.FetchArrayBuffer(e)}getProjectFileUrl(e){return Ru.GetProjectFileUrl(e)}getMediaFileUrl(e){return"flat"===Ru.GetFileStructure()&&Pu.IsRelativeURL(e)&&(e=e.toLowerCase()),Ru.GetMediaFileUrl(e)}get mediaFolder(){return Ru.GetMediaSubfolder()}async decodeWebMOpus(e,t){throw new Error("decodeWebMOpus() is no longer supported - use Web Audio's decodeAudioData() directly as all supported platforms now support WebM Opus")}loadScripts(...e){return Ru.LoadScripts(...e)}compileWebAssembly(e){return Ru.CompileWebAssembly(e)}loadStyleSheet(e){return Ru.LoadStyleSheet(e)}}}{const Du=self.C3,Eu=self.C3X;let Mu=null;self.ICollisionEngine=class{constructor(e){Mu=e,Object.defineProperties(this,{runtime:{value:Mu.GetRuntime(),writable:!1}})}testOverlap(e,t){const s=Mu.GetRuntime(),n=s._UnwrapIWorldInstance(e),i=s._UnwrapIWorldInstance(t);return Mu.TestOverlap(n,i)}testOverlapAny(e,t){const s=Mu.GetRuntime(),n=s._UnwrapIWorldInstance(e);for(const e of t){const t=s._UnwrapIWorldInstance(e);if(Mu.TestOverlap(n,t))return e}return null}testOverlapSolid(e){const t=Mu.GetRuntime()._UnwrapIWorldInstance(e),s=Mu.TestOverlapSolid(t);return s?s.GetInterfaceClass():null}setCollisionCellSize(e,t){if(Eu.RequireFiniteNumber(e),Eu.RequireFiniteNumber(t),e=Math.floor(e),t=Math.floor(t),e<=0||t<=0)throw new Error("invalid cell size");Mu.SetCollisionCellSize(e,t)}getCollisionCellSize(){return Mu.GetCollisionCellSize()}getCollisionCandidates(e,t){const s=Mu.GetRuntime();let n;n=Array.isArray(e)?e.map((e=>s._UnwrapIObjectClass(e))):[s._UnwrapIObjectClass(e)];const i=Du.Rect.FromObject(t),r=[];return Mu.GetObjectClassesCollisionCandidates(null,n,i,r),r.map((e=>e.GetInterfaceClass()))}}}{const ku=self.C3,Lu=self.C3X;let Fu=null;const Bu=new Map([["Windows","windows"],["macOS","macos"],["Linux","linux"],["Chrome OS","chrome-os"],["Android","android"],["iOS","ios"]]),Ou=new Map([["Chrome","chrome"],["Chromium","chromium"],["Edge","edge"],["Opera","opera"],["NW.js","nwjs"],["Firefox","firefox"],["Safari","safari"]]),Nu=new Map([["Chromium","chromium"],["Gecko","gecko"],["WebKit","webkit"]]);self.IPlatformInfo=class{constructor(e){Fu=e,Object.defineProperties(this,{isMobile:{value:ku.Platform.IsMobile,writable:!1},os:{value:Bu.get(ku.Platform.OS)||"unknown",writable:!1},osVersion:{value:ku.Platform.OSVersion,writable:!1},browser:{value:Ou.get(ku.Platform.Browser)||"unknown",writable:!1},browserVersion:{value:ku.Platform.BrowserVersion,writable:!1},browserEngine:{value:Nu.get(ku.Platform.BrowserEngine)||"unknown",writable:!1}})}get exportType(){let e=Fu.GetExportType();return Fu.IsNWjs()?e="nwjs":Fu.IsWindowsWebView2()?e="windows-webview2":"cordova"===e?e="Android"===ku.Platform.OS?"cordova-android":"cordova-ios":"playable-ad-single-file"!==e&&"playable-ad-zip"!==e||(e="playable-ad"),e}get renderer(){return Fu.GetCanvasManager().GetRendererString()}get rendererDetail(){return Fu.GetCanvasManager().GetRendererDetailString()}get canvasClientX(){return Fu.GetCanvasManager().GetCanvasClientX()}get canvasClientY(){return Fu.GetCanvasManager().GetCanvasClientY()}get canvasCssWidth(){return Fu.GetCanvasManager().GetCssWidth()}get canvasCssHeight(){return Fu.GetCanvasManager().GetCssHeight()}get canvasDeviceWidth(){return Fu.GetCanvasManager().GetDeviceWidth()}get canvasDeviceHeight(){return Fu.GetCanvasManager().GetDeviceHeight()}get devicePixelRatio(){return Fu.GetDevicePixelRatio()}}}{const Wu=self.C3,Vu=self.C3X;self.IStorage=class{constructor(e){this._storage=e._GetProjectStorage()}getItem(e){return Vu.RequireString(e),this._storage.getItem(e)}setItem(e,t){return Vu.RequireString(e),this._storage.setItem(e,t)}removeItem(e){return Vu.RequireString(e),this._storage.removeItem(e)}clear(){return this._storage.clear()}keys(){return this._storage.keys()}}}{const ju=self.C3,Uu=self.C3X,Hu=ju._GetInternalAPIToken();self.IPlugin=class{#e;constructor(){const e=ju.AddonManager._GetInitObject2(Hu);this.#e=e,Object.defineProperties(this,{runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},id:{value:e.GetID(),writable:!1},isSingleGlobal:{value:e.IsSingleGlobal(),writable:!1},isWorldType:{value:e.IsWorldType(),writable:!1},isHTMLElementType:{value:e.IsHTMLElementType(),writable:!1},isRotatable:{value:e.IsRotatable(),writable:!1},hasEffects:{value:e.HasEffects(),writable:!1},is3d:{value:e.Is3D(),writable:!1},supportsHierarchies:{value:e.SupportsSceneGraph(),writable:!1},supportsMesh:{value:e.SupportsMesh(),writable:!1}}),e.GetRuntime()._MapScriptInterface(this,e)}static getByConstructor(e){if(!e)return null;const t=ju.AddonManager.GetPluginByConstructorFunction(e);return t?t.GetIPlugin():null}getSingleGlobalObjectType(){return this.#e.GetSingleGlobalObjectClass().GetIObjectClass()}getSingleGlobalInstance(){return this.#e.GetSingleGlobalInstance().GetInterfaceClass()}}}{const zu=globalThis.C3,Xu=globalThis.C3X,Yu=zu._GetInternalAPIToken();globalThis.IObjectClass=class{#e;constructor(){const e=zu.AddonManager._GetInitObject2(Yu);this.#e=e,Object.defineProperties(this,{name:{value:e.GetName(),writable:!1},runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},plugin:{value:e.GetPlugin().GetIPlugin(),writable:!1}}),e.GetRuntime()._MapScriptInterface(this,e)}addEventListener(e,t){Xu.RequireString(e),Xu.RequireFunction(t),this.#e.UserScriptDispatcher().addEventListener(e,t)}removeEventListener(e,t){Xu.RequireString(e),Xu.RequireFunction(t),this.#e.UserScriptDispatcher().removeEventListener(e,t)}getAllInstances(){return[...this.instances()]}getFirstInstance(){return zu.first(this.instances())}getPickedInstances(){return[...this.pickedInstances()]}getFirstPickedInstance(){return zu.first(this.pickedInstances())}getPairedInstance(e){const t=this.#e,s=t.GetRuntime()._UnwrapIInstance(e),n=t.GetPairedInstance(s);return n?n.GetInterfaceClass():null}*instances(){for(const e of this.#e.instancesIncludingPendingCreate())yield e.GetInterfaceClass()}*pickedInstances(){for(const e of this.#e.GetCurrentSol().GetInstances())yield e.GetInterfaceClass()}}}{const qu=globalThis.C3,Ju=globalThis.C3X,Ku=qu._GetInternalAPIToken();globalThis.IObjectType=class extends globalThis.IObjectClass{#e;constructor(){super();const e=qu.AddonManager._GetInitObject2(Ku);this.#e=e}setInstanceClass(e){Ju.RequireFunction(e);const t=this.#e;if(t.GetInstanceCount()>0)throw new Error("setInstanceClass() called too late, because instances have already been created - call in runOnStartup");t._SetUserScriptInstanceClass(e)}createInstance(e,t,s,n,i){if(Ju.RequireNumber(t),Ju.RequireNumber(s),"number"!=typeof e&&"string"!=typeof e)throw new TypeError("invalid layer parameter");const r=this.#e,a=r.GetRuntime(),o=a.GetMainRunningLayout().GetLayer(e);if(!o)throw new Error("invalid layer");const l=a.CreateInstance(r,o,t,s,n,i);n&&o.SortAndAddInstancesByZIndex(l);const c=a.GetEventSheetManager();return c.BlockFlushingInstances(!0),l._TriggerOnCreatedOnSelfAndRelated(),c.BlockFlushingInstances(!1),c.IsInEventEngine()||a.GetLayoutManager().IsEndingLayout()||a.FlushPendingInstances(),l.GetInterfaceClass()}getAllFamilies(){return this.#e.GetFamilies().map((e=>e.GetIObjectClass()))}*families(){for(const e of this.#e.GetFamilies())yield e.GetIObjectClass()}isInFamily(e){return Ju.RequireInstanceOf(e,globalThis.IFamily),e.hasObjectType(this)}}}{const $u=globalThis.C3,Zu=globalThis.C3X,Qu=globalThis.IObjectType,ed=$u._GetInternalAPIToken();globalThis.IFamily=class extends globalThis.IObjectClass{#e;constructor(){super();const e=$u.AddonManager._GetInitObject2(ed);this.#e=e}getAllObjectTypes(){return this.#e.GetFamilyMembers().map((e=>e.GetIObjectClass()))}*objectTypes(){for(const e of this.#e.GetFamilyMembers())yield e.GetIObjectClass()}hasObjectType(e){Zu.RequireInstanceOf(e,Qu);const t=this.#e,s=t.GetRuntime()._UnwrapIObjectClass(e);return t.FamilyHasMember(s)}}}{const td=self.C3,sd=self.C3X,nd=new WeakMap,id=["above","below","top-sublayer","bottom-sublayer"];self.ILayout=class{constructor(e){nd.set(this,e);const t=[],s=e.GetEffectList(),n=s.GetAllEffectTypes().length;for(let e=0;e<n;++e)t.push(new self.IEffectInstance(s,e));Object.defineProperties(this,{name:{value:e.GetName(),writable:!1},index:{value:e.GetIndex(),writable:!1},effects:{value:t,writable:!1}})}addEventListener(e,t){sd.RequireString(e),sd.RequireFunction(t),nd.get(this).UserScriptDispatcher().addEventListener(e,t)}removeEventListener(e,t){sd.RequireString(e),sd.RequireFunction(t),nd.get(this).UserScriptDispatcher().removeEventListener(e,t)}get width(){return nd.get(this).GetWidth()}set width(e){sd.RequireFiniteNumber(e),nd.get(this).SetWidth(e)}get height(){return nd.get(this).GetHeight()}set height(e){sd.RequireFiniteNumber(e),nd.get(this).SetHeight(e)}setSize(e,t){sd.RequireFiniteNumber(e),sd.RequireFiniteNumber(t);const s=nd.get(this);s.SetWidth(e),s.SetHeight(t)}getSize(){const e=nd.get(this);return[e.GetWidth(),e.GetHeight()]}set scale(e){sd.RequireFiniteNumber(e),nd.get(this).SetScale(e)}get scale(){return nd.get(this).GetScale()}set angle(e){sd.RequireFiniteNumber(e),nd.get(this).SetAngle(e)}get angle(){return nd.get(this).GetAngle()}set scrollX(e){sd.RequireNumber(e),nd.get(this).SetScrollX(e)}get scrollX(){return nd.get(this).GetScrollX()}set scrollY(e){sd.RequireNumber(e),nd.get(this).SetScrollY(e)}get scrollY(){return nd.get(this).GetScrollY()}scrollTo(e,t){sd.RequireNumber(e),sd.RequireNumber(t);const s=nd.get(this);s.SetScrollX(e),s.SetScrollY(t)}getScrollPosition(){const e=nd.get(this);return[e.GetScrollX(),e.GetScrollY()]}getLayer(e){const t=nd.get(this);let s=null;if("number"!=typeof e&&"string"!=typeof e)throw new TypeError("expected string or number");return s=t.GetLayer(e),s?s.GetILayer():null}getAllLayers(){return nd.get(this).GetLayers().map((e=>e.GetILayer()))}*allLayers(){for(const e of nd.get(this).allLayers())yield e.GetILayer()}addLayer(e,t,s){const n=nd.get(this),i=self.ILayer;sd.RequireString(e),sd.RequireOptionalInstanceOf(t,i);const r=t?n.GetRuntime()._UnwrapScriptInterface(t):null,a=id.indexOf(s);if(a<0)throw new Error("invalid location");n.AddLayer(e,r,a)}moveLayer(e,t,s){const n=nd.get(this),i=n.GetRuntime(),r=self.ILayer;sd.RequireInstanceOf(e,r);const a=i._UnwrapScriptInterface(e);if(!a)throw new Error("invalid layer");sd.RequireOptionalInstanceOf(t,r);const o=t?i._UnwrapScriptInterface(t):null,l=id.indexOf(s);if(l<0)throw new Error("invalid location");n.MoveLayer(a,o,l)}removeLayer(e){const t=nd.get(this),s=self.ILayer;sd.RequireInstanceOf(e,s);const n=t.GetRuntime()._UnwrapScriptInterface(e);if(!n)throw new Error("invalid layer");const i=n.GetRuntime();t.RemoveLayer(n),i.GetEventSheetManager().IsInEventEngine()||i.FlushPendingInstances()}removeAllDynamicLayers(){const e=nd.get(this),t=e.GetRuntime();e.RemoveAllDynamicLayers(),t.GetEventSheetManager().IsInEventEngine()||t.FlushPendingInstances()}setVanishingPoint(e,t){sd.RequireFiniteNumber(e),sd.RequireFiniteNumber(t),nd.get(this).SetVanishingPointXY(e,t)}getVanishingPoint(){return nd.get(this)._GetVanishingPoint()}set projection(e){sd.RequireString(e);const t=nd.get(this);if("perspective"===e)t.SetPerspectiveProjection();else{if("orthographic"!==e)throw new Error("invalid projection");t.SetOrthographicProjection()}}get projection(){return nd.get(this).IsOrthographicProjection()?"orthographic":"perspective"}}}{const rd=self.C3,ad=self.C3X,od=new WeakMap,ld=new Map([["normal",0],["additive",1],["copy",3],["destination-over",4],["source-in",5],["destination-in",6],["source-out",7],["destination-out",8],["source-atop",9],["destination-atop",10]]),cd=new Map([...ld.entries()].map((e=>[e[1],e[0]]))),hd=new Set(["2d","3d"]),_d=rd.New(rd.Color);self.ILayer=class{constructor(e){od.set(this,e);const t=[],s=e.GetEffectList(),n=s.GetAllEffectTypes().length;for(let e=0;e<n;++e)t.push(new self.IEffectInstance(s,e));Object.defineProperties(this,{name:{value:e.GetName(),writable:!1},layout:{value:e.GetLayout().GetILayout(),writable:!1},effects:{value:t,writable:!1}}),e.GetRuntime()._MapScriptInterface(this,e)}get parentLayer(){const e=od.get(this).GetParentLayer();return e?e.GetILayer():null}*parentLayers(){for(const e of od.get(this).parentLayers())yield e.GetILayer()}*subLayers(){for(const e of od.get(this).GetSubLayers())yield e.GetILayer()}*allSubLayers(){for(const e of od.get(this).GetSubLayers())for(const t of e.selfAndAllSubLayers())yield t.GetILayer()}get index(){return od.get(this).GetIndex()}get isVisible(){return od.get(this)._IsVisibleFlagSet()}set isVisible(e){od.get(this).SetVisible(e)}get isSelfAndParentsVisible(){return od.get(this).IsVisible()}get isInteractive(){return od.get(this).IsInteractive()}set isInteractive(e){od.get(this).SetInteractive(e)}get isHTMLElementsLayer(){return od.get(this).IsHTMLElementsLayer()}set isHTMLElementsLayer(e){od.get(this).SetIsHTMLElementsLayer(!!e)}get isSelfAndParentsInteractive(){return od.get(this).IsSelfAndParentsInteractive()}get opacity(){return od.get(this).GetOpacity()}set opacity(e){e=rd.clamp(+e,0,1),isNaN(e)||od.get(this).SetOpacity(e)}set scale(e){ad.RequireFiniteNumber(e),od.get(this).SetOwnScale(e)}get scale(){return od.get(this).GetOwnScale()}set scaleRate(e){ad.RequireFiniteNumber(e),od.get(this).SetScaleRate(e)}get scaleRate(){return od.get(this).GetScaleRate()}set angle(e){ad.RequireFiniteNumber(e),od.get(this).SetAngle(e)}get angle(){return od.get(this).GetOwnAngle()}set parallaxX(e){ad.RequireFiniteNumber(e),od.get(this).SetParallaxX(e)}get parallaxX(){return od.get(this).GetParallaxX()}set parallaxY(e){ad.RequireFiniteNumber(e),od.get(this).SetParallaxY(e)}get parallaxY(){return od.get(this).GetParallaxY()}set zElevation(e){ad.RequireFiniteNumber(e),od.get(this).SetZElevation(e)}get zElevation(){return od.get(this).GetZElevation()}set renderingMode(e){if(!hd.has(e))throw TypeError("invalid rendering mode");od.get(this).SetRenderAs3D("3d"===e)}get renderingMode(){return od.get(this).IsRenderAs3D()?"3d":"2d"}set isTransparent(e){od.get(this).SetTransparent(e)}get isTransparent(){return od.get(this).IsTransparent()}set isForceOwnTexture(e){od.get(this).SetForceOwnTexture(e)}get isForceOwnTexture(){return od.get(this).IsForceOwnTexture()}set blendMode(e){ad.RequireString(e);const t=ld.get(e);if("number"!=typeof t)throw new Error("invalid blend mode");od.get(this).SetBlendMode(t)}get blendMode(){return cd.get(od.get(this).GetBlendMode())}set backgroundColor(e){if(ad.RequireArray(e),e.length<3)throw new Error("expected 3 elements");_d.setRgb(e[0],e[1],e[2]);const t=od.get(this),s=t.GetBackgroundColor();s.equalsIgnoringAlpha(_d)||(s.copyRgb(_d),t.GetRuntime().UpdateRender())}get backgroundColor(){const e=od.get(this).GetBackgroundColor();return[e.getR(),e.getG(),e.getB()]}set scrollX(e){ad.RequireNumber(e);const t=od.get(this);t.SetOwnScrollPositionEnabled(!0),t.SetScrollX(e)}get scrollX(){return od.get(this).GetScrollX()}set scrollY(e){ad.RequireNumber(e);const t=od.get(this);t.SetOwnScrollPositionEnabled(!0),t.SetScrollY(e)}get scrollY(){return od.get(this).GetScrollY()}scrollTo(e,t){ad.RequireNumber(e),ad.RequireNumber(t);const s=od.get(this);s.SetOwnScrollPositionEnabled(!0),s.SetScrollX(e),s.SetScrollY(t)}getScrollPosition(){const e=od.get(this);return[e.GetScrollX(),e.GetScrollY()]}restoreScrollPosition(){od.get(this).SetOwnScrollPositionEnabled(!1)}getViewport(){return od.get(this).GetViewport().toDOMRect()}cssPxToLayer(e,t,s=0){ad.RequireNumber(e),ad.RequireNumber(t),ad.RequireNumber(s);const n=od.get(this),i=n.GetRuntime();return n.CanvasCssToLayer(e-i.GetCanvasClientX(),t-i.GetCanvasClientY(),s)}layerToCssPx(e,t,s=0){ad.RequireNumber(e),ad.RequireNumber(t),ad.RequireNumber(s);const n=od.get(this),i=n.GetRuntime(),[r,a]=n.LayerToCanvasCss(e,t,s);return[r+i.GetCanvasClientX(),a+i.GetCanvasClientY()]}drawSurfaceToLayer(e,t,s=0){return ad.RequireNumber(e),ad.RequireNumber(t),ad.RequireNumber(s),od.get(this).DrawSurfaceToLayer(e,t,s)}layerToDrawSurface(e,t,s=0){return ad.RequireNumber(e),ad.RequireNumber(t),ad.RequireNumber(s),od.get(this).LayerToDrawSurface(e,t,s)}get renderScale(){return od.get(this).GetRenderScale()}}}{let ud=function(e){let t=fd.get(e);return t||(t=dd.New(dd.Event.Dispatcher),fd.set(e,t),t)};GetDispatcher=ud;const dd=self.C3,pd=self.C3X,fd=new WeakMap,md=dd._GetInternalAPIToken();self.IInstance=class{#e;constructor(){const e=dd.AddonManager._GetInitObject2(md);this.#e=e;const t={runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},objectType:{value:e.GetObjectClass().GetIObjectClass(),writable:!1},plugin:{value:e.GetPlugin().GetIPlugin(),writable:!1}};e._GetInstVarsScriptDescriptor(t),e._GetBehaviorsScriptDescriptor(t),Object.defineProperties(this,t),e.GetRuntime()._MapScriptInterface(this,e)}static _GetInitInst(){return dd.AddonManager._GetInitObject()}_release(){const e=fd.get(this);e&&(e.Release(),fd.delete(this))}addEventListener(e,t,s){pd.RequireString(e),pd.RequireFunction(t),ud(this).addEventListener(e,t,s)}removeEventListener(e,t,s){pd.RequireString(e),pd.RequireFunction(t),ud(this).removeEventListener(e,t,s)}dispatchEvent(e){ud(this).dispatchEvent(e)}destroy(){const e=this.#e,t=e.GetRuntime();t.DestroyInstance(e),t.GetEventSheetManager().IsInEventEngine()||t.GetLayoutManager().IsEndingLayout()||t.GetEventSheetManager().IsFlushingBlocked()||t.FlushPendingInstances()}getOtherContainerInstances(){const e=this.#e.GetSiblings();return e?e.map((e=>e.GetInterfaceClass())):[]}*otherContainerInstances(){const e=this.#e;if(e.IsInContainer())for(const t of e.siblings())yield t.GetInterfaceClass()}get uid(){return this.#e.GetUID()}get iid(){return this.#e.GetIID()}get templateName(){return this.#e.GetTemplateName()}set timeScale(e){pd.RequireFiniteNumber(e),this.#e.SetTimeScale(e)}get timeScale(){return this.#e.GetActiveTimeScale()}restoreTimeScale(){this.#e.RestoreTimeScale()}get dt(){const e=this.#e;return e.GetRuntime().GetDt(e)}hasTags(...e){pd.RequireArray(e);const t=new Set(e),s=this.#e.GetTagsSet();return t.isSubsetOf(s)}setAllTags(e){pd.RequireInstanceOf(e,Set),this.#e.SetTagsSet(e)}getAllTags(){return new Set(this.#e.GetTagsSet())}signal(e){pd.RequireString(e);const t=this.#e;t.GetRuntime().GetEventSheetManager().InstanceSignal(t,e)}waitForSignal(e){pd.RequireString(e);const t=this.#e;return t.GetRuntime().GetEventSheetManager().WaitForInstanceSignal(t,e)}}}{const gd=self.C3,Id=self.C3X,Sd=gd._GetInternalAPIToken();self.ISDKInstanceBase=class extends self.IInstance{#e;#t=!1;#s=null;#n=!1;#i=null;#r;#a;constructor(e){super(),this.#e=gd.AddonManager._GetInitObject2(Sd),this.#t=!1,this.#s=null,this.#n=!1,this.#i=null,this.#r=e?.domComponentId,this.#a=e?.wrapperComponentId}_release(){this._setTicking(!1),this._setTicking2(!1),super._release()}_getInitProperties(){return gd.AddonManager._GetInitProperties()}_trigger(e){const t=this.#e;t.GetRuntime().Trigger(e,t)}_triggerAsync(e){const t=this.#e;return t.GetRuntime().TriggerAsync(e,t)}_addDOMMessageHandler(e,t){if(Id.RequireString(e),Id.RequireFunction(t),!this.#r)throw new Error("no DOM component id set");this.#e.GetRuntime().AddDOMComponentMessageHandler(this.#r,e,t)}_addDOMMessageHandlers(e){Id.RequireArray(e);for(const[t,s]of e)this._addDOMMessageHandler(t,s)}_postToDOM(e,t){if(Id.RequireString(e),!this.#r)throw new Error("no DOM component id set");this.#e.GetRuntime().PostComponentMessageToDOM(this.#r,e,t)}_postToDOMAsync(e,t){if(Id.RequireString(e),!this.#r)throw new Error("no DOM component id set");return this.#e.GetRuntime().PostComponentMessageToDOMAsync(this.#r,e,t)}_postToDOMMaybeSync(e,t){if(!this.#e.GetRuntime().IsInWorker())return window.c3_runtimeInterface._OnMessageFromRuntime({type:"event",component:this.#r,handler:e,data:t,responseId:null});this._postToDOM(e,t)}_setTicking(e){if(e=!!e,this.#t===e)return;this.#t=e;const t=this.#e.GetRuntime();if(e){if(!this.#s)if(this.#e.GetRuntime().IsDebug()){const e=globalThis.C3Debugger,t=this.plugin;this.#s=()=>{const s=performance.now();this._tick(),e.AddIndividualPluginTickTime(t,performance.now()-s)}}else this.#s=()=>this._tick();t.Dispatcher().addEventListener("tick",this.#s)}else t.Dispatcher().removeEventListener("tick",this.#s)}_isTicking(){return this.#t}_tick(){}_setTicking2(e){if(e=!!e,this.#n===e)return;this.#n=e;const t=this.#e.GetRuntime();if(e){if(!this.#i)if(this.#e.GetRuntime().IsDebug()){const e=globalThis.C3Debugger,t=this.plugin;this.#i=()=>{const s=performance.now();this._tick2(),e.AddIndividualPluginTickTime(t,performance.now()-s)}}else this.#i=()=>this._tick2();t.Dispatcher().addEventListener("tick2",this.#i)}else t.Dispatcher().removeEventListener("tick2",this.#i)}_isTicking2(){return this.#n}_tick2(){}_getDebuggerProperties(){return[]}_saveToJson(){return null}_loadFromJson(e){}_isWrapperExtensionAvailable(){if(!this.#a)throw new Error("no wrapper component id set");return this.#e.GetRuntime().HasWrapperComponentId(this.#a)}_addWrapperExtensionMessageHandler(e,t){if(Id.RequireString(e),Id.RequireFunction(t),!this.#a)throw new Error("no wrapper component id set");this.#e.GetRuntime().AddWrapperExtensionMessageHandler(this.#a,e,t)}_addWrapperMessageHandlers(e){Id.RequireArray(e);for(const[t,s]of e)this._addWrapperExtensionMessageHandler(t,s)}_sendWrapperExtensionMessage(e,t){if(!this.#a)throw new Error("no wrapper component id set");this.runtime.sdk.sendWrapperExtensionMessage(this.#a,e,t)}_sendWrapperExtensionMessageAsync(e,t){if(!this.#a)throw new Error("no wrapper component id set");return this.runtime.sdk.sendWrapperExtensionMessageAsync(this.#a,e,t)}}}{let yd=function(e){return class t extends e{#e;#t;constructor(e){super(e);const t=bd.AddonManager._GetInitObject2(Pd),s=t.GetWorldInfo();this.#e=t,this.#t=s,wd.set(this,t);const n=[],i=s.GetInstanceEffectList();if(i){const e=s.GetObjectClass().GetEffectList().GetAllEffectTypes().length;for(let t=0;t<e;++t)n.push(new self.IEffectInstance(i,t))}const r={effects:{value:n,writable:!1}};Object.defineProperties(this,r)}get layout(){return this.#t.GetLayout().GetILayout()}get layer(){return this.#t.GetLayer().GetILayer()}get x(){return this.#t.GetX()}set x(e){e=+e;const t=this.#t;isNaN(e)||t.GetX()===e||(t.SetX(e),t.SetBboxChanged())}get y(){return this.#t.GetY()}set y(e){e=+e;const t=this.#t;isNaN(e)||t.GetY()===e||(t.SetY(e),t.SetBboxChanged())}setPosition(e,t){e=+e,t=+t;const s=this.#t;isNaN(e)||isNaN(t)||s.GetX()===e&&s.GetY()===t||(s.SetXY(e,t),s.SetBboxChanged())}getPosition(){const e=this.#t;return[e.GetX(),e.GetY()]}offsetPosition(e,t){if(e=+e,t=+t,isNaN(e)||isNaN(t)||0===e&&0===t)return;const s=this.#t;s.OffsetXY(e,t),s.SetBboxChanged()}set originX(e){e=+e;const t=this.#t;isNaN(e)||t.GetOriginX()===e||(t.SetOriginX(e),t.SetBboxChanged())}get originX(){return this.#t.GetOriginX()}set originY(e){e=+e;const t=this.#t;isNaN(e)||t.GetOriginY()===e||(t.SetOriginY(e),t.SetBboxChanged())}get originY(){return this.#t.GetOriginY()}setOrigin(e,t){e=+e,t=+t;const s=this.#t;isNaN(e)||isNaN(t)||s.GetOriginX()===e&&s.GetOriginY()===t||(s.SetOriginX(e),s.SetOriginY(t),s.SetBboxChanged())}getOrigin(){const e=this.#t;return[e.GetOriginX(),e.GetOriginY()]}get zElevation(){return this.#t.GetZElevation()}set zElevation(e){e=+e;const t=this.#e,s=this.#t;isNaN(e)||s.GetZElevation()===e||(s.SetZElevation(e),t.GetRuntime().UpdateRender())}get totalZElevation(){return this.#t.GetTotalZElevation()}get width(){return this.#t.GetWidth()}set width(e){e=+e;const t=this.#t;isNaN(e)||t.GetWidth()===e||(t.SetWidth(e),t.SetBboxChanged())}get height(){return this.#t.GetHeight()}set height(e){e=+e;const t=this.#t;isNaN(e)||t.GetHeight()===e||(t.SetHeight(e),t.SetBboxChanged())}setSize(e,t){e=+e,t=+t;const s=this.#t;isNaN(e)||isNaN(t)||s.GetWidth()===e&&s.GetHeight()===t||(s.SetSize(e,t),s.SetBboxChanged())}getSize(){const e=this.#t;return[e.GetWidth(),e.GetHeight()]}get angle(){return this.#t.GetAngle()}set angle(e){e=bd.clampAngle(+e);const t=this.#t;isNaN(e)||t.GetAngle()===e||(t.SetAngle(e),t.SetBboxChanged())}get angleDegrees(){return bd.toDegrees(this.angle)}set angleDegrees(e){this.angle=bd.toRadians(e)}getBoundingBox(e){return e?(this.#t.CalculateBbox(Td,Cd,!1),Td.toDOMRect()):this.#t.GetBoundingBox().toDOMRect()}getBoundingQuad(e){return e?(this.#t.CalculateBbox(Td,Cd,!1),Cd.toDOMQuad()):this.#t.GetBoundingQuad().toDOMQuad()}isOnScreen(){return this.#t.IsInViewport2()}get isVisible(){return this.#t.IsVisible()}set isVisible(e){e=!!e;const t=this.#e,s=this.#t;s.IsVisible()!==e&&(s.SetVisible(e),t.GetRuntime().UpdateRender())}get opacity(){return this.#t.GetOpacity()}set opacity(e){e=bd.clamp(+e,0,1);const t=this.#e,s=this.#t;isNaN(e)||s.GetOpacity()===e||(s.SetOpacity(e),t.GetRuntime().UpdateRender())}set colorRgb(e){if(Gd.RequireArray(e),e.length<3)throw new Error("expected 3 elements");Dd.setRgb(e[0],e[1],e[2]);const t=this.#e,s=this.#t;s.GetUnpremultipliedColor().equalsIgnoringAlpha(Dd)||(s.SetUnpremultipliedColor(Dd),t.GetRuntime().UpdateRender())}get colorRgb(){const e=this.#t.GetUnpremultipliedColor();return[e.getR(),e.getG(),e.getB()]}set blendMode(e){Gd.RequireString(e);const t=Ad.get(e);if("number"!=typeof t)throw new Error("invalid blend mode");const s=this.#e;this.#t.SetBlendMode(t),s.GetRuntime().UpdateRender()}get blendMode(){return Rd.get(this.#t.GetBlendMode())}moveToTop(){this.#t.ZOrderMoveToTop()}moveToBottom(){this.#t.ZOrderMoveToBottom()}moveToLayer(e){Gd.RequireInstanceOf(e,xd);const t=this.#e,s=t.GetRuntime()._UnwrapScriptInterface(e);if(!s)throw new Error("invalid layer");t.GetWorldInfo().ZOrderMoveToLayer(s)}moveAdjacentToInstance(e,s){Gd.RequireInstanceOf(e,t),this.#t.ZOrderMoveAdjacentToInstance(wd.get(e),s)}get zIndex(){return this.#t.GetZIndex()}get isCollisionEnabled(){return this.#t.IsCollisionEnabled()}set isCollisionEnabled(e){this.#t.SetCollisionEnabled(!!e)}containsPoint(e,t){return Gd.RequireNumber(e),Gd.RequireNumber(t),this.#t.ContainsPoint(+e,+t)}testOverlap(e){Gd.RequireInstanceOf(e,t);const s=this.#e,n=wd.get(e);return s.GetRuntime().GetCollisionEngine().TestOverlap(s,n)}testOverlapSolid(){const e=this.#e,t=e.GetRuntime().GetCollisionEngine().TestOverlapSolid(e);return t?t.GetInterfaceClass():null}getParent(){const e=this.#e.GetParent();return e?e.GetInterfaceClass():null}getTopParent(){const e=this.#e.GetTopParent();return e?e.GetInterfaceClass():null}*parents(){for(const e of this.#e.parents())yield e.GetInterfaceClass()}getChildCount(){return this.#e.GetChildCount()}getChildAt(e){const t=this.#e.GetChildAt(e);return t?t.GetInterfaceClass():null}*children(){for(const e of this.#e.children())yield e.GetInterfaceClass()}*allChildren(){for(const e of this.#e.allChildren())yield e.GetInterfaceClass()}addChild(e,s){Gd.RequireInstanceOf(e,t),Gd.RequireOptionalObject(s),s||(s={});const n=this.#e,i=wd.get(e);n.AddChild(i,s)}removeChild(e){Gd.RequireInstanceOf(e,t);const s=this.#e,n=wd.get(e);s.RemoveChild(n)}removeFromParent(){const e=this.#e;e.HasParent()&&e.GetParent().RemoveChild(e)}getHierarchyOpts(){const e=this.#t;return{transformX:e.GetTransformWithParentX(),transformY:e.GetTransformWithParentY(),transformWidth:e.GetTransformWithParentWidth(),transformHeight:e.GetTransformWithParentHeight(),transformAngle:e.GetTransformWithParentAngle(),transformZElevation:e.GetTransformWithParentZElevation(),transformOpacity:e.GetTransformWithParentOpacity(),transformVisibility:e.GetTransformWithParentVisibility(),destroyWithParent:e.GetDestroyWithParent()}}createMesh(e,t){Gd.RequireFiniteNumber(e),Gd.RequireFiniteNumber(t),this.#t.CreateMesh(e,t)}releaseMesh(){const e=this.#t;e.ReleaseMesh(),e.SetBboxChanged()}setMeshPoint(e,t,s){Gd.RequireFiniteNumber(e),Gd.RequireFiniteNumber(t),Gd.RequireObject(s);const n=this.#t;n.SetMeshPoint(e,t,s)&&n.SetBboxChanged()}getMeshPoint(e,t){let s=NaN,n=NaN,i=NaN,r=NaN,a=NaN;const o=this.#t;if(o.HasMesh()){const l=o.GetSourceMesh().GetMeshPointAt(e,t);null!==l&&(s=l.GetX(),n=l.GetY(),i=l.GetZElevation(),r=l.GetU(),a=l.GetV())}return{x:s,y:n,zElevation:i,u:r,v:a}}getMeshSize(){const e=this.#t;if(!e.HasMesh())return[0,0];const t=e.GetSourceMesh();return[t.GetHSize(),t.GetVSize()]}}};MakeIWorldInstanceClass=yd;const bd=self.C3,Gd=self.C3X,vd=self.IInstance,xd=self.ILayer,Td=bd.New(bd.Rect),Cd=bd.New(bd.Quad),wd=new WeakMap,Pd=bd._GetInternalAPIToken(),Ad=new Map([["normal",0],["additive",1],["copy",3],["destination-over",4],["source-in",5],["destination-in",6],["source-out",7],["destination-out",8],["source-atop",9],["destination-atop",10]]),Rd=new Map([...Ad.entries()].map((e=>[e[1],e[0]]))),Dd=bd.New(bd.Color);self.IWorldInstance=yd(self.IInstance),self.IWorldInstanceSDKBase=yd(self.ISDKInstanceBase)}{const Ed=self.C3,Md=self.C3X;self.IDOMInstance=class extends self.IWorldInstance{#e;constructor(){super(),this.#e=self.IInstance._GetInitInst()}getElement(){return this.#e.GetSdkInstance()._GetElementInDOMMode()}focus(){this.#e.GetSdkInstance().FocusElement()}blur(){this.#e.GetSdkInstance().BlurElement()}setCssStyle(e,t){Md.RequireString(e),this.#e.GetSdkInstance().SetElementCSSStyle(e,t)}}}{let kd=function(e){let t=Bd.get(e);return t||(t=Ld.New(Ld.Event.Dispatcher),Bd.set(e,t),t)};GetDispatcher=kd;const Ld=self.C3,Fd=self.C3X,Bd=new WeakMap,Od=Ld._GetInternalAPIToken();self.IBehaviorInstance=class{#e;constructor(){const e=Ld.AddonManager._GetInitObject2(Od);this.#e=e;const t={runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},behavior:{value:e.GetBehavior().GetIBehavior(),writable:!1},behaviorType:{value:e.GetBehaviorType().GetIBehaviorType(),writable:!1}};Object.defineProperties(this,t),e.GetRuntime()._MapScriptInterface(this,e)}static _GetInitInst(){return Ld.AddonManager._GetInitObject()}get instance(){return this.#e.GetObjectInstance().GetInterfaceClass()}_release(){const e=Bd.get(this);e&&(e.Release(),Bd.delete(this))}addEventListener(e,t,s){Fd.RequireString(e),Fd.RequireFunction(t),kd(this).addEventListener(e,t,s)}removeEventListener(e,t,s){Fd.RequireString(e),Fd.RequireFunction(t),kd(this).removeEventListener(e,t,s)}dispatchEvent(e){kd(this).dispatchEvent(e)}}}{const Nd=self.C3,Wd=self.C3X,Vd=Nd._GetInternalAPIToken();self.IBehaviorType=class{constructor(){const e=Nd.AddonManager._GetInitObject2(Vd),t={runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},behavior:{value:e.GetBehavior().GetIBehavior(),writable:!1},name:{value:e.GetName(),writable:!1}};Object.defineProperties(this,t)}}}{const jd=self.C3,Ud=self.C3X,Hd=jd._GetInternalAPIToken();self.IBehavior=class{#t;constructor(){const e=jd.AddonManager._GetInitObject2(Hd);this.#t=e;const t={runtime:{value:e.GetRuntime().GetIRuntime(),writable:!1},id:{value:e.GetID(),writable:!1}};Object.defineProperties(this,t),e.GetRuntime()._MapScriptInterface(this,e)}getAllInstances(){return this.#t.GetInstances().map((e=>e.GetInterfaceClass()))}static getByConstructor(e){if(!e)return null;const t=jd.AddonManager.GetBehaviorByConstructorFunction(e);return t?t.GetIBehavior():null}}}{const zd=self.C3,Xd=self.C3X,Yd=zd.New(zd.Color);self.IEffectInstance=class{#e;constructor(e,t){this.#e=e;const s={index:{value:t,writable:!1}};Object.defineProperties(this,s)}get name(){return this.#e.GetAllEffectTypes()[this.index].GetName()}get isActive(){return this.#e.IsEffectIndexActive(this.index)}set isActive(e){e=!!e;const t=this.#e;t.IsEffectIndexActive(this.index)!==e&&(t.SetEffectIndexActive(this.index,e),t.UpdateActiveEffects(),t.GetRuntime().UpdateRender())}setParameter(e,t){Xd.RequireFiniteNumber(e),e=Math.floor(+e);const s=this.#e,n=s.GetEffectParameter(this.index,e);if(null===n)throw new RangeError("invalid index");if(n instanceof zd.Color){if(!Array.isArray(t)||t.length<3)throw new TypeError("expected array with 3 elements");Yd.setRgb(t[0],t[1],t[2]),t=Yd}else if("number"!=typeof t)throw new TypeError("expected number");s.SetEffectParameter(this.index,e,t)&&s.IsEffectIndexActive(this.index)&&s.GetRuntime().UpdateRender()}getParameter(e){Xd.RequireFiniteNumber(e),e=Math.floor(+e);const t=this.#e.GetEffectParameter(this.index,e);if(null===t)throw new RangeError("invalid index");return t instanceof zd.Color?[t.getR(),t.getG(),t.getB()]:t}}}{const qd=self.C3,Jd=self.C3X;self.IAnimation=class{#e;constructor(e){this.#e=e,Object.defineProperties(this,{name:{value:e.GetName(),writable:!1}})}get speed(){return this.#e.GetSpeed()}get isLooping(){return this.#e.IsLooping()}get repeatCount(){return this.#e.GetRepeatCount()}get repeatTo(){return this.#e.GetRepeatTo()}get isPingPong(){return this.#e.IsPingPong()}get frameCount(){return this.#e.GetFrameCount()}getFrames(){return this.#e.GetFrames().map((e=>e.GetIAnimationFrame()))}*frames(){for(const e of this.#e.GetFrames())yield e.GetIAnimationFrame()}}}{const Kd=self.C3,$d=self.C3X;self.IImageInfo=class{#t;constructor(e){this.#t=e}static _Unwrap(e){return e.#t}get width(){return this.#t.GetWidth()}get height(){return this.#t.GetHeight()}getSize(){const e=this.#t;return[e.GetWidth(),e.GetHeight()]}getTexture(e){return e.getTextureForImageInfo(this)}getTexRect(){return this.#t.GetTexRect().toDOMRect()}}}{const Zd=self.C3,Qd=self.C3X;self.IAnimationFrame=class extends self.IImageInfo{#t;constructor(e){super(e.GetImageInfo()),this.#t=e,Object.defineProperties(this,{duration:{value:e.GetDuration(),writable:!1},originX:{value:e.GetOriginX(),writable:!1},originY:{value:e.GetOriginY(),writable:!1}})}getOrigin(){const e=this.#t;return[e.GetOriginX(),e.GetOriginY()]}getImagePointCount(){return this.#t.GetImagePointCount()}getImagePointX(e){return this.getImagePoint(e)[0]}getImagePointY(e){return this.getImagePoint(e)[1]}getImagePoint(e){const t=this.#t;let s=null;if("number"==typeof e)s=t.GetImagePointByIndex(Math.floor(e));else{if("string"!=typeof e)throw new TypeError("expected string or number");s=t.GetImagePointByName(e)}return s?[s.GetX(),s.GetY()]:this.getOrigin()}getPolyPointCount(){const e=this.#t.GetCollisionPoly();return e?e.pointCount():0}getPolyPointX(e){return this.getPolyPoint(e)[0]}getPolyPointY(e){return this.getPolyPoint(e)[1]}getPolyPoint(e){Qd.RequireFiniteNumber(e),e=Math.floor(e);const t=this.#t.GetCollisionPoly();if(!t||e<0||e>=t.pointCount())return[0,0];const s=t.pointsArr();return[s[2*e],s[2*e+1]]}get tag(){return this.#t.GetTag()}}}{let ep=function(e){const t=np.get(e);if(t.IsReleased())throw new Error("timeline/tween was released and is no longer valid");return t};GetTimelineState=ep;const tp=self.C3,sp=self.C3X,np=new WeakMap;self.ITimelineStateBase=class{constructor(e){np.set(this,e),e.GetRuntime()._MapScriptInterface(this,e)}pause(){ep(this).Stop()}resume(){ep(this).Resume()}stop(){ep(this).Reset()}hasTags(e){return ep(this).HasTags(e)}set time(e){sp.RequireFiniteNumber(e),ep(this).SetTime(e)}get time(){return ep(this).GetTime()}set totalTime(e){sp.RequireFiniteNumber(e),ep(this).SetTotalTime(e)}get totalTime(){return ep(this).GetTotalTime()}set isLooping(e){ep(this).SetLoop(!!e)}get isLooping(){return ep(this).GetLoop()}set isPingPong(e){ep(this).SetPingPong(!!e)}get isPingPong(){return ep(this).GetPingPong()}set playbackRate(e){sp.RequireFiniteNumber(e),ep(this).SetPlaybackRate(e)}get playbackRate(){return ep(this).GetPlaybackRate()}get progress(){const e=ep(this);return e.GetTime()/e.GetTotalTime()}get tags(){return ep(this).GetTags()}get finished(){return ep(this).GetPlayPromise()}get isPlaying(){return ep(this).IsPlaying()}get isPaused(){return ep(this).IsPaused()}get isReleased(){return np.get(this).IsReleased()}}}{let ip=function(e){const t=op.get(e);if(t.IsReleased())throw new Error("timeline was released and is no longer valid");return t};GetTimelineState=ip;const rp=self.C3,ap=self.C3X,op=new WeakMap;let lp=null;self.ITimelineState=class extends self.ITimelineStateBase{constructor(e){super(e),op.set(this,e);const t={name:{value:e.GetName(),writable:!1}};Object.defineProperties(this,t)}}}{let cp=function(e){const t=up.get(e);if(t.IsReleased())throw new Error("tween was released and is no longer valid");return t};GetTweenState=cp;const hp=self.C3,_p=self.C3X,up=new WeakMap,dp=new WeakMap;let pp=null;self.ITweenState=class extends self.ITimelineStateBase{constructor(e,t,s){super(e),pp||(pp=s.easeToIndexFunc),up.set(this,e),t&&dp.set(this,t)}stop(){const e=cp(this);dp.get(this).ReleaseTween(e)}setEase(e){_p.RequireString(e);const t=self.Ease.GetEaseFromIndex(pp(e));cp(this).SetEase(t)}get instance(){const e=cp(this).GetInstance();return e?e.GetInterfaceClass():null}get isDestroyOnComplete(){return cp(this).GetDestroyInstanceOnComplete()}set isDestroyOnComplete(e){cp(this).SetDestroyInstanceOnComplete(!!e)}get value(){const e=cp(this);if("value"!==e.GetId())throw new Error("not a value tween");return e.GetPropertyTrack("value").GetSourceAdapterValue()}}}{const fp=self.C3,mp=self.C3X;self.ISDKPluginBase=class extends self.IPlugin{constructor(){super()}}}{const gp=self.C3,Ip=self.C3X,Sp=gp._GetInternalAPIToken();self.ISDKDOMPluginBase=class extends self.ISDKPluginBase{#e;#s;#t=0;#r=new Map;constructor(e){if(super(),this.#e=gp.AddonManager._GetInitObject2(Sp),!e?.domComponentId)throw new Error("no DOM component ID specified");this.#s=e.domComponentId,this._addElementMessageHandler("elem-focused",(e=>e._onElemFocused())),this._addElementMessageHandler("elem-blurred",(e=>{e&&e._onElemBlurred()}))}_addElement(e){const t=this.#t++;return this.#r.set(t,e),t}_removeElement(e){this.#r.delete(e)}_addElementMessageHandler(e,t){this.#e.GetRuntime().AddDOMComponentMessageHandler(this.#s,e,(e=>{const s=this.#r.get(e.elementId);t(s,e)}))}_addElementMessageHandlers(e){Ip.RequireArray(e);for(const[t,s]of e)this._addElementMessageHandlers(t,s)}}}{const yp=self.C3,bp=self.C3X,Gp=new WeakMap,vp=yp._GetInternalAPIToken();self.ISDKObjectTypeBase=class extends self.IObjectType{#e;constructor(){super(),this.#e=yp.AddonManager._GetInitObject2(vp)}_onCreate(){}getImageInfo(){return this.#e.GetImageInfo().GetIImageInfo()}_loadTextures(e){}_releaseTextures(e){}_onDynamicTextureLoadComplete(){}_preloadTexturesWithInstances(e){}}}{const xp=self.C3,Tp=self.C3X,Cp=new WeakMap,wp=xp._GetInternalAPIToken();self.ISDKWorldInstanceBase=class extends self.IWorldInstanceSDKBase{#e;#i=null;#t=null;constructor(e){super(e),this.#e=xp.AddonManager._GetInitObject2(wp)}_release(){if(super._release(),this.#i){const e=this.#e.GetRuntime().Dispatcher();e.removeEventListener("renderercontextlost",this.#i),e.removeEventListener("renderercontextrestored",this.#t),this.#i=null,this.#t=null}}_handleRendererContextLoss(){if(this.#i)return;this.#i=()=>this._onRendererContextLost(),this.#t=()=>this._onRendererContextRestored();const e=this.#e.GetRuntime().Dispatcher();e.addEventListener("renderercontextlost",this.#i),e.addEventListener("renderercontextrestored",this.#t)}_onRendererContextLost(){}_onRendererContextRestored(){}_draw(e){}}}{const Pp=self.C3,Ap=self.C3X,Rp=Pp.New(Pp.Rect),Dp=new WeakMap,Ep=Pp._GetInternalAPIToken();self.ISDKDOMInstanceBase=class extends self.ISDKWorldInstanceBase{#e=-1;#t=!0;#r=!1;#n=!1;#s=-.2;#a=Pp.New(Pp.Rect,0,0,-1,-1);#o=0;#l=0;#c=-1;#h=-1;#_=!1;constructor(e){if(!e?.domComponentId)throw new Error("no DOM component ID specified");super(e);const t=Pp.AddonManager._GetInitObject2(Ep);Dp.set(this,t),this.#e=this.plugin._addElement(this);const s=t.GetRuntime().GetCanvasManager();this.#o=s.GetLastWidth(),this.#l=s.GetLastHeight(),this._setTicking(!0)}_release(){super._release(),this.plugin._removeElement(this.#e),this._postToDOMElement("destroy"),this.#e=-1,Dp.delete(this)}_getElementInDOMMode(){if(Dp.get(this).GetRuntime().IsInWorker())throw new Error("not valid in worker mode");return this._postToDOMElementMaybeSync("get-element")}_postToDOMElement(e,t){t||(t={}),t.elementId=this.#e,this._postToDOM(e,t)}_postToDOMElementMaybeSync(e,t){return t||(t={}),t.elementId=this.#e,this._postToDOMMaybeSync(e,t)}_postToDOMElementAsync(e,t){return t||(t={}),t.elementId=this.#e,this._postToDOMAsync(e,t)}_createElement(e){e||(e={});const t=Dp.get(this).GetWorldInfo();e.elementId=this.#e,e.isVisible=t.IsVisible(),e.htmlIndex=t.GetLayer().GetHTMLIndex(),e.htmlZIndex=t.GetHTMLZIndex(),Object.assign(e,this._getElementState()),this.#t=!!e.isVisible,this._postToDOMMaybeSync("create",e),this._updatePosition(!0)}setElementVisible(e){e=!!e,this.#t!==e&&(this.#t=e,this._postToDOMElement("set-visible",{isVisible:e}))}_tick(){this._updatePosition(!1)}_shouldPreserveElement(){const e=Dp.get(this).GetRuntime().GetCanvasManager().GetFullscreenMode();return"Android"===Pp.Platform.OS&&("scale-inner"===e||"scale-outer"===e||"crop"===e)}_updatePosition(e){const t=Dp.get(this);if(t.IsDestroyed())return;const s=t.GetWorldInfo(),n=s.GetLayer(),i=s.GetBoundingBox();let[r,a]=n.LayerToCanvasCss(i.getLeft(),i.getTop()),[o,l]=n.LayerToCanvasCss(i.getRight(),i.getBottom());const c=t.GetRuntime().GetCanvasManager(),h=c.GetCssWidth(),_=c.GetCssHeight();if(!s.IsVisible()||!n.IsVisible())return void this.setElementVisible(!1);if(!this._shouldPreserveElement()&&(o<=0||l<=0||r>=h||a>=_))return void this.setElementVisible(!1);Rp.set(r,a,o,l);const u=c.GetLastWidth(),d=c.GetLastHeight(),p=n.GetHTMLIndex(),f=s.GetHTMLZIndex();if(!e&&Rp.equals(this.#a)&&this.#o===u&&this.#l===d&&this.#c===p&&this.#h===f)return void this.setElementVisible(!0);this.#a.copy(Rp),this.#o=u,this.#l=d,this.#c=p,this.#h=f,this.setElementVisible(!0);let m=null;this.#n&&(m=n.GetDisplayScale()+this.#s),this._postToDOMElement("update-position",{left:Math.round(this.#a.getLeft()),top:Math.round(this.#a.getTop()),width:Math.round(this.#a.width()),height:Math.round(this.#a.height()),htmlIndex:p,htmlZIndex:f,fontSize:m})}focusElement(){this._postToDOMElementMaybeSync("focus",{focus:!0})}blurElement(){this._postToDOMElementMaybeSync("focus",{focus:!1})}_onElemFocused(){this.#r=!0}_onElemBlurred(){this.#r=!1}isElementFocused(){return this.#r}setElementCSSStyle(e,t){this.postToDOMElement("set-css-style",{prop:Pp.CSSToCamelCase(e),val:t})}setElementAttribute(e,t){this.postToDOMElement("set-attribute",{name:e,val:t})}removeElementAttribute(e){this.postToDOMElement("remove-attribute",{name:e})}_updateElementState(){this.#_||(this.#_=!0,Promise.resolve().then((()=>{this.#_=!1,this._postToDOMElement("update-state",this._getElementState())})))}_getElementState(){}_getElementId(){return this.#e}}}{const Mp=self.C3,kp=self.C3X;self.ISDKBehaviorBase=class extends self.IBehavior{constructor(){super()}}}{const Lp=self.C3,Fp=self.C3X;self.ISDKBehaviorTypeBase=class extends globalThis.IBehaviorType{constructor(){super()}_onCreate(){}}}{const Bp=self.C3,Op=self.C3X,Np=new WeakMap,Wp=Bp._GetInternalAPIToken();self.ISDKBehaviorInstanceBase=class extends self.IBehaviorInstance{#n=!1;#t=!1;#e=!1;constructor(){super(),Np.set(this,Bp.AddonManager._GetInitObject2(Wp))}_release(){super._release(),this._setTicking(!1),this._setTicking2(!1),this._setPostTicking(!1),Np.delete(this)}_getInitProperties(){return Bp.AddonManager._GetInitProperties()}_postCreate(){}_trigger(e){const t=Np.get(this);t.GetRuntime().Trigger(e,t.GetObjectInstance(),t.GetBehaviorType())}_triggerAsync(e){const t=Np.get(this);return t.GetRuntime().TriggerAsync(e,t.GetObjectInstance(),t.GetBehaviorType())}_setTicking(e){if(e=!!e,this.#n===e)return;this.#n=e;const t=Np.get(this).GetRuntime();e?t._AddBehInstToTick(this):t._RemoveBehInstToTick(this)}_isTicking(){return this.#n}_tick(){}_setTicking2(e){if(e=!!e,this.#t===e)return;this.#t=e;const t=Np.get(this).GetRuntime();e?t._AddBehInstToTick2(this):t._RemoveBehInstToTick2(this)}_isTicking2(){return this.#t}_tick2(){}_setPostTicking(e){if(e=!!e,this.#e===e)return;this.#e=e;const t=Np.get(this).GetRuntime();e?t._AddBehInstToPostTick(this):t._RemoveBehInstToPostTick(this)}_isPostTicking(){return this.#e}_postTick(){}_getDebuggerProperties(){return[]}_saveToJson(){return null}_loadFromJson(e){}}}{const Vp=self.C3,jp=self.C3X;let Up=null;self.ISDKUtils=class{constructor(e){Up=e}addLoadPromise(e){Up.AddLoadPromise(e)}sendWrapperExtensionMessage(e,t,s){jp.RequireString(e),jp.RequireString(t),jp.RequireOptionalArray(s),Up.SendWrapperExtensionMessage(e,t,s)}sendWrapperExtensionMessageAsync(e,t,s){return jp.RequireString(e),jp.RequireString(t),jp.RequireOptionalArray(s),Up.SendWrapperExtensionMessageAsync(e,t,s)}createLoopingConditionContext(e){return jp.RequireOptionalString(e),new self.ILoopingConditionContext(Up,e)}set isAutoSuspendEnabled(e){Up._SetAutoSuspendEnabled(!!e)}get isAutoSuspendEnabled(){return Up._IsAutoSuspendEnabled()}setSuspended(e){Up.SetSuspended(!!e)}getObjectClassBySid(e){jp.RequireNumber(e);const t=Up.GetObjectClassBySID(e);return t?t.GetIObjectClass():null}}}{const Hp=self.C3,zp=self.C3X;self.ILoopingConditionContext=class{#e;#t;#a;#s;#r;#i;constructor(e,t){this.#e=e;const s=e.GetEventSheetManager(),n=e.GetCurrentEvent();this.#t=n,this.#a=n.GetSolModifiers();const i=e.GetEventStack();this.#s=i.GetCurrentStackFrame(),this.#r=i.Push(n);const r=s.GetLoopStack().Push();this.#i=r,t&&r.SetName(t),e.SetDebuggingEnabled(!1)}retrigger(){const e=this.#e.GetEventSheetManager(),t=this.#a,s=this.#i;e.PushCopySol(t),this.#t.Retrigger(this.#s,this.#r),e.PopSol(t),s.SetIndex(s.GetIndex()+1)}get isStopped(){return this.#i.IsStopped()}release(){const e=this.#e,t=e.GetEventStack(),s=e.GetEventSheetManager().GetLoopStack();e.SetDebuggingEnabled(!0),s.Pop(),t.Pop()}}}{const Xp=self.C3,Yp=self.C3X;let qp=null,Jp=null;self.IRenderer=class{constructor(e,t){Jp=e,qp=t}setAlphaBlendMode(){qp.SetAlphaBlend()}setBlendMode(e){qp.SetNamedBlendMode(e)}setColorFillMode(){qp.SetColorFillMode()}setTextureFillMode(){qp.SetTextureFillMode()}setSmoothLineFillMode(){qp.SetSmoothLineFillMode()}setColor(e){qp.SetColorRgba(e[0],e[1],e[2],e[3])}setColorRgba(e,t,s,n){qp.SetColorRgba(e,t,s,n)}resetColor(){qp.ResetColor()}setOpacity(e){qp.SetOpacity(e)}setCurrentZ(e){qp.SetCurrentZ(e)}getCurrentZ(){qp.GetCurrentZ()}rect(e){qp.Rect2(e.left,e.top,e.right,e.bottom)}rect2(e,t,s,n){qp.Rect2(e,t,s,n)}quad(e){qp.Quad(Xp.Quad.fromDOMQuad(e))}quad2(e,t,s,n,i,r,a,o){qp.Quad2(e,t,s,n,i,r,a,o)}quad3(e,t){qp.Quad3(Xp.Quad.fromDOMQuad(e),Xp.Rect.fromDOMRect(t))}quad4(e,t){qp.Quad4(Xp.Quad.fromDOMQuad(e),Xp.Quad.fromDOMQuad(t))}quad3D(e,t,s,n,i,r,a,o,l,c,h,_,u){qp.Quad3D(e,t,s,n,i,r,a,o,l,c,h,_,Xp.Rect.fromDOMRect(u))}quad3D2(e,t,s,n,i,r,a,o,l,c,h,_,u){qp.Quad3D2(e,t,s,n,i,r,a,o,l,c,h,_,Xp.Quad.fromDOMQuad(u))}drawMesh(e,t,s){qp.DrawMesh(e,t,s)}convexPoly(e){qp.ConvexPoly(e)}line(e,t,s,n){qp.Line(e,t,s,n)}texturedLine(e,t,s,n,i,r){qp.TexturedLine(e,t,s,n,i,r)}lineRect(e,t,s,n){qp.LineRect(e,t,s,n)}lineRect2(e){qp.LineRect2(Xp.Rect.fromDOMRect(e))}lineQuad(e){qp.LineQuad(Xp.Quad.fromDOMQuad(e))}pushLineWidth(e){qp.PushLineWidth(e)}popLineWidth(){qp.PopLineWidth()}pushLineCap(e){qp.PushLineCap(e)}popLineCap(){qp.PopLineCap()}setTexture(e){Yp.RequireOptionalInstanceOf(e,self.ITexture);const t=e?Jp._UnwrapScriptInterface(e):null;qp.SetTexture(t)}loadTextureForImageInfo(e,t){const s=self.IImageInfo._Unwrap(e);if(!s)throw new Error("invalid IImageInfo");return s.LoadStaticTexture(qp,{wrapX:t?.wrapX??"clamp-to-edge",wrapY:t?.wrapY??"clamp-to-edge",sampling:t?.sampling??"trilinear",mipMap:t?.mipMap??!0})}releaseTextureForImageInfo(e){const t=self.IImageInfo._Unwrap(e);if(!t)throw new Error("invalid IImageInfo");t.ReleaseTexture()}getTextureForImageInfo(e){const t=self.IImageInfo._Unwrap(e);if(!t)throw new Error("invalid IImageInfo");const s=t.GetTexture();return self.ITexture.GetInterface(Jp,s)}createDynamicTexture(e,t,s){Yp.RequireFiniteNumber(e),Yp.RequireFiniteNumber(t);const n=qp.CreateDynamicTexture(e,t,{wrapX:s?.wrapX??"clamp-to-edge",wrapY:s?.wrapY??"clamp-to-edge",sampling:s?.sampling??"trilinear",mipMap:s?.mipMap??!0});return self.ITexture.GetInterface(Jp,n)}updateTexture(e,t,s){Yp.RequireInstanceOf(t,self.ITexture);const n=Jp._UnwrapScriptInterface(t);qp.UpdateTexture(e,n,{premultiplyAlpha:s?.premultiplyAlpha??!0})}deleteTexture(e){Yp.RequireInstanceOf(e,self.ITexture);const t=Jp._UnwrapScriptInterface(e);qp.DeleteTexture(t)}createRendererText(){const e=qp.CreateRendererText();return new self.IRendererText(Jp,e)}setDeviceTransform(){Jp.GetCanvasManager().SetDeviceTransform(qp)}setLayerTransform(e){Yp.RequireInstanceOf(e,globalThis.ILayer),Jp._UnwrapScriptInterface(e)._SetTransform(qp)}}}{const Kp=self.C3,$p=self.C3X,Zp=new WeakMap,Qp=new WeakMap;self.ITexture=class{constructor(e,t){Zp.set(this,{runtime:e,texture:t}),Qp.set(t,this),e._MapScriptInterface(this,t),Object.defineProperties(this,{width:{value:t.GetWidth(),writable:!1},height:{value:t.GetHeight(),writable:!1}})}static GetInterface(e,t){if(!t)return null;return Qp.get(t)||new self.ITexture(e,t)}}}{let ef=function(e){return nf.get(e).rendererText};getActual=ef;const tf=self.C3,sf=self.C3X,nf=new WeakMap;self.IRendererText=class{constructor(e,t){nf.set(this,{runtime:e,rendererText:t}),e._MapScriptInterface(this,t)}release(){ef(this).Release()}set fontFace(e){sf.RequireString(e),ef(this).SetFontName(e)}get fontFace(){return ef(this).GetFontName()}set sizePt(e){sf.RequireFiniteNumber(e),ef(this).SetFontSize(e)}get sizePt(){return ef(this).GetFontSize()}set lineHeight(e){sf.RequireFiniteNumber(e),ef(this).SetLineHeight(e)}get lineHeight(){return ef(this).GetLineHeight()}set isBold(e){ef(this).SetBold(e)}get isBold(){return ef(this).IsBold()}set isItalic(e){ef(this).SetItalic(e)}get isItalic(){return ef(this).IsItalic()}setColor(e){sf.RequireArray(e),this.setColorRgb(e[0],e[1],e[2])}setColorRgb(e,t,s){ef(this).SetColorRgb(e,t,s)}setCssColor(e){sf.RequireString(e),ef(this).SetColor(e)}set horizontalAlign(e){ef(this).SetHorizontalAlignment(e)}get horizontalAlign(){return ef(this).GetHorizontalAlignment()}set verticalAlign(e){ef(this).SetVerticalAlignment(e)}get verticalAlign(){return ef(this).GetVerticalAlignment()}set wordWrapMode(e){ef(this).SetWordWrapMode(e)}get wordWrapMode(){return ef(this).GetWordWrapMode()}set textDirection(e){ef(this).SetTextDirection(e)}get textDirection(){return ef(this).GetTextDirection()}set text(e){sf.RequireString(e),ef(this).SetText(e)}get text(){return ef(this).GetText()}setSize(e,t,s){sf.RequireFiniteNumber(e),sf.RequireFiniteNumber(t),sf.RequireFiniteNumber(s),ef(this).SetSize(e,t,s)}getTexture(){const{runtime:e,rendererText:t}=nf.get(this),s=t.GetTexture();return self.ITexture.GetInterface(e,s)}getTexRect(){return ef(this).GetTexRect().toDOMRect()}setTextureUpdateCallback(e){sf.RequireFunction(e),ef(this).ontextureupdate=e}releaseTexture(){ef(this).ReleaseTexture()}get textWidth(){return ef(this).GetTextWidth()}get textHeight(){return ef(this).GetTextHeight()}}}{let rf=function(e){if(!e)return"";const t=e.split(".");if(t.length<2)return"";const s=t.at(-1).toLowerCase();return cf.get(s)||""},af=function(e){return new Promise(((t,s)=>{const n=document.createElement("script");n.onload=t,n.onerror=s,n.async=!1,n.type="module",n.src=e,document.head.appendChild(n)}))};GetTypeFromFileExtension=rf,AddScript=af;const of=self.C3,lf=new Set(["local","remote"]),cf=new Map([["mp4","video/mp4"],["webm","video/webm"],["m4a","audio/mp4"],["mp3","audio/mpeg"],["js","application/javascript"],["wasm","application/wasm"],["svg","image/svg+xml"],["html","text/html"]]);of.AssetManager=class extends of.DefendedBase{constructor(e,t){super();const s=t.exportType;this._runtime=e,this._fileStructure="folders",this._cordovaBlobUrlCache=new Map,this._isCordova="cordova"===s,this._isiOSCordova=!!t.isiOSCordova,this._isFileProtocol=!!t.isFileProtocol,this._swClientId=t.swClientId,this._supportedAudioFormats=t.supportedAudioFormats||{},this._audioFiles=new Map,this._preloadSounds=!1,this._scriptSubfolder=t.scriptFolder,this._mediaSubfolder="",this._fontsSubfolder="",this._iconsSubfolder="",this._fileMap=t.fileMap||new Map,this._fileMapBlobUrls=new Map;const n="html5"===s||"scirra-arcade"===s||"instant-games"===s;this._defaultLoadPolicy=n?"remote":"local",this._imageAssetsMap=new Map,this._webFonts=[],this._loadPromises=[],this._hasFinishedInitialLoad=!1,this._totalAssetSizeToLoad=0,this._assetSizeLoaded=0,this._lastLoadProgress=0,this._hasHadErrorLoading=!1,this._loadingRateLimiter=of.New(of.RateLimiter,(()=>this._FireLoadingProgressEvent()),50),this._localPromiseThrottle=of.New(of.PromiseThrottle,Math.max(of.hardwareConcurrency,8)),this._remotePromiseThrottle=of.New(of.PromiseThrottle,20),this._iAssetManager=new self.IAssetManager(this)}Release(){for(const e of this._imageAssetsMap.values())e.Release();this._imageAssetsMap.clear(),of.clearArray(this._loadPromises),this._runtime=null}GetRuntime(){return this._runtime}_SetFileStructure(e){this._fileStructure=e}GetFileStructure(){return this._fileStructure}GetScriptSubfolder(){return this._scriptSubfolder}_SetMediaSubfolder(e){this._mediaSubfolder=e}GetMediaSubfolder(){return this._mediaSubfolder}_SetFontsSubfolder(e){this._fontsSubfolder=e}GetFontsSubfolder(){return this._fontsSubfolder}_SetIconsSubfolder(e){this._iconsSubfolder=e}GetIconsSubfolder(){return this._iconsSubfolder}IsFileProtocol(){return this._isFileProtocol}FetchBlob(e,t){return t=t||this._defaultLoadPolicy,of.IsRelativeURL(e)?("flat"===this._fileStructure&&(e=e.toLowerCase()),this._isCordova&&this._isFileProtocol?this.CordovaFetchLocalFileAsBlob(e):"playable-ad-single-file"===this._runtime.GetExportType()?self.c3_runtimeInterface._PlayableAdFetchBlob(e):"local"===t?this._localPromiseThrottle.Add((()=>of.FetchBlob(e))):this._remotePromiseThrottle.Add((()=>of.FetchBlob(e)))):of.FetchBlob(e)}FetchArrayBuffer(e){return of.IsRelativeURL(e)?("flat"===this._fileStructure&&(e=e.toLowerCase()),this._isCordova&&this._isFileProtocol?this.CordovaFetchLocalFileAsArrayBuffer(e):"playable-ad-single-file"===this._runtime.GetExportType()?of.BlobToArrayBuffer(self.c3_runtimeInterface._PlayableAdFetchBlob(e)):"local"===this._defaultLoadPolicy?this._localPromiseThrottle.Add((()=>of.FetchArrayBuffer(e))):this._remotePromiseThrottle.Add((()=>of.FetchArrayBuffer(e)))):of.FetchArrayBuffer(e)}FetchText(e){return of.IsRelativeURL(e)?("flat"===this._fileStructure&&(e=e.toLowerCase()),this._isCordova&&this._isFileProtocol?this.CordovaFetchLocalFileAsText(e):"playable-ad-single-file"===this._runtime.GetExportType()?of.BlobToString(self.c3_runtimeInterface._PlayableAdFetchBlob(e)):"local"===this._defaultLoadPolicy?this._localPromiseThrottle.Add((()=>of.FetchText(e))):this._remotePromiseThrottle.Add((()=>of.FetchText(e)))):of.FetchText(e)}async FetchJson(e){const t=await this.FetchText(e);return JSON.parse(t)}_CordovaFetchLocalFileAs(e,t){return"flat"===this._fileStructure&&(e=e.toLowerCase()),this._runtime.PostComponentMessageToDOMAsync("runtime","cordova-fetch-local-file",{filename:e,as:t})}CordovaFetchLocalFileAsText(e){return this._CordovaFetchLocalFileAs(e,"text")}async CordovaFetchLocalFileAsBlob(e){const t=await this._CordovaFetchLocalFileAs(e,"buffer"),s=rf(e);return new Blob([t],{type:s})}async CordovaFetchLocalFileAsBlobURL(e){"flat"===this._fileStructure&&(e=e.toLowerCase());let t=this._cordovaBlobUrlCache.get(e);if(t)return t;const s=await this.CordovaFetchLocalFileAsBlob(e);return t=URL.createObjectURL(s),this._cordovaBlobUrlCache.set(e,t),t}CordovaFetchLocalFileAsArrayBuffer(e){return this._CordovaFetchLocalFileAs(e,"buffer")}GetMediaFileUrl(e){"flat"===this._fileStructure&&(e=e.toLowerCase());let t=this._mediaSubfolder+e;return"Gecko"===of.Platform.BrowserEngine&&"preview"===this._runtime.GetExportType()&&(t=this._GetLocalBlobURLFromFileMap(t)),t}GetProjectFileUrl(e){return of.IsAbsoluteURL(e)?Promise.resolve(e):this._isCordova&&this._isFileProtocol?this.CordovaFetchLocalFileAsBlobURL(e):"playable-ad-single-file"===this._runtime.GetExportType()?URL.createObjectURL(self.c3_runtimeInterface._PlayableAdFetchBlob(e)):("flat"===this._fileStructure&&(e=e.toLowerCase()),Promise.resolve(e))}GetProjectFileIframeUrl(e){if(of.IsAbsoluteURL(e)||"preview"!==this._runtime.GetExportType()||!this._swClientId||!e)return e;try{const t=new URL(e,location.href);return t.searchParams.set("__c3_client_id",this._swClientId),t.toString()}catch(t){return console.warn("Invalid iframe URL: "+e),e}}LoadProjectFileUrl(e){return this.GetProjectFileUrl(e)}_GetImageAssetKey(e,t){return(t?"true":"false")+"|"+e}LoadImage(e){const t=!!e.isTiled;if(e.loadPolicy&&!lf.has(e.loadPolicy))throw new Error("invalid load policy");const s=this._GetImageAssetKey(e.url,t);let n=this._imageAssetsMap.get(s);return n||(n=of.New(of.ImageAsset,this,{url:e.url,size:e.size||0,loadPolicy:e.loadPolicy||this._defaultLoadPolicy,isTiled:t}),this._imageAssetsMap.set(s,n),this._hasFinishedInitialLoad||(this._totalAssetSizeToLoad+=n.GetSize(),this._loadPromises.push(n.Load().then((()=>this._AddLoadedSize(n.GetSize()))))),n)}_ReleaseImageAsset(e){const t=this._GetImageAssetKey(e.GetURL(),e.IsTiled());this._imageAssetsMap.delete(t)}async WaitForAllToLoad(){try{await Promise.all(this._loadPromises),this._lastLoadProgress=1}catch(e){console.error("Error loading: ",e),this._hasHadErrorLoading=!0,this._FireLoadingProgressEvent()}}SetInitialLoadFinished(){this._hasFinishedInitialLoad=!0}HasHadErrorLoading(){return this._hasHadErrorLoading}_AddLoadedSize(e){this._assetSizeLoaded+=e,this._loadingRateLimiter.Call()}_FireLoadingProgressEvent(){const e=of.New(of.Event,"loadingprogress");this._lastLoadProgress=of.clamp(this._assetSizeLoaded/this._totalAssetSizeToLoad,0,1),e.progress=this._lastLoadProgress,this._runtime.Dispatcher().dispatchEvent(e),this._runtime.DispatchUserScriptEvent(of.New(of.Event,"loadingprogress"))}GetLoadProgress(){return this._lastLoadProgress}GetImageLoadProgress(){return this._runtime.GetSystemPlugin().GetImageLoadingProgress()}_SetWebFonts(e){of.shallowAssignArray(this._webFonts,e),this._webFonts.length&&this._loadPromises.push(this._LoadWebFonts())}async _LoadWebFonts(){const e=[],t=[];for(const[s,n,i]of this._webFonts)this._totalAssetSizeToLoad+=i,e.push(this._LoadWebFont(s,n,t).then((()=>this._AddLoadedSize(i))));await Promise.all(e),this._runtime.IsInWorker()&&t.length>0&&await this._runtime.PostComponentMessageToDOMAsync("runtime","load-webfonts",{webfonts:t})}async _LoadWebFont(e,t,s){try{let n=await this.GetProjectFileUrl(t);"Gecko"===of.Platform.BrowserEngine&&(e=`'${e}'`),("Gecko"===of.Platform.BrowserEngine&&"preview"===this._runtime.GetExportType()||"playable-ad-single-file"===this._runtime.GetExportType())&&(n=this._GetLocalBlobURLFromFileMap(n));const i=new FontFace(e,`url('${n}')`);this._runtime.IsInWorker()?self.fonts.add(i):document.fonts.add(i),await i.load(),this._runtime.IsInWorker()&&s.push({name:e,url:n})}catch(t){console.warn(`[C3 runtime] Failed to load web font '${e}': `,t)}}IsAudioFormatSupported(e){return!!this._supportedAudioFormats[e]}_SetAudioFiles(e,t){this._preloadSounds=!!t;for(const[t,s,n]of e)this._audioFiles.set(t,{fileName:t,formats:s.map((e=>({type:e[0],fileExtension:e[1],fullName:t+e[1],fileSize:e[2]}))),isMusic:n})}GetPreferredAudioFile(e){"flat"===this._fileStructure&&(e=e.toLowerCase());const t=this._audioFiles.get(e);if(!t)return null;let s=null;for(const e of t.formats)if(s||"audio/webm; codecs=opus"!==e.type||(s=e),this.IsAudioFormatSupported(e.type))return e;return s}GetProjectAudioFileUrl(e){const t=this.GetPreferredAudioFile(e);return t?{url:this.GetMediaFileUrl(t.fullName),type:t.type}:null}GetAudioToPreload(){if(this._preloadSounds){const e=[];for(const t of this._audioFiles.values()){if(t.isMusic)continue;const s=this.GetPreferredAudioFile(t.fileName);s&&e.push({originalUrl:t.fileName,url:this.GetMediaFileUrl(s.fullName),type:s.type,fileSize:s.fileSize})}return e}return[]}_GetLocalBlobFromFileMap(e){return"preview"===this._runtime.GetExportType()&&(e=new URL(e,location.href).toString()),this._fileMap.get(e)||null}_GetLocalBlobURLFromFileMap(e){let t=this._fileMapBlobUrls.get(e);if(t)return t;const s=this._GetLocalBlobFromFileMap(e);return s?(t=URL.createObjectURL(s),this._fileMapBlobUrls.set(e,t),t):e}GetIAssetManager(){return this._iAssetManager}async LoadScripts(...e){const t=await Promise.all(e.map((e=>this.GetProjectFileUrl(e))));if(this._runtime.IsInWorker())if(1===e.length){const t=e[0];await import((of.IsRelativeURL(t)?"./":"")+t)}else{const t=e.map((e=>`import "${of.IsRelativeURL(e)?"./":""}${e}";`)).join("\n"),s=URL.createObjectURL(new Blob([t],{type:"application/javascript"}));await import(s)}else await Promise.all(t.map((e=>af(e))))}async CompileWebAssembly(e){if(WebAssembly.compileStreaming){const t=await this.GetProjectFileUrl(e);return await WebAssembly.compileStreaming(fetch(t))}{const t=await of.FetchArrayBuffer(e);return await WebAssembly.compile(t)}}async LoadStyleSheet(e){const t=await this.GetProjectFileUrl(e);return await this._runtime.PostComponentMessageToDOMAsync("runtime","add-stylesheet",{url:t})}}}{const hf=self.C3;hf.Asset=class extends hf.DefendedBase{constructor(e,t){super(),this._assetManager=e,this._runtime=e.GetRuntime(),this._url=t.url||"",this._size=t.size,this._loadPolicy=t.loadPolicy,this._blob=t.blob||null,this._isLoaded=!!this._blob,this._loadPromise=null}Release(){this._loadPromise=null,this._assetManager=null,this._runtime=null,this._blob=null}GetURL(){return this._url}GetSize(){return this._size}Load(){return"local"===this._loadPolicy||this._blob?(this._isLoaded=!0,Promise.resolve()):(this._loadPromise||(this._loadPromise=this._assetManager.FetchBlob(this._url,this._loadPolicy).then((e=>(this._isLoaded=!0,this._loadPromise=null,this._blob=e,e))).catch((e=>{console.error("Error loading resource: ",e),this._loadPromise=null}))),this._loadPromise)}IsLoaded(){return this._isLoaded}GetBlob(){return this._blob?Promise.resolve(this._blob):this._loadPromise?this._loadPromise:this._assetManager.FetchBlob(this._url,this._loadPolicy)}}}{const _f=self.C3,uf=new _f.PromiseThrottle,df=new Set;_f.ImageAsset=class extends _f.Asset{constructor(e,t){super(e,t),this._texturePromise=null,this._webglTexture=null,this._refCount=0,this._imageWidth=-1,this._imageHeight=-1,this._isTiled=!!t.isTiled,df.add(this)}Release(){if(0!==this._refCount)throw new Error("released image asset which still has texture references");this._assetManager._ReleaseImageAsset(this),this._texturePromise=null,df.delete(this),super.Release()}static OnRendererContextLost(){for(const e of df)e._texturePromise=null,e._webglTexture=null,e._refCount=0}LoadStaticTexture(e,t){return t=t||{},this._refCount++,this._webglTexture?Promise.resolve(this._webglTexture):(this._texturePromise||(t.anisotropy=this._runtime.GetCanvasManager().GetTextureAnisotropy(),this._texturePromise=this._DoLoadStaticTexture(e,t)),this._texturePromise)}async _DoLoadStaticTexture(e,t){try{const s=await this.GetBlob();return 0===this._refCount?(this._texturePromise=null,null):await uf.Add((async()=>{const n=await e.CreateStaticTextureAsync(s,t);return this._texturePromise=null,0===this._refCount?(e.DeleteTexture(n),null):(this._webglTexture=n,this._imageWidth=n.GetWidth(),this._imageHeight=n.GetHeight(),this._webglTexture)}))}catch(e){throw console.error("Failed to load texture: ",e),e}}ReleaseTexture(){if(this._refCount<=0)throw new Error("texture released too many times");this._refCount--,0===this._refCount&&this._webglTexture&&(this._webglTexture.GetRenderer().DeleteTexture(this._webglTexture),this._webglTexture=null)}GetRefCount(){return this._refCount}GetTexture(){return this._webglTexture}GetWidth(){return this._imageWidth}GetHeight(){return this._imageHeight}IsTiled(){return this._isTiled}async LoadToDrawable(){const e=await this.GetBlob();return _f.Supports.ImageBitmap?await createImageBitmap(e):await _f.BlobToImage(e)}}}{let pf=function(e,t){return e.GetWorldInfo()._GetLastCachedZIndex()-t.GetWorldInfo()._GetLastCachedZIndex()};SortByInstLastCachedZIndex=pf;const ff=self.C3,mf=self.assert;ff.RenderCell=class extends ff.DefendedBase{constructor(e,t,s){super(),this._grid=e,this._x=t,this._y=s,this._instances=[],this._isSorted=!0,this._pendingRemoval=new Set,this._isAnyPendingRemoval=!1}Release(){ff.clearArray(this._instances),this._pendingRemoval.clear(),this._grid=null}Reset(){ff.clearArray(this._instances),this._isSorted=!0,this._pendingRemoval.clear(),this._isAnyPendingRemoval=!1}SetChanged(){this._isSorted=!1}IsEmpty(){return!this._instances.length||!(this._instances.length>this._pendingRemoval.size)&&(this._FlushPending(),!0)}Insert(e){if(this._pendingRemoval.has(e))return this._pendingRemoval.delete(e),void(0===this._pendingRemoval.size&&(this._isAnyPendingRemoval=!1));this._instances.push(e),this._isSorted=1===this._instances.length}Remove(e){this._pendingRemoval.add(e),this._isAnyPendingRemoval=!0,this._pendingRemoval.size>=50&&this._FlushPending()}_FlushPending(){this._isAnyPendingRemoval&&(this._instances.length!==this._pendingRemoval.size?(ff.arrayRemoveAllInSet(this._instances,this._pendingRemoval),this._pendingRemoval.clear(),this._isAnyPendingRemoval=!1):this.Reset())}_EnsureSorted(){this._isSorted||(this._instances.sort(pf),this._isSorted=!0)}Dump(e){this._FlushPending(),this._EnsureSorted(),this._instances.length&&e.push(this._instances)}}}{const gf=self.C3;gf.RenderGrid=class extends gf.DefendedBase{constructor(e,t){super(),this._cellWidth=e,this._cellHeight=t,this._cells=gf.New(gf.PairMap)}Release(){this._cells.Release(),this._cells=null}GetCell(e,t,s){let n=this._cells.Get(e,t);return n||(s?(n=gf.New(gf.RenderCell,this,e,t),this._cells.Set(e,t,n),n):null)}XToCell(e){return Math.floor(e/this._cellWidth)}YToCell(e){return Math.floor(e/this._cellHeight)}Update(e,t,s){if(t)for(let n=t.getLeft(),i=t.getRight();n<=i;++n)for(let i=t.getTop(),r=t.getBottom();i<=r;++i){if(s&&s.containsPoint(n,i))continue;const t=this.GetCell(n,i,!1);t&&(t.Remove(e),t.IsEmpty()&&this._cells.Delete(n,i))}if(s)for(let n=s.getLeft(),i=s.getRight();n<=i;++n)for(let i=s.getTop(),r=s.getBottom();i<=r;++i)t&&t.containsPoint(n,i)||this.GetCell(n,i,!0).Insert(e)}QueryRange(e,t){let s=this.XToCell(e.getLeft());const n=this.YToCell(e.getTop()),i=this.XToCell(e.getRight()),r=this.YToCell(e.getBottom());for(;s<=i;++s)for(let e=n;e<=r;++e){const n=this.GetCell(s,e,!1);n&&n.Dump(t)}}MarkRangeChanged(e){let t=e.getLeft();const s=e.getTop(),n=e.getRight(),i=e.getBottom();for(;t<=n;++t)for(let e=s;e<=i;++e){const s=this.GetCell(t,e,!1);s&&s.SetChanged()}}}}{let If=function(e,t){return e.GetWorldInfo()._GetLastCachedZIndex()-t.GetWorldInfo()._GetLastCachedZIndex()},Sf=function(e,t){return e.GetWorldInfo().GetZElevation()-t.GetWorldInfo().GetZElevation()};SortByInstLastCachedZIndex=If,SortByInstZElevation=Sf;const yf=self.C3,bf=self.assert,Gf=new yf.Rect,vf=new yf.Quad,xf=[],Tf=new yf.Rect,Cf=new yf.Rect,wf=self.glMatrix,Pf=wf.vec3,Af=wf.vec4,Rf=wf.mat4,Df=Rf.create(),Ef=Pf.create(),Mf=Af.create(),kf=Pf.create(),Lf=Pf.create(),Ff=Pf.create(),Bf=yf.New(yf.Vector2),Of=yf.New(yf.Rect),Nf=[],Wf=[],Vf=[],jf={name:"",sid:-1,isDynamic:!1,isVisible:!0,isInteractive:!0,isHTMLElementsLayer:!1,backgroundColor:[1,1,1,1],isTransparent:!0,parallax:[1,1],opacity:1,isForceOwnTexture:!1,renderAs3d:!1,useCameraDistanceDrawOrder:!1,useRenderCells:!1,scaleRate:1,blendMode:0,zElevation:0,initialInstancesData:[],effectListData:[],subLayersData:[]};yf.Layer=class extends yf.DefendedBase{constructor(e,t,s){super(),s=Object.assign({},jf,s),this._layout=e,this._runtime=e.GetRuntime(),this._parentLayer=t,this._name=s.name,this._index=-1,this._isHTMLElementsLayer=!!s.isHTMLElementsLayer,this._htmlIndex=-1,this._sid=s.sid,this._isDynamic=!!s.isDynamic,this._isVisible=!!s.isVisible,this._isInteractive=!!s.isInteractive,this._backgroundColor=yf.New(yf.Color),this._backgroundColor.setFromJSON(s.backgroundColor),this._isTransparent=!!s.isTransparent,this._parallaxX=s.parallax[0],this._parallaxY=s.parallax[1],this._color=yf.New(yf.Color,1,1,1,s.opacity),this._premultipliedColor=yf.New(yf.Color),this._isForceOwnTexture=!!s.isForceOwnTexture,this._renderAs3d=!!s.renderAs3d,this._useCameraDistanceDrawOrder=!!s.useCameraDistanceDrawOrder,this._useRenderCells=!!s.useRenderCells,this._scaleRate=s.scaleRate,this._blendMode=s.blendMode,this._curRenderTarget=null,this._scale=1,this._zElevation=s.zElevation,this._angle=0,this._scrollX=0,this._scrollY=0,this._hasOwnScrollPosition=!1,this._viewport=yf.New(yf.Rect),this._viewportZ0=yf.New(yf.Rect),this._viewport3D=yf.New(yf.Rect),this._isViewportChanged=!0,this._projectionMatrix=Rf.create(),this._isProjectionMatrixChanged=!0,this._modelViewMatrix=Rf.create(),this._isMVMatrixChanged=!0,this._viewFrustum=yf.New(yf.Gfx.ViewFrustum),this._isViewFrustumChanged=!0,this._startupInitialInstances=[],this._initialInstancesData=s.initialInstancesData,this._initialInstances=[],this._createdGlobalUids=[],this._initialUIDsToInstanceData=new Map,this._instances=[],this._zIndicesUpToDate=!1,this._htmlZIndicesUpToDate=!1,this._anyInstanceZElevated=!1;const n=this._runtime.GetCanvasManager();this._effectList=yf.New(yf.EffectList,this,s.effectListData),this._effectChain=yf.New(yf.Gfx.EffectChain,n.GetEffectChainManager(),{drawContent:(e,t)=>{const s=t.GetContentObject(),i=s.GetRenderTarget();e.SetColor(s.GetPremultipliedColor()),e.DrawRenderTarget(i),e.InvalidateRenderTarget(i),n.ReleaseAdditionalRenderTarget(i)},getShaderParameters:e=>this.GetEffectList()._GetEffectChainShaderParametersForIndex(e)}),this._needsRebuildEffectChainSteps=!0,this._wasDefaultColor=!0,this._renderGrid=null,this._lastRenderList=[],this._isRenderListUpToDate=!1,this._lastRenderCells=yf.New(yf.Rect,0,0,-1,-1),this._curRenderCells=yf.New(yf.Rect,0,0,-1,-1),this._iLayer=new self.ILayer(this),this._UpdatePremultipliedColor(),this.UsesRenderCells()&&(this._renderGrid=yf.New(yf.RenderGrid,this._runtime.GetOriginalViewportWidth(),this._runtime.GetOriginalViewportHeight())),this._subLayers=s.subLayersData.map((e=>yf.Layer.CreateFromExportData(this._layout,this,e)))}_InitInitialInstances(){for(const e of this._initialInstancesData){const t=this._runtime.GetObjectClassByIndex(e[1]);this._layout._AddInitialObjectClass(t),t.GetDefaultInstanceData()||(t.SetDefaultInstanceData(e),t._SetDefaultLayerIndex(this._index)),this._initialInstances.push(e),this._initialUIDsToInstanceData.set(e[2],e)}yf.shallowAssignArray(this._startupInitialInstances,this._initialInstances),this._initialInstancesData=null}static CreateFromExportData(e,t,s){return yf.New(yf.Layer,e,t,{name:s[0],sid:s[2],isVisible:s[3],isInteractive:s[13],isHTMLElementsLayer:s[19],backgroundColor:s[4].map((e=>e/255)),isTransparent:s[5],parallax:[s[6],s[7]],opacity:s[8],isForceOwnTexture:s[9],renderAs3d:s[17],useCameraDistanceDrawOrder:s[18],useRenderCells:s[10],scaleRate:s[11],blendMode:s[12],zElevation:s[16],initialInstancesData:s[14],effectListData:s[15],subLayersData:s[20]})}Release(){for(const e of this._subLayers)e.Release();yf.clearArray(this._subLayers);for(const e of this._instances)this._runtime.DestroyInstance(e);yf.clearArray(this._instances),this._effectList.Release(),this._effectList=null,this._effectChain.Release(),this._effectChain=null,this._iLayer=null,this._parentLayer=null,this._layout=null,this._runtime=null}WasReleased(){return!this._layout}GetInitialInstanceData(e){return this._initialUIDsToInstanceData.get(e)}CreateInitialInstances(e){const t=this._layout.IsFirstVisit(),s=this._initialInstances;let n=0;for(let i=0,r=s.length;i<r;++i){const r=s[i],a=this._runtime.GetObjectClassByIndex(r[1]);let o=!0;if(!a.HasPersistBehavior()||t){const t=this._runtime.CreateInstanceFromData(r,this,!0);e.push(t),a.IsGlobal()&&(o=!1,this._createdGlobalUids.push(t.GetUID()))}o&&(s[n]=s[i],++n)}yf.truncateArray(s,n),this._runtime.FlushPendingInstances(),this.SetZIndicesChanged()}_AddInstance(e,t){if(!e.GetPlugin().IsWorldType())throw new Error("instance is not of world type");const s=e.GetWorldInfo();if(s.GetLayer()!==this)throw new Error("instance added to wrong layer");this._instances.push(e),0!==s.GetZElevation()&&(this._anyInstanceZElevated=!0),t&&this.UsesRenderCells()&&e.GetWorldInfo().SetBboxChanged(),this.SetZIndicesChanged(e)}_MaybeAddInstance(e){this._instances.includes(e)||(this._instances.push(e),0!==e.GetWorldInfo().GetZElevation()&&(this._anyInstanceZElevated=!0),this.SetZIndicesChanged(e))}_PrependInstance(e,t){const s=e.GetWorldInfo();if(s.GetLayer()!==this)throw new Error("instance added to wrong layer");this._instances.unshift(e),0!==s.GetZElevation()&&(this._anyInstanceZElevated=!0),this.SetZIndicesChanged(e),t&&this.UsesRenderCells()&&e.GetWorldInfo().SetBboxChanged()}_RemoveInstance(e,t){const s=this._instances.indexOf(e);s<0||(t&&this.UsesRenderCells()&&e.GetWorldInfo()._RemoveFromRenderCells(),this._instances.splice(s,1),this.SetZIndicesChanged(e),this._MaybeResetAnyInstanceZElevatedFlag())}_SetAnyInstanceZElevated(){this._anyInstanceZElevated=!0}_MaybeResetAnyInstanceZElevatedFlag(){0===this._instances.length&&(this._anyInstanceZElevated=!1)}_SortInstancesByLastCachedZIndex(e){if(e){const e=new Set;for(const t of this._instances){const s=t.GetWorldInfo()._GetLastCachedZIndex();s>=0&&e.add(s)}let t=-1;for(const s of this._instances){const n=s.GetWorldInfo();if(!(n._GetLastCachedZIndex()>=0)){for(++t;e.has(t);)++t;n._SetZIndex(t)}}}this._instances.sort(If)}_Start(){}_End(){for(const e of this._instances)e.GetObjectClass().IsGlobal()||this._runtime.DestroyInstance(e);this._runtime.FlushPendingInstances(),yf.clearArray(this._instances),this._anyInstanceZElevated=!1,this.SetZIndicesChanged()}RecreateInitialObjects(e,t,s,n,i,r){const a=this._runtime.GetEventSheetManager(),o=this._runtime.GetAllObjectClasses(),l=e.IsFamily(),c=[];for(const h of this._initialInstances){const _=h[0],u=_[0],d=_[1];if(!t.containsPoint(u,d))continue;const p=o[h[1]];if(p!==e){if(!l)continue;if(!e.FamilyHasMember(p))continue}let f=i;if(!f){const e=this._runtime.GetCurrentLayout();this.GetLayout()===e?f=this:(f=e.GetLayerByName(this.GetName()),f||(f=e.GetLayerByIndex(this.GetIndex())))}const m=this._runtime.CreateInstanceFromData(h,f,!1,void 0,void 0,!1,r);f.SortAndAddInstancesByZIndex(m);const g=m.GetWorldInfo();g.OffsetXY(s,n),g.SetBboxChanged(),a.BlockFlushingInstances(!0),m._TriggerOnCreatedOnSelfAndRelated(),a.BlockFlushingInstances(!1),c.push(m)}return c}GetInstanceCount(){return this._instances.length}GetLayout(){return this._layout}GetName(){return this._name}_SetIndex(e){this._index=e}GetIndex(){return this._index}_SetHTMLIndex(e){this._htmlIndex=e}GetHTMLIndex(){return this._htmlIndex}IsHTMLElementsLayer(){return this._isHTMLElementsLayer}SetIsHTMLElementsLayer(e){e=!!e,this._isHTMLElementsLayer!==e&&(this._isHTMLElementsLayer=e,this._layout._ReindexAndUpdateAllLayers(),this._runtime.UpdateRender())}_GetSiblingIndex(){let e=-1;const t=this.GetParentLayer();return e=t?t.GetSubLayers().indexOf(this):this.GetLayout()._GetRootLayers().indexOf(this),e}GetSID(){return this._sid}GetRuntime(){return this._runtime}IsDynamic(){return this._isDynamic}HasAnyDynamicParentLayer(){for(const e of this.parentLayers())if(e.IsDynamic())return!0;return!1}GetDevicePixelRatio(){return this._runtime.GetDevicePixelRatio()}GetEffectList(){return this._effectList}GetEffectChain(){return this._MaybeRebuildEffectChainSteps(),this._effectChain}_MaybeRebuildEffectChainSteps(){const e=this.HasDefaultColor();if(!this._needsRebuildEffectChainSteps&&e===this._wasDefaultColor&&!this._effectChain.NeedsRebuild())return;const t=this.GetEffectList().GetActiveEffectTypes();this._effectChain.BuildSteps(t.map((e=>e.GetShaderProgram())),{indexMap:t.map((e=>e.GetIndex())),forcePreDraw:!e,useFullSurface:!0}),this._needsRebuildEffectChainSteps=!1,this._wasDefaultColor=e}UpdateActiveEffects(){this.GetEffectList().UpdateActiveEffects(),this._needsRebuildEffectChainSteps=!0}UsesRenderCells(){return this._useRenderCells&&!this._useCameraDistanceDrawOrder}GetRenderGrid(){return this._renderGrid}SetRenderListStale(){this._isRenderListUpToDate=!1}IsVisible(){for(const e of this.selfAndParentLayers())if(!e._IsVisibleFlagSet())return!1;return!0}_IsVisibleFlagSet(){return this._isVisible}SetVisible(e){e=!!e,this._isVisible!==e&&(this._isVisible=e,this._runtime.UpdateRender())}SetInteractive(e){this._isInteractive=!!e}IsInteractive(){return this._isInteractive}IsSelfAndParentsInteractive(){for(const e of this.selfAndParentLayers())if(!e.IsInteractive())return!1;return!0}SetOwnScrollPositionEnabled(e){if(e=!!e,this._hasOwnScrollPosition!==e){if(this._hasOwnScrollPosition=e,e){const e=this.GetLayout();this._scrollX=e.GetScrollX(),this._scrollY=e.GetScrollY()}this._SetMVMatrixChanged(),this._runtime.UpdateRender()}}IsOwnScrollPositionEnabled(){return this._hasOwnScrollPosition}SetScrollX(e){const t=this.GetLayout(),s=t.GetScrollLeftBound(),n=t.GetScrollRightBound();e>n&&(e=n),e<s&&(e=s),this._scrollX!==e&&(this._scrollX=e,this.IsOwnScrollPositionEnabled()&&(this._SetMVMatrixChanged(),this._runtime.UpdateRender()))}SetScrollY(e){const t=this.GetLayout(),s=t.GetScrollTopBound(),n=t.GetScrollBottomBound();e>n&&(e=n),e<s&&(e=s),this._scrollY!==e&&(this._scrollY=e,this.IsOwnScrollPositionEnabled()&&(this._SetMVMatrixChanged(),this._runtime.UpdateRender()))}GetScrollX(){return this.IsOwnScrollPositionEnabled()?this._scrollX:this.GetLayout().GetScrollX()}GetScrollY(){return this.IsOwnScrollPositionEnabled()?this._scrollY:this.GetLayout().GetScrollY()}GetViewport(){return this._MaybeUpdateViewport(),this._viewport}_GetViewportZ0(){return this._MaybeUpdateViewport(),this._viewportZ0}GetViewport3D(){return this._MaybeUpdateViewport(),this._viewport3D}_GetVanishingPoint(){const e=this.GetLayout();return[e.GetVanishingPointX(),e.GetVanishingPointY()]}GetDefaultCameraZ(e){return this._runtime.GetDefaultCameraZ(e)}GetViewportForZ(e,t){const s=this._GetViewportZ0();if(0===e)t.copy(s);else{let n=s.midX(),i=s.midY();const r=this.Get2DScaleFactorToZ(e),a=s.width()/r,o=s.height()/r,[l,c]=this._GetVanishingPoint();if(.5!==l||.5!==c){const t=this.Get2DCameraZ(),s=this._runtime,r=this.GetDefaultCameraZ()/t;let a=(l-.5)*s.GetViewportWidth()/r,o=(c-.5)*s.GetViewportHeight()/r;const h=this.GetAngle();0!==h&&(Bf.set(a,o),Bf.rotate(h),a=Bf.getX(),o=Bf.getY());const _=yf.unlerp(t,0,e);n+=yf.lerp(a,0,_),i+=yf.lerp(o,0,_)}t.set(n-a/2,i-o/2,n+a/2,i+o/2)}}GetOpacity(){return this._color.getA()}SetOpacity(e){e=yf.clamp(e,0,1),this._color.getA()!==e&&(this._color.setA(e),this._UpdatePremultipliedColor(),this._runtime.UpdateRender())}_UpdatePremultipliedColor(){this._premultipliedColor.copy(this._color),this._premultipliedColor.premultiply()}GetPremultipliedColor(){return this._premultipliedColor}HasDefaultColor(){return this._color.equalsRgba(1,1,1,1)}GetScaleRate(){return this._scaleRate}SetScaleRate(e){this._scaleRate!==e&&(this._scaleRate=e,this._SetMVMatrixChanged(),this._runtime.UpdateRender())}GetParallaxX(){return this._parallaxX}GetParallaxY(){return this._parallaxY}SetParallax(e,t){this._parallaxX===e&&this._parallaxY===t||(this._parallaxX=e,this._parallaxY=t,this._SetMVMatrixChanged(),this._runtime.UpdateRender())}SetParallaxX(e){this.SetParallax(e,this.GetParallaxY())}SetParallaxY(e){this.SetParallax(this.GetParallaxX(),e)}SetZElevation(e){this._zElevation!==e&&(this._zElevation=e,this._runtime.UpdateRender())}GetZElevation(){return this._zElevation}SetAngle(e){e=yf.clampAngle(e),this._angle!==e&&(this._angle=e,this._SetMVMatrixChanged(),this._runtime.UpdateRender())}GetAngle(){return yf.clampAngle(this._layout.GetAngle()+this._angle)}GetOwnAngle(){return this._angle}HasInstances(){return this._instances.length>0}_GetInstances(){return this._instances}_GetInstancesInDrawOrder(){return this.RendersIn3DMode()&&this._useCameraDistanceDrawOrder?(yf.shallowAssignArray(Vf,this._GetInstances()),Vf.sort(((e,t)=>this._SortInstancesByCameraDistance(e,t))),Vf):this._GetInstances()}_AppendAllInstancesIncludingSubLayersInDrawOrder(e){yf.appendArray(e,this._GetInstancesInDrawOrder());for(const t of this._subLayers)t.IsVisible()&&t.GetOpacity()>0&&t._AppendAllInstancesIncludingSubLayersInDrawOrder(e)}_SortInstancesByCameraDistance(e,t){const s=this.GetLayout().Get3DCameraPosition(),n=s[0],i=s[1],r=s[2],a=e.GetWorldInfo(),o=t.GetWorldInfo(),l=a.GetX()-n,c=a.GetY()-i,h=a.GetZElevation()-r,_=o.GetX()-n,u=o.GetY()-i,d=o.GetZElevation()-r;return _*_+u*u+d*d-(l*l+c*c+h*h)}GetBackgroundColor(){return this._backgroundColor}IsTransparent(){return this._isTransparent}SetTransparent(e){e=!!e,this._isTransparent!==e&&(this._isTransparent=e,this._runtime.UpdateRender())}IsForceOwnTexture(){return this._isForceOwnTexture}SetForceOwnTexture(e){e=!!e,this._isForceOwnTexture!==e&&(this._isForceOwnTexture=e,this._runtime.UpdateRender())}SetRenderAs3D(e){e=!!e,this._renderAs3d!==e&&(this._renderAs3d=e,this._SetMVMatrixChanged(),this._runtime.UpdateRender())}IsRenderAs3D(){return this._renderAs3d}RendersIn2DMode(){return!this.GetRuntime().Uses3DFeatures()||!this._renderAs3d}RendersIn3DMode(){return!this.RendersIn2DMode()}Has3DCamera(){return this.RendersIn3DMode()&&this.GetLayout().Is3DCameraEnabled()}SelfAndAllSubLayersHave3DCamera(){if(!this.Has3DCamera())return!1;for(const e of this._subLayers)if(!e.SelfAndAllSubLayersHave3DCamera())return!1;return!0}SetBlendMode(e){this._blendMode!==e&&(this._blendMode=e,this._runtime.UpdateRender())}GetBlendMode(){return this._blendMode}IsRootLayer(){return!this._parentLayer}GetParentLayer(){return this._parentLayer}_SetParentLayer(e){this._parentLayer=e}GetSubLayers(){return this._subLayers}HasAnySubLayers(){return this._subLayers.length>0}_AddSubLayer(e,t=!0){t?this._subLayers.push(e):this._subLayers.unshift(e)}_InsertSubLayer(e,t,s){let n=this._subLayers.indexOf(t);if(-1===n)throw new Error("cannot find layer to insert by");s&&++n,this._subLayers.splice(n,0,e)}_RemoveSubLayer(e){const t=this._subLayers.indexOf(e);if(-1===t)throw new Error("cannot find layer to remove");this._subLayers.splice(t,1)}HasAnyVisibleSubLayer(){for(const e of this._subLayers)if(e.ShouldDraw())return!0;return!1}*selfAndAllSubLayers(){for(const e of this._subLayers)yield*e.selfAndAllSubLayers();yield this}*parentLayers(){let e=this.GetParentLayer();for(;e;)yield e,e=e.GetParentLayer()}*selfAndParentLayers(){yield this,yield*this.parentLayers()}HasParentLayer(e){for(const t of this.parentLayers())if(t===e)return!0;return!1}IsTransformCompatibleWith(e){return this===e||this._parallaxX===e._parallaxX&&this._parallaxY===e._parallaxY&&this._scale===e._scale&&this._scaleRate===e._scaleRate&&this._angle===e._angle&&this.GetScrollX()===e.GetScrollX()&&this.GetScrollY()===e.GetScrollY()}SaveTransform(){return{parallaxX:this.GetParallaxX(),parallaxY:this.GetParallaxY(),scale:this.GetOwnScale(),scaleRate:this.GetScaleRate(),angle:this.GetOwnAngle(),hasOwnScroll:this.IsOwnScrollPositionEnabled(),scrollX:this.GetScrollX(),scrollY:this.GetScrollY()}}RestoreTransform(e){this.SetParallax(e.parallaxX,e.parallaxY),this.SetOwnScale(e.scale),this.SetScaleRate(e.scaleRate),this.SetAngle(e.angle),this.SetOwnScrollPositionEnabled(e.hasOwnScroll),this.SetScrollX(e.scrollX),this.SetScrollY(e.scrollY),this._MaybeUpdateViewport()}_RemoveAllInstancesInSet(e){0!==e.size&&yf.arrayRemoveAllInSet(this._instances,e)>0&&(this._MaybeResetAnyInstanceZElevatedFlag(),this.SetZIndicesChanged())}SetZIndicesChanged(e){this._zIndicesUpToDate=!1,this._isRenderListUpToDate=!1,e&&!e.GetObjectClass().GetPlugin().IsHTMLElementType()||(this._htmlZIndicesUpToDate=!1)}_UpdateZIndices(){if(!this._zIndicesUpToDate){if(this._instances.sort(Sf),this.UsesRenderCells())for(let e=0,t=this._instances.length;e<t;++e){const t=this._instances[e].GetWorldInfo();t._SetZIndex(e),this._renderGrid.MarkRangeChanged(t.GetRenderCellRange())}else for(let e=0,t=this._instances.length;e<t;++e)this._instances[e].GetWorldInfo()._SetZIndex(e);this._zIndicesUpToDate=!0}}_UpdateHTMLZIndices(){if(this._htmlZIndicesUpToDate)return;const e=this._layout.GetRootLayersForHTMLLayer(this.GetHTMLIndex()).map((e=>[...e.selfAndAllSubLayers()])).flat();let t=0;for(const s of e){for(const e of s._GetInstances())e.GetObjectClass().GetPlugin().IsHTMLElementType()&&e.GetWorldInfo()._SetHTMLZIndex(t++);s._SetHTMLZIndicesUpToDate()}}_SetHTMLZIndicesUpToDate(){this._htmlZIndicesUpToDate=!0}_GetHTMLLayerDOMState(){return{isVisible:this.IsVisible(),opacity:this.GetOpacity(),isInteractive:this.IsInteractive()}}MoveInstanceAdjacent(e,t,s){const n=e.GetWorldInfo(),i=t.GetWorldInfo();if(n.GetLayer()!==this||i.GetLayer()!==this)throw new Error("can't arrange Z order unless both objects on this layer");const r=n.GetZIndex();let a=i.GetZIndex();return r!==a+(s?1:-1)&&(yf.arrayRemove(this._instances,r),r<a&&a--,s&&a++,a===this._instances.length?this._instances.push(e):this._instances.splice(a,0,e),this.SetZIndicesChanged(e),!0)}_MergeSortedZArrays(e,t){const s=[];let n=0,i=0,r=e.length,a=t.length;for(;n<r&&i<a;){const r=e[n],a=t[i];r.GetWorldInfo()._GetLastCachedZIndex()<a.GetWorldInfo()._GetLastCachedZIndex()?(s.push(r),++n):(s.push(a),++i)}for(;n<r;++n)s.push(e[n]);for(;i<a;++i)s.push(t[i]);return s}_MergeAllSortedZArrays_pass(e){const t=[],s=e.length;for(let n=0;n<s-1;n+=2){const s=e[n],i=e[n+1];t.push(this._MergeSortedZArrays(s,i))}return s%2==1&&t.push(e[s-1]),t}_MergeAllSortedZArrays(e){for(;e.length>1;)e=this._MergeAllSortedZArrays_pass(e);return e[0]}_GetRenderCellInstancesToDraw(){return this._UpdateZIndices(),yf.clearArray(xf),this._renderGrid.QueryRange(this.GetViewport(),xf),xf.length?1===xf.length?xf[0]:this._MergeAllSortedZArrays(xf):[]}ShouldDraw(){return this.IsVisible()&&this.GetOpacity()>0&&this._DrawsAnyContentInSelfOrSubLayers()}_DrawsAnyContentInSelfOrSubLayers(){if(this.HasInstances()||!this.IsTransparent())return!0;for(const e of this._subLayers)if(e._DrawsAnyContentInSelfOrSubLayers())return!0;return!1}UsesOwnTexture(){return this.IsForceOwnTexture()||!this.HasDefaultColor()||0!==this.GetBlendMode()||this._effectList.HasAnyActiveEffect()}SelfOrAnySubLayerUsesOwnTexture(){if(this.UsesOwnTexture())return!0;for(const e of this._subLayers)if(e.SelfOrAnySubLayerUsesOwnTexture())return!0;return!1}GetRenderTarget(){return this._curRenderTarget}Get2DScaleFactorToZ(e){if(this._layout.IsOrthographicProjection())return 1;{const t=this.Get3DCameraZ();return t/(t-e)}}GetResolutionScaleFactorToZ(e){const t=this._runtime.GetRenderScale();if(this._layout.IsOrthographicProjection())return t;{const s=this.Get3DCameraZ();return this.GetDefaultCameraZ()/Math.abs(s-e)*t}}_SetMVMatrixChanged(){this._isMVMatrixChanged=!0,this._isViewFrustumChanged=!0,this._isViewportChanged=!0}_GetModelViewMatrix(e){return this._isMVMatrixChanged&&(this._CalculateModelViewMatrix(e,this._modelViewMatrix,0,0,null),this._isMVMatrixChanged=!1),this._modelViewMatrix}Get2DCameraZ(e){return this.GetDefaultCameraZ(e)/this.GetNormalScale()}Get3DCameraZ(){return this.Has3DCamera()?this.GetLayout().Get3DCameraPosition()[2]:this.Get2DCameraZ()}GetCameraPosition(){if(this.Has3DCamera()){const e=this.GetLayout().Get3DCameraPosition();return[e[0],e[1],e[2]]}return this._Get2DCameraPosition()}_Get2DCameraPosition(e=0,t=0,s=0){const n=this._runtime,i=this.GetLayout(),r=n.GetParallaxXOrigin(),a=n.GetParallaxYOrigin();let o=(this.GetScrollX()-r)*this._parallaxX+r,l=(this.GetScrollY()-a)*this._parallaxY+a;n.IsPixelRoundingEnabled()&&(o=Math.round(o),l=Math.round(l));let c=o+e,h=l+t;const _=i.IsOrthographicProjection()?this.GetDefaultCameraZ(s):this.Get2DCameraZ(s),[u,d]=this._GetVanishingPoint();if(.5!==u||.5!==d){const e=this.GetDefaultCameraZ(s)/_;let t=(u-.5)*n.GetViewportWidth()/e,i=(d-.5)*n.GetViewportHeight()/e;const r=this.GetAngle();0!==r&&(Bf.set(t,i),Bf.rotate(r),t=Bf.getX(),i=Bf.getY()),c+=t,h+=i}return[c,h,_]}_CalculateModelViewMatrix(e,t,s,n,i){const r=this._runtime,a=this.GetLayout();if(this.Has3DCamera()){Pf.copy(kf,a.Get3DCameraPosition()),Pf.copy(Lf,a.Get3DCameraLookAt()),Pf.copy(Ff,a.Get3DCameraUpVector());const e=r.GetParallaxXOrigin(),t=r.GetParallaxYOrigin(),s=Lf[0]-kf[0],n=Lf[1]-kf[1],i=Lf[2]-kf[2];kf[0]=(kf[0]-e)*this._parallaxX+e,kf[1]=(kf[1]-t)*this._parallaxY+t,kf[2]*=Math.max(this._parallaxX,this._parallaxY),Lf[0]=kf[0]+s,Lf[1]=kf[1]+n,Lf[2]=kf[2]+i}else{const[e,t,r]=this._Get2DCameraPosition(s,n,i);Pf.set(kf,e,t,r),Pf.set(Lf,e,t,r-100);const a=this.GetAngle();0===a?Pf.set(Ff,0,1,0):Pf.set(Ff,Math.sin(a),Math.cos(a),0)}e.CalculateLookAtModelView(t,kf,Lf,Ff,i||r.GetViewportHeight())}_SetProjectionMatrixChanged(){this._isProjectionMatrixChanged=!0,this._isViewFrustumChanged=!0,this._isViewportChanged=!0}_GetProjectionMatrix(e){return this._isProjectionMatrixChanged&&(this._CalculateProjectionMatrix(e),this._isProjectionMatrixChanged=!1),this._projectionMatrix}_CalculateProjectionMatrix(e){const t=this._runtime.GetCanvasManager(),[s,n]=this._GetVanishingPoint();if(this._layout.IsOrthographicProjection())e.CalculateOrthographicMatrix(this._projectionMatrix,t.GetDrawWidth(),t.GetDrawHeight());else if(.5===s&&.5===n)Rf.copy(this._projectionMatrix,t.GetDefaultProjectionMatrix());else{const i=t.GetDrawWidth(),r=t.GetDrawHeight();e.CalculatePerspectiveMatrix(this._projectionMatrix,i/r,s,n)}}_SetTransform(e,t=!0,s=0,n=0,i=0){t&&e.SetProjectionMatrix(this._GetProjectionMatrix(e));let r=null;0===s&&0===n&&0===i?r=this._GetModelViewMatrix(e):(this._CalculateModelViewMatrix(e,Df,s,n,i),r=Df),e.SetModelViewMatrix(r)}PrepareForDraw(e){this._SetTransform(e),e.SetBaseZ(this.GetZElevation())}_MaybeStartWebGLProfiling(e){let t=null;if(e.IsWebGL()&&this._runtime.IsGPUProfiling()){const s=this._runtime.GetCanvasManager().GetLayerTimingsBuffer(this);s&&(t=s.AddTimeElapsedQuery(),e.StartQuery(t))}return t}_MaybeStartWebGPUProfiling(e){if(e.IsWebGPU()&&this._runtime.IsGPUProfiling()){const t=2*(this.GetIndex()+1);e.StartMeasuringRenderPassTime(t,t+1)}}Draw(e,t,s){const n=this._runtime.GetCanvasManager(),i=this.UsesOwnTexture();let r=null;const a=this._MaybeStartWebGLProfiling(e);if(this._MaybeStartWebGPUProfiling(e),i){const t={sampling:this._runtime.GetSampling(),isSampled:!0,canReadPixels:!!e.IsWebGPU()&&this._runtime.UsesAnyBackgroundBlending()};"low"===n.GetCurrentFullscreenScalingQuality()&&(t.width=n.GetDrawWidth(),t.height=n.GetDrawHeight()),r=this._runtime.GetAdditionalRenderTarget(t),this._curRenderTarget=r,e.SetRenderTarget(r),this.IsTransparent()&&e.ClearRgba(0,0,0,0)}else this._curRenderTarget=t,e.SetRenderTarget(t);if(this.IsTransparent()||e.Clear(this._backgroundColor),this._layout._DrawLayerList(e,this._curRenderTarget,this._subLayers,i&&this.IsTransparent()),this._MaybeStartWebGPUProfiling(e),this._SetTransform(e),e.SetBaseZ(this.GetZElevation()),e.SetDepthEnabled(this.RendersIn3DMode()),this.GetNormalScale()>Number.EPSILON){this._UpdateZIndices();const t=this.UsesRenderCells()&&0===this.GetZElevation()&&!this._anyInstanceZElevated;this.Has3DCamera()?this._DrawInstances_3DCamera(e):t?this._DrawInstances_RenderCells(e):this._DrawInstances(e,this._GetInstancesInDrawOrder())}e.SetBaseZ(0),e.SetCurrentZ(0),i&&(e.SetDepthEnabled(!1),this._DrawLayerOwnTextureToRenderTarget(e,r,t,s)),a&&e.EndQuery(a),this._curRenderTarget=null}_DrawInstances(e,t){const s=this.GetViewport(),n=this._curRenderTarget,i=this.GetLayout().IsOrthographicProjection(),r=this.GetLayout().HasVanishingPointOutsideViewport();let a=null;for(let o=0,l=t.length;o<l;++o){const l=t[o];if(l===a)continue;a=l;const c=l.GetWorldInfo();c.IsVisible()&&c.IsInViewport(s,r,i)&&this._DrawInstanceMaybeWithEffects(l,c,e,n)}}_DrawInstances_3DCamera(e){const t=this._curRenderTarget,s=this._GetViewFrustum(),n=Nf,i=Wf,r=this._GetInstancesInDrawOrder();for(let a=0,o=r.length;a<o;){const l=r[a],c=l.GetWorldInfo();if(!c.IsVisible()||!c.IsInViewport3D(s)){++a;continue}(!l.RendersToOwnZPlane()||c.GetDepth()>0)&&i.push(l);const h=l.GetWorldInfo().GetTotalZElevation();n.push(l);let _=a+1;for(;_<o;++_){const e=r[_],t=e.GetWorldInfo();if(t.IsVisible()&&t.IsInViewport3D(s)){if(t.GetTotalZElevation()!==h)break;e.RendersToOwnZPlane()?(t.GetDepth()>0&&i.push(e),n.push(e)):i.push(e)}}if(1!==n.length||n[0].MustMitigateZFighting()){this._DrawCoplanarInstances_3DCamera(e,n);for(let s=0,n=i.length;s<n;++s){const n=i[s],r=n.GetWorldInfo();r._SetDrawNonBackFacesOnly(!0),this._DrawInstanceMaybeWithEffects(n,r,e,t),r._SetDrawNonBackFacesOnly(!1)}}else{this._DrawInstanceMaybeWithEffects(l,c,e,t);for(let s=0,n=i.length;s<n;++s){const n=i[s];if(n===l)continue;const r=n.GetWorldInfo();r.GetLayer()._DrawInstanceMaybeWithEffects(n,r,e,t)}}a=_,yf.clearArray(n),yf.clearArray(i)}}_DrawCoplanarInstances_3DCamera(e,t){const s=this._curRenderTarget;e.CoplanarStartStencilPass();for(let s=0,n=t.length;s<n;++s){const n=t[s],i=n.GetWorldInfo();i._SetDrawBackFaceOnly(!0),this._DrawInstance(n,i,e)}e.CoplanarStartColorPass();for(let n=0,i=t.length;n<i;++n){const i=t[n],r=i.GetWorldInfo();this._DrawInstanceMaybeWithEffects(i,r,e,s),r._SetDrawBackFaceOnly(!1)}e.CoplanarRestoreStandardRendering()}_DrawInstances_RenderCells(e){const t=this._renderGrid,s=this._curRenderCells,n=this._lastRenderCells,i=this.GetViewport();let r;s.set(t.XToCell(i.getLeft()),t.YToCell(i.getTop()),t.XToCell(i.getRight()),t.YToCell(i.getBottom())),this._isRenderListUpToDate&&s.equals(n)?r=this._lastRenderList:(r=this._GetRenderCellInstancesToDraw(),this._isRenderListUpToDate=!0,n.copy(s)),this._DrawInstances(e,r),r!==this._lastRenderList&&yf.shallowAssignArray(this._lastRenderList,r)}_DrawInstanceMaybeWithEffects(e,t,s,n){t.HasAnyActiveEffect()?this._DrawInstanceWithEffectsAndRestore(e,t,s,n):this._DrawInstance(e,t,s)}_DrawInstance(e,t,s){const n=t.GetRendererStateGroup();s.GetCurrentStateGroup()!==n&&n.Apply(),e.Draw(s)}_DrawInstanceWithEffectsAndRestore(e,t,s,n){this._DrawInstanceWithEffects(e,t,s,n,null)&&this._SetTransform(s)}_DrawInstanceWithEffects(e,t,s,n,i){const r=t.GetInstanceEffectList().GetEffectChain();return r.Render(s,n,{contentObject:e,blendMode:t.GetBlendMode(),devicePixelRatio:this._runtime.GetEffectDevicePixelRatioParam(),time:e.GetInstanceGameTime(),layerScale:this._runtime.GetEffectLayerScaleParam()*this.GetNormalScale(),layerAngle:this.GetAngle(),layoutRect:t.GetBoundingBox(),drawSurfaceRect:r.CanSkipCalculatingDrawSurfaceRect()?null:this._InstanceBoxToDrawSurface(t),drawContentHook:i&&i.drawContentHook,compositOffX:i&&i.compositOffX,compositOffY:i&&i.compositOffY,compositRtWidth:i&&i.compositRtWidth,compositRtHeight:i&&i.compositRtHeight,updateOwnProjection:i&&i.updateOwnProjection}),s.SetBaseZ(this.GetZElevation()),r.DidChangeTransform()}_DrawLayerOwnTextureToRenderTarget(e,t,s,n){const i=this._effectList.GetActiveEffectTypes(),r=this._runtime;0===i.length?(e.SetRenderTarget(s),e.SetTextureFillMode(),n&&0===this._blendMode&&this.HasDefaultColor()?e.CopyRenderTarget(t):(e.SetBlendMode(this._blendMode),e.SetColor(this._premultipliedColor),e.DrawRenderTarget(t)),e.InvalidateRenderTarget(t),r.ReleaseAdditionalRenderTarget(t)):this.GetEffectChain().Render(e,s,{contentObject:this,blendMode:this.GetBlendMode(),devicePixelRatio:r.GetEffectDevicePixelRatioParam(),layerScale:r.GetEffectLayerScaleParam()*this.GetNormalScale(),layerAngle:this.GetAngle(),layoutRect:this.GetViewport(),drawSurfaceRect:null,invalidateRenderTargets:!0})}GetOwnScale(){return this._scale}SetOwnScale(e){this._scale!==e&&(this._scale=e,this._layout.BoundScrolling(),this._SetMVMatrixChanged(),this._runtime.UpdateRender())}GetRenderScale(){return this.GetNormalScale()*this._runtime.GetRenderScale()}GetDisplayScale(){return this.GetNormalScale()*this._runtime.GetDisplayScale()}GetNormalScale(){return(this._scale*this._layout.GetScale()-1)*this._scaleRate+1}_MaybeUpdateViewport(){if(!this._isViewportChanged)return;this._isViewportChanged=!1;const e=this._runtime.GetParallaxXOrigin(),t=this._runtime.GetParallaxYOrigin(),s=(this.GetScrollX()-e)*this._parallaxX+e,n=(this.GetScrollY()-t)*this._parallaxY+t,i=this.GetNormalScale(),r=this._runtime.GetViewportWidth()/i,a=this._runtime.GetViewportHeight()/i;let o=s-r/2,l=n-a/2;this._runtime.IsPixelRoundingEnabled()&&(o=Math.round(o),l=Math.round(l));const c=this._viewportZ0;c.set(o,l,o+r,l+a);const h=this.GetAngle();0!==h&&(Gf.copy(c),Gf.offset(-c.midX(),-c.midY()),vf.setFromRotatedRect(Gf,h),vf.getBoundingBox(Gf),Gf.offset(c.midX(),c.midY()),c.copy(Gf));const _=this._zElevation;this.GetViewportForZ(_,this._viewport),this.Has3DCamera()?this.CalculateViewport3D(_,this._viewport3D):this._viewport3D.copy(this._viewport)}CalculateViewport3D(e,t){const s=this._runtime.GetCanvasManager(),n=s.GetCssWidth(),i=s.GetCssHeight(),[r,a]=this.CanvasCssToLayer(0,0,e),[o,l]=this.CanvasCssToLayer(n,0,e),[c,h]=this.CanvasCssToLayer(n,i,e),[_,u]=this.CanvasCssToLayer(0,i,e);let d=Math.min(r,o,c,_),p=Math.min(a,l,h,u),f=Math.max(r,o,c,_),m=Math.max(a,l,h,u);isFinite(d)||(d=-1/0),isFinite(p)||(p=-1/0),isFinite(f)||(f=1/0),isFinite(m)||(m=1/0),t.set(d,p,f,m)}CanvasCssToLayer(e,t,s=0){return this._CanvasToLayer(e,t,s,this.GetDisplayScale())}DrawSurfaceToLayer(e,t,s=0){return this._CanvasToLayer(e,t,s,this.GetRenderScale()*this.GetDevicePixelRatio())}_CanvasToLayer(e,t,s,n){const i=this._runtime,r=i.GetRenderer(),a=this.GetNormalScale(),o=i.GetViewportWidth()/a,l=i.GetViewportHeight()/a,c=Mf;Af.set(c,0,0,o,l),e/=n,t=c[3]-t/n;const h=this._GetProjectionMatrix(r),_=this._GetModelViewMatrix(r),u=Ef;return yf.Gfx.UnprojectScreenToWorldZ(e,t,s,_,h,c,u)?[u[0],u[1]]:[NaN,NaN]}CanvasCssToLayer_DefaultTransform(e,t){const s=this._scale,n=this._scaleRate,i=this._parallaxX,r=this._parallaxY,a=this._angle;this._scale=1,this._scaleRate=1,this._parallaxX=1,this._parallaxY=1,this._angle=0,this._SetMVMatrixChanged();const o=this.CanvasCssToLayer(e,t);return this._scale=s,this._scaleRate=n,this._parallaxX=i,this._parallaxY=r,this._angle=a,this._SetMVMatrixChanged(),o}LayerToCanvasCss(e,t,s=0){return this._LayerToCanvas(e,t,s,this.GetDisplayScale())}LayerToDrawSurface(e,t,s=0){return this._LayerToCanvas(e,t,s,this.GetRenderScale()*this.GetDevicePixelRatio())}_LayerToCanvas(e,t,s,n){const i=this._runtime,r=i.GetRenderer(),a=this.GetNormalScale(),o=i.GetViewportWidth()/a,l=i.GetViewportHeight()/a,c=Mf;Af.set(c,0,0,o,l);const h=this._GetProjectionMatrix(r),_=this._GetModelViewMatrix(r),u=Ef;return yf.Gfx.Project(e,t,s,_,h,c,u)?[u[0]*n,(c[3]-u[1])*n]:[NaN,NaN]}_GetLayerToDrawSurfaceScale(e,t){return e*=this.GetRenderScale()*this.GetDevicePixelRatio(),0!==t&&(e*=this.Get2DScaleFactorToZ(t)),e}_InstanceBoxToDrawSurface(e){const t=e.GetBoundingBox(),s=e.GetTotalZElevation(),n=e.GetDepth(),i=s+n,r=t.getLeft(),a=t.getTop(),o=t.getRight(),l=t.getBottom();if(this.Has3DCamera()){if(this._IsPointBehindNearPlane(r,a,s)||this._IsPointBehindNearPlane(o,a,s)||this._IsPointBehindNearPlane(o,l,s)||this._IsPointBehindNearPlane(r,l,s))return null;if(n>0&&(this._IsPointBehindNearPlane(r,a,i)||this._IsPointBehindNearPlane(o,a,i)||this._IsPointBehindNearPlane(o,l,i)||this._IsPointBehindNearPlane(r,l,i)))return null}else if(i>=this.Get2DCameraZ())return null;let[c,h]=this.LayerToDrawSurface(r,a,s),[_,u]=this.LayerToDrawSurface(o,l,s);if(0!==this.GetAngle()||n>0||this.Has3DCamera()){const[e,t]=this.LayerToDrawSurface(o,a,s),[d,p]=this.LayerToDrawSurface(r,l,s);if(n>0){const[s,n]=this.LayerToDrawSurface(r,a,i),[f,m]=this.LayerToDrawSurface(o,a,i),[g,I]=this.LayerToDrawSurface(o,l,i),[S,y]=this.LayerToDrawSurface(r,l,i);let b=Math.min(c,_,e,d,s,f,g,S);_=Math.max(c,_,e,d,s,f,g,S),c=b,b=Math.min(h,u,t,p,n,m,I,y),u=Math.max(h,u,t,p,n,m,I,y),h=b}else{let s=Math.min(c,_,e,d);_=Math.max(c,_,e,d),c=s,s=Math.min(h,u,t,p),u=Math.max(h,u,t,p),h=s}}return Gf.set(c,h,_,u),Gf}_GetViewFrustum(){return this._isViewFrustumChanged&&(this._UpdateViewFrustum(),this._isViewFrustumChanged=!1),this._viewFrustum}_UpdateViewFrustum(){const e=this._runtime.GetRenderer(),t=this._GetProjectionMatrix(e),s=this._GetModelViewMatrix(e);this._viewFrustum.CalculatePlanes(s,t)}_IsPointBehindNearPlane(e,t,s){return this._GetViewFrustum().IsBehindNearPlane(e,t,s)}_SaveToJson(){return{d:this.IsDynamic(),s:this.GetOwnScale(),a:this.GetOwnAngle(),v:this._IsVisibleFlagSet(),i:this.IsInteractive(),html:this.IsHTMLElementsLayer(),bc:this._backgroundColor.toJSON(),t:this.IsTransparent(),sx:this._scrollX,sy:this._scrollY,hosp:this._hasOwnScrollPosition,px:this.GetParallaxX(),py:this.GetParallaxY(),c:this._color.toJSON(),sr:this.GetScaleRate(),fx:this._effectList.SaveToJson(),cg:this._createdGlobalUids}}_LoadFromJson(e){this._isDynamic=!!e.d,this._scale=e.s,this._angle=e.a,this._isVisible=!!e.v,this._isInteractive=!e.hasOwnProperty("i")||e.i,this._isHTMLElementsLayer=!!e.html,this._backgroundColor.setFromJSON(e.bc),this._isTransparent=!!e.t,e.hasOwnProperty("sx")&&(this._scrollX=e.sx),e.hasOwnProperty("sy")&&(this._scrollY=e.sy),e.hasOwnProperty("hosp")&&(this._hasOwnScrollPosition=!!e.hosp),this._parallaxX=e.px,this._parallaxY=e.py,this._color.setFromJSON(e.c),this._UpdatePremultipliedColor(),this._scaleRate=e.sr,yf.shallowAssignArray(this._createdGlobalUids,e.cg),yf.shallowAssignArray(this._initialInstances,this._startupInitialInstances);const t=new Set(this._createdGlobalUids);let s=0;for(let e=0,n=this._initialInstances.length;e<n;++e)t.has(this._initialInstances[e][2])||(this._initialInstances[s]=this._initialInstances[e],++s);yf.truncateArray(this._initialInstances,s),this._effectList.LoadFromJson(e.fx),this._needsRebuildEffectChainSteps=!0}_LoadFromJsonAfterInstances(){this._SortInstancesByLastCachedZIndex(!1),this.SetZIndicesChanged(),this._SetMVMatrixChanged(),this._SetProjectionMatrixChanged()}GetILayer(){return this._iLayer}SortAndAddInstancesByZIndex(e,t=!1,s=!1){if(this._instances.includes(e))return t&&this._instances.sort(((e,t)=>(e.GetWorldInfo().GetSceneGraphZIndex()??0)-(t.GetWorldInfo().GetSceneGraphZIndex()??0))),void(s&&this._instances.forEach(((e,t)=>e.GetWorldInfo()._SetZIndex(t))));if(e.HasChildren()){const t=[...e.allChildren()];t.push(e),t.sort(((e,t)=>(e.GetWorldInfo().GetSceneGraphZIndex()??0)-(t.GetWorldInfo().GetSceneGraphZIndex()??0)));for(const e of t)if(e.IsInContainer())for(const s of e.siblings()){if(t.includes(s))continue;const e=[...s.allChildren()];e.push(s),e.sort(((e,t)=>(e.GetWorldInfo().GetSceneGraphZIndex()??0)-(t.GetWorldInfo().GetSceneGraphZIndex()??0))),e&&e.length&&t.splice(t.length,0,...e)}for(const e of t)e.GetPlugin().IsWorldType()&&this._AddInstance(e,!0);s&&this._instances.forEach(((e,t)=>e.GetWorldInfo()._SetZIndex(t)))}else{if(e.GetPlugin().IsWorldType()&&this._AddInstance(e,!0),!e.IsInContainer())return void(s&&this._instances.forEach(((e,t)=>e.GetWorldInfo()._SetZIndex(t))));for(const t of e.siblings()){const e=[...t.allChildren()];if(e.push(t),e.sort(((e,t)=>(e.GetWorldInfo().GetSceneGraphZIndex()??0)-(t.GetWorldInfo().GetSceneGraphZIndex()??0))),e&&e.length)for(const t of e)t.GetPlugin().IsWorldType()&&this._AddInstance(t,!0)}s&&this._instances.forEach(((e,t)=>e.GetWorldInfo()._SetZIndex(t)))}}}}{let Uf=function(e,t,s,n){return e[0]===Math.fround(t)&&e[1]===Math.fround(s)&&e[2]===Math.fround(n)},Hf=function(e,t){im!==e&&(e.PrepareForDraw(t),im=e)};vec3EqualsXYZ=Uf,MaybePrepareLayerDraw=Hf;const zf=self.C3,Xf=self.C3Debugger,Yf=self.assert,qf=zf.New(zf.Rect),Jf=zf.New(zf.Rect),Kf=zf.New(zf.Rect),$f=zf.New(zf.Color),Zf=self.glMatrix,Qf=Zf.vec3,em=[],tm=[],sm=[],nm=[];let im=null;zf.Layout=class extends zf.DefendedBase{constructor(e,t,s){super(),this._layoutManager=e,this._runtime=e.GetRuntime(),this._name=s[0],this._originalWidth=s[1],this._originalHeight=s[2],this._width=s[1],this._height=s[2],this._isUnboundedScrolling=!!s[3],this._isOrthographicProjection=!!s[4],this._vanishingPointX=s[5],this._vanishingPointY=s[6],this._eventSheetName=s[7],this._eventSheet=null,this._sid=s[8],this._index=t,this._scrollX=0,this._scrollY=0,this._scale=1,this._angle=0,this._initialObjectClasses=new Set,this._textureLoadedTypes=new Set,this._textureLoadPendingPromises=new Set,this._createdInstances=[],this._createdPersistedInstances=[],this._createdPersistedInstancesToDataMap=new Map,this._createdPersistedIndexToInstanceMap=new Map,this._initialNonWorld=[],this._is3dCameraEnabled=!1,this._cam3dposition=Qf.create(),this._cam3dlook=Qf.create(),this._cam3dup=Qf.create(),this._rootLayers=[],this._allLayersFlat=[],this._layersByName=new Map,this._layersBySid=new Map,this._pendingSetHTMLLayerCount=-1;const n=this._runtime.GetCanvasManager();this._effectList=zf.New(zf.EffectList,this,s[11]),this._effectChain=zf.New(zf.Gfx.EffectChain,n.GetEffectChainManager(),{drawContent:(e,t)=>{const s=t.GetContentObject().GetRenderTarget();e.ResetColor(),e.DrawRenderTarget(s),e.InvalidateRenderTarget(s),n.ReleaseAdditionalRenderTarget(s)},getShaderParameters:e=>this.GetEffectList()._GetEffectChainShaderParametersForIndex(e)}),this._needsRebuildEffectChainSteps=!0,this._wasFullScreenQualityLow=!1,this._curRenderTarget=null,this._persistData={},this._persistedIntances=new Map,this._isFirstVisit=!0,this._iLayout=new self.ILayout(this),this._userScriptDispatcher=zf.New(zf.Event.Dispatcher);for(const e of s[9])this._rootLayers.push(zf.Layer.CreateFromExportData(this,null,e));this._ReindexLayers();for(const e of this.allLayers())e._InitInitialInstances();for(const e of s[10]){const t=this._runtime.GetObjectClassByIndex(e[1]);if(!t)throw new Error("missing nonworld object class");t.GetDefaultInstanceData()||t.SetDefaultInstanceData(e),this._initialNonWorld.push(e),this._AddInitialObjectClass(t)}}Release(){for(const e of this._allLayersFlat)e.Release();zf.clearArray(this._allLayersFlat),this._textureLoadPendingPromises.clear(),this._eventSheet=null,this._layoutManager=null,this._runtime=null}GetRuntime(){return this._runtime}GetName(){return this._name}GetSID(){return this._sid}GetIndex(){return this._index}GetEffectList(){return this._effectList}GetEffectChain(){return this._MaybeRebuildEffectChainSteps(),this._effectChain}_MaybeRebuildEffectChainSteps(){const e="low"===this._runtime.GetCanvasManager().GetCurrentFullscreenScalingQuality();if(!this._needsRebuildEffectChainSteps&&this._wasFullScreenQualityLow===e&&!this._effectChain.NeedsRebuild())return;const t=this.GetEffectList().GetActiveEffectTypes();this._effectChain.BuildSteps(t.map((e=>e.GetShaderProgram())),{indexMap:t.map((e=>e.GetIndex())),forcePostDraw:e,useFullSurface:!0}),this._needsRebuildEffectChainSteps=!1,this._wasFullScreenQualityLow=e}UpdateActiveEffects(){this.GetEffectList().UpdateActiveEffects(),this._needsRebuildEffectChainSteps=!0}GetMinLayerScale(){let e=this._allLayersFlat[0].GetNormalScale();for(let t=1,s=this._allLayersFlat.length;t<s;++t){const s=this._allLayersFlat[t];0===s.GetParallaxX()&&0===s.GetParallaxY()||(e=Math.min(e,s.GetNormalScale()))}return e}_GetScrollBoundMarginHorizontal(){return.5*this._runtime.GetViewportWidth()/this.GetMinLayerScale()}_GetScrollBoundMarginVertical(){return.5*this._runtime.GetViewportHeight()/this.GetMinLayerScale()}GetScrollLeftBound(){return this.IsUnboundedScrolling()?-1/0:this._GetScrollBoundMarginHorizontal()}GetScrollRightBound(){return this.IsUnboundedScrolling()?1/0:this.GetWidth()-this._GetScrollBoundMarginHorizontal()}GetScrollTopBound(){return this.IsUnboundedScrolling()?-1/0:this._GetScrollBoundMarginVertical()}GetScrollBottomBound(){return this.IsUnboundedScrolling()?1/0:this.GetHeight()-this._GetScrollBoundMarginVertical()}SetScrollX(e){const t=this.GetScrollLeftBound(),s=this.GetScrollRightBound();e>s&&(e=s),e<t&&(e=t),this._scrollX!==e&&(this._scrollX=e,this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}GetScrollX(){return this._scrollX}SetScrollY(e){const t=this.GetScrollTopBound(),s=this.GetScrollBottomBound();e>s&&(e=s),e<t&&(e=t),this._scrollY!==e&&(this._scrollY=e,this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}GetScrollY(){return this._scrollY}IsUnboundedScrolling(){return this._isUnboundedScrolling}BoundScrolling(){this.SetScrollX(this.GetScrollX()),this.SetScrollY(this.GetScrollY());for(const e of this._allLayersFlat)e.IsOwnScrollPositionEnabled()&&(e.SetScrollX(e.GetScrollX()),e.SetScrollY(e.GetScrollY()))}SetVanishingPointXY(e,t){this._vanishingPointX===e&&this._vanishingPointY===t||(this._vanishingPointX=e,this._vanishingPointY=t,this.IsPerspectiveProjection()&&(this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged(),this._runtime.UpdateRender()))}GetVanishingPointX(){return this.IsOrthographicProjection()?.5:this._vanishingPointX}GetVanishingPointY(){return this.IsOrthographicProjection()?.5:this._vanishingPointY}HasVanishingPointOutsideViewport(){const e=this.GetVanishingPointX(),t=this.GetVanishingPointY();return e<0||e>1||t<0||t>1}SetPerspectiveProjection(){this._isOrthographicProjection&&(this._isOrthographicProjection=!1,this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}SetOrthographicProjection(){this._isOrthographicProjection||(this._isOrthographicProjection=!0,this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}IsOrthographicProjection(){return this._isOrthographicProjection}IsPerspectiveProjection(){return!this.IsOrthographicProjection()}Set3DCameraEnabled(e){e=!!e,this._is3dCameraEnabled!==e&&(this._is3dCameraEnabled=e,this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}Is3DCameraEnabled(){return this._is3dCameraEnabled}Set3DCameraOrientation(e,t,s,n,i,r,a,o,l){Uf(this._cam3dposition,e,t,s)&&Uf(this._cam3dlook,n,i,r)&&Uf(this._cam3dup,a,o,l)||(Qf.set(this._cam3dposition,e,t,s),Qf.set(this._cam3dlook,n,i,r),Qf.set(this._cam3dup,a,o,l),this.Set3DCameraChanged())}Set3DCameraChanged(){this._SetAllLayersMVChanged(),this._runtime.UpdateRender()}Get3DCameraPosition(){return this._cam3dposition}Get3DCameraLookAt(){return this._cam3dlook}Get3DCameraUpVector(){return this._cam3dup}GetScale(){return this._scale}SetScale(e){this._scale!==e&&(this._scale=e,this._SetAllLayersMVChanged(),this.BoundScrolling(),this._runtime.UpdateRender())}SetAngle(e){e=zf.clampAngle(e),this._angle!==e&&(this._angle=e,this._SetAllLayersMVChanged(),this._runtime.UpdateRender())}GetAngle(){return this._angle}GetWidth(){return this._width}SetWidth(e){!isFinite(e)||e<1||(this._width=e)}GetHeight(){return this._height}SetHeight(e){!isFinite(e)||e<1||(this._height=e)}GetEventSheet(){return this._eventSheet}_GetRootLayers(){return this._rootLayers}*allLayers(){for(const e of this._rootLayers)yield*e.selfAndAllSubLayers()}GetLayers(){return this._allLayersFlat}GetLayerCount(){return this._allLayersFlat.length}GetLayer(e){return"number"==typeof e?this.GetLayerByIndex(e):this.GetLayerByName(e.toString())}GetLayerByIndex(e){return e=zf.clamp(Math.floor(e),0,this._allLayersFlat.length-1),this._allLayersFlat[e]}GetLayerByName(e){return this._layersByName.get(e.toLowerCase())||null}HasLayerByName(e){return!!this.GetLayerByName(e)}GetLayerBySID(e){return this._layersBySid.get(e)||null}_SetAllLayersProjectionChanged(){for(const e of this._allLayersFlat)e._SetProjectionMatrixChanged()}_SetAllLayersMVChanged(){for(const e of this._allLayersFlat)e._SetMVMatrixChanged()}AddLayer(e,t,s){if(this.HasLayerByName(e))throw new Error(`layer name '${e}' already in use`);if(!t&&s<2)throw new Error("invalid insert position");const n=s>=2?t:t.GetParentLayer(),i=zf.New(zf.Layer,this,n,{name:e,sid:Math.floor(1e15*Math.random()),isDynamic:!0});this._InsertLayer(i,t,s),this.GetRuntime().UpdateRender(),this._ReindexAndUpdateAllLayers()}MoveLayer(e,t,s){if(!t&&s<2)throw new Error("invalid insert position");e===t&&s<2||(this._RemoveLayer(e),this._InsertLayer(e,t,s),this.GetRuntime().UpdateRender(),this._ReindexAndUpdateAllLayers())}RemoveLayer(e){if(this._RemoveLayer(e)){const t=this._runtime.GetEventSheetManager();t.BlockFlushingInstances(!0),e.Release(),t.BlockFlushingInstances(!1),this.GetRuntime().UpdateRender(),this._ReindexAndUpdateAllLayers()}}RemoveAllDynamicLayers(){const e=new Set;for(const t of this.allLayers())t.IsDynamic()&&!t.HasAnyDynamicParentLayer()&&e.add(t);if(0===e.size)return;const t=this._runtime.GetEventSheetManager();t.BlockFlushingInstances(!0);for(const t of e)this._RemoveLayer(t),t.Release();t.BlockFlushingInstances(!1),this.GetRuntime().UpdateRender(),this._ReindexAndUpdateAllLayers()}_InsertLayer(e,t,s){if(s>=2)if(t){if(t===e||t.HasParentLayer(e))throw new Error(`cannot move layer '${e.GetName()}' to sub-layer of itself`);t._AddSubLayer(e,2===s),e._SetParentLayer(t)}else 2===s?this._rootLayers.push(e):this._rootLayers.unshift(e),e._SetParentLayer(null);else{const n=t.GetParentLayer();if(n){if(t.HasParentLayer(e))throw new Error(`cannot move layer '${e.GetName()}' to sub-layer of itself`);n._InsertSubLayer(e,t,0===s),e._SetParentLayer(n)}else{let n=this._rootLayers.indexOf(t);if(-1===n)throw new Error("cannot find layer to insert by");0===s&&++n,this._rootLayers.splice(n,0,e),e._SetParentLayer(null)}}}_RemoveLayer(e){const t=e.GetParentLayer();if(t)return t._RemoveSubLayer(e),!0;if(this._rootLayers.length>1){const t=this._rootLayers.indexOf(e);if(-1===t)throw new Error("cannot find layer to remove");return this._rootLayers.splice(t,1),!0}return!1}_ReindexLayers(){this._allLayersFlat=[...this.allLayers()],this._layersByName.clear(),this._layersBySid.clear();for(let e=0,t=this._allLayersFlat.length;e<t;++e){const t=this._allLayersFlat[e];t._SetIndex(e),this._layersByName.set(t.GetName().toLowerCase(),t),this._layersBySid.set(t.GetSID(),t)}}_ReindexHTMLLayers(){let e=0;for(const t of this._rootLayers){for(const s of t.selfAndAllSubLayers())s._SetHTMLIndex(e);t.IsHTMLElementsLayer()&&e++}}GetHTMLLayerCount(){return this._rootLayers.at(-1).GetHTMLIndex()+1}async _ReindexAndUpdateAllLayers(){this._ReindexLayers(),this._ReindexHTMLLayers(),this._pendingSetHTMLLayerCount=this.GetHTMLLayerCount()}_GetPendingSetHTMLLayerCount(){return this._pendingSetHTMLLayerCount}_ResetPendingHTMLLayerCount(){this._pendingSetHTMLLayerCount=-1}GetRootLayersForHTMLLayer(e){const t=[];for(const s of this._rootLayers){const n=s.GetHTMLIndex();if(n===e)t.push(s);else if(n>e)break}return t}SaveTransform(){return{scrollX:this.GetScrollX(),scrollY:this.GetScrollY(),scale:this.GetScale(),angle:this.GetAngle(),vpX:this.GetVanishingPointX(),vpY:this.GetVanishingPointY()}}RestoreTransform(e){this.SetScrollX(e.scrollX),this.SetScrollY(e.scrollY),this.SetScale(e.scale),this.SetAngle(e.angle),this.SetVanishingPointXY(e.vpX,e.vpY)}GetLayoutBackgroundColor(){let e=this._rootLayers.filter((e=>e.ShouldDraw()))[0];for(;e;){if(!e.IsTransparent())return $f.copyRgb(e.GetBackgroundColor()),$f.setA(1),$f;if(e.UsesOwnTexture())return $f.setRgba(0,0,0,0),$f;e=e.GetSubLayers().filter((e=>e.ShouldDraw()))[0]}return $f.setRgba(0,0,0,0),$f}IsFirstVisit(){return this._isFirstVisit}_GetInitialObjectClasses(){return[...this._initialObjectClasses]}_AddInitialObjectClass(e){if(e.IsInContainer())for(const t of e.GetContainer().GetObjectTypes())this._initialObjectClasses.add(t);else this._initialObjectClasses.add(e)}_GetTextureLoadedObjectTypes(){return[...this._textureLoadedTypes]}_Load(e,t){if(e===this||!t)return Promise.resolve();e&&(zf.CopySet(this._textureLoadedTypes,e._textureLoadedTypes),e._textureLoadedTypes.clear());const s=[];for(const e of this._initialObjectClasses)this._textureLoadedTypes.has(e)||(s.push(e.LoadTextures(t)),this._textureLoadedTypes.add(e));return Promise.all(s)}async MaybeLoadTexturesFor(e){if(e.IsFamily())throw new Error("cannot load textures for family");const t=this._runtime.GetRenderer();if(!t||t.IsContextLost()||this._textureLoadedTypes.has(e))return;this._textureLoadedTypes.add(e);const s=e.LoadTextures(t);this._AddPendingTextureLoadPromise(s),await s,e.OnDynamicTextureLoadComplete(),this._runtime.UpdateRender()}_AddPendingTextureLoadPromise(e){this._textureLoadPendingPromises.add(e),e.then((()=>this._textureLoadPendingPromises.delete(e))).catch((()=>this._textureLoadPendingPromises.delete(e)))}WaitForPendingTextureLoadsToComplete(){return Promise.all([...this._textureLoadPendingPromises])}MaybeUnloadTexturesFor(e){if(e.IsFamily()||e.GetInstanceCount()>0)throw new Error("cannot unload textures");const t=this._runtime.GetRenderer();t&&this._textureLoadedTypes.has(e)&&(this._textureLoadedTypes.delete(e),e.ReleaseTextures(t))}_Unload(e,t){if(e!==this&&t)for(const t of this._textureLoadedTypes)t.IsGlobal()||e._initialObjectClasses.has(t)||(t.ReleaseTextures(),this._textureLoadedTypes.delete(t))}_OnRendererContextLost(){this._textureLoadedTypes.clear()}async _StartRunning(e){const t=this._runtime,s=this._layoutManager,n=t.GetEventSheetManager();this._eventSheetName&&(this._eventSheet=n.GetEventSheetByName(this._eventSheetName),this._eventSheet._UpdateDeepIncludes()),s._SetMainRunningLayout(this),this._width=this._originalWidth,this._height=this._originalHeight,this._scrollX=t.GetOriginalViewportWidth()/2,this._scrollY=t.GetOriginalViewportHeight()/2,this.BoundScrolling(),this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged(),this._ReindexHTMLLayers(),await this._runtime.GetCanvasManager().SetHTMLLayerCount(this.GetHTMLLayerCount(),!0),this._MoveGlobalObjectsToThisLayout(e),this._runtime.SetUsingCreatePromises(!0),this._CreateInitialInstances(),this._isFirstVisit||this._CreatePersistedInstances(),this._CreateAndLinkContainerInstances(this._createdInstances),this._CreateAndLinkContainerInstances(this._createdPersistedInstances),this._CreateInitialNonWorldInstances(),s.ClearPendingChangeLayout(),t.FlushPendingInstances(),this._runtime.SetUsingCreatePromises(!1);const i=this._runtime.GetCreatePromises();if(await Promise.all(i),zf.clearArray(i),!t.IsLoadingState()){for(const e of this._createdInstances)e.SetupInitialSceneGraphConnections();for(const e of this._createdPersistedInstances)e.SetupPersistedSceneGraphConnections(this._createdPersistedInstancesToDataMap,this._createdPersistedIndexToInstanceMap);for(const[e,t]of Object.entries(this._persistData)){const s=this._runtime.GetObjectClassBySID(parseInt(e,10));s&&!s.IsFamily()&&s.HasPersistBehavior()&&zf.clearArray(t)}for(const e of this._createdInstances)e._TriggerOnCreated();for(const e of this._createdPersistedInstances)e._TriggerOnCreated();for(const e of this._createdInstances)e.HasParent()||e._OnHierarchyReady();for(const e of this._createdPersistedInstances)e.HasParent()||e._OnHierarchyReady()}zf.clearArray(this._createdInstances),zf.clearArray(this._createdPersistedInstances),this._createdPersistedInstancesToDataMap.clear(),this._createdPersistedIndexToInstanceMap.clear(),await Promise.all([...this._initialObjectClasses].map((e=>e.PreloadTexturesWithInstances(this._runtime.GetRenderer())))),e&&(t.Dispatcher().dispatchEvent(new zf.Event("beforefirstlayoutstart")),await t.DispatchUserScriptEventAsyncWait(new zf.Event("beforeprojectstart"))),await this.DispatchRuntimeUserScriptEventAsyncWait(new zf.Event("beforeanylayoutstart")),t.Dispatcher().dispatchEvent(new zf.Event("beforelayoutstart")),await this.DispatchUserScriptEventAsyncWait(new zf.Event("beforelayoutstart")),t.IsLoadingState()||await t.TriggerAsync(zf.Plugins.System.Cnds.OnLayoutStart,null,null),t.Dispatcher().dispatchEvent(new zf.Event("afterlayoutstart")),await this.DispatchUserScriptEventAsyncWait(new zf.Event("afterlayoutstart")),await this.DispatchRuntimeUserScriptEventAsyncWait(new zf.Event("afteranylayoutstart")),e&&(t.Dispatcher().dispatchEvent(new zf.Event("afterfirstlayoutstart")),await t.DispatchUserScriptEventAsyncWait(new zf.Event("afterprojectstart"))),n._RunQueuedTriggers(s),await this.WaitForPendingTextureLoadsToComplete(),this._isFirstVisit=!1}_MoveGlobalObjectsToThisLayout(e){for(const e of this._runtime.GetAllObjectClasses())if(!e.IsFamily()&&e.IsWorldType())for(const t of e.GetInstances()){const e=t.GetWorldInfo(),s=e.GetLayer(),n=zf.clamp(s.GetIndex(),0,this._allLayersFlat.length-1),i=this._allLayersFlat[n];e._SetLayer(i,!0),i._MaybeAddInstance(t)}if(!e)for(const e of this._allLayersFlat)e._SortInstancesByLastCachedZIndex(!1)}_CreateInitialInstances(){for(const e of this._allLayersFlat)e.CreateInitialInstances(this._createdInstances),e._Start()}_CreatePersistedInstances(){let e=!1;for(const[t,s]of Object.entries(this._persistData)){const n=this._runtime.GetObjectClassBySID(parseInt(t,10));if(n&&!n.IsFamily()&&n.HasPersistBehavior())for(const t of s){let s=null;if(n.IsWorldType()&&(s=t.hasOwnProperty("instJson")?this.GetLayerBySID(t.instJson.w.l):this.GetLayerBySID(t.w.l),!s))continue;const i=this._runtime.CreateInstanceFromData(n,s,!1,0,0,!0);t.hasOwnProperty("instJson")?i.LoadFromJson(t.instJson):i.LoadFromJson(t),e=!0,this._createdPersistedInstances.push(i),t.hasOwnProperty("instJson")&&(this._createdPersistedInstancesToDataMap.set(i,t),this._createdPersistedIndexToInstanceMap.set(t.index,i))}}for(const e of this._allLayersFlat)e._SortInstancesByLastCachedZIndex(!0),e.SetZIndicesChanged();e&&(this._runtime.FlushPendingInstances(),this._runtime._RefreshUidMap())}_CreateAndLinkContainerInstances(e){for(const t of e){if(!t.IsInContainer())continue;const s=t.GetWorldInfo(),n=t.GetIID();for(const i of t.GetObjectClass().GetContainer().objectTypes()){if(i===t.GetObjectClass())continue;const r=i.GetInstances();if(r.length>n)t._AddSibling(r[n]);else{let n;n=s?this._runtime.CreateInstanceFromData(i,s.GetLayer(),!0,s.GetX(),s.GetY(),!0):this._runtime.CreateInstanceFromData(i,null,!0,0,0,!0),this._runtime.FlushPendingInstances(),i._UpdateIIDs(),t._AddSibling(n),e.push(n)}}}}_CreateInitialNonWorldInstances(){for(const e of this._initialNonWorld)this._runtime.GetObjectClassByIndex(e[1]).IsInContainer()||this._runtime.CreateInstanceFromData(e,null,!0)}_CreateGlobalNonWorlds(){const e=[],t=this._initialNonWorld;let s=0;for(let n=0,i=t.length;n<i;++n){const i=t[n],r=this._runtime.GetObjectClassByIndex(i[1]);r.IsGlobal()?r.IsInContainer()&&r.GetContainer().HasAnyWorldType()||e.push(this._runtime.CreateInstanceFromData(i,null,!0)):(t[s]=i,++s)}zf.truncateArray(t,s),this._runtime.FlushPendingInstances(),this._CreateAndLinkContainerInstances(e)}RecreateInitialObjects(e,t,s,n,i,r,a){if(s)return s.RecreateInitialObjects(e,t,i,r,n,a);{const s=[];for(const o of this._allLayersFlat)s.push(o.RecreateInitialObjects(e,t,i,r,n,a));return s.flat()}}async _StopRunning(){const e=this._layoutManager;this._runtime.IsLoadingState()||(await this.DispatchRuntimeUserScriptEventAsyncWait(new zf.Event("beforeanylayoutend")),await this.DispatchUserScriptEventAsyncWait(new zf.Event("beforelayoutend")),await this._runtime.TriggerAsync(zf.Plugins.System.Cnds.OnLayoutEnd,null,null),await this.DispatchUserScriptEventAsyncWait(new zf.Event("afterlayoutend")),await this.DispatchRuntimeUserScriptEventAsyncWait(new zf.Event("afteranylayoutend"))),e.SetIsEndingLayout(!0),this._runtime.GetEventSheetManager().ClearAllScheduledWaits(),this._isFirstVisit||this._SavePersistData();for(const e of this._allLayersFlat)e._End();for(const e of this._runtime.GetAllObjectClasses())if(!(e.IsGlobal()||e.IsWorldType()||e.GetPlugin().IsSingleGlobal()||e.IsFamily())){for(const t of e.GetInstances())this._runtime.DestroyInstance(t);this._runtime.FlushPendingInstances()}e.SetIsEndingLayout(!1),e.GetMainRunningLayout()===this&&e._SetMainRunningLayout(null)}_SaveInstanceToPersist(e,t){const s=e.GetObjectClass().GetSID().toString();this._persistData.hasOwnProperty(s)||(this._persistData[s]=[]);const n=this._persistData[s],i={index:t,instJson:e.SaveToJson(),sceneGraphJson:{children:[]}};n.push(i),this._persistedIntances.set(e,i)}_SaveSceneGraphInfoToPersist(e){const t=this._persistedIntances.get(e);for(const s of e.GetChildren()){const e=this._persistedIntances.get(s);e&&t.sceneGraphJson.children.push({index:e.index,flags:zf.SceneGraphInfo._GetFlagsNumber(s.GetWorldInfo())})}}_SavePersistData(){this._persistedIntances.clear();let e=0;for(const t of this._allLayersFlat){t._UpdateZIndices();for(const s of t._GetInstances()){const t=s.GetObjectClass();!t.IsGlobal()&&t.HasPersistBehavior()&&(this._SaveInstanceToPersist(s,e),e++)}}for(const e of this._allLayersFlat)for(const t of e._GetInstances()){const e=t.GetObjectClass();!e.IsGlobal()&&e.HasPersistBehavior()&&this._SaveSceneGraphInfoToPersist(t)}this._persistedIntances.clear()}ResetPersistData(){this._persistData={},this._isFirstVisit=!0}GetRenderTarget(){return this._curRenderTarget}UsesOwnTexture(){const e=this._runtime,t=e.GetRenderer().IsWebGL();return"low"===e.GetCanvasManager().GetCurrentFullscreenScalingQuality()||t&&e.UsesAnyBackgroundBlending()||this._effectList.HasAnyActiveEffect()||t&&e.Uses3DFeatures()}_MaybeStartDrawToOwnTexture(e){const t=this._runtime.GetCanvasManager();if(this.UsesOwnTexture()){e.SetRenderTarget(null),e.ClearRgba(0,0,0,0);const s={sampling:this._runtime.GetSampling(),isSampled:e.IsWebGPU()||this._runtime.UsesAnyBackgroundBlending()||this._effectList.HasAnyActiveEffect(),canReadPixels:!!e.IsWebGPU()&&this._runtime.UsesAnyBackgroundBlending()};"low"===t.GetCurrentFullscreenScalingQuality()&&(s.width=t.GetDrawWidth(),s.height=t.GetDrawHeight()),this._curRenderTarget=this._runtime.GetAdditionalRenderTarget(s)}else this._curRenderTarget=null}_MaybeCopyOwnTextureToBackbuffer(e){this._runtime._NeedsHTMLLayerCompositing(e)&&(e.SetDepthEnabled(!1),e.SetRenderTarget(null),e.SetTextureFillMode(),e.CopyRenderTarget(this._curRenderTarget))}_MaybeEndDrawToOwnTexture(e){this.UsesOwnTexture()&&(e.SetDepthEnabled(!1),this._DrawLayoutOwnTextureToRenderTarget(e,this._curRenderTarget))}DrawMain(e){e.SetRenderTarget(this._curRenderTarget),e.Clear(this.GetLayoutBackgroundColor()),this._runtime.Uses3DFeatures()&&e.ClearDepth();const t=this.GetRootLayersForHTMLLayer(0);this._DrawLayerList(e,this._curRenderTarget,t,!0),e.IsWebGPU()&&e.StartMeasuringRenderPassTime(0,1),this._MaybeEndDrawToOwnTexture(e),this._curRenderTarget=null}DrawForHTMLLayerIndex(e,t){let s=null;this._runtime._NeedsHTMLLayerCompositing(e)&&(s=this._curRenderTarget),e.SetRenderTarget(s),e.ClearRgba(0,0,0,0),this._runtime.Uses3DFeatures()&&e.ClearDepth();const n=this.GetRootLayersForHTMLLayer(t);this._DrawLayerList(e,s,n,!0),this._MaybeCopyOwnTextureToBackbuffer(e),e.EndBatch(),this._runtime.GetCanvasManager().BlitMainCanvasToHTMLLayerCanvas(t)}_DrawLayerList(e,t,s,n){const i=s.filter((e=>e.ShouldDraw()));for(let s=0,r=i.length;s<r;){const a=i[s];if(a.SelfAndAllSubLayersHave3DCamera()&&!a.SelfOrAnySubLayerUsesOwnTexture()){em.push(a);for(let e=s+1;e<r;++e){const t=i[e];if(!t.SelfAndAllSubLayersHave3DCamera()||t.SelfOrAnySubLayerUsesOwnTexture())break;em.push(i[e])}if(em.length>=2||1===em.length&&em[0].HasAnyVisibleSubLayer()){this._Draw3DLayers(e,t,em),s+=em.length,zf.clearArray(em);continue}zf.clearArray(em)}a.Draw(e,t,n&&0===s),++s}}_DrawLayoutOwnTextureToRenderTarget(e,t){const s=this._effectList.GetActiveEffectTypes(),n=this._runtime;0===s.length?(e.SetRenderTarget(null),e.SetTextureFillMode(),e.CopyRenderTarget(t),e.InvalidateRenderTarget(t),n.ReleaseAdditionalRenderTarget(t)):(Kf.set(0,0,n.GetViewportWidth(),n.GetViewportHeight()),this.GetEffectChain().Render(e,null,{contentObject:this,blendMode:3,devicePixelRatio:this._runtime.GetEffectDevicePixelRatioParam(),layerScale:this._runtime.GetEffectLayerScaleParam()*this.GetScale(),layerAngle:this.GetAngle(),layoutRect:Kf,drawSurfaceRect:null,invalidateRenderTargets:!0}))}_Draw3DLayers(e,t,s){s[0].IsTransparent()||($f.copyRgb(s[0].GetBackgroundColor()),$f.setA(1),e.Clear($f)),this._runtime.GetCanvasManager(),e.SetDepthEnabled(!0);const n=tm,i=sm,r=nm;for(const e of s)e._UpdateZIndices(),e._AppendAllInstancesIncludingSubLayersInDrawOrder(n);const a=s[0],o=a._MaybeStartWebGLProfiling(e);a._MaybeStartWebGPUProfiling(e);for(let s=0,a=n.length;s<a;){const o=n[s],l=o.GetWorldInfo(),c=l.GetLayer();if(!l.IsVisible()||!l.IsInViewport3D(c._GetViewFrustum())){++s;continue}(!o.RendersToOwnZPlane()||l.GetDepth()>0)&&r.push(o);const h=o.GetWorldInfo().GetTotalZElevation();i.push(o);let _=s+1;for(;_<a;++_){const e=n[_],t=e.GetWorldInfo();if(t.IsVisible()&&t.IsInViewport3D(t.GetLayer()._GetViewFrustum())){if(t.GetTotalZElevation()!==h)break;e.RendersToOwnZPlane()?(t.GetDepth()>0&&r.push(e),i.push(e)):r.push(e)}}if(1!==i.length||i[0].MustMitigateZFighting()){this._Draw3DLayersCoplanarInstances(e,t,i);for(let s=0,n=r.length;s<n;++s){const n=r[s],i=n.GetWorldInfo(),a=i.GetLayer();i._SetDrawNonBackFacesOnly(!0),Hf(a,e),a._DrawInstanceMaybeWithEffects(n,i,e,t),i._SetDrawNonBackFacesOnly(!1)}}else{Hf(c,e),c._DrawInstanceMaybeWithEffects(o,l,e,t);for(let s=0,n=r.length;s<n;++s){const n=r[s];if(n===o)continue;const i=n.GetWorldInfo(),a=i.GetLayer();Hf(a,e),a._DrawInstanceMaybeWithEffects(n,i,e,t)}}s=_,zf.clearArray(i),zf.clearArray(r)}o&&e.EndQuery(o),zf.clearArray(n),im=null}_Draw3DLayersCoplanarInstances(e,t,s){e.CoplanarStartStencilPass();for(let t=0,n=s.length;t<n;++t){const n=s[t],i=n.GetWorldInfo(),r=i.GetLayer();i._SetDrawBackFaceOnly(!0),Hf(r,e),r._DrawInstance(n,i,e)}e.CoplanarStartColorPass();for(let n=0,i=s.length;n<i;++n){const i=s[n],r=i.GetWorldInfo(),a=r.GetLayer();Hf(a,e),a._DrawInstanceMaybeWithEffects(i,r,e,t),r._SetDrawBackFaceOnly(!1)}e.CoplanarRestoreStandardRendering()}_SaveToJson(){const e={sx:this.GetScrollX(),sy:this.GetScrollY(),s:this.GetScale(),a:this.GetAngle(),w:this.GetWidth(),h:this.GetHeight(),ortho:this.IsOrthographicProjection(),vpX:this.GetVanishingPointX(),vpY:this.GetVanishingPointY(),fv:this._isFirstVisit,persist:this._persistData,fx:this._effectList.SaveToJson(),layers:{},dynamicLayers:[]};for(const t of this._allLayersFlat)if(t.IsDynamic()){const s=t.GetParentLayer();e.dynamicLayers.push({sid:t.GetSID(),name:t.GetName(),parentSid:s?s.GetSID():null,siblingIndex:t._GetSiblingIndex(),data:t._SaveToJson()})}else e.layers[t.GetSID().toString()]=t._SaveToJson();return e}_LoadFromJson(e){this._scrollX=e.sx,this._scrollY=e.sy,this._scale=e.s,this._angle=e.a,this._width=e.w,this._height=e.h,this._isOrthographicProjection=!!e.ortho,e.hasOwnProperty("vpX")&&(this._vanishingPointX=e.vpX),e.hasOwnProperty("vpY")&&(this._vanishingPointY=e.vpY),this._isFirstVisit=!!e.fv,this._persistData=e.persist,this._effectList.LoadFromJson(e.fx),this._needsRebuildEffectChainSteps=!0;for(const[t,s]of Object.entries(e.layers)){const e=parseInt(t,10),n=this.GetLayerBySID(e);n&&n._LoadFromJson(s)}if(e.hasOwnProperty("dynamicLayers")){this.RemoveAllDynamicLayers(),this._runtime.FlushPendingInstances();const t=new Map,s=e.dynamicLayers;for(let e=s.length-1;e>=0;--e){const n=s[e],i=n.sid,r=n.name,a=n.parentSid,o=n.siblingIndex,l=n.data;if(this._ReindexLayers(),this.HasLayerByName(r)||this.GetLayerBySID(i))continue;let c,h;if(null===a)c=null,h=this._rootLayers;else{if(c=this.GetLayerBySID(a),!c)continue;h=c.GetSubLayers()}const _=zf.New(zf.Layer,this,c,{name:r,sid:i,isDynamic:!0});h.push(_);let u=t.get(h);u||(u=[],t.set(h,u)),u.push({layer:_,siblingIndex:o}),_._LoadFromJson(l)}for(const[e,s]of t){s.sort(((e,t)=>e.siblingIndex-t.siblingIndex));for(const t of s){const s=t.layer,n=t.siblingIndex;let i=e.indexOf(s);e.splice(i,1),e.splice(n,0,s)}}}this._ReindexAndUpdateAllLayers(),this._SetAllLayersProjectionChanged(),this._SetAllLayersMVChanged()}GetILayout(){return this._iLayout}UserScriptDispatcher(){return this._userScriptDispatcher}DispatchUserScriptEvent(e){e.layout=this.GetILayout();const t=this._runtime,s=t.IsDebug()&&!t.GetEventSheetManager().IsInEventEngine();s&&Xf.StartMeasuringScriptTime(),this._userScriptDispatcher.dispatchEvent(e),s&&Xf.AddScriptTime()}DispatchUserScriptEventAsyncWait(e){return e.layout=this.GetILayout(),this._userScriptDispatcher.dispatchEventAndWaitAsync(e)}DispatchRuntimeUserScriptEventAsyncWait(e){return e.layout=this.GetILayout(),this._runtime.DispatchUserScriptEventAsyncWait(e)}_LogLayerTree(){this._LogLayerList(this._rootLayers)}_LogLayerList(e,t=0){const s=e.slice(0);s.reverse();for(const e of s)console.log(`${"\t".repeat(t)}- ${e.GetName()}`),this._LogLayerList(e.GetSubLayers(),t+1)}}}{const rm=self.C3;rm.LayoutManager=class extends rm.DefendedBase{#t;#s=[];#u=new Map;#l=new Map;#n=null;#e=[];#r=null;#a=0;#d=null;constructor(e){super(),this.#t=e}Release(){this.#t=null,this.#n=null,this.#r=null,this.#d=null,rm.clearArray(this.#s),this.#u.clear(),this.#l.clear(),rm.clearArray(this.#e)}Create(e){const t=rm.New(rm.Layout,this,this.#s.length,e);this.#s.push(t),this.#u.set(t.GetName().toLowerCase(),t),this.#l.set(t.GetSID(),t)}GetRuntime(){return this.#t}SetFirstLayout(e){this.#r=e}GetFirstLayout(){if(this.#r)return this.#r;if(this.#s.length)return this.#s[0];throw new Error("no first layout")}GetLayoutByName(e){return this.#u.get(e.toLowerCase())||null}GetLayoutBySID(e){return this.#l.get(e)||null}GetLayoutByIndex(e){return e=rm.clamp(Math.floor(e),0,this.#s.length-1),this.#s[e]}GetLayout(e){return"number"==typeof e?this.GetLayoutByIndex(e):this.GetLayoutByName(e.toString())}GetAllLayouts(){return this.#s}_SetMainRunningLayout(e){this.#n=e}GetMainRunningLayout(){return this.#n}_AddRunningSubLayout(e){if(this.#e.includes(e))throw new Error("layout already running");this.#e.push(e)}_RemoveRunningSubLayout(e){const t=this.#e.indexOf(e);if(-1===t)throw new Error("layout not running");this.#e.splice(t,1)}*runningLayouts(){this.#n&&(yield this.#n),this.#e.length&&(yield*this.#e)}IsLayoutRunning(e){return this.#n===e||this.#e.includes(e)}SetIsEndingLayout(e){if(e)this.#a++;else{if(this.#a<=0)throw new Error("already unset");this.#a--}}IsEndingLayout(){return this.#a>0}ChangeMainLayout(e){this.#d=e}ClearPendingChangeLayout(){this.#d=null}IsPendingChangeMainLayout(){return!!this.#d}GetPendingChangeMainLayout(){return this.#d}SetAllLayerProjectionChanged(){const e=this.GetMainRunningLayout();e&&e._SetAllLayersProjectionChanged()}SetAllLayerMVChanged(){const e=this.GetMainRunningLayout();e&&e._SetAllLayersMVChanged()}}}{const am=self.C3,om=new RegExp("<(.+?)>","g");am.TimelineManager=class extends am.DefendedBase{constructor(e){super(),this._runtime=e,this._timelineDataManager=am.New(am.TimelineDataManager),this._pluginInstance=null,this._timelines=[],this._timelinesByName=new Map,this._objectClassToTimelineMap=new Map,this._timelinesCreatedByTemplate=new Map,this._scheduledTimelines=[],this._playingTimelines=[],this._markedForRemovalTimelines=[],this._hasRuntimeListeners=!1,this._changingLayout=!1,this._isTickingTimelines=!1,this._tickFunc=()=>this._OnTick(),this._tick2Func=()=>this._OnTick2(),this._beforeLayoutChange=()=>this._OnBeforeChangeLayout(),this._layoutChange=()=>this._OnAfterChangeLayout(),this._instanceDestroy=e=>this._OnInstanceDestroy(e.instance),this._beforeLoad=e=>this._OnBeforeLoad(),this._afterLoad=e=>this._OnAfterLoad(),this._afterLayoutStart=e=>this._OnAfterLayoutStart(),this._destroyedWhileLoadingState=[],this._renderChange=0}Release(){this.RemoveRuntimeListeners(),this._tickFunc=null,this._tick2Func=null,this._beforeLayoutChange=null,this._layoutChange=null,this._instanceDestroy=null,this._afterLoad=null;for(const e of this._timelines)e.Stop(),e.Release();am.clearArray(this._timelines),this._timelines=null,this._timelineDataManager.Release(),this._timelineDataManager=null,am.clearArray(this._scheduledTimelines),this._scheduledTimelines=null,am.clearArray(this._playingTimelines),this._playingTimelines=null,am.clearArray(this._markedForRemovalTimelines),this._markedForRemovalTimelines=null,this._timelinesByName.clear(),this._timelinesByName=null,this._objectClassToTimelineMap.clear(),this._objectClassToTimelineMap=null,this._timelinesCreatedByTemplate.clear(),this._timelinesCreatedByTemplate=null,am.clearArray(this._destroyedWhileLoadingState),this._destroyedWhileLoadingState=null,this._runtime=null}AddRuntimeListeners(){const e=this._runtime.Dispatcher();e.addEventListener("pretick",this._tickFunc),e.addEventListener("tick2",this._tick2Func),e.addEventListener("beforelayoutchange",this._beforeLayoutChange),e.addEventListener("layoutchange",this._layoutChange),e.addEventListener("instancedestroy",this._instanceDestroy),e.addEventListener("beforeload",this._beforeLoad),e.addEventListener("afterload",this._afterLoad),e.addEventListener("afterlayoutstart",this._afterLayoutStart)}RemoveRuntimeListeners(){const e=this._runtime.Dispatcher();e.removeEventListener("pretick",this._tickFunc),e.removeEventListener("tick2",this._tick2Func),e.removeEventListener("beforelayoutchange",this._beforeLayoutChange),e.removeEventListener("layoutchange",this._layoutChange),e.removeEventListener("instancedestroy",this._instanceDestroy),e.removeEventListener("beforeload",this._beforeLoad),e.removeEventListener("afterload",this._afterLoad),e.removeEventListener("afterlayoutstart",this._afterLayoutStart)}Create(e){this._timelineDataManager.Add(e);const t=am.TimelineState.CreateInitial(e,this);this.Add(t),this.SetTimelineObjectClassesToMap(t),this._timelinesCreatedByTemplate.set(t.GetName(),0)}CreateFromTemplate(e){const t=this.GetTimelineDataManager(),s=e.GetTemplateName(),n=t.Get(s),i=am.TimelineState.CreateFromTemplate(`${s}:${this._timelinesCreatedByTemplate.get(s)}`,n,this);return this._IncreaseTemplateTimelinesCount(s),this.Add(i),i}_IncreaseTemplateTimelinesCount(e){this._timelinesCreatedByTemplate.set(e,this._timelinesCreatedByTemplate.get(e)+1)}_SetCreatedTemplateTimelinesCount(){for(const e of this._timelines){if(e.IsTemplate())continue;const t=e.GetTemplateName();this._IncreaseTemplateTimelinesCount(t)}}_ClearCreatedTemplateTimelinesCount(){for(const e of this._timelinesCreatedByTemplate.keys())this._timelinesCreatedByTemplate.set(e,0)}Add(e){this._timelines.push(e),this._timelinesByName.set(e.GetName().toLowerCase(),e)}Remove(e){e.Removed(),e.IsTemplate()||(am.arrayFindRemove(this._timelines,e),am.arrayFindRemove(this._scheduledTimelines,e),am.arrayFindRemove(this._playingTimelines,e),am.arrayFindRemove(this._markedForRemovalTimelines,e),this._timelinesByName.delete(e.GetName().toLowerCase()),this.RemoveTimelineFromObjectClassMap(e),e.IsReleased()||e.Release())}Trigger(e){this._runtime.Trigger(e,this._pluginInstance,null)}GetRuntime(){return this._runtime}GetTimelineDataManager(){return this._timelineDataManager}SetPluginInstance(e){this._pluginInstance=e}GetPluginInstance(){return this._pluginInstance}*GetTimelines(){for(const e of this._timelines)yield e}*GetPlayingTimelines(){for(const e of this._playingTimelines)yield e}SetTimelineObjectClassToMap(e,t){this._objectClassToTimelineMap.has(e)||this._objectClassToTimelineMap.set(e,new Set),this._objectClassToTimelineMap.get(e).add(t)}SetTimelineObjectClassesToMap(e){for(const t of e.GetObjectClasses())this.SetTimelineObjectClassToMap(t,e)}RemoveTimelineFromObjectClassMap(e){for(const[t,s]of this._objectClassToTimelineMap.entries())s.has(e)&&(s.delete(e),0===s.size&&this._objectClassToTimelineMap.delete(t))}GetTimelinesForObjectClass(e){if(this._objectClassToTimelineMap.has(e))return this._objectClassToTimelineMap.get(e)}GetTimelineOfTemplateForInstances(e,t){if(t)for(const s of this._timelines)if(t.every((e=>s.HasTrackInstance(e.instance,e.trackId)))&&s.GetName().includes(e.GetName()))return s}GetTimelineByName(e){return this._timelinesByName.get(e.toLowerCase())||null}GetScheduledOrPlayingTimelineByName(e){for(const t of this._scheduledTimelines)if(t.GetName()===e)return t;for(const t of this._playingTimelines)if(t.GetName()===e)return t;return null}*GetTimelinesByName(e){if(om.test(e)){let t;om.lastIndex=0;const s=new Set;do{if(t=om.exec(e),t){const e=t[1].split(",");for(const t of e)s.add(t)}}while(t);for(const e of s.values()){const t=this.GetTimelineByName(e);t&&(yield t)}s.clear()}else{const t=this.GetTimelineByName(e);t&&(yield t)}}*GetTimelinesByTags(e){for(const t of this._timelines)t.HasTags(e)&&(yield t)}AddScheduledTimeline(e){this._scheduledTimelines.includes(e)||this._scheduledTimelines.push(e),this._MaybeEnableRuntimeListeners()}RemovePlayingTimeline(e){am.arrayFindRemove(this._playingTimelines,e),this._MaybeDisableRuntimeListeners()}ScheduleTimeline(e){this._playingTimelines.includes(e)?(e.SetPlaying(!0),e.SetScheduled(!1),e.SetMarkedForRemoval(!1)):(e.SetPlaying(!1),e.SetScheduled(!0),e.SetMarkedForRemoval(!1),this._scheduledTimelines.includes(e)||this._scheduledTimelines.push(e)),this._MaybeEnableRuntimeListeners()}DeScheduleTimeline(e){e.SetPlaying(!1),e.SetScheduled(!1),e.ResolvePlayPromise(),am.arrayFindRemove(this._scheduledTimelines,e),this._MaybeDisableRuntimeListeners()}CompleteTimeline(e){e.SetPlaying(!1),e.SetScheduled(!1),this._playingTimelines.includes(e)&&(e.SetMarkedForRemoval(!0),this._markedForRemovalTimelines.push(e),am.arrayFindRemove(this._playingTimelines,e)),this._scheduledTimelines.includes(e)&&e.SetMarkedForRemoval(!0)}CompleteTimelineBeforeChangeOfLayout(e){e.SetPlaying(!1),e.SetScheduled(!1),e.SetMarkedForRemoval(!1),e.SetPlaybackRate(1),am.arrayFindRemove(this._playingTimelines,e)}CompleteTimelineAndResolve(e){this.CompleteTimeline(e),e.ResolvePlayPromise()}_OnTick(){const e=this.GetRuntime();if(e.IsLoadingState())return;if(!this._hasRuntimeListeners)return;if(this._changingLayout)return;let t=0;for(e.IsDebug()&&(t=performance.now()),this._isTickingTimelines=!0;this._scheduledTimelines.length;){const e=this._scheduledTimelines.pop();e.IsMarkedForRemoval()?(e.SetInitialStateForce(),this._markedForRemovalTimelines.push(e)):(e.SetInitialState(),this._playingTimelines.push(e)),0!==e.GetRenderChange()&&(this._renderChange=1)}const s=this._runtime._GetDtFast(),n=this._runtime.GetDt1(),i=this._runtime.GetTimeScale();for(let e=this._playingTimelines.length-1;e>=0;e--){const t=this._playingTimelines[e];t&&t.Tick(s,i,n)}this._isTickingTimelines=!1,e.IsDebug()&&globalThis.C3Debugger.AddTweensAndTimelinesTime(performance.now()-t),0!==this._renderChange&&e.UpdateRender()}_OnTick2(){const e=this.GetRuntime();if(e.IsLoadingState())return;if(!this._hasRuntimeListeners)return;if(this._changingLayout)return;let t,s=0;e.IsDebug()&&(s=performance.now());for(let e=0,s=this._markedForRemovalTimelines.length;e<s;e++){const s=this._markedForRemovalTimelines[e];t||(t=new Set),s.Removed(),this._MaybeExecuteTimelineFinishTriggers(s),t.add(s)}if(t){am.arrayRemoveAllInSet(this._markedForRemovalTimelines,t),this._renderChange=0;for(let e=0,t=this._playingTimelines.length;e<t;e++)if(0!==this._playingTimelines[e].GetRenderChange()){this._renderChange=1;break}}this._MaybeDisableRuntimeListeners(),e.IsDebug()&&globalThis.C3Debugger.AddTweensAndTimelinesTime(performance.now()-s)}_MaybeExecuteTimelineFinishTriggers(e){e.IsReleased()||e.HasValidTracks()&&e.IsComplete()&&e.InitialStateSet()&&e.FinishTriggers()}_MaybeEnableRuntimeListeners(){this._hasRuntimeListeners||(this._hasRuntimeListeners=!0)}_MaybeDisableRuntimeListeners(){this._markedForRemovalTimelines.length||this._playingTimelines.length||this._scheduledTimelines.length||this._isTickingTimelines||(this._hasRuntimeListeners=!1)}_OnBeforeChangeLayout(){for(this._changingLayout=!0;this._scheduledTimelines.length;)this.DeScheduleTimeline(this._scheduledTimelines.pop());const e=new Set;for(const t of this._playingTimelines)t._OnBeforeChangeLayout()&&(t.Removed(),e.add(t));am.arrayRemoveAllInSet(this._playingTimelines,e),e.clear();for(const t of this._markedForRemovalTimelines)t._OnBeforeChangeLayout()&&(t.Removed(),e.add(t));am.arrayRemoveAllInSet(this._markedForRemovalTimelines,e),this._MaybeDisableRuntimeListeners();for(const e of this._timelines)e.CleanCaches()}_OnAfterChangeLayout(){this._changingLayout=!1}_OnInstanceDestroy(e){const t=e.GetObjectClass(),s=this.GetTimelinesForObjectClass(t);if(s)if(this._runtime.IsLoadingState())this._destroyedWhileLoadingState.push(e);else for(const e of s)e.IsTemplate()||(e.IsReleased()?this.Remove(e):e.HasValidTracks()||(this._MaybeExecuteTimelineFinishTriggers(e),this.Remove(e)))}_OnBeforeLoad(){for(const e of this._scheduledTimelines.map((e=>e)))this._MaybeExecuteTimelineFinishTriggers(e),this.Remove(e);for(const e of this._playingTimelines.map((e=>e)))this._MaybeExecuteTimelineFinishTriggers(e),this.Remove(e)}_OnAfterLoad(){for(const e of this._destroyedWhileLoadingState)this._OnInstanceDestroy(e);am.clearArray(this._destroyedWhileLoadingState);for(const e of this._timelines)e._OnAfterLoad()}_OnAfterLayoutStart(){const e=this._runtime.GetLayoutManager().GetMainRunningLayout();if(e)for(const t of this._timelines){const s=t.GetStartOnLayout();s&&e.GetName()===s&&this.ScheduleTimeline(t)}}_SaveToJson(){return{timelinesJson:this._SaveTimelinesToJson(),scheduledTimelinesJson:this._SaveScheduledTimelinesToJson(),playingTimelinesJson:this._SavePlayingTimelinesToJson(),markedForRemovalTimelinesJson:this._SaveMarkedForRemovalTimelinesToJson(),hasRuntimeListeners:this._hasRuntimeListeners,changingLayout:this._changingLayout,isTickingTimelines:this._isTickingTimelines}}_LoadFromJson(e){e&&(this._ClearCreatedTemplateTimelinesCount(),this._LoadTimelinesFromJson(e.timelinesJson),this._LoadScheduledTimelinesFromJson(e.scheduledTimelinesJson),this._LoadPlayingTimelinesFromJson(e.playingTimelinesJson),this._LoadMarkedForRemovalTimelinesFromJson(e.markedForRemovalTimelinesJson),this._hasRuntimeListeners=!e.hasRuntimeListeners,this._changingLayout=!!e.changingLayout,this._isTickingTimelines=!!e.isTickingTimelines,this._SetCreatedTemplateTimelinesCount(),this._MaybeEnableRuntimeListeners(),this._MaybeDisableRuntimeListeners())}_SaveTimelinesToJson(){return this._timelines.map((e=>e._SaveToJson()))}_LoadTimelinesFromJson(e){for(const t of e){let e=this.GetTimelineByName(t.name);if(e)e._LoadFromJson(t);else{const s=this._GetTemplateNameFromJson(t);if(!s)continue;const n=this.GetTimelineByName(s);e=this.CreateFromTemplate(n),e._LoadFromJson(t)}e.HasTracks()||this.Remove(e)}}_GetTemplateNameFromJson(e){const t=e.name.split(":");return t&&2===t.length?t[0]:null}_SaveScheduledTimelinesToJson(){return this._SaveTimelines(this._scheduledTimelines)}_LoadScheduledTimelinesFromJson(e){this._LoadTimelines(e,this._scheduledTimelines)}_SavePlayingTimelinesToJson(){return this._SaveTimelines(this._playingTimelines)}_LoadPlayingTimelinesFromJson(e){this._LoadTimelines(e,this._playingTimelines)}_SaveMarkedForRemovalTimelinesToJson(){return this._SaveTimelines(this._markedForRemovalTimelines)}_LoadMarkedForRemovalTimelinesFromJson(e){this._LoadTimelines(e,this._markedForRemovalTimelines)}_IsTimelineInJson(e,t){if(!t)return!1;for(const s of t)if(s===e.GetName())return!0;return!1}_SaveTimelines(e){return e.map((e=>e.GetName()))}_LoadTimelines(e,t){const s=new Set;for(const n of t)this._IsTimelineInJson(n,e)||s.add(n);if(am.arrayRemoveAllInSet(t,s),e){const s=e=>t=>t.GetName()===e;for(const n of e){const e=this.GetTimelineByName(n);e&&(t.find(s(n))||t.push(e))}}}}}{const lm=self.C3,cm=100,hm=.01,_m=25,um=20,dm=5,pm=[0,0],fm=[0,0],mm=[0,0],gm=[0,0,0,0,0],Im=new Array(4),Sm=[{x:0,y:0,t:0,distance:0},{x:0,y:0,t:0,distance:0},{x:0,y:0,t:0,distance:0}],ym={x:0,y:0,t:0,distance:0};lm.TimelineInfo=class{constructor(e,t){this._initialized=!1,this._timeline=e,this._segments=[];let s=null;if(s=t?this._timeline.GetTrackById(t):lm.first(this._timeline.GetTracks()),!s)return;const n=s.GetPropertyTrack("offsetX"),i=s.GetPropertyTrack("offsetY");if(!n||!i)return;this._xTrack=n,this._yTrack=i;const r=n.GetPropertyKeyframeDataItemArrayIncludingDisabled(),a=i.GetPropertyKeyframeDataItemArrayIncludingDisabled();for(let e=1,t=Math.min(r.length,a.length);e<t;++e){const t=r[e],s=(t.GetNext(),t.GetPrevious()),n=a[e],i=(n.GetNext(),n.GetPrevious());s&&"cubic-bezier"===s.GetPathMode()&&i&&"cubic-bezier"===i.GetPathMode()?this._segments.push(lm.New(lm.TimelineCubicBezierSegmentInfo,s,i,t,n,this._segments.length)):(s&&"line"===s.GetPathMode()&&i&&i.GetPathMode(),this._segments.push(lm.New(lm.TimelineLineSegmentInfo,t,n,this._segments.length)))}this._initialized=!0}Release(){for(const e of this._segments)e.Release();lm.clearArray(this._segments),this._segments=null,this._timeline=null,this._xTrack=null,this._yTrack=null}WasInitialized(){return this._initialized}segments(){return this._segments}SetOrigin(e){const t="relative"===this._xTrack.GetResultMode()?e.GetX():0,s="relative"===this._yTrack.GetResultMode()?e.GetY():0;for(const e of this._segments)e.SetOrigin(t,s)}Project(e,t,s){let n=NaN,i=this._segments.length;for(let s=0;s<i;s++){const i=this._segments[s];if("cubic-bezier"===i.GetType()){const s=i.Project(e,t);(isNaN(n)||s[3]<n)&&(n=s[3],mm[0]=s[2],mm[1]=i.GetIndex())}}return mm}ProjectWithOptions(e,t,s){const n=s.tRange;lm.IsFiniteNumber(n[0])||(n[0]=0),lm.IsFiniteNumber(n[1])||(n[1]=1);let i=NaN,r=this._segments.length;for(let s=0;s<r;s++){const r=this._segments[s];if("cubic-bezier"===r.GetType()){const s=r.ProjectWithRange(e,t,n);(isNaN(i)||s[3]<i)&&(i=s[3],mm[0]=s[2],mm[1]=r.GetIndex())}}return mm}Tangent(e,t){return this._segments[t].Tangent(e)}TangentAngle(e,t){return this._segments[t].TangentAngle(e)}},lm.TimelineCubicBezierSegmentInfo=class{constructor(e,t,s,n,i){this._index=i;const r=e.GetAddOn("cubic-bezier"),a=s.GetAddOn("cubic-bezier"),o=t.GetAddOn("cubic-bezier"),l=n.GetAddOn("cubic-bezier");this._aX=e.GetValueWithResultMode(),this._aY=t.GetValueWithResultMode(),this._bX=e.GetValueWithResultMode()+r.GetStartAnchor(),this._bY=t.GetValueWithResultMode()+o.GetStartAnchor(),this._cX=s.GetValueWithResultMode()+a.GetEndAnchor(),this._cY=n.GetValueWithResultMode()+l.GetEndAnchor(),this._dX=s.GetValueWithResultMode(),this._dY=n.GetValueWithResultMode(),this._aXO=0,this._aYO=0,this._bXO=0,this._bYO=0,this._cXO=0,this._cYO=0,this._dXO=0,this._dYO=0,this._d0x=0,this._d0y=0,this._d1x=0,this._d1y=0,this._d2x=0,this._d2y=0,this._x1Factor=0,this._x2Factor=0,this._x3Factor=0,this._y1Factor=0,this._y2Factor=0,this._y3Factor=0,this._lutIndex=NaN,this._initialized=!1,this._len=100,this._arcLengths=new Array(this._len+1),this._arcLengths[0]=0,this._length=0,this._lut=[],this._lutObjects=[];for(let e=0;e<100;e++)this._lutObjects.push({x:0,y:0,t:0,distance:0});this._CalculateLength()}Release(){lm.clearArray(this._arcLengths),this._arcLengths=null,lm.clearArray(this._lut),this._lut=null,lm.clearArray(this._lutObjects),this._lutObjects=null}GetType(){return"cubic-bezier"}GetIndex(){return this._index}GetStepCount(){return Math.floor(this._length/25)}GetStepIncrement(){return 1/this.GetStepCount()}SetOrigin(e,t){this._originX=e,this._originY=t,this._arcLengths=new Array(this._len+1),this._arcLengths[0]=0,this._CalculateLength(),this._aXO=this._aX+this._originX,this._aYO=this._aY+this._originY,this._bXO=this._bX+this._originX,this._bYO=this._bY+this._originY,this._cXO=this._cX+this._originX,this._cYO=this._cY+this._originY,this._dXO=this._dX+this._originX,this._dYO=this._dY+this._originY,this._d0x=3*(this._bXO-this._aXO),this._d0y=3*(this._bYO-this._aYO),this._d1x=3*(this._cXO-this._bXO),this._d1y=3*(this._cYO-this._bYO),this._d2x=3*(this._dXO-this._cXO),this._d2y=3*(this._dYO-this._cYO),this._x1Factor=3*(this._bXO-this._aXO),this._x2Factor=3*(this._aXO+this._cXO-2*this._bXO),this._x3Factor=this._dXO-this._aXO+3*(this._bXO-this._cXO),this._y1Factor=3*(this._bYO-this._aYO),this._y2Factor=3*(this._aYO+this._cYO-2*this._bYO),this._y3Factor=this._dYO-this._aYO+3*(this._bYO-this._cYO)}Map(e){if(!this._initialized)return NaN;const t=this._Map(e);return fm[0]=this._X(t),fm[1]=this._Y(t),fm}Project(e,t){const s=this._GenerateLUT(100),n=this._FindClosestFromLUT(e,t,s),i=this._RefineProjection(e,t,s,n);return gm[0]=i.x,gm[1]=i.y,gm[2]=i.t,gm[3]=i.distance,gm}ProjectWithRange(e,t,s){const n=this._GenerateLUT(100),i=this._FindClosestFromLUTWithRange(e,t,n,s),r=this._RefineProjection(e,t,n,i);return gm[0]=r.x,gm[1]=r.y,gm[2]=r.t,gm[3]=r.distance,gm}Tangent(e){const t=1-e,s=t*t,n=2*t*e,i=e*e,r=s*this._d0x+n*this._d1x+i*this._d2x,a=s*this._d0y+n*this._d1y+i*this._d2y,o=lm.hypot2DFast(r,a);return pm[0]=r/o,pm[1]=a/o,pm}TangentAngle(e){const t=1-e,s=t*t,n=2*t*e,i=e*e,r=s*this._d0x+n*this._d1x+i*this._d2x,a=s*this._d0y+n*this._d1y+i*this._d2y;return Math.atan2(a,r)}_Map(e){if(!this._initialized)return;let t=e*this._arcLengths[this._len],s=0,n=this._len,i=0;for(;s<n;)i=s+((n-s)/2|0),this._arcLengths[i]<t?s=i+1:n=i;this._arcLengths[i]>t&&i--;const r=this._arcLengths[i];return r===t?i/this._len:(i+(t-r)/(this._arcLengths[i+1]-r))/this._len}_X(e){return this._initialized?self.Ease.GetRuntimeEase("cubicbezier")(e,this._aX+this._originX,this._bX+this._originX,this._cX+this._originX,this._dX+this._originX):NaN}_Y(e){return this._initialized?self.Ease.GetRuntimeEase("cubicbezier")(e,this._aY+this._originY,this._bY+this._originY,this._cY+this._originY,this._dY+this._originY):NaN}_GenerateLUT(e){if(e=e||100,this._lut.length>=e)return this._lut;this._lut=new Array(e),e++;for(let t=0;t<e-1;t++){const s=t/(e-1),n=s**2,i=s**3,r=this._x1Factor*s,a=this._x2Factor*n,o=this._x3Factor*i,l=this._y1Factor*s,c=this._y2Factor*n,h=this._y3Factor*i,_=this._aXO+r+a+o,u=this._aYO+l+c+h;this._lutObjects[t].x=_,this._lutObjects[t].y=u,this._lutObjects[t].t=s,this._lutObjects[t].distance=0,this._lut[t]=this._lutObjects[t]}return this._lut}_FindClosestFromLUT(e,t,s,n=null,i=Number.MAX_SAFE_INTEGER){let r=0;if(isNaN(this._lutIndex))for(let n=0;n<100;n++){const a=s[n],o=a.x-e,l=a.y-t;a.distance=o*o+l*l,a.distance<i&&(i=a.distance,r=n)}else{for(let n=this._lutIndex;n<this._lutIndex+5&&!(n>=s.length);n++){const a=s[n],o=a.x-e,l=a.y-t;a.distance=o*o+l*l,a.distance<i&&(i=a.distance,r=n)}for(let n=this._lutIndex;n>this._lutIndex-5&&!(n<0);n--){const a=s[n],o=a.x-e,l=a.y-t;a.distance=o*o+l*l,a.distance<i&&(i=a.distance,r=n)}}return this._lutIndex=r,r}_FindClosestFromLUTWithRange(e,t,s,n,i=Number.MAX_SAFE_INTEGER){let r=0;if(isNaN(this._lutIndex))for(let a=0;a<100;a++){const o=s[a],l=o.x-e,c=o.y-t;o.distance=l*l+c*c,o.t>=n[0]&&o.t<=n[1]&&o.distance<i&&(i=o.distance,r=a)}else{for(let a=this._lutIndex;a<this._lutIndex+5&&!(a>=s.length);a++){const o=s[a],l=o.x-e,c=o.y-t;o.distance=l*l+c*c,o.t>=n[0]&&o.t<=n[1]&&o.distance<i&&(i=o.distance,r=a)}for(let a=this._lutIndex;a>this._lutIndex-5&&!(a<0);a--){const o=s[a],l=o.x-e,c=o.y-t;o.distance=l*l+c*c,o.t>=n[0]&&o.t<=n[1]&&o.distance<i&&(i=o.distance,r=a)}}return this._lutIndex=r,r}_RefineProjection(e,t,s,n){let i=s[n],r=1,a=Number.MAX_SAFE_INTEGER;e:do{const r=s.length;let o=0===n?0:n-1,l=n===r-1?r-1:n+1,c=s[o].t,h=(s[l].t-c)/4;if(h<.001)break;Im[0]=s[o];for(let s=1;s<=2;s++){const r=c+s*h,o=r**2,l=r**3,_=this._x1Factor*r,u=this._x2Factor*o,d=this._x3Factor*l,p=this._y1Factor*r,f=this._y2Factor*o,m=this._y3Factor*l,g=this._aXO+_+u+d,I=this._aYO+p+f+m,S=g-e,y=I-t,b=S*S+y*y;if(b<a){a=b,n=s,ym.x=g,ym.y=I,ym.t=r,ym.distance=b,i=ym;break e}const G=Sm[s-1];G.x=g,G.y=I,G.t=r,G.distance=b,Im[s]=G}Im[3]=s[l],s=Im}while(r++<20);return i}_CalculateLength(){this._initialized=!0;let e=this._X(0),t=this._Y(0),s=0;for(let n=1;n<=this._len;n++){const i=this._X(.01*n),r=this._Y(.01*n),a=e-i,o=t-r;s+=lm.hypot2DFast(a,o),this._arcLengths[n]=s,e=i,t=r}this._length=s}},lm.TimelineLineSegmentInfo=class{constructor(e,t,s){this._index=s,this._targetX=e.GetValueWithResultMode(),this._targetY=t.GetValueWithResultMode(),this._originX=0,this._originY=0}Release(){}GetType(){return"line"}GetIndex(){return this._index}SetOrigin(e,t){this._originX=e,this._originY=t}GetX(){return this._targetX+this._originX}GetY(){return this._targetY+this._originY}}}{const bm=self.C3,Gm=0,vm=1;bm.TimelineState=class extends bm.DefendedBase{constructor(e,t,s){super(),this._runtime=s.GetRuntime(),this._timelineManager=s,this._timelineDataItem=t,this._name=e,this._tracks=[],this._tracksLength=0,this._beforeAndAfterTracks=null,this._beforeAndAfterTracksLength=0,this.CreateTrackStates(),this._playPromise=null,this._playResolve=null,this._playheadTime=0,this._overshoot=0,this._playbackRate=1,this._pingPongState=0,this._resumePingPongState=-1,this._currentRepeatCount=1,this._isPlaying=!1,this._isScheduled=!1,this._initialStateSet=!1,this._complete=!0,this._released=!1,this._markedForRemoval=!1,this._completedTick=-1,this._implicitPause=!1,this._isTemplate=!1,this._finishedTriggers=!1,this._firstTick=!1,this._lastDelta=NaN,this._tags=[""],this._stringTags="",this._tagsChanged=!1,this._renderChange=0,this._hasNestedContent=0,this._stoppedKeyframeDataItem=null,this._iTimelineState=null}static CreateInitial(e,t){const s=t.GetTimelineDataManager(),n=s.GetNameId(),i=s.Get(e[n]),r=bm.New(bm.TimelineState,e[n],i,t);return r.SetIsTemplate(!0),r}static CreateFromTemplate(e,t,s){return bm.New(bm.TimelineState,e,t,s)}Release(){if(this.IsReleased())return;const e=this._runtime.Dispatcher();this._timelineManager.DeScheduleTimeline(this),this._timelineManager.CompleteTimelineAndResolve(this);for(const e of this._tracks)e.Release();bm.clearArray(this._tracks),this._tracks=null,this._runtime=null,this._timelineManager=null,this._timelineDataItem=null,this._released=!0,this._playPromise=null,this._playResolve=null,this.FireReleaseEvent(e)}FireReleaseEvent(e){const t=bm.New(bm.Event,"timelinestatereleased");t.timelineState=this,e.dispatchEvent(t)}GetType(){return 0}CreateTrackStates(){for(const e of this._timelineDataItem.GetTrackData().trackDataItems())this._tracksLength=this._tracks.push(bm.TrackState.Create(this,e))}GetTimelineManager(){return this._timelineManager}GetRuntime(){return this._runtime}GetTracks(){return this._tracks}GetSimilarPropertyTracks(e,t,s,n){if(!this._hasNestedContent)return;let i;for(let r=0;r<this._tracks.length;r++){let a=this._tracks[r];if(e!==a.GetInstance())continue;const o=a.GetPropertyTrack(s);o&&t.constructor===o.GetSourceAdapter().constructor&&o.GetResultMode()===n.GetResultMode()&&(i||(i=[]),i.push(o))}return i}HasTracks(){return!!this._tracks.length}GetTrackById(e){for(const t of this._tracks)if(bm.equalsNoCase(t.GetId(),e))return t;return null}GetTrackByName(e){for(const t of this._tracks)if(!t.IsInstanceTrack()&&bm.equalsNoCase(t.GetName(),e))return t;return null}SetName(e){this._name=e}GetName(){return this._name}GetTimelineDataItem(){return this._timelineDataItem}GetTemplateName(){return this._timelineDataItem.GetName()}GetTotalTime(){return this._timelineDataItem.GetTotalTime()}SetTotalTime(e){this._timelineDataItem.SetTotalTime(e)}GetStep(){return this._timelineDataItem.GetStep()}SetStep(e){this._timelineDataItem.SetStep(e)}GetInterpolationMode(){return this._timelineDataItem.GetInterpolationMode()}SetInterpolationMode(e){this._timelineDataItem.SetInterpolationMode(e)}GetResultMode(){return this._timelineDataItem.GetResultMode()}SetResultMode(e){this._timelineDataItem.GetResultMode(e)}SetEase(e){for(const t of this.GetTracks())t.SetEase(e)}GetLoop(){return this._timelineDataItem.GetLoop()}SetLoop(e){return this._timelineDataItem.SetLoop(e)}GetPingPong(){return this._timelineDataItem.GetPingPong()}SetPingPong(e){return this._timelineDataItem.SetPingPong(e)}GetRepeatCount(){return this._timelineDataItem.GetRepeatCount()}SetRepeatCount(e){return this._timelineDataItem.SetRepeatCount(e)}SetPlaybackRate(e){return this._playbackRate=e}GetPlaybackRate(){return this._playbackRate}GetStartOnLayout(){return this._timelineDataItem.GetStartOnLayout()}GetTransformWithSceneGraph(){return this._timelineDataItem.GetTransformWithSceneGraph()}GetUseSystemTimescale(){return this._timelineDataItem.GetUseSystemTimescale()}GetPingPongState(){return this._pingPongState}IsForwardPlayBack(){return!this.IsPlaying()||this._playbackRate>0}GetPlayPromise(){return this._playPromise||(this._playPromise=new Promise((e=>{this._playResolve=e}))),this._playPromise}ResolvePlayPromise(){this._playPromise&&(this._playResolve(),this._playPromise=null,this._playResolve=null)}SetTags(e){this._tags=bm.TimelineState._GetTagArray(e),this._tagsChanged=!0}GetTags(){return this._tags}GetStringTags(){return this._tagsChanged&&(this._stringTags=this._tags.join(" ")),this._tagsChanged=!1,this._stringTags}HasTags(e){if(!this._tags)return!1;if(!this._tags.length)return!1;const t=bm.TimelineState._GetTagArray(e);return!!t&&!!t.length&&t.every(bm.TimelineState._HasTag,this)}OnStarted(){bm.Plugins.Timeline&&this.constructor===bm.TimelineState&&(bm.Plugins.Timeline.Cnds.PushTriggerTimeline(this),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimelineStarted),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimelineStartedByName),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimelineStartedByTags),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnAnyTimelineStarted),bm.Plugins.Timeline.Cnds.PopTriggerTimeline())}OnCompleted(){this._completedTick=this._runtime.GetTickCount()}FinishTriggers(){this._finishedTriggers||(this._finishedTriggers=!0,bm.Plugins.Timeline&&this.constructor===bm.TimelineState&&(bm.Plugins.Timeline.Cnds.PushTriggerTimeline(this),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimelineFinished),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimelineFinishedByName),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimelineFinishedByTags),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnAnyTimelineFinished),bm.Plugins.Timeline.Cnds.PopTriggerTimeline()))}SetPlaying(e){this._isPlaying=e}IsCompletedTick(){return this._completedTick===this._runtime.GetTickCount()}IsPlaying(e=!1){return!!this.IsCompletedTick()||!(!this.IsScheduled()||e)||this._isPlaying}_IsPlaying(){return this.IsPlaying(!0)}IsPaused(){return this._IsPaused()}_IsPaused(){return!(this.IsReleased()||this.IsScheduled()||this._IsPlaying()||this.IsComplete())}SetScheduled(e){this._isScheduled=e}IsScheduled(){return this._isScheduled}SetComplete(e){this._complete=e;const t=this.GetLoop(),s=this.GetPingPong();if(t||s){if(t&&!s);else if(!t&&s){const e=this.GetTime();1===this._pingPongState&&(e<=0||e>=this.GetTotalTime())&&(this._complete=!0)}}else{const e=this.GetTime();(e<=0||e>=this.GetTotalTime())&&(this._complete=!0)}}IsComplete(){return this._complete}IsReleased(){return this._released}SetMarkedForRemoval(e){this._markedForRemoval=e}IsMarkedForRemoval(){return this._markedForRemoval}SetImplicitPause(e){this._implicitPause=e}IsImplicitPause(){return this._implicitPause}SetIsTemplate(e){this._isTemplate=!!e}IsTemplate(){return this._isTemplate}InitialStateSet(){return this._initialStateSet}GetTime(){return this._playheadTime}SetTime(e){const t=this.GetTime();this._SetTime(e),this.SetComplete(!1),this.IsComplete()||this.SetImplicitPause(!0),(this._IsPlaying()||this.IsScheduled()||!this._initialStateSet)&&(this._IsPlaying()||this.IsScheduled()||this._initialStateSet?this._IsPlaying()?this.Stop():this.IsScheduled()&&(this._timelineManager.DeScheduleTimeline(this),this.SetInitialStateFromSetTime()):this.SetInitialStateFromSetTime()),this._SetUpdateStateBefore(),this._Interpolate(this.GetTime(),!1,!0,!0,t),this._SetUpdateStateAfter(),this._renderChange&&this.GetRuntime().UpdateRender(),this._OnSetTime()}_SetTime(e){bm.IsFiniteNumber(e)||(e=this.GetTotalTime()),e<0?this._playheadTime=0:e>=this.GetTotalTime()?this._playheadTime=this.GetTotalTime():this._playheadTime=e}_SetTimeAndReset(e){bm.IsFiniteNumber(e)||(e=this.GetTotalTime()),e<0?this._playheadTime=0:e>=this.GetTotalTime()?this._playheadTime=this.GetTotalTime():this._playheadTime=e;for(const e of this._tracks)e.SetResetState()}_OnSetTime(){bm.Plugins.Timeline&&this.constructor===bm.TimelineState&&(bm.Plugins.Timeline.Cnds.PushTriggerTimeline(this),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimeSet),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimeSetByName),this._timelineManager.Trigger(bm.Plugins.Timeline.Cnds.OnTimeSetByTags),bm.Plugins.Timeline.Cnds.PopTriggerTimeline())}_CanResume(){if(this.GetLoop())return!0;if(this.GetPingPong()&&1===this._pingPongState){if(this.IsForwardPlayBack()){if(this.GetTime()>=this.GetTotalTime())return!1}else if(this.GetTime()<=0)return!1}else if(!this.GetLoop()&&!this.GetPingPong())if(this.IsForwardPlayBack()){if(this.GetTime()>=this.GetTotalTime())return!1}else if(this.GetTime()<=0)return!1;return!0}Resume(){this.IsReleased()||this._CanResume()&&this.Play(!0)}Play(e=!1){return!this.IsReleased()&&!this.IsScheduled()&&(this._IsPlaying()&&this.IsCompletedTick()?this._SchedulePlayingTimeline():!this._IsPlaying()&&!!(this.IsComplete()||e||this.IsImplicitPause())&&this._ScheduleStoppedTimeline())}_SchedulePlayingTimeline(){return this.SetImplicitPause(!1),this._timelineManager.RemovePlayingTimeline(this),this._timelineManager.ScheduleTimeline(this),this.GetPlayPromise(),!0}_ScheduleStoppedTimeline(){return this.SetImplicitPause(!1),this._timelineManager.ScheduleTimeline(this),this.GetPlayPromise(),!0}Stop(e=!1){this.IsReleased()||(this.SetComplete(e),this._timelineManager.CompleteTimeline(this),this.IsComplete()&&this.ResolvePlayPromise())}Reset(e=!0,t=!1){if(this.IsReleased())return;if(!this._IsPlaying()&&this.IsScheduled())return this._timelineManager.DeScheduleTimeline(this);if(this.IsComplete())return;this.Stop(!0),this.IsForwardPlayBack()?this._SetTime(0):this._SetTime(this.GetTotalTime());const s=this.GetTime();this._SetUpdateStateBefore(),t?this._InterpolateBeforeChangeLayout(s):this._Interpolate(s,!1,!1,!0),e&&this._OnSetTime(),this._SetUpdateStateAfter(),this._renderChange&&e&&this.GetRuntime().UpdateRender()}ResetBeforeChangeLayout(){this.Reset(!1,!0)}_InterpolateBeforeChangeLayout(e){this._Interpolate(e,!1,!1,!0,NaN,!1,!0)}_OnBeforeChangeLayout(){return!!this.IsReleased()||!(!this.GetRuntime().IsLoadingState()&&this.HasValidGlobalTracks())&&(this._timelineManager.CompleteTimelineBeforeChangeOfLayout(this),this.GetRuntime().IsLoadingState()||this.ResetBeforeChangeLayout(),!0)}SetInitialStateFromSetTime(){this.SetInitialState(!0)}SetInitialStateForce(){this.SetInitialState(!1,!0),this.SetPlaying(!1),this.SetScheduled(!1)}SetInitialState(e=!1,t=!1){if(!this.IsMarkedForRemoval()||t)if(e){this._finishedTriggers=!1,this._initialStateSet=!0,this._firstTick=!0,this._SetUpdateStateBefore();for(const e of this._tracks)e.SetInitialState();this._SetUpdateStateAfter()}else if(this.SetPlaying(!0),this.SetScheduled(!1),this.OnStarted(),this.IsComplete()){this._completedTick=-1,0!==this._pingPongState&&(this._playbackRate=Math.abs(this._playbackRate)),this._pingPongState=0,this._resumePingPongState=-1,this._currentRepeatCount=1,this._complete=!1,this._finishedTriggers=!1,this._initialStateSet=!0,this._firstTick=!0,this.IsForwardPlayBack()?this._SetTime(0):this._SetTime(this.GetTotalTime()),this._SetUpdateStateBefore();for(const e of this._tracks)e.SetInitialState();this._SetUpdateStateAfter()}else{-1!==this._resumePingPongState&&(this._pingPongState=this._resumePingPongState),this._firstTick=!0,this._finishedTriggers=!1,this._SetUpdateStateBefore();for(const e of this._tracks)e.SetResumeState();this._SetUpdateStateAfter()}}GetRenderChange(){return this._renderChange}_SetUpdateStateBefore(){this._hasNestedContent=0;for(const e of this._tracks)e.IsNested()&&(this._hasNestedContent=1)}_SetUpdateStateAfter(){this._renderChange=0;for(const e of this._tracks)e._SetUpdateState(),0===this._renderChange&&1===e.GetRenderChange()&&(this._renderChange=1),this._beforeAndAfterTracks||1!==e.GetNeedsBeforeAndAfter()||(this._beforeAndAfterTracks||(this._beforeAndAfterTracks=[]),this._beforeAndAfterTracksLength=this._beforeAndAfterTracks.push(e))}Tick(e,t,s){if(this.GetUseSystemTimescale()){if(0===e&&0===this._lastDelta)return;this._lastDelta=e,e=s}else{if(0===s&&0===this._lastDelta)return;this._lastDelta=s,e=s,t=1}const n=this._playheadTime+this._overshoot,i=n+e*t*this._playbackRate,r=this._timelineDataItem._totalTime;i<0?(this._playheadTime=0,this._overshoot=-i):i>=r?(this._playheadTime=r,this._overshoot=this._playheadTime-i):(this._playheadTime=i,this._overshoot=0);let a=!1,o=!1;const l=this.GetLoop(),c=this.GetPingPong();let h;l||c?l&&!c?this._playbackRate>0?this._playheadTime>=r&&(this._SetTimeAndReset(0),o=!0):this._playheadTime<=0&&(this._SetTimeAndReset(r),o=!0):!l&&c?this._playbackRate>0?this._playheadTime>=r&&(this._SetTime(r),this.SetPlaybackRate(-1*this.GetPlaybackRate()),o=!0,1===this._pingPongState?this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._pingPongState=0):a=!0:0===this._pingPongState&&(this._pingPongState=1)):this._playheadTime<=0&&(this._SetTime(0),this.SetPlaybackRate(-1*this.GetPlaybackRate()),o=!0,1===this._pingPongState?this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._pingPongState=0):a=!0:0===this._pingPongState&&(this._pingPongState=1)):l&&c&&(this._playbackRate>0?this._playheadTime>=r&&(this._SetTime(r),this.SetPlaybackRate(-1*this.GetPlaybackRate()),o=!0,this._pingPongState++,bm.wrap(this._pingPongState,0,2)):this._playheadTime<=0&&(this._SetTime(0),this.SetPlaybackRate(-1*this.GetPlaybackRate()),o=!0,this._pingPongState++,bm.wrap(this._pingPongState,0,2))):this._playbackRate>0?this._playheadTime>=r&&(this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._SetTimeAndReset(0),o=!0):(this._SetTime(r),a=!0)):this._playheadTime<=0&&(this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._SetTimeAndReset(r),o=!0):(this._SetTime(0),a=!0));const _=this._tracksLength;if(a){for(h=0;h<_;h++)this._tracks[h].SetEndState();return this.Stop(!0),void this.OnCompleted()}const u=this._beforeAndAfterTracksLength;for(h=0;h<u;h++)this._beforeAndAfterTracks[h].BeforeInterpolate();if(1===this._hasNestedContent)for(h=0;h<_;h++){const e=this._tracks[h],t=e.GetStartOffset();this._playheadTime-t<0&&n-t>0?(this._playheadTime=t<0?0:t>=r?r:t,e.Interpolate(t,!0,!1,o,this._firstTick,!1)):e.Interpolate(this._playheadTime,!0,!1,o,this._firstTick,!1)}else for(h=0;h<_;h++)this._tracks[h].Interpolate(this._playheadTime,!0,!1,o,this._firstTick,!1);if(!this.IsPlaying()&&this._stoppedKeyframeDataItem){const e=this._stoppedKeyframeDataItem.GetTime()+this._stoppedKeyframeDataItem.GetKeyframeData().GetTrackDataItem().GetStartOffset(),t=this._playheadTime-e;this._playheadTime-=t,0!==this._overshoot&&(this._overshoot-=t),this._stoppedKeyframeDataItem=null}for(h=0;h<u;h++)this._beforeAndAfterTracks[h].AfterInterpolate();this._firstTick&&(this._firstTick=!1)}SetStoppedOnKeyframe(e){this._stoppedKeyframeDataItem=e}GetStoppedOnKeyframe(){return this._stoppedKeyframeDataItem}_Interpolate(e,t=!1,s=!1,n=!1,i=NaN,r=!1,a=!1){for(const e of this._tracks)e.BeforeInterpolate();for(const r of this._tracks){let o=e;if("number"==typeof i&&!isNaN(i)){const e=this.GetTime()-r.GetStartOffset(),t=i-r.GetStartOffset();e<0&&t>0&&(o=r.GetStartOffset(),this._SetTime(o))}r.Interpolate(o,t,s,n,this._firstTick,a)}for(const e of this._tracks)e.AfterInterpolate();this._firstTick&&r&&(this._firstTick=!1)}AddTrack(){const e=this._timelineDataItem.GetTrackData().AddEmptyTrackDataItem(),t=bm.TrackState.Create(this,e);return this._tracksLength=this._tracks.push(t),t}Removed(){if(!this.IsReleased())for(const e of this._tracks)e.TimelineRemoved()}CleanCaches(){for(const e of this._tracks)e.CleanCaches()}ClearTrackInstances(){for(const e of this._tracks)e.ClearInstance()}SetTrackInstance(e,t,s){if(t){if("number"==typeof s&&s>=0){const e=this._tracks[s];if(!e)return;return e.SetInstance(t),void this._timelineManager.SetTimelineObjectClassToMap(t.GetObjectClass(),this)}for(const s of this._tracks)if(s.IsInstanceTrack()){if(e){if(s.GetId()!==e)continue;s.SetInstance(t),this._timelineManager.SetTimelineObjectClassToMap(t.GetObjectClass(),this);break}if(!s.HasInstance()){s.SetInstance(t),this._timelineManager.SetTimelineObjectClassToMap(t.GetObjectClass(),this);break}}}}HasTrackInstance(e,t){for(const s of this._tracks)if(s.IsInstanceTrack())if(t){if(t===s.GetId()&&e===s.GetInstance())return!0}else if(e===s.GetInstance())return!0;return!1}HasValidTracks(){return this._tracks.some((e=>!e.IsInstanceTrack()||e.CanInstanceBeValid()))}HasValidGlobalTracks(){return this._tracks.some((e=>{if(e.IsInstanceTrack()){if(!e.CanInstanceBeValid())return!1;const t=e.GetObjectClass();return!!t&&t.IsGlobal()}return!1}))}GetPropertyTrack(e){for(const t of this.GetTracks())for(const s of t.GetPropertyTracks())if(s.GetPropertyName()===e)return s}GetTrackFromInstance(e){for(const t of this._tracks)if(e===t.GetInstance())return t;return null}GetKeyframeWithTags(e){let t=e?e.split(" "):[];const s=new Set(t.map((e=>e.toLowerCase().trim())));t=[...s.values()];for(const e of this.GetTracks())for(const s of e.GetKeyframeDataItems())if(t.every((e=>s.HasTag(e))))return s}GetObjectClasses(){const e=[];for(const t of this.GetTracks())e.push(t.GetObjectClass());return e.filter((e=>e))}_OnAfterLoad(){for(const e of this.GetTracks())e._OnAfterLoad()}_SaveToJson(){return{tracksJson:this._SaveTracksToJson(),name:this._name,playheadTime:this.GetTime(),playbackRate:this._playbackRate,pingPongState:this._pingPongState,resumePingPongState:this._resumePingPongState,currentRepeatCount:this._currentRepeatCount,isPlaying:this._isPlaying,isScheduled:this._isScheduled,initialStateSet:this._initialStateSet,finishedTriggers:this._finishedTriggers,complete:this._complete,released:this._released,markedForRemoval:this._markedForRemoval,completedTick:this._completedTick,implicitPause:this._implicitPause,isTemplate:this._isTemplate,tags:this._tags.join(" "),stringTags:this._stringTags,tagsChanged:this._tagsChanged,firstTick:this._firstTick}}_LoadFromJson(e){e&&(this._LoadTracksFromJson(e.tracksJson),this._name=e.name,this._playheadTime=e.playheadTime,this._playbackRate=e.playbackRate,this._pingPongState=e.pingPongState,this._resumePingPongState=e.hasOwnProperty("resumePingPongState")?e.resumePingPongState:-1,this._currentRepeatCount=e.currentRepeatCount,this._isPlaying=!!e.isPlaying,this._isScheduled=!!e.isScheduled,this._initialStateSet=!!e.initialStateSet,this._finishedTriggers=!!e.hasOwnProperty("finishedTriggers")&&!!e.finishedTriggers,this._complete=!!e.complete,this._released=!!e.released,this._markedForRemoval=!!e.markedForRemoval,this._completedTick=e.completedTick,this._implicitPause=!!e.implicitPause,this._isTemplate=!!e.isTemplate,this._tags=e.tags.split(" "),this._stringTags=e.stringTags,this._tagsChanged=!!e.tagsChanged,this._firstTick=!!e.firstTick)}_SaveTracksToJson(){return this._tracks.map((e=>e._SaveToJson()))}_LoadTracksFromJson(e){this.ClearTrackInstances(),e.forEach(((e,t)=>{this._tracks[t]._LoadFromJson(e)})),this._tracks.filter((e=>e.CanInstanceBeValid()))}static _HasTag(e){const t=this.GetTags();return""===e?1===t.length&&""===t[0]:t.map((e=>e.toLowerCase())).includes(e.toLowerCase())}static _GetTagArray(e){if(bm.IsArray(e))return e.slice(0);if(bm.IsString(e))return e.split(" ");throw new Error("invalid tags")}GetITimelineState(){return this._iTimelineState||(this._iTimelineState=bm.New(self.ITimelineState,this)),this._iTimelineState}}}{const xm=self.C3,Tm=0,Cm=1,wm=2;xm.TrackState=class extends xm.DefendedBase{constructor(e,t){super(),this._timeline=e,this._trackDataItem=t,this._trackData=t.GetTrackData(),this._instanceUid=NaN,this._objectClassIndex=NaN,this._instance=null,this._worldInfo=null,this._cleared=!1,this._isNested=t.GetStartOffset()>0,this._initialStateOfNestedSet=!1,this._endStateOfNestedSet=!1,this._instanceUidToLoad=NaN,this._lastKeyframeDataItem=null,this._keyframeDataItems=this._trackDataItem.GetKeyframeData().GetKeyframeDataItemArray(),this._propertyTracks=[],this.CreatePropertyTrackStates(),this._worldInfoChange=0,this._renderChange=0,this._needsBeforeAndAfter=0}static Create(e,t){return xm.New(xm.TrackState,e,t)}Release(){this._keyframeDataItems=null;for(const e of this._propertyTracks)e.Release();xm.clearArray(this._propertyTracks),this._propertyTracks=null,this._timeline=null,this._instance=null,this._worldInfo=null,this._trackDataItem=null,this._lastKeyframeDataItem=null}CreatePropertyTrackStates(){for(const e of this._trackDataItem.GetPropertyTrackData().propertyTrackDataItems())this._propertyTracks.push(xm.PropertyTrackState.Create(this,e))}TimelineRemoved(){for(const e of this._propertyTracks)e.TimelineRemoved()}CleanCaches(){for(const e of this._propertyTracks)e.CleanCaches();this._instance=null,this._worldInfo=null}GetTimeline(){return this._timeline}GetRuntime(){return this._timeline.GetRuntime()}GetKeyframeDataItems(){return this._keyframeDataItems||(this._keyframeDataItems=this._trackDataItem.GetKeyframeData().GetKeyframeDataItemArray()),this._keyframeDataItems}GetPropertyTracks(){return this._propertyTracks}GetPropertyTrack(e){for(let t=0;t<this._propertyTracks.length;t++){const s=this._propertyTracks[t];if(s.GetPropertyName()===e)return s}}MaybeGetInstance(){this._instance||this.GetInstance()}IsInstanceValid(){return!!this._instance&&!this._instance.IsDestroyed()}CanInstanceBeValid(){if(!this.IsInstanceTrack())return!1;const e=this.GetInstanceUID(),t=this.GetRuntime().GetInstanceByUID(e);return!!t&&!t.IsDestroyed()}GetObjectClass(){if(!this.IsInstanceTrack())return;const e=this.GetObjectClassIndex();return-1!==e?this.GetRuntime().GetObjectClassByIndex(e):void 0}GetTrackIndexInTimeline(){return this._timeline.GetTracks().indexOf(this)}ClearInstance(){this._instance=null,this._instanceUid=NaN,this._worldInfo=null,this._objectClassIndex=NaN,this._cleared=!0}HasInstance(){return!!this._instance}GetInstance(){if(this._cleared)return;if(this._instance&&this.IsInstanceValid())return this._instance;const e=this.GetInstanceUID();return this._instance=this.GetRuntime().GetInstanceByUID(e),this._instance}SetInstance(e){if(this._cleared=!1,this._instance!==e){this.CleanCaches(),this._instance=e,this._objectClassIndex=e.GetObjectClass().GetIndex(),this._instanceUid=e.GetUID(),this._worldInfo=e.GetWorldInfo();for(const t of this.propertyTrackItems()){const s=t.propertyTrack,n=t.sourceAdapter;switch(s.GetSourceAdapterId()){case"instance-variable":{n.GetEditorIndex();const s=e.GetObjectClass(),i=s.GetInstanceVariableIndexByName(t.name),r=s.GetInstanceVariableName(i),a=s.GetInstanceVariableType(i);r===t.name&&a===t.type&&n.UpdateInstanceVariableIndex(i);break}case"behavior":{const s=t.behaviorType,i=this.GetObjectClass(),r=e.GetObjectClass(),a=n.GetBehaviorType(r);if(s&&a){const e=s.GetName();i.GetBehaviorIndexByName(e),r.GetBehaviorIndexByName(e),n.GetEditorIndex(),n.UpdateBehaviorTypeSid(a.GetSID())}break}}}}}*propertyTrackItems(){for(const e of this._propertyTracks){const t=e.GetSourceAdapter(),s=this.GetObjectClass(),n={propertyTrack:e,sourceAdapter:t};switch(e.GetSourceAdapterId()){case"world-instance":n.property=e.GetPropertyName();break;case"instance-variable":{const e=t.GetEditorIndex();n.name=s.GetInstanceVariableName(e),n.type=s.GetInstanceVariableType(e);break}case"effect":{const e=s.GetEffectList(),i=t.GetEffectType(e);n.effectType=i;break}case"behavior":{const e=t.GetBehaviorType(s);n.behaviorType=e;break}case"plugin":n.plugin=s.GetPlugin()}yield n}}GetWorldInfo(){if(this._worldInfo&&this.IsInstanceValid())return this._worldInfo;const e=this.GetInstance();return e&&(this._worldInfo=e.GetWorldInfo()),this._worldInfo}GetTrackDataItem(){return this._trackDataItem}GetInstanceUID(){return isNaN(this._instanceUid)?this._trackDataItem.GetInstanceUID():this._instanceUid}SetInstanceUID(e){this._trackDataItem.SetInstanceUID(e)}GetInterpolationMode(){return this._trackDataItem.GetInterpolationMode()}SetInterpolationMode(e){this._trackDataItem.SetInterpolationMode(e)}GetResultMode(){return this._trackDataItem.GetResultMode()}GetId(){return this._trackDataItem.GetId()}GetStartOffset(){return this._trackDataItem.GetStartOffset()}GetLocalTotalTime(){return this._trackDataItem.GetLocalTotalTime()}SetLocalTotalTime(e){this._trackDataItem.SetLocalTotalTime(e)}SetResultMode(e){this._trackDataItem.SetResultMode(e)}SetEase(e){for(const t of this.GetKeyframeDataItems())t.SetEase(e);for(const t of this.GetPropertyTracks())t.SetEase(e)}GetEnable(){return this._trackDataItem.GetEnable()}SetEnable(e){this._trackDataItem.SetEnable(e)}GetObjectClassIndex(){return isNaN(this._objectClassIndex)?this._trackDataItem.GetObjectClassIndex():this._objectClassIndex}SetObjectClassIndex(e){this._trackDataItem.SetObjectClassIndex(e)}SetOriginalWidth(e){this._trackDataItem.SetOriginalWidth(e)}GetOriginalWidth(){const e=this.GetInstance();return e&&e.GetSdkInstance().IsOriginalSizeKnown()?e.GetSdkInstance().GetOriginalWidth():this._trackDataItem.GetOriginalWidth()}SetOriginalHeight(e){this._trackDataItem.SetOriginalHeight(e)}GetOriginalHeight(){const e=this.GetInstance();return e&&e.GetSdkInstance().IsOriginalSizeKnown()?e.GetSdkInstance().GetOriginalHeight():this._trackDataItem.GetOriginalHeight()}GetType(){return this._trackDataItem.GetType()}GetName(){return this._trackDataItem.GetName()}IsInstanceTrack(){return 0===this.GetType()}IsValueTrack(){return 1===this.GetType()}IsAudioTrack(){return 2===this.GetType()}GetWorldInfoChange(){return this._worldInfoChange}GetRenderChange(){return this._renderChange}GetNeedsBeforeAndAfter(){return this._needsBeforeAndAfter}IsNested(){return this._isNested}SetResetState(){for(const e of this._propertyTracks)e.SetResetState()}SetInitialState(){if(this.MaybeGetInstance(),!this.IsInstanceValid()&&this.IsInstanceTrack())return;const e=this.GetTimeline().IsForwardPlayBack(),t=e?0:this.GetLocalTotalTime();for(const e of this._propertyTracks)e.SetInitialState(t),0===this._worldInfoChange&&1===e.GetWorldInfoChange()&&(this._worldInfoChange=1),0===this._renderChange&&1===e.GetRenderChange()&&(this._renderChange=1);this._needsBeforeAndAfter=0,this._propertyTracks.some((e=>e.GetNeedsBeforeAndAfter()))&&(this._needsBeforeAndAfter=1),this._lastKeyframeDataItem=e?this._GetLastKeyFrameBeforeTime(t):this._GetFirstKeyFrameAfterTime(t),this._initialStateOfNestedSet=!1,this._endStateOfNestedSet=!1,this.Interpolate(t),this.OnInitialKeyframeReached(this._lastKeyframeDataItem)}SetResumeState(){if(this.MaybeGetInstance(),!this.IsInstanceValid()&&this.IsInstanceTrack())return;const e=this._timeline.IsForwardPlayBack(),t=this._timeline.GetTime()-this.GetStartOffset();this._lastKeyframeDataItem=e?this._GetLastKeyFrameBeforeTime(t):this._GetFirstKeyFrameAfterTime(t);for(const e of this._propertyTracks)e.SetResumeState(t)}SetEndState(){if(!this.GetTimeline().IsComplete()&&(this.MaybeGetInstance(),(this.IsInstanceValid()||!this.IsInstanceTrack())&&!this._isNested)){const e=this._timeline.GetTime();e>=this.GetStartOffset()+this.GetLocalTotalTime()?this.Interpolate(this.GetLocalTotalTime(),!0,!1,!0,!1,!1,!0):e<=0&&this.Interpolate(0,!0,!1,!0,!1,!1,!0)}}_SetUpdateState(){for(let e=0,t=this._propertyTracks.length;e<t;e++){const t=this._propertyTracks[e];t._SetUpdateState(),0===this._worldInfoChange&&1===t.GetWorldInfoChange()&&(this._worldInfoChange=1),0===this._renderChange&&1===t.GetRenderChange()&&(this._renderChange=1)}}BeforeInterpolate(){const e=this._propertyTracks.length;for(let t=0;t<e;t++)this._propertyTracks[t].BeforeInterpolate()}Interpolate(e,t=!1,s=!1,n=!1,i=!1,r=!1,a=!1){this._instance||this.GetInstance();const o=this._instance&&!this._instance.IsDestroyed(),l=0===this._trackDataItem._type;if((o||!l)&&!(r&&l&&this.GetObjectClass().IsGlobal()||(e-=this.GetStartOffset())<0)){this.MaybeSetInitialStateOfNestedTrack(e,t),this.MaybeTriggerKeyframeReachedConditions(e,t,i),!this.GetTimeline().IsPlaying()&&this.GetTimeline().GetStoppedOnKeyframe()&&(e=this.GetTimeline().GetStoppedOnKeyframe().GetTime());for(let t=0,i=this._propertyTracks.length;t<i;t++)this._propertyTracks[t].Interpolate(e,s,n,a);this.MaybeSetEndStateOfNestedTrack(e,t),0!==this._worldInfoChange&&(this._worldInfo||(this._worldInfo=this._instance.GetWorldInfo()),this._worldInfo&&this._worldInfo.SetBboxChanged())}}AfterInterpolate(){const e=this._propertyTracks.length;for(let t=0;t<e;t++)this._propertyTracks[t].AfterInterpolate()}MaybeSetInitialStateOfNestedTrack(e,t){if(t&&this._isNested&&!this._initialStateOfNestedSet){if(this.GetTimeline().IsForwardPlayBack()){if(e<0)return}else if(e>this.GetLocalTotalTime())return;for(const e of this._propertyTracks)e.SetInitialState();this._initialStateOfNestedSet=!0}}MaybeSetEndStateOfNestedTrack(e,t){if(t&&this._isNested&&!this._endStateOfNestedSet)if(this.GetTimeline().IsForwardPlayBack()){if(e>=this.GetLocalTotalTime()){for(const e of this._propertyTracks)e.Interpolate(this.GetLocalTotalTime(),!1,!0);this._endStateOfNestedSet=!0}}else if(e<=0){for(const e of this._propertyTracks)e.Interpolate(0,!1,!0);this._endStateOfNestedSet=!0}}MaybeTriggerKeyframeReachedConditions(e,t,s){if(s)return;if(!t)return;if(!xm.Plugins.Timeline)return;const n=this.GetTimeline();if(n.IsForwardPlayBack()){const t=this._lastKeyframeDataItem.GetNext(),s=this._lastKeyframeDataItem.GetTime(),i=t?t.GetTime():n.GetTotalTime();(e<=s||e>=i)&&(this._lastKeyframeDataItem=this._trackData.GetFirstKeyFrameDataItemLowerOrEqualThan(e,this._trackDataItem),t&&this.OnKeyframeReached(this._lastKeyframeDataItem))}else{if(!this._trackData.GetFirstKeyFrameDataItemHigherOrEqualThan(e,this._trackDataItem))return;this._lastKeyframeDataItem||(this._lastKeyframeDataItem=this._trackData.GetFirstKeyFrameDataItemHigherOrEqualThan(e,this._trackDataItem));const t=this._lastKeyframeDataItem.GetLast(),s=this._lastKeyframeDataItem.GetTime(),n=t?t.GetTime():0;(e>=s||e<=n)&&(this._lastKeyframeDataItem=this._trackData.GetFirstKeyFrameDataItemHigherOrEqualThan(e,this._trackDataItem),this._lastKeyframeDataItem&&this.OnKeyframeReached(this._lastKeyframeDataItem))}}_GetLastKeyFrameBeforeTime(e){return this._trackData.GetKeyFrameDataItemAtTime(e,this._trackDataItem)||this._trackData.GetFirstKeyFrameDataItemLowerOrEqualThan(e,this._trackDataItem)}_GetFirstKeyFrameAfterTime(e){return this._trackData.GetKeyFrameDataItemAtTime(e,this._trackDataItem)||this._trackData.GetFirstKeyFrameDataItemHigherOrEqualThan(e,this._trackDataItem)}OnKeyframeReached(e,t=!1){if(!xm.Plugins.Timeline)return;const s=this.GetTimeline(),n=s.GetTimelineManager();xm.Plugins.Timeline.Cnds.PushTriggerTimeline(s),xm.Plugins.Timeline.Cnds.PushTriggerKeyframe(e),n.Trigger(xm.Plugins.Timeline.Cnds.OnAnyKeyframeReached),n.Trigger(xm.Plugins.Timeline.Cnds.OnKeyframeReached),s.IsPlaying()||t||s.SetStoppedOnKeyframe(e),xm.Plugins.Timeline.Cnds.PopTriggerTimeline(s),xm.Plugins.Timeline.Cnds.PopTriggerKeyframe(e)}OnInitialKeyframeReached(e){this.OnKeyframeReached(e,!0)}AddKeyframe(){return this._trackDataItem.GetKeyframeData().AddEmptyKeyframeDataItem()}AddPropertyTrack(){const e=this._trackDataItem.GetPropertyTrackData().AddEmptyPropertyTrackDataItem(),t=xm.PropertyTrackState.Create(this,e);return this._propertyTracks.push(t),t}DeleteKeyframes(e){this._trackDataItem.GetKeyframeData().DeleteKeyframeDataItems(e)}DeletePropertyKeyframes(e){for(const t of this._propertyTracks)t.DeletePropertyKeyframes(e)}SaveState(){for(const e of this._propertyTracks)e.SaveState()}CompareInitialStateWithCurrent(){if(this.MaybeGetInstance(),this.IsInstanceValid()||!this.IsInstanceTrack())for(const e of this._propertyTracks)e.CompareInitialStateWithCurrent()}CompareSaveStateWithCurrent(){if(this.MaybeGetInstance(),!this.IsInstanceValid()&&this.IsInstanceTrack())return;let e=!1;for(const t of this._propertyTracks){const s=t.CompareSaveStateWithCurrent();!e&&s&&(e=!0)}if(e){const e=this.AddKeyframe();e.SetTime(this.GetTimeline().GetTime()),e.SetEase("noease"),e.SetEnable(!0),e.SetTags("")}}_OnAfterLoad(){isNaN(this._instanceUidToLoad)||this._LoadInstanceFromJson(this._instanceUidToLoad),this._instanceUidToLoad=NaN}_SaveToJson(){const e=this.GetInstance(),t=e?e.GetUID():this.GetInstanceUID();return{propertyTracksJson:this._SavePropertyTracksToJson(),lastKeyframeDataItemJson:this._SaveLastKeyframeDataItemToJson(),initialStateOfNestedSet:this._initialStateOfNestedSet,endStateOfNestedSet:this._endStateOfNestedSet,instanceUid:t,cleared:this._cleared}}_LoadFromJson(e){if(e){this._LoadPropertyTracksFromJson(e.propertyTracksJson),this._LoadLastKeyframeDataItemFromJson(e.lastKeyframeDataItemJson),this._instanceUidToLoad=e.instanceUid,this._initialStateOfNestedSet=!1,e.hasOwnProperty.initialStateOfNestedSet&&(this._initialStateOfNestedSet=e.initialStateOfNestedSet),this._endStateOfNestedSet=!1,e.hasOwnProperty.endStateOfNestedSet&&(this._endStateOfNestedSet=e.endStateOfNestedSet),this._cleared=!!e.hasOwnProperty("cleared")&&e.cleared;for(const e of this._propertyTracks)0===this._worldInfoChange&&1===e.GetWorldInfoChange()&&(this._worldInfoChange=1),0===this._renderChange&&1===e.GetRenderChange()&&(this._renderChange=1);this._needsBeforeAndAfter=0,this._propertyTracks.some((e=>e.GetNeedsBeforeAndAfter()))&&(this._needsBeforeAndAfter=1)}}_SaveLastKeyframeDataItemToJson(){return this._trackDataItem.GetKeyframeData().GetKeyframeDataItemIndex(this._lastKeyframeDataItem)}_SavePropertyTracksToJson(){return this._propertyTracks.map((e=>e._SaveToJson()))}_LoadPropertyTracksFromJson(e){e.forEach(((e,t)=>{this._propertyTracks[t]._LoadFromJson(e)}))}_LoadInstanceFromJson(e){if(!xm.IsFiniteNumber(e))return;const t=this.GetRuntime().GetInstanceByUID(e);t&&this.GetTimeline().SetTrackInstance(this._trackDataItem.GetId(),t,this.GetTrackIndexInTimeline())}_LoadLastKeyframeDataItemFromJson(e){const t=this._trackDataItem.GetKeyframeData();this._lastKeyframeDataItem=t.GetKeyframeDataItemFromIndex(e)}}}{const Pm=self.C3;Pm.PropertyTrackState=class extends Pm.DefendedBase{constructor(e,t){super(),this._track=e,this._propertyTrackDataItem=t,this._propertyTrackData=t.GetPropertyTrackData(),this._worldInfoChange=0,this._renderChange=0,this._needsBeforeAndAfter=0,this._sourceAdapter=this.GetSourceAdapter(),this._propertyKeyframeDataItems=this._propertyTrackDataItem.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray(),this._lastPropertyKeyframeDataItem=null,this._absoluteValueObject=null}static Create(e,t){return Pm.New(Pm.PropertyTrackState,e,t)}Release(){this._track=null,this._sourceAdapter&&(this._sourceAdapter.Release(),this._sourceAdapter=null),this._propertyKeyframeDataItems=null,this._propertyTrackDataItem=null,this._propertyTrackData=null}GetWorldInfoChange(){return this._worldInfoChange}GetRenderChange(){return this._renderChange}GetNeedsBeforeAndAfter(){return this._needsBeforeAndAfter}HasAbsoluteValueObject(){return!!this._absoluteValueObject}SetAbsoluteValueObject(e){this._absoluteValueObject=e}GetAbsoluteValueObject(){return this._absoluteValueObject}GetTrack(){return this._track}GetPropertyTrackDataItem(){return this._propertyTrackDataItem}GetPropertyTrackData(){return this._propertyTrackData}GetTimeline(){return this._track.GetTimeline()}GetRuntime(){return this._track.GetRuntime()}GetInstance(){return this._track.GetInstance()}GetSourceAdapter(){if(this._sourceAdapter)return this._sourceAdapter;let e;switch(this._propertyTrackDataItem.GetSourceAdapterId()){case"behavior":e=new Pm.PropertyTrackState.BehaviorSourceAdapter(this);break;case"effect":e=new Pm.PropertyTrackState.EffectSourceAdapter(this),this._renderChange=1;break;case"instance-variable":e=new Pm.PropertyTrackState.InstanceVariableSourceAdapter(this);break;case"plugin":e=new Pm.PropertyTrackState.PluginSourceAdapter(this),this._renderChange=1;break;case"world-instance":e=new Pm.PropertyTrackState.PropertySourceAdapter(this),this._renderChange=1,this._worldInfoChange=1;break;case"value":e=new Pm.PropertyTrackState.ValueSourceAdapter(this);break;case"audio":e=new Pm.PropertyTrackState.AudioSourceAdapter(this)}return this._sourceAdapter=e,this._sourceAdapter}GetSourceAdapterId(){return this._propertyTrackDataItem.GetSourceAdapterId()}SetSourceAdapterId(e){this._propertyTrackDataItem.SetSourceAdapterId(e)}GetSourceAdapterArgs(){return this._propertyTrackDataItem.GetSourceAdapterArguments()}SetSourceAdapterArgs(e){this._propertyTrackDataItem.SetSourceAdapterArguments(e)}GetSourceAdapterValue(){return this.GetSourceAdapter().GetValue()}GetPropertyName(){return this._propertyTrackDataItem.GetProperty()}SetPropertyName(e){this._propertyTrackDataItem.SetProperty(e)}GetPropertyType(){return this._propertyTrackDataItem.GetType()}SetPropertyType(e){this._propertyTrackDataItem.SetType(e)}GetPropertyKeyframeType(){return this.GetPropertyTrackData().GetFirstPropertyKeyframeDataItem(this._propertyTrackDataItem).GetType()}GetMin(){return this._propertyTrackDataItem.GetMin()}SetMin(e){this._propertyTrackDataItem.SetMin(e)}GetMax(){return this._propertyTrackDataItem.GetMax()}SetMax(e){this._propertyTrackDataItem.SetMax(e)}GetEnable(){return this._propertyTrackDataItem.GetEnable()}SetEnable(e){this._propertyTrackDataItem.SetEnable(e)}GetInterpolationMode(){return this._propertyTrackDataItem.GetInterpolationMode()}SetInterpolationMode(e){this._propertyTrackDataItem.SetInterpolationMode(e)}GetResultMode(){return this._propertyTrackDataItem.GetResultMode()}SetResultMode(e){this._propertyTrackDataItem.SetResultMode(e)}SetEase(e){for(const t of this.GetPropertyKeyframeDataItems())t.SetEase(e)}CanHavePropertyKeyframes(){return this._propertyTrackDataItem.CanHavePropertyKeyframes()}GetPropertyKeyframeDataItems(){return this._propertyKeyframeDataItems||(this._propertyKeyframeDataItems=this._propertyTrackDataItem.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray()),this._propertyKeyframeDataItems}GetPropertyKeyframeDataItemArrayIncludingDisabled(){return this._propertyTrackDataItem.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArrayIncludingDisabled()}GetPropertyKeyFrameDataItemAtTime(e){return this._propertyTrackData.GetPropertyKeyFrameDataItemAtTime(e,this._propertyTrackDataItem)}GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e){return this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem)}GetPropertyKeyframeDataItemPairForTime(e){let t,s=this._propertyTrackData.GetPropertyKeyFrameDataItemAtTime(e,this._propertyTrackDataItem);return s?t=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemHigherThan(e,this._propertyTrackDataItem):(s=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem),t=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(e,this._propertyTrackDataItem)),{start:s,end:t}}*GetPropertyKeyframeValues(){for(const e of this.GetPropertyKeyframeDataItems())yield e.GetValueWithResultMode()}*GetPropertyKeyframeTimes(){for(const e of this.GetPropertyKeyframeDataItems())yield e.GetTime()}TimelineRemoved(){this.GetSourceAdapter().TimelineRemoved()}CleanCaches(){this.GetSourceAdapter().CleanCaches()}GetCurrentState(){return this.GetSourceAdapter().GetCurrentState()}SetResetState(){this.GetSourceAdapter().SetResetState()}SetInitialState(e){this.GetSourceAdapter().SetInitialState(),this._lastPropertyKeyframeDataItem=this._GetLastPropertyKeyFrameBeforeTime(e),this._SetUpdateState()}SetResumeState(e){this.GetSourceAdapter().SetResumeState(),this._lastPropertyKeyframeDataItem=this._GetLastPropertyKeyFrameBeforeTime(e)}_SetUpdateState(){const e=this.GetTrack();if(this._needsBeforeAndAfter=0,e.IsInstanceTrack()){const t=this.GetTimeline(),s=e.GetInstance(),n=this.GetSourceAdapter(),i=this.GetPropertyName();if(n.MayNeedBeforeAndAfterInterpolate()){const e=t.GetSimilarPropertyTracks(s,n,i,this);e&&e.length&&(this._needsBeforeAndAfter=1)}else this._needsBeforeAndAfter=0}}_GetLastPropertyKeyFrameBeforeTime(e){const t=this.GetTimeline();return this._propertyTrackData.GetPropertyKeyFrameDataItemAtTime(e,this._propertyTrackDataItem)||(t.IsForwardPlayBack()?this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem):this._propertyTrackData.GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(e,this._propertyTrackDataItem))}BeforeInterpolate(){this._sourceAdapter.BeforeInterpolate()}Interpolate(e,t=!1,s=!1,n=!1){let i,r,a=!1;if(t)i=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem);else{if(this._lastPropertyKeyframeDataItem){const t=this.GetTimeline(),s=this._lastPropertyKeyframeDataItem.GetNext(),n=this._lastPropertyKeyframeDataItem.GetTime(),i=s?s.GetTime():t.GetTotalTime();(e<=n||e>=i)&&(this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem),a=!0)}else this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem),a=!0;i=this._lastPropertyKeyframeDataItem}i&&(r=i.GetNext()),this._sourceAdapter.Interpolate(e,i,r,t,s,n,a)}GetInterpolatedValue(e){if(this._lastPropertyKeyframeDataItem){const t=this.GetTimeline(),s=this._lastPropertyKeyframeDataItem.GetNext(),n=this._lastPropertyKeyframeDataItem.GetTime(),i=s?s.GetTime():t.GetTotalTime();(e<=n||e>=i)&&(this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem))}else this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem);const t=this._lastPropertyKeyframeDataItem,s=t.GetNext();return this._sourceAdapter.GetInterpolatedValue(e,t,s)}GetInterpolatedValueFast(e,t,s){return this._sourceAdapter.GetInterpolatedValue(e,t,s)}AfterInterpolate(){this._sourceAdapter.AfterInterpolate()}static GetStartPropertyKeyframeForTime(e,t){const s=t.GetPropertyTrackDataItem();return t._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,s)}static GetEndPropertyKeyframeForTime(e,t){const s=t.GetPropertyTrackDataItem();return t._propertyTrackData.GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(e,s)}AddPropertyKeyframe(){const e=this._propertyTrackDataItem.GetPropertyKeyframeData().AddEmptyPropertyKeyframeDataItem();return this._lastPropertyKeyframeDataItem=null,e}DeletePropertyKeyframes(e){this._lastPropertyKeyframeDataItem=null,this._propertyTrackDataItem.GetPropertyKeyframeData().DeletePropertyKeyframeDataItems(e)}SaveState(){this.GetSourceAdapter().SaveState()}CompareInitialStateWithCurrent(){if(this.GetSourceAdapter().CompareInitialStateWithCurrent()){const e=this._propertyTrackData.GetFirstPropertyKeyframeDataItem(this._propertyTrackDataItem),t=this.GetSourceAdapter().GetCurrentState();e.SetAbsoluteValue(t)}}CompareSaveStateWithCurrent(){const e=this.GetSourceAdapter().CompareSaveStateWithCurrent();return e&&this.AddPropertyKeyframeAtCurrentTime(),this.GetSourceAdapter().ClearSaveState(),e}AddPropertyKeyframeAtCurrentTime(){const e=this.GetTimeline().GetTime(),t=this.GetSourceAdapter(),s=Pm.PropertyTrackState.GetStartPropertyKeyframeForTime(e,this),n=this.AddPropertyKeyframe();n.SetType(s.GetType()),n.SetTime(e),n.SetEase(s.GetEase()),n.SetEnable(!0),n.SetValue(t.GetValueAtTime()),n.SetAbsoluteValue(t.GetCurrentState())}_SaveToJson(){return{sourceAdapterJson:this.GetSourceAdapter()._SaveToJson()}}_LoadFromJson(e){e&&this.GetSourceAdapter()._LoadFromJson(e.sourceAdapterJson)}}}{const Am=self.C3,Rm=Am.PropertyTrackState;Rm.PropertySourceAdapter=class{constructor(e){this._propertyTrack=e,this._propertyAdapter=null,this.GetPropertyAdapter()}Release(){this._propertyAdapter&&(this._propertyAdapter.Release(),this._propertyAdapter=null),this._propertyTrack=null}MayNeedBeforeAndAfterInterpolate(){return this._propertyAdapter.MayNeedBeforeAndAfterInterpolate()}GetPropertyTrack(){return this._propertyTrack}TimelineRemoved(){this._propertyAdapter&&this._propertyAdapter.TimelineRemoved()}CleanCaches(){this._propertyAdapter&&this._propertyAdapter.CleanCaches()}GetPropertyAdapter(){return this._propertyAdapter||(this._propertyAdapter=this._CreatePropertyAdapter()),this._propertyAdapter}GetEditorIndex(){}GetIndex(){return this.GetEditorIndex()}GetTarget(){}SetResetState(){this.GetPropertyAdapter().SetResetState()}SetInitialState(){this.GetPropertyAdapter().SetInitialState()}SetResumeState(){this.GetPropertyAdapter().SetResumeState()}BeforeInterpolate(){this._propertyAdapter.BeforeChangeProperty()}Interpolate(e,t,s,n,i,r,a){let o;switch(this._propertyTrack.GetPropertyKeyframeType()){case"numeric":o=Rm.NumericTypeAdapter.Interpolate(e,t,s,this._propertyTrack);break;case"angle":o=Rm.AngleTypeAdapter.Interpolate(e,t,s,this._propertyTrack);break;case"boolean":o=Rm.BooleanTypeAdapter.Interpolate(e,t,s,this._propertyTrack);break;case"color":o=Rm.ColorTypeAdapter.Interpolate(e,t,s,this._propertyTrack);break;case"text":o=Rm.TextTypeAdapter.Interpolate(e,t,s,this._propertyTrack)}this._propertyAdapter.ChangeProperty(e,o,t,s,n,i,r,a)}GetInterpolatedValue(e,t,s){switch(this._propertyTrack.GetPropertyKeyframeType()){case"numeric":return Rm.NumericTypeAdapter.Interpolate(e,t,s,this._propertyTrack);case"angle":return Rm.AngleTypeAdapter.Interpolate(e,t,s,this._propertyTrack);case"boolean":return Rm.BooleanTypeAdapter.Interpolate(e,t,s,this._propertyTrack);case"color":return Rm.ColorTypeAdapter.Interpolate(e,t,s,this._propertyTrack);case"text":return Rm.TextTypeAdapter.Interpolate(e,t,s,this._propertyTrack)}}AfterInterpolate(){this._propertyAdapter.AfterChangeProperty()}SaveState(){this.GetPropertyAdapter().SetSaveState()}ClearSaveState(){this.GetPropertyAdapter().ClearSaveState()}GetCurrentState(){return this.GetPropertyAdapter().GetCurrentState()}CompareInitialStateWithCurrent(){return this.GetPropertyAdapter().CompareInitialStateWithCurrent()}CompareSaveStateWithCurrent(){return this.GetPropertyAdapter().CompareSaveStateWithCurrent()}GetValueAtTime(){const e=this._propertyTrack,t=e.GetTrack().GetTimeline().GetTime(),s=Rm.GetStartPropertyKeyframeForTime(t,e),n=s.GetNext();switch(e.GetPropertyKeyframeType()){case"numeric":return Rm.NumericTypeAdapter.Interpolate(t,s,n,e);case"angle":return Rm.AngleTypeAdapter.Interpolate(t,s,n,e);case"boolean":return Rm.BooleanTypeAdapter.Interpolate(t,s,n,e);case"color":return Rm.ColorTypeAdapter.Interpolate(t,s,n,e);case"text":return Rm.TextTypeAdapter.Interpolate(t,s,n,e)}}_CreatePropertyAdapter(){const e=this._propertyTrack;switch(e.CanHavePropertyKeyframes()?e.GetPropertyKeyframeType():""){case"combo":case"boolean":case"text":case"string":return new Rm.PropertyInterpolationAdapter.NoInterpolationAdapter(this);case"numeric":case"number":case"angle":return"combo"===this._propertyTrack.GetPropertyType()?new Rm.PropertyInterpolationAdapter.NoInterpolationAdapter(this):new Rm.PropertyInterpolationAdapter.NumericInterpolationAdapter(this);case"color":case"offsetColor":return new Rm.PropertyInterpolationAdapter.ColorInterpolationAdapter(this);default:return new Rm.PropertyInterpolationAdapter.NumericInterpolationAdapter(this)}}_SaveToJson(){return{propertyAdapterJson:this.GetPropertyAdapter()._SaveToJson()}}_LoadFromJson(e){e&&this.GetPropertyAdapter()._LoadFromJson(e.propertyAdapterJson)}}}{const Dm=self.C3,Em=0;class Mm extends Dm.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e),this._updatedIndex=NaN}GetEditorIndex(){return this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0]}GetIndex(){return this._updatedIndex?this._updatedIndex:super.GetIndex()}GetTarget(){return this._propertyTrack.GetTrack().GetInstance()}UpdateInstanceVariableIndex(e){this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0]!==e&&(this._updatedIndex=e)}Interpolate(e,t,s,n,i,r,a){this.GetPropertyAdapter().CanChange(t.GetValue())&&super.Interpolate(e,t,s,n,i,r,a)}GetInterpolatedValue(e,t,s){if(this.GetPropertyAdapter().CanChange(t.GetValue()))return super.GetInterpolatedValue(e,t,s)}_SaveToJson(){return Object.assign(super._SaveToJson(),{index:this._updatedIndex})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._updatedIndex=e.index)}}Dm.PropertyTrackState.InstanceVariableSourceAdapter=Mm}{const km=self.C3,Lm=0,Fm=1,Bm=2;class Om extends km.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e),this._sid=NaN}GetEditorIndex(){return this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[1]}GetTarget(){const e=this._propertyTrack.GetPropertyTrackDataItem(),t=this._propertyTrack.GetTrack(),s=this._sid?this._sid:e.GetSourceAdapterArguments()[0],n=t.GetInstance(),i=n.GetBehaviorIndexBySID(s);return n.GetBehaviorInstances()[i].GetSdkInstance()}GetBehaviorType(e){const t=this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[2];return e.GetBehaviorTypeByName(t)}UpdateBehaviorTypeSid(e){this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0]!==e&&(this._sid=e)}Interpolate(e,t,s,n,i,r,a){const o=this._propertyTrack.GetTrack().GetInstance();this.GetBehaviorType(o.GetObjectClass())&&super.Interpolate(e,t,s,n,i,r,a)}GetInterpolatedValue(e,t,s){const n=this._propertyTrack.GetTrack().GetInstance();if(this.GetBehaviorType(n.GetObjectClass()))return super.GetInterpolatedValue(e,t,s)}_SaveToJson(){return Object.assign(super._SaveToJson(),{sid:this._sid})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._sid=e.sid)}}km.PropertyTrackState.BehaviorSourceAdapter=Om}{const Nm=self.C3,Wm=0,Vm=1;class jm extends Nm.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e)}GetEditorIndex(){return this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[1]}GetTarget(){const e=this._propertyTrack.GetTrack().GetWorldInfo().GetInstanceEffectList(),t=e.GetEffectList(),s=this.GetEffectType(t).GetIndex();return e.IsEffectIndexActive(s)?e.GetEffectParametersForIndex(s):null}GetEffectType(e){const t=this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0];return e.GetEffectTypeByName(t)}Interpolate(e,t,s,n,i,r,a){this._IsEffectActive()&&super.Interpolate(e,t,s,n,i,r,a)}GetInterpolatedValue(e,t,s){if(this._IsEffectActive())return super.GetInterpolatedValue(e,t,s)}_IsEffectActive(){const e=this._propertyTrack.GetTrack().GetWorldInfo().GetInstanceEffectList(),t=e.GetEffectList(),s=this.GetEffectType(t);if(!s)return;const n=s.GetIndex();return e.IsEffectIndexActive(n)}}Nm.PropertyTrackState.EffectSourceAdapter=jm}{const Um=self.C3,Hm=0;class zm extends Um.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e)}GetEditorIndex(){return this._propertyTrack.GetPropertyTrackDataItem().GetSourceAdapterArguments()[0]}GetTarget(){return this._propertyTrack.GetTrack().GetInstance().GetSdkInstance()}Interpolate(e,t,s,n,i,r,a){const o=this._propertyTrack.GetTrack();o.GetObjectClass().GetPlugin()===o.GetInstance().GetObjectClass().GetPlugin()&&super.Interpolate(e,t,s,n,i,r,a)}GetInterpolatedValue(e,t,s){const n=this._propertyTrack.GetTrack();if(n.GetObjectClass().GetPlugin()===n.GetInstance().GetObjectClass().GetPlugin())return super.GetInterpolatedValue(e,t,s)}GetOptionalCallbacks(){const e=this._propertyTrack.GetTrack(),t=e.GetObjectClass().GetPlugin();if(Um.Plugins.Sprite&&t instanceof Um.Plugins.Sprite&&("initial-frame"===this._propertyTrack.GetPropertyName()||"initial-animation"===this._propertyTrack.GetPropertyName()))switch(this._propertyTrack.GetResultMode()){case"relative":return{onFrameChange:(t,s,n,i,r)=>{if(s!==i){const n=i/s,r=e.GetPropertyTrack("offsetWidth"),a=e.GetPropertyTrack("offsetScaleX");if(r||a){const o=r?.GetSourceAdapter()?.GetPropertyAdapter(),l=a?.GetSourceAdapter()?.GetPropertyAdapter();if(t.HasParent()&&t.GetTransformWithParentWidth())l&&l.SetOriginalSizeProperty(i),t.SetWidth(this.GetNewWidth(i,s,t,e,o,l));else{const s=i*((t._GetSceneGraphInfo()?._GetStartWidth()??this.GetInstanceOriginalWidth(t,e))/this.GetInstanceOriginalWidth(t,e));l&&l.SetOriginalSizeProperty(i);const r=o?.GetChangeAccumulatorProperty()??0,a=l?.GetChangeAccumulatorProperty()??0;t.SetWidth(s+(r+a*n))}}else t.SetWidth(t.GetWidth()*n)}if(n!==r){const s=r/n,i=e.GetPropertyTrack("offsetHeight"),a=e.GetPropertyTrack("offsetScaleY");if(i||a){const o=i?.GetSourceAdapter()?.GetPropertyAdapter(),l=a?.GetSourceAdapter()?.GetPropertyAdapter();if(t.HasParent()&&t.GetTransformWithParentHeight())l&&l.SetOriginalSizeProperty(r),t.SetHeight(this.GetNewHeight(r,n,t,e,o,l));else{const n=r*((t._GetSceneGraphInfo()?._GetStartHeight()??this.GetInstanceOriginalHeight(t,e))/this.GetInstanceOriginalHeight(t,e));l&&l.SetOriginalSizeProperty(r);const i=o?.GetChangeAccumulatorProperty()??0,a=l?.GetChangeAccumulatorProperty()??0;t.SetHeight(n+(i+a*s))}}else t.SetHeight(t.GetHeight()*s)}}};case"absolute":return null}}GetLastPropertyKeyframeValue(e,t,s,n=0){const i=t.GetTimeline().GetTrackFromInstance(e.GetInstance());if(!i)return n;const r=i.GetPropertyTrack(s);if(!r)return n;const a=r.GetPropertyTrackDataItem().GetPropertyKeyframeData();if(!a)return n;const o=a.GetLastPropertyKeyframeDataItem();return o?o.GetValue():n}GetInstanceOriginalWidth(e,t){const s=t.GetTimeline().GetTrackFromInstance(e.GetInstance());if(s)return s.GetOriginalWidth();const n=e.GetInstance().GetSdkInstance();return n.IsOriginalSizeKnown()?n.GetOriginalWidth():e._GetSceneGraphInfo()._GetStartWidth()}GetInstanceOriginalHeight(e,t){const s=t.GetTimeline().GetTrackFromInstance(e.GetInstance());if(s)return s.GetOriginalHeight();const n=e.GetInstance().GetSdkInstance();return n.IsOriginalSizeKnown()?n.GetOriginalHeight():e._GetSceneGraphInfo()._GetStartHeight()}GetNewWidth(e,t,s,n,i,r){const a=s._GetSceneGraphInfo()._GetStartWidth(),o=a/s.GetParent()._GetSceneGraphInfo()._GetStartWidth();let l=1;const c=r?.GetAbsoluteScaleXOffsetProperty()??0;if(0!==c){const e=a/this.GetInstanceOriginalWidth(s,n);l=(e+c)/(0===e?Number.EPSILON:e)}const h=a*(e/t);let _=i?.GetAbsoluteWidthOffsetProperty()??0;_+=h-a;const u=(a+_)/(0===a?Number.EPSILON:a);return s.GetParent().GetWidth()*o*l*u}GetNewHeight(e,t,s,n,i,r){const a=s._GetSceneGraphInfo()._GetStartHeight(),o=a/s.GetParent()._GetSceneGraphInfo()._GetStartHeight();let l=1;const c=r?.GetAbsoluteScaleYOffsetProperty()??0;if(0!==c){const e=a/this.GetInstanceOriginalHeight(s,n);l=(e+c)/(0===e?Number.EPSILON:e)}const h=a*(e/t);let _=i?.GetAbsoluteHeightOffsetProperty()??0;_+=h-a;const u=(a+_)/(0===a?Number.EPSILON:a);return s.GetParent().GetHeight()*o*l*u}}Um.PropertyTrackState.PluginSourceAdapter=zm}{const Xm=self.C3;class Ym extends Xm.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e),this._value=0,this._init=!1}MayNeedBeforeAndAfterInterpolate(){return!1}SetInitialState(){const e=this._propertyTrack.GetPropertyTrackData();let t=this._propertyTrack.GetPropertyTrackDataItem();t=e.GetFirstPropertyKeyframeDataItem(t),this._value=t.GetValueWithResultMode()}SetResumeState(){}GetValue(){return this._init||this._propertyTrack.Interpolate(0),this._value}Interpolate(e,t,s,n,i,r,a){this._value=Xm.PropertyTrackState.NumericTypeAdapter.Interpolate(e,t,s,this._propertyTrack),this._init=!0}SaveState(){}ClearSaveState(){}GetCurrentState(){return this._value}CompareInitialStateWithCurrent(){return!1}CompareSaveStateWithCurrent(){return!1}_SaveToJson(){return{value:this._value,init:this._init}}_LoadFromJson(e){e&&(this._value=e.value,this._init=!e.hasOwnProperty("init")||e.init)}}Xm.PropertyTrackState.ValueSourceAdapter=Ym}{const qm=self.C3,Jm=0,Km=0,$m=1,Zm=1,Qm=2,eg=3;class tg extends qm.PropertyTrackState.PropertySourceAdapter{constructor(e){super(e),this._audioPlaybackStarted=!1,this._sdkInstance=null,this._actions=null,this._expressions=null,this._timeline=this._propertyTrack.GetTimeline(),this._track=this._propertyTrack.GetTrack(),this._sourceAdapterArgs=this._propertyTrack.GetSourceAdapterArgs(),this._fileArgs=this._sourceAdapterArgs[0],this._startOffsetTime=this._sourceAdapterArgs[1],this._sourceAdapterArgs[3]?this._audioTag=this._sourceAdapterArgs[3]:this._audioTag=Math.random().toString(36).slice(2),this._pauseTime=NaN,this._pauseVolume=NaN,this._volume=NaN,this._audioSource=null,this._Initialize()}Release(){super.Release(),this._sdkInstance=null,this._actions=null,this._expressions=null,this._timeline=null,this._track=null,this._sourceAdapterArgs=null,this._fileArgs=null,this._audioSource=null}_Initialize(){if(!self.C3.Plugins.Audio)return;const e=this._propertyTrack.GetRuntime().GetSingleGlobalObjectClassByCtor(self.C3.Plugins.Audio);e&&(this._sdkInstance=e.GetSingleGlobalInstance().GetSdkInstance()),this._actions=self.C3.Plugins.Audio.Acts,this._expressions=self.C3.Plugins.Audio.Exps}_MaybeSetAudioSource(){if(this._audioSource)return;const e=this._propertyTrack.GetTrack().GetPropertyTrack("audioSource");e&&(this._audioSource=e.GetSourceAdapter())}_GetPauseVolume(){const e=this._propertyTrack.GetTrack().GetPropertyTrack("volume");return e?e.GetSourceAdapter()._pauseVolume:this._pauseVolume}TimelineRemoved(){super.TimelineRemoved(),this._audioPlaybackStarted=!1,this._sdkInstance&&(this._expressions&&(this._pauseTime=this._expressions.PlaybackTime.call(this._sdkInstance,this._audioTag),this._pauseVolume=this._expressions.Volume.call(this._sdkInstance,this._audioTag)),this._actions&&this._actions.Stop.call(this._sdkInstance,this._audioTag))}GetAudioTag(){return this._audioTag}GetVolume(){return this._volume}SetVolume(e){this._volume=e}SetInitialState(){super.SetInitialState(),this._pauseTime=NaN,this._audioPlaybackStarted=!1}SetResumeState(){super.SetResumeState();const e=this._propertyTrack.GetTimeline().GetTime();switch(this._pauseTime=e-this._startOffsetTime,this._propertyTrack.GetPropertyName()){case"audioSource":break;case"volume":this._pauseVolume=this._propertyTrack.GetInterpolatedValue(e)}this._audioPlaybackStarted=!1}Interpolate(e,t,s,n,i,r,a){if(this._sdkInstance)switch(this._propertyTrack.GetPropertyName()){case"audioSource":{if(!this._timeline.IsForwardPlayBack())return;if(n)return void(this._actions&&this._actions.Stop.call(this._sdkInstance,this._audioTag));if(e<this._startOffsetTime)return void(this._audioPlaybackStarted=!1);const t=this._expressions.PlaybackRate.call(this._sdkInstance,this._audioTag),s=this._timeline.GetPlaybackRate();if(s!==t&&this._actions.SetPlaybackRate.call(this._sdkInstance,this._audioTag,s),this._audioPlaybackStarted)return;if(!this._propertyTrack.GetTimeline().IsPlaying())return;if(this._audioPlaybackStarted=!0,isNaN(this._pauseTime)){const t=self.performance.now(),s=e-this._startOffsetTime;if("suspended"===this._sdkInstance.GetAudioContextState())return void(this._audioPlaybackStarted=!1);const n=s+(self.performance.now()-t)/1e3;if(this._actions){let e=this.GetVolume();isNaN(e)?(this.SetVolume(0),e=0):this.SetVolume(e),this._actions.PlayFromTimeline.call(this._sdkInstance,this._fileArgs,e,this._audioTag,n)}}else{const e=this._pauseTime;this._pauseTime=NaN;const t=this._GetPauseVolume();if(this._pauseVolume=NaN,"suspended"===this._sdkInstance.GetAudioContextState())return void(this._audioPlaybackStarted=!1);this._actions&&(this.SetVolume(t),this._actions.PlayFromTimeline.call(this._sdkInstance,this._fileArgs,t,this._audioTag,e))}break}case"volume":this._MaybeSetAudioSource(),super.Interpolate(e,t,s,n,i,r,a)}}GetInterpolatedValue(e,t,s){if(this._sdkInstance)switch(this._propertyTrack.GetPropertyName()){case"audioSource":return;case"volume":return this._MaybeSetAudioSource(),super.GetInterpolatedValue(e,t,s)}}Getter(e,t){return this._audioSource?this._audioSource.GetVolume():0}Setter(e,t,s,n){this._audioSource&&this._audioSource.SetVolume(this.Getter()+t),this._actions&&this._audioSource&&this._actions.SetVolume.call(this._sdkInstance,this._audioSource.GetAudioTag(),this._audioSource.GetVolume())}AbsoluteSetter(e,t,s){this._audioSource&&this._audioSource.SetVolume(t),this._actions&&this._audioSource&&this._actions.SetVolume.call(this._sdkInstance,this._audioSource.GetAudioTag(),this._audioSource.GetVolume())}DoesRounding(){return!0}_SaveToJson(){return{audioPlaybackStarted:this._audioPlaybackStarted,audioTag:this._audioTag,pauseTime:this._pauseTime,pauseVolume:this._pauseVolume,volume:this._volume}}_LoadFromJson(e){e&&(this._audioPlaybackStarted=e.audioPlaybackStarted,this._audioTag=e.audioTag,this._pauseTime=e.pauseTime,this._pauseVolume=e.pauseVolume,this._volume=e.volume,this._Initialize())}}qm.PropertyTrackState.AudioSourceAdapter=tg}{const sg=self.C3;sg.PropertyTrackState.PropertyInterpolationAdapter=class{constructor(e){this._sourceAdapter=e,this._propertyTrack=e.GetPropertyTrack(),this._worldInfo=this._propertyTrack.GetTrack().GetWorldInfo(),this._property=this._propertyTrack.GetPropertyName(),this._firstAbsoluteUpdate=!1,this._saveState=null,this._target=null}Release(){this._sourceAdapter=null,this._propertyTrack=null,this._worldInfo=null,this._saveState=null,this._target=null}MayNeedBeforeAndAfterInterpolate(){return!1}TimelineRemoved(){}CleanCaches(){this._worldInfo=null,this._saveState=null,this._target=null}GetSourceAdapter(){return this._sourceAdapter}GetPropertyTrack(){return this._propertyTrack}GetWorldInfo(){return this._worldInfo||(this._worldInfo=this._propertyTrack.GetTrack().GetWorldInfo()),this._worldInfo}SetFirstAbsoluteUpdate(e){this._firstAbsoluteUpdate=!!e}GetFirstAbsoluteUpdate(){return this._firstAbsoluteUpdate}SetResetState(){}SetInitialState(){}SetResumeState(){}SetSaveState(){this._saveState=this.GetCurrentState()}ClearSaveState(){this._saveState=null}GetCurrentState(){}CompareInitialStateWithCurrent(){}CompareSaveStateWithCurrent(){}CanChange(e){return typeof this._Getter()==typeof e}BeforeChangeProperty(){}ChangeProperty(e,t,s,n,i,r,a,o){}AfterChangeProperty(){}_FirstKeyframeGetter(){return this._PickTimelinePlaybackMode((()=>{const e=this._propertyTrack.GetPropertyTrackDataItem();return this._propertyTrack.GetPropertyTrackData().GetFirstPropertyKeyframeDataItem(e)}),(()=>{const e=this._propertyTrack.GetPropertyTrackDataItem();return this._propertyTrack.GetPropertyTrackData().GetLastPropertyKeyframeDataItem(e)})).GetAbsoluteValue()}_CurrentKeyframeGetter(){const e=this._propertyTrack.GetTimeline().GetTime()-this._propertyTrack.GetTrack().GetStartOffset();return this._PickTimelinePlaybackMode((()=>{const t=this._propertyTrack.GetPropertyTrackDataItem();return this._propertyTrack.GetPropertyTrackData().GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,t)}),(()=>{const t=this._propertyTrack.GetPropertyTrackDataItem(),s=this._propertyTrack.GetPropertyTrackData();return s.GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(e,t)||s.GetLastPropertyKeyframeDataItem(t)})).GetAbsoluteValue()}_PickTimelinePlaybackMode(e,t){return this._propertyTrack.GetTimeline().IsForwardPlayBack()?e():t()}_PickResultMode(e,t){return"relative"===this._propertyTrack.GetResultMode()?e():t()}_PickFirstAbsoluteUpdate(e,t){return this.GetFirstAbsoluteUpdate()?(this.SetFirstAbsoluteUpdate(!1),e()):t()}_GetAbsoluteInitialValue(e){}_GetIndex(){return this._sourceAdapter.GetIndex()}_GetTarget(){return this._target||(this._target=this._sourceAdapter.GetTarget()),this._target}_PickSource(e,t,s,n,i,r){switch(this._propertyTrack.GetSourceAdapterId()){case"behavior":return e();case"effect":return t();case"instance-variable":return s();case"plugin":return n();case"world-instance":return i();case"audio":return r()}}_SaveToJson(){return{firstAbsoluteUpdate:this._firstAbsoluteUpdate,saveState:this._saveState}}_LoadFromJson(e){e&&(this._firstAbsoluteUpdate=e.firstAbsoluteUpdate,this._saveState=e.saveState)}_GetPropertyKeyframeStubs(e,t=!1){const s=[];for(const n of e){const e=n.GetTrack().GetStartOffset();for(const i of n.GetPropertyKeyframeDataItems())t&&0===i.GetTime()?s.push({time:e+i.GetTime(),value:i.GetAbsoluteValue()}):t||s.push({time:e+i.GetTime(),value:i.GetAbsoluteValue()})}return s.sort(((e,t)=>e.time-t.time))}_GetLastPropertyKeyframeStub(e,t,s){return this._GetPropertyKeyframeStubLowerThanPlayhead(t,s)}_GetPropertyKeyframeStubLowerThanPlayhead(e,t){for(let s=t.length-1;s>=0;s--)if(t[s].time<=e)return t[s];return null}}}{const ng=self.C3,ig=new Map,rg=[0,0,0];class ag extends ng.PropertyTrackState.PropertyInterpolationAdapter{constructor(e){super(e)}SetResetState(){}SetInitialState(){}SetResumeState(){}GetCurrentState(){const e=this._propertyTrack.GetSourceAdapterId(),t=this._GetTarget(),s=this._GetIndex();switch(e){case"behavior":case"plugin":return this._ToColorArray(t.GetPropertyValueByIndex(s));case"effect":return this._ToColorArray(t[s]);case"world-instance":return this._ToColorArray(this._Getter())}}CompareInitialStateWithCurrent(){const e=this._FirstKeyframeGetter();return!this._CompareColors(e,this._Getter())}CompareSaveStateWithCurrent(){return!ng.IsNullOrUndefined(this._saveState)&&!this._CompareColors(this._saveState,this._Getter())}_CompareColors(e,t){return e=this._GetColorFromArray(e),t=this._GetColorFromArray(t),e.equalsIgnoringAlpha(t)}_FirstKeyframeGetter(){const e=super._FirstKeyframeGetter();return this._GetColorFromArray(e)}_CurrentKeyframeGetter(){const e=super._CurrentKeyframeGetter();return this._GetColorFromArray(e)}_GetAbsoluteInitialValue(e){}_ToColorArray(e){return ng.IsInstanceOf(e,ng.Color)?e.toArray().slice(0,3):e.slice(0,3)}_GetColorFromArray(e){return ng.IsInstanceOf(e,ng.Color)?e:new ng.Color(e[0],e[1],e[2],1)}CanChange(e){return!0}MayNeedBeforeAndAfterInterpolate(){return!0}BeforeChangeProperty(){const e=this._propertyTrack.GetTimeline(),t=this._propertyTrack.GetInstance(),s=this._propertyTrack.GetSourceAdapter(),n=e.GetSimilarPropertyTracks(t,s,this._property,this._propertyTrack);if(n&&n.length>1){ig.has(t)||ig.set(t,new Map);const e=ig.get(t),s=this._propertyTrack.GetSourceAdapterId();e.has(s)||e.set(s,new Map);const n=e.get(s);n.has(this._property)||n.set(this._property,{used:!1,color:new ng.Color(0,0,0,1)})}}_GetTmpColor(e,t,s){const n=ig.get(e).get(t).get(s);return n.used=!0,n.color}ChangeProperty(e,t,s,n,i,r,a,o){const l=this._propertyTrack.GetTimeline(),c=this._propertyTrack.GetTrack(),h=this._propertyTrack.GetInstance(),_=this._propertyTrack.GetSourceAdapter(),u=this._propertyTrack.GetSourceAdapterId(),d=this._property,p=l.GetSimilarPropertyTracks(h,_,d,this._propertyTrack);if(p&&p.length>1){const e=this._GetPropertyKeyframeStubs(p,!0),s=this._GetLastPropertyKeyframeStub(l,l.GetTime(),e);if(s){const e=c.GetStartOffset(),n=s.time-e;if(0===n)this._GetTmpColor(h,u,this._property).addRgb(t[0],t[1],t[2]);else{if(n<0)return;const e=t[0],s=t[1],i=t[2],r=this._propertyTrack.Interpolate(n,!1,!0),a=ng.Color.DiffChannel(e,r[0]),o=ng.Color.DiffChannel(s,r[1]),l=ng.Color.DiffChannel(i,r[2]);this._GetTmpColor(h,u,this._property).addRgb(a,o,l)}}}else this._Setter(t[0],t[1],t[2])}AfterChangeProperty(){const e=this._propertyTrack.GetInstance();if(!ig.has(e))return;const t=ig.get(e),s=this._propertyTrack.GetSourceAdapterId();if(!t.has(s))return;const n=t.get(s);if(!n.has(this._property))return;const i=n.get(this._property),r=i.used,a=i.color;r&&this._Setter(a.getR(),a.getG(),a.getB()),0===n.size&&t.delete(s),0===t.size&&ig.delete(e)}_Getter(){const e=this._propertyTrack.GetSourceAdapterId(),t=this._GetTarget(),s=this._GetIndex();switch(e){case"behavior":case"plugin":return this._GetColorFromArray(t.GetPropertyValueByIndex(s));case"effect":return t[s].clone();case"world-instance":return this.GetWorldInfo().GetUnpremultipliedColor().clone()}}_Setter(e,t,s){const n=this._propertyTrack.GetSourceAdapterId(),i=this._GetTarget(),r=this._GetIndex();switch(n){case"behavior":case"plugin":rg[0]=e,rg[1]=t,rg[2]=s,i.SetPropertyValueByIndex(r,rg);break;case"effect":i[r].setRgb(e,t,s);break;case"world-instance":this.GetWorldInfo().SetUnpremultipliedColorRGB(e,t,s)}}_SaveToJson(){}_LoadFromJson(e){}}ng.PropertyTrackState.PropertyInterpolationAdapter.ColorInterpolationAdapter=ag}{const og=self.C3,lg=og.PropertyTrackState;class cg extends og.PropertyTrackState.PropertyInterpolationAdapter{constructor(e){super(e)}SetResetState(){}SetInitialState(){}SetResumeState(){}GetCurrentState(){return this._Getter()}CompareInitialStateWithCurrent(){return this._FirstKeyframeGetter()!==this.GetCurrentState()}CompareSaveStateWithCurrent(){return!og.IsNullOrUndefined(this._saveState)&&this._saveState!==this.GetCurrentState()}MayNeedBeforeAndAfterInterpolate(){return!1}ChangeProperty(e,t,s,n,i,r,a,o){const l=this._propertyTrack,c=l.GetTrack(),h=l.GetSourceAdapterId(),_=l.GetTimeline(),u=c.GetInstance(),d=l.GetSourceAdapter(),p=this._property,f=_.GetSimilarPropertyTracks(u,d,p,l);if(f&&f.length>1){const s=this._GetPropertyKeyframeStubs(f),n=e+c.GetStartOffset(),i=this._GetLastPropertyKeyframeStub(_,n,s);i&&(t=i.value)}switch(l.GetPropertyKeyframeType()){case"numeric":if(!lg.NumericTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,h))return;break;case"angle":if(!lg.AngleTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,h))return;break;case"boolean":if(!lg.BooleanTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,h))return;break;case"color":if(!lg.ColorTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,h))return;break;case"text":if(!lg.TextTypeAdapter.WillChange(this._GetIndex(),this._GetTarget(),t,h))return}this._Setter(t)}_Getter(){const e=this._propertyTrack.GetSourceAdapterId(),t=this._GetTarget(),s=this._GetIndex();switch(e){case"behavior":case"plugin":return t.GetPropertyValueByIndex(s);case"effect":return t[s];case"instance-variable":return t.GetInstanceVariableValue(s)}}_Setter(e){const t=this._propertyTrack.GetSourceAdapterId(),s=this._GetTarget(),n=this._GetIndex();switch(t){case"behavior":case"plugin":s.SetPropertyValueByIndex(n,e);break;case"effect":s[n]=e;break;case"instance-variable":s.SetInstanceVariableValue(n,e)}}}og.PropertyTrackState.PropertyInterpolationAdapter.NoInterpolationAdapter=cg}{const hg=self.C3,_g=hg.PropertyTrackState.PropertyInterpolationAdapter,ug=new Map,dg=(e,t,s,n,i,r=!1,a=null,o=null)=>{ug.set(e,{setter:t,absolute_setter:s,getter:n,round:i,fRound:r,init:a,reset:o})},pg=(e,t)=>{const s=t.GetTimeline().GetTrackFromInstance(e.GetInstance());if(s)return s.GetOriginalWidth();const n=e.GetInstance().GetSdkInstance();return n.IsOriginalSizeKnown()?n.GetOriginalWidth():e._GetSceneGraphInfo()._GetStartWidth()},fg=(e,t,s,n=0)=>{const i=t.GetTimeline().GetTrackFromInstance(e.GetInstance());if(!i)return n;const r=i.GetPropertyTrack(s);if(!r)return n;const a=r.GetPropertyTrackDataItem().GetPropertyKeyframeData();if(!a)return n;const o=a.GetLastPropertyKeyframeDataItem();return o?o.GetValue():n},mg=e=>{const t=[];let s=e.GetParent();for(;s;)t.push(s),s=s.GetParent();return t.reverse(),t};dg("offsetX",((e,t,s,n)=>{"relative"===n._propertyTrack.GetResultMode()?e.OffsetX(t,s.GetTimeline().GetTransformWithSceneGraph()):e.OffsetX(t)}),((e,t)=>e.SetX(t)),(e=>e.GetX()),!0),dg("offsetY",((e,t,s,n)=>{"relative"===n._propertyTrack.GetResultMode()?e.OffsetY(t,s.GetTimeline().GetTransformWithSceneGraph()):e.OffsetY(t)}),((e,t)=>e.SetY(t)),(e=>e.GetY()),!0),dg("offsetWidth",((e,t,s,n,i=!1,r=!0)=>{if(0===t)return;const a="relative"===n._propertyTrack.GetResultMode(),o=1===n._typeAdapter.GetType();if((a||o)&&e.HasParent()&&e.GetTransformWithParentWidth()){if(isNaN(n._absoluteToFactor)){const t=mg(e);let s;s=o?t[t.length-1].GetWidth():t[t.length-1]._GetSceneGraphInfo()._GetStartWidth(),n._absoluteToFactor=0===s?Number.EPSILON:s}if(i)return;n._absoluteWidthOffset+=t;const s=t/n._absoluteToFactor;e.OffsetWidth(s,r),n._changeAccumulator+=s}else e.OffsetWidth(t),n._changeAccumulator+=t}),((e,t)=>e.SetWidth(t)),(e=>e.GetWidth()),!0,!1,null,(e=>{e._changeAccumulator=0,e._absoluteWidthOffset=0})),dg("offsetHeight",((e,t,s,n,i=!1,r=!0)=>{if(0===t)return;const a="relative"===n._propertyTrack.GetResultMode(),o=1===n._typeAdapter.GetType();if((a||o)&&e.HasParent()&&e.GetTransformWithParentHeight()){if(isNaN(n._absoluteToFactor)){const t=mg(e);let s;s=o?t[t.length-1].GetHeight():t[t.length-1]._GetSceneGraphInfo()._GetStartHeight(),n._absoluteToFactor=0===s?Number.EPSILON:s}if(i)return;n._absoluteHeightOffset+=t;const s=t/n._absoluteToFactor;e.OffsetHeight(s,r),n._changeAccumulator+=s}else e.OffsetHeight(t),n._changeAccumulator+=t}),((e,t)=>e.SetHeight(t)),(e=>e.GetHeight()),!0,!1,null,(e=>{e._changeAccumulator=0,e._absoluteHeightOffset=0})),dg("offsetAngle",((e,t,s,n,i)=>{e.OffsetAngle(t)}),((e,t)=>e.SetAngle(t)),(e=>e.GetAngle()),!1,!0),dg("offsetOpacity",((e,t,s,n,i)=>{t/=n._opacityFactor?n._opacityFactor:1;const r=e.GetOpacity()+t;if(0===n._clampAccumulator)r>1?n._clampAccumulator+=r-1:r<0&&(n._clampAccumulator+=r),e.OffsetOpacity(t);else{const s=e.GetOpacity()+t;t>0&&n._clampAccumulator>0?s>1&&(n._clampAccumulator+=s-1):t>0&&n._clampAccumulator<0?(n._clampAccumulator+=t,n._clampAccumulator>0&&(e.OffsetOpacity(n._clampAccumulator),n._clampAccumulator=0)):t<0&&n._clampAccumulator>0?(n._clampAccumulator+=t,n._clampAccumulator<0&&(e.OffsetOpacity(n._clampAccumulator),n._clampAccumulator=0)):t<0&&n._clampAccumulator<0&&s<0&&(n._clampAccumulator+=s)}}),((e,t)=>{e.SetOpacity(t)}),(e=>e.GetOpacity()),!1,!0,((e,t,s)=>{switch(e._clampAccumulator=0,e._propertyTrack.GetResultMode()){case"relative":{e._propertyTrack.GetPropertyTrackData();const t=e._propertyTrack.GetPropertyTrackDataItem().GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray();let s=e.GetWorldInfo().GetOpacity(),n=s;for(const i of t){const t=i.GetTime();n=s+e._propertyTrack.GetInterpolatedValue(t),n=hg.clamp(n,0,1)}e._totalForewardOpacityDelta=s-n,e._totalForewardOpacityDelta=Math.round(100*(e._totalForewardOpacityDelta+Number.EPSILON))/100,n=s;for(let s=t.length-1;s>=0;s--){const i=t[s].GetTime();n-=e._propertyTrack.GetInterpolatedValue(i),n=hg.clamp(n,0,1)}e._totalBackwardOpacityDelta=n,e._totalBackwardOpacityDelta=Math.round(100*(e._totalBackwardOpacityDelta+Number.EPSILON))/100;break}}const n="relative"===e._propertyTrack.GetResultMode(),i=1===e._typeAdapter.GetType();if((n||i)&&t.HasParent()&&t.GetTransformWithParentOpacity()){const n=mg(t);let i=n[0]._GetSceneGraphInfo().GetStartOpacity();i+=fg(n[0],s,"offsetOpacity");for(let e=1;e<n.length;e++)i+=fg(n[e],s,"offsetOpacity");e._opacityFactor=0===i?1:i}}),(e=>{switch(e._propertyTrack.GetResultMode()){case"relative":{e._clampAccumulator=0;const t=e.GetWorldInfo();let s=t.GetOpacity();s=Math.round(100*(s+Number.EPSILON))/100,e._propertyTrack.GetTimeline().IsForwardPlayBack()?(t.SetOpacity(s+e._totalForewardOpacityDelta),e._lastValue=0):(t.SetOpacity(s-e._totalBackwardOpacityDelta),e._lastValue=e.GetSourceAdapter().GetValueAtTime());break}}})),dg("offsetOriginX",((e,t)=>e.OffsetOriginX(t)),((e,t)=>e.SetOriginX(t)),(e=>e.GetOriginX()),!1),dg("offsetOriginY",((e,t)=>e.OffsetOriginY(t)),((e,t)=>e.SetOriginY(t)),(e=>e.GetOriginY()),!1),dg("offsetZElevation",((e,t)=>e.OffsetZElevation(t)),((e,t)=>e.SetZElevation(t)),(e=>e.GetZElevation()),!0),dg("offsetScaleX",((e,t,s,n)=>{if(0===t)return;const i=e.GetWidth()<0?-1:1;if(n._absoluteScaleXOffset+=t,"relative"===n._propertyTrack.GetResultMode()&&e.HasParent()&&e.GetTransformWithParentWidth()){const r=fg(e,s,"offsetWidth"),a=isNaN(n._originalSize)?s.GetOriginalWidth():n._originalSize,o=(a+r/(e._GetSceneGraphInfo()._GetStartWidth()/a))*i*t;isNaN(n._absoluteToFactor)&&ug.get("offsetWidth").setter(e,1,s,n,!0);const l=o/n._absoluteToFactor;e.OffsetWidth(l,!0),n._changeAccumulator+=l}else{const r=(isNaN(n._originalSize)?s.GetOriginalWidth():n._originalSize)*i*t;e.OffsetWidth(r),n._changeAccumulator+=r}}),((e,t,s)=>{e.SetWidth(s.GetOriginalWidth()*t)}),((e,t)=>{const s=e.GetWidth()<0?-1:1;if(e.GetTransformWithParentWidth()){const n=e.GetParent(),i=t.GetTimeline().GetTrackFromInstance(n.GetInstance());let r=NaN;if(i)r=n.GetWidth()/i.GetOriginalWidth();else{const e=n.GetInstance().GetSdkInstance();r=e.IsOriginalSizeKnown()?n.GetWidth()/e.GetOriginalWidth():1}return e.GetWidth()*s/(t.GetOriginalWidth()*r)}return e.GetWidth()*s/t.GetOriginalWidth()}),!1,!1,null,(e=>{e._changeAccumulator=0,e._originalSize=NaN,e._absoluteScaleXOffset=0})),dg("offsetScaleY",((e,t,s,n)=>{if(0===t)return;const i=e.GetHeight()<0?-1:1;if(n._absoluteScaleYOffset+=t,"relative"===n._propertyTrack.GetResultMode()&&e.HasParent()&&e.GetTransformWithParentHeight()){const r=fg(e,s,"offsetHeight"),a=isNaN(n._originalSize)?s.GetOriginalHeight():n._originalSize,o=(a+r/(e._GetSceneGraphInfo()._GetStartHeight()/a))*i*t;isNaN(n._absoluteToFactor)&&ug.get("offsetHeight").setter(e,1,s,n,!0);const l=o/n._absoluteToFactor;e.OffsetHeight(l,!0),n._changeAccumulator+=l}else{const r=(isNaN(n._originalSize)?s.GetOriginalHeight():n._originalSize)*i*t;e.OffsetHeight(r),n._changeAccumulator+=r}}),((e,t,s)=>{e.SetHeight(s.GetOriginalHeight()*t)}),((e,t)=>{const s=e.GetHeight()<0?-1:1;if(e.GetTransformWithParentHeight()){const n=e.GetParent(),i=t.GetTimeline().GetTrackFromInstance(n.GetInstance());let r=NaN;if(i)r=n.GetHeight()/i.GetOriginalHeight();else{const e=n.GetInstance().GetSdkInstance();r=e.IsOriginalSizeKnown()?n.GetHeight()/e.GetOriginalHeight():1}return e.GetHeight()*s/(t.GetOriginalHeight()*r)}return e.GetHeight()*s/t.GetOriginalHeight()}),!1,!1,null,(e=>{e._changeAccumulator=0,e._originalSize=NaN,e._absoluteScaleYOffset=0}));class gg extends hg.PropertyTrackState.PropertyInterpolationAdapter{constructor(e){super(e),this._lastValue=0,this._clampAccumulator=0,this._totalForewardOpacityDelta=0,this._totalBackwardOpacityDelta=0,this._opacityFactor=NaN,this._absoluteToFactor=NaN,this._changeAccumulator=0,this._originalSize=NaN,this._absoluteWidthOffset=0,this._absoluteScaleXOffset=0,this._absoluteHeightOffset=0,this._absoluteScaleYOffset=0,this._angleReflectMirrorOrFlip=void 0,this._angleReflectMirrorAndFlip=void 0,this._instance_getter=null,this._instance_setter=null,this._instance_absolute_setter=null,this._reset_action=null,this._init_action=null,this._source_adapter_getter=null,this._source_adapter_setter=null,this._source_adapter_absolute_setter=null,this._round=!1,this._fRound=!1,hg.IsInstanceOf(this._propertyTrack.GetTimeline(),hg.TweenState)?this._typeAdapter=new hg.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapterForTween(this):this._typeAdapter=new hg.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapterForTimeline(this);const t=this._propertyTrack.GetPropertyName();switch(this._propertyTrack.GetSourceAdapterId()){case"world-instance":{const e=ug.get(t);this._instance_getter=e.getter,this._instance_setter=e.setter,this._instance_absolute_setter=e.absolute_setter,this._round=e.round,this._fRound=e.fRound,this._init_action=e.init,this._reset_action=e.reset;break}case"audio":this._source_adapter_getter=e.Getter,this._source_adapter_setter=e.Setter,this._source_adapter_absolute_setter=e.AbsoluteSetter,this._round=!!e.DoesRounding(),this._fRound=!1}}Release(){this._typeAdapter=null,this._instance_getter=null,this._instance_setter=null,this._instance_absolute_setter=null,this._reset_action=null,this._init_action=null,this._source_adapter_getter=null,this._source_adapter_setter=null,this._source_adapter_absolute_setter=null,super.Release()}MayNeedBeforeAndAfterInterpolate(){return this._typeAdapter.MayNeedBeforeAndAfterInterpolate()}GetLastValue(){return this._lastValue}SetLastValue(e){this._lastValue=e}SetResetState(){this._reset_action&&this._reset_action(this)}SetInitialState(){const e=this._typeAdapter.SetInitialState();if("number"==typeof e&&(this._lastValue=e),this._init_action){const e=this.GetWorldInfo(),t=this._propertyTrack.GetTrack();this._init_action(this,e,t)}}SetResumeState(){const e=this._typeAdapter.SetResumeState();"number"==typeof e&&(this._lastValue=e)}GetCurrentState(){return this._Getter()}CompareInitialStateWithCurrent(){return this._FirstKeyframeGetter()!==this.GetCurrentState()}CompareSaveStateWithCurrent(){return!hg.IsNullOrUndefined(this._saveState)&&this._saveState!==this.GetCurrentState()}BeforeChangeProperty(){this._typeAdapter.BeforeChangeProperty()}ChangeProperty(e,t,s,n,i,r,a,o){return this._typeAdapter.ChangeProperty(e,t,s,n,i,r,a,o)}AfterChangeProperty(){this._typeAdapter.AfterChangeProperty()}_Getter(){const e=this._GetTarget(),t=this._GetIndex(),s=this.GetWorldInfo(),n=this._propertyTrack.GetTrack();switch(this._propertyTrack.GetSourceAdapterId()){case"behavior":case"plugin":return e.GetPropertyValueByIndex(t);case"effect":return e[t];case"instance-variable":return e.GetInstanceVariableValue(t);case"world-instance":return this._instance_getter(s,n);case"audio":return this._source_adapter_getter.call(this.GetSourceAdapter(),s,n)}}_Setter(e,t,s,n=!0){const i=this._GetTarget(),r=this._GetIndex(),a=this.GetWorldInfo(),o=this._propertyTrack.GetTrack();switch(this._propertyTrack.GetSourceAdapterId()){case"behavior":i.OffsetPropertyValueByIndex(r,e);break;case"effect":i[r]+=e;break;case"instance-variable":i.SetInstanceVariableOffset(r,e);break;case"plugin":i.OffsetPropertyValueByIndex(r,e,this.GetSourceAdapter().GetOptionalCallbacks());break;case"world-instance":this._instance_setter(a,e,o,this,!1,n);break;case"audio":this._source_adapter_setter.call(this.GetSourceAdapter(),a,e,o,this)}}_SetterAbsolute(e,t,s){let n=this._propertyTrack.GetInterpolationMode();if(n="default"===n?"continuous":n,"discrete"===n&&!t)return;if("discrete"===n&&s){const e=this._propertyTrack.GetTimeline().GetTime();if(!this._propertyTrack.GetPropertyKeyFrameDataItemAtTime(e))return}const i=this._GetTarget(),r=this._GetIndex(),a=this.GetWorldInfo(),o=this._propertyTrack.GetTrack();switch(this._propertyTrack.GetSourceAdapterId()){case"behavior":i.SetPropertyValueByIndex(r,e);break;case"effect":i[r]=e;break;case"instance-variable":i.SetInstanceVariableValue(r,e);break;case"plugin":i.SetPropertyValueByIndex(r,e,this.GetSourceAdapter().GetOptionalCallbacks());break;case"world-instance":this._instance_absolute_setter(a,e,o);break;case"audio":this._source_adapter_absolute_setter.call(this.GetSourceAdapter(),a,e,o)}}_MaybeEnsureValue(e,t,s,n,i,r,a,o){this._typeAdapter._MaybeEnsureValue(e,t,s,n,i,r,a,o)}_AddDelta(e,t,s,n,i){"angle"===this._propertyTrack.GetPropertyType()&&(e=hg.toDegrees(e));const r=(e.toString().split(".")[1]||"").length,a=this._Getter();let o;switch(o=0===r?this._round?Math.round(a):this._fRound?"angle"===this._propertyTrack.GetPropertyType()?hg.toRadians(Math.round(hg.toDegrees(a))):Number(hg.toFixed(a,2)):a:this._round?Number(hg.toFixed(a,r)):(this._fRound,a),this._Setter(o-a,t,s,!1),this._propertyTrack.GetPropertyName()){case"offsetWidth":case"offsetScaleX":{const e=this.GetWorldInfo(),t=e.GetWidth(),s=Number(hg.toFixed(t,2));e.OffsetWidth(s-t);break}case"offsetHeight":case"offsetScaleY":{const e=this.GetWorldInfo(),t=e.GetHeight(),s=Number(hg.toFixed(t,2));e.OffsetHeight(s-t);break}}}_SaveToJson(){return Object.assign(super._SaveToJson(),{v:this._lastValue,a:this._clampAccumulator,fod:this._totalForewardOpacityDelta,bod:this._totalBackwardOpacityDelta,of:this._opacityFactor,sf:this._absoluteToFactor,armorf:this._angleReflectMirrorOrFlip,armandf:this._angleReflectMirrorAndFlip,ca:this._changeAccumulator,os:this._originalSize,awo:this._absoluteWidthOffset,aho:this._absoluteHeightOffset,asxo:this._absoluteScaleXOffset,asyo:this._absoluteScaleYOffset})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._lastValue=e.v,this._clampAccumulator=e.a,this._totalForewardOpacityDelta=hg.IsFiniteNumber(e.fod)?e.fod:0,this._totalBackwardOpacityDelta=hg.IsFiniteNumber(e.bod)?e.bod:0,this._opacityFactor=hg.IsFiniteNumber(e.of)?e.of:NaN,this._absoluteToFactor=hg.IsFiniteNumber(e.sf)?e.sf:NaN,this._angleReflectMirrorOrFlip=hg.IsFiniteNumber(e.armorf)?e.armorf:void 0,this._angleReflectMirrorAndFlip=hg.IsFiniteNumber(e.armandf)?e.armandf:void 0,this._changeAccumulator=hg.IsFiniteNumber(e.ca)?e.ca:0,this._originalSize=hg.IsFiniteNumber(e.os)?e.os:NaN,this._absoluteWidthOffset=hg.IsFiniteNumber(e.awo)?e.awo:0,this._absoluteHeightOffset=hg.IsFiniteNumber(e.aho)?e.aho:0,this._absoluteScaleXOffset=hg.IsFiniteNumber(e.asxo)?e.asxo:0,this._absoluteScaleYOffset=hg.IsFiniteNumber(e.asyo)?e.asyo:0)}SetOriginalSizeProperty(e){this._originalSize=e}GetChangeAccumulatorProperty(){return this._changeAccumulator}GetAbsoluteWidthOffsetProperty(){return this._absoluteWidthOffset}GetAbsoluteHeightOffsetProperty(){return this._absoluteHeightOffset}GetAbsoluteScaleXOffsetProperty(){return this._absoluteScaleXOffset}GetAbsoluteScaleYOffsetProperty(){return this._absoluteScaleYOffset}}hg.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapter=gg}{const Ig=self.C3;class Sg{constructor(e){this._used=!1,this._value=0,this._propertyKeyframeReached=!1,this._endState=!1,this._propertyTracks=e;for(let e=0,t=this._propertyTracks.length;e<t;e++)this._propertyTracks[e].SetAbsoluteValueObject(this)}GetPropertyTracks(){return this._propertyTracks}SetUsed(){this._used=!0}GetUsed(){return this._used}SetValue(e){this._value=e}GetValue(){return this._value}SetPropertyKeyframeReached(e){this._propertyKeyframeReached=e}GetPropertyKeyframeReached(){return this._propertyKeyframeReached}SetEndState(e){this._endState=e}GetEndState(){return this._endState}Reset(){this._used=!1,this._value=0,this._propertyKeyframeReached=!1,this._endState=!1}}class yg{constructor(e){this._numericInterpolationAdapter=e}Release(){this._numericInterpolationAdapter=null}GetType(){return 0}SetInitialState(){const e=this._numericInterpolationAdapter;return this._numericInterpolationAdapter.GetPropertyTrack(),e._PickResultMode((()=>e._PickTimelinePlaybackMode((()=>0),(()=>e.GetSourceAdapter().GetValueAtTime()))),(()=>{}))}SetResumeState(){}MayNeedBeforeAndAfterInterpolate(){switch(this._numericInterpolationAdapter,this._numericInterpolationAdapter.GetPropertyTrack().GetResultMode()){case"relative":return!1;case"absolute":return!0}}BeforeChangeProperty(){this._numericInterpolationAdapter;const e=this._numericInterpolationAdapter.GetPropertyTrack(),t=e.GetPropertyName();switch(e.GetResultMode()){case"relative":break;case"absolute":if(e.HasAbsoluteValueObject())e.GetAbsoluteValueObject().Reset();else{const s=e.GetTimeline(),n=e.GetInstance(),i=e.GetSourceAdapter(),r=s.GetSimilarPropertyTracks(n,i,t,e);r&&r.length>1&&new Sg(r)}}}ChangeProperty(e,t,s,n,i,r,a,o){const l=this._numericInterpolationAdapter,c=this._numericInterpolationAdapter.GetPropertyTrack();switch(c.GetResultMode()){case"relative":{const a=l.GetLastValue();l._Setter(t-a,s,n),r&&this._MaybeEnsureValue(e,s,n,i,a,t),l.SetLastValue(t);break}case"absolute":{const e=c.GetTimeline(),s=c.GetTrack();if(c.GetInstance(),c.GetSourceAdapter(),c.HasAbsoluteValueObject()){const n=c.GetAbsoluteValueObject(),i=n.GetPropertyTracks(),r=l._GetPropertyKeyframeStubs(i,!0),h=l._GetLastPropertyKeyframeStub(e,e.GetTime(),r);if(h){const e=s.GetStartOffset(),i=h.time-e;if(0===i)n.SetEndState(a),n.SetPropertyKeyframeReached(o),n.SetUsed(),n.SetValue(n.GetValue()+t);else{if(i<0)return;const e=c.GetInterpolatedValue(i);n.SetEndState(a),n.SetPropertyKeyframeReached(o),n.SetUsed(),n.SetValue(n.GetValue()+(t-e))}}}else l._SetterAbsolute(t,o,a);break}}}AfterChangeProperty(){const e=this._numericInterpolationAdapter,t=this._numericInterpolationAdapter.GetPropertyTrack();switch(t.GetResultMode()){case"relative":break;case"absolute":if(t.HasAbsoluteValueObject()){const s=t.GetAbsoluteValueObject();s.GetUsed()&&e._SetterAbsolute(s.GetValue(),s.GetPropertyKeyframeReached(),s.GetEndState())}}}_MaybeEnsureValue(e,t,s,n,i,r){const a=this._numericInterpolationAdapter;n||(t&&e===t.GetTime()?a._AddDelta(t.GetValueWithResultMode(),t,s):s&&e===s.GetTime()?a._AddDelta(s.GetValueWithResultMode(),t,s):r-i==0&&a._AddDelta(t.GetValueWithResultMode(),t,s))}}Ig.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapterForTimeline=yg}{const bg=self.C3;class Gg{constructor(e){this._numericInterpolationAdapter=e}Release(){this._numericInterpolationAdapter=null}GetType(){return 1}SetInitialState(){const e=this._numericInterpolationAdapter;return e.SetFirstAbsoluteUpdate(!0),this._GetAbsoluteInitialValue(e._FirstKeyframeGetter())}SetResumeState(){const e=this._numericInterpolationAdapter;if(e._FirstKeyframeGetter()!==e._CurrentKeyframeGetter())return e.SetFirstAbsoluteUpdate(!0),this._GetAbsoluteInitialValue(e._CurrentKeyframeGetter())}MayNeedBeforeAndAfterInterpolate(){return!1}BeforeChangeProperty(){}ChangeProperty(e,t,s,n,i,r,a,o){const l=this._numericInterpolationAdapter,c=l.GetLastValue();switch(l.GetPropertyTrack().GetResultMode()){case"relative":l._Setter(t-c,s,n),r&&this._MaybeEnsureValue(e,s,n,i,c,t,!1,a);break;case"absolute":l.GetFirstAbsoluteUpdate()?(l.SetFirstAbsoluteUpdate(!1),l._Setter(c,s,n)):0===e&&0===l.GetPropertyTrack().GetTimeline().GetTotalTime()?l._SetterAbsolute(t,!0,!1):(l._Setter(t-c,s,n),r&&this._MaybeEnsureValue(e,s,n,i,c,t,this._ForceEndValue(),a))}l.SetLastValue(t)}AfterChangeProperty(){}_GetAbsoluteInitialValue(e){return e-this._numericInterpolationAdapter.GetCurrentState()}_ForceEndValue(){const e=this._numericInterpolationAdapter,t=e.GetWorldInfo().GetInstance(),s=e.GetPropertyTrack().GetRuntime().GetTimelineManager();let n=0;for(const e of s.GetPlayingTimelines())0===e.GetType()?e.HasTrackInstance(t)&&n++:1===e.GetType()&&e.GetInstance()===t&&n++;return n<=1}_MaybeEnsureValue(e,t,s,n,i,r,a,o){const l=this._numericInterpolationAdapter;n?t&&e===t.GetTime()?l._AddDelta(t.GetValueWithResultMode(),t,s,a,o):s&&e===s.GetTime()?l._AddDelta(s.GetValueWithResultMode(),t,s,a,o):s||l._AddDelta(t.GetValueWithResultMode(),t,s,a,o):t&&e===t.GetTime()?l._AddDelta(t.GetValueWithResultMode(),t,s,a,o):s&&e===s.GetTime()?l._AddDelta(s.GetValueWithResultMode(),t,s,a,o):r-i==0&&l._AddDelta(t.GetValueWithResultMode(),t,s,a,o)}}bg.PropertyTrackState.PropertyInterpolationAdapter.NumericInterpolationAdapterForTween=Gg}{const vg=self.C3,xg=self.Ease;vg.PropertyTrackState.NumericTypeAdapter=class{constructor(){}static WillChange(e,t,s,n){let i;switch(n){case"behavior":case"plugin":i=t.GetPropertyValueByIndex(e);break;case"effect":i=t[e];break;case"instance-variable":i=t.GetInstanceVariableValue(e)}return i!==s}static Interpolate(e,t,s,n){if(!s){let e=n.GetPropertyTrackDataItem();return e=n.GetPropertyTrackData().GetLastPropertyKeyframeDataItem(e),e.GetValueWithResultMode()}let i=n.GetInterpolationMode();if("default"===i&&(i="continuous"),"combo"===n.GetPropertyType()&&(i="discrete"),"discrete"===i)return t.GetValueWithResultMode();if("continuous"===i||"step"===i){const r=n.GetTimeline().GetStep();if("step"===i&&0!==r){const t=1/r;e=Math.floor(e*t)/t}const a=t.GetValueWithResultMode(),o=s.GetValueWithResultMode(),l=t.GetAddOn("cubic-bezier"),c=s.GetAddOn("cubic-bezier"),h=l&&l.GetStartEnable()&&c&&c.GetEndEnable();if(!h&&a===o)return a;const _=t.GetTime(),u=s.GetTime();"step"===i&&0!==r&&(e=vg.clamp(e,_,u));const d=vg.normalize(e,_,u),p=t.GetEase();let f;if(h){const e=u-_;f=xg.GetRuntimeEase(p)(e*d,0,1,e),f=xg.GetRuntimeEase("cubicbezier")(f,a,a+l.GetStartAnchor(),o+c.GetEndAnchor(),o)}else f=xg.GetRuntimeEase(p)((u-_)*d,a,o-a,u-_);return"integer"===n.GetPropertyType()?Math.floor(f):f}}}}{const Tg=self.C3;Tg.PropertyTrackState.AngleTypeAdapter=class{constructor(){}static WillChange(e,t,s,n){let i;switch(n){case"behavior":case"plugin":i=t.GetPropertyValueByIndex(e);break;case"effect":i=t[e];break;case"instance-variable":i=t.GetInstanceVariableValue(e)}return i!==s}static Interpolate(e,t,s,n){if(!s){let e=n.GetPropertyTrackDataItem();return e=n.GetPropertyTrackData().GetLastPropertyKeyframeDataItem(e),e.GetValueWithResultMode()}let i=n.GetInterpolationMode();if("default"===i&&(i="continuous"),"combo"===n.GetPropertyType()&&(i="discrete"),"discrete"===i)return t.GetValueWithResultMode();if("continuous"===i||"step"===i){const r=n.GetTimeline().GetStep();if("step"===i&&0!==r){const t=1/r;e=Math.floor(e*t)/t}const a=t.GetTime(),o=s.GetTime(),l=t.GetValueWithResultMode(),c=s.GetValueWithResultMode();"step"===i&&0!==r&&(e=Tg.clamp(e,a,o));const h=t.GetAddOn("angle");if(!h){if(l===c)return l;const s=Tg.normalize(e,a,o),n=self.Ease.GetRuntimeEase(t.GetEase());return Tg.angleLerp(l,c,n(s,0,1,1))}{const s=h.GetRevolutions();if(l===c&&0===s)return l;const n=Tg.normalize(e,a,o),i=self.Ease.GetRuntimeEase(t.GetEase())(n,0,1,1);switch(h.GetDirection()){case"closest":return Tg.angleLerp(l,c,i,s);case"clockwise":return Tg.angleLerpClockwise(l,c,i,s);case"anti-clockwise":return Tg.angleLerpAntiClockwise(l,c,i,s)}}}}}}{const Cg=self.C3;Cg.PropertyTrackState.BooleanTypeAdapter=class{constructor(){}static WillChange(e,t,s,n){let i;switch(n){case"behavior":case"plugin":i=t.GetPropertyValueByIndex(e);break;case"effect":i=t[e];break;case"instance-variable":i=t.GetInstanceVariableValue(e)}return!!i!=!!s}static Interpolate(e,t,s,n){if(!s){let e=n.GetPropertyTrackDataItem();return e=n.GetPropertyTrackData().GetLastPropertyKeyframeDataItem(e),e.GetValueWithResultMode()?1:0}return t.GetValueWithResultMode()?1:0}}}{const wg=self.C3,Pg=[0,0,0],Ag=[0,0,0],Rg=[0,0,0];wg.PropertyTrackState.ColorTypeAdapter=class{constructor(){}static WillChange(e,t,s,n){let i;switch(n){case"behavior":case"plugin":i=t.GetPropertyValueByIndex(e);break;case"effect":i=t[e];break;case"instance-variable":i=t.GetInstanceVariableValue(e)}return Array.isArray(s)?(Pg[0]=s[0],Pg[1]=s[1],Pg[2]=s[2]):(Rg.parseCommaSeparatedRgb(s),Pg[0]=Math.floor(255*Rg.getR()),Pg[1]=Math.floor(255*Rg.getG()),Pg[2]=Math.floor(255*Rg.getB())),Array.isArray(i)?(Ag[0]=i[0],Ag[1]=i[1],Ag[2]=i[2]):(Rg.parseCommaSeparatedRgb(i),Ag[0]=Math.floor(255*Rg.getR()),Ag[1]=Math.floor(255*Rg.getG()),Ag[2]=Math.floor(255*Rg.getB())),Pg[0]!==Ag[0]||Pg[1]!==Ag[1]||Pg[2]!==Ag[2]}static Interpolate(e,t,s,n){if(!s){let e=n.GetPropertyTrackDataItem();e=n.GetPropertyTrackData().GetLastPropertyKeyframeDataItem(e);const t=e.GetValueWithResultMode();return Pg[0]=t[0],Pg[1]=t[1],Pg[2]=t[2],Pg}let i=n.GetInterpolationMode();if("default"===i&&(i="continuous"),"discrete"===i){const e=t.GetValueWithResultMode();return Pg[0]=e[0],Pg[1]=e[1],Pg[2]=e[2],Pg}if("continuous"===i||"step"===i){const r=n.GetTimeline().GetStep();if("step"===i&&0!==r){const t=1/r;e=Math.floor(e*t)/t}const a=t.GetTime(),o=s.GetTime(),l=t.GetValueWithResultMode(),c=s.GetValueWithResultMode();"step"===i&&0!==r&&(e=wg.clamp(e,a,o));const h=wg.normalize(e,a,o),_=t.GetEase(),u=l[0],d=l[1],p=l[2],f=c[0],m=c[1],g=c[2],I=self.Ease.GetRuntimeEase(_),S=o-a,y=S*h;return Pg[0]=u===f?u:I(y,u,f-u,S),Pg[1]=d===m?d:I(y,d,m-d,S),Pg[2]=p===g?p:I(y,p,g-p,S),Pg}}}}{const Dg=self.C3;Dg.PropertyTrackState.TextTypeAdapter=class{constructor(){}static WillChange(e,t,s,n){let i;switch(n){case"behavior":case"plugin":i=t.GetPropertyValueByIndex(e);break;case"effect":i=t[e];break;case"instance-variable":i=t.GetInstanceVariableValue(e)}return i!==s}static Interpolate(e,t,s,n){if(!s){let e=n.GetPropertyTrackDataItem();return e=n.GetPropertyTrackData().GetLastPropertyKeyframeDataItem(e),e.GetValueWithResultMode()}return t.GetValueWithResultMode()}}}{const Eg=self.C3;Eg.TimelineDataManager=class{constructor(){this._timelineDataItems=new Map}Release(){for(const e of this._timelineDataItems.values())e.Release();this._timelineDataItems.clear(),this._timelineDataItems=null}Add(e){const t=new Eg.TimelineDataItem(e),s=t.GetName();this._timelineDataItems.set(s,t)}Get(e){return this._timelineDataItems.get(e)}GetNameId(){return 0}static _CreateDataItems(e,t,s,n){if(t)for(const i of t)Eg.TimelineDataManager._CreateDataItem("create",i,e,s,n)}static _CreateDataItemsIncludingDisabled(e,t,s,n){if(t)for(const i of t)Eg.TimelineDataManager._CreateDataItem("create-including-disabled",i,e,s,n)}static _LoadDataItemsFromJson(e,t,s,n){e.length?t.forEach(((t,s)=>{e[s]._LoadFromJson(t)})):t.forEach((t=>{Eg.TimelineDataManager._CreateDataItem("load",t,e,s,n)}))}static _CreateDataItem(e,t,s,n,i){let r;if("function"==typeof n)switch(e){case"load":r=new n(null,i);break;case"create":case"create-including-disabled":r=new n(t,i)}else if("object"==typeof n){const s=t[n.prop],a=n.map.get(s);switch(e){case"load":r=new a(null,i);break;case"create":case"create-including-disabled":r=new a(t,i)}}switch(e){case"load":r._LoadFromJson(t),s.push(r);break;case"create":if("function"==typeof r.GetEnable&&!r.GetEnable())return r.Release();s.push(r);break;case"create-including-disabled":s.push(r)}}}}{const Mg=self.C3,kg=0,Lg=1,Fg=2,Bg=3,Og=4,Ng=5,Wg=6,Vg=7,jg=8,Ug=9,Hg=10,zg=11;Mg.TimelineDataItem=class{constructor(e){this._name="",this._totalTime=NaN,this._step=0,this._interpolationMode="default",this._resultMode="default",this._loop=!1,this._pingPong=!1,this._repeatCount=1,this._trackData=null,this._startOnLayout="",this._transformWithSceneGraph=!1,this._useSystemTimescale=!0,e&&(this._name=e[0],this._totalTime=e[1],this._step=e[2],this._interpolationMode=e[3],this._resultMode=e[4],this._loop=!!e[6],this._pingPong=!!e[7],this._repeatCount=e[8],this._startOnLayout=e[9],this._transformWithSceneGraph=!!e[10],this._useSystemTimescale=!!e[11],this._trackData=new Mg.TrackData(e[5],this))}Release(){this._trackData.Release(),this._trackData=null}GetTrackData(){return this._trackData||(this._trackData=new Mg.TrackData(null,this)),this._trackData}GetName(){return this._name}SetName(e){this._name=e}GetTotalTime(){return this._totalTime}SetTotalTime(e){this._totalTime=e}GetStep(){return this._step}SetStep(e){this._step=e}GetInterpolationMode(){return this._interpolationMode}SetInterpolationMode(e){this._interpolationMode=e}GetResultMode(){return this._resultMode}SetResultMode(e){this._resultMode=e}GetLoop(){return this._loop}SetLoop(e){this._loop=e}GetPingPong(){return this._pingPong}SetPingPong(e){this._pingPong=e}GetRepeatCount(){return this._repeatCount}SetRepeatCount(e){this._repeatCount=e}GetStartOnLayout(){return this._startOnLayout}GetTransformWithSceneGraph(){return this._transformWithSceneGraph}GetUseSystemTimescale(){return this._useSystemTimescale}_SaveToJson(){return{trackDataJson:this._trackData._SaveToJson(),name:this._name,totalTime:this._totalTime,step:this._step,interpolationMode:this._interpolationMode,resultMode:this._resultMode,loop:this._loop,pingPong:this._pingPong,repeatCount:this._repeatCount,startOnLayout:this._startOnLayout,transformWithSceneGraph:!!this._transformWithSceneGraph,useSystemTimescale:this._useSystemTimescale}}_LoadFromJson(e){e&&(this.GetTrackData()._LoadFromJson(e.trackDataJson),this._name=e.name,this._totalTime=e.totalTime,this._step=e.step,this._interpolationMode=e.interpolationMode,this._resultMode=e.resultMode,this._loop=e.loop,this._pingPong=e.pingPong,this._repeatCount=e.repeatCount,this._startOnLayout=e.startOnLayout,this._transformWithSceneGraph=!!e.transformWithSceneGraph,this._useSystemTimescale=!!e.useSystemTimescale)}}}{const Xg=self.C3,Yg=0,qg=1,Jg=2,Kg=1,$g=2,Zg=3,Qg=4,eI=5,tI=6,sI=7,nI=0,iI=1,rI=8,aI=0,oI=1,lI=9,cI=10;class hI{constructor(e,t){this._trackData=t,this._instanceData=null,this._additionalInstanceData=null,this._instanceUid=NaN,this._objectClassIndex=NaN,this._interpolationMode="default",this._resultMode="default",this._enabled=!1,this._keyframeData=null,this._propertyTrackData=null,this._id="",this._nestedData=null,this._startOffset=0,this._localTotalTime=this._trackData.GetTimelineDataItem().GetTotalTime(),this._type=0,this._name="",e&&(e[0]&&(this._instanceData=e[0],this._instanceUid=e[0][2],this._objectClassIndex=e[0][1]),this._interpolationMode=e[1],this._resultMode=e[2],this._enabled=!!e[3],e[6]&&(this._id=e[6]),e[7]&&(this._nestedData=e[7],this._startOffset=e[7][0],this._localTotalTime=e[7][1]),e[8]&&(this._additionalInstanceData=e[8]),e[8]&&(this._additionalInstanceData=e[8]),e[9]&&(this._type=e[9]),e[10]&&(this._name=e[10]),this._keyframeData=new Xg.KeyframeData(e[4],this),this._propertyTrackData=new Xg.PropertyTrackData(e[5],this))}Release(){this._instanceData=null,this._trackData=null,this._keyframeData&&(this._keyframeData.Release(),this._keyframeData=null),this._propertyTrackData&&(this._propertyTrackData.Release(),this._propertyTrackData=null),this._nestedData=null}GetTrackData(){return this._trackData}GetKeyframeData(){return this._keyframeData||(this._keyframeData=new Xg.KeyframeData(null,this)),this._keyframeData}GetPropertyTrackData(){return this._propertyTrackData||(this._propertyTrackData=new Xg.PropertyTrackData(null,this)),this._propertyTrackData}GetInstanceData(){return this._instanceData}GetObjectClassIndex(){return this._objectClassIndex}SetObjectClassIndex(e){this._objectClassIndex=e}GetInstanceUID(){return this._instanceUid}SetInstanceUID(e){this._instanceUid=e}GetInterpolationMode(){return this._interpolationMode}SetInterpolationMode(e){this._interpolationMode=e}GetResultMode(){return this._resultMode}SetResultMode(e){this._resultMode=e}GetEnable(){return this._enabled}SetEnable(e){this._enabled=!!e}GetId(){return this._id}GetStartOffset(){return this._startOffset}GetLocalTotalTime(){return this._localTotalTime}SetLocalTotalTime(e){this._localTotalTime=e}GetOriginalWidth(){return this._additionalInstanceData[0]}SetOriginalWidth(e){this._additionalInstanceData||(this._additionalInstanceData=[]),this._additionalInstanceData[0]=e}GetOriginalHeight(){return this._additionalInstanceData||(this._additionalInstanceData=[]),this._additionalInstanceData[1]}SetOriginalHeight(e){this._additionalInstanceData||(this._additionalInstanceData=[]),this._additionalInstanceData[1]=e}GetType(){return this._type}GetName(){return this._name}_SaveToJson(){return{keyframeDataJson:this._keyframeData._SaveToJson(),propertyTrackDataJson:this._propertyTrackData._SaveToJson(),instanceData:this._instanceData,additionalInstanceData:this._additionalInstanceData,instanceUid:this._instanceUid,objectClassIndex:this._objectClassIndex,interpolationMode:this._interpolationMode,resultMode:this._resultMode,enabled:this._enabled,id:this._id,nestedData:this._nestedData,type:this._type,name:this._name}}_LoadFromJson(e){e&&(this._instanceData=e.instanceData,this._instanceUid=e.instanceUid,this._objectClassIndex=e.objectClassIndex,this._interpolationMode=e.interpolationMode,this._resultMode=e.resultMode,this._enabled=e.enabled,this._id=e.id,this._type=e.type?e.type:0,this._name=e.name?e.name:"",this._localTotalTime=this._trackData.GetTimelineDataItem().GetTotalTime(),e.nestedData&&(this._nestedData=e.nestedData,this._startOffset=this._nestedData[0],this._localTotalTime=this._nestedData[1]),e.additionalInstanceData&&(this._additionalInstanceData=e.additionalInstanceData),this.GetKeyframeData()._LoadFromJson(e.keyframeDataJson),this.GetPropertyTrackData()._LoadFromJson(e.propertyTrackDataJson))}}Xg.TrackData=class{constructor(e,t){this._timelineDataItem=t,this._trackDataItems=[],Xg.TimelineDataManager._CreateDataItems(this._trackDataItems,e,hI,this)}Release(){this._timelineDataItem=null;for(const e of this._trackDataItems)e.Release();Xg.clearArray(this._trackDataItems),this._trackDataItems=null}GetTimelineDataItem(){return this._timelineDataItem}AddEmptyTrackDataItem(){const e=new hI(null,this);return this._trackDataItems.push(e),e}GetFirstKeyframeDataItem(e){return e.GetKeyframeData().GetKeyframeDataItemArray()[0]}GetLastKeyframeDataItem(e){return e.GetKeyframeData().GetKeyframeDataItemArray().at(-1)}GetKeyFrameDataItemAtTime(e,t){const s=t.GetKeyframeData().GetKeyframeDataItemArray(),n=s.length;for(let t=0;t<n;t++){const n=s[t];if(n.GetTime()===e)return n}}GetFirstKeyFrameDataItemHigherThan(e,t){const s=t.GetKeyframeData().GetKeyframeDataItemArray(),n=s.length;for(let t=0;t<n;t++){const n=s[t];if(n.GetTime()>e)return n}}GetFirstKeyFrameDataItemHigherOrEqualThan(e,t){const s=t.GetKeyframeData().GetKeyframeDataItemArray(),n=s.length;for(let t=0;t<n;t++){const n=s[t];if(n.GetTime()>=e)return n}}GetFirstKeyFrameDataItemLowerOrEqualThan(e,t){const s=t.GetKeyframeData().GetKeyframeDataItemArray();for(let t=s.length-1;t>=0;t--){const n=s[t];if(n.GetTime()<=e)return n}}*trackDataItems(){for(const e of this._trackDataItems)yield e}_SaveToJson(){return{trackDataItemsJson:this._trackDataItems.map((e=>e._SaveToJson()))}}_LoadFromJson(e){e&&Xg.TimelineDataManager._LoadDataItemsFromJson(this._trackDataItems,e.trackDataItemsJson,hI,this)}}}{const _I=self.C3,uI=0,dI=0,pI=1,fI=2,mI=3,gI=4,II=5,SI=6,yI=7,bI=8,GI=9;class vI{constructor(e,t){this._propertyTrackData=t,this._sourceAdapterId="",this._sourceAdapterArguments=null,this._property=null,this._type=null,this._min=NaN,this._max=NaN,this._interpolationMode="default",this._resultMode="default",this._enabled=!1,this._propertyKeyframeData=null,this._canHavePropertyKeyframes=!0,e&&(this._sourceAdapterId=e[0][0],this._sourceAdapterArguments=e[0].slice(1),this._property=e[1],this._type=e[2],this._min=e[3],this._max=e[4],this._interpolationMode=e[5],this._resultMode=e[6],this._enabled=!!e[7],this._propertyKeyframeData=new _I.PropertyKeyframeData(e[8],this),this._canHavePropertyKeyframes=e[9])}Release(){this._propertyKeyframeData.Release(),this._propertyKeyframeData=null,this._propertyTrackData=null,this._sourceAdapterArguments=null}GetPropertyTrackData(){return this._propertyTrackData}GetPropertyKeyframeData(){return this._propertyKeyframeData||(this._propertyKeyframeData=new _I.PropertyKeyframeData(null,this)),this._propertyKeyframeData}GetSourceAdapterId(){return this._sourceAdapterId}SetSourceAdapterId(e){this._sourceAdapterId=e}GetSourceAdapterArguments(){return this._sourceAdapterArguments}SetSourceAdapterArguments(e){this._sourceAdapterArguments=e}GetProperty(){return this._property}SetProperty(e){this._property=e}GetType(){return this._type}SetType(e){this._type=e}GetMin(){return this._min}SetMin(e){this._min=e}GetMax(){return this._max}SetMax(e){this._max=e}GetInterpolationMode(){return this._interpolationMode}SetInterpolationMode(e){this._interpolationMode=e}GetResultMode(){return this._resultMode}SetResultMode(e){this._resultMode=e}GetEnable(){return this._enabled}SetEnable(e){this._enabled=!!e}CanHavePropertyKeyframes(){return!!this._canHavePropertyKeyframes}_SaveToJson(){return{propertyKeyframeDataJson:this._propertyKeyframeData._SaveToJson(),sourceAdapterId:this._sourceAdapterId,sourceAdapterArguments:this._sourceAdapterArguments,property:this._property,type:this._type,min:this._min,max:this._max,interpolationMode:this._interpolationMode,resultMode:this._resultMode,enabled:this._enabled,canHavePropertyKeyframes:this._canHavePropertyKeyframes}}_LoadFromJson(e){e&&(this._sourceAdapterId=e.sourceAdapterId,this._sourceAdapterArguments=e.sourceAdapterArguments,this._property=e.property,this._type=e.type,this._min=e.min,this._max=e.max,this._interpolationMode=e.interpolationMode,this._resultMode=e.resultMode,this._enabled=e.enabled,this._canHavePropertyKeyframes=e.canHavePropertyKeyframes,this.GetPropertyKeyframeData()._LoadFromJson(e.propertyKeyframeDataJson))}}_I.PropertyTrackData=class{constructor(e,t){this._trackDataItem=t,this._propertyTrackDataItems=[],_I.TimelineDataManager._CreateDataItems(this._propertyTrackDataItems,e,vI,this)}Release(){this._trackDataItem=null;for(const e of this._propertyTrackDataItems)e.Release();_I.clearArray(this._propertyTrackDataItems),this._propertyTrackDataItems=null}GetTrackDataItem(){return this._trackDataItem}AddEmptyPropertyTrackDataItem(){const e=new vI(null,this);return this._propertyTrackDataItems.push(e),e}GetFirstPropertyKeyframeDataItem(e){return e.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray()[0]}GetLastPropertyKeyframeDataItem(e){return e.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray().at(-1)}GetPropertyKeyFrameDataItemAtTime(e,t){const s=t.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray(),n=s.length;for(let t=0;t<n;t++){const n=s[t];if(n.GetTime()===e)return n}}GetFirstPropertyKeyFrameDataItemHigherThan(e,t){const s=t.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray(),n=s.length;for(let t=0;t<n;t++){const n=s[t];if(n.GetTime()>e)return n}}GetFirstPropertyKeyFrameDataItemHigherOrEqualThan(e,t){const s=t.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray(),n=s.length;for(let t=0;t<n;t++){const n=s[t];if(n.GetTime()>=e)return n}}GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,t){const s=t.GetPropertyKeyframeData().GetPropertyKeyframeDataItemArray();for(let t=s.length-1;t>=0;t--){const n=s[t];if(n.GetTime()<=e)return n}}*propertyTrackDataItems(){for(const e of this._propertyTrackDataItems)yield e}_SaveToJson(){return{propertyTrackDataItemsJson:this._propertyTrackDataItems.map((e=>e._SaveToJson()))}}_LoadFromJson(e){e&&_I.TimelineDataManager._LoadDataItemsFromJson(this._propertyTrackDataItems,e.propertyTrackDataItemsJson,vI,this)}}}{const xI=self.C3,TI=0,CI=1,wI=2,PI=3;class AI{constructor(e,t){if(this._keyframeData=t,this._time=-1,this._ease="noease",this._enable=!1,this._tags=null,this._lowerTags=null,!e)return;this._time=e[0],this._ease=e[1],this._enable=!!e[2];const s=e[3];this._tags=s?s.split(" "):[],this._lowerTags=new Set(this._tags.map((e=>e.toLowerCase()))),this._next=null,this._last=null}Release(){this._keyframeData=null,xI.clearArray(this._tags),this._tags=null,this._lowerTags.clear(),this._lowerTags=null,this._next=null}GetKeyframeData(){return this._keyframeData}GetNext(){return this._next}SetNext(e){this._next=e}GetLast(){return this._last}SetLast(e){this._last=e}GetTime(){return this._time}SetTime(e){this._time=e,this._keyframeData._LinkKeyframeDataItems()}GetEase(){return this._ease}SetEase(e){this._ease=e}GetEnable(){return this._enable}SetEnable(e){this._enable=!!e}GetTags(){return this._tags}SetTags(e){this._tags=e?e.split(" "):[],this._lowerTags=new Set(this._tags.map((e=>e.toLowerCase())))}GetLowerTags(){return this._lowerTags}HasTag(e){return this._lowerTags.has(e.toLowerCase())}_SaveToJson(){return{time:this._time,ease:this._ease,enable:this._enable,tags:this._tags}}_LoadFromJson(e){e&&(this._time=e.time,this._ease=e.ease,this._enable=e.enable,this._tags=e.tags,this._lowerTags=new Set(this._tags.map((e=>e.toLowerCase()))))}}xI.KeyframeData=class{constructor(e,t){this._trackDataItem=t,this._keyframeDataItems=[],xI.TimelineDataManager._CreateDataItems(this._keyframeDataItems,e,AI,this),this._LinkKeyframeDataItems()}Release(){this._trackDataItem=null;for(const e of this._keyframeDataItems)e.Release();xI.clearArray(this._keyframeDataItems),this._keyframeDataItems=null}_LinkKeyframeDataItems(){this._keyframeDataItems.sort(((e,t)=>e.GetTime()-t.GetTime()));for(let e=0;e<this._keyframeDataItems.length;e++){const t=this._keyframeDataItems[e];t.SetNext(this._keyframeDataItems[e+1]),t.SetLast(this._keyframeDataItems[e-1])}}GetTrackDataItem(){return this._trackDataItem}GetKeyframeDataItemCount(){return this._keyframeDataItems.length}GetKeyframeDataItemArray(){return this._keyframeDataItems}AddEmptyKeyframeDataItem(){const e=new AI(null,this);return this._keyframeDataItems.push(e),this._LinkKeyframeDataItems(),e}DeleteKeyframeDataItems(e){for(const t of this._keyframeDataItems){if(!e(t))continue;const s=this._keyframeDataItems.indexOf(t);-1!==s&&(t.Release(),this._keyframeDataItems.splice(s,1))}this.SortKeyframeDataItems(),this._LinkKeyframeDataItems()}SortKeyframeDataItems(){this._keyframeDataItems.sort(((e,t)=>e.GetTime()-t.GetTime()))}GetKeyframeDataItemIndex(e){return this._keyframeDataItems.indexOf(e)}GetKeyframeDataItemFromIndex(e){return this._keyframeDataItems[e]}*keyframeDataItems(){for(const e of this._keyframeDataItems)yield e}*keyframeDataItemsReverse(){for(let e=this._keyframeDataItems.length-1;e>=0;e--)yield this._keyframeDataItems[e]}_SaveToJson(){return{keyframeDataItemsJson:this._keyframeDataItems.map((e=>e._SaveToJson()))}}_LoadFromJson(e){e&&(xI.TimelineDataManager._LoadDataItemsFromJson(this._keyframeDataItems,e.keyframeDataItemsJson,AI,this),this._LinkKeyframeDataItems())}}}{const RI=self.C3,DI=0,EI=0,MI=1,kI=2,LI=1,FI=2,BI=3,OI=4,NI=5;class WI{constructor(e,t){this._propertyKeyframeData=t,this._value=null,this._aValue=null,this._type="",this._time=NaN,this._ease="noease",this._enable=!1,this._addonData=null,this._addonInstance=void 0,this._pathMode="line",e&&(this._value=e[0][0],this._aValue=e[0][1],this._type=e[0][2],this._time=e[1],this._ease=e[2],this._enable=!!e[3],this._pathMode=e[5],this._addonData=null,e[4]&&(this._addonData=new RI.AddonData(e[4],this)),this._next=null,this._prev=null)}Release(){this._propertyKeyframeData=null,this._addonData&&(this._addonData.Release(),this._addonData=null),this._next=null,this._prev=null}GetAddonData(){return this._addonData}SetNext(e){this._next=e}GetNext(){return this._next}SetPrevious(e){this._prev=e}GetPrevious(){return this._prev}GetValue(){return this._value}SetValue(e){"color"===this._type&&RI.IsFiniteNumber(e)?(this._value[0]=RI.GetRValue(e),this._value[1]=RI.GetGValue(e),this._value[2]=RI.GetBValue(e)):this._value=e}GetAbsoluteValue(){return this._aValue}SetAbsoluteValue(e){"color"===this._type&&RI.IsFiniteNumber(e)?(this._aValue[0]=RI.GetRValue(e),this._aValue[1]=RI.GetGValue(e),this._aValue[2]=RI.GetBValue(e)):this._aValue=e}GetValueWithResultMode(){const e=this._propertyKeyframeData.GetPropertyTrackDataItem().GetResultMode();return"relative"===e?this.GetValue():"absolute"===e?this.GetAbsoluteValue():void 0}GetType(){return this._type}SetType(e){this._type=e}GetTime(){return this._time}SetTime(e){this._time=e,this._propertyKeyframeData._LinkPropertyKeyframeDataItems()}GetEase(){return this._ease}SetEase(e){this._ease=e}GetEnable(){return this._enable}SetEnable(e){this._enable=!!e}GetPathMode(){return this._pathMode}GetAddOn(e){if(!this._addonData)return;if(this._addonInstance||null===this._addonInstance)return this._addonInstance;const t=this._addonData.GetAddDataItemArray();if(!t)return this._addonInstance=null,this._addonInstance;const s=t.length;for(let n=0;n<s;n++){const s=t[n];if(s.GetId()===e)return this._addonInstance=s,this._addonInstance}return this._addonInstance=null,this._addonInstance}_SaveToJson(){const e=this._addonData;return{addonDataJson:e?e._SaveToJson():e,value:this._value,aValue:this._aValue,type:this._type,time:this._time,ease:this._ease,enable:this._enable}}_LoadFromJson(e){e&&(e.addonDataJson&&this._addonData._SetFromJson(e.addonDataJson),this._value=e.value,this._aValue=e.aValue,this._type=e.type,this._time=e.time,this._ease=e.ease,this._enable=e.enable)}}RI.PropertyKeyframeData=class{constructor(e,t){this._propertyTrackDataItem=t,this._propertyKeyframeDataItems=[],this._propertyKeyframeDataItemsIncludingDisabled=[],RI.TimelineDataManager._CreateDataItems(this._propertyKeyframeDataItems,e,WI,this),RI.TimelineDataManager._CreateDataItemsIncludingDisabled(this._propertyKeyframeDataItemsIncludingDisabled,e,WI,this),this._LinkPropertyKeyframeDataItems()}Release(){this._propertyTrackDataItem=null;for(const e of this._propertyKeyframeDataItems)e.Release();RI.clearArray(this._propertyKeyframeDataItems),this._propertyKeyframeDataItems=null;for(const e of this._propertyKeyframeDataItemsIncludingDisabled)e.Release();RI.clearArray(this._propertyKeyframeDataItemsIncludingDisabled),this._propertyKeyframeDataItemsIncludingDisabled=null}_LinkPropertyKeyframeDataItems(){let e=this._propertyKeyframeDataItems;e.sort(((e,t)=>e.GetTime()-t.GetTime()));for(let t=0;t<e.length;t++){const s=e[t];t+1<e.length&&s.SetNext(e[t+1]),t-1>=0&&s.SetPrevious(e[t-1])}e=this._propertyKeyframeDataItemsIncludingDisabled,e.sort(((e,t)=>e.GetTime()-t.GetTime()));for(let t=0;t<e.length;t++){const s=e[t];t+1<e.length&&s.SetNext(e[t+1]),t-1>=0&&s.SetPrevious(e[t-1])}}AddEmptyPropertyKeyframeDataItem(){const e=new WI(null,this);return this._propertyKeyframeDataItems.push(e),this._LinkPropertyKeyframeDataItems(),e}DeletePropertyKeyframeDataItems(e){for(const t of this._propertyKeyframeDataItems){if(!e(t))continue;const s=this._propertyKeyframeDataItems.indexOf(t);-1!==s&&(t.Release(),this._propertyKeyframeDataItems.splice(s,1))}this.SortPropertyKeyFrameDataItems(),this._LinkPropertyKeyframeDataItems()}SortPropertyKeyFrameDataItems(){this._propertyKeyframeDataItems.sort(((e,t)=>e.GetTime()-t.GetTime()))}GetPropertyTrackDataItem(){return this._propertyTrackDataItem}GetPropertyKeyframeDataItemCount(){return this._propertyKeyframeDataItems.length}GetLastPropertyKeyframeDataItem(){return this._propertyKeyframeDataItems[this._propertyKeyframeDataItems.length-1]}GetPropertyKeyframeDataItemArray(){return this._propertyKeyframeDataItems}GetPropertyKeyframeDataItemArrayIncludingDisabled(){return this._propertyKeyframeDataItemsIncludingDisabled}*propertyKeyframeDataItems(){for(const e of this._propertyKeyframeDataItems)yield e}*propertyKeyframeDataItemsReverse(){for(let e=this._propertyKeyframeDataItems.length-1;e>=0;e--)yield this._propertyKeyframeDataItems[e]}_SaveToJson(){const e=this._propertyKeyframeDataItems,t=this._propertyKeyframeDataItemsIncludingDisabled;return{propertyKeyframeDataItemsJson:e.map((e=>e._SaveToJson())),propertyKeyframeDataItemsIncludingDisabledJson:t.map((e=>e._SaveToJson()))}}_LoadFromJson(e){e&&(RI.TimelineDataManager._LoadDataItemsFromJson(this._propertyKeyframeDataItems,e.propertyKeyframeDataItemsJson,WI,this),RI.TimelineDataManager._LoadDataItemsFromJson(this._propertyKeyframeDataItemsIncludingDisabled,e.propertyKeyframeDataItemsIncludingDisabledJson,WI,this),this._LinkPropertyKeyframeDataItems())}}}{const VI=self.C3,jI=0,UI=1;class HI{constructor(e,t){this._addonData=t,this._id=e[0],this._data=e[1]}Release(){this._addonData=null,this._data=null}GetAddonData(){return this._addonData}GetId(){return this._id}_SaveToJson(){return{id:this._id,data:this._data}}_LoadFromJson(e){e&&(this._id=e.id,this._data=e.data)}}const zI=0,XI=1,YI=2,qI=3;class JI extends HI{constructor(e,t){super(e,t),this._startAnchor=this._data[0],this._startEnable=!!this._data[1],this._endAnchor=this._data[2],this._endEnable=!!this._data[3]}Release(){super.Release()}GetStartAnchor(){return this._startAnchor}GetStartEnable(){return this._startEnable}GetEndAnchor(){return this._endAnchor}GetEndEnable(){return this._endEnable}_SaveToJson(){return Object.assign(super._SaveToJson(),{startAnchor:this._startAnchor,startEnable:!!this._startEnable,endAnchor:this._endAnchor,endEnable:!!this._endEnable})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._startAnchor=e.startAnchor,this._startEnable=!!e.startEnable,this._endAnchor=e.endAnchor,this._endEnable=!!e.endEnable)}}const KI=0,$I=1;class ZI extends HI{constructor(e,t){super(e,t),this._direction=this._data[0],this._revolutions=this._data[1]}Release(){super.Release()}GetDirection(){return this._direction}GetRevolutions(){return this._revolutions}_SaveToJson(){return Object.assign(super._SaveToJson(),{direction:this._direction,revolutions:this._revolutions})}_LoadFromJson(e){e&&(super._LoadFromJson(e),this._direction=e.direction,this._revolutions=e.revolutions)}}VI.AddonData=class{constructor(e,t){this._propertyKeyframeDataItem=t,this._addonDataItems=[],VI.TimelineDataManager._CreateDataItems(this._addonDataItems,e,{prop:0,map:new Map([["cubic-bezier",JI],["angle",ZI]])},this)}Release(){this._propertyKeyframeDataItem=null;for(const e of this._addonDataItems)e.Release();VI.clearArray(this._addonDataItems),this._addonDataItems=null}GetPropertyKeyframeDataItem(){return this._propertyKeyframeDataItem}GetAddDataItemArray(){return this._addonDataItems}*addonDataItems(){for(const e of this._addonDataItems)yield e}_SaveToJson(){return{addonDataItemsJson:this._addonDataItems.map((e=>e._SaveToJson()))}}_LoadFromJson(e){e&&VI.TimelineDataManager._LoadDataItemsFromJson(this._addonDataItems,e.addonDataItemsJson,{prop:"id",map:new Map([["cubic-bezier",JI],["angle",ZI]])},this)}}}{const QI=self.C3,eS="start-value",tS="current-state",sS=0,nS=1;let iS=0;QI.TweenState=class extends QI.TimelineState{constructor(e,t){super("tween-"+iS++,e,t),this._id="",this._destroyInstanceOnComplete=!1,this._initialValueMode="start-value",this._instance=null,this._on_completed_callbacks=null,this._on_started_callbacks=null,this._behInst=null,this._track=null,this._iTweenState=null}FireReleaseEvent(e){const t=QI.New(QI.Event,"tweenstatereleased");t.tweenState=this,e.dispatchEvent(t)}GetType(){return 1}CreateTrackStates(){for(const e of this._timelineDataItem.GetTrackData().trackDataItems())this._tracks.push(QI.TweenTrackState.Create(this,e));this._track=this._tracks[0]}AddTrack(){const e=this._timelineDataItem.GetTrackData().AddEmptyTrackDataItem(),t=QI.TweenTrackState.Create(this,e);return this._tracks.push(t),this._CacheTrack(),t}_CacheTrack(){this._track=this._tracks[0]}GetPropertyTrack(e){return this._track.GetPropertyTracks()[0]}SetPropertyType(e){this._propertyType=e}GetInstance(){const e=this.GetTracks();if(!e||!e.length)return;const t=e[0];if(this._track=t,!t)return;const s=t.GetInstance();return t.IsInstanceValid()?s:void 0}SetBehaviorInstance(e){this._behInst=e}AddStartedCallback(e){this._on_started_callbacks||(this._on_started_callbacks=[]),this._on_started_callbacks.push(e)}AddCompletedCallback(e){this._on_completed_callbacks||(this._on_completed_callbacks=[]),this._on_completed_callbacks.push(e)}RemoveStartedCallback(e){if(!this._on_started_callbacks)return;const t=this._on_started_callbacks.indexOf(e);-1!==t&&this._on_started_callbacks.splice(t,1)}RemoveCompletedCallback(e){if(!this._on_completed_callbacks)return;const t=this._on_completed_callbacks.indexOf(e);-1!==t&&this._on_completed_callbacks.splice(t,1)}SetStartValue(e,t){for(const s of this._tracks)for(const n of s._propertyTracks){if(n.GetPropertyName()!==t)continue;const s=n.GetPropertyTrackData(),i=n.GetPropertyTrackDataItem(),r=s.GetFirstPropertyKeyframeDataItem(i);r.SetValue(e),r.SetAbsoluteValue(e)}}_GetPropertyTrackState(e){for(const t of this._tracks)for(const s of t._propertyTracks)if(s.GetPropertyName()===e)return s}BeforeSetEndValues(e){for(const t of e){const e=this._GetPropertyTrackState(t);this.SetStartValue(e.GetCurrentState(),t)}if(this.IsForwardPlayBack()){const e=this.GetTotalTime()-this.GetTime();this.SetTotalTime(e);for(const t of this._tracks)t.SetLocalTotalTime(e);this._SetTime(0)}else{const e=this.GetTime();this.SetTotalTime(e);for(const t of this._tracks)t.SetLocalTotalTime(e);this._SetTime(e)}this.SetInitialStateFromSetTime()}SetEndValue(e,t){const s=this._GetPropertyTrackState(t),n=s.GetPropertyTrackData(),i=s.GetPropertyTrackDataItem(),r=n.GetLastPropertyKeyframeDataItem(i);r.SetTime(this.GetTotalTime()),r.SetValue(e),r.SetAbsoluteValue(e)}SetId(e){this._id=e}GetId(){return this._id}SetInitialValueMode(e){this._initialValueMode=e}GetInitialValueMode(){return this._initialValueMode}SetDestroyInstanceOnComplete(e){this._destroyInstanceOnComplete=e}GetDestroyInstanceOnComplete(){return this._destroyInstanceOnComplete}OnStarted(){if(this._on_started_callbacks)for(const e of this._on_started_callbacks)e(this);if(!this.IsComplete())for(const e of this._tracks)e.CompareSaveStateWithCurrent()}OnCompleted(){this._completedTick=this._runtime.GetTickCount()}FinishTriggers(){if(!this._finishedTriggers&&(this._finishedTriggers=!0,this._on_completed_callbacks))for(const e of this._on_completed_callbacks)e(this)}SetTime(e){this._DeleteIntermediateKeyframes(),super.SetTime(e)}_SetTimeAndReset(e){QI.IsFiniteNumber(e)||(e=this.GetTotalTime()),e<0?this._playheadTime=0:e>=this.GetTotalTime()?this._playheadTime=this.GetTotalTime():this._playheadTime=e,this._track.SetResetState()}SetInitialState(e){if(!this.InitialStateSet()&&"current-state"===this.GetInitialValueMode())for(const e of this._tracks)e.CompareInitialStateWithCurrent();super.SetInitialState(e)}Stop(e=!1){if(super.Stop(e),!this.IsComplete())for(const e of this._tracks)e.SaveState()}Reset(e=!0,t=!1){this._DeleteIntermediateKeyframes(),super.Reset(e,t)}_DeleteIntermediateKeyframes(){for(const e of this._tracks){const t=e=>{const t=e.GetTime(),s=this.GetTotalTime();return 0!==t&&t!==s};e.DeleteKeyframes(t),e.DeletePropertyKeyframes(t)}}_OnBeforeChangeLayout(){if(this.IsReleased())return!0;const e=this.GetInstance();return!(e&&e.GetObjectClass().IsGlobal()||(this._timelineManager.CompleteTimelineBeforeChangeOfLayout(this),this.ResetBeforeChangeLayout(),0))}Tick(e,t,s){if(this._instance||(this._instance=this.GetInstance()),!this._instance||this._instance.IsDestroyed())return this.Stop(!0),void this.OnCompleted();const n=this._instance.GetTimeScale();if(-1!==n&&(e=s*n),0===e&&0===this._lastDelta)return;this._lastDelta=e;const i=this._playheadTime+this._overshoot+e*this._playbackRate,r=this._timelineDataItem._totalTime;i<0?(this._playheadTime=0,this._overshoot=-i):i>=r?(this._playheadTime=r,this._overshoot=this._playheadTime-i):(this._playheadTime=i,this._overshoot=0);let a=!1,o=!1;const l=this.GetLoop(),c=this.GetPingPong();if(l||c?l&&!c?this._playbackRate>0?this._playheadTime>=r&&(this._SetTimeAndReset(0),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensLoop),o=!0):this._playheadTime<=0&&(this._SetTimeAndReset(r),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensLoop),o=!0):!l&&c?this._playbackRate>0?this._playheadTime>=r&&(this._SetTime(r),this.SetPlaybackRate(-1*this.GetPlaybackRate()),o=!0,1===this._pingPongState?this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong),this.IsPlaying()?this._pingPongState=0:this._resumePingPongState=0):(this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong),a=!0):0===this._pingPongState&&(this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong),this.IsPlaying()?this._pingPongState=1:this._resumePingPongState=1)):this._playheadTime<=0&&(this._SetTime(0),this.SetPlaybackRate(-1*this.GetPlaybackRate()),o=!0,1===this._pingPongState?this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong),this.IsPlaying()?this._pingPongState=0:this._resumePingPongState=0):(a=!0,this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong)):0===this._pingPongState&&(this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong),this.IsPlaying()?this._pingPongState=1:this._resumePingPongState=1)):l&&c&&(this._playbackRate>0?this._playheadTime>=r&&(this._SetTime(r),this.SetPlaybackRate(-1*this.GetPlaybackRate()),o=!0,0===this._pingPongState&&(this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong)),1===this._pingPongState&&(this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong)),this.IsPlaying()?(this._pingPongState++,this._pingPongState=QI.wrap(this._pingPongState,0,2)):(this._resumePingPongState=this._pingPongState+1,this._resumePingPongState=QI.wrap(this._resumePingPongState,0,2))):this._playheadTime<=0&&(this._SetTime(0),this.SetPlaybackRate(-1*this.GetPlaybackRate()),o=!0,0===this._pingPongState&&(this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong)),1===this._pingPongState&&(this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenPingPong),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensPingPong)),this.IsPlaying()?(this._pingPongState++,this._pingPongState=QI.wrap(this._pingPongState,0,2)):(this._resumePingPongState=this._pingPongState+1,this._resumePingPongState=QI.wrap(this._resumePingPongState,0,2)))):this._playbackRate>0?this._playheadTime>=r&&(this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._SetTimeAndReset(0),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensLoop),o=!0):(this._SetTime(r),a=!0)):this._playheadTime<=0&&(this._currentRepeatCount<this.GetRepeatCount()?(this._currentRepeatCount++,this._SetTimeAndReset(r),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnAnyTweenLoop),this._TweenTrigger(QI.Behaviors.Tween.Cnds.OnTweensLoop),o=!0):(this._SetTime(0),a=!0)),this.IsPlaying()){if(a)return this._track.SetEndState(),this.Stop(!0),void this.OnCompleted();this._track.Interpolate(this._playheadTime,!0,!1,o,this._firstTick,!1),this._firstTick&&(this._firstTick=!1)}}_TweenTrigger(e){const t=this.GetInstance();this._behInst.PushTriggerTween(this),this._runtime.Trigger(e,t,this._behInst.GetBehaviorType()),this._behInst.PopTriggerTween()}_SaveToJson(){const e=super._SaveToJson(),t=this.GetTimelineDataItem();return Object.assign(e,{tweenDataItemJson:t._SaveToJson(),id:this._id,destroyInstanceOnComplete:this._destroyInstanceOnComplete,initialValueMode:this._initialValueMode})}_LoadFromJson(e){e&&(this.GetTimelineDataItem()._LoadFromJson(e.tweenDataItemJson),super._LoadFromJson(e),this._id=e.id,this._destroyInstanceOnComplete=e.destroyInstanceOnComplete,this._initialValueMode=e.initialValueMode,this._CacheTrack())}static IsPlaying(e){return e.IsPlaying()}static IsPaused(e){return e.IsPaused()}static IsPing(e){return!!e.GetPingPong()&&0===e.GetPingPongState()}static IsPong(e){return!!e.GetPingPong()&&1===e.GetPingPongState()}static Build(e){const t=e.runtime.GetTimelineManager(),s=new QI.TimelineDataItem;if(e.json){s._LoadFromJson(e.json.tweenDataItemJson);const n=new QI.TweenState(s,t);return n._LoadFromJson(e.json),n}{const n=new QI.TweenState(s,t);QI.IsArray(e.propertyTracksConfig)||(e.propertyTracksConfig=[e.propertyTracksConfig]),n.SetId(e.id),n.SetTags(e.tags),n.SetInitialValueMode(e.initialValueMode),n.SetDestroyInstanceOnComplete(e.releaseOnComplete),n.SetLoop(e.loop),n.SetPingPong(e.pingPong),n.SetTotalTime(e.time),n.SetStep(0),n.SetInterpolationMode("default"),n.SetResultMode(e.propertyTracksConfig[0].resultMode),n.SetRepeatCount(e.repeatCount);const i=n.AddTrack();i.SetInstanceUID(e.instance.GetUID()),i.SetInterpolationMode("default"),i.SetResultMode(e.propertyTracksConfig[0].resultMode),i.SetEnable(!0),i.SetObjectClassIndex(e.instance.GetObjectClass().GetIndex());const r=e.instance.GetSdkInstance(),a=r.IsOriginalSizeKnown()?r.GetOriginalWidth():e.instance.GetWorldInfo().GetWidth(),o=r.IsOriginalSizeKnown()?r.GetOriginalHeight():e.instance.GetWorldInfo().GetHeight();i.SetOriginalWidth(a),i.SetOriginalHeight(o);const l=i.AddKeyframe();l.SetTime(0),l.SetEase("noease"),l.SetEnable(!0),l.SetTags("");const c=i.AddKeyframe();c.SetTime(e.time),c.SetEase("noease"),c.SetEnable(!0),c.SetTags("");for(const t of e.propertyTracksConfig){const s=i.AddPropertyTrack();s.SetSourceAdapterId(t.sourceId),s.SetSourceAdapterArgs(t.sourceArgs),s.SetPropertyName(t.property),s.SetPropertyType(t.type),s.SetMin(NaN),s.SetMax(NaN),s.SetInterpolationMode("default"),s.SetResultMode(t.resultMode),s.SetEnable(!0);const n=s.AddPropertyKeyframe();n.SetType(t.valueType),n.SetTime(0),n.SetEase(t.ease),n.SetEnable(!0),n.SetValue(t.startValue),n.SetAbsoluteValue(t.startValue);const r=s.AddPropertyKeyframe();r.SetType(t.valueType),r.SetTime(e.time),r.SetEase(t.ease),r.SetEnable(!0),r.SetValue(t.endValue),r.SetAbsoluteValue(t.endValue),s.GetSourceAdapter()}return n}}static SetInstanceUID(e,t){if(!isNaN(t))for(const s of e.GetTracks())s.SetInstanceUID(t)}static SetBehaviorInstance(e,t){e.SetBehaviorInstance(t)}GetITweenState(e,t){return this._iTweenState||(this._iTweenState=QI.New(self.ITweenState,this,e,t)),this._iTweenState}}}{const rS=self.C3;rS.TweenTrackState=class extends rS.TrackState{constructor(e,t){super(e,t),this._firstPropertyTrack=null,this._secondPropertyTrack=null}static Create(e,t){return rS.New(rS.TweenTrackState,e,t)}_CachePropertyTracks(){1===this._propertyTracks.length?this._firstPropertyTrack=this._propertyTracks[0]:(this._firstPropertyTrack=this._propertyTracks[0],this._secondPropertyTrack=this._propertyTracks[1])}CreatePropertyTrackStates(){for(const e of this._trackDataItem.GetPropertyTrackData().propertyTrackDataItems())this._propertyTracks.push(rS.TweenPropertyTrackState.Create(this,e));this._CachePropertyTracks()}AddPropertyTrack(){const e=this._trackDataItem.GetPropertyTrackData().AddEmptyPropertyTrackDataItem(),t=rS.TweenPropertyTrackState.Create(this,e);return this._propertyTracks.push(t),this._CachePropertyTracks(),t}SetInitialState(){if(this.MaybeGetInstance(),!this.IsInstanceValid()&&this.IsInstanceTrack())return;const e=this.GetTimeline().IsForwardPlayBack()?0:this.GetLocalTotalTime();for(const t of this._propertyTracks)t.SetInitialState(e),0===this._worldInfoChange&&1===t.GetWorldInfoChange()&&(this._worldInfoChange=1),0===this._renderChange&&1===t.GetRenderChange()&&(this._renderChange=1);this._needsBeforeAndAfter=0,this._propertyTracks.some((e=>e.GetNeedsBeforeAndAfter()))&&(this._needsBeforeAndAfter=1),this._lastKeyframeDataItem=this._GetLastKeyFrameBeforeTime(e),this._initialStateOfNestedSet=!1,this._endStateOfNestedSet=!1,this.Interpolate(e)}BeforeInterpolate(){}Interpolate(e,t=!1,s=!1,n=!1,i=!1,r=!1,a=!1){if(this._instance||this.GetInstance(),this._instance)return!this._instance.IsDestroyed()&&(!r||!this.GetObjectClass().IsGlobal())&&(this._secondPropertyTrack?(this._firstPropertyTrack.Interpolate(e,s,n,a),this._secondPropertyTrack.Interpolate(e,s,n,a)):this._firstPropertyTrack.Interpolate(e,s,n,a),void(0!==this._firstPropertyTrack.GetWorldInfoChange()&&(this._worldInfo||(this._worldInfo=this._instance.GetWorldInfo()),this._worldInfo&&this._worldInfo.SetBboxChanged())))}AfterInterpolate(){}_LoadFromJson(e){super._LoadFromJson(e),this._CachePropertyTracks()}}}{const aS=self.C3;aS.TweenPropertyTrackState=class extends aS.PropertyTrackState{constructor(e,t){super(e,t),this._basic=!1}static Create(e,t){return aS.New(aS.TweenPropertyTrackState,e,t)}Interpolate(e,t=!1,s=!1,n=!1){let i,r;if(this._basic)i=this._propertyKeyframeDataItems[0],r=this._propertyKeyframeDataItems[1];else if(t)i=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem),r=i.GetNext();else{if(this._lastPropertyKeyframeDataItem){const t=this.GetTimeline(),s=this._lastPropertyKeyframeDataItem.GetNext(),n=this._lastPropertyKeyframeDataItem.GetTime(),i=s?s.GetTime():t.GetTotalTime();(e<=n||e>=i)&&(this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem))}else this._lastPropertyKeyframeDataItem=this._propertyTrackData.GetFirstPropertyKeyFrameDataItemLowerOrEqualThan(e,this._propertyTrackDataItem);i=this._lastPropertyKeyframeDataItem,r=i.GetNext()}this._sourceAdapter.Interpolate(e,i,r,t,s,n)}AddPropertyKeyframe(){const e=this._propertyTrackDataItem.GetPropertyKeyframeData().AddEmptyPropertyKeyframeDataItem();return this._lastPropertyKeyframeDataItem=null,this._basic=this.GetPropertyKeyframeDataItems().length<=2,e}DeletePropertyKeyframes(e){this._lastPropertyKeyframeDataItem=null,this._propertyTrackDataItem.GetPropertyKeyframeData().DeletePropertyKeyframeDataItems(e),this._basic=this.GetPropertyKeyframeDataItems().length<=2}_SaveToJson(){return{sourceAdapterJson:this.GetSourceAdapter()._SaveToJson(),basic:this._basic}}_LoadFromJson(e){e&&(this.GetSourceAdapter()._LoadFromJson(e.sourceAdapterJson),this._basic=e.basic)}}}{const oS=self.C3,lS=self.Ease,cS=0,hS=1,_S=2;oS.Transition=class extends oS.DefendedBase{constructor(e,t=!0){super(),this._name=e[0],this._linear=e[2],this._transitionKeyframes=[];for(const t of e[1]){const e=oS.TransitionKeyframe.Create(this,t);this._transitionKeyframes.push(e)}for(let e=0;e<this._transitionKeyframes.length;e++){const t=this._transitionKeyframes[e],s=this._transitionKeyframes[e+1],n=this._transitionKeyframes[e-1];t.SetNext(s),t.SetPrevious(n)}this._precalculatedSamples=new Map,this._transitionKeyframeCache=new Map,this._PreCalcSamples(),t&&lS.AddCustomEase(this._name,((e,t,s,n)=>this.Interpolate(e,t,s,n)),null,{transition:this})}static Create(e){return oS.New(oS.Transition,e)}Release(){for(const e of this._transitionKeyframes)e.Release();oS.clearArray(this._transitionKeyframes),this._transitionKeyframes=null,this._precalculatedSamples.clear(),this._precalculatedSamples=null,this._transitionKeyframeCache.clear(),this._transitionKeyframeCache=null}MakeLinear(e){this._linear=!!e}GetTransitionKeyFrameAt(e){const t=this._transitionKeyframeCache.get(e);if(t)return t;for(const t of this._transitionKeyframes)if(t.GetValueX()===e)return this._transitionKeyframeCache.set(e,t),t}GetFirstTransitionKeyFrameLowerOrEqualThan(e){for(let t=this._transitionKeyframes.length-1;t>=0;t--){const s=this._transitionKeyframes[t],n=s.GetValueX();if(n<=e){let t=s;if(n<e)return t;if(n===e){for(;t;){const e=t.GetPrevious();if(!e)break;if(e.GetValueX()!==t.GetValueX())break;t=e}return t}}}}Interpolate(e,t,s,n){let i=e/n;if(this._linear){const i=this.GetTransitionKeyFrameAt(0),r=this.GetTransitionKeyFrameAt(1),a=t+(t+s)*i.GetValueY(),o=(t+s)*r.GetValueY()-a;return 0===n?a+o:lS.NoEase(e,a,o,n)}0===n&&(i=1);let r=this.GetFirstTransitionKeyFrameLowerOrEqualThan(i),a=r.GetNext();if(!a){const e=r.GetPrevious(),t=r;r=e,a=t}const o=a.GetValueX()-r.GetValueX(),l=oS.mapToRange(i,r.GetValueX(),a.GetValueX(),0,o);if(r.IsSegmentLinear()||0===o){const e=t+(t+s)*r.GetValueY(),n=(t+s)*a.GetValueY()-e;return 0===o?1===l?e+n:e:lS.NoEase(l,e,n,o)}const c=r.GetValueX(),h=r.GetValueY(),_=r.GetValueX()+r.GetStartAnchorX(),u=r.GetValueY()+r.GetStartAnchorY(),d=a.GetValueX()+a.GetEndAnchorX(),p=a.GetValueY()+a.GetEndAnchorY(),f=a.GetValueX(),m=a.GetValueY();let g=lS.GetRuntimeEase("spline")(l,c,h,_,u,d,p,f,m,this._precalculatedSamples.get(r));return g+=r.GetValueY(),(1-g)*t+g*(t+s)}_PreCalcSamples(){this._precalculatedSamples.clear();for(let e=0;e<this._transitionKeyframes.length-1;e++){const t=this._transitionKeyframes[e];if(!t.GetStartEnable())continue;const s=t,n=this._transitionKeyframes[e+1];if(!n.GetEndEnable())continue;const i=s.GetValueX(),r=s.GetValueX()+s.GetStartAnchorX(),a=n.GetValueX()+n.GetEndAnchorX(),o=n.GetValueX();this._precalculatedSamples.set(s,lS.GetBezierSamples(i,r,a,o))}}}}{const uS=self.C3,dS=0,pS=1,fS=2,mS=3,gS=4,IS=5,SS=6,yS=7,bS=8;uS.TransitionKeyframe=class extends uS.DefendedBase{constructor(e,t){super(),this._transition=e,this._valueX=t[0],this._valueY=t[1],this._startAnchorX=t[2],this._startAnchorY=t[3],this._endAnchorX=t[4],this._endAnchorY=t[5],this._startEnable=t[6],this._endEnable=t[7],this._segmentMode=t[8],this._next=null,this._prev=null}Release(){this._transition=null}static Create(e,t){return uS.New(uS.TransitionKeyframe,e,t)}SetNext(e){this._next=e}GetNext(){return this._next}SetPrevious(e){this._prev=e}GetPrevious(){return this._prev}GetValueX(){return this._valueX}GetValueY(){return this._valueY}GetStartAnchorX(){return this._startAnchorX}GetStartAnchorY(){return this._startAnchorY}GetEndAnchorX(){return this._endAnchorX}GetEndAnchorY(){return this._endAnchorY}GetStartEnable(){return this._startEnable}GetEndEnable(){return this._endEnable}IsSegmentLinear(){return"linear"===this._segmentMode}IsSegmentCubic(){return"cubic"===this._segmentMode}}}{const GS=self.C3;GS.TransitionManager=class extends GS.DefendedBase{constructor(e){super(),this._runtime=e,this._transitions=[]}Release(){for(const e of this._transitions)e.Release();GS.clearArray(this._transitions),this._transitions=null}Create(e){this._transitions.push(GS.Transition.Create(e))}}}{const vS=self.C3;vS.TemplateManager=class extends vS.DefendedBase{constructor(e){super(),this._runtime=e,this._templateDataMap=null,this._instanceToTemplateNameMap=null,this._instanceDestroy=e=>this._OnInstanceDestroy(e.instance)}Release(){if(this.RemoveRuntimeListeners(),this._templateDataMap){for(const e of this._templateDataMap.values())e.clear();this._templateDataMap.clear()}this._templateDataMap=null,this._runtime=null}Create(e){if(this._templateDataMap||(this._templateDataMap=new Map),!e)return;const t=e[0][16][0],s=e[1];this._templateDataMap.has(s)||this._templateDataMap.set(s,new Map),this._templateDataMap.get(s).set(t,e)}AddRuntimeListeners(){const e=this._runtime.Dispatcher();e&&e.addEventListener("instancedestroy",this._instanceDestroy)}RemoveRuntimeListeners(){const e=this._runtime.Dispatcher();e&&e.removeEventListener("instancedestroy",this._instanceDestroy)}HasTemplates(){return!!this._templateDataMap&&0!==this._templateDataMap.size}GetTemplateData(e,t){let s=0;if(s=e instanceof vS.ObjectClass?e.GetIndex():e,!this._templateDataMap.has(s))return;const n=this._templateDataMap.get(s).get(t);return n?JSON.parse(JSON.stringify(n)):void 0}MapInstanceToTemplateName(e,t){this._instanceToTemplateNameMap||(this._instanceToTemplateNameMap=new WeakMap),this._instanceToTemplateNameMap.has(e)||this._instanceToTemplateNameMap.set(e,t)}GetInstanceTemplateName(e){if(!this._instanceToTemplateNameMap)return"";return this._instanceToTemplateNameMap.get(e)||""}_OnInstanceDestroy(e){this._instanceToTemplateNameMap&&this._instanceToTemplateNameMap.has(e)&&this._instanceToTemplateNameMap.delete(e)}}}{const xS=self.C3;xS.FlowchartManager=class{constructor(e){this._runtime=e,this._flowchartDataManager=new xS.FlowchartDataManager}Release(){this._flowchartDataManager.Release(),this._flowchartDataManager=null,this._runtime=null}GetRuntime(){return this._runtime}Create(e){this._flowchartDataManager.Add(e)}GetFlowchartDataItemByName(e){return this._flowchartDataManager.Get(e)}HasFlowcharts(){return this._flowchartDataManager.HasFlowcharts()}}}{const TS=self.C3;TS.FlowchartState=class{constructor(e,t,s,n,i,r,a){this._runtime=i.GetRuntime(),this._flowchartManager=i,this._flowchartName=e,this._startNodeTag=s,this._flowchartDataItem=n,this._tag=t,this._pluginInstance=r,this._pluginUID=a??r.GetInstance().GetUID(),this._SetStartFlowchartNode(),this._currentFlowchartNodeId=this._startFlowchartNode?.GetFlowchartId()??-1,this._previousFlowchartNodeIds=[],this._previousFlowchartState=null,this._previousFlowchartStateStartNodeId=NaN,this._referenceFlowchartStates=null,this._currentReferenceFlowchartState=null,this._rootFlowchartState=null,this._previousFlowchartStateTag="",this._referenceFlowchartStatesJson=null,this._currentReferenceFlowchartStateTag="",this._rootFlowchartStateTag="",this._triggerCount=0,this._markForRelease=!1,this._released=!1}Release(){this._released||(TS.clearArray(this._previousFlowchartNodeIds),this._previousFlowchartNodeIds=null,this._runtime=null,this._flowchartManager=null,this._flowchartDataItem=null,this._pluginInstance=null,this._previousFlowchartState=null,this._previousFlowchartStateStartNodeId=NaN,this._referenceFlowchartStates&&this._referenceFlowchartStates.clear(),this._referenceFlowchartStates=null,this._currentReferenceFlowchartState=null,this._rootFlowchartState=null,this._previousFlowchartStateTag="",this._referenceFlowchartStatesJson=null,this._currentReferenceFlowchartStateTag="",this._rootFlowchartStateTag="",this._released=!0)}WasReleased(){return this._released}GetFlowchartManager(){return this._flowchartManager}GetRuntime(){return this._runtime}GetName(){return this._flowchartName}GetFlowchartDataItem(){return this._flowchartDataItem}GetTag(){return this._tag}GetPluginInstance(){return this._pluginInstance||(this._pluginInstance=this._runtime.GetInstanceByUID(this._pluginUID).GetSdkInstance()),this._pluginInstance}GetCurrentNode(){return this.GetFlowchartElementById(this._currentFlowchartNodeId)}GetCurrentNodeTag(){const e=this.GetCurrentNode();return e?e.GetTag():""}GetCurrentNodeTags(){const e=this.GetCurrentNode();return e?e.GetTags():[]}CurrentNodeHasTags(e){const t=this.GetCurrentNodeTags();if(!t)return!1;if(!t.length)return!1;const s=TS.FlowchartState._GetTagArray(e);return!(!s||!s.length)&&s.every(TS.FlowchartState._HasTag,t)}CurrentNodeCompareTags(e,t){const s=this.GetCurrentNodeTags();if(!s)return!1;if(!s.length)return!1;const n=TS.FlowchartState._GetTagArray(e);return!(!n||!n.length)&&n.every((e=>TS.FlowchartState._CompareTag.call(s,e,t)))}static _HasTag(e){const t=this;return""===e?1===t.length&&""===t[0]:t.map((e=>e.trim().toLowerCase())).includes(e.trim().toLowerCase())}static _GetTagArray(e){return e.trim().split(" ")}static _CompareTag(e,t){const s=this;return""===e?1===s.length&&""===s[0]:s.some((s=>TS.compare(s.trim(),t,e.trim())))}GetCurrentNodeParent(e){const t=this.GetCurrentNode();if(t){if(TS.IsFiniteNumber(e)){const s=t.GetParentFlowchartIds(),n=s?s[e]:void 0;if(TS.IsFiniteNumber(n))return this.GetFlowchartElementById(n)}if("string"==typeof e)for(const s of t.GetParentFlowchartIds()){const t=this.GetFlowchartElementById(s);if(t.HasTags(e))return this.GetFlowchartElementById(t.GetFlowchartId())}}}GetCurrentNodeParentTag(e){const t=this.GetCurrentNodeParent(e);return t?t.GetTag():""}GetCurrentNodeParentTags(e){const t=this.GetCurrentNodeParent(e);return t?t.GetTags():""}GetCurrentNodeParentIndex(e){const t=this.GetCurrentNode();if(!t)return-1;const s=t.GetParentFlowchartIds();if(!s)return-1;const n=this.GetCurrentNodeParent(e);return n?s.indexOf(n.GetFlowchartId()):-1}GetCurrentNodeParentCount(){const e=this.GetCurrentNode();if(!e)return 0;const t=e.GetParentFlowchartIds();return t?t.length:0}GetFlowchartElementById(e){return this._flowchartDataItem.GetFlowchartElementById(e)}Reset(){this._GetRootFlowchartState()._Reset(!0)}_Reset(e){if(this._GetReferenceFlowchartStates()){for(const[e,t]of this._GetReferenceFlowchartStates().entries())t._Reset(!1);this._GetReferenceFlowchartStates().clear()}if(this._referenceFlowchartStates=null,this._previousFlowchartState=null,this._previousFlowchartStateStartNode=null,this._currentReferenceFlowchartState=null,this._previousFlowchartStateTag="",this._referenceFlowchartStatesJson=null,this._currentReferenceFlowchartStateTag="",this._rootFlowchartStateTag="",this._previousFlowchartNodeIds=[],e){this._flowchartManager.SetCurrentFlowchartState(this);const e=this._startFlowchartNode.GetFlowchartId();e!==this._currentFlowchartNodeId&&this._GotoFlowchartNode(e)}else this._currentFlowchartNodeId=this._startFlowchartNode.GetFlowchartId()}GetCurrentNodeOutputCount(){const e=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId);return e?e.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItemCount():0}IsIndexOfDefaultOutput(e){return!(e<0)&&e===this.GetDefaultOutputIndex()}GetDefaultOutputIndex(){const e=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId);if(!e)return-1;let t=e.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDefault();return t?e.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItems().indexOf(t):-1}GetCurrentNodeOutputNameAt(e){const t=this._GetFlowchartNodeOutputAt(e);return t?t.GetName():""}GetCurrentNodeOutputValueAt(e){let t;return TS.IsFiniteNumber(e)&&(t=this._GetFlowchartNodeOutputAt(e)),"string"==typeof e&&(t=this._GetFlowchartNodeOutputByName(e)),"number"!=typeof e&&"string"!=typeof e&&console.warn("[Flowcharts] unexpected argument type in GetCurrentNodeOutputValueAt expression"),t?t.GetValue():""}_MaybeByPassNodes(e,t){if(e.GetEnable())return e.GetFlowchartId();{const s=e.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDefault();if(!s)return t.GetFlowchartId();const n=s.GetConnectedFlowchartNodeFlowchartId();if(!TS.IsFiniteNumber(n))return t.GetFlowchartId();const i=this.GetFlowchartElementById(n);return i?this._MaybeByPassNodes(i,t):t.GetFlowchartId()}}_MaybeByPassNodesInReferenceFlowchart(e,t){if(e.GetEnable()){if("reference"===e.GetType()){const t=e.GetReferenceFlowchartName(),s=e.GetReferenceFlowchartStartNodeTag(),n=this._flowchartManager.GetFlowchartDataItemByName(t);if(!n)return[-1,null];const i=n.GetFlowchartNodeByTags(s);return i?this._MaybeByPassNodesInReferenceFlowchart(i,n):this._MaybeByPassNodesInReferenceFlowchart(n.GetFlowchartStartNode(),n)}return[e.GetFlowchartId(),t]}{const s=e.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDefault();if(!s)return[-1,null];const n=s.GetConnectedFlowchartNodeFlowchartId();if(!TS.IsFiniteNumber(n))return[-1,null];const i=t.GetFlowchartElementById(n);return i?this._MaybeByPassNodesInReferenceFlowchart(i,t):[-1,null]}}_ProcessAllByPasses(e,t){let s=this.GetFlowchartElementById(e);if(s){if(!s.GetEnable()){const t=this.GetFlowchartElementById(this._currentFlowchartNodeId);e=this._MaybeByPassNodes(s,t)}if(TS.IsFiniteNumber(e)&&e!==this._currentFlowchartNodeId)if(s=this.GetFlowchartElementById(e),"reference"===s.GetType()){const n=s.GetReferenceFlowchartName(),i=s.GetReferenceFlowchartStartNodeTag(),r=this._flowchartManager.GetFlowchartDataItemByName(n);let a=r.GetFlowchartNodeByTags(i);if(a){const s=this._MaybeByPassNodesInReferenceFlowchart(a,r);if(-1===s[0])return;t(this._currentFlowchartNodeId,e,s[1],s[0])}else t(this._currentFlowchartNodeId,e)}else t(this._currentFlowchartNodeId,e)}}GotoNextFlowchartNode(e){let t;if(TS.IsFiniteNumber(e)&&(t=this._GetFlowchartNodeOutputAt(e)),"string"==typeof e&&(t=this._GetFlowchartNodeOutputByName(e)),!t)return;let s=t.GetConnectedFlowchartNodeFlowchartId();TS.IsFiniteNumber(s)&&this._ProcessAllByPasses(s,((e,t,s,n)=>{this._previousFlowchartNodeIds.push(e),this._GotoFlowchartNode(t,s,n)}))}GotoNextFlowchartNodeDefault(){const e=this._GetFlowchartNodeOutputDefault();if(!e)return;const t=e.GetConnectedFlowchartNodeFlowchartId();TS.IsFiniteNumber(t)&&this._ProcessAllByPasses(t,((e,t,s,n)=>{this._previousFlowchartNodeIds.push(e),this._GotoFlowchartNode(t,s,n)}))}GotoAnyFlowchartNode(e){const t=this._flowchartDataItem.GetFlowchartNodeByTags(e);if(!t)return;const s=t.GetFlowchartId();TS.IsFiniteNumber(s)&&this._ProcessAllByPasses(s,((e,t,s,n)=>{this._previousFlowchartNodeIds.push(e),this._GotoFlowchartNode(t,s,n)}))}GotoPreviousFlowchartNode(){const e=this._previousFlowchartNodeIds.pop();TS.IsFiniteNumber(e)?this._GotoFlowchartNode(e):this._GetPreviousFlowchartState()&&(this._flowchartManager.SetCurrentFlowchartState(this._GetPreviousFlowchartState(),!0,!1,!1),this._GetPreviousFlowchartState()._GotoFlowchartNode(this._GetPreviousFlowchartStateStartNodeId()),this._GetRootFlowchartState()._SetCurrentReferenceFlowchart(this._GetPreviousFlowchartState()))}GotoParentFlowchartNode(e){if(!this.GetCurrentNode())return;const t=this.GetCurrentNodeParent(e);if(t){if(!t.GetEnable())return;const e=t.GetFlowchartId();if(!TS.IsFiniteNumber(e))return;this._previousFlowchartNodeIds.push(this._currentFlowchartNodeId),this._GotoFlowchartNode(t.GetFlowchartId())}}HasOutput(e){if(TS.IsFiniteNumber(e))return!!this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId).GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItems()[e];if("string"==typeof e){const t=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId).GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItems();for(let s=0;s<t.length;s++)if(t[s].GetName()===e)return!0;return!1}return!1}MarkForRelease(){this._markForRelease=!0}IsInTriggerState(){return this._triggerCount>0}PushIsTriggerState(){this._triggerCount++}PopIsTriggerState(){this._triggerCount--,0===this._triggerCount&&this._markForRelease&&this._flowchartManager.RemoveFlowchartState(this)}_GotoFlowchartNode(e,t,s){const n=this._currentFlowchartNodeId,i=this.GetPluginInstance().GetInstance();this.PushIsTriggerState(),this._flowchartManager.PushFlowchartState(this),this._runtime.Trigger(TS.Plugins.Flowchart.Cnds.OnBeforeAnyNodeChange,i),this._runtime.Trigger(TS.Plugins.Flowchart.Cnds.OnBeforeTaggedNodeChange,i),this._runtime.Trigger(TS.Plugins.Flowchart.Cnds.OnBeforeAnyNodeChangeInFlowchart,i),this._runtime.Trigger(TS.Plugins.Flowchart.Cnds.OnBeforeTaggedNodeChangeInFlowchart,i),this._currentFlowchartNodeId=e;let r=this.GetFlowchartElementById(this._currentFlowchartNodeId);if("dictionary"===r.GetType()&&(this._runtime.Trigger(TS.Plugins.Flowchart.Cnds.OnAnyNodeChange,i),this._runtime.Trigger(TS.Plugins.Flowchart.Cnds.OnTaggedNodeChange,i),this._runtime.Trigger(TS.Plugins.Flowchart.Cnds.OnAnyNodeChangeInFlowchart,i),this._runtime.Trigger(TS.Plugins.Flowchart.Cnds.OnTaggedNodeChangeInFlowchart,i)),this._flowchartManager.PopFlowchartState(),this.PopIsTriggerState(),!this.WasReleased()&&(r=this.GetFlowchartElementById(this._currentFlowchartNodeId),"reference"===r.GetType())){const e=t?t.GetName():r.GetReferenceFlowchartName();if(this._HasReferenceFlowchartState(r)){this._previousFlowchartNodeIds.pop();const e=this._GetReferenceFlowchartState(r);this._flowchartManager.SetCurrentFlowchartState(e,!0,!0,!1),e._SetPreviousFlowchart(this,n),this._GetRootFlowchartState()._SetCurrentReferenceFlowchart(e)}else{const t="number"==typeof s?s:r.GetReferenceFlowchartStartNodeTag();if(e){this._previousFlowchartNodeIds.pop();let s=r.GetReferenceFlowchartTag();if(s){let e=this._flowchartManager.GetFlowchartState(s);for(;e;)s=TS.IncrementNumberAtEndOf(s),e=this._flowchartManager.GetFlowchartState(s)}else{s=`${e}-ref`;let t=this._flowchartManager.GetFlowchartState(s);for(;t;)s=TS.IncrementNumberAtEndOf(s),t=this._flowchartManager.GetFlowchartState(s)}const i=this._flowchartManager.AddFlowchartState(e,t,s,this._pluginInstance,!0);i._SetPreviousFlowchart(this,n),this._SetReferenceFlowchartState(r,i);const a=this._GetRootFlowchartState();i._SetRootFlowchartState(a),a._SetCurrentReferenceFlowchart(i)}}}}_GetFlowchartNodeOutputDefault(){const e=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId);return e?e.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDefault():null}_GetFlowchartNodeOutputAt(e){const t=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId);if(!t)return null;const s=t.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItems();if(!s)return null;return s[e]||null}_GetFlowchartNodeOutputByName(e){const t=this._flowchartDataItem.GetFlowchartElementById(this._currentFlowchartNodeId);if(!t)return null;return t.GetFlowchartNodeOutputData().GetFlowchartNodeOutputDataItemByName(e)||null}_SetStartFlowchartNode(e){if("number"==typeof e){let t=this.GetFlowchartElementById(e);t||(t=this._flowchartDataItem.GetFlowchartStartNode()),this._startFlowchartNode=t}else if("number"==typeof this._startNodeTag){let e=this.GetFlowchartElementById(this._startNodeTag);e||(e=this._flowchartDataItem.GetFlowchartStartNode()),this._startFlowchartNode=e}else{let e=this._flowchartDataItem.GetFlowchartNodeByTags(this._startNodeTag);e||(e=this._flowchartDataItem.GetFlowchartStartNode()),this._startFlowchartNode=e}}_SaveToJson(){return this._markForRelease?null:{flowchartName:this._flowchartName,flowchartTag:this._tag,startNodeTag:this._startNodeTag,currentNodeId:this._currentFlowchartNodeId,previousNodeIds:this._previousFlowchartNodeIds,pluginUID:this._pluginInstance.GetInstance().GetUID(),reference:{previousFlowchartTag:this._GetPreviousFlowchartState()?this._GetPreviousFlowchartState().GetTag():"",previousStartNodeId:TS.IsFiniteNumber(this._GetPreviousFlowchartStateStartNodeId())?this._GetPreviousFlowchartStateStartNodeId():NaN,referencesJson:this._GetFlowchartReferencesJson(),currentReferenceFlowchartTag:this.GetCurrentReferenceFlowchart()?this.GetCurrentReferenceFlowchart().GetTag():"",rootFlowchartTag:this._GetRootFlowchartState()?this._GetRootFlowchartState().GetTag():""}}}_GetFlowchartReferencesJson(){if(!this._HasReferenceFlowchartStates())return null;const e=[];for(const[t,s]of this._GetReferenceFlowchartStates().entries())e.push({flowchartElementId:t.GetFlowchartId(),flowchartStateTag:s.GetTag()});return e.length?e:null}_LoadFromJson(e){if(e){if(this._flowchartName=e.flowchartName,this._tag=e.flowchartTag,this._startNodeTag=e.startNodeTag,this._currentFlowchartNodeId=e.currentNodeId,this._previousFlowchartNodeIds=e.previousNodeIds,this._pluginUID=e.pluginUID,e.hasOwnProperty("reference")){const t=e.reference;this._previousFlowchartStateTag=t.previousFlowchartTag,this._previousFlowchartStateStartNodeId=t.previousStartNodeId,this._referenceFlowchartStatesJson=t.referencesJson,this._currentReferenceFlowchartStateTag=t.currentReferenceFlowchartTag,this._rootFlowchartStateTag=t.rootFlowchartTag}this._SetStartFlowchartNode()}}_GetPreviousFlowchartState(){return"string"==typeof this._previousFlowchartStateTag&&this._previousFlowchartStateTag&&(this._previousFlowchartState=this._flowchartManager.GetFlowchartState(this._previousFlowchartStateTag),this._previousFlowchartStateTag=""),this._previousFlowchartState}_GetPreviousFlowchartStateStartNodeId(){return this._previousFlowchartStateStartNodeId}_SetPreviousFlowchart(e,t){this._previousFlowchartState=e,this._previousFlowchartStateStartNodeId=t}GetCurrentReferenceFlowchart(){return"string"==typeof this._currentReferenceFlowchartStateTag&&this._currentReferenceFlowchartStateTag&&(this._currentReferenceFlowchartState=this._flowchartManager.GetFlowchartState(this._currentReferenceFlowchartStateTag),this._currentReferenceFlowchartStateTag=""),this._currentReferenceFlowchartState}_SetCurrentReferenceFlowchart(e){this._currentReferenceFlowchartState=e,this._currentReferenceFlowchartState===this&&(this._currentReferenceFlowchartState=null)}_GetRootFlowchartState(){return"string"==typeof this._rootFlowchartStateTag&&this._rootFlowchartStateTag&&(this._rootFlowchartState=this._flowchartManager.GetFlowchartState(this._rootFlowchartStateTag),this._rootFlowchartStateTag=""),this._rootFlowchartState?this._rootFlowchartState:this}_SetRootFlowchartState(e){this._rootFlowchartState=e}_HasReferenceFlowchartStates(){return this._RebuildReferenceFlowchartStates(),!!this._referenceFlowchartStates}_HasReferenceFlowchartState(e){return this._RebuildReferenceFlowchartStates(),this._referenceFlowchartStates&&this._referenceFlowchartStates.has(e)}_RebuildReferenceFlowchartStates(){if(this._referenceFlowchartStatesJson){this._referenceFlowchartStates&&this._referenceFlowchartStates.clear(),this._referenceFlowchartStates||(this._referenceFlowchartStates=new Map);for(const e of this._referenceFlowchartStatesJson){const t=this._flowchartManager.GetFlowchartState(e.flowchartStateTag),s=t.GetFlowchartElementById(e.flowchartElementId);this._referenceFlowchartStates.set(s,t)}this._referenceFlowchartStatesJson=null}}_GetReferenceFlowchartStates(){return this._RebuildReferenceFlowchartStates(),this._referenceFlowchartStates}_GetReferenceFlowchartState(e){return this._RebuildReferenceFlowchartStates(),this._referenceFlowchartStates.get(e)}_SetReferenceFlowchartState(e,t){this._referenceFlowchartStates||(this._referenceFlowchartStates=new Map),this._referenceFlowchartStates.set(e,t)}}}{const CS=self.C3;CS.FlowchartStateManager=class{constructor(e){this._runtime=e,this._flowchartStates=new Map,this._currentFlowchartState=null,this._flowchartStateStack=[],this._on_after_load=()=>this._OnAfterLoad(),this._loadJson=null}Release(){CS.clearArray(this._flowchartStateStack),this._flowchartStateStack=null,this._flowchartStates.clear(),this._flowchartStates=null,this._currentFlowchartState=null,this._runtime=null,this._loadJson=null}GetRuntime(){return this._runtime}GetFlowchartDataItemByName(e){return this._runtime.GetFlowchartManager().GetFlowchartDataItemByName(e)}AddFlowchartState(e,t,s,n,i,r){const a=this._runtime.GetFlowchartManager().GetFlowchartDataItemByName(e);if(!a)return void console.warn(`[Flowcharts] no flowchart found with name '${e}'`);if(this._flowchartStates.has(s)){const e=this._flowchartStates.get(s);e&&this.RemoveFlowchartState(e)}const o=new CS.FlowchartState(e,s,t,a,this,n,r);return this._flowchartStates.set(s,o),i&&this.SetCurrentFlowchartState(o,!0),o}RemoveFlowchartState(e){if(e.MarkForRelease(),e.IsInTriggerState())return;const t=e.GetTag();this._flowchartStates.delete(t),e.Release(),this._currentFlowchartState===e&&(this._currentFlowchartState=null)}ResetFlowchartState(e){e.Reset()}GetFlowchartState(e){return this._flowchartStates.get(e)}PushFlowchartState(e){this._flowchartStateStack.push(e)}PopFlowchartState(){this._flowchartStateStack.pop()}SetCurrentFlowchartState(e,t=!1,s=!1,n=!0){if(n){const t=e.GetCurrentReferenceFlowchart();e=t||e}e!==this._currentFlowchartState&&(this._TriggerBeforeFlowchartChange(),this._TriggerAfterFlowchartChange(e,t,s))}GetCurrentFlowchartState(e){return"string"==typeof e?this.GetFlowchartState(e):this._flowchartStateStack.length?this._flowchartStateStack[this._flowchartStateStack.length-1]:this._currentFlowchartState}_TriggerBeforeFlowchartChange(){if(!this._currentFlowchartState)return;if(this._currentFlowchartState.WasReleased())return;const e=this._currentFlowchartState.GetPluginInstance().GetInstance();this._currentFlowchartState.PushIsTriggerState(),this.PushFlowchartState(this._currentFlowchartState),this._runtime.Trigger(CS.Plugins.Flowchart.Cnds.OnBeforeFlowchartChange,e),this.PopFlowchartState(),this._currentFlowchartState.PopIsTriggerState()}_TriggerAfterFlowchartChange(e,t=!1,s=!1){if(this._currentFlowchartState=e,!this._currentFlowchartState)return;if(this._currentFlowchartState.WasReleased())return;const n=this._currentFlowchartState.GetPluginInstance().GetInstance();this._currentFlowchartState.PushIsTriggerState(),this.PushFlowchartState(this._currentFlowchartState),this._runtime.Trigger(CS.Plugins.Flowchart.Cnds.OnFlowchartChange,n),!0!==s&&"number"!=typeof s||this._currentFlowchartState._SetStartFlowchartNode(s),t&&(this._runtime.Trigger(CS.Plugins.Flowchart.Cnds.OnAnyNodeChange,n),this._runtime.Trigger(CS.Plugins.Flowchart.Cnds.OnTaggedNodeChange,n),this._runtime.Trigger(CS.Plugins.Flowchart.Cnds.OnAnyNodeChangeInFlowchart,n),this._runtime.Trigger(CS.Plugins.Flowchart.Cnds.OnTaggedNodeChangeInFlowchart,n)),this.PopFlowchartState(),this._currentFlowchartState.PopIsTriggerState()}_SaveToJson(){return{flowchartJsonObjects:[...this._flowchartStates.values()].map((e=>e._SaveToJson())),currentFlowchartTag:this._currentFlowchartState?this._currentFlowchartState.GetTag():null}}_LoadFromJson(e){if(!e)return;this._loadJson=e;const t=new Map;for(const e of this._loadJson.flowchartJsonObjects){const s=e.flowchartTag;if(this._flowchartStates.has(s)){const n=this._flowchartStates.get(s);n._LoadFromJson(e),t.set(s,n)}else{const s=this.AddFlowchartState(e.flowchartName,e.startNodeTag,e.flowchartTag,null,!1,e.pluginUID);s._LoadFromJson(e),t.set(e.flowchartTag,s)}}for(const[e,s]of this._flowchartStates.entries())t.has(e)||s.Release();this._flowchartStates.clear(),this._flowchartStates=t,this._runtime.IsLoadingState()?this._runtime.Dispatcher().addEventListener("afterload",this._on_after_load):this._OnAfterLoad()}_OnAfterLoad(){this._runtime.Dispatcher().removeEventListener("afterload",this._on_after_load);const e=this._flowchartStates.get(this._loadJson.currentFlowchartTag);e&&this.SetCurrentFlowchartState(e,!0),this._loadJson=null}}}{const wS=self.C3;wS.FlowchartDataManager=class{constructor(){this._flowchartDataItems=new Map}Release(){for(const e of this._flowchartDataItems.values())e.Release();this._flowchartDataItems.clear(),this._flowchartDataItems=null}Add(e){const t=new wS.FlowchartDataItem(e),s=t.GetName();this._flowchartDataItems.set(s,t)}Get(e){return this._flowchartDataItems.get(e)}HasFlowcharts(){return!!this._flowchartDataItems.size}static CreateDataItems(e,t,s,n){if(t)for(const i of t){const t=new s(i,n);e.push(t)}}}}{const PS=self.C3,AS=0,RS=1;PS.FlowchartDataItem=class{constructor(e){this._name=e[0],this._flowchartNodeData=new PS.FlowchartNodeData(e[1],this)}Release(){this._flowchartNodeData.Release(),this._flowchartNodeData=null}GetFlowchartNodeData(){return this._flowchartNodeData}GetFlowchartElementById(e){return this._flowchartNodeData.GetFlowchartElementById(e)}GetFlowchartNodeByTags(e){return this._flowchartNodeData.GetFlowchartNodeByTags(e)}GetFlowchartStartNode(){return this._flowchartNodeData.GetFlowchartStartNode()}GetName(){return this._name}}}{const DS=self.C3,ES=0,MS=1,kS=2,LS=3,FS=4,BS=5,OS=6,NS=7,WS=8,VS=8,jS=9,US=10,HS=11;class zS{constructor(e,t){this._flowchartNodeData=t,this._type=e[7],this._flowchartId=e[0],this._tag=e[1],this._tag?this._tags=this._tag.trim().split(" ").map((e=>e.trim())):this._tags=[],this._parentFlowchartIds=e[2],this._parentOutputFlowchartIds=null,this._childrenFlowchartIds=null,this._enable=!1,"dictionary"===this._type&&(this._parentOutputFlowchartIds=e[3],this._childrenFlowchartIds=e[4],this._enable=e[8]),this._isStart=e[6],this._referenceFlowchartName=null,this._referenceFlowchartStartNodeTag=null,this._referenceFlowchartTag=null,"reference"===this._type&&(this._referenceFlowchartName=e[8],this._referenceFlowchartStartNodeTag=e[9],this._referenceFlowchartTag=e[10],this._enable=e[11]),this._flowchartNodeOutputData=new DS.FlowchartNodeOutputData(e[5],this)}Release(){this._flowchartNodeData=null}GetFlowchartNodeData(){return this._flowchartNodeData}GetFlowchartNodeOutputData(){return this._flowchartNodeOutputData}GetFlowchartId(){return this._flowchartId}GetTag(){return this._tag}GetTags(){return this._tags}HasTags(e){if(!this._tags)return!1;if(!this._tags.length)return!1;const t=DS.FlowchartState._GetTagArray(e);return!(!t||!t.length)&&t.every(DS.FlowchartState._HasTag,this._tags)}GetIsStart(){return this._isStart}SetIsStart(e){this._isStart=!!e}CanBeStartNode(){if("dictionary"===this._type)return!0;if("reference"===this._type)return!1;throw new Error(`unexpected flowchart node type: ${this._type}`)}GetParentFlowchartIds(){return this._parentFlowchartIds}GetParentOutputFlowchartIds(){return this._parentOutputFlowchartIds}GetChildrenFlowchartIds(){return this._childrenFlowchartIds}GetType(){return this._type}GetEnable(){return this._enable}GetReferenceFlowchartName(){return this._referenceFlowchartName}GetReferenceFlowchartStartNodeTag(){return this._referenceFlowchartStartNodeTag}GetReferenceFlowchartTag(){return this._referenceFlowchartTag}}DS.FlowchartNodeData=class{constructor(e,t){this._flowchartDataItem=t,this._flowchartNodeItems=[],this._flowchartNodeItemsIdMap=new Map,this._flowchartNodeItemsTagMap=new Map,this._flowchartNodeStartItem=null,DS.FlowchartDataManager.CreateDataItems(this._flowchartNodeItems,e,zS,this);for(const e of this._flowchartNodeItems){const t=e.GetFlowchartId(),s=e.GetTag(),n=e.GetTags(),i=e.GetIsStart();if(this._flowchartNodeItemsIdMap.set(t,e),s)for(const t of n)this._flowchartNodeItemsTagMap.has(t)||this._flowchartNodeItemsTagMap.set(t,new Set),this._flowchartNodeItemsTagMap.get(t).add(e);i&&(this._flowchartNodeStartItem=e);const r=e.GetFlowchartNodeOutputData();for(const e of r.flowchartNodeOutputDataItems()){const t=e.GetFlowchartId();this._flowchartNodeItemsIdMap.set(t,e)}}this._flowchartNodeStartItem||this._SetStartNodeIfMissing()}Release(){this._flowchartDataItem=null;for(const e of this._flowchartNodeItems)e.Release();DS.clearArray(this._flowchartNodeItems),this._flowchartNodeItems=null}GetFlowchartDataItem(){return this._flowchartDataItem}GetFlowchartElementById(e){return this._flowchartNodeItemsIdMap.get(e)}GetFlowchartNodeByTags(e){if(!e||!e.length)return null;const t=[];for(const s of e.trim().split(" ")){let e=this._flowchartNodeItemsTagMap.get(s.trim())??new Set;if(0===e.size)return null;t.push(e)}return[...t.reduce(((e,t)=>t.size<e.size?t:e))].filter((e=>t.every((t=>t.has(e)))))[0]}GetFlowchartStartNode(){return this._flowchartNodeStartItem}*flowchartNodeDataItems(){for(const e of this._flowchartNodeItems)yield e}_SetStartNodeIfMissing(){let e=0;for(const t of this.flowchartNodeDataItems())t.GetIsStart()&&e++;if(0===e){for(const e of this.flowchartNodeDataItems())if(e.CanBeStartNode()&&!e.GetIsStart())return void e.SetIsStart(!0)}else{if(1===e)return;if(e>1){let e=!0;for(const t of this.flowchartNodeDataItems())t.CanBeStartNode()&&(t.GetIsStart()&&e?e=!1:t.GetIsStart()&&!e&&t.SetIsStart(!1))}}for(const e of this.flowchartNodeDataItems())if(e.CanBeStartNode()&&e.GetIsStart())return void(this._flowchartNodeStartItem=e)}}}{const XS=self.C3,YS=0,qS=1,JS=2,KS=3,$S=4,ZS=5;class QS{constructor(e,t){this._flowchartNodeOutputData=t,this._flowchartId=e[0],this._name=e[1],this._value=e[2],this._connectedFlowchartNodeFlowchartId=e[3],this._enable=e[4],this._default=e[5]}Release(){this._flowchartNodeOutputData=null}GetFlowchartNodeOutputData(){return this._flowchartNodeOutputData}GetFlowchartId(){return this._flowchartId}GetName(){return this._name}GetValue(){return this._value}GetConnectedFlowchartNodeFlowchartId(){return this._connectedFlowchartNodeFlowchartId}GetEnable(){return this._enable}GetDefault(){return this._default}}XS.FlowchartNodeOutputData=class{constructor(e,t){this._flowchartDataNodeItem=t,this._flowchartNodeOutputItems=[],this._flowchartNodeOutputItemsNameMap=new Map,XS.FlowchartDataManager.CreateDataItems(this._flowchartNodeOutputItems,e,QS,this),this._enabledFlowchartNodeOutputItems=this._flowchartNodeOutputItems.filter((e=>e.GetEnable()));for(const e of this._enabledFlowchartNodeOutputItems)this._flowchartNodeOutputItemsNameMap.set(e.GetName(),e)}Release(){this._flowchartDataNodeItem=null;for(const e of this._flowchartNodeOutputItems)e.Release();XS.clearArray(this._flowchartNodeOutputItems),this._flowchartNodeOutputItems=null,XS.clearArray(this._enabledFlowchartNodeOutputItems),this._enabledFlowchartNodeOutputItems=null}GetFlowchartNodeDataItem(){return this._flowchartDataNodeItem}GetFlowchartNodeOutputDataItemCount(){return this._enabledFlowchartNodeOutputItems.length}GetFlowchartNodeOutputDataItems(){return this._enabledFlowchartNodeOutputItems}GetFlowchartNodeOutputDataItemByName(e){return this._flowchartNodeOutputItemsNameMap.get(e)}GetFlowchartNodeOutputDefault(){for(const e of this._enabledFlowchartNodeOutputItems)if(e.GetDefault())return e}*flowchartNodeOutputDataItems(){for(const e of this._enabledFlowchartNodeOutputItems)yield e}}}{const ey=self.C3;ey.SolStack=class extends ey.DefendedBase{constructor(e){super(),this._objectClass=e,this._stack=[],this._stack.push(ey.New(ey.Sol,this)),this._index=0,this._current=this._stack[0]}Release(){for(const e of this._stack)e.Release();ey.clearArray(this._stack),this._current=null,this._objectClass=null}GetObjectClass(){return this._objectClass}GetCurrentSol(){return this._current}GetOneBelowCurrentSol(){return this._stack[this._index-1]}Clear(){this.GetCurrentSol().Clear()}PushClean(){const e=this._stack,t=++this._index;if(t===e.length){const t=ey.New(ey.Sol,this);e.push(t),this._current=t}else{const s=e[t];s.Reset(),this._current=s}}PushCopy(){const e=this._stack,t=++this._index;t===e.length&&e.push(ey.New(ey.Sol,this));const s=e[t];s.Copy(e[t-1]),this._current=s}Pop(){this._current=this._stack[--this._index]}RemoveInstances(e){const t=this._stack;for(let s=0,n=t.length;s<n;++s)t[s].RemoveInstances(e)}}}{const ty=self.C3;ty.Sol=class extends ty.DefendedBase{constructor(e){super(),this._stack=e,this._objectClass=this._stack.GetObjectClass(),this._eventStack=this._objectClass.GetRuntime().GetEventStack(),this._selectAll=!0,this._instances=[],this._elseInstances=[]}Release(){this.ClearArrays(),this._stack=null,this._objectClass=null,this._eventStack=null}ClearArrays(){ty.clearArray(this._instances),ty.clearArray(this._elseInstances)}GetObjectClass(){return this._objectClass}IsSelectAll(){return this._selectAll}HasAnyInstances(){return this._selectAll?!!this._objectClass.GetInstanceCount():!!this._instances.length}GetInstances(){return this._selectAll?this._objectClass.GetInstances():this._instances}HasAnyElseInstances(){return!!this._elseInstances.length}GetElseInstances(){return this._elseInstances}GetExpressionInstances(){const e=this.GetInstances();return e.length?e:this._elseInstances}Reset(){this._selectAll=!0,ty.clearArray(this._elseInstances)}Clear(){this._selectAll=!0}Copy(e){e.IsSelectAll()?this.Reset():(this._selectAll=!1,ty.shallowAssignArray(this._instances,e._instances),ty.clearArray(this._elseInstances))}_PushInstance(e){this._instances.push(e)}_PushElseInstance(e){this._elseInstances.push(e)}_SetSelectAll(e){this._selectAll=!!e}_GetOwnInstances(){return this._instances}_GetOwnElseInstances(){return this._elseInstances}SetSinglePicked(e){this._selectAll=!1,ty.clearArray(this._instances),this._instances.push(e)}SetArrayPicked(e){this._selectAll=!1,ty.shallowAssignArray(this._instances,e)}SetSetPicked(e){this._selectAll=!1,ty.clearArray(this._instances);for(const t of e)this._instances.push(t)}AddElseInstances(e,t){for(const s of t)e.has(s)||this._elseInstances.push(s)}TransferElseInstancesToOwn(e){for(const t of e)this._instances.push(t);ty.arrayRemoveAllInSet(this._elseInstances,e)}ClearElseInstances(){ty.clearArray(this._elseInstances)}PickOne(e){if(e)if(this._eventStack.GetCurrentStackFrame().GetCurrentEvent().IsOrBlock()){this.IsSelectAll()&&(ty.clearArray(this._instances),ty.shallowAssignArray(this._elseInstances,e.GetObjectClass().GetInstances()),this._selectAll=!1);const t=this._elseInstances.indexOf(e);-1!==t&&(this._instances.push(this._elseInstances[t]),this._elseInstances.splice(t,1))}else this.SetSinglePicked(e)}RemoveInstances(e){ty.arrayRemoveAllInSet(this._instances,e),ty.arrayRemoveAllInSet(this._elseInstances,e)}}}{const sy=self.C3;sy.EventStack=class extends sy.DefendedBase{constructor(e){super(),this._eventSheetManager=e,this._runtime=this._eventSheetManager.GetRuntime(),this._stack=[],this._stack.push(sy.New(sy.EventStackFrame,this,null)),this._index=0,this._expFuncStack=[]}Release(){for(const e of this._stack)e.Release();sy.clearArray(this._stack),sy.clearArray(this._expFuncStack),this._eventSheetManager=null,this._runtime=null}GetEventSheetManager(){return this._eventSheetManager}GetRuntime(){return this._runtime}GetCurrentStackFrame(){return this._stack[this._index]}GetAllStackFrames(){return this._stack}GetCurrentStackFrameIndex(){return this._index}Push(e){const t=this._stack,s=++this._index;if(s===t.length){const s=sy.New(sy.EventStackFrame,this,e);return t.push(s),s}{const n=t[s];return n.Reset(e),n}}Pop(){--this._index}PushExpFunc(e){this._expFuncStack.push(e)}PopExpFunc(){this._expFuncStack.pop()}GetCurrentExpFuncStackFrame(){const e=this._expFuncStack;return 0===e.length?null:e.at(-1)}}}{const ny=self.C3;ny.EventStackFrame=class extends ny.DefendedBase{constructor(e,t){super(),this._stack=e,this._runtime=this._stack.GetRuntime(),this._currentEvent=t,this._cndIndex=0,this._actIndex=0,this._lastEventTrue=!1,this._elseBranchRan=!1,this._expressionObjectClass=null,this._functionReturnType=0,this._functionReturnValue=0,this._dynamicSolModifiers=null}Release(){this.Reset(null),this._stack=null,this._runtime=null}Reset(e){this._currentEvent=e,this._cndIndex=0,this._actIndex=0,this._lastEventTrue=!1,this._elseBranchRan=!1,this._dynamicSolModifiers=null}_Restore(e,t){this._currentEvent=e,this._cndIndex=0,this._actIndex=t}ResetQuick(){this._cndIndex=0,this._actIndex=0}GetCurrentEvent(){return this._currentEvent}SetCurrentEvent(e){this._currentEvent=e}GetConditionIndex(){return this._cndIndex}SetConditionIndex(e){this._cndIndex=e}GetActionIndex(){return this._actIndex}SetActionIndex(e){this._actIndex=e}SetLastEventTrue(e){this._lastEventTrue=!!e}GetLastEventTrue(){return this._lastEventTrue}SetElseBranchRan(e){this._elseBranchRan=!!e}GetElseBranchRan(){return this._elseBranchRan}SetExpressionObjectClass(e){this._expressionObjectClass=e}GetExpressionObjectClass(){return this._expressionObjectClass}InitCallFunctionExpression(e,t){this._functionReturnType=e,this._functionReturnValue=t}GetFunctionReturnType(){return this._functionReturnType}SetFunctionReturnValue(e){this._functionReturnValue=e}GetFunctionReturnValue(){return this._functionReturnValue}IsSolModifierAfterCnds(){const e=this._currentEvent;return!!e.IsSolWriterAfterCnds()||this._cndIndex<e.GetConditionCount()-1&&!!e.GetSolModifiers().length}SetDynamicSolModifiers(e){this._dynamicSolModifiers=e}GetDynamicSolModifiers(){return this._dynamicSolModifiers}}}{const iy=self.C3;iy.LocalVarStack=class extends iy.DefendedBase{constructor(e){super(),this._eventSheetManager=e,this._runtime=this._eventSheetManager.GetRuntime(),this._stack=[],this._index=-1,this._current=null,this._initialValues=[]}Release(){iy.clearArray(this._stack),this._eventSheetManager=null,this._runtime=null}_SetInitialValues(e){this._initialValues=e;const t=this._initialValues.slice(0);this._stack.push(t),this._index=0,this._current=t}GetEventSheetManager(){return this._eventSheetManager}GetRuntime(){return this._runtime}GetCurrent(){return this._current}Push(){const e=++this._index,t=this._stack;e===t.length?t.push(this._initialValues.slice(0)):iy.shallowAssignArray(t[e],this._initialValues),this._current=t[e]}Pop(){this._current=this._stack[--this._index]}}}{const ry=self.C3;ry.LoopStack=class extends ry.DefendedBase{constructor(e){super(),this._eventSheetManager=e,this._runtime=this._eventSheetManager.GetRuntime(),this._stack=[],this._index=-1}Release(){ry.clearArray(this._stack),this._eventSheetManager=null,this._runtime=null}GetEventSheetManager(){return this._eventSheetManager}GetRuntime(){return this._runtime}IsInLoop(){return this._index>=0}GetCurrent(){return this._stack[this._index]}Push(){if(++this._index,this._index===this._stack.length){const e=ry.New(ry.Loop,this);return this._stack.push(e),e}{const e=this._stack[this._index];return e.Reset(),e}}Pop(){--this._index}FindByName(e){const t=this._stack;for(let s=this._index;s>=0;--s){const n=t[s];if(n.GetName()===e)return n}return null}_GetStack(){return this._stack.slice(0,this._index+1)}}}{const ay=self.C3;ay.Loop=class extends ay.DefendedBase{constructor(e){super(),this._loopStack=e,this._name="",this._index=0,this._isStopped=!1,this._end=NaN}Reset(){this._name="",this._index=0,this._isStopped=!1,this._end=NaN}SetName(e){this._name=e}GetName(){return this._name}SetIndex(e){this._index=e}GetIndex(){return this._index}Stop(){this._isStopped=!0}IsStopped(){return this._isStopped}SetEnd(e){this._end=e}GetEnd(){return this._end}}}{const oy=self.C3;oy.ArrayStack=class extends oy.DefendedBase{constructor(){super(),this._stack=[],this._index=-1}Release(){oy.clearArray(this._stack)}GetCurrent(){return this._stack[this._index]}Push(){if(++this._index,this._index===this._stack.length){const e=[];return this._stack.push(e),e}return this._stack[this._index]}Pop(){--this._index}}}{let ly=function(e,t){return e.GetIndex()-t.GetIndex()},cy=function(e,t){for(let s=0,n=e.length;s<n;++s)if(e[s]!==t[s])return!1;return!0};SortSolArray=ly,IsSolArrayIdentical=cy;const hy=self.C3,_y=self.assert;hy.EventSheetManager=class extends hy.DefendedBase{constructor(e){super(),this._runtime=e,this._allSheets=[],this._sheetsByName=new Map,this._allGroups=[],this._groupsByName=new Map,this._blocksBySid=new Map,this._cndsBySid=new Map,this._actsBySid=new Map,this._allUniqueSolModifiers=new Map,this._eventVarsBySid=new Map,this._nextLocalVarIndex=0,this._allGlobalVars=[],this._allLocalVars=[],this._localVarInitialValues=[],this._functionBlocksByName=new Map,this._customActionBlocksMap=new Map,this._eventStack=hy.New(hy.EventStack,this),this._localVarStack=hy.New(hy.LocalVarStack,this),this._loopStack=hy.New(hy.LoopStack,this),this._triggersToPostInit=[],this._queuedTriggers=[],this._queuedDebugTriggers=[],this._runningEventsDepth=0,this._executingTriggerDepth=0,this._blockFlushingDepth=0,this._scheduledWaits=[],this._asyncActionPromises=[],this._signalTags=[],this._signalPromises=new Map,this._instSignals=new Map,self.c3_callFunction=(e,t)=>this._InvokeFunctionFromJS(e,t)}Release(){this.ClearAllScheduledWaits(),this._eventStack.Release(),this._eventStack=null,this._localVarStack.Release(),this._localVarStack=null,hy.clearArray(this._queuedTriggers),hy.clearArray(this._queuedDebugTriggers),this._runtime=null,hy.clearArray(this._allSheets),this._sheetsByName.clear()}Create(e){const t=hy.New(hy.EventSheet,this,e);this._allSheets.push(t),this._sheetsByName.set(t.GetName().toLowerCase(),t)}_AddTriggerToPostInit(e){this._triggersToPostInit.push(e)}_PostInit(){for(const e of this._customActionBlocksMap.values())e._CheckOverrideState();for(const e of this._functionBlocksByName.values())e._PostInit();for(const e of this._customActionBlocksMap.values())e._PostInit();for(const e of this._allSheets)e._PostInit();for(const e of this._allSheets)e._UpdateDeepIncludes();for(const e of this._triggersToPostInit)e._PostInit(!1);hy.clearArray(this._triggersToPostInit),this._localVarStack._SetInitialValues(this._localVarInitialValues)}GetRuntime(){return this._runtime}GetEventSheetByName(e){return this._sheetsByName.get(e.toLowerCase())||null}_RegisterGroup(e){this._allGroups.push(e),this._groupsByName.set(e.GetGroupName(),e)}_RegisterEventBlock(e){this._blocksBySid.set(e.GetSID(),e)}_RegisterCondition(e){this._cndsBySid.set(e.GetSID(),e)}_RegisterAction(e){this._actsBySid.set(e.GetSID(),e)}_RegisterFunctionBlock(e){switch(e.GetFunctionType()){case 0:this._functionBlocksByName.set(e.GetFunctionName().toLowerCase(),e);break;case 1:this._customActionBlocksMap.set(e.GetFunctionName().toLowerCase(),e)}}_RegisterEventVariable(e){this._eventVarsBySid.set(e.GetSID(),e),e.IsGlobal()?this._allGlobalVars.push(e):this._allLocalVars.push(e)}_DeduplicateSolModifierList(e){e.length>=2&&e.sort(ly);let t=this._allUniqueSolModifiers.get(e.length);t||(t=[],this._allUniqueSolModifiers.set(e.length,t));for(let s=0,n=t.length;s<n;++s){const n=t[s];if(cy(e,n))return n}return t.push(e),e}_GetNextLocalVarIndex(e){return this._localVarInitialValues.push(e.GetInitialValue()),this._nextLocalVarIndex++}GetEventStack(){return this._eventStack}GetCurrentEventStackFrame(){return this.GetEventStack().GetCurrentStackFrame()}GetCurrentEvent(){return this.GetCurrentEventStackFrame().GetCurrentEvent()}GetCurrentCondition(){const e=this.GetCurrentEventStackFrame();return e.GetCurrentEvent().GetConditionAt(e.GetConditionIndex())}GetCurrentAction(){const e=this.GetCurrentEventStackFrame();return e.GetCurrentEvent().GetActionAt(e.GetActionIndex())}GetLocalVarStack(){return this._localVarStack}GetLoopStack(){return this._loopStack}GetAllLocalVariablesInScope(e){const t=[];for(e=e.GetScopeParent();e;)hy.appendArray(t,e._GetAllLocalVariablesInScope()),e=e.GetScopeParent();return t}_GetLocalVariablesScriptInterface(e){const t={};for(const s of this.GetAllLocalVariablesInScope(e))t[s.GetJsPropName()]=s._GetScriptInterfaceDescriptor();return Object.create(Object.prototype,t)}GetEventVariableBySID(e){return this._eventVarsBySid.get(e)||null}GetEventBlockBySID(e){return this._blocksBySid.get(e)||null}GetConditionBySID(e){return this._cndsBySid.get(e)||null}GetActionBySID(e){return this._actsBySid.get(e)||null}GetFunctionBlockByName(e){return this._functionBlocksByName.get(e.toLowerCase())||null}GetCustomActionBlockByName(e,t){let s=this._customActionBlocksMap.get((e.GetName()+"."+t).toLowerCase());if(s)return s;if(!e.IsFamily())for(const n of e.GetFamilies())if(s=this._customActionBlocksMap.get((n.GetName()+"."+t).toLowerCase()),s)return s;return null}GetAllGlobalVariables(){return this._allGlobalVars}GetAllLocalVariables(){return this._allLocalVars}ResetAllGlobalsToInitialValue(e){for(const e of this._allGlobalVars)e.ResetToInitialValue();if(e)for(const e of this._allLocalVars)e.IsStatic()&&e.ResetToInitialValue()}GetEventGroupByName(e){return this._groupsByName.get(e.toLowerCase())||null}GetEventGroupBySID(e){const t=this._blocksBySid.get(e);return t&&t.IsGroup()?t:null}GetAllGroups(){return this._allGroups}ResetAllGroupsInitialActivation(){for(const e of this._allGroups)e.ResetInitialActivation()}_ResetAllHasRunFlags(){for(const e of this._allSheets)e._ResetHasRunFlag()}RunEvents(e){this._ResetAllHasRunFlags(),this._runningEventsDepth++;for(const t of e.runningLayouts()){const e=t.GetEventSheet();e&&(this._runtime.PushCurrentLayout(t),e.Run(),this._runtime.PopCurrentLayout())}this._runningEventsDepth--}async DebugRunEvents(e){this._ResetAllHasRunFlags(),this._runningEventsDepth++;for(const t of this._DebugRunEventsGen(e))await this._runtime.DebugBreak(t);this._runningEventsDepth--}*_DebugRunEventsGen(e){for(const t of e.runningLayouts()){const e=t.GetEventSheet();e&&(this._runtime.PushCurrentLayout(t),yield*e.DebugRun(),this._runtime.PopCurrentLayout())}}_Trigger(e,t,s,n){let i=!1;if(!e.GetMainRunningLayout())return this.QueueTrigger(t,s,n);this._executingTriggerDepth++;for(const r of e.runningLayouts()){const e=r.GetEventSheet();if(!e)continue;this._runtime.PushCurrentLayout(r);for(const r of e.deepIncludes()){const e=r._Trigger(t,s,n);i=i||e}const a=e._Trigger(t,s,n);i=i||a,this._runtime.PopCurrentLayout()}return this._executingTriggerDepth--,i}*_DebugTrigger(e,t,s,n){let i=!1;if(!e.GetMainRunningLayout())return this.QueueTrigger(t,s,n);this._executingTriggerDepth++;for(const r of e.runningLayouts()){const e=r.GetEventSheet();if(!e)continue;this._runtime.PushCurrentLayout(r);for(const r of e.deepIncludes()){const e=yield*r._DebugTrigger(t,s,n);i=i||e}const a=yield*e._DebugTrigger(t,s,n);i=i||a,this._runtime.PopCurrentLayout()}return this._executingTriggerDepth--,i}QueueTrigger(e,t,s){return this._queuedTriggers.push([e,t,s]),!1}QueueDebugTrigger(e,t,s){let n=null;const i=new Promise((e=>n=e));return this._queuedDebugTriggers.push([e,t,s,n]),i}*_RunQueuedDebugTriggersGen(){if(this._runtime.HitBreakpoint())throw new Error("should not be in breakpoint");const e=this._runtime.GetLayoutManager();for(;this._queuedDebugTriggers.length;){const[t,s,n,i]=this._queuedDebugTriggers.shift();i(yield*this._DebugTrigger(e,t,s,n))}}async RunQueuedDebugTriggersAsync(){for(const e of this._RunQueuedDebugTriggersGen())await this._runtime.DebugBreak(e)}_FastTrigger(e,t,s,n){let i=!1;const r=e.GetMainRunningLayout(),a=r.GetEventSheet();if(!a)return;this._executingTriggerDepth++,this._runtime.PushCurrentLayout(r);const o=a.deepIncludes();for(let e=0,r=o.length;e<r;++e){const r=o[e]._FastTrigger(t,s,n);i=i||r}const l=a._FastTrigger(t,s,n);return i=i||l,this._runtime.PopCurrentLayout(),this._executingTriggerDepth--,i}*_DebugFastTrigger(e,t,s,n){let i=!1;const r=e.GetMainRunningLayout(),a=r.GetEventSheet();if(!a)return;this._executingTriggerDepth++,this._runtime.PushCurrentLayout(r);const o=a.deepIncludes();for(let e=0,r=o.length;e<r;++e){const r=yield*o[e]._DebugFastTrigger(t,s,n);i=i||r}const l=yield*a._DebugFastTrigger(t,s,n);return i=i||l,this._runtime.PopCurrentLayout(),this._executingTriggerDepth--,i}GetTriggerDepth(){return this._executingTriggerDepth}IsInTrigger(){return this.GetTriggerDepth()>0}_IncTriggerDepth(){return++this._executingTriggerDepth}_DecTriggerDepth(){--this._executingTriggerDepth}IsRunningEvents(){return this._runningEventsDepth>0}IsInEventEngine(){return this.IsRunningEvents()||this.IsInTrigger()}_RunQueuedTriggers(e){for(const[t,s,n]of this._queuedTriggers)this._Trigger(e,t,s,n);hy.clearArray(this._queuedTriggers)}BlockFlushingInstances(e){e?this._blockFlushingDepth++:this._blockFlushingDepth--}IsFlushingBlocked(){return this._blockFlushingDepth>0}ClearSol(e){for(let t=0,s=e.length;t<s;++t)e[t].GetSolStack().Clear()}PushCleanSol(e){for(let t=0,s=e.length;t<s;++t)e[t].GetSolStack().PushClean()}PushCopySol(e){for(let t=0,s=e.length;t<s;++t)e[t].GetSolStack().PushCopy()}PopSol(e){for(let t=0,s=e.length;t<s;++t)e[t].GetSolStack().Pop()}GetDynamicSolModifiersSet(e){const t=new Set,s=this._eventStack.GetAllStackFrames(),n=this._eventStack.GetCurrentStackFrameIndex();for(let i=0;i<=n;++i){const n=s[i].GetDynamicSolModifiers();if(n)for(const s of n)e&&e.has(s)||t.add(s)}return t}PushCleanSolDynamic(e){const t=new Set([...e]),s=this.GetDynamicSolModifiersSet(t);if(s.size>0){for(const e of s)e.GetSolStack().PushClean();return[...s]}return null}AddScheduledWait(){const e=hy.New(hy.ScheduledWait,this);return this._scheduledWaits.push(e),e}scheduledWaits(){return this._scheduledWaits}RunScheduledWaits(){if(!this._scheduledWaits.length)return;const e=this.GetCurrentEventStackFrame();let t=!1;this._runningEventsDepth++;for(let s=0,n=this._scheduledWaits.length;s<n;++s){const n=this._scheduledWaits[s];n._ShouldRun()&&n._Run(e),n.ShouldRelease()&&(t=!0)}t&&(this._FilterScheduledWaitsToRelease(),e.Reset(null)),this._runningEventsDepth--}async DebugRunScheduledWaits(){if(!this._scheduledWaits.length)return;const e=this.GetCurrentEventStackFrame();let t=!1;this._runningEventsDepth++;for(let s=0,n=this._scheduledWaits.length;s<n;++s){const n=this._scheduledWaits[s];n._ShouldRun()&&await n._DebugRun(e),n.ShouldRelease()&&(t=!0)}t&&(this._FilterScheduledWaitsToRelease(),e.Reset(null)),this._runningEventsDepth--}_FilterScheduledWaitsToRelease(){const e=hy.arrayFilterOut(this._scheduledWaits,(e=>e.ShouldRelease()));for(const t of e)t.Release()}ClearAllScheduledWaits(){for(const e of this._scheduledWaits)e.Release();hy.clearArray(this._scheduledWaits)}_OnInstancesReleased(e){for(const t of this._scheduledWaits)t.RemoveInstances(e);for(const t of e){const e=this._instSignals.get(t);if(this._instSignals.delete(t),e)for(const{resolve:t}of e.signalPromises.values())t(!0)}}AddAsyncActionPromise(e){this._asyncActionPromises.push({promise:e,triggerDepth:this.GetTriggerDepth()})}ClearAsyncActionPromises(){hy.clearArray(this._asyncActionPromises)}GetPromiseForAllAsyncActions(){const e=this.GetTriggerDepth(),t=Promise.all(this._asyncActionPromises.filter((t=>t.triggerDepth===e)).map((e=>e.promise)));return this._asyncActionPromises=this._asyncActionPromises.filter((t=>t.triggerDepth<e)),t}Signal(e){const t=e.toLowerCase();this._signalTags.push(t),this._runtime.Trigger(hy.Plugins.System.Cnds.OnSignal,null),this._signalTags.pop();for(const e of this._runtime.GetEventSheetManager().scheduledWaits())e.IsSignal()&&e.GetSignalTag()===t&&e.SetSignalled();const s=this._signalPromises.get(t);s&&(s.resolve(),this._signalPromises.delete(t))}WaitForSignal(e){const t=e.toLowerCase(),s=this._signalPromises.get(t);if(s)return s.promise;{let e=null;const s=new Promise((t=>e=t));return this._signalPromises.set(t,{promise:s,resolve:e}),s}}GetCurrentSignalTag(){if(0===this._signalTags.length)throw new Error("not in a signal");return this._signalTags.at(-1)}_GetInstanceSignalState(e){let t=this._instSignals.get(e);return t||(t={signalTags:[],signalPromises:new Map},this._instSignals.set(e,t)),t}InstanceSignal(e,t){const s=this._GetInstanceSignalState(e),n=t.toLowerCase();s.signalTags.push(n),this._runtime.Trigger(e.GetPlugin().GetConstructor().Cnds.OnInstanceSignal,e),s.signalTags.pop();for(const t of this._runtime.GetEventSheetManager().scheduledWaits())t.IsInstanceSignals()&&t.GetSignalTag()===n&&t.SetInstanceSignalled(e);const i=s.signalPromises.get(n);i&&(i.resolve(!1),s.signalPromises.delete(n)),0===s.signalTags.length&&0===s.signalPromises.size&&this._instSignals.delete(e)}WaitForInstanceSignal(e,t){const s=this._GetInstanceSignalState(e),n=t.toLowerCase(),i=s.signalPromises.get(n);if(i)return i.promise;{let e=null;const t=new Promise((t=>e=t));return s.signalPromises.set(n,{promise:t,resolve:e}),t}}GetCurrentInstanceSignalTag(e){const t=this._GetInstanceSignalState(e);if(!t||0===t.signalTags.length)throw new Error("not in a signal");return t.signalTags.at(-1)}_SaveToJson(){return{groups:this._SaveGroupsToJson(),cnds:this._SaveCndsToJson(),acts:this._SaveActsToJson(),vars:this._SaveVarsToJson(),waits:this._SaveScheduledWaitsToJson()}}_LoadFromJson(e){this._LoadGroupsFromJson(e.groups),this._LoadCndsFromJson(e.cnds),this._LoadActsFromJson(e.acts),this._LoadVarsFromJson(e.vars),this._LoadScheduledWaitsFromJson(e.waits)}_SaveGroupsToJson(){const e={};for(const t of this.GetAllGroups())e[t.GetSID().toString()]=t.IsGroupActive();return e}_LoadGroupsFromJson(e){for(const[t,s]of Object.entries(e)){const e=parseInt(t,10),n=this.GetEventGroupBySID(e);n&&n.SetGroupActive(s)}}_SaveCndsToJson(){const e={};for(const[t,s]of this._cndsBySid){const n=s._SaveToJson();n&&(e[t.toString()]=n)}return e}_LoadCndsFromJson(e){const t=new Map;for(const[s,n]of Object.entries(e))t.set(parseInt(s,10),n);for(const[e,s]of this._cndsBySid)s._LoadFromJson(t.get(e)||null)}_SaveActsToJson(){const e={};for(const[t,s]of this._actsBySid){const n=s._SaveToJson();n&&(e[t.toString()]=n)}return e}_LoadActsFromJson(e){const t=new Map;for(const[s,n]of Object.entries(e))t.set(parseInt(s,10),n);for(const[e,s]of this._actsBySid)s._LoadFromJson(t.get(e)||null)}_SaveVarsToJson(){const e={};for(const[t,s]of this._eventVarsBySid)s.IsConstant()||!s.IsGlobal()&&!s.IsStatic()||(e[t.toString()]=s.GetValue());return e}_LoadVarsFromJson(e){for(const[t,s]of Object.entries(e)){const e=parseInt(t,10),n=this.GetEventVariableBySID(e);n&&n.SetValue(s)}}_SaveScheduledWaitsToJson(){return this._scheduledWaits.filter((e=>!e.IsPromise())).map((e=>e._SaveToJson()))}_LoadScheduledWaitsFromJson(e){this.ClearAllScheduledWaits();for(const t of e){const e=hy.ScheduledWait._CreateFromJson(this,t);e&&this._scheduledWaits.push(e)}}_GetPerfRecords(){return[...this._runtime.GetLayoutManager().runningLayouts()].map((e=>e.GetEventSheet())).filter((e=>e)).map((e=>e._GetPerfRecord()))}FindFirstFunctionBlockParent(e){for(;e;){const t=e.GetScopeParent();if(t instanceof hy.FunctionBlock)return t;e=t}return null}_InvokeFunctionFromJS(e,t){Array.isArray(t)||(t=[]);const s=this.GetFunctionBlockByName(e.toLowerCase());if(!s)return null;if(!s.IsEnabled())return s.GetDefaultReturnValue();const n=s.GetFunctionParameters();if(t.length<n.length){t=t.slice(0);do{t.push(n[t.length].GetInitialValue())}while(t.length<n.length)}const i=s.GetEventBlock();return i.RunAsExpressionFunctionCall(i.GetSolModifiersIncludingParents(),!1,s.GetReturnType(),s.GetDefaultReturnValue(),...t)}}}{const uy=self.C3;uy.EventSheet=class extends uy.DefendedBase{constructor(e,t){super(),this._eventSheetManager=e,this._runtime=e.GetRuntime(),this._name=t[0],this._events=[],this._triggers=new Map,this._fastTriggers=new Map,this._eventsByDisplayNumber=new Map,this._hasRun=!1,this._shallowIncludes=[],this._deepIncludes=[],this._alreadyIncludedSheets=new Set;for(const e of t[1])this._CreateEvent(e,null,this._events);this._perfRecord=this._runtime.IsDebug()?{type:"sheet",name:this._name,totalTimeCounter:0,children:[]}:null}Release(){this._eventSheetManager=null,this._runtime=null}_CreateEvent(e,t,s){switch(e[0]){case 0:case 3:this._CreateEventBlock(e,t,s);break;case 1:this._CreateEventVariable(e,t,s);break;case 2:this._CreateInclude(e,t,s);break;case 4:this._CreateFunctionBlock(e,t);break;case 5:this._CreateScriptBlock(e,t,s);break;case 6:this._CreateCustomACEBlock(e,t);break;default:throw new Error("invalid event type")}}_CreateEventBlock(e,t,s){const n=uy.EventBlock.Create(this,t,e);if(n.IsOrBlock()){s.push(n);const e=n.GetConditions();for(let t=0,s=e.length;t<s;++t)e[t].IsTrigger()&&this._InitTrigger(n,t)}else n.IsTrigger()?this._InitTrigger(n,0):s.push(n)}_CreateFunctionBlock(e,t){const s=uy.FunctionBlock.CreateFunctionBlock(this,t,e);this._eventSheetManager._RegisterFunctionBlock(s)}_CreateCustomACEBlock(e,t){const s=uy.FunctionBlock.CreateCustomACEBlock(this,t,e);this._eventSheetManager._RegisterFunctionBlock(s)}_CreateEventVariable(e,t,s){const n=uy.EventVariable.Create(this,t,e);s.push(n)}_CreateInclude(e,t,s){const n=uy.EventInclude.Create(this,t,e);s.push(n)}_CreateScriptBlock(e,t,s){const n=uy.EventScript.Create(this,t,e);s.push(n)}_InitTrigger(e,t){e.IsOrBlock()||this._eventSheetManager._AddTriggerToPostInit(e);const s=e.GetConditionAt(t),n=s._GetFunc(),i=s.GetObjectClass();if(s.IsFastTrigger()){let r=this._fastTriggers.get(i);r||(r=new Map,this._fastTriggers.set(i,r));const a=s.GetFastTriggerValue().toLowerCase();let o=r.get(n);o||(o=new Map,r.set(n,o));let l=o.get(a);l||(l=[],o.set(a,l)),l.push([e,t])}else{let r=this._triggers.get(i);r||(r={methodMap:new Map,behaviors:new Map},this._triggers.set(i,r));const a=s.GetBehaviorType();let o;a?(o=r.behaviors.get(a),o||(o=new Map,r.behaviors.set(a,o))):o=r.methodMap;let l=o.get(n);l||(l=[],o.set(n,l)),l.push([e,t])}}_PostInit(){const e=this._events;for(let t=0,s=e.length;t<s;++t){const n=t<s-1&&e[t+1]instanceof uy.EventBlock&&e[t+1].IsElseBlock();e[t]._PostInit(n)}}_AddShallowInclude(e){this._shallowIncludes.push(e)}_UpdateDeepIncludes(){uy.clearArray(this._deepIncludes),this._AddDeepIncludes(this),this._alreadyIncludedSheets.clear()}_AddDeepIncludes(e){const t=e._deepIncludes,s=e._alreadyIncludedSheets;for(const n of this._shallowIncludes){const i=n.GetIncludeSheet();n.IsActive()&&e!==i&&!s.has(i)&&(s.add(i),i._AddDeepIncludes(e),t.push(i))}}deepIncludes(){return this._deepIncludes}GetEventSheetManager(){return this._eventSheetManager}GetRuntime(){return this._runtime}GetName(){return this._name}_RegisterEventByDisplayNumber(e,t){this._eventsByDisplayNumber.set(t,e)}_GetEventByDisplayNumber(e){return this._eventsByDisplayNumber.get(e)||null}_ResetHasRunFlag(){this._hasRun=!1}Run(){if(this._hasRun)return;const e=this._runtime,t=e.IsCPUProfiling(),s=t?performance.now():0;this._hasRun=!0;const n=this.GetEventSheetManager(),i=n.GetCurrentEventStackFrame();for(const t of this._events)t.Run(i),n.ClearSol(t.GetSolModifiers()),n.ClearAsyncActionPromises(),e.FlushPendingInstances();i.Reset(null),t&&(this._perfRecord.totalTimeCounter+=performance.now()-s)}*DebugRun(){if(this._hasRun)return;this._hasRun=!0;const e=this._runtime,t=this.GetEventSheetManager(),s=t.GetCurrentEventStackFrame();for(const n of this._events)yield*n.DebugRun(s),t.ClearSol(n.GetSolModifiers()),t.ClearAsyncActionPromises(),e.FlushPendingInstances();s.Reset(null)}_Trigger(e,t,s){if(!t)return this._TriggerForClass(e,t,null,null);{const n=t.GetObjectClass();let i=!1,r=this._TriggerForClass(e,t,n,s);i=i||r;for(const a of n.GetFamilies())r=this._TriggerForClass(e,t,a,s),i=i||r}}_TriggerForClass(e,t,s,n){const i=this._triggers.get(s);if(!i)return!1;const r=n?i.behaviors.get(n):i.methodMap;if(!r)return!1;const a=r.get(e);if(!a)return!1;let o=!1;for(const[e,s]of a){const n=this._ExecuteTrigger(t,e,s);o=o||n}return o}*_DebugTrigger(e,t,s){if(!t)return yield*this._DebugTriggerForClass(e,t,null,null);{const n=t.GetObjectClass();let i=!1,r=yield*this._DebugTriggerForClass(e,t,n,s);i=i||r;for(const a of n.GetFamilies())r=yield*this._DebugTriggerForClass(e,t,a,s),i=i||r}}*_DebugTriggerForClass(e,t,s,n){const i=this._triggers.get(s);if(!i)return!1;const r=n?i.behaviors.get(n):i.methodMap;if(!r)return!1;const a=r.get(e);if(!a)return!1;let o=!1;for(const[e,s]of a){let n;n=e.DebugCanRunFast()?this._ExecuteTrigger(t,e,s):yield*this._DebugExecuteTrigger(t,e,s),o=o||n}return o}_FastTrigger(e,t,s){const n=t.GetObjectClass(),i=this._fastTriggers.get(n);if(!i)return!1;const r=i.get(e);if(!r)return!1;const a=r.get(s);if(!a)return!1;let o=!1;for(let e=0,t=a.length;e<t;++e){const t=a[e],s=this._ExecuteTrigger(null,t[0],t[1]);o=o||s}return o}*_DebugFastTrigger(e,t,s){const n=t.GetObjectClass(),i=this._fastTriggers.get(n);if(!i)return!1;const r=i.get(e);if(!r)return!1;const a=r.get(s);if(!a)return!1;let o=!1;for(let e=0,t=a.length;e<t;++e){const t=a[e],s=t[0],n=t[1];let i;i=s.DebugCanRunFast()?this._ExecuteTrigger(null,s,n):yield*this._DebugExecuteTrigger(null,s,n),o=o||i}return o}_ExecuteTrigger(e,t,s){const n=this._runtime,i=this._eventSheetManager,r=i.GetCurrentEvent(),a=i.GetEventStack(),o=i.GetTriggerDepth();let l=!1;r&&i.PushCleanSol(r.GetSolModifiersIncludingParents()),i.PushCleanSol(t.GetSolModifiersIncludingParents());const c=o>1;c&&i.GetLocalVarStack().Push();const h=a.Push(t);e&&(t.GetConditions()[s].GetObjectClass().GetCurrentSol().SetSinglePicked(e),e.IsInContainer()&&e.SetSiblingsSinglePicked());let _=!0;if(t.GetParent()){const e=t.GetTriggerParents();for(let t=0,s=e.length;t<s;++t)if(!e[t].RunPreTrigger(h)){_=!1;break}}return _&&(t.IsOrBlock()?t.RunOrBlockTrigger(h,s):t.Run(h),l=h.GetLastEventTrue()),a.Pop(),c&&i.GetLocalVarStack().Pop(),i.PopSol(t.GetSolModifiersIncludingParents()),r&&i.PopSol(r.GetSolModifiersIncludingParents()),r||1!==o||(i.ClearAsyncActionPromises(),i.IsFlushingBlocked()||n.FlushPendingInstances()),l}*_DebugExecuteTrigger(e,t,s){const n=this._runtime,i=this._eventSheetManager,r=i.GetCurrentEvent(),a=i.GetEventStack(),o=i.GetTriggerDepth();let l=!1;r&&i.PushCleanSol(r.GetSolModifiersIncludingParents()),i.PushCleanSol(t.GetSolModifiersIncludingParents());const c=o>1;c&&i.GetLocalVarStack().Push();const h=a.Push(t);e&&(t.GetConditions()[s].GetObjectClass().GetCurrentSol().SetSinglePicked(e),e.IsInContainer()&&e.SetSiblingsSinglePicked());let _=!0;if(t.GetParent()){const e=t.GetTriggerParents();for(let t=0,s=e.length;t<s;++t)if(!(yield*e[t].DebugRunPreTrigger(h))){_=!1;break}}return _&&(t.IsOrBlock()?yield*t.DebugRunOrBlockTrigger(h,s):yield*t.DebugRun(h),l=h.GetLastEventTrue()),a.Pop(),c&&i.GetLocalVarStack().Pop(),i.PopSol(t.GetSolModifiersIncludingParents()),r&&i.PopSol(r.GetSolModifiersIncludingParents()),r||1!==o||(i.ClearAsyncActionPromises(),i.IsFlushingBlocked()||n.FlushPendingInstances()),l}_GetPerfRecord(){return this._perfRecord}}}{let dy=function(e,t){return!0};NoActions=dy;const py=self.C3,fy=[];function*my(e,t){return!0}py.EventBlock=class extends py.DefendedBase{constructor(e,t,s){super(),this._eventSheet=e,this._runtime=e.GetRuntime(),this._parent=t,this._scopeParent=null,this._eventStack=this._runtime.GetEventSheetManager().GetEventStack(),this._solModifiers=[],this._solModifiersIncludingParents=[],this._hasGotSolModifiersIncludingParents=!1,this._isSolWriterAfterCnds=!1,this._isTopLevelGroup=!1,this._hasElseBlock=!1,this._isOrBlock=!!s[2],this._isElseBlock=!1,this._triggerParents=null,this._conditions=[],this._actions=[],this._subEvents=[],this._RunActions=dy,this._DebugRunActions=my,this._isGroup=!1,this._isInitiallyActive=!1,this._groupName="",this._isGroupActive=!1,this._containedIncludes=null,this._perfRecord=null,this._sid=s[4],this._displayNumber=s[5],this._eventSheet._RegisterEventByDisplayNumber(this,this._displayNumber),this._debugData=this._runtime.IsDebug()?{isBreakpoint:s[3][0],isBreakable:s[3][1],canRunAllConditionsFast:!1,canRunAllActionsFast:!1,canRunAllSubEventsFast:!1,canRunSelfFast:!1}:null,this.GetEventSheetManager()._RegisterEventBlock(this),3===s[0]&&this._InitGroup(s[1]);let n=0;for(const e of s[6]){const t=py.Condition.Create(this,e,n++);this._conditions.push(t),this._AddSolModifier(t.GetObjectClass())}n=0;for(const e of s[7]){const t=py.Action.Create(this,e,n++);this._actions.push(t)}if(9===s.length){const e=s[8];for(const t of e)this._eventSheet._CreateEvent(t,this,this._subEvents)}this._conditions.length&&(this._isElseBlock=null===this._conditions[0].GetObjectClass()&&this._conditions[0]._GetFunc()===py.Plugins.System.Cnds.Else),0===this._conditions.length&&(this._conditions=fy),0===this._actions.length&&(this._actions=fy),0===this._subEvents.length&&(this._subEvents=fy)}static Create(e,t,s){return py.New(py.EventBlock,e,t,s)}_InitGroup(e){this._isGroup=!0,this._isInitiallyActive=!!e[0],this._isGroupActive=this._isInitiallyActive,this._groupName=e[1].toLowerCase(),this._containedIncludes=[],this.GetEventSheetManager()._RegisterGroup(this),this._runtime.IsDebug()&&(this._perfRecord={type:"group",name:e[1],totalTimeCounter:0,children:[]})}_AddContainedInclude(e){this._containedIncludes.push(e)}_AddContainerSolModifierToList(e,t){for(const s of e.GetContainer().objectTypes())t.includes(s)||t.push(s)}_AddSolModifierToList(e,t){if(e)if(t.includes(e)||t.push(e),e.IsFamily())for(const s of e.GetFamilyMembers())s.IsInContainer()&&this._AddContainerSolModifierToList(s,t);else e.IsInContainer()&&this._AddContainerSolModifierToList(e,t)}_AddSolModifier(e){this._AddSolModifierToList(e,this._solModifiers)}_AddParentSolModifier(e){this._AddSolModifierToList(e,this._solModifiersIncludingParents)}SetAllSolModifiers(){this._solModifiers=this._runtime.GetAllObjectClasses()}_PostInit(e){this._hasElseBlock=!!e,this._IdentifyTopLevelGroup(),this._IdentifyTriggerParents();for(const e of this._conditions)e._PostInit();if(this._actions.length>0){let e=!1;for(const t of this._actions)t._PostInit(),t.HasReturnType()&&(e=!0);e?(this._RunActions=this._RunActions_ReturnValue,this._DebugRunActions=this._DebugRunActions_ReturnValue):(this._RunActions=this._RunActions_Fast,this._DebugRunActions=this._DebugRunActions_Fast)}const t=this._subEvents;for(let e=0,s=t.length;e<s;++e){const n=e<s-1&&t[e+1]instanceof py.EventBlock&&t[e+1].IsElseBlock();t[e]._PostInit(n)}this._debugData&&this._UpdateCanRunFast(),this._perfRecord&&this._GetPerfRecordParent()._GetPerfRecord().children.push(this._perfRecord)}_GetPerfRecord(){return this._perfRecord}_GetPerfRecordParent(){let e=this.GetParent();for(;e;){if(e.IsGroup())return e;e=e.GetParent()}return this._eventSheet}_UpdateCanRunFast(){const e=this._debugData;e.canRunAllConditionsFast=this._conditions.every((e=>e.DebugCanRunFast())),e.canRunAllActionsFast=this._actions.every((e=>e.DebugCanRunFast())),e.canRunAllSubEventsFast=this._subEvents.every((e=>e.DebugCanRunFast())),e.canRunSelfFast=e.canRunAllConditionsFast&&e.canRunAllActionsFast&&e.canRunAllSubEventsFast}_UpdateCanRunFastRecursive(){let e=this;do{e._UpdateCanRunFast(),e=e.GetParent()}while(e)}_IdentifyTopLevelGroup(){if(!this.IsGroup())return;let e=this.GetParent();for(this._isTopLevelGroup=!0;e;){if(!e.IsGroup()){this._isTopLevelGroup=!1;break}e=e.GetParent()}}_IdentifySolModifiersIncludingParents(){const e=this._runtime.GetAllObjectClasses();if(this._solModifiers===e)this._solModifiersIncludingParents=e;else{this._solModifiersIncludingParents=py.cloneArray(this._solModifiers);let e=this.GetParent();for(;e;){for(const t of e._solModifiers)this._AddParentSolModifier(t);e=e.GetParent()}const t=this.GetEventSheetManager();this._solModifiers=t._DeduplicateSolModifierList(this._solModifiers),this._solModifiersIncludingParents=t._DeduplicateSolModifierList(this._solModifiersIncludingParents)}}_IdentifyTriggerParents(){if(!this.HasAnyTriggeredCondition())return;this._triggerParents=[];let e=this.GetParent();for(;e;)this._triggerParents.push(e),e=e.GetParent();this._triggerParents.reverse()}SetSolWriterAfterCnds(){this._isSolWriterAfterCnds=!0,this._parent&&this._parent.SetSolWriterAfterCnds()}IsSolWriterAfterCnds(){return this._isSolWriterAfterCnds}GetSolModifiers(){return this._solModifiers}GetSolModifiersIncludingParents(){return this._hasGotSolModifiersIncludingParents||(this._hasGotSolModifiersIncludingParents=!0,this._IdentifySolModifiersIncludingParents()),this._solModifiersIncludingParents}HasSolModifier(e){return this._solModifiers.includes(e)}GetTriggerParents(){return this._triggerParents}GetEventSheet(){return this._eventSheet}GetEventSheetManager(){return this._eventSheet.GetEventSheetManager()}GetRuntime(){return this._runtime}GetParent(){return this._parent}_SetScopeParent(e){this._scopeParent=e}GetScopeParent(){return this._scopeParent||this._parent}GetDisplayNumber(){return this._displayNumber}IsDebugBreakable(){return this._debugData&&this._debugData.isBreakable}IsDebugBreakpoint(){return this.IsDebugBreakable()&&this._debugData.isBreakpoint}_SetDebugBreakpoint(e){this._debugData.isBreakpoint=!!e,this._UpdateCanRunFastRecursive()}IsGroup(){return this._isGroup}IsTopLevelGroup(){return this._isTopLevelGroup}IsElseBlock(){return this._isElseBlock}HasElseBlock(){return this._hasElseBlock}GetGroupName(){return this._groupName}IsGroupActive(){return this._isGroupActive}ResetInitialActivation(){this.SetGroupActive(this._isInitiallyActive)}SetGroupActive(e){if(e=!!e,!this._isGroup)throw new Error("not a group");if(this._isGroupActive!==e){this._isGroupActive=e;for(const e of this._containedIncludes)e.UpdateActive();if(this._containedIncludes.length){const e=this._runtime.GetCurrentLayout().GetEventSheet();e&&e._UpdateDeepIncludes()}}}GetSID(){return this._sid}IsOrBlock(){return this._isOrBlock}IsTrigger(){return this._conditions.length&&this._conditions[0].IsTrigger()}IsForFunctionBlock(){return this._scopeParent&&this._scopeParent instanceof py.FunctionBlock}HasAnyTriggeredCondition(){return this.IsForFunctionBlock()||this._conditions.some((e=>e.IsTrigger()))}GetConditions(){return this._conditions}GetConditionCount(){return this._conditions.length}GetConditionAt(e){if((e=Math.floor(e))<0||e>=this._conditions.length)throw new RangeError("invalid condition index");return this._conditions[e]}GetConditionByDebugIndex(e){return this.GetConditionAt(e)}IsFirstConditionOfType(e){let t=e.GetIndex();if(0===t)return!0;--t;const s=e.IsSystemOrSingleGlobalCondition()?e.GetFirstObjectParameterObjectClass():e.GetObjectClass();for(;t>=0;--t){const e=this._conditions[t];if(s===e.GetObjectClass()||e.IsSystemOrSingleGlobalCondition()&&e.GetFirstObjectParameterObjectClass()===s)return!1}return!0}GetActions(){return this._actions}GetActionCount(){return this._actions.length}GetActionAt(e){if((e=Math.floor(e))<0||e>=this._actions.length)throw new RangeError("invalid action index");return this._actions[e]}GetActionByDebugIndex(e){e=Math.floor(e);const t=this._actions.find((t=>t.GetDebugIndex()===e));if(!t)throw new RangeError("invalid action debug index");return t}_HasActionIndex(e){return(e=Math.floor(e))>=0&&e<this._actions.length}GetSubEvents(){return this._subEvents}_GetAllLocalVariablesInScope(){return this._subEvents.filter((e=>e instanceof py.EventVariable))}RunPreTrigger(e){e.SetCurrentEvent(this);const t=this._conditions;let s=0===t.length;for(let n=0,i=t.length;n<i;++n){const i=t[n];if(e.SetConditionIndex(n),i.IsLooping())throw new Error("trigger cannot be used as sub-event to a loop");if(i.Run())s=!0;else if(!this._isOrBlock)return!1}return!this._isOrBlock||s}RunOrBlockTrigger(e,t){e.SetCurrentEvent(this),e.SetConditionIndex(t),this._conditions[t].Run()&&(this._RunActions(e,0)&&this._RunSubEvents(e),e.SetLastEventTrue(!0))}*DebugRunPreTrigger(e){e.SetCurrentEvent(this);const t=this._conditions;let s=0===t.length;for(let n=0,i=t.length;n<i;++n){const i=t[n];if(e.SetConditionIndex(n),i.IsLooping())throw new Error("trigger cannot be used as sub-event to a loop");let r;if(r=i.DebugCanRunFast()?i.Run():yield*i.DebugRun(),r)s=!0;else if(!this._isOrBlock)return!1}return!this._isOrBlock||s}*DebugRunOrBlockTrigger(e,t){e.SetCurrentEvent(this),e.SetConditionIndex(t);const s=this._conditions[t];let n;if(n=s.DebugCanRunFast()?s.Run():yield*s.DebugRun(),n){let t;t=this.DebugCanRunActionsFast()?this._RunActions(e,0):yield*this._DebugRunActions(e,0),t&&(this.DebugCanRunSubEventsFast()?this._RunSubEvents():yield*this._DebugRunSubEvents()),e.SetLastEventTrue(!0)}}Run(e){e.SetCurrentEvent(this),this._isElseBlock||e.SetElseBranchRan(!1),this._isOrBlock?this._RunOrBlock(e):this._RunAndBlock(e)}*DebugRun(e){(this.IsDebugBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),e.SetCurrentEvent(this),this._isElseBlock||e.SetElseBranchRan(!1),this._isOrBlock?yield*this._DebugRunOrBlock(e):yield*this._DebugRunAndBlock(e)}_RunOrBlock(e){const t=this._conditions;let s=0===t.length;for(let n=0,i=t.length;n<i;++n){const i=t[n];if(i.IsTrigger())continue;e.SetConditionIndex(n);const r=i.Run();s=s||r}e.SetLastEventTrue(s),s&&(this._RunActions(e,0)&&this._RunSubEvents(e),this._hasElseBlock&&e.SetElseBranchRan(!0))}*_DebugRunOrBlock(e){const t=this._conditions;let s=0===t.length;for(let n=0,i=t.length;n<i;++n){const i=t[n];if(i.IsTrigger())continue;let r;e.SetConditionIndex(n),r=i.DebugCanRunFast()?i.Run():yield*i.DebugRun(),s=s||r}if(e.SetLastEventTrue(s),s){let t;t=this.DebugCanRunActionsFast()?this._RunActions(e,0):yield*this._DebugRunActions(e,0),t&&(this.DebugCanRunSubEventsFast()?this._RunSubEvents():yield*this._DebugRunSubEvents()),this._hasElseBlock&&e.SetElseBranchRan(!0)}}_RunAndBlock(e){const t=this._conditions;for(let s=0,n=t.length;s<n;++s){const n=t[s];if(e.SetConditionIndex(s),!n.Run())return void e.SetLastEventTrue(!1)}e.SetLastEventTrue(!0),this._RunActions(e,0)&&this._RunSubEvents(e),e.GetLastEventTrue()&&this._hasElseBlock&&e.SetElseBranchRan(!0)}*_DebugRunAndBlock(e){const t=this._conditions;for(let s=0,n=t.length;s<n;++s){const n=t[s];let i;if(e.SetConditionIndex(s),i=n.DebugCanRunFast()?n.Run():yield*n.DebugRun(),!i)return void e.SetLastEventTrue(!1)}let s;e.SetLastEventTrue(!0),s=this.DebugCanRunActionsFast()?this._RunActions(e,0):yield*this._DebugRunActions(e,0),s&&(this.DebugCanRunSubEventsFast()?this._RunSubEvents():yield*this._DebugRunSubEvents()),e.GetLastEventTrue()&&this._hasElseBlock&&e.SetElseBranchRan(!0)}_RunActions_Fast(e,t){const s=this._actions;for(let n=t,i=s.length;n<i;++n){const t=s[n];e.SetActionIndex(n),t.Run()}return!0}*_DebugRunActions_Fast(e,t){const s=this._actions;for(let n=t,i=s.length;n<i;++n){const t=s[n];e.SetActionIndex(n),t.DebugCanRunFast()?t.Run():yield*t.DebugRun()}return!0}_RunActions_ReturnValue(e,t){const s=this.GetEventSheetManager(),n=this._actions;for(let i=t,r=n.length;i<r;++i){const t=n[i];e.SetActionIndex(i);const r=t.Run();if(t.CanBailOut()&&!0===r)return!1;t.IsAsync()&&r instanceof Promise&&s.AddAsyncActionPromise(r)}return!0}*_DebugRunActions_ReturnValue(e,t){const s=this.GetEventSheetManager(),n=this._actions;for(let i=t,r=n.length;i<r;++i){const t=n[i];let r;if(e.SetActionIndex(i),r=t.DebugCanRunFast()?t.Run():yield*t.DebugRun(),t.CanBailOut()&&!0===r)return!1;t.IsAsync()&&r instanceof Promise&&s.AddAsyncActionPromise(r)}return!0}_ResumeActionsAndSubEvents(e){this._RunActions(e,e.GetActionIndex())&&this._RunSubEvents()}*_DebugResumeActionsAndSubEvents(e){(yield*this._DebugRunActions(e,e.GetActionIndex()))&&(yield*this._DebugRunSubEvents())}_RunSubEvents(){if(!this._subEvents.length)return;const e=this.IsGroup()&&this._runtime.IsCPUProfiling(),t=e?performance.now():0,s=this._eventStack,n=s.Push(this);this._isSolWriterAfterCnds?this._RunSubEvents_SolWriterAfterCnds(n):this._RunSubEvents_Fast(n),s.Pop(),e&&(this._perfRecord.totalTimeCounter+=performance.now()-t)}_RunSubEvents_SolWriterAfterCnds(e){const t=this._isGroup,s=this._isTopLevelGroup,n=this.GetEventSheetManager(),i=this._subEvents;for(let r=0,a=i.length,o=a-1;r<a;++r){const a=i[r],l=a.GetSolModifiers(),c=!s||!t&&r<o;c&&n.PushCopySol(l),a.Run(e),c?n.PopSol(l):n.ClearSol(l)}}_RunSubEvents_Fast(e){const t=this._subEvents;for(let s=0,n=t.length;s<n;++s)t[s].Run(e)}*_DebugRunSubEvents(){if(!this._subEvents.length)return;const e=this._eventStack,t=e.Push(this);this._isSolWriterAfterCnds?yield*this._DebugRunSubEvents_SolWriterAfterCnds(t):yield*this._DebugRunSubEvents_Fast(t),e.Pop()}*_DebugRunSubEvents_SolWriterAfterCnds(e){const t=this._isGroup,s=this._isTopLevelGroup,n=this.GetEventSheetManager(),i=this._subEvents;for(let r=0,a=i.length,o=a-1;r<a;++r){const a=i[r],l=a.GetSolModifiers(),c=!s||!t&&r<o;c&&n.PushCopySol(l),yield*a.DebugRun(e),c?n.PopSol(l):n.ClearSol(l)}}*_DebugRunSubEvents_Fast(e){const t=this._subEvents;for(let s=0,n=t.length;s<n;++s)yield*t[s].DebugRun(e)}Retrigger(e,t){t.ResetQuick();const s=this._conditions;if(!this.IsOrBlock())for(let n=e.GetConditionIndex()+1,i=s.length;n<i;++n){const e=s[n];if(t.SetConditionIndex(n),!e.Run())return!1}return this._RunActions(t,0)&&this._RunSubEvents(t),!0}*DebugRetrigger(e,t){t.ResetQuick();const s=this._conditions;if(!this.IsOrBlock())for(let n=e.GetConditionIndex()+1,i=s.length;n<i;++n){const e=s[n];let i;if(t.SetConditionIndex(n),i=e.DebugCanRunFast()?e.Run():yield*e.DebugRun(),!i)return!1}let n;return n=this.DebugCanRunActionsFast()?this._RunActions(t,0):yield*this._DebugRunActions(t,0),n&&(this.DebugCanRunSubEventsFast()?this._RunSubEvents():yield*this._DebugRunSubEvents()),!0}DebugCanRunFast(){return!this.IsDebugBreakpoint()&&!this._runtime.DebugBreakNext()&&this._debugData.canRunSelfFast}DebugCanRunActionsFast(){return!this._runtime.DebugBreakNext()&&this._debugData.canRunAllActionsFast}DebugCanRunSubEventsFast(){return!this._runtime.DebugBreakNext()&&this._debugData.canRunAllSubEventsFast}_CheckParentsOKToRun(e){if(this.GetParent()){const t=this.GetTriggerParents();for(let s=0,n=t.length;s<n;++s)if(!t[s].RunPreTrigger(e))return!1}return!0}*_DebugCheckParentsOKToRun(e){if(this.GetParent()){const t=this.GetTriggerParents();for(let s=0,n=t.length;s<n;++s)if(!(yield*t[s].DebugRunPreTrigger(e)))return!1}return!0}_EvaluateFunctionCallParameters(e,t,s){if(t.length>0)if(s){const s=t.map((e=>e.Get(0)));e.GetLocalVarStack().Push(),this._scopeParent.SetFunctionParameters(s)}else this._scopeParent.EvaluateFunctionParameters(t);else s&&e.GetLocalVarStack().Push()}RunAsFunctionCall(e,t,s,n){let i,r;const a=e.length>0;let o=null;const l=this._runtime,c=this._eventStack,h=l.GetEventSheetManager(),_=this._scopeParent,u=_.IsAsync(),d=h._IncTriggerDepth()>1;if(this._EvaluateFunctionCallParameters(h,t,d),a&&(s?h.PushCopySol(e):h.PushCleanSol(e)),null!==n){if(n.copyFromObjectClass){const e=s?n.copyFromObjectClass.GetCurrentSol():n.copyFromObjectClass.GetSolStack().GetOneBelowCurrentSol(),t=n.copyToObjectClass.GetCurrentSol();t.SetArrayPicked(e.GetInstances()),t.ClearElseInstances(),s||n.copyToObjectClass.ApplySolToContainer()}else if(n.pickObjectClass){const e=n.pickObjectClass.GetCurrentSol();e.SetArrayPicked(n.pickInstances),e.ClearElseInstances()}n.pushCleanSolDynamic&&(o=h.PushCleanSolDynamic(e))}const p=c.Push(this);return s&&p.SetDynamicSolModifiers(e),this._CheckParentsOKToRun(p)&&(p.SetCurrentEvent(this),u&&([r,i]=_.StartAsyncFunctionCall()),this._RunAndBlock(p),u&&_.MaybeFinishAsyncFunctionCall(r)),c.Pop(),d&&h.GetLocalVarStack().Pop(),null!==o&&h.PopSol(o),a&&h.PopSol(e),h._DecTriggerDepth(),i}*DebugRunAsFunctionCall(e,t,s,n){let i,r;(this.IsDebugBreakpoint()||this._runtime.DebugBreakNext())&&(yield this);const a=e.length>0;let o=null;const l=this._runtime,c=this._eventStack,h=l.GetEventSheetManager(),_=this._scopeParent,u=_.IsAsync(),d=h._IncTriggerDepth()>1;if(this._EvaluateFunctionCallParameters(h,t,d),a&&(s?h.PushCopySol(e):h.PushCleanSol(e)),null!==n){if(n.copyFromObjectClass){const e=s?n.copyFromObjectClass.GetCurrentSol():n.copyFromObjectClass.GetSolStack().GetOneBelowCurrentSol(),t=n.copyToObjectClass.GetCurrentSol();t.SetArrayPicked(e.GetInstances()),t.ClearElseInstances(),s||n.copyToObjectClass.ApplySolToContainer()}else if(n.pickObjectClass){const e=n.pickObjectClass.GetCurrentSol();e.SetArrayPicked(n.pickInstances),e.ClearElseInstances()}n.pushCleanSolDynamic&&(o=h.PushCleanSolDynamic(e))}const p=c.Push(this);return s&&p.SetDynamicSolModifiers(e),(yield*this._DebugCheckParentsOKToRun(p))&&(p.SetCurrentEvent(this),u&&([r,i]=_.StartAsyncFunctionCall()),yield*this._DebugRunAndBlock(p),u&&_.MaybeFinishAsyncFunctionCall(r)),c.Pop(),d&&h.GetLocalVarStack().Pop(),null!==o&&h.PopSol(o),a&&h.PopSol(e),h._DecTriggerDepth(),i}RunAsMappedFunctionCall(e,t){const s=this.GetSolModifiersIncludingParents(),n=s.length>0,i=this._runtime,r=this._eventStack,a=i.GetEventSheetManager(),o=a._IncTriggerDepth()>1;o&&a.GetLocalVarStack().Push(),this._scopeParent.SetFunctionParameters(e),n&&(t?a.PushCopySol(s):a.PushCleanSol(s));const l=r.Push(this);this._CheckParentsOKToRun(l)&&(l.SetCurrentEvent(this),this._RunAndBlock(l)),r.Pop(),o&&a.GetLocalVarStack().Pop(),n&&a.PopSol(s),a._DecTriggerDepth()}*DebugRunAsMappedFunctionCall(e,t){(this.IsDebugBreakpoint()||this._runtime.DebugBreakNext())&&(yield this);const s=this.GetSolModifiersIncludingParents(),n=s.length>0,i=this._runtime,r=this._eventStack,a=i.GetEventSheetManager(),o=a._IncTriggerDepth()>1;o&&a.GetLocalVarStack().Push(),this._scopeParent.SetFunctionParameters(e),n&&(t?a.PushCopySol(s):a.PushCleanSol(s));const l=r.Push(this);(yield*this._DebugCheckParentsOKToRun(l))&&(l.SetCurrentEvent(this),yield*this._DebugRunAndBlock(l)),r.Pop(),o&&a.GetLocalVarStack().Pop(),n&&a.PopSol(s),a._DecTriggerDepth()}RunAsExpressionFunctionCall(e,t,s,n,...i){let r,a;const o=e.length>0,l=this._runtime,c=this._eventStack,h=l.GetEventSheetManager(),_=this._scopeParent,u=_.IsAsync(),d=h._IncTriggerDepth()>1;d&&h.GetLocalVarStack().Push(),i.length>0&&this._scopeParent.SetFunctionParameters(i),o&&(t?h.PushCopySol(e):h.PushCleanSol(e));const p=c.Push(this);return p.InitCallFunctionExpression(s,n),c.PushExpFunc(p),l.SetDebuggingEnabled(!1),this._CheckParentsOKToRun(p)&&(p.SetCurrentEvent(this),u&&([a,r]=_.StartAsyncFunctionCall()),this._RunAndBlock(p),u&&_.MaybeFinishAsyncFunctionCall(a)),l.SetDebuggingEnabled(!0),c.Pop(),c.PopExpFunc(),d&&h.GetLocalVarStack().Pop(),o&&h.PopSol(e),h._DecTriggerDepth(),r||p.GetFunctionReturnValue()}}}{const gy=self.C3,Iy=[];let Sy=!1;gy.EventScript=class extends gy.DefendedBase{constructor(e,t,s){super();const n=e.GetRuntime(),i=e.GetEventSheetManager();this._eventSheet=e,this._eventSheetManager=i,this._runtime=e.GetRuntime(),this._parent=t;const r=n.GetObjectReference(s[1]);this._func=r,this._displayNumber=s[2],this._eventSheet._RegisterEventByDisplayNumber(this,this._displayNumber),this._debugData=n.IsDebug()?{isBreakpoint:s[3][0],isBreakable:s[3][1]}:null}static Create(e,t,s){return gy.New(gy.EventScript,e,t,s)}_PostInit(){const e=this._func,t=this._runtime.GetEventSheetManager()._GetLocalVariablesScriptInterface(this);this._func=e.bind(null,this._runtime.GetIRuntime(),t)}GetParent(){return this._parent}GetScopeParent(){return this._parent}GetEventSheet(){return this._eventSheet}GetDisplayNumber(){return this._displayNumber}IsDebugBreakable(){return this._debugData&&this._debugData.isBreakable}IsDebugBreakpoint(){return this.IsDebugBreakable()&&this._debugData.isBreakpoint}_SetDebugBreakpoint(e){this._debugData.isBreakpoint=!!e}IsElseBlock(){return!1}GetSolModifiers(){return Iy}GetSolModifiersIncludingParents(){return this._parent?this._parent.GetSolModifiersIncludingParents():Iy}Run(e){e.SetCurrentEvent(this),this._eventSheetManager.AddAsyncActionPromise(this._RunUserScript())}async _RunUserScript(){try{await this._func()}catch(e){console.error(`Unhandled exception running script %c${this.GetEventSheet().GetName()}, event ${this.GetDisplayNumber()}:`,"font-size: 1.2em; font-weight: bold;",e),self.C3Debugger&&self.C3Debugger._SetLastErrorScript(this),Sy||(console.info("%cTip:%c run this to highlight in Construct the last script that had an error: %cgoToLastErrorScript()","font-weight: bold; text-decoration: underline","","font-weight: bold"),Sy=!0)}}*DebugRun(e){e.SetCurrentEvent(this),(this.IsDebugBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this.Run(e)}DebugCanRunFast(){return!this.IsDebugBreakpoint()&&!this._runtime.DebugBreakNext()}static HadUserScriptException(){return Sy}static SetHadUserScriptException(){Sy=!0}}}{const yy=self.C3,by=self.assert;yy.FunctionBlock=class extends yy.DefendedBase{constructor(e,t,s){super(),this._eventSheet=e,this._runtime=e.GetRuntime(),this._parent=t,this._functionType=0,this._functionName="",this._returnType=0,this._functionParameters=[],this._isEnabled=!0,this._aceName="",this._objectClass=null,this._hasOverrides=!1,this._innerLocalVariables=[],this._isCopyPicked=!1,this._isAsync=!1,this._nextAsyncId=0,this._currentAsyncId=-1,this._asyncMap=new Map,this._eventBlock=yy.EventBlock.Create(e,t,s),this._eventBlock._SetScopeParent(this)}InitFunctionBlock(e){this._functionType=0,this._functionName=e[0],this._returnType=e[1],this._functionParameters=e[2].map((e=>yy.EventVariable.Create(this._eventSheet,this,e))),this._isEnabled=e[3],this._isAsync=e[4],this._isCopyPicked=e[5]}InitCustomACEBlock(e){this._functionType=1,this._aceName=e[1],this._objectClass=this._runtime.GetObjectClassByIndex(e[2]),this._eventBlock._AddSolModifier(this._objectClass),this._functionName=this._objectClass.GetName()+"."+this._aceName,this._returnType=e[3],this._functionParameters=e[4].map((e=>yy.EventVariable.Create(this._eventSheet,this,e))),this._isEnabled=e[5],this._isAsync=e[6],this._isCopyPicked=e[7],this._objectClass.AddCustomAction(this)}static CreateFunctionBlock(e,t,s){const n=yy.New(yy.FunctionBlock,e,t,s),i=s[1];return n.InitFunctionBlock(i),n}static CreateCustomACEBlock(e,t,s){const n=yy.New(yy.FunctionBlock,e,t,s),i=s[1];return n.InitCustomACEBlock(i),n}_CheckOverrideState(){if(this._objectClass&&this._objectClass.IsFamily())for(const e of this._objectClass.GetFamilyMembers())if(e.HasOwnCustomActionByName(this._aceName)){this._hasOverrides=!0;break}}_PostInit(){for(const e of this._functionParameters)e._PostInit();this._eventBlock._PostInit(!1)}GetFunctionType(){return this._functionType}_GetAllLocalVariablesInScope(){return this._functionParameters}GetFunctionParameters(){return this._functionParameters}GetFunctionParameterCount(){return this._functionParameters.length}_RegisterLocalVariable(e){this._innerLocalVariables.push(e)}_GetAllInnerLocalVariables(){return this._innerLocalVariables}EvaluateFunctionParameters(e){const t=this._functionParameters;for(let s=0,n=t.length;s<n;++s)t[s].SetValue(e[s].Get(0))}SetFunctionParameters(e){const t=this._functionParameters;for(let s=0,n=t.length;s<n;++s)t[s].SetValue(e[s])}CaptureFunctionParameters(){return this._functionParameters.map((e=>e.GetValue()))}GetParent(){return this._parent}GetScopeParent(){return this._parent}GetFunctionName(){return this._functionName}GetACEName(){return this._aceName}HasCustomACEOverrides(){return this._hasOverrides}GetReturnType(){return this._returnType}GetObjectClass(){return this._objectClass}IsEnabled(){return this._isEnabled}GetDefaultReturnValue(){switch(this._returnType){case 0:return null;case 2:return"";default:return 0}}GetEventBlock(){return this._eventBlock}IsCopyPicked(){return this._isCopyPicked}IsAsync(){return this._isAsync}StartAsyncFunctionCall(){const e=this._nextAsyncId++;let t;this._currentAsyncId=e;const s=new Promise((e=>t=e));return this._asyncMap.set(e,{resolve:t,pauseCount:0}),[e,s]}MaybeFinishAsyncFunctionCall(e){const t=this._asyncMap.get(e);0===t.pauseCount&&(t.resolve(),this._asyncMap.delete(e)),this._currentAsyncId=-1}PauseCurrentAsyncFunction(){return this._asyncMap.get(this._currentAsyncId).pauseCount++,this._currentAsyncId}ResumeAsyncFunction(e){this._currentAsyncId=e,this._asyncMap.get(e).pauseCount--}RunAsFamilyCustomActionWithOverrides(e,t){const s=new Map,n=[];for(const e of this._objectClass.GetCurrentSol().GetInstances()){const t=e.GetObjectClass();if(t.HasOwnCustomActionByName(this._aceName)){const n=s.get(t);Array.isArray(n)?n.push(e):s.set(t,[e])}else n.push(e)}if(n.length>0&&this._eventBlock.RunAsFunctionCall(e,t,this._isCopyPicked,{pickObjectClass:this._objectClass,pickInstances:n}),s.size>0)for(const[n,i]of s){const s=n.GetOwnCustomActionByName(this._aceName).GetEventBlock(),r=[...new Set([...e,...s.GetSolModifiers()])];s.RunAsFunctionCall(r,t,this._isCopyPicked,{pickObjectClass:n,pickInstances:i})}}*DebugRunAsFamilyCustomActionWithOverrides(e,t){const s=new Map,n=[];for(const e of this._objectClass.GetCurrentSol().GetInstances()){const t=e.GetObjectClass();if(t.HasOwnCustomActionByName(this._aceName)){const n=s.get(t);Array.isArray(n)?n.push(e):s.set(t,[e])}else n.push(e)}if(n.length>0&&(yield*this._eventBlock.DebugRunAsFunctionCall(e,t,this._isCopyPicked,{pickObjectClass:this._objectClass,pickInstances:n})),s.size>0)for(const[n,i]of s){const s=n.GetOwnCustomActionByName(this._aceName).GetEventBlock(),r=[...new Set([...e,...s.GetSolModifiers()])];yield*s.DebugRunAsFunctionCall(r,t,this._isCopyPicked,{pickObjectClass:n,pickInstances:i})}}}}{const Gy=self.C3,vy=[];Gy.EventVariable=class extends Gy.DefendedBase{constructor(e,t,s){super();const n=e.GetEventSheetManager();this._eventSheet=e,this._eventSheetManager=n,this._runtime=e.GetRuntime(),this._parent=t,this._localVarStack=n.GetLocalVarStack(),this._name=s[1],this._type=s[2],this._initialValue=s[3],this._isStatic=!!s[4],this._isConstant=!!s[5],this._isFunctionParameter=t instanceof Gy.FunctionBlock,this._sid=s[6],this._jsPropName=this._runtime.GetJsPropName(s[8]),this._scriptSetter=e=>this.SetValue(e),this._scriptGetter=()=>this.GetValue(),this._hasSingleValue=!this._parent||this._isStatic||this._isConstant,this._value=this._initialValue,this._localIndex=-1,this.IsBoolean()&&(this._value=this._value?1:0),!this.IsLocal()||this.IsStatic()||this.IsConstant()||(this._localIndex=n._GetNextLocalVarIndex(this)),n._RegisterEventVariable(this)}static Create(e,t,s){return Gy.New(Gy.EventVariable,e,t,s)}_PostInit(){if(this.IsLocal()&&!this.IsStatic()&&!this.IsConstant()&&!this.IsFunctionParameter()){const e=this._eventSheetManager.FindFirstFunctionBlockParent(this);e&&e._RegisterLocalVariable(this)}}GetName(){return this._name}GetJsPropName(){return this._jsPropName}GetParent(){return this._parent}GetScopeParent(){return this.GetParent()}IsGlobal(){return!this.GetParent()}IsLocal(){return!this.IsGlobal()}IsFunctionParameter(){return this._isFunctionParameter}IsStatic(){return this._isStatic}IsConstant(){return this._isConstant}IsNumber(){return 0===this._type}IsString(){return 1===this._type}IsBoolean(){return 2===this._type}IsElseBlock(){return!1}GetSID(){return this._sid}GetInitialValue(){return this._initialValue}GetSolModifiers(){return vy}Run(e){!this.IsLocal()||this.IsStatic()||this.IsConstant()||this.SetValue(this.GetInitialValue())}DebugCanRunFast(){return!0}*DebugRun(e){this.Run(e)}SetValue(e){this.IsNumber()?"number"!=typeof e&&(e=parseFloat(e)):this.IsString()?"string"!=typeof e&&(e=e.toString()):this.IsBoolean()&&(e=e?1:0),this._hasSingleValue?this._value=e:this._localVarStack.GetCurrent()[this._localIndex]=e}GetValue(){return this._hasSingleValue?this._value:this._localVarStack.GetCurrent()[this._localIndex]}GetTypedValue(){let e=this.GetValue();return this.IsBoolean()&&(e=!!e),e}ResetToInitialValue(){this._value=this._initialValue}_GetScriptInterfaceDescriptor(){return{configurable:!1,enumerable:!0,get:this._scriptGetter,set:this._scriptSetter}}}}{const xy=self.C3,Ty=self.assert,Cy=[];xy.EventInclude=class extends xy.DefendedBase{constructor(e,t,s){super();const n=e.GetEventSheetManager();this._eventSheet=e,this._eventSheetManager=n,this._runtime=e.GetRuntime(),this._parent=t,this._includeSheet=null,this._includeSheetName=s[1],this._isActive=!0}static Create(e,t,s){return xy.New(xy.EventInclude,e,t,s)}_PostInit(){this._includeSheet=this._eventSheetManager.GetEventSheetByName(this._includeSheetName),this._eventSheet._AddShallowInclude(this);let e=this.GetParent();for(;e;)e instanceof xy.EventBlock&&e.IsGroup()&&e._AddContainedInclude(this),e=e.GetParent();this.UpdateActive(),this._runtime.IsDebug()&&this._eventSheet._GetPerfRecord().children.push(this._includeSheet._GetPerfRecord())}GetParent(){return this._parent}GetSolModifiers(){return Cy}GetIncludeSheet(){return this._includeSheet}Run(e){const t=!!this.GetParent(),s=this._runtime.GetAllObjectClasses();t&&this._eventSheetManager.PushCleanSol(s),this._includeSheet.Run(),t&&this._eventSheetManager.PopSol(s)}*DebugRun(e){const t=!!this.GetParent(),s=this._runtime.GetAllObjectClasses();t&&this._eventSheetManager.PushCleanSol(s),yield*this._includeSheet.DebugRun(),t&&this._eventSheetManager.PopSol(s)}DebugCanRunFast(){return!1}IsActive(){return this._isActive}UpdateActive(){let e=this.GetParent();for(;e;){if(e instanceof xy.EventBlock&&e.IsGroup()&&!e.IsGroupActive())return void(this._isActive=!1);e=e.GetParent()}this._isActive=!0}}}{let wy=function(e,t){return e>=t?e%t:e<0?(e<=-t&&(e%=t),e<0&&(e+=t),e):e};WrapIndex=wy;const Py=self.C3,Ay=self.assert;Py.ExpNode=class extends Py.DefendedBase{constructor(e){super(),this._owner=e,this._runtime=e.GetRuntime()}_PostInit(){}static CreateNode(e,t){const s=t[0],n=[ky,Ey,My,Ly,Ry,Dy];return Py.New(n[s],e,t)}};class Ry extends Py.ExpNode{constructor(e,t){super(e),this._systemPlugin=this._runtime.GetSystemPlugin(),this._func=this._runtime.GetObjectReference(t[1]),this._func!==Py.Plugins.System.Exps.random&&this._func!==Py.Plugins.System.Exps.choose||this._owner.SetVariesPerInstance()}GetBoundMethod(){return this._systemPlugin._GetBoundACEMethod(this._func,this._systemPlugin)}}class Dy extends Py.ExpNode{constructor(e,t){super(e),this._functionBlock=null,this._functionName=t[1],this._owner.SetVariesPerInstance()}_PostInit(){const e=this._runtime.GetEventSheetManager();this._functionBlock=e.GetFunctionBlockByName(this._functionName),this._functionName=null;const t=this._owner.GetEventBlock(),s=this._functionBlock.GetEventBlock();this._combinedSolModifiers=[...new Set([...t.GetSolModifiersIncludingParents(),...s.GetSolModifiersIncludingParents()])],this._combinedSolModifiers=e._DeduplicateSolModifierList(this._combinedSolModifiers)}GetBoundMethod(){const e=this._functionBlock;if(e.IsEnabled()){const t=e.GetEventBlock();return Py.EventBlock.prototype.RunAsExpressionFunctionCall.bind(t,this._combinedSolModifiers,e.IsCopyPicked(),e.GetReturnType(),e.GetDefaultReturnValue())}{const t=e.GetDefaultReturnValue();return()=>t}}}class Ey extends Py.ExpNode{constructor(e,t){super(e),this._objectClass=this._runtime.GetObjectClassByIndex(t[1]),this._func=this._runtime.GetObjectReference(t[2]),this._returnsString=!!t[3],this._eventStack=this._runtime.GetEventSheetManager().GetEventStack(),this._owner._MaybeVaryFor(this._objectClass)}GetBoundMethod(){return this._objectClass.GetPlugin()._GetBoundACEMethod(this._func,this._objectClass.GetSingleGlobalInstance().GetSdkInstance())}ExpObject(...e){const t=this._objectClass,s=t.GetCurrentSol().GetExpressionInstances(),n=s.length;if(0===n)return this._returnsString?"":0;const i=wy(this._owner.GetSolIndex(),n);return this._eventStack.GetCurrentStackFrame().SetExpressionObjectClass(t),this._func.apply(s[i].GetSdkInstance(),e)}ExpObject_InstExpr(e,...t){const s=this._objectClass,n=s.GetInstances(),i=n.length;if(0===i||"number"!=typeof e)return this._returnsString?"":0;const r=wy(e,i);return this._eventStack.GetCurrentStackFrame().SetExpressionObjectClass(s),this._func.apply(n[r].GetSdkInstance(),t)}}class My extends Py.ExpNode{constructor(e,t){super(e),this._objectClass=this._runtime.GetObjectClassByIndex(t[1]),this._varIndex=t[3],this._returnsString=!!t[2],this._owner._MaybeVaryFor(this._objectClass)}ExpInstVar(){const e=this._objectClass.GetCurrentSol().GetExpressionInstances(),t=e.length;return 0===t?this._returnsString?"":0:e[wy(this._owner.GetSolIndex(),t)]._GetInstanceVariableValueUnchecked(this._varIndex)}ExpInstVar_Family(){const e=this._objectClass,t=e.GetCurrentSol().GetExpressionInstances(),s=t.length;if(0===s)return this._returnsString?"":0;const n=t[wy(this._owner.GetSolIndex(),s)],i=n.GetObjectClass().GetFamilyInstanceVariableOffset(e.GetFamilyIndex());return n._GetInstanceVariableValueUnchecked(this._varIndex+i)}ExpInstVar_InstExpr(e){const t=this._objectClass,s=t.GetInstances(),n=s.length;if(0===n||"number"!=typeof e)return this._returnsString?"":0;const i=s[wy(e,n)];let r=0;return t.IsFamily()&&(r=i.GetObjectClass().GetFamilyInstanceVariableOffset(t.GetFamilyIndex())),i._GetInstanceVariableValueUnchecked(this._varIndex+r)}}class ky extends Py.ExpNode{constructor(e,t){super(e),this._objectClass=this._runtime.GetObjectClassByIndex(t[1]),this._behaviorType=this._objectClass.GetBehaviorTypeByName(t[2]),this._behaviorIndex=this._objectClass.GetBehaviorIndexByName(t[2]),this._func=this._runtime.GetObjectReference(t[3]),this._returnsString=!!t[4],this._eventStack=this._runtime.GetEventSheetManager().GetEventStack(),this._owner._MaybeVaryFor(this._objectClass)}ExpBehavior(...e){const t=this._objectClass,s=t.GetCurrentSol().GetExpressionInstances(),n=s.length;if(0===n)return this._returnsString?"":0;const i=wy(this._owner.GetSolIndex(),n);this._eventStack.GetCurrentStackFrame().SetExpressionObjectClass(t);const r=s[i];let a=0;return t.IsFamily()&&(a=r.GetObjectClass().GetFamilyBehaviorOffset(t.GetFamilyIndex())),this._func.apply(r.GetBehaviorInstances()[this._behaviorIndex+a].GetSdkInstance(),e)}ExpBehavior_InstExpr(e,...t){const s=this._objectClass,n=s.GetInstances(),i=n.length;if(0===i||"number"!=typeof e)return this._returnsString?"":0;const r=wy(e,i);this._eventStack.GetCurrentStackFrame().SetExpressionObjectClass(s);const a=n[r];let o=0;return s.IsFamily()&&(o=a.GetObjectClass().GetFamilyBehaviorOffset(s.GetFamilyIndex())),this._func.apply(a.GetBehaviorInstances()[this._behaviorIndex+o].GetSdkInstance(),t)}}class Ly extends Py.ExpNode{constructor(e,t){super(e),this._eventVar=null,this._eventVarSid=t[1]}_PostInit(){this._eventVar=this._runtime.GetEventSheetManager().GetEventVariableBySID(this._eventVarSid)}GetVar(){return this._eventVar}}}{let Fy=function(e){const t=self.C3_ExpressionFuncs[e];if(!t)throw new Error("invalid expression number");return t};GetExpressionFunc=Fy;const By=self.C3,Oy=self.assert;By.Parameter=class extends By.DefendedBase{constructor(e,t,s){super(),this._owner=e,this._index=s,this._type=t,this.Get=null,this._variesPerInstance=!1,this._isConstant=!1}static Create(e,t,s){const n=t[0],i=[Ny,Wy,Yy,jy,Hy,Vy,zy,Ny,jy,jy,qy,Jy,Yy,$y,Wy,Xy,Uy,Ky,Zy,Qy,eb,tb];return By.New(i[n],e,n,s,t)}_PostInit(){}SetVariesPerInstance(){this._variesPerInstance=!0}_MaybeVaryFor(e){this._variesPerInstance||e&&(e.GetPlugin().IsSingleGlobal()||(this._variesPerInstance=!0))}VariesPerInstance(){return this._variesPerInstance}GetIndex(){return this._index}GetRuntime(){return this._owner.GetRuntime()}GetEventBlock(){return this._owner.GetEventBlock()}IsConstant(){return this._isConstant}IsObjectParameter(){return 4===this._type}};class Ny extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._solIndex=0;const i=n[1];this._expressionNumber=i[0],this._numberedNodes=[],this._expressionFunc=null;for(let e=1,t=i.length;e<t;++e)this._numberedNodes.push(By.ExpNode.CreateNode(this,i[e]));this._numberedNodes.length?this.Get=this.GetExpression:(this.Get=Fy(this._expressionNumber),this._isConstant=!0)}_GetNode(e){if(e<0||e>=this._numberedNodes.length)throw new RangeError("invalid numbered node");return this._numberedNodes[e]}_PostInit(){for(const e of this._numberedNodes)e._PostInit();const e=Fy(this._expressionNumber);this._numberedNodes.length?this._expressionFunc=e(this):this._expressionFunc=e}GetSolIndex(){return this._solIndex}GetExpression(e){return this._solIndex=e,this._expressionFunc()}}class Wy extends Ny{constructor(e,t,s,n){super(e,t,s,n),this.Get=this.GetStringExpression,14===t&&(this.GetEventBlock().SetAllSolModifiers(),this._owner instanceof By.Action&&this.GetEventBlock().SetSolWriterAfterCnds())}GetStringExpression(e){this._solIndex=e;const t=this._expressionFunc();return"string"==typeof t?t:""}_GetFastTriggerValue(){return Fy(this._expressionNumber)()}}class Vy extends Ny{constructor(e,t,s,n){super(e,t,s,n),e.GetImplementationSdkVersion()>=2?this.Get=this.GetILayer:this.Get=this.GetLayer,this._isConstant=!1}GetLayer(e){this._solIndex=e;const t=this._expressionFunc();return this.GetRuntime().GetCurrentLayout().GetLayer(t)}GetILayer(e){const t=this.GetLayer(e);return t?t.GetILayer():null}}class jy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._combo=n[1],this.Get=this.GetCombo,this._isConstant=!0}GetCombo(){return this._combo}}class Uy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._bool=n[1],this.Get=this.GetBoolean,this._isConstant=!0}GetBoolean(){return this._bool}}class Hy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._objectClass=this.GetRuntime().GetObjectClassByIndex(n[1]),e.GetImplementationSdkVersion()>=2?this.Get=this.GetIObjectClass:this.Get=this.GetObjectClass;const i=this.GetEventBlock();i._AddSolModifier(this._objectClass),this._owner instanceof By.Action?i.SetSolWriterAfterCnds():i.GetParent()&&i.GetParent().SetSolWriterAfterCnds(),this._isConstant=!0}GetObjectClass(){return this._objectClass}GetIObjectClass(){return this._objectClass?this._objectClass.GetIObjectClass():null}}class zy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._layout=this.GetRuntime().GetLayoutManager().GetLayoutByName(n[1]),e.GetImplementationSdkVersion()>=2?this.Get=this.GetILayout:this.Get=this.GetLayout,this._isConstant=!0}GetLayout(){return this._layout}GetILayout(){return this._layout?this._layout.GetILayout():null}}class Xy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._timeline=this.GetRuntime().GetTimelineManager().GetTimelineByName(n[1]),e.GetImplementationSdkVersion()>=2?this.Get=this.GetITimelineState:this.Get=this.GetTimeline,this._isConstant=!0}GetTimeline(){return this._timeline}GetITimelineState(){return this._timeline?this._timeline.GetITimelineState():null}}class Yy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._fileInfo=n[1],this.Get=this.GetFile,this._isConstant=!0}GetFile(){return this._fileInfo}}class qy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._instVarIndex=n[1];const i=this._owner.GetObjectClass();this._owner instanceof By.Condition&&this._owner.IsStatic()?(this.Get=this.GetInstanceVariable,this._isConstant=!0):i&&i.IsFamily()?(this.Get=this.GetFamilyInstanceVariable,this.SetVariesPerInstance()):(this.Get=this.GetInstanceVariable,this._isConstant=!0)}GetInstanceVariable(){return this._instVarIndex}GetFamilyInstanceVariable(e){e=e||0;const t=this._owner.GetObjectClass(),s=t.GetCurrentSol(),n=s.GetInstances();let i=null;if(n.length)i=n[e%n.length].GetObjectClass();else if(s.HasAnyElseInstances()){const t=s.GetElseInstances();i=t[e%t.length].GetObjectClass()}else{if(!(t.GetInstanceCount()>0))return 0;{const s=t.GetInstances();i=s[e%s.length].GetObjectClass()}}return this._instVarIndex+i.GetFamilyInstanceVariableOffset(t.GetFamilyIndex())}}class Jy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._eventVarSid=n[1],this._eventVar=null,e.GetImplementationSdkVersion()>=2?this.Get=this.GetIEventVariable:this.Get=this.GetEventVariable,this._isConstant=!0}_PostInit(){this._eventVar=this.GetRuntime().GetEventSheetManager().GetEventVariableBySID(this._eventVarSid)}GetEventVariable(){return this._eventVar}GetIEventVariable(){return null}}class Ky extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._functionBlockName=n[1],this._functionBlock=null,e.GetImplementationSdkVersion()>=2?this.Get=this.GetIFunction:this.Get=this.GetFunction,this._isConstant=!0}_PostInit(){this._functionBlock=this.GetRuntime().GetEventSheetManager().GetFunctionBlockByName(this._functionBlockName),this._functionBlockName=null}GetFunction(){return this._functionBlock}GetIFunction(){return null}}class $y extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._subParams=[],this._variadicRet=[],this._isConstant=!0;for(let e=1,t=n.length;e<t;++e){const t=By.Parameter.Create(this._owner,n[e],0);this._subParams.push(t),this._variadicRet.push(0),t.IsConstant()||(this._isConstant=!1)}this.Get=this.GetVariadic}_PostInit(){for(const e of this._subParams)e._PostInit()}GetVariadic(){const e=this._subParams,t=this._variadicRet;for(let s=0,n=e.length;s<n;++s)t[s]=e[s].Get(0);return t}}class Zy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._easeIndex=n[1],this.Get=this.GetEase,this._isConstant=!0}GetEase(){return this._easeIndex}}class Qy extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._brushIndex=n[1],this.Get=this.GetTilemapBrush,this._isConstant=!0}GetTilemapBrush(){return this._brushIndex}}class eb extends Ny{constructor(e,t,s,n){super(e,t,s,n),this.Get=this.GetTemplateName,this._isConstant=!1}GetTemplateName(){return this._expressionFunc()}}class tb extends By.Parameter{constructor(e,t,s,n){super(e,t,s),this._flowchartDataItem=this.GetRuntime().GetFlowchartManager().GetFlowchartDataItemByName(n[1]),this.Get=this.GetFlowchartName,this._isConstant=!0}GetFlowchartName(){return this._flowchartDataItem.GetName()}}}{let sb=function(e,t){for(let s=0,n=e.length;s<n;++s)t[s]=e[s].Get(0)};EvalParams=sb;const nb=self.C3,ib=self.assert,rb=[],ab=function(){};nb.Condition=class extends nb.DefendedBase{constructor(e,t,s){if(super(),this._eventBlock=e,this._runtime=e.GetRuntime(),this._index=s,this._func=this._runtime.GetObjectReference(t[1]),this._isTrigger=t[3]>0,this._isFastTrigger=2===t[3],this._isLooping=!!t[4],this._isInverted=!!t[5],this._isStatic=!!t[6],this._sid=t[7],this._isInOrBlock=this._eventBlock.IsOrBlock(),this._objectClass=null,this._behaviorType=null,this._behaviorIndex=-1,this._systemPlugin=null,this.Run=ab,this.DebugRun=ab,this._parameters=[],this._results=[],this._anyParamVariesPerInstance=!1,this._savedData=null,this._unsavedData=null,this._debugData=this._runtime.IsDebug()?{isBreakpoint:t[8][0],canDebug:t[8][1]}:null,-1===t[0]?this._systemPlugin=this._runtime.GetSystemPlugin():(this._objectClass=this._runtime.GetObjectClassByIndex(t[0]),t[2]&&(this._behaviorType=this._objectClass.GetBehaviorTypeByName(t[2]),this._behaviorIndex=this._objectClass.GetBehaviorIndexByName(t[2])),this._eventBlock.GetParent()&&this._eventBlock.GetParent().SetSolWriterAfterCnds()),10===t.length){let e=t[9];for(let t of e)this._parameters.push(nb.Parameter.Create(this,t,this._parameters.length)),this._results.push(0)}0===this._parameters.length&&(this._parameters=rb,this._results=rb),this._eventBlock.GetEventSheetManager()._RegisterCondition(this)}static Create(e,t,s){return nb.New(nb.Condition,e,t,s)}_PostInit(){for(const e of this._parameters)e._PostInit(),e.VariesPerInstance()&&(this._anyParamVariesPerInstance=!0);this._isFastTrigger?(this.Run=this._RunFastTrigger,this.DebugRun=this._DebugRunFastTrigger):this._systemPlugin?(this._SetSystemRunMethod(),this.DebugRun=this._DebugRunSystem):this._objectClass.GetPlugin().IsSingleGlobal()?(this._SetSingleGlobalRunMethod(),this.DebugRun=this._DebugRunSingleGlobal):this._isStatic?(this.Run=this._RunStatic,this.DebugRun=this._DebugRunStatic):(this.Run=this._RunObject,this.DebugRun=this._DebugRunObject)}_SetSystemRunMethod(){const e=this._systemPlugin,t=this._systemPlugin;this._SetRunMethodForBoundFunc(e,t,this._RunSystem)}_SetSingleGlobalRunMethod(){const e=this._objectClass.GetPlugin(),t=this._objectClass.GetSingleGlobalInstance().GetSdkInstance();this._SetRunMethodForBoundFunc(e,t,this._RunSingleGlobal)}_SetRunMethodForBoundFunc(e,t,s){const n=this._func,i=this._isInverted,r=this._parameters;if(0===r.length){const s=e._GetBoundACEMethod(n,t);this.Run=i?function(){return nb.xor(s(),i)}:s}else if(1===r.length){const s=r[0];if(!i&&s.IsConstant())this.Run=e._GetBoundACEMethod_1param(n,t,s.Get(0));else{const r=e._GetBoundACEMethod(n,t);this.Run=function(){return nb.xor(r(s.Get(0)),i)}}}else if(2===r.length){const s=r[0],a=r[1];if(!i&&s.IsConstant()&&a.IsConstant())this.Run=e._GetBoundACEMethod_2params(n,t,s.Get(0),a.Get(0));else{const r=e._GetBoundACEMethod(n,t);this.Run=function(){return nb.xor(r(s.Get(0),a.Get(0)),i)}}}else if(3===r.length){const s=r[0],a=r[1],o=r[2];if(!i&&s.IsConstant()&&a.IsConstant()&&o.IsConstant())this.Run=e._GetBoundACEMethod_3params(n,t,s.Get(0),a.Get(0),o.Get(0));else{const r=e._GetBoundACEMethod(n,t);this.Run=function(){return nb.xor(r(s.Get(0),a.Get(0),o.Get(0)),i)}}}else this.Run=s}GetSID(){return this._sid}_GetFunc(){return this._func}GetObjectClass(){return this._objectClass}GetBehaviorType(){return this._behaviorType}GetImplementationAddon(){return this._behaviorType?this._behaviorType.GetBehavior():this._objectClass?this._objectClass.GetPlugin():null}GetImplementationSdkVersion(){const e=this.GetImplementationAddon();return e?e.GetSdkVersion():1}GetEventBlock(){return this._eventBlock}GetRuntime(){return this._runtime}GetIndex(){return this._index}GetDebugIndex(){return this.GetIndex()}IsTrigger(){return this._isTrigger}IsFastTrigger(){return this._isFastTrigger}IsInverted(){return this._isInverted}IsLooping(){return this._isLooping}IsStatic(){return this._isStatic}IsBreakpoint(){return this._debugData.isBreakpoint}IsSystemCondition(){return!!this._systemPlugin}IsSystemOrSingleGlobalCondition(){return this.IsSystemCondition()||this._objectClass.GetPlugin().IsSingleGlobal()}GetFirstObjectParameterObjectClass(){for(const e of this._parameters)if(e.IsObjectParameter())return e.GetObjectClass();return null}_SetBreakpoint(e){this._debugData.isBreakpoint=!!e,this._eventBlock._UpdateCanRunFastRecursive()}_DebugReturnsGenerator(){return this._debugData.canDebug}DebugCanRunFast(){return!this.IsBreakpoint()&&!this._runtime.DebugBreakNext()&&!this._DebugReturnsGenerator()}GetSavedDataMap(){return this._savedData||(this._savedData=new Map),this._savedData}GetUnsavedDataMap(){return this._unsavedData||(this._unsavedData=new Map),this._unsavedData}_RunSystem(){const e=this._results;return sb(this._parameters,e),nb.xor(this._func.apply(this._systemPlugin,e),this._isInverted)}*_DebugRunSystem(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results;sb(this._parameters,e);let t=this._func.apply(this._systemPlugin,e);return nb.IsIterator(t)&&(t=yield*t),nb.xor(t,this._isInverted)}return this.Run()}_RunSingleGlobal(){const e=this._results;sb(this._parameters,e);const t=this._objectClass.GetSingleGlobalInstance().GetSdkInstance();return nb.xor(this._func.apply(t,e),this._isInverted)}*_DebugRunSingleGlobal(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results;sb(this._parameters,e);const t=this._objectClass.GetSingleGlobalInstance().GetSdkInstance();let s=this._func.apply(t,e);return nb.IsIterator(s)&&(s=yield*s),nb.xor(s,this._isInverted)}return this.Run()}_RunFastTrigger(){return!0}*_DebugRunFastTrigger(){return(this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),!0}_GetStaticConditionThis(){return this._behaviorType?this._behaviorType.GetBehavior().GetSdkVersion()>=2?this._behaviorType.GetIBehaviorType():this._behaviorType:this._objectClass.GetPlugin().GetSdkVersion()>=2?this._objectClass.GetIObjectClass():this._objectClass}_RunStatic(){const e=this._results;sb(this._parameters,e);const t=this._func.apply(this._GetStaticConditionThis(),e);return this._objectClass.ApplySolToContainer(),t}*_DebugRunStatic(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results;sb(this._parameters,e);let t=this._func.apply(this._GetStaticConditionThis(),e);return nb.IsIterator(t)&&(t=yield*t),this._objectClass.ApplySolToContainer(),t}return this.Run()}_RunObject(){const e=this._parameters,t=this._results,s=this._objectClass.GetCurrentSol();for(let s=0,n=e.length;s<n;++s){const n=e[s];n.VariesPerInstance()||(t[s]=n.Get(0))}return s.IsSelectAll()?this._RunObject_FirstFilter(s):this._RunObject_NextFilter(s)}*_DebugRunObject(){return(this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._RunObject()}_EvaluateVaryingParameters(e){const t=this._parameters,s=this._results;for(let n=0,i=t.length;n<i;++n){const i=t[n];i.VariesPerInstance()&&(s[n]=i.Get(e))}}_RunObject_FirstFilter(e){const t=this._objectClass,s=t.IsFamily(),n=t.GetFamilyIndex(),i=this._behaviorIndex,r=i>=0,a=t.GetInstances(),o=this._anyParamVariesPerInstance,l=this._results,c=this._func,h=this._isInverted,_=this._isInOrBlock&&!this._isTrigger;e.ClearArrays();for(let t=0,u=a.length;t<u;++t){const u=a[t];let d;if(o&&this._EvaluateVaryingParameters(t),r){const e=s?u.GetObjectClass().GetFamilyBehaviorOffset(n):0;d=c.apply(u.GetBehaviorInstances()[i+e].GetSdkInstance(),l)}else d=c.apply(u.GetSdkInstance(),l);nb.xor(d,h)?e._PushInstance(u):_&&e._PushElseInstance(u)}return t.FinishCondition(!0),e._SetSelectAll(!1),t.ApplySolToContainer(),e.HasAnyInstances()}_RunObject_NextFilter(e){const t=this._objectClass,s=t.IsFamily(),n=t.GetFamilyIndex(),i=t.IsInContainer(),r=this._behaviorIndex,a=r>=0,o=this._anyParamVariesPerInstance,l=this._results,c=this._func,h=this._isInverted,_=this._isInOrBlock&&!this._isTrigger,u=e._GetOwnInstances(),d=e._GetOwnElseInstances(),p=_&&!this._eventBlock.IsFirstConditionOfType(this),f=p?d:u;let m=0,g=!1;for(let e=0,t=f.length;e<t;++e){const t=f[e];let I;if(o&&this._EvaluateVaryingParameters(e),a){const e=s?t.GetObjectClass().GetFamilyBehaviorOffset(n):0;I=c.apply(t.GetBehaviorInstances()[r+e].GetSdkInstance(),l)}else I=c.apply(t.GetSdkInstance(),l);nb.xor(I,h)?(g=!0,p?(u.push(t),i&&t._PushSiblingsToSolInstances()):(f[m]=t,i&&t._SetSiblingsToSolInstancesIndex(m),++m)):p?(f[m]=t,i&&t._SetSiblingsToSolElseInstancesIndex(m),++m):_&&(d.push(t),i&&t._PushSiblingsToSolElseInstances())}nb.truncateArray(f,m),i&&t._TruncateContainerSols(p,m);const I=g;return p&&!g&&(g=this._OrBlockCheckInstances(u)),t.FinishCondition(I||_),_?g:e.HasAnyInstances()}_OrBlockCheckInstances(e){const t=this._objectClass,s=t.IsFamily(),n=t.GetFamilyIndex(),i=this._anyParamVariesPerInstance,r=this._behaviorIndex,a=r>=0,o=this._results,l=this._func,c=this._isInverted;for(let t=0,h=e.length;t<h;++t){const h=e[t];let _;if(i&&this._EvaluateVaryingParameters(t),a){const e=s?h.GetObjectClass().GetFamilyBehaviorOffset(n):0;_=l.apply(h.GetBehaviorInstances()[r+e].GetSdkInstance(),o)}else _=l.apply(h.GetSdkInstance(),o);if(nb.xor(_,c))return!0}return!1}ReevaluateParameter(e,t){return this._parameters[e].Get(t)}GetFastTriggerValue(){const e=this._parameters;if(!e.length)throw new Error("no parameters");return e[0]._GetFastTriggerValue()}_SaveToJson(){if(!this._savedData||!this._savedData.size)return null;const e={};for(const[t,s]of this._savedData.entries()){let n=s;"collmemory"===t&&(n=[...s.entries()].map((e=>[e[0].GetUID(),e[1].GetUID(),e[2]]))),e[t]=n}return{ex:e}}_LoadFromJson(e){if(this._savedData&&(this._savedData.clear(),this._savedData=null),!e)return;const t=this._runtime,s=e.ex;if(s){const e=this.GetSavedDataMap();e.clear();for(const[n,i]of Object.entries(s)){let s=i;"collmemory"===n&&(s=nb.New(nb.PairMap,i.map((e=>[t.GetInstanceByUID(e[0]),t.GetInstanceByUID(e[1]),e[2]])).filter((e=>e[0]&&e[1])))),e.set(n,s)}}}}}{let ob=function(e,t){for(let s=0,n=e.length;s<n;++s)t[s]=e[s].Get(0)};EvalParams=ob;const lb=self.C3,cb=self.assert,hb=[],_b=function(){},ub=function*(){},db=1,pb=2,fb=4,mb=8,gb=16;lb.Action=class extends lb.DefendedBase{constructor(e,t,s){super(),this._eventBlock=e;const n=e.GetRuntime();this._runtime=n,this._index=s,this._sid=t.length>=4?t[3]:-1,this._actionType=t.length>=5?255&t[4]:0,this._flags=t.length>=5?t[4]>>8:0,this._func=null,this._objectClass=null,this._behaviorType=null,this._behaviorIndex=-1,this._systemPlugin=null,this._callFunctionName="",this._callCustomAceObjectClass=null,this._callEventBlock=null,this.Run=_b,this.DebugRun=_b,this._parameters=[],this._results=[],this._anyParamVariesPerInstance=!1,this._savedData=null,this._unsavedData=null;const i=-3===t[0],r=i?t[2]:t[5];if(this._debugData=n.IsDebug()||i?{isBreakpoint:r[0],canDebug:r[1],index:r[2]}:null,-1===t[0])this._systemPlugin=n.GetSystemPlugin(),this._func=n.GetObjectReference(t[1]);else if(-2===t[0])this._callFunctionName=t[1];else if(i){const e=n.GetObjectReference(t[1]);this._func=e,this.Run=this.RunUserScript,this.DebugRun=this.DebugRunUserScript,this._flags|=8}else this._objectClass=n.GetObjectClassByIndex(t[0]),4&this._flags?(this._callFunctionName=t[1],this._callCustomAceObjectClass=n.GetObjectClassByIndex(t[2])):(t[2]&&(this._behaviorType=this._objectClass.GetBehaviorTypeByName(t[2]),this._behaviorIndex=this._objectClass.GetBehaviorIndexByName(t[2])),this._func=n.GetObjectReference(t[1]));if(7===t.length){const e=t[6];for(const t of e)this._parameters.push(lb.Parameter.Create(this,t,this._parameters.length)),this._results.push(0)}0===this._parameters.length&&(this._parameters=hb,this._results=hb),this.CanPickAnyObjectClass()&&(this._eventBlock.SetAllSolModifiers(),this._eventBlock.SetSolWriterAfterCnds()),this._eventBlock.GetEventSheetManager()._RegisterAction(this)}static Create(e,t,s){return lb.New(lb.Action,e,t,s)}_PostInit(){for(const e of this._parameters)e._PostInit(),e.VariesPerInstance()&&(this._anyParamVariesPerInstance=!0);if(this._systemPlugin)this._SetSystemRunMethod(),this.DebugRun=this._DebugRunSystem;else if(this._callFunctionName)4&this._flags?this._SetCallCustomActionRunMethod():this._SetCallFunctionRunMethod(),this._callFunctionName="",this._callCustomAceObjectClass=null;else if(this.Run===this.RunUserScript){const e=this._func,t=this._runtime.GetEventSheetManager()._GetLocalVariablesScriptInterface(this._eventBlock);this._func=e.bind(null,this._runtime.GetIRuntime(),t)}else this._behaviorType?this.IsAsync()?(this.Run=this._RunBehavior_Async,this.DebugRun=this._DebugRunBehavior_Async):(this.Run=this._RunBehavior,this.DebugRun=this._DebugRunBehavior):this._objectClass.GetPlugin().IsSingleGlobal()?(this._SetSingleGlobalRunMethod(),this.DebugRun=this._DebugRunSingleGlobal):this.IsStatic()?(this.Run=this._RunObject_Static,this.DebugRun=this._DebugRunObject_Static):this.IsAsync()?(this.Run=this._RunObject_Async,this.DebugRun=this._DebugRunObject_Async):this.CallBeforeAfterHooks()?(this.Run=this._RunObject_BeforeAfterHooks,this.DebugRun=this._DebugRunObject_BeforeAfterHooks):this._parameters.length?this._parameters.every((e=>e.VariesPerInstance()))?(this.Run=this._RunObject_AllParamsVary,this.DebugRun=this._DebugRunObject_AllParamsVary):this._anyParamVariesPerInstance?(this.Run=this._RunObject_SomeParamsVary,this.DebugRun=this._DebugRunObject_SomeParamsVary):this._parameters.every((e=>e.IsConstant()))?(ob(this._parameters,this._results),this.Run=this._RunObject_ParamsConst,this.DebugRun=this._DebugRunObject_ParamsConst):(this.Run=this._RunObject_ParamsDontVary,this.DebugRun=this._DebugRunObject_ParamsDontVary):(this.Run=this._RunObject_ParamsConst,this.DebugRun=this._DebugRunObject_ParamsConst)}_SetSystemRunMethod(){const e=this._systemPlugin,t=this._systemPlugin;this._SetRunMethodForBoundFunc(e,t,this._RunSystem)}_SetSingleGlobalRunMethod(){const e=this._objectClass.GetPlugin(),t=this._objectClass.GetSingleGlobalInstance().GetSdkInstance();this._SetRunMethodForBoundFunc(e,t,this._RunSingleGlobal)}_SetCallFunctionRunMethod(){const e=this._eventBlock.GetEventSheetManager(),t=e.GetFunctionBlockByName(this._callFunctionName);if(t.IsEnabled()){const s=!!(2&this._flags);this._callEventBlock=t.GetEventBlock();let n=[...new Set([...this._eventBlock.GetSolModifiersIncludingParents(),...this._callEventBlock.GetSolModifiersIncludingParents()])];n=e._DeduplicateSolModifierList(n);const i=!t.IsCopyPicked()&&this._HasCopyPickedParent()?{pushCleanSolDynamic:!0}:null;if(this.Run=lb.EventBlock.prototype.RunAsFunctionCall.bind(this._callEventBlock,n,this._parameters,s,i),this._runtime.IsDebug()){const e=this;this.DebugRun=function*(){return(e.IsBreakpoint()||e._runtime.DebugBreakNext())&&(yield e),yield*e._callEventBlock.DebugRunAsFunctionCall(n,e._parameters,s,i)}}else this.DebugRun=ub}else this.Run=_b,this.DebugRun=ub}_SetCallCustomActionRunMethod(){const e=this._eventBlock.GetEventSheetManager(),t=e.GetCustomActionBlockByName(this._callCustomAceObjectClass,this._callFunctionName);if(t.IsEnabled()){const s=!!(2&this._flags);this._callEventBlock=t.GetEventBlock();let n=[...new Set([...this._eventBlock.GetSolModifiersIncludingParents(),...this._callEventBlock.GetSolModifiersIncludingParents(),this._objectClass,t.GetObjectClass()])];n=e._DeduplicateSolModifierList(n);const i=!this._objectClass.IsFamily()&&!t.GetObjectClass().IsFamily(),r=!this._objectClass.IsFamily()&&t.GetObjectClass().IsFamily(),a=this._objectClass.IsFamily();let o=null;if(!t.IsCopyPicked()&&this._HasCopyPickedParent()&&(o=o||{},o.pushCleanSolDynamic=!0),!r&&s||(o=o||{},o.copyFromObjectClass=this._objectClass,o.copyToObjectClass=t.GetObjectClass()),i||r||a&&!t.HasCustomACEOverrides()?this.Run=lb.EventBlock.prototype.RunAsFunctionCall.bind(this._callEventBlock,n,this._parameters,s,o):a&&(this.Run=lb.FunctionBlock.prototype.RunAsFamilyCustomActionWithOverrides.bind(t,n,this._parameters)),this._runtime.IsDebug()){const e=this;i||r||a&&!t.HasCustomACEOverrides()?this.DebugRun=function*(){return(e.IsBreakpoint()||e._runtime.DebugBreakNext())&&(yield e),yield*e._callEventBlock.DebugRunAsFunctionCall(n,e._parameters,s,o)}:a&&(this.DebugRun=function*(){return(e.IsBreakpoint()||e._runtime.DebugBreakNext())&&(yield e),yield*t.DebugRunAsFamilyCustomActionWithOverrides(n,e._parameters)})}else this.DebugRun=ub}else this.Run=_b,this.DebugRun=ub}_SetRunMethodForBoundFunc(e,t,s){const n=this._func,i=this._parameters;if(0===i.length)this.Run=e._GetBoundACEMethod(n,t);else if(1===i.length){const s=i[0];if(s.IsConstant())this.Run=e._GetBoundACEMethod_1param(n,t,s.Get(0));else{const i=e._GetBoundACEMethod(n,t);this.Run=function(){return i(s.Get(0))}}}else if(2===i.length){const s=i[0],r=i[1];if(s.IsConstant()&&r.IsConstant())this.Run=e._GetBoundACEMethod_2params(n,t,s.Get(0),r.Get(0));else{const i=e._GetBoundACEMethod(n,t);this.Run=function(){return i(s.Get(0),r.Get(0))}}}else if(3===i.length){const s=i[0],r=i[1],a=i[2];if(s.IsConstant()&&r.IsConstant()&&a.IsConstant())this.Run=e._GetBoundACEMethod_3params(n,t,s.Get(0),r.Get(0),a.Get(0));else{const i=e._GetBoundACEMethod(n,t);this.Run=function(){return i(s.Get(0),r.Get(0),a.Get(0))}}}else this.Run=s}GetSID(){return this._sid}IsAsync(){return!!(8&this._flags)}CanBailOut(){return!!(16&this._flags)}CallBeforeAfterHooks(){return 1===this._actionType}IsStatic(){return 2===this._actionType}CanPickAnyObjectClass(){return!!(1&this._flags)}HasReturnType(){return this.IsAsync()||this.CanBailOut()}GetObjectClass(){return this._objectClass}GetImplementationAddon(){return this._behaviorType?this._behaviorType.GetBehavior():this._objectClass?this._objectClass.GetPlugin():null}GetImplementationSdkVersion(){const e=this.GetImplementationAddon();return e?e.GetSdkVersion():1}GetEventBlock(){return this._eventBlock}_HasCopyPickedParent(){let e=this._eventBlock;do{if(e instanceof lb.FunctionBlock&&e.IsCopyPicked())return!0;e=e.GetScopeParent()}while(e);return!1}GetRuntime(){return this._runtime}GetIndex(){return this._index}GetDebugIndex(){return this._debugData.index}IsBreakpoint(){return this._debugData.isBreakpoint}_SetBreakpoint(e){this._debugData.isBreakpoint=!!e,this._eventBlock._UpdateCanRunFastRecursive()}_DebugReturnsGenerator(){return this._debugData.canDebug}DebugCanRunFast(){return!this.IsBreakpoint()&&!this._runtime.DebugBreakNext()&&!this._DebugReturnsGenerator()}GetSavedDataMap(){return this._savedData||(this._savedData=new Map),this._savedData}GetUnsavedDataMap(){return this._unsavedData||(this._unsavedData=new Map),this._unsavedData}_RunSystem(){const e=this._results;return ob(this._parameters,e),this._func.apply(this._systemPlugin,e)}*_DebugRunSystem(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results;return ob(this._parameters,e),yield*this._func.apply(this._systemPlugin,e)}return this.Run()}_RunSingleGlobal(){const e=this._results;return ob(this._parameters,e),this._func.apply(this._objectClass.GetSingleGlobalInstance().GetSdkInstance(),e)}*_DebugRunSingleGlobal(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results;return ob(this._parameters,e),yield*this._func.apply(this._objectClass.GetSingleGlobalInstance().GetSdkInstance(),e)}return this.Run()}_RunObject_ParamsConst(){const e=this._results,t=this._objectClass.GetCurrentSol().GetInstances();for(let s=0,n=t.length;s<n;++s)this._func.apply(t[s].GetSdkInstance(),e)}*_DebugRunObject_ParamsConst(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results,t=this._objectClass.GetCurrentSol().GetInstances();for(let s=0,n=t.length;s<n;++s)yield*this._func.apply(t[s].GetSdkInstance(),e)}else this._RunObject_ParamsConst()}_RunObject_ParamsDontVary(){const e=this._results;ob(this._parameters,e);const t=this._objectClass.GetCurrentSol().GetInstances();for(let s=0,n=t.length;s<n;++s)this._func.apply(t[s].GetSdkInstance(),e)}*_DebugRunObject_ParamsDontVary(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results;ob(this._parameters,e);const t=this._objectClass.GetCurrentSol().GetInstances();for(let s=0,n=t.length;s<n;++s)yield*this._func.apply(t[s].GetSdkInstance(),e)}else this._RunObject_ParamsDontVary()}_RunObject_AllParamsVary(){const e=this._parameters,t=this._results,s=this._func,n=this._objectClass.GetCurrentSol().GetInstances();for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let s=0,n=e.length;s<n;++s)t[s]=e[s].Get(i);s.apply(r.GetSdkInstance(),t)}}*_DebugRunObject_AllParamsVary(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._parameters,t=this._results,s=this._func,n=this._objectClass.GetCurrentSol().GetInstances();for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let s=0,n=e.length;s<n;++s)t[s]=e[s].Get(i);yield*s.apply(r.GetSdkInstance(),t)}}else this._RunObject_AllParamsVary()}_RunObject_SomeParamsVary(){const e=this._parameters,t=this._results,s=this._func,n=this._objectClass.GetCurrentSol().GetInstances();for(let s=0,n=e.length;s<n;++s){const n=e[s];n.VariesPerInstance()||(t[s]=n.Get(0))}for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let s=0,n=e.length;s<n;++s){const n=e[s];n.VariesPerInstance()&&(t[s]=n.Get(i))}s.apply(r.GetSdkInstance(),t)}}*_DebugRunObject_SomeParamsVary(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._parameters,t=this._results,s=this._func,n=this._objectClass.GetCurrentSol().GetInstances();for(let s=0,n=e.length;s<n;++s){const n=e[s];n.VariesPerInstance()||(t[s]=n.Get(0))}for(let i=0,r=n.length;i<r;++i){const r=n[i];for(let s=0,n=e.length;s<n;++s){const n=e[s];n.VariesPerInstance()&&(t[s]=n.Get(i))}yield*s.apply(r.GetSdkInstance(),t)}}else this._RunObject_SomeParamsVary()}_RunObject_BeforeAfterHooks(){const e=this._parameters,t=this._results,s=this._func,n=this._objectClass,i=n.GetSdkType(),r=n.GetCurrentSol().GetInstances();i.BeforeRunAction(s);for(let n=0,i=r.length;n<i;++n){const i=r[n];for(let s=0,i=e.length;s<i;++s)t[s]=e[s].Get(n);s.apply(i.GetSdkInstance(),t)}i.AfterRunAction(s)}*_DebugRunObject_BeforeAfterHooks(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._parameters,t=this._results,s=this._func,n=this._objectClass,i=n.GetSdkType(),r=n.GetCurrentSol().GetInstances();i.BeforeRunAction(s);for(let n=0,i=r.length;n<i;++n){const i=r[n];for(let s=0,i=e.length;s<i;++s)t[s]=e[s].Get(n);yield*s.apply(i.GetSdkInstance(),t)}i.AfterRunAction(s)}else this._RunObject_BeforeAfterHooks()}_GetStaticActionThis(){return this._behaviorType?this._behaviorType.GetBehavior().GetSdkVersion()>=2?this._behaviorType.GetIBehaviorType():this._behaviorType:this._objectClass.GetPlugin().GetSdkVersion()>=2?this._objectClass.GetIObjectClass():this._objectClass}_RunObject_Static(){const e=this._results;return ob(this._parameters,e),this._func.apply(this._GetStaticActionThis(),e)}*_DebugRunObject_Static(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._results;ob(this._parameters,e);let t=this._func.apply(this._GetStaticActionThis(),e);return lb.IsIterator(t)&&(t=yield*t),t}return this._RunObject_Static()}_RunBehavior(){const e=this._objectClass,t=e.IsFamily(),s=e.GetFamilyIndex(),n=this._parameters,i=this._anyParamVariesPerInstance,r=this._results,a=this._func,o=this._behaviorIndex,l=e.GetCurrentSol().GetInstances();for(let e=0,t=n.length;e<t;++e){const t=n[e];t.VariesPerInstance()||(r[e]=t.Get(0))}for(let e=0,c=l.length;e<c;++e){const c=l[e];if(i)for(let t=0,s=n.length;t<s;++t){const s=n[t];s.VariesPerInstance()&&(r[t]=s.Get(e))}const h=t?c.GetObjectClass().GetFamilyBehaviorOffset(s):0;a.apply(c.GetBehaviorInstances()[o+h].GetSdkInstance(),r)}}*_DebugRunBehavior(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._objectClass,t=e.IsFamily(),s=e.GetFamilyIndex(),n=this._parameters,i=this._anyParamVariesPerInstance,r=this._results,a=this._func,o=this._behaviorIndex,l=e.GetCurrentSol().GetInstances();for(let e=0,t=n.length;e<t;++e){const t=n[e];t.VariesPerInstance()||(r[e]=t.Get(0))}for(let e=0,c=l.length;e<c;++e){const c=l[e];if(i)for(let t=0,s=n.length;t<s;++t){const s=n[t];s.VariesPerInstance()&&(r[t]=s.Get(e))}const h=t?c.GetObjectClass().GetFamilyBehaviorOffset(s):0;yield*a.apply(c.GetBehaviorInstances()[o+h].GetSdkInstance(),r)}}else this._RunBehavior()}_RunObject_Async(){const e=this._parameters,t=this._results,s=this._func,n=this._objectClass.GetCurrentSol().GetInstances(),i=[];for(let r=0,a=n.length;r<a;++r){const a=n[r];for(let s=0,n=e.length;s<n;++s)t[s]=e[s].Get(r);i.push(s.apply(a.GetSdkInstance(),t))}return Promise.all(i)}*_DebugRunObject_Async(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._parameters,t=this._results,s=this._func,n=this._objectClass.GetCurrentSol().GetInstances(),i=[];for(let r=0,a=n.length;r<a;++r){const a=n[r];for(let s=0,n=e.length;s<n;++s)t[s]=e[s].Get(r);i.push(yield*s.apply(a.GetSdkInstance(),t))}return Promise.all(i)}return this._RunObject_Async()}_RunBehavior_Async(){const e=this._objectClass,t=e.IsFamily(),s=e.GetFamilyIndex(),n=this._parameters,i=this._results,r=this._func,a=this._behaviorIndex,o=e.GetCurrentSol().GetInstances(),l=[];for(let e=0,c=o.length;e<c;++e){const c=o[e];for(let t=0,s=n.length;t<s;++t)i[t]=n[t].Get(e);const h=t?c.GetObjectClass().GetFamilyBehaviorOffset(s):0;l.push(r.apply(c.GetBehaviorInstances()[a+h].GetSdkInstance(),i))}return Promise.all(l)}*_DebugRunBehavior_Async(){if((this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this._DebugReturnsGenerator()){const e=this._objectClass,t=e.IsFamily(),s=e.GetFamilyIndex(),n=this._parameters,i=this._results,r=this._func,a=this._behaviorIndex,o=e.GetCurrentSol().GetInstances(),l=[];for(let e=0,c=o.length;e<c;++e){const c=o[e];for(let t=0,s=n.length;t<s;++t)i[t]=n[t].Get(e);const h=t?c.GetObjectClass().GetFamilyBehaviorOffset(s):0;l.push(yield*r.apply(c.GetBehaviorInstances()[a+h].GetSdkInstance(),i))}return Promise.all(l)}return this._RunBehavior_Async()}async RunUserScript(){try{await this._func()}catch(e){console.error(`Unhandled exception running script %c${this._eventBlock.GetEventSheet().GetName()}, event ${this._eventBlock.GetDisplayNumber()}, action ${this.GetDebugIndex()+1}:`,"font-size: 1.2em; font-weight: bold;",e),self.C3Debugger&&self.C3Debugger._SetLastErrorScript(this),lb.EventScript.HadUserScriptException()||(console.info("%cTip:%c run this to highlight in Construct the last script that had an error: %cgoToLastErrorScript()","font-weight: bold; text-decoration: underline","","font-weight: bold"),lb.EventScript.SetHadUserScriptException())}}*DebugRunUserScript(){return(this.IsBreakpoint()||this._runtime.DebugBreakNext())&&(yield this),this.RunUserScript()}_SaveToJson(){return this._savedData&&this._savedData.size?{ex:lb.ToSuperJSON(this._savedData)}:null}_LoadFromJson(e){if(this._savedData&&(this._savedData.clear(),this._savedData=null),!e)return;const t=e.ex;t&&(this._savedData=lb.FromSuperJSON(t))}}}{let Ib=function(e){return e instanceof Nb?Ob._UnwrapScriptInterface(e):e.GetInstance()},Sb=function(e){return Ib(e).GetWorldInfo()},yb=function(e){return Ob._UnwrapScriptInterface(e)},bb=function(e){return yb(e).GetWorldInfo()},Gb=function(e){return e instanceof Wb?Ob._UnwrapScriptInterface(e):e},vb=function(e){return e instanceof Vb?Ob._UnwrapScriptInterface(e):e},xb=function(e,t,s,n){t.GetUID()<s.GetUID()?e.Set(t,s,n):e.Set(s,t,n)},Tb=function(e,t,s){t.GetUID()<s.GetUID()?e.Delete(t,s):e.Delete(s,t)},Cb=function(e,t){e.DeleteEither(t)},wb=function(e,t,s){return t.GetUID()<s.GetUID()?e.Get(t,s):e.Get(s,t)},Pb=function(e,t,s,n){if(!t)return!1;const i=0!==s||0!==n,r=e.GetWorldInfo(),a=Ob.GetCollisionEngine(),o=Ob.GetCurrentCondition(),l=o.GetEventBlock().IsOrBlock(),c=o.GetObjectClass(),h=o.IsInverted(),_=t.GetCurrentSol(),u=c!==t;let d;Xb=t,zb=u&&!h,Yb=!1;let p=0,f=0,m=!1;_.IsSelectAll()?(jb.copy(r.GetBoundingBox()),jb.offset(s,n),a.GetCollisionCandidates(r.GetLayer(),t,jb,Hb),d=Hb):l?Ob.IsCurrentConditionFirst()&&!_._GetOwnElseInstances().length&&_._GetOwnInstances().length?d=_._GetOwnInstances():(d=_._GetOwnElseInstances(),Yb=!0):d=_._GetOwnInstances(),i&&(p=r.GetX(),f=r.GetY(),r.OffsetXY(s,n),r.SetBboxChanged());for(const t of d)if(a.TestOverlap(e,t)){if(m=!0,h)break;u&&qb.add(t)}return i&&(r.SetXY(p,f),r.SetBboxChanged()),Mb.clearArray(Hb),m},Ab=function(e){const t=Ob.GetCurrentEvent().IsOrBlock(),s=Xb.GetCurrentSol(),n=s._GetOwnInstances(),i=s._GetOwnElseInstances();s.IsSelectAll()?(s.SetSetPicked(qb),t&&(Mb.clearArray(i),s.AddElseInstances(qb,Xb.GetInstances()))):t?Yb?s.TransferElseInstancesToOwn(qb):(s.AddElseInstances(qb,n),s.SetSetPicked(qb)):s.SetSetPicked(qb),Xb.ApplySolToContainer()},Rb=function(e,t){zb&&(t&&Ab(e),qb.clear(),Xb=null,zb=!1)},Db=function(e,t){const s=Ob.GetInstanceByUID(t);if(!s)return!1;const n=e.GetCurrentSol();if(!n.IsSelectAll()&&!n._GetOwnInstances().includes(s))return!1;if(e.IsFamily()){if(s.GetObjectClass().BelongsToFamily(e))return n.PickOne(s),e.ApplySolToContainer(),!0}else if(s.GetObjectClass()===e)return n.PickOne(s),e.ApplySolToContainer(),!0;return!1},Eb=function(e,t){const s=e.GetCurrentSol();if(s.IsSelectAll()){s._SetSelectAll(!1),s.ClearArrays();const n=e.GetInstances();for(let e=0,i=n.length;e<i;++e){const i=n[e];i.GetUID()===t?s._PushElseInstance(i):s._PushInstance(i)}return e.ApplySolToContainer(),!!s._GetOwnInstances().length}{const n=s._GetOwnInstances();let i=0;for(let e=0,r=n.length;e<r;++e){const r=n[e];n[i]=r,r.GetUID()===t?s._PushElseInstance(r):++i}return Mb.truncateArray(n,i),e.ApplySolToContainer(),!!n.length}};GetInst=Ib,GetWorldInfo=Sb,GetInst_SDKv2=yb,GetWorldInfo_SDKv2=bb,GetObjectClass=Gb,GetLayer=vb,CollMemory_Add=xb,CollMemory_Remove=Tb,CollMemory_RemoveInstance=Cb,CollMemory_Get=wb,DoOverlapCondition=Pb,FinishCollisionConditionPicking=Ab,FinishCollisionCondition=Rb,PickByUID_Normal=Db,PickByUID_Inverted=Eb;const Mb=self.C3,kb=new Mb.Color,Lb={},Fb={},Bb={};let Ob=null;Mb.CommonACES_SetRuntime=function(e){Ob=e};const Nb=self.IInstance,Wb=self.IObjectClass,Vb=self.ILayer;Fb.CompareX=function(e,t){return Mb.compare(this.GetWorldInfo().GetX(),e,t)},Bb.CompareX=function(e,t){return Mb.compare(this.x,e,t)},Fb.CompareY=function(e,t){return Mb.compare(this.GetWorldInfo().GetY(),e,t)},Bb.CompareY=function(e,t){return Mb.compare(this.y,e,t)},Fb.IsOnScreen=function(){return this.GetWorldInfo().IsInViewport2()},Bb.IsOnScreen=function(){return this.isOnScreen()},Lb.IsOutsideLayout=function(){const e=Sb(this),t=e.GetLayout(),s=e.GetBoundingBox();return s.getRight()<0||s.getBottom()<0||s.getLeft()>t.GetWidth()||s.getTop()>t.GetHeight()},Lb.PickDistance=function(e,t,s){const n=Gb(this).GetCurrentSol(),i=n.GetInstances();if(!i.length)return!1;let r=i[0],a=r.GetWorldInfo(),o=r,l=Mb.distanceSquared(a.GetX(),a.GetY(),t,s);for(let n=1,c=i.length;n<c;++n){r=i[n],a=r.GetWorldInfo();const c=Mb.distanceSquared(a.GetX(),a.GetY(),t,s);(0===e&&c<l||1===e&&c>l)&&(l=c,o=r)}return n.PickOne(o),!0},Fb.SetX=function(e){const t=this.GetWorldInfo();t.GetX()!==e&&(t.SetX(e),t.SetBboxChanged())},Bb.SetX=function(e){this.x=+e},Fb.SetY=function(e){const t=this.GetWorldInfo();t.GetY()!==e&&(t.SetY(e),t.SetBboxChanged())},Bb.SetY=function(e){this.y=+e},Fb.SetPos=function(e,t){const s=this.GetWorldInfo();s.EqualsXY(e,t)||(s.SetXY(e,t),s.SetBboxChanged())},Bb.SetPos=function(e,t){this.setPosition(e,t)},Lb.SetPosToObject=function(e,t){if(!(e=Gb(e)))return;const s=Ib(this),n=e.GetPairedInstance(s);if(!n)return;const[i,r]=n.GetImagePoint(t),a=s.GetWorldInfo();a.GetX()===i&&a.GetY()===r||(a.SetXY(i,r),a.SetBboxChanged())},Lb.MoveForward=function(e){if(0===e)return;const t=Sb(this);t.OffsetXY(t.GetCosAngle()*e,t.GetSinAngle()*e),t.SetBboxChanged()},Fb.MoveAtAngle=function(e,t){if(0===t)return;const s=this.GetWorldInfo();e=Mb.toRadians(e),s.OffsetXY(Math.cos(e)*t,Math.sin(e)*t),s.SetBboxChanged()},Bb.MoveAtAngle=function(e,t){0!==t&&(e=Mb.toRadians(e),this.offsetPosition(Math.cos(e)*t,Math.sin(e)*t))},Fb.GetX=function(){return this.GetWorldInfo().GetX()},Bb.GetX=function(){return this.x},Fb.GetY=function(){return this.GetWorldInfo().GetY()},Bb.GetY=function(){return this.y},Lb.GetDt=function(){return Ob.GetDt(Ib(this))},Fb.CompareWidth=function(e,t){return Mb.compare(this.GetWorldInfo().GetWidth(),e,t)},Bb.CompareWidth=function(e,t){return Mb.compare(this.width,e,t)},Fb.CompareHeight=function(e,t){return Mb.compare(this.GetWorldInfo().GetHeight(),e,t)},Bb.CompareHeight=function(e,t){return Mb.compare(this.height,e,t)},Fb.SetWidth=function(e){const t=this.GetWorldInfo();t.GetWidth()!==e&&(t.SetWidth(e),t.SetBboxChanged())},Bb.SetWidth=function(e){this.width=e},Fb.SetHeight=function(e){const t=this.GetWorldInfo();t.GetHeight()!==e&&(t.SetHeight(e),t.SetBboxChanged())},Bb.SetHeight=function(e){this.height=e},Fb.SetSize=function(e,t){const s=Sb(this);s.GetWidth()===e&&s.GetHeight()===t||(s.SetSize(e,t),s.SetBboxChanged())},Bb.SetSize=function(e,t){this.setSize(e,t)},Fb.GetWidth=function(){return this.GetWorldInfo().GetWidth()},Bb.GetWidth=function(){return this.width},Fb.GetHeight=function(){return this.GetWorldInfo().GetHeight()},Bb.GetHeight=function(){return this.height},Lb.GetBboxLeft=function(){return Sb(this).GetBoundingBox().getLeft()},Lb.GetBboxTop=function(){return Sb(this).GetBoundingBox().getTop()},Lb.GetBboxRight=function(){return Sb(this).GetBoundingBox().getRight()},Lb.GetBboxBottom=function(){return Sb(this).GetBoundingBox().getBottom()},Lb.GetBboxMidX=function(){const e=Sb(this).GetBoundingBox();return(e.getLeft()+e.getRight())/2},Lb.GetBboxMidY=function(){const e=Sb(this).GetBoundingBox();return(e.getTop()+e.getBottom())/2},Lb.IsAngleWithin=function(e,t){return Mb.angleDiff(Sb(this).GetAngle(),Mb.toRadians(t))<=Mb.toRadians(e)},Lb.IsAngleClockwiseFrom=function(e){return Mb.angleClockwise(Sb(this).GetAngle(),Mb.toRadians(e))},Lb.IsBetweenAngles=function(e,t){const s=Mb.toRadians(e),n=Mb.toRadians(t),i=Sb(this).GetAngle();return Mb.angleClockwise(n,s)?Mb.angleClockwise(i,s)&&!Mb.angleClockwise(i,n):!(!Mb.angleClockwise(i,s)&&Mb.angleClockwise(i,n))},Fb.SetAngle=function(e){const t=this.GetWorldInfo(),s=Mb.clampAngle(Mb.toRadians(e));isNaN(s)||t.GetAngle()===s||(t.SetAngle(s),t.SetBboxChanged())},Bb.SetAngle=function(e){this.angleDegrees=e},Lb.RotateClockwise=function(e){if(isNaN(e)||0===e)return;const t=Sb(this);t.SetAngle(t.GetAngle()+Mb.toRadians(e)),t.SetBboxChanged()},Lb.RotateCounterclockwise=function(e){if(isNaN(e)||0===e)return;const t=Sb(this);t.SetAngle(t.GetAngle()-Mb.toRadians(e)),t.SetBboxChanged()},Lb.RotateTowardAngle=function(e,t){const s=Sb(this),n=s.GetAngle(),i=Mb.angleRotate(n,Mb.toRadians(t),Mb.toRadians(e));isNaN(i)||n===i||(s.SetAngle(i),s.SetBboxChanged())},Lb.RotateTowardPosition=function(e,t,s){const n=Sb(this),i=n.GetAngle(),r=t-n.GetX(),a=s-n.GetY(),o=Math.atan2(a,r),l=Mb.angleRotate(i,o,Mb.toRadians(e));isNaN(l)||i===l||(n.SetAngle(l),n.SetBboxChanged())},Lb.SetTowardPosition=function(e,t){const s=Sb(this),n=s.GetAngle(),i=e-s.GetX(),r=t-s.GetY(),a=Math.atan2(r,i);isNaN(a)||n===a||(s.SetAngle(a),s.SetBboxChanged())},Fb.GetAngle=function(){return Mb.toDegrees(this.GetWorldInfo().GetAngle())},Bb.GetAngle=function(){return this.angleDegrees},Lb.CompareOpacity=function(e,t){return Mb.compare(Mb.roundToDp(100*Sb(this).GetOpacity(),6),e,t)},Fb.IsVisible=function(){return this.GetWorldInfo().IsVisible()},Bb.IsVisible=function(){return this.isVisible},Lb.SetVisible=function(e){const t=Sb(this);e=2===e?!t.IsVisible():0!==e,t.IsVisible()!==e&&(t.SetVisible(e),Ob.UpdateRender())},Lb.SetOpacity=function(e){const t=Mb.clamp(e/100,0,1),s=Sb(this);if(s.GetTransformWithParentOpacity()){if(s._GetSceneGraphInfo().GetOwnOpacity()===t)return}else if(s.GetOpacity()===t)return;s.SetOpacity(t),Ob.UpdateRender()},Lb.SetDefaultColor=function(e){kb.setFromRgbValue(e);const t=Sb(this);t.GetUnpremultipliedColor().equalsIgnoringAlpha(kb)||(t.SetUnpremultipliedColor(kb),Ob.UpdateRender())},Lb.GetColor=function(){const e=Sb(this).GetUnpremultipliedColor();return Mb.PackRGBAEx(e.getR(),e.getG(),e.getB(),e.getA())},Lb.GetOpacity=function(){return Mb.roundToDp(100*Sb(this).GetOpacity(),6)},Lb.IsOnLayer=function(e){return!!(e=vb(e))&&Sb(this).GetLayer()===e},Lb.PickTopBottom=function(e){const t=Gb(this).GetCurrentSol(),s=t.GetInstances();if(!s.length)return!1;let n=s[0];for(let t=1,i=s.length;t<i;++t){const i=s[t],r=i.GetWorldInfo(),a=n.GetWorldInfo(),o=r.GetLayer().GetIndex(),l=a.GetLayer().GetIndex();0===e?(o>l||o===l&&r.GetZIndex()>a.GetZIndex())&&(n=i):(o<l||o===l&&r.GetZIndex()<a.GetZIndex())&&(n=i)}return t.PickOne(n),!0},Fb.CompareZElevation=function(e,t,s){const n=this.GetWorldInfo(),i=0===e?n.GetZElevation():n.GetTotalZElevation();return Mb.compare(i,t,s)},Bb.CompareZElevation=function(e,t,s){const n=0===e?this.zElevation:this.totalZElevation;return Mb.compare(n,t,s)},Fb.MoveToTop=function(){this.GetWorldInfo().ZOrderMoveToTop()},Bb.MoveToTop=function(){this.moveToTop()},Fb.MoveToBottom=function(){this.GetWorldInfo().ZOrderMoveToBottom()},Bb.MoveToBottom=function(){this.moveToBottom()},Lb.MoveToLayer=function(e){(e=vb(e))&&Sb(this).ZOrderMoveToLayer(e)},Lb.ZMoveToObject=function(e,t){const s=0===e;if(!(t=Gb(t)))return;const n=Ib(this),i=t.GetFirstPicked(n);i&&n.GetWorldInfo().ZOrderMoveAdjacentToInstance(i,s)},Fb.SetZElevation=function(e){const t=this.GetWorldInfo();t.GetZElevation()!==e&&(t.SetZElevation(e),Ob.UpdateRender())},Bb.SetZElevation=function(e){this.zElevation=e},Lb.LayerNumber=function(){return Sb(this).GetLayer().GetIndex()},Lb.LayerName=function(){return Sb(this).GetLayer().GetName()},Fb.ZIndex=function(){return this.GetWorldInfo().GetZIndex()},Bb.ZIndex=function(){return this.zIndex},Fb.ZElevation=function(){return this.GetWorldInfo().GetZElevation()},Bb.ZElevation=function(){return this.zElevation},Fb.TotalZElevation=function(){return this.GetWorldInfo().GetTotalZElevation()},Bb.TotalZElevation=function(){return this.totalZElevation},Lb.IsEffectEnabled=function(e){const t=Ib(this),s=t.GetObjectClass().GetEffectList().GetEffectTypeByName(e);if(!s)return;const n=s.GetIndex();return t.GetWorldInfo().GetInstanceEffectList().IsEffectIndexActive(n)},Lb.SetEffectEnabled=function(e,t){const s=Ib(this),n=s.GetObjectClass().GetEffectList().GetEffectTypeByName(t);if(!n)return;const i=n.GetIndex(),r=1===e,a=s.GetWorldInfo().GetInstanceEffectList();a.IsEffectIndexActive(i)!==r&&(a.SetEffectIndexActive(i,r),a.UpdateActiveEffects(),Ob.UpdateRender())},Lb.SetEffectParam=function(e,t,s){const n=Ib(this),i=n.GetObjectClass().GetEffectList().GetEffectTypeByName(e);if(!i)return;t=Math.floor(t);const r=i.GetShaderProgram().GetParameterType(t);if(!r)return;"color"===r?(kb.setFromRgbValue(s),s=kb):"percent"===r&&(s/=100);const a=i.GetIndex(),o=n.GetWorldInfo().GetInstanceEffectList();o.SetEffectParameter(a,t,s)&&o.IsEffectIndexActive(a)&&Ob.UpdateRender()};const jb=Mb.New(Mb.Rect),Ub=[],Hb=[];let zb=!1,Xb=null,Yb=!1;const qb=new Set;function*Jb(e){if(!e)return!1;const t=this.GetRuntime(),s=t.GetCollisionEngine(),n=t.GetEventSheetManager(),i=n.GetEventStack(),r=n.GetCurrentCondition(),a=r.GetObjectClass(),o=r.GetSavedDataMap(),l=r.GetUnsavedDataMap(),c=i.GetCurrentStackFrame(),h=t.GetTickCount(),_=h-1,u=c.GetCurrentEvent(),d=i.Push(u);let p=o.get("collmemory");p||(p=Mb.New(Mb.PairMap),o.set("collmemory",p)),l.get("collisionCreatedDestroyCallback")||(l.set("collisionCreatedDestroyCallback",!0),t.Dispatcher().addEventListener("instancedestroy",(e=>Cb(p,e.instance))));const f=a.GetCurrentSol(),m=e.GetCurrentSol(),g=f.GetInstances();let I=null;for(let t=0;t<g.length;++t){const i=g[t];m.IsSelectAll()?(s.GetCollisionCandidates(i.GetWorldInfo().GetLayer(),e,i.GetWorldInfo().GetBoundingBox(),Ub),I=Ub,s.AddRegisteredCollisionCandidates(i,e,I)):I=m.GetInstances();for(let t=0;t<I.length;++t){const r=I[t];if(s.TestOverlap(i,r)||s.CheckRegisteredCollision(i,r)){const t=wb(p,i,r);let s=!1,o=-2;"number"==typeof t&&(s=!0,o=t);const l=!s||o<_;if(xb(p,i,r,h),l){const t=u.GetSolModifiers();n.PushCopySol(t);const s=a.GetCurrentSol(),o=e.GetCurrentSol();if(s._SetSelectAll(!1),o._SetSelectAll(!1),a===e){const e=s._GetOwnInstances();Mb.clearArray(e),e.push(i),e.push(r),a.ApplySolToContainer()}else{const t=s._GetOwnInstances(),n=o._GetOwnInstances();Mb.clearArray(t),Mb.clearArray(n),t.push(i),n.push(r),a.ApplySolToContainer(),e.ApplySolToContainer()}yield*u.DebugRetrigger(c,d),n.PopSol(t)}}else Tb(p,i,r)}Mb.clearArray(Ub)}return i.Pop(),!1}Lb.OnCollision=function(e){const t=Gb(this);e=Gb(e);const s=t.GetRuntime();if(s.IsDebugging())return Jb.call(t,e);if(!e)return!1;const n=s.GetCollisionEngine(),i=s.GetEventSheetManager(),r=i.GetEventStack(),a=i.GetCurrentCondition(),o=a.GetObjectClass(),l=a.GetSavedDataMap(),c=a.GetUnsavedDataMap(),h=r.GetCurrentStackFrame(),_=s.GetTickCount(),u=_-1,d=h.GetCurrentEvent(),p=r.Push(d);let f=l.get("collmemory");f||(f=Mb.New(Mb.PairMap),l.set("collmemory",f)),c.get("collisionCreatedDestroyCallback")||(c.set("collisionCreatedDestroyCallback",!0),s.Dispatcher().addEventListener("instancedestroy",(e=>Cb(f,e.instance))));const m=o.GetCurrentSol(),g=e.GetCurrentSol(),I=m.GetInstances();let S=null;for(let t=0;t<I.length;++t){const s=I[t];g.IsSelectAll()?(n.GetCollisionCandidates(s.GetWorldInfo().GetLayer(),e,s.GetWorldInfo().GetBoundingBox(),Ub),S=Ub,n.AddRegisteredCollisionCandidates(s,e,S)):S=g.GetInstances();for(let t=0;t<S.length;++t){const r=S[t];if(n.TestOverlap(s,r)||n.CheckRegisteredCollision(s,r)){const t=wb(f,s,r);let n=!1,a=-2;"number"==typeof t&&(n=!0,a=t);const l=!n||a<u;if(xb(f,s,r,_),l){const t=d.GetSolModifiers();i.PushCopySol(t);const n=o.GetCurrentSol(),a=e.GetCurrentSol();if(n._SetSelectAll(!1),a._SetSelectAll(!1),o===e){const e=n._GetOwnInstances();Mb.clearArray(e),e.push(s),e.push(r),o.ApplySolToContainer()}else{const t=n._GetOwnInstances(),i=a._GetOwnInstances();Mb.clearArray(t),Mb.clearArray(i),t.push(s),i.push(r),o.ApplySolToContainer(),e.ApplySolToContainer()}d.Retrigger(h,p),i.PopSol(t)}}else Tb(f,s,r)}Mb.clearArray(Ub)}return r.Pop(),!1},Lb.IsOverlapping=function(e){return e=Gb(e),Pb(Ib(this),e,0,0)},Lb.IsOverlappingOffset=function(e,t,s){return e=Gb(e),Pb(Ib(this),e,t,s)},Lb.OnHierarchyReady=function(){return!0},Lb.HasParent=function(){return Sb(this).HasParent()},Lb.HasChildren=function(){return Sb(this).HasChildren()},Lb.PickParent=function(e,t){const s=Gb(this);e=Gb(e);const n=s.GetRuntime(),i=this.GetCurrentSol().GetInstances();if(0===i.length)return!1;const r=e.GetCurrentSol();let a=r.GetInstances();if(r.IsSelectAll()){const t=[...n.instancesPendingCreateForObjectClass(e)];t.length>0&&(a=a.concat(t))}if(0===a.length)return!1;const o=r.IsSelectAll()?null:new Set(a),l=new Set;for(let s=0,n=i.length;s<n;++s){const n=i[s];if(1===t)for(const t of n.parents())t.BelongsToObjectClass(e)&&(null===o||o.has(t))&&l.add(t);else{let s;if(0===t){if(s=n.GetParent(),null===s)continue}else s=n.GetTopParent();s.BelongsToObjectClass(e)&&(null===o||o.has(s))&&l.add(s)}}return 0!==l.size&&(r.SetSetPicked(l),e.ApplySolToContainer(),!0)},Lb.PickChildren=function(e,t){const s=Gb(this);e=Gb(e);const n=s.GetRuntime(),i=s.GetCurrentSol().GetInstances();if(0===i.length)return!1;const r=e.GetCurrentSol();let a=r.GetInstances();if(r.IsSelectAll()){const t=[...n.instancesPendingCreateForObjectClass(e)];t.length>0&&(a=a.concat(t))}if(0===a.length)return!1;const o=r.IsSelectAll()?null:new Set(a),l=new Set;for(let s=0,n=i.length;s<n;++s){const n=i[s];2!==t||n.HasChildren()||!n.BelongsToObjectClass(e)||null!==o&&!o.has(n)||l.add(n);for(const s of 0===t?n.children():n.allChildren())2===t&&s.HasChildren()||s.BelongsToObjectClass(e)&&(null===o||o.has(s))&&l.add(s)}return 0!==l.size&&(r.SetSetPicked(l),e.ApplySolToContainer(),!0)},Lb.PickNthChild=function(e,t,s){const n=Gb(this);e=Gb(e);const i=n.GetRuntime(),r=n.GetCurrentSol().GetInstances();if(0===r.length)return!1;const a=e.GetCurrentSol();let o=a.GetInstances();if(a.IsSelectAll()){const t=[...i.instancesPendingCreateForObjectClass(e)];t.length>0&&(o=o.concat(t))}if(0===o.length)return!1;const l=a.IsSelectAll()?null:new Set(o),c=[];for(let n=0,i=r.length;n<i;++n){const i=r[n];if(0===t){const t=i.GetChildAt(s);null!==t&&t.BelongsToObjectClass(e)&&(null===l||l.has(t))&&c.push(t)}else if(1===t)for(const t of i.children())if(t.BelongsToObjectClass(e)){if(0===s){(null===l||l.has(t))&&c.push(t);break}--s}}return 0!==c.length&&(a.SetArrayPicked(c),e.ApplySolToContainer(),!0)},Lb.CompareChildCount=function(e,t,s){const n=Ib(this);switch(e){case 0:default:return Mb.compare(n.GetChildCount(),t,s);case 1:return Mb.compare(n.GetAllChildCount(),t,s)}},Lb.AddChild=function(e,t,s,n,i,r,a,o,l,c){e=Gb(e);const h=Ib(this),_=Ob.GetCurrentAction().GetObjectClass();for(const u of e.allCorrespondingInstances(h,_)){if(!u.GetPlugin().SupportsSceneGraph())return;h.AddChild(u,{transformX:t,transformY:s,transformWidth:n,transformHeight:i,transformAngle:r,transformOpacity:a,transformZElevation:o,transformVisibility:l,destroyWithParent:c})}},Lb.RemoveChild=function(e){e=Gb(e);const t=Ib(this),s=Ob.GetCurrentAction().GetObjectClass();for(const n of e.allCorrespondingInstances(t,s))t.RemoveChild(n)},Lb.RemoveFromParent=function(){const e=Ib(this);e.HasParent()&&e.GetParent().RemoveChild(e)},Lb.ParentUID=function(){const e=Ib(this).GetParent();return e?e.GetUID():-1},Lb.ChildCount=function(){return Ib(this).GetChildCount()},Lb.AllChildCount=function(){return Ib(this).GetAllChildCount()},Lb.SetMeshSize=function(e,t){e=Math.floor(e),t=Math.floor(t);const s=Sb(this);e<2||t<2||!isFinite(e)||!isFinite(t)?(s.ReleaseMesh(),s.SetBboxChanged()):s.CreateMesh(e,t)},Lb.SetMeshPoint=function(e,t,s,n,i,r,a,o){const l=Sb(this);l.SetMeshPoint(e,t,{mode:0===s?"absolute":"relative",x:n,y:i,zElevation:r,u:a,v:o})&&l.SetBboxChanged()},Lb.MeshColumns=function(){const e=Sb(this);return e.HasMesh()?e.GetSourceMesh().GetHSize():0},Lb.MeshRows=function(){const e=Sb(this);return e.HasMesh()?e.GetSourceMesh().GetVSize():0},Lb.SetElementVisible=function(e){const t=Sb(this);e=2===e?!t.IsVisible():0!==e,t.IsVisible()!==e&&t.SetVisible(e)},Lb.SetElementCSSStyle=function(e,t){this instanceof self.IInstance?this.setElementCSSStyle(e,t):this.SetElementCSSStyle(e,t)},Lb.SetElementAttribute=function(e,t){this instanceof self.IInstance?this.setElementAttribute(e,""+t):this.SetElementAttribute(e,""+t)},Lb.RemoveElementAttribute=function(e){this instanceof self.IInstance?this.removeElementAttribute(e):this.RemoveElementAttribute(e)},Lb.SetElementFocus=function(){this instanceof self.IInstance?this.focusElement():this.FocusElement()},Lb.SetElementBlur=function(){this instanceof self.IInstance?this.blurElement():this.BlurElement()},Lb.IsElementFocused=function(){return this instanceof self.IInstance?this.isElementFocused():this.IsElementFocused()},Lb.SetElementEnabled=function(e){this instanceof self.IInstance?this._setEnabled(0!==e):this._SetEnabled(0!==e)},Lb.IsElementEnabled=function(){return this instanceof self.IInstance?this._isEnabled():this._IsEnabled()},Fb.CompareInstanceVar=function(e,t,s){return Mb.compare(this.GetInstance().GetInstanceVariableValue(e),t,s)},Bb.CompareInstanceVar=function(e,t,s){return Mb.compare(yb(this).GetInstanceVariableValue(e),t,s)},Fb.IsBoolInstanceVarSet=function(e){return!!this.GetInstance().GetInstanceVariableValue(e)},Bb.IsBoolInstanceVarSet=function(e){return!!yb(this).GetInstanceVariableValue(e)},Lb.PickInstVarHiLow=function(e,t){const s=Gb(this),n=s.GetCurrentSol(),i=n.GetInstances();if(!i.length)return!1;const r=s.IsFamily();let a=null,o=0;for(let n=0,l=i.length;n<l;++n){const l=i[n],c=r?l.GetObjectClass().GetFamilyInstanceVariableOffset(s.GetFamilyIndex()):0,h=l.GetInstanceVariableValue(c+t);(null===a||0===e&&h<o||1===e&&h>o)&&(o=h,a=l)}return n.PickOne(a),!0},Lb.PickByUID=function(e){const t=Gb(this);return t.GetRuntime().GetCurrentCondition().IsInverted()?Eb(t,e):Db(t,e)},Lb.HasTags=function(e){const t=new Set(Mb.splitStringAndNormalize(e)),s=Ib(this).GetTagsSet();return t.isSubsetOf(s)},Lb.Tags=function(){return Ib(this).GetTagsString()},Lb.TagsCount=function(){return Ib(this).GetTagsSet().size},Lb.TagAt=function(e){return Ib(this).GetTagAt(e)},Lb.ChangeTags=function(e,t){const s=Mb.splitStringAndNormalize(t);if(0===s.length)return;const n=Ib(this),i=new Set(n.GetTagsSet());if(0===e)for(const e of s)i.add(e);else if(1===e)for(const e of s)i.delete(e);n.SetTagsSet(i)},Lb.Destroy=function(){Ob.DestroyInstance(Ib(this))},Lb.OnCreated=function(){return!0},Lb.OnDestroyed=function(){return!0},Fb.SetInstanceVar=function(e,t){this.GetInstance().SetInstanceVariableValue(e,t)},Bb.SetInstanceVar=function(e,t){yb(this).SetInstanceVariableValue(e,t)},Fb.AddInstanceVar=function(e,t){const s=this.GetInstance(),n=s.GetInstanceVariableValue(e);"number"==typeof n&&"number"!=typeof t?t=parseFloat(t):"string"==typeof n&&"string"!=typeof t&&(t=t.toString()),s.SetInstanceVariableValue(e,n+t)},Bb.AddInstanceVar=function(e,t){const s=yb(this),n=s.GetInstanceVariableValue(e);"number"==typeof n&&"number"!=typeof t?t=parseFloat(t):"string"==typeof n&&"string"!=typeof t&&(t=t.toString()),s.SetInstanceVariableValue(e,n+t)},Fb.SubInstanceVar=function(e,t){const s=this.GetInstance(),n=s.GetInstanceVariableValue(e);"number"==typeof n&&("number"!=typeof t&&(t=parseFloat(t)),s.SetInstanceVariableValue(e,n-t))},Bb.SubInstanceVar=function(e,t){const s=yb(this),n=s.GetInstanceVariableValue(e);"number"==typeof n&&("number"!=typeof t&&(t=parseFloat(t)),s.SetInstanceVariableValue(e,n-t))},Fb.SetBoolInstanceVar=function(e,t){this.GetInstance().SetInstanceVariableValue(e,t?1:0)},Bb.SetBoolInstanceVar=function(e,t){yb(this).SetInstanceVariableValue(e,t?1:0)},Fb.ToggleBoolInstanceVar=function(e){const t=this.GetInstance();t.SetInstanceVariableValue(e,0===t.GetInstanceVariableValue(e)?1:0)},Bb.ToggleBoolInstanceVar=function(e){const t=yb(this);t.SetInstanceVariableValue(e,0===t.GetInstanceVariableValue(e)?1:0)},Lb.LoadFromJsonString=function(e){let t;try{t=JSON.parse(e)}catch(e){return void console.error("Failed to load from JSON string: ",e)}const s=Ib(this),n="state";Ob.ClearIntancesNeedingAfterLoad(),s._OnBeforeLoad(n),s.LoadFromJson(t,n),Ob.DoAfterLoad(n,{setFromJson:!0})},Lb.AsJSON=function(){return JSON.stringify(Ib(this).SaveToJson("state"))},Lb.ObjectTypeName=function(){return Ib(this).GetObjectClass().GetName()},Lb.Count=function(){const e=Ob.GetCurrentEventStackFrame().GetExpressionObjectClass();let t=e.GetInstanceCount();for(const s of Ob.instancesPendingCreateForObjectClass(e))++t;return t},Lb.PickedCount=function(){return Ob.GetCurrentEventStackFrame().GetExpressionObjectClass().GetCurrentSol().GetInstances().length},Fb.GetIID=function(){return this.GetInstance().GetIID()},Bb.GetIID=function(){return yb(this).GetIID()},Fb.GetUID=function(){return this.GetInstance().GetUID()},Bb.GetUID=function(){return yb(this).GetUID()},Lb.OnInstanceSignal=function(e){const t=Ib(this);return e.toLowerCase()===Ob.GetEventSheetManager().GetCurrentInstanceSignalTag(t)},Lb.InstanceSignal=function(e){const t=Ib(this);Ob.GetEventSheetManager().InstanceSignal(t,e)},Lb.InstanceWaitForSignal=function(e){const t=Gb(this);return Ob.GetEventSheetManager().AddScheduledWait().InitInstanceSignals(t.GetCurrentSol().GetInstances(),e),!0},Lb.TemplateName=function(){return Ib(this).GetTemplateName()},Mb.AddCommonACEs=function(e,t,s){const n=e[1],i=e[3],r=e[4],a=e[5],o=e[6],l=e[7],c=e[8],h=e[10],_=e[11],u=e[12],d=e[13],p=e[14],f=e[15],m=e[16],g=t.Cnds,I=t.Acts,S=t.Exps,y=Object.assign({},Lb,s>=2?Bb:Fb);i&&(g.CompareX=y.CompareX,g.CompareY=y.CompareY,g.IsOnScreen=y.IsOnScreen,g.IsOutsideLayout=y.IsOutsideLayout,g.PickDistance=y.PickDistance,I.SetX=y.SetX,I.SetY=y.SetY,I.SetPos=y.SetPos,I.SetPosToObject=y.SetPosToObject,I.MoveForward=y.MoveForward,I.MoveAtAngle=y.MoveAtAngle,S.X=y.GetX,S.Y=y.GetY,S.dt=y.GetDt),r&&(g.CompareWidth=y.CompareWidth,g.CompareHeight=y.CompareHeight,I.SetWidth=y.SetWidth,I.SetHeight=y.SetHeight,I.SetSize=y.SetSize,S.Width=y.GetWidth,S.Height=y.GetHeight,S.BBoxLeft=y.GetBboxLeft,S.BBoxTop=y.GetBboxTop,S.BBoxRight=y.GetBboxRight,S.BBoxBottom=y.GetBboxBottom,S.BBoxMidX=y.GetBboxMidX,S.BBoxMidY=y.GetBboxMidY),a&&(g.AngleWithin=y.IsAngleWithin,g.IsClockwiseFrom=y.IsAngleClockwiseFrom,g.IsBetweenAngles=y.IsBetweenAngles,I.SetAngle=y.SetAngle,I.RotateClockwise=y.RotateClockwise,I.RotateCounterclockwise=y.RotateCounterclockwise,I.RotateTowardAngle=y.RotateTowardAngle,I.RotateTowardPosition=y.RotateTowardPosition,I.SetTowardPosition=y.SetTowardPosition,S.Angle=y.GetAngle),o&&(g.IsVisible=y.IsVisible,g.CompareOpacity=y.CompareOpacity,I.SetVisible=y.SetVisible,I.SetOpacity=y.SetOpacity,I.SetDefaultColor=y.SetDefaultColor,S.Opacity=y.GetOpacity,S.ColorValue=y.GetColor),l&&(g.IsOnLayer=y.IsOnLayer,g.PickTopBottom=y.PickTopBottom,g.CompareZElevation=y.CompareZElevation,I.MoveToTop=y.MoveToTop,I.MoveToBottom=y.MoveToBottom,I.MoveToLayer=y.MoveToLayer,I.ZMoveToObject=y.ZMoveToObject,I.SetZElevation=y.SetZElevation,S.LayerNumber=y.LayerNumber,S.LayerName=y.LayerName,S.ZIndex=y.ZIndex,S.ZElevation=y.ZElevation,S.TotalZElevation=y.TotalZElevation),c&&(g.IsEffectEnabled=y.IsEffectEnabled,I.SetEffectEnabled=y.SetEffectEnabled,I.SetEffectParam=y.SetEffectParam),d&&(g.OnHierarchyReady=y.OnHierarchyReady,g.HasParent=y.HasParent,g.HasChildren=y.HasChildren,g.PickParent=y.PickParent,g.PickChildren=y.PickChildren,g.PickNthChild=y.PickNthChild,g.CompareChildCount=y.CompareChildCount,I.AddChild=y.AddChild,I.RemoveChild=y.RemoveChild,I.RemoveFromParent=y.RemoveFromParent,S.ParentUID=y.ParentUID,S.ChildCount=y.ChildCount,S.AllChildCount=y.AllChildCount),p&&(I.SetMeshSize=y.SetMeshSize,I.SetMeshPoint=y.SetMeshPoint,S.MeshColumns=y.MeshColumns,S.MeshRows=y.MeshRows),h&&(g.IsVisible=y.IsVisible,I.SetVisible=y.SetElementVisible,I.SetCSSStyle=y.SetElementCSSStyle,I.SetElemAttribute=y.SetElementAttribute,I.RemoveElemAttribute=y.RemoveElementAttribute),_&&(g.IsFocused=y.IsElementFocused,I.SetFocus=y.SetElementFocus,I.SetBlur=y.SetElementBlur),u&&(g.IsEnabled=y.IsElementEnabled,I.SetEnabled=y.SetElementEnabled),f&&(g.OnCollision=y.OnCollision,g.IsOverlapping=y.IsOverlapping,g.IsOverlappingOffset=y.IsOverlappingOffset,t.FinishCollisionCondition=Rb),n||(g.CompareInstanceVar=y.CompareInstanceVar,g.IsBoolInstanceVarSet=y.IsBoolInstanceVarSet,g.PickInstVarHiLow=y.PickInstVarHiLow,g.PickByUID=y.PickByUID,g.HasTags=y.HasTags,I.SetInstanceVar=y.SetInstanceVar,I.AddInstanceVar=y.AddInstanceVar,I.SubInstanceVar=y.SubInstanceVar,I.SetBoolInstanceVar=y.SetBoolInstanceVar,I.ToggleBoolInstanceVar=y.ToggleBoolInstanceVar,I.ChangeTags=y.ChangeTags,g.OnCreated=y.OnCreated,g.OnDestroyed=y.OnDestroyed,I.Destroy=y.Destroy,I.LoadFromJsonString||(I.LoadFromJsonString=y.LoadFromJsonString),S.AsJSON||(S.AsJSON=y.AsJSON),S.Count=y.Count,S.PickedCount=y.PickedCount,S.IID=y.GetIID,S.UID=y.GetUID,S.ObjectTypeName=y.ObjectTypeName,S.Tags=y.Tags,S.TagsCount=y.TagsCount,S.TagAt=y.TagAt,g.OnInstanceSignal=y.OnInstanceSignal,I.InstanceSignal=y.InstanceSignal,I.InstanceWaitForSignal=y.InstanceWaitForSignal),m&&(S.TemplateName=y.TemplateName)}}{const Kb=self.C3;Kb.ScheduledWait=class extends Kb.DefendedBase{constructor(e){super(),this._eventSheetManager=e,this._type="",this._time=-1,this._signalTag="",this._isSignalled=!1,this._event=null,this._actIndex=0,this._solModifiers=[],this._dynamicSolModifiers=null,this._sols=new Map,this._pendingInstances=null,this._callingFunctionBlock=null,this._asyncId=-1,this._functionParameters=null,this._functionInnerLocalVars=null,this._shouldRelease=!1}Release(){this._type="",this._time=-1,this._signalTag="",this._event=null,this._callingFunctionBlock=null,this._functionParameters=null,this._functionInnerLocalVars=null,this._asyncId=-1,Kb.clearArray(this._solModifiers),this._dynamicSolModifiers&&(this._dynamicSolModifiers.clear(),this._dynamicSolModifiers=null);for(const e of this._sols.values())e.Release();this._sols.clear(),this._pendingInstances=null}_Init(){const e=this._eventSheetManager,t=e.GetRuntime().GetAllObjectClasses(),s=e.GetCurrentEventStackFrame();this._event=s.GetCurrentEvent(),this._actIndex=s.GetActionIndex()+1;const n=e.FindFirstFunctionBlockParent(this._event);n&&(this._callingFunctionBlock=n,this._functionParameters=n.CaptureFunctionParameters(),this._functionInnerLocalVars=n._GetAllInnerLocalVariables().map((e=>e.GetValue())),n.IsAsync()&&(this._asyncId=n.PauseCurrentAsyncFunction()));for(const e of t){const t=e.GetCurrentSol();t.IsSelectAll()&&!this._event.HasSolModifier(e)||(this._solModifiers.push(e),this._sols.set(e,Kb.New(Kb.SolState,t)))}const i=e.GetDynamicSolModifiersSet();this._dynamicSolModifiers=i.size>0?i:null}InitTimer(e){this._type="timer",this._Init(),this._time=this._eventSheetManager.GetRuntime().GetGameTime()+e}InitWallTimer(e){this._type="walltimer",this._Init(),this._time=this._eventSheetManager.GetRuntime().GetWallTime()+e}InitSignal(e){this._type="signal",this._Init(),this._signalTag=e.toLowerCase()}InitInstanceSignals(e,t){this._type="instance-signals",this._Init(),this._signalTag=t.toLowerCase(),this._pendingInstances=new Set(e)}InitPromise(e){this._type="promise",this._Init(),e.then((()=>this.SetSignalled())).catch((e=>{console.warn("[C3 runtime] Promise rejected in 'Wait for previous actions to complete': ",e),this.SetSignalled()}))}IsTimer(){return"timer"===this._type}IsWallTimer(){return"walltimer"===this._type}IsSignal(){return"signal"===this._type}IsInstanceSignals(){return"instance-signals"===this._type}IsPromise(){return"promise"===this._type}GetSignalTag(){return this._signalTag}IsSignalled(){return this._isSignalled}SetSignalled(){this._isSignalled=!0}SetInstanceSignalled(e){this._pendingInstances.delete(e),0===this._pendingInstances.size&&this.SetSignalled()}_ShouldRun(){return this.IsTimer()?this._time<=this._eventSheetManager.GetRuntime().GetGameTime():this.IsWallTimer()?this._time<=this._eventSheetManager.GetRuntime().GetWallTime():this.IsSignalled()}_RestoreState(e){e._Restore(this._event,this._actIndex);for(const[e,t]of this._sols.entries()){const s=e.GetCurrentSol();t._Restore(s)}this._dynamicSolModifiers&&e.SetDynamicSolModifiers([...this._dynamicSolModifiers]);const t=this._callingFunctionBlock;t&&(t.SetFunctionParameters(this._functionParameters),t._GetAllInnerLocalVariables().map(((e,t)=>e.SetValue(this._functionInnerLocalVars[t]))),t.IsAsync()&&t.ResumeAsyncFunction(this._asyncId))}_Run(e){this._RestoreState(e),this._event._ResumeActionsAndSubEvents(e),this._callingFunctionBlock&&this._callingFunctionBlock.IsAsync()&&this._callingFunctionBlock.MaybeFinishAsyncFunctionCall(this._asyncId),this._eventSheetManager.ClearSol(this._solModifiers),this._shouldRelease=!0}async _DebugRun(e){this._RestoreState(e);for(const t of this._event._DebugResumeActionsAndSubEvents(e))await this._eventSheetManager.GetRuntime().DebugBreak(t);this._callingFunctionBlock&&this._callingFunctionBlock.IsAsync()&&this._callingFunctionBlock.MaybeFinishAsyncFunctionCall(this._asyncId),this._eventSheetManager.ClearSol(this._solModifiers),this._shouldRelease=!0}ShouldRelease(){return this._shouldRelease}RemoveInstances(e){for(const t of this._sols.values())t.RemoveInstances(e);if("instance-signals"===this._type){for(const t of e)this._pendingInstances.delete(t);0===this._pendingInstances.size&&this.SetSignalled()}}_SaveToJson(){const e={},t={wt:this._type,t:this._time,st:this._signalTag,s:this._isSignalled,ev:this._event.GetSID(),sm:this._solModifiers.map((e=>e.GetSID())),dsm:this._dynamicSolModifiers?[...this._dynamicSolModifiers].map((e=>e.GetSID())):null,sols:e};this._event._HasActionIndex(this._actIndex)&&(t.act=this._event.GetActionAt(this._actIndex).GetSID());for(const[t,s]of this._sols)e[t.GetSID().toString()]=s._SaveToJson();return"instance-signals"===this._type&&(t.pi=[...this._pendingInstances].map((e=>e.GetUID()))),t}static _CreateFromJson(e,t){const s=e.GetRuntime(),n=e.GetEventBlockBySID(t.ev);if(!n)return null;let i=0;if(t.hasOwnProperty("act")){const s=e.GetActionBySID(t.act);if(!s)return null;i=s.GetIndex()}const r=Kb.New(Kb.ScheduledWait,e);r._time=t.t,t.hasOwnProperty("wt")?r._type=t.wt:r._type=-1===r._time?"signal":"timer",r._signalTag=t.st,r._isSignalled=t.s,r._event=n,r._actIndex=i;for(const e of t.sm){const t=s.GetObjectClassBySID(e);t&&r._solModifiers.push(t)}if(Array.isArray(t.dsm))for(const e of t.dsm){const t=s.GetObjectClassBySID(e);t&&(r._dynamicSolModifiers||(r._dynamicSolModifiers=new Set),r._dynamicSolModifiers.add(t))}for(const[n,i]of Object.entries(t.sols)){const t=parseInt(n,10),a=s.GetObjectClassBySID(t);if(!a)continue;const o=Kb.New(Kb.SolState,null);o._LoadFromJson(e,i),r._sols.set(a,o)}if("instance-signals"===r._type){r._pendingInstances=new Set;for(const e of t.pi){const t=s.GetInstanceByUID(e);t&&r._pendingInstances.add(t)}}return r}}}{const $b=self.C3;$b.SolState=class extends $b.DefendedBase{constructor(e){super(),this._objectClass=null,this._isSelectAll=!0,this._instances=[],e&&(this._objectClass=e.GetObjectClass(),this._isSelectAll=e.IsSelectAll(),$b.shallowAssignArray(this._instances,e._GetOwnInstances()))}Release(){this._objectClass=null,$b.clearArray(this._instances)}_Restore(e){e._SetSelectAll(this._isSelectAll),$b.shallowAssignArray(e._GetOwnInstances(),this._instances)}RemoveInstances(e){$b.arrayRemoveAllInSet(this._instances,e)}_SaveToJson(){return{sa:this._isSelectAll,insts:this._instances.map((e=>e.GetUID()))}}_LoadFromJson(e,t){const s=e.GetRuntime();this._isSelectAll=!!t.sa,$b.clearArray(this._instances);for(const e of t.insts){const t=s.GetInstanceByUID(e);t&&this._instances.push(t)}}}}{let Zb=function(e,t){let s=e.get(t);return s||(s=new Map,e.set(t,s)),s};GetNextParamMap=Zb;const Qb=self.C3;Qb.SDKPluginBase=class extends Qb.DefendedBase{constructor(e){super(),this._runtime=e.runtime,this._id=e.id,this._name=e.name??"",this._isSingleGlobal=!!e.isSingleGlobal,this._isWorldType=!!e.isWorld,this._isRotatable=!!e.isRotatable,this._mustPredraw=!!e.mustPredraw,this._hasEffects=!!e.hasEffects,this._supportsSceneGraph=!!e.supportsSceneGraph,this._supportsMesh=!!e.supportsMesh,this._isHTMLElementType=!!e.isHTMLElementType,this._is3d=!!e.is3d,this._sdkVersion=e.sdkVersion,this._singleGlobalObjectClass=null,this._boundACEMethodCache=new Map,this._boundACEMethodCache_1param=new Map,this._boundACEMethodCache_2params=new Map,this._boundACEMethodCache_3params=new Map,this._scriptInterfaceClass=e.scriptInterfaceClass,this._iPlugin=null}Release(){this._runtime=null}GetRuntime(){return this._runtime}GetID(){return this._id}GetName(){return this._name}OnCreate(){}GetConstructor(){return this.GetSdkVersion()>=2?this._iPlugin.constructor:this.constructor}GetSdkVersion(){return this._sdkVersion}GetScriptInterfaceClass(e=!1){let t=this._scriptInterfaceClass;return e&&"function"!=typeof t&&this.GetSdkVersion()>=2&&(t=globalThis.ISDKPluginBase),t}IsSingleGlobal(){return this._isSingleGlobal}IsWorldType(){return this._isWorldType}IsHTMLElementType(){return this._isHTMLElementType}Is3D(){return this._is3d}IsRotatable(){return this._isRotatable}MustPreDraw(){return this._mustPredraw}HasEffects(){return this._hasEffects}SupportsSceneGraph(){return this._supportsSceneGraph}SupportsMesh(){return this._supportsMesh}_GetBoundACEMethod(e,t){if(!t)throw new Error("missing 'this' binding");let s=this._boundACEMethodCache.get(e);return s||(s=e.bind(t),this._boundACEMethodCache.set(e,s),s)}_GetBoundACEMethod_1param(e,t,s){if(!t)throw new Error("missing 'this' binding");const n=Zb(this._boundACEMethodCache_1param,e);let i=n.get(s);return i||(i=e.bind(t,s),n.set(s,i),i)}_GetBoundACEMethod_2params(e,t,s,n){if(!t)throw new Error("missing 'this' binding");const i=Zb(this._boundACEMethodCache_2params,e),r=Zb(i,s);let a=r.get(n);return a||(a=e.bind(t,s,n),r.set(n,a),a)}_GetBoundACEMethod_3params(e,t,s,n,i){if(!t)throw new Error("missing 'this' binding");const r=Zb(this._boundACEMethodCache_3params,e),a=Zb(r,s),o=Zb(a,n);let l=o.get(i);return l||(l=e.bind(t,s,n,i),o.set(i,l),l)}_SetSingleGlobalObjectClass(e){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");this._singleGlobalObjectClass=e}GetSingleGlobalObjectClass(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass}GetSingleGlobalInstance(){if(!this.IsSingleGlobal())throw new Error("must be single-global plugin");return this._singleGlobalObjectClass.GetSingleGlobalInstance()}_InitScriptInterface(){const e=this.GetSdkVersion();Qb.AddonManager._PushInitObject(this,e);const t=this.GetScriptInterfaceClass(!0);if(t){if(this._iPlugin=new t,!(this._iPlugin instanceof self.IPlugin))throw new TypeError("plugin class must derive from IPlugin")}else this._iPlugin=new self.IPlugin;Qb.AddonManager._PopInitObject(e)}GetIPlugin(){return this._iPlugin}}}{const eG=self.C3;eG.SDKDOMPluginBase=class extends eG.SDKPluginBase{constructor(e,t){super(e),this._domComponentId=t,this._nextElementId=0,this._instMap=new Map,this.AddElementMessageHandler("elem-focused",(e=>e._OnElemFocused())),this.AddElementMessageHandler("elem-blurred",(e=>{e&&e._OnElemBlurred()}))}Release(){super.Release()}_AddElement(e){const t=this._nextElementId++;return this._instMap.set(t,e),t}_RemoveElement(e){this._instMap.delete(e)}AddElementMessageHandler(e,t){this._runtime.AddDOMComponentMessageHandler(this._domComponentId,e,(e=>{const s=this._instMap.get(e.elementId);t(s,e)}))}}}{const tG=self.C3;tG.SDKTypeBase=class extends tG.DefendedBase{constructor(e){super(),this._objectClass=e,this._runtime=e.GetRuntime(),this._plugin=e.GetPlugin()}Release(){this._objectClass=null,this._runtime=null,this._plugin=null}GetObjectClass(){return this._objectClass}GetRuntime(){return this._runtime}GetPlugin(){return this._plugin}GetImageInfo(){return this._objectClass.GetImageInfo()}OnCreate(){}FinishCondition(e){}BeforeRunAction(e){}AfterRunAction(e){}LoadTextures(e){}ReleaseTextures(){}OnDynamicTextureLoadComplete(){}PreloadTexturesWithInstances(e){}LoadTilemapData(){}GetScriptInterfaceClass(){return null}DispatchScriptEvent(e,t,s){const n=tG.New(tG.Event,e,t);n.objectClass=this,s&&Object.assign(n,s),this.GetObjectClass().DispatchUserScriptEvent(n)}}}{const sG=self.C3;sG.SDKInstanceBase=class extends sG.DefendedBase{constructor(e,t){super(),this._inst=e,this._domComponentId=t,this._wrapperComponentId=null,this._runtime=e.GetRuntime(),this._objectClass=this._inst.GetObjectClass(),this._sdkType=this._objectClass.GetSdkType(),this._tickFunc=null,this._tick2Func=null,this._isTicking=!1,this._isTicking2=!1,this._disposables=null,this._wasReleased=!1}Release(){this._wasReleased=!0,this._StopTicking(),this._StopTicking2(),this._tickFunc=null,this._tick2Func=null,this._disposables&&(this._disposables.Release(),this._disposables=null),this._inst=null,this._runtime=null,this._objectClass=null,this._sdkType=null}WasReleased(){return this._wasReleased}GetInstance(){return this._inst}GetRuntime(){return this._runtime}GetObjectClass(){return this._objectClass}GetPlugin(){return this._sdkType.GetPlugin()}GetSdkType(){return this._sdkType}GetScriptInterface(){return this._inst.GetInterfaceClass()}Trigger(e){return this._runtime.Trigger(e,this._inst,null)}DebugTrigger(e){return this._runtime.DebugTrigger(e,this._inst,null)}TriggerAsync(e){return this._runtime.TriggerAsync(e,this._inst,null)}FastTrigger(e,t){return this._runtime.FastTrigger(e,this._inst,t)}DebugFastTrigger(e,t){return this._runtime.DebugFastTrigger(e,this._inst,t)}ScheduleTriggers(e){return this._runtime.ScheduleTriggers(e)}AddDOMMessageHandler(e,t){this._runtime.AddDOMComponentMessageHandler(this._domComponentId,e,t)}AddDOMMessageHandlers(e){for(const[t,s]of e)this.AddDOMMessageHandler(t,s)}PostToDOM(e,t){this._runtime.PostComponentMessageToDOM(this._domComponentId,e,t)}PostToDOMAsync(e,t){return this._runtime.PostComponentMessageToDOMAsync(this._domComponentId,e,t)}_PostToDOMMaybeSync(e,t){if(!this._runtime.IsInWorker())return window.c3_runtimeInterface._OnMessageFromRuntime({type:"event",component:this._domComponentId,handler:e,data:t,responseId:null});this.PostToDOM(e,t)}SetWrapperExtensionComponentId(e){if(!e)throw new Error("cannot set empty component id");this._wrapperComponentId=e}IsWrapperExtensionAvailable(){if(!this._wrapperComponentId)throw new Error("wrapper extension component id not set");return this._runtime.HasWrapperComponentId(this._wrapperComponentId)}AddWrapperExtensionMessageHandler(e,t){if(!this._wrapperComponentId)throw new Error("wrapper extension component id not set");this._runtime.AddWrapperExtensionMessageHandler(this._wrapperComponentId,e,t)}AddWrapperExtensionMessageHandlers(e){for(const[t,s]of e)this.AddWrapperExtensionMessageHandler(t,s)}SendWrapperExtensionMessage(e,t){if(!this._wrapperComponentId)throw new Error("wrapper extension component id not set");this._runtime.SendWrapperExtensionMessage(this._wrapperComponentId,e,t)}SendWrapperExtensionMessageAsync(e,t){if(!this._wrapperComponentId)throw new Error("wrapper extension component id not set");return this._runtime.SendWrapperExtensionMessageAsync(this._wrapperComponentId,e,t)}Tick(){}Tick2(){}_StartTicking(){if(!this._isTicking){if(!this._tickFunc)if(this._runtime.IsDebug()){const e=globalThis.C3Debugger,t=this.GetPlugin();this._tickFunc=()=>{const s=performance.now();this.Tick(),e.AddIndividualPluginTickTime(t,performance.now()-s)}}else this._tickFunc=()=>this.Tick();this._runtime.Dispatcher().addEventListener("tick",this._tickFunc),this._isTicking=!0}}_StopTicking(){this._isTicking&&(this._runtime.Dispatcher().removeEventListener("tick",this._tickFunc),this._isTicking=!1)}IsTicking(){return this._isTicking}_StartTicking2(){if(!this._isTicking2){if(!this._tick2Func)if(this._runtime.IsDebug()){const e=globalThis.C3Debugger,t=this.GetPlugin();this._tick2Func=()=>{const s=performance.now();this.Tick2(),e.AddIndividualPluginTickTime(t,performance.now()-s)}}else this._tick2Func=()=>this.Tick2();this._runtime.Dispatcher().addEventListener("tick2",this._tick2Func),this._isTicking2=!0}}_StopTicking2(){this._isTicking2&&(this._runtime.Dispatcher().removeEventListener("tick2",this._tick2Func),this._isTicking2=!1)}IsTicking2(){return this._isTicking2}GetDebuggerProperties(){return[]}SaveToJson(){return null}LoadFromJson(e){}GetPropertyValueByIndex(e){}SetPropertyValueByIndex(e,t){}OffsetPropertyValueByIndex(e,t,s){if(0===t)return;const n=this.GetPropertyValueByIndex(e);if("number"!=typeof n)throw new Error("expected number");this.SetPropertyValueByIndex(e,n+t,s)}SetPropertyColorOffsetValueByIndex(e,t,s,n){}CallAction(e,...t){e.call(this,...t)}CallExpression(e,...t){return e.call(this,...t)}GetScriptInterfaceClass(){return null}DispatchScriptEvent(e,t,s){if(!this._inst.HasScriptInterface())return;const n=this.GetScriptInterface(),i=sG.New(sG.Event,e,t);i.instance=n,s&&Object.assign(i,s),n.dispatchEvent(i)}MustPreDraw(){return!1}}}{const nG=self.C3;nG.SDKWorldInstanceBase=class extends nG.SDKInstanceBase{constructor(e,t){super(e,t),this._worldInfo=e.GetWorldInfo(),this._renderercontextlost_handler=null,this._renderercontextrestored_handler=null}Release(){if(this._renderercontextlost_handler){const e=this._runtime.Dispatcher();e.removeEventListener("renderercontextlost",this._renderercontextlost_handler),e.removeEventListener("renderercontextrestored",this._renderercontextrestored_handler),this._renderercontextlost_handler=null,this._renderercontextrestored_handler=null}this._worldInfo=null,super.Release()}HandleWebGLContextLoss(){this.HandleRendererContextLoss()}OnWebGLContextLost(){}OnWebGLContextRestored(){}HandleRendererContextLoss(){if(this._renderercontextlost_handler)return;this._renderercontextlost_handler=()=>this.OnRendererContextLost(),this._renderercontextrestored_handler=()=>this.OnRendererContextRestored();const e=this._runtime.Dispatcher();e.addEventListener("renderercontextlost",this._renderercontextlost_handler),e.addEventListener("renderercontextrestored",this._renderercontextrestored_handler)}OnRendererContextLost(){this.OnWebGLContextLost()}OnRendererContextRestored(){this.OnWebGLContextRestored()}GetWorldInfo(){return this._worldInfo}IsOriginalSizeKnown(){return!1}GetOriginalWidth(){if(!this.IsOriginalSizeKnown())throw new Error("original size not known");const e=this.GetCurrentImageInfo();if(e)return e.GetWidth()}GetOriginalHeight(){if(!this.IsOriginalSizeKnown())throw new Error("original size not known");const e=this.GetCurrentImageInfo();if(e)return e.GetHeight()}GetCurrentImageInfo(){return null}GetCurrentSurfaceSize(){const e=this.GetCurrentImageInfo();if(e){const t=e.GetTexture();if(t)return[t.GetWidth(),t.GetHeight()]}return[100,100]}GetCurrentTexRect(){const e=this.GetCurrentImageInfo();return e?e.GetTexRect():null}GetCurrentTexQuad(){const e=this.GetCurrentImageInfo();return e?e.GetTexQuad():null}IsCurrentTexRotated(){const e=this.GetCurrentImageInfo();return!!e&&e.IsRotated()}GetImagePoint(e){const t=this._inst.GetWorldInfo();return[t.GetX(),t.GetY(),t.GetTotalZElevation()]}LoadTilemapData(e,t,s){}TestPointOverlapTile(e,t){}RendersToOwnZPlane(){return!0}}}{const iG=self.C3,rG=iG.New(iG.Rect);iG.SDKDOMInstanceBase=class extends iG.SDKWorldInstanceBase{constructor(e,t){super(e,t),this._elementId=this.GetPlugin()._AddElement(this),this._isElementShowing=!0,this._elemHasFocus=!1,this._autoFontSize=!1,this._autoFontSizeOffset=-.2,this._lastRect=iG.New(iG.Rect,0,0,-1,-1);const s=this._runtime.GetCanvasManager();this._lastWindowWidth=s.GetLastWidth(),this._lastWindowHeight=s.GetLastHeight(),this._lastHTMLIndex=-1,this._lastHTMLZIndex=-1,this._isPendingUpdateState=!1,this._StartTicking()}Release(){this.GetPlugin()._RemoveElement(this._elementId),this.PostToDOMElement("destroy"),this._elementId=-1,super.Release()}_GetElementInDOMMode(){if(this._runtime.IsInWorker())throw new Error("not valid in worker mode");return this._PostToDOMElementMaybeSync("get-element")}PostToDOMElement(e,t){t||(t={}),t.elementId=this._elementId,this.PostToDOM(e,t)}_PostToDOMElementMaybeSync(e,t){return t||(t={}),t.elementId=this._elementId,this._PostToDOMMaybeSync(e,t)}PostToDOMElementAsync(e,t){return t||(t={}),t.elementId=this._elementId,this.PostToDOMAsync(e,t)}CreateElement(e){e||(e={});const t=this.GetWorldInfo();e.elementId=this._elementId,e.isVisible=t.IsVisible(),e.htmlIndex=t.GetLayer().GetHTMLIndex(),e.htmlZIndex=t.GetHTMLZIndex(),Object.assign(e,this.GetElementState()),this._isElementShowing=!!e.isVisible,this._PostToDOMMaybeSync("create",e),this._UpdatePosition(!0)}SetElementVisible(e){e=!!e,this._isElementShowing!==e&&(this._isElementShowing=e,this.PostToDOMElement("set-visible",{isVisible:e}))}Tick(){this._UpdatePosition(!1)}_ShouldPreserveElement(){const e=this._runtime.GetCanvasManager().GetFullscreenMode();return"Android"===iG.Platform.OS&&("scale-inner"===e||"scale-outer"===e||"crop"===e)}_UpdatePosition(e){if(this.GetInstance().IsDestroyed())return;const t=this.GetWorldInfo(),s=t.GetLayer(),n=t.GetBoundingBox();let[i,r]=s.LayerToCanvasCss(n.getLeft(),n.getTop()),[a,o]=s.LayerToCanvasCss(n.getRight(),n.getBottom());const l=this._runtime.GetCanvasManager(),c=l.GetCssWidth(),h=l.GetCssHeight();if(!t.IsVisible()||!s.IsVisible())return void this.SetElementVisible(!1);if(!this._ShouldPreserveElement()&&(a<=0||o<=0||i>=c||r>=h))return void this.SetElementVisible(!1);rG.set(i,r,a,o);const _=l.GetLastWidth(),u=l.GetLastHeight(),d=s.GetHTMLIndex(),p=t.GetHTMLZIndex();if(!e&&rG.equals(this._lastRect)&&this._lastWindowWidth===_&&this._lastWindowHeight===u&&this._lastHTMLIndex===d&&this._lastHTMLZIndex===p)return void this.SetElementVisible(!0);this._lastRect.copy(rG),this._lastWindowWidth=_,this._lastWindowHeight=u,this._lastHTMLIndex=d,this._lastHTMLZIndex=p,this.SetElementVisible(!0);let f=null;this._autoFontSize&&(f=s.GetDisplayScale()+this._autoFontSizeOffset),this._PostToDOMElementMaybeSync("update-position",{left:Math.round(this._lastRect.getLeft()),top:Math.round(this._lastRect.getTop()),width:Math.round(this._lastRect.width()),height:Math.round(this._lastRect.height()),htmlIndex:d,htmlZIndex:p,fontSize:f})}FocusElement(){this._PostToDOMElementMaybeSync("focus",{focus:!0})}BlurElement(){this._PostToDOMElementMaybeSync("focus",{focus:!1})}_OnElemFocused(){this._elemHasFocus=!0}_OnElemBlurred(){this._elemHasFocus=!1}IsElementFocused(){return this._elemHasFocus}SetElementCSSStyle(e,t){this.PostToDOMElement("set-css-style",{prop:iG.CSSToCamelCase(e),val:t})}SetElementAttribute(e,t){this.PostToDOMElement("set-attribute",{name:e,val:t})}RemoveElementAttribute(e){this.PostToDOMElement("remove-attribute",{name:e})}UpdateElementState(){this._isPendingUpdateState||(this._isPendingUpdateState=!0,Promise.resolve().then((()=>{this._isPendingUpdateState=!1,this.PostToDOMElement("update-state",this.GetElementState())})))}GetElementState(){}GetElementId(){return this._elementId}}}{const aG=self.C3,oG=self.IBehavior;aG.SDKBehaviorBase=class extends aG.DefendedBase{constructor(e){super(),this._runtime=e.runtime,this._id=e.id,this._name=e.name??"",this._myObjectClasses=aG.New(aG.ArraySet),this._myInstances=aG.New(aG.ArraySet),this._sdkVersion=e.sdkVersion,this._scriptInterfaceClass=e.scriptInterfaceClass,this._iBehavior=null}Release(){this._myInstances.Release(),this._myObjectClasses.Release(),this._runtime=null}GetRuntime(){return this._runtime}GetID(){return this._id}GetName(){return this._name}OnCreate(){}GetSdkVersion(){return this._sdkVersion}GetScriptInterfaceClass(e=!1){let t=this._scriptInterfaceClass;return e&&"function"!=typeof t&&this.GetSdkVersion()>=2&&(t=globalThis.ISDKBehaviorBase),t}_AddObjectClass(e){this._myObjectClasses.Add(e)}GetObjectClasses(){return this._myObjectClasses.GetArray()}_AddInstance(e){this._myInstances.Add(e)}_RemoveInstance(e){this._myInstances.Delete(e)}GetInstances(){return this._myInstances.GetArray()}_InitScriptInterface(){const e=this.GetSdkVersion();aG.AddonManager._PushInitObject(this,e);const t=this.GetScriptInterfaceClass(!0);if(t){if(this._iBehavior=new t,!(this._iBehavior instanceof oG))throw new TypeError("behavior class must derive from IBehavior")}else this._iBehavior=new oG;aG.AddonManager._PopInitObject(e)}GetIBehavior(){return this._iBehavior}}}{const lG=self.C3;lG.SDKBehaviorTypeBase=class extends lG.DefendedBase{constructor(e){super(),this._runtime=e.GetRuntime(),this._behaviorType=e,this._objectClass=e.GetObjectClass(),this._behavior=e.GetBehavior(),this._behavior._AddObjectClass(this._objectClass)}Release(){this._runtime=null,this._behaviorType=null,this._objectClass=null,this._behavior=null}OnCreate(){}GetBehaviorType(){return this._behaviorType}GetObjectClass(){return this._objectClass}GetRuntime(){return this._runtime}GetBehavior(){return this._behavior}}}{const cG=self.C3;cG.SDKBehaviorInstanceBase=class extends cG.DefendedBase{constructor(e,t){super(),this._behInst=e,this._domComponentId=t,this._inst=e.GetObjectInstance(),this._runtime=e.GetRuntime(),this._behaviorType=e.GetBehaviorType(),this._sdkType=this._behaviorType.GetSdkType(),this._isTicking=!1,this._isTicking2=!1,this._isPostTicking=!1,this._disposables=null}Release(){this._StopTicking(),this._StopTicking2(),this._StopPostTicking(),this._disposables&&(this._disposables.Release(),this._disposables=null),this._behInst=null,this._inst=null,this._runtime=null,this._behaviorType=null,this._sdkType=null}GetBehavior(){return this._behaviorType.GetBehavior()}GetBehaviorInstance(){return this._behInst}GetObjectInstance(){return this._inst}GetObjectClass(){return this._inst.GetObjectClass()}GetWorldInfo(){return this._inst.GetWorldInfo()}GetRuntime(){return this._runtime}GetBehaviorType(){return this._behaviorType}GetSdkType(){return this._sdkType}GetScriptInterface(){return this._behInst.GetScriptInterface()}Trigger(e){return this._runtime.Trigger(e,this._inst,this._behaviorType)}DebugTrigger(e){return this._runtime.DebugTrigger(e,this._inst,this._behaviorType)}TriggerAsync(e){return this._runtime.TriggerAsync(e,this._inst,this._behaviorType)}PostCreate(){}Tick(){}Tick2(){}PostTick(){}_StartTicking(){this._isTicking||(this._runtime._AddBehInstToTick(this),this._isTicking=!0)}_StopTicking(){this._isTicking&&(this._runtime._RemoveBehInstToTick(this),this._isTicking=!1)}IsTicking(){return this._isTicking}_StartTicking2(){this._isTicking2||(this._runtime._AddBehInstToTick2(this),this._isTicking2=!0)}_StopTicking2(){this._isTicking2&&(this._runtime._RemoveBehInstToTick2(this),this._isTicking2=!1)}IsTicking2(){return this._isTicking2}_StartPostTicking(){this._isPostTicking||(this._runtime._AddBehInstToPostTick(this),this._isPostTicking=!0)}_StopPostTicking(){this._isPostTicking&&(this._runtime._RemoveBehInstToPostTick(this),this._isPostTicking=!1)}IsPostTicking(){return this._isPostTicking}GetDebuggerProperties(){return[]}AddDOMMessageHandler(e,t){this._runtime.AddDOMComponentMessageHandler(this._domComponentId,e,t)}OnSpriteFrameChanged(e,t){}SaveToJson(){return null}LoadFromJson(e){}GetPropertyValueByIndex(e){}SetPropertyValueByIndex(e,t){}OffsetPropertyValueByIndex(e,t){if(0===t)return;const s=this.GetPropertyValueByIndex(e);if("number"!=typeof s)throw new Error("expected number");this.SetPropertyValueByIndex(e,s+t)}SetPropertyColorOffsetValueByIndex(e,t,s,n){}CallAction(e,...t){e.call(this,...t)}CallExpression(e,...t){return e.call(this,...t)}GetScriptInterfaceClass(){return null}DispatchScriptEvent(e,t,s){if(!this._behInst.HasScriptInterface())return;const n=this.GetScriptInterface(),i=cG.New(cG.Event,e,t);i.behaviorInstance=n,i.instance=n.instance,s&&Object.assign(i,s),n.dispatchEvent(i)}}}{let hG=function(e){if(e!==uG)throw new Error("invalid internal API token")};ValidateInternalAPIToken=hG;const _G=self.C3;_G.Plugins={},_G.Behaviors={};const uG=_G._GetInternalAPIToken();let dG=[],pG=[],fG=[],mG=null,gG=null,IG=null,SG=null;const yG=new Map,bG=new Map;_G.AddonManager=class extends _G.DefendedBase{constructor(e,t){super(),this._runtime=e,this._allPlugins=[],this._systemPlugin=null,this._allBehaviors=[],this._delayCreateBehaviors=new Map,this._solidBehavior=null,this._jumpthruBehavior=null,this._wrapperComponentIds=new Set(t)}CreatePlugin(e){const t=e[19],s=this._runtime.GetObjectReference(e[0]);if(!s)throw new Error("missing plugin");_G.AddCommonACEs(e,s,t);const n=t>=2?_G.SDKPluginBase:s,i=_G.New(n,{runtime:this._runtime,isSingleGlobal:e[1],isWorld:e[2],isRotatable:e[5],hasEffects:e[8],mustPredraw:e[9],supportsSceneGraph:e[13],supportsMesh:e[14],isHTMLElementType:e[17],is3d:e[18],sdkVersion:t,id:e[20],name:e[21],scriptInterfaceClass:t>=2?s:null});i.OnCreate(),this._allPlugins.push(i),yG.set(s,i)}CreateSystemPlugin(){this._systemPlugin=_G.New(_G.Plugins.System,{runtime:this._runtime,isSingleGlobal:!0}),this._systemPlugin.OnCreate()}CreateBehavior(e){const t=e[1],s=e[2],n=e[3],i=this._runtime.GetObjectReference(e[0]);if(!i)throw new Error("missing behavior");this._delayCreateBehaviors.set(i,(()=>{const e=t>=2?_G.SDKBehaviorBase:i,r=_G.New(e,{runtime:this._runtime,id:s,name:n,sdkVersion:t,scriptInterfaceClass:t>=2?i:null});r.OnCreate(),this._allBehaviors.push(r),bG.set(i,r),!this._solidBehavior&&_G.Behaviors.solid&&r instanceof _G.Behaviors.solid?this._solidBehavior=r:!this._jumpthruBehavior&&_G.Behaviors.jumpthru&&r instanceof _G.Behaviors.jumpthru&&(this._jumpthruBehavior=r),r._InitScriptInterface()}))}_DelayCreateBehavior(e){const t=this._delayCreateBehaviors.get(e);t&&(t(),this._delayCreateBehaviors.delete(e))}static _PushInitObject(e,t=1){if(_G.AddonManager._PushInitObject!==mG)throw new Error("invalid method");1===t&&dG.push(e),pG.push(e)}static _PopInitObject(e=1){if(_G.AddonManager._PopInitObject!==gG)throw new Error("invalid method");1===e&&dG.pop(),pG.pop()}static _GetInitObject(){if(_G.AddonManager._GetInitObject!==IG)throw new Error("invalid method");if(0===dG.length)throw new Error("no init object set");return dG.at(-1)}static _GetInitObject2(e){if(_G.AddonManager._GetInitObject2!==SG)throw new Error("invalid method");if(hG(e),0===pG.length)throw new Error("no init object set");return pG.at(-1)}static _PushInitProperties(e){fG.push(e)}static _PopInitProperties(){fG.pop()}static _GetInitProperties(){if(0===fG.length)throw new Error("no init properties set");return fG.at(-1)}_InitAddonScriptInterfaces(){for(const e of this._allPlugins)e._InitScriptInterface()}static GetPluginByConstructorFunction(e){return yG.get(e)||null}static GetBehaviorByConstructorFunction(e){return bG.get(e)||null}GetSystemPlugin(){return this._systemPlugin}GetSolidBehavior(){return this._solidBehavior}GetJumpthruBehavior(){return this._jumpthruBehavior}HasWrapperComponentId(e){return this._wrapperComponentIds.has(e)}},mG=_G.AddonManager._PushInitObject,gG=_G.AddonManager._PopInitObject,IG=_G.AddonManager._GetInitObject,SG=_G.AddonManager._GetInitObject2}{const GG=self.C3,vG=new Set;GG.ImageInfo=class extends GG.DefendedBase{constructor(){super(),this._generation=0,this._url="",this._size=0,this._offsetX=0,this._offsetY=0,this._width=0,this._height=0,this._isRotated=!1,this._hasMetaData=!1,this._imageAsset=null,this._textureState="",this._rcTex=GG.New(GG.Rect),this._quadTex=GG.New(GG.Quad),this._blobUrl="",this._iImageInfo=new self.IImageInfo(this),vG.add(this)}Release(){this.ReleaseTexture(),this._imageAsset&&0===this._imageAsset.GetRefCount()&&this._imageAsset.Release(),this._imageAsset=null,vG.delete(this),this.ReleaseBlobURL()}static OnRendererContextLost(){for(const e of vG)e._textureState="",e._rcTex.set(0,0,0,0),e._quadTex.setFromRect(e._rcTex)}LoadData(e){this._url=e[0],this._size=e[1],this._offsetX=e[2],this._offsetY=e[3],this._width=e[4],this._height=e[5],this._isRotated=e[6],this._hasMetaData=!0}LoadDynamicAsset(e,t,s){if(s=!!s,this._imageAsset)throw new Error("already loaded asset");this._url=t;const n={isTiled:s};return GG.IsAbsoluteURL(t)&&(n.loadPolicy="remote"),this.LoadAsset(e,n),this._imageAsset.Load()}LoadDynamicBlobAsset(e,t){if(this._imageAsset)throw new Error("already loaded asset");this._url="",this._size=t.size,this._imageAsset=GG.New(GG.ImageAsset,e.GetAssetManager(),{blob:t,size:this._size,loadPolicy:"local"})}ReplaceWith(e){if(e===this)throw new Error("cannot replace with self");this._generation++,this.ReleaseTexture(),this._url=e._url,this._size=e._size,this._offsetX=e._offsetX,this._offsetY=e._offsetY,this._width=e._width,this._height=e._height,this._isRotated=e._isRotated,this._hasMetaData=e._hasMetaData,this._imageAsset=e._imageAsset,this._textureState=e._textureState,this._rcTex=e._rcTex,this._quadTex=e._quadTex,this.ReleaseBlobURL()}GetURL(){return this._url}GetSize(){return this._size}GetOffsetX(){return this._offsetX}GetOffsetY(){return this._offsetY}IsRotated(){return this._isRotated}GetWidth(){return this._width}GetHeight(){return this._height}GetSheetWidth(){return this._imageAsset.GetWidth()}GetSheetHeight(){return this._imageAsset.GetHeight()}LoadAsset(e,t){if(this._imageAsset)throw new Error("already got asset");t=Object.assign({},t,{url:this.GetURL(),size:this.GetSize()}),this._imageAsset=e.LoadImage(t)}IsLoaded(){return this._imageAsset&&this._imageAsset.IsLoaded()}async LoadStaticTexture(e,t){if(!this._imageAsset)throw new Error("no asset");if(this._textureState)throw new Error("already loaded texture");const s=this._generation;this._textureState="loading";const n=await this._imageAsset.LoadStaticTexture(e,t);if(this._generation!==s)return null;if(!n)return this._textureState="",null;this._textureState="loaded",this._hasMetaData||(this._width=n.GetWidth(),this._height=n.GetHeight(),this._hasMetaData=!0);const i=this._isRotated?this._height:this._width,r=this._isRotated?this._width:this._height;return this._rcTex.set(this._offsetX,this._offsetY,this._offsetX+i,this._offsetY+r),this._rcTex.divide(n.GetWidth(),n.GetHeight()),this._quadTex.setFromRect(this._rcTex),this._isRotated&&this._quadTex.rotatePointsAnticlockwise(),n}ReleaseTexture(){this._textureState&&(this._imageAsset&&this._imageAsset.ReleaseTexture(),this._textureState="",this._rcTex.set(0,0,0,0),this._quadTex.setFromRect(this._rcTex))}GetTexture(){return this._imageAsset&&"loaded"===this._textureState?this._imageAsset.GetTexture():null}GetTexRect(){return this._rcTex}GetTexQuad(){return this._quadTex}GetIImageInfo(){return this._iImageInfo}GetImageAsset(){return this._imageAsset}async ExtractImageToCanvas(e){e||(e=await this._imageAsset.LoadToDrawable());const t=GG.CreateCanvas(this._width,this._height),s=t.getContext("2d");return this._isRotated?(s.rotate(Math.PI/-2),s.translate(-this._height,0),s.drawImage(e,this._offsetX,this._offsetY,this._height,this._width,0,0,this._height,this._width)):s.drawImage(e,this._offsetX,this._offsetY,this._width,this._height,0,0,this._width,this._height),t}async ExtractImageToBlobURL(e){if(this._blobUrl)return this._blobUrl;const t=await this.ExtractImageToCanvas(e),s=await GG.CanvasToBlob(t);return this._blobUrl=URL.createObjectURL(s),this._blobUrl}ReleaseBlobURL(){this._blobUrl&&(URL.revokeObjectURL(this._blobUrl),this._blobUrl="")}}}{const xG=self.C3;xG.AnimationInfo=class extends xG.DefendedBase{constructor(e){super(),this._name=e[0],this._speed=e[1],this._isLooping=!!e[2],this._repeatCount=e[3],this._repeatTo=e[4],this._isPingPong=!!e[5],this._sid=e[6],this._frames=e[7].map((e=>xG.New(xG.AnimationFrameInfo,e))),this._iAnimation=new self.IAnimation(this)}static CreateDynamic(e,t){const s=xG.New(xG.AnimationInfo,[t,0,!1,0,0,!1,Math.floor(1e15*Math.random()),[]]);return s._frames.push(xG.AnimationFrameInfo.CreateDynamic(e)),s}Release(){for(const e of this._frames)e.Release();xG.clearArray(this._frames)}LoadAllAssets(e){for(const t of this._frames)t.GetImageInfo().LoadAsset(e)}LoadAllTextures(e,t){return Promise.all(this._frames.map((s=>s.GetImageInfo().LoadStaticTexture(e,t))))}ReleaseAllTextures(){for(const e of this._frames)e.GetImageInfo().ReleaseTexture()}GetName(){return this._name}GetSID(){return this._sid}GetFrameCount(){return this._frames.length}GetFrames(){return this._frames}GetFrameAt(e){if((e=Math.floor(e))<0||e>=this._frames.length)throw new RangeError("invalid frame");return this._frames[e]}InsertFrameAt(e,t){(t=Math.floor(t))<0?this._frames.unshift(e):t>=this._frames.length?this._frames.push(e):this._frames.splice(t,0,e)}RemoveFrameAt(e){if((e=Math.floor(e))<0||e>=this._frames.length)throw new RangeError("invalid frame");this._frames[e].Release(),this._frames.splice(e,1)}GetFrameIndexByTag(e){for(let t=0,s=this._frames.length;t<s;++t)if(xG.equalsNoCase(this._frames[t].GetTag(),e))return t;return-1}FrameTagOrIndexToIndex(e){if("string"==typeof e){const t=this.GetFrameIndexByTag(e);if(-1===t)throw new Error(`cannot find animation frame with tag ${e}`);return t}return e}GetSpeed(){return this._speed}IsLooping(){return this._isLooping}GetRepeatCount(){return this._repeatCount}GetRepeatTo(){return this._repeatTo}IsPingPong(){return this._isPingPong}GetIAnimation(){return this._iAnimation}}}{const TG=self.C3,CG=(()=>{const e=atob("iVBORw0KGgoAAAANSUhEUgAAAGQAAABkAQMAAABKLAcXAAAAAXNSR0IArs4c6QAAAANQTFRFAAAAp3o92gAAAAF0Uk5TAEDm2GYAAAATSURBVBgZYxgFo2AUjIJRQFcAAAV4AAHcRQIbAAAAAElFTkSuQmCC"),t=new Uint8Array(e.length);for(let s=0,n=e.length;s<n;++s)t[s]=e.charCodeAt(s);return new Blob([t],{type:"image/png"})})();TG.AnimationFrameInfo=class extends TG.DefendedBase{constructor(e){super(),this._imageInfo=TG.New(TG.ImageInfo),this._imageInfo.LoadData(e),this._duration=e[7],this._origin=TG.New(TG.Vector2,e[8],e[9]),this._imagePoints=e[10].map((e=>TG.New(TG.ImagePoint,this,e))),this._imagePointsByName=new Map;for(const e of this._imagePoints)this._imagePointsByName.set(e.GetName().toLowerCase(),e);this._collisionPoly=null;const t=e[11];t.length>=6&&(this._collisionPoly=TG.New(TG.CollisionPoly,t)),this._tag=e[12]?e[12]:"",this._iAnimationFrame=new self.IAnimationFrame(this)}static CreateDynamic(e){const t=TG.New(TG.AnimationFrameInfo,["",0,0,0,100,100,!1,1,0,0,[],[],""]);return t._imageInfo.LoadDynamicBlobAsset(e,CG),t}Release(){this._collisionPoly&&(this._collisionPoly.Release(),this._collisionPoly=null),this._imageInfo.Release(),this._imageInfo=null}GetImageInfo(){return this._imageInfo}GetDuration(){return this._duration}GetOriginX(){return this._origin.getX()}GetOriginY(){return this._origin.getY()}GetCollisionPoly(){return this._collisionPoly}GetImagePointByName(e){return this._imagePointsByName.get(e.toLowerCase())||null}GetImagePointByIndex(e){return(e=Math.floor(e))<0||e>=this._imagePoints.length?null:this._imagePoints[e]}GetImagePointCount(){return this._imagePoints.length}GetTag(){return this._tag}GetIAnimationFrame(){return this._iAnimationFrame}}}{const wG=self.C3;wG.ImagePoint=class extends wG.DefendedBase{constructor(e,t){super(),this._afi=e,this._name=t[0],this._pos=wG.New(wG.Vector2,t[1],t[2])}Release(){}GetName(){return this._name}GetX(){return this._pos.getX()}GetY(){return this._pos.getY()}GetVec2(){return this._pos}}}{const PG=globalThis.C3,AG=globalThis.C3Debugger,RG=globalThis.IObjectClass,DG=globalThis.IObjectType,EG=globalThis.IFamily,MG=globalThis.assert;PG.ObjectClass=class extends PG.DefendedBase{constructor(e,t,s){super();const n=e.GetObjectReference(s[1]);this._runtime=e,this._plugin=PG.AddonManager.GetPluginByConstructorFunction(n),this._sdkType=null,this._instSdkCtor=n.Instance,this._index=t,this._sid=s[11],this._name=s[0],this._jsPropName=this._runtime.GetJsPropName(s[14]),this._isGlobal=!!s[9],this._isFamily=!!s[2],this._isOnLoaderLayout=!!s[10],this._instVars=s[3].map((t=>({sid:t[0],type:t[1],name:t[2],jsPropName:e.GetJsPropName(t[3])}))),this._behaviorsCount=s[4],this._effectsCount=s[5],this._isWorldType=this._plugin.IsWorldType(),this._dispatcher=PG.New(PG.Event.Dispatcher),this._effectList=null;const[i,r]=e.GetCollisionEngine().GetCollisionCellSize();if(this._collisionGrid=PG.New(PG.SparseGrid,i,r),this._anyCollisionCellChanged=!0,this._familyMembers=null,this._familyMembersSet=null,this._familyIndex=-1,this._families=null,this._familiesSet=null,this._familyInstVarMap=null,this._familyBehaviorMap=null,this._familyEffectMap=null,this._isInContainer=!1,this._container=null,this._behaviorTypes=s[8].map((e=>PG.BehaviorType.Create(this,e))),this._behaviorTypesIncludingInherited=[],this._behaviorsByName=new Map,this._behaviorNameToIndex=new Map,this._usedBehaviorCtors=new Set,this._customActionMap=new Map,this._solStack=PG.New(PG.SolStack,this),this._defaultInstanceData=null,this._defaultLayerIndex=0,this._isContained=!1,this._container=null,this._imageInfo=null,this._animations=null,this._animationsByName=null,this._animationsBySid=null,this._textureRefCount=0,this._savedData=new Map,this._unsavedData=new Map,this._instances=[],this._worldInfosByLayer=new Map,this._iidsStale=!0,this._plugin.HasEffects()&&(this._effectList=PG.New(PG.EffectList,this,s[12])),s[6]&&(this._imageInfo=PG.New(PG.ImageInfo),this._imageInfo.LoadData(s[6])),s[7]){this._animations=s[7].map((e=>PG.New(PG.AnimationInfo,e))),this._animationsByName=new Map,this._animationsBySid=new Map;for(const e of this._animations)this._animationsByName.set(e.GetName().toLowerCase(),e),this._animationsBySid.set(e.GetSID(),e)}this._isFamily?(this._familyMembers=[],this._familyMembersSet=new Set,this._familyIndex=this._runtime._GetNextFamilyIndex()):(this._families=[],this._familiesSet=new Set,this._familyInstVarMap=[],this._familyBehaviorMap=[],this._familyEffectMap=[]);const a=this._plugin.GetSdkVersion();if(a<2&&(this._sdkType=PG.New(n.Type,this,s[15]),!(this._sdkType instanceof PG.SDKTypeBase)))throw new Error("v1 sdk type must derive from SDKTypeBase");let o;if(this._iObjectClass=null,this._instanceUserScriptClass=null,this._userScriptDispatcher=PG.New(PG.Event.Dispatcher),PG.AddonManager._PushInitObject(this,a),a>=2?(o=n.Type,o||(o=globalThis.ISDKObjectTypeBase)):o=this._sdkType.GetScriptInterfaceClass(),o&&!this._isFamily){if(this._iObjectClass=new o(a<2?this:null),a<2&&!(this._iObjectClass instanceof DG))throw new TypeError("script interface class must derive from IObjectType");if(a>=2&&!(this._iObjectClass instanceof globalThis.ISDKObjectTypeBase))throw new TypeError("script interface class must derive from ISDKObjectTypeBase")}else{const e=this._isFamily?EG:DG;this._iObjectClass=new e}if(PG.AddonManager._PopInitObject(a),s[13]){const e=s[13];if(e){const t=e[0],s=e[1],n=e[2];this._sdkType.LoadTilemapData(t,s,n)}}this._runtime.UsesLoaderLayout()&&!this._isFamily&&!this._isOnLoaderLayout&&this._isWorldType||this.OnCreate(),this._plugin.IsSingleGlobal()&&(this._plugin._SetSingleGlobalObjectClass(this),this._CreateSingleGlobalInstance(s)),this._loadInstancesJson=null}static Create(e,t,s){return PG.New(PG.ObjectClass,e,t,s)}Release(){if(this._dispatcher.Release(),this._dispatcher=null,this._imageInfo&&(this._imageInfo.Release(),this._imageInfo=null),this._animations){for(const e of this._animations)e.Release();PG.clearArray(this._animations),this._animationsByName.clear(),this._animationsBySid.clear()}this._loadInstancesJson=null,this._solStack.Release(),this._solStack=null,this._savedData.clear(),this._unsavedData.clear(),this._container=null,this._runtime=null}_LoadFamily(e){for(let t=1,s=e.length;t<s;++t){const s=this._runtime.GetObjectClassByIndex(e[t]);this._familyMembers.push(s),this._familyMembersSet.add(s),s._families.push(this),s._familiesSet.add(this)}}_SetContainer(e){this._isInContainer=!0,this._container=e}IsInContainer(){return this._isInContainer}GetContainer(){return this._container}_OnAfterCreate(){let e=0;if(!this._isFamily)for(const t of this._families)for(const s of t.GetBehaviorTypes()){const t=s.GetName().toLowerCase();this._behaviorsByName.set(t,s),this._behaviorNameToIndex.set(t,e),this._behaviorTypesIncludingInherited.push(s),++e}for(const t of this.GetBehaviorTypes()){const s=t.GetName().toLowerCase();this._behaviorsByName.set(s,t),this._behaviorNameToIndex.set(s,e),this._behaviorTypesIncludingInherited.push(t),++e}for(const e of this._behaviorTypesIncludingInherited)this._usedBehaviorCtors.add(e.GetBehavior().constructor);if(!this._isFamily&&this._families.length){const e=this._runtime.GetFamilyCount();PG.extendArray(this._familyInstVarMap,e,0),PG.extendArray(this._familyBehaviorMap,e,0),PG.extendArray(this._familyEffectMap,e,0);const t=[];let s=0,n=0,i=0;for(const e of this._families){const r=e.GetFamilyIndex();this._familyInstVarMap[r]=s,s+=e.GetInstanceVariablesCount(),this._familyBehaviorMap[r]=n,n+=e.GetBehaviorTypesCount(),this._familyEffectMap[r]=i,i+=e.GetEffectTypesCount();const a=e.GetEffectList();if(a&&this._effectList)for(const e of a.GetAllEffectTypes())t.push(e.Clone(this._effectList))}this._effectList&&this._effectList.PrependEffectTypes(t)}}_CreateSingleGlobalInstance(e){const t=PG.IsFiniteNumber(e[17])?e[17]:this._runtime._GetNewUID(),s=PG.New(PG.Instance,{runtime:this._runtime,objectType:this,uid:t});s._CreateSdkInstance(e[16],[]),this._runtime._MapInstanceByUID(t,s),this._instances.push(s)}GetSdkType(){return this._sdkType}IsOnLoaderLayout(){return this._isOnLoaderLayout}Dispatcher(){return this._dispatcher}OnCreate(){this._isFamily||(this._sdkType?this._sdkType.OnCreate():this._iObjectClass._onCreate())}HasLoadedTextures(){return this._textureRefCount>0}async LoadTextures(e){this._isFamily||(this._textureRefCount++,1===this._textureRefCount&&(this._sdkType?await this._sdkType.LoadTextures(e):await this._iObjectClass._loadTextures(this._runtime.GetCanvasManager().GetIRenderer())))}ReleaseTextures(){if(!this._isFamily){if(this._textureRefCount--,this._textureRefCount<0)throw new Error("released textures too many times");0===this._textureRefCount&&(this._sdkType?this._sdkType.ReleaseTextures():this._iObjectClass._releaseTextures(this._runtime.GetCanvasManager().GetIRenderer()))}}OnDynamicTextureLoadComplete(){if(this._isFamily)throw new Error("not applicable to family");this._sdkType?this._sdkType.OnDynamicTextureLoadComplete():this._iObjectClass._onDynamicTextureLoadComplete()}async PreloadTexturesWithInstances(e){this._isFamily||(this._sdkType?await this._sdkType.PreloadTexturesWithInstances(e):await this._iObjectClass._preloadTexturesWithInstances(this._runtime.GetCanvasManager().GetIRenderer()))}GetRuntime(){return this._runtime}GetPlugin(){return this._plugin}GetInstanceSdkCtor(){return this._instSdkCtor}GetName(){return this._name}GetJsPropName(){return this._jsPropName}GetIndex(){return this._index}GetSID(){return this._sid}IsFamily(){return this._isFamily}IsGlobal(){return this._isGlobal}IsWorldType(){return this._isWorldType}GetFamilyIndex(){return this._familyIndex}GetBehaviorTypes(){return this._behaviorTypes}GetBehaviorTypesCount(){return this._behaviorsCount}UsesBehaviorByCtor(e){return e&&this._usedBehaviorCtors.has(e)}GetInstanceVariablesCount(){return this._instVars.length}GetInstanceVariableSIDs(){return this._instVars.map((e=>e.sid))}GetInstanceVariableIndexBySID(e){return this._instVars.findIndex((t=>t.sid===e))}GetInstanceVariableIndexByName(e){return this._instVars.findIndex((t=>t.name===e))}_GetAllInstanceVariableNames(){return this._instVars.map((e=>e.name))}_GetAllInstanceVariableJsPropNames(){return this._instVars.map((e=>e.jsPropName))}GetInstanceVariableType(e){if((e=Math.floor(e))<0||e>=this._instVars.length)throw new RangeError("invalid instance variable index");return this._instVars[e].type}GetInstanceVariableName(e){if((e=Math.floor(e))<0||e>=this._instVars.length)throw new RangeError("invalid instance variable index");return this._instVars[e].name}GetEffectTypesCount(){return this._effectsCount}GetBehaviorTypesIncludingInherited(){return this._behaviorTypesIncludingInherited}GetBehaviorTypeByName(e){return this._behaviorsByName.get(e.toLowerCase())||null}GetBehaviorIndexByName(e){const t=this._behaviorNameToIndex.get(e.toLowerCase());return void 0===t?-1:t}GetEffectList(){return this._effectList}HasEffects(){return this._plugin.HasEffects()}UsesEffects(){return this._effectList&&this._effectList.HasAnyEffectType()}GetSolStack(){return this._solStack}GetCurrentSol(){return this._solStack.GetCurrentSol()}GetImageInfo(){return this._imageInfo}SetDefaultInstanceData(e){this._defaultInstanceData=e}GetDefaultInstanceData(){return this._defaultInstanceData}_SetDefaultLayerIndex(e){this._defaultLayerIndex=e}GetDefaultLayerIndex(){return this._defaultLayerIndex}GetAnimations(){return this._animations}GetAnimationCount(){return this._animations.length}GetFamilies(){return this._families}BelongsToFamily(e){return this._familiesSet.has(e)}GetFamilyMembers(){return this._familyMembers}FamilyHasMember(e){return this._familyMembersSet.has(e)}GetFamilyBehaviorOffset(e){return this._familyBehaviorMap[e]}GetFamilyInstanceVariableOffset(e){return this._familyInstVarMap[e]}AddCustomAction(e){this._customActionMap.set(e.GetACEName().toLowerCase(),e)}HasOwnCustomActionByName(e){return!!this.GetOwnCustomActionByName(e)}GetOwnCustomActionByName(e){const t=this._customActionMap.get(e.toLowerCase());return t&&t.IsEnabled()?t:null}GetAllAnimations(){return this._animations}GetAnimationByName(e){if(!this._animations)throw new Error("no animations");return this._animationsByName.get(e.toLowerCase())||null}GetAnimationBySID(e){if(!this._animations)throw new Error("no animations");return this._animationsBySid.get(e)||null}AddAnimation(e){if(this.GetAnimationByName(e))throw new Error(`animation name '${e}' already exists`);const t=PG.AnimationInfo.CreateDynamic(this.GetRuntime(),e);return this._animations.push(t),this._animationsByName.set(t.GetName().toLowerCase(),t),this._animationsBySid.set(t.GetSID(),t),t}RemoveAnimation(e){const t=this.GetAnimationByName(e);if(!t)throw new Error(`animation name '${e}' does not exist`);if(1===this._animations.length)throw new Error("cannot remove last animation");const s=this._animations.indexOf(t);this._animations.splice(s,1),this._animationsByName.delete(t.GetName().toLowerCase()),this._animationsBySid.delete(t.GetSID()),t.Release()}GetFirstAnimation(){if(!this._animations)throw new Error("no animations");return this._animations[0]}GetFirstAnimationFrame(){return this.GetFirstAnimation().GetFrameAt(0)}GetDefaultInstanceSize(){if(this._animations){const e=this.GetFirstAnimationFrame().GetImageInfo();return[e.GetWidth(),e.GetHeight()]}return this._imageInfo?[this._imageInfo.GetWidth(),this._imageInfo.GetHeight()]:[100,100]}GetSingleGlobalInstance(){if(!this._plugin.IsSingleGlobal())throw new Error("not a single-global plugin");return this._instances[0]}GetInstances(){return this._instances}*instances(){yield*this._instances}*instancesIncludingPendingCreate(){yield*this._instances,yield*this._runtime.instancesPendingCreateForObjectClass(this)}GetInstanceCount(){return this._instances.length}_AddInstance(e){this._instances.push(e)}_SetIIDsStale(){this._iidsStale=!0}_UpdateIIDs(){if(!this._iidsStale||this._isFamily)return;const e=this._instances;let t=0;for(let s=e.length;t<s;++t)e[t]._SetIID(t);const s=this._runtime._GetInstancesPendingCreate();for(const e of s)e.GetObjectClass()===this&&e._SetIID(t++);this._iidsStale=!1}GetInstanceByIID(e){const t=this._instances;if(e<t.length)return t[e];e-=t.length;const s=this._runtime._GetInstancesPendingCreate();for(const t of s)if(t.GetObjectClass()===this){if(0===e)return t;--e}return null}GetFirstPicked(e){if(e&&e.IsInContainer()&&e.GetObjectClass()!==this)for(const t of e.siblings())if(t.GetObjectClass()===this)return t;const t=this.GetCurrentSol().GetInstances();return t.length?t[0]:null}GetPairedInstance(e){const t=this.GetCurrentSol().GetInstances();return t.length>0?t[e.GetIID()%t.length]:null}*allCorrespondingInstances(e,t){const s=this.GetCurrentSol().GetInstances(),n=s.length,i=t.GetCurrentSol(),r=t.GetCurrentSol().GetInstances(),a=r.length;let o=e.GetIID();!t.IsFamily()&&i.IsSelectAll()||(o=r.indexOf(e));const l=Math.ceil(n/a),c=n%a;let h=0,_=0;0===c||o<c?(h=o*l,_=l):(h=c*l+(o-c)*(l-1),_=l-1);for(let e=h,t=h+_;e<t;++e)yield s[e]}FinishCondition(e){this._sdkType?.FinishCondition(e)}ApplySolToContainer(){if(!this._isInContainer||this._isFamily)return;this._UpdateIIDs();const e=this.GetCurrentSol(),t=e._GetOwnInstances(),s=e.IsSelectAll(),n=this._runtime.GetCurrentEventStackFrame(),i=n&&n.GetCurrentEvent()&&n.GetCurrentEvent().IsOrBlock();for(const n of this._container.objectTypes()){if(n===this)continue;n._UpdateIIDs();const r=n.GetCurrentSol();if(r._SetSelectAll(s),!s){const s=r._GetOwnInstances();PG.clearArray(s);for(const e of t)s.push(n.GetInstanceByIID(e.GetIID()));if(i){const t=e._GetOwnElseInstances(),s=r._GetOwnElseInstances();PG.clearArray(s);for(const e of t)s.push(n.GetInstanceByIID(e.GetIID()))}}}}_TruncateContainerSols(e,t){for(const s of this.GetContainer().objectTypes()){const n=s.GetCurrentSol();e?PG.truncateArray(n._GetOwnElseInstances(),t):PG.truncateArray(n._GetOwnInstances(),t)}}_GetCollisionCellGrid(){return this._collisionGrid}_SetAnyCollisionCellChanged(e){this._anyCollisionCellChanged=!!e}_UpdateAllCollisionCells(){if(this._anyCollisionCellChanged&&this._isWorldType){for(const e of this._instances)e.GetWorldInfo()._UpdateCollisionCell();for(const e of this._runtime._GetInstancesPendingCreate())e.GetObjectClass()===this&&e.GetWorldInfo()._UpdateCollisionCell();this._anyCollisionCellChanged=!1}}_OnWorldInstanceLayerChanged(e,t,s){if(t){const s=this._worldInfosByLayer.get(t);s&&(s.delete(e),0===s.size&&this._worldInfosByLayer.delete(t))}if(s){let t=this._worldInfosByLayer.get(s);t||(t=new Set,this._worldInfosByLayer.set(s,t)),t.add(e)}}*layersHasInstancesOn(){if(this.IsFamily()){const e=new Set;for(const t of this._familyMembers)for(const s of t.layersHasInstancesOn())e.add(s);yield*e.values()}else for(const e of this._worldInfosByLayer.keys())e.WasReleased()||(yield e)}GetSavedDataMap(){return this._savedData||(this._savedData=new Map),this._savedData}GetUnsavedDataMap(){return this._unsavedData||(this._unsavedData=new Map),this._unsavedData}HasSolidBehavior(){return this.UsesBehaviorByCtor(PG.Behaviors.solid)}HasJumpthruBehavior(){return this.UsesBehaviorByCtor(PG.Behaviors.jumpthru)}HasNoSaveBehavior(){return this.UsesBehaviorByCtor(PG.Behaviors.NoSave)}HasPersistBehavior(){return this.UsesBehaviorByCtor(PG.Behaviors.Persist)}_SaveToJson(){const e={instances:this._instances.map((e=>e.SaveToJson()))};return this._savedData&&this._savedData.size&&(e.ex=PG.ToSuperJSON(this._savedData)),e}_LoadFromJson(e,t){this._savedData&&(this._savedData.clear(),this._savedData=null);const s=e.ex;s&&(this._savedData=PG.FromSuperJSON(s));const n=this._instances,i=e.instances;for(let e=0,t=Math.min(n.length,i.length);e<t;++e)n[e].LoadFromJson(i[e]);for(let e=i.length,t=n.length;e<t;++e)this._runtime.DestroyInstance(n[e]);for(let e=n.length,s=i.length;e<s;++e){const s=i[e];let n=null;if(this.IsWorldType()&&(n=this._runtime.GetMainRunningLayout().GetLayerBySID(s.w.l),!n))continue;const r=this._runtime.CreateInstanceFromData(this._defaultInstanceData||this,n,!1,0,0,!0);r.LoadFromJson(s),t&&t.add(r)}this._loadInstancesJson=i,this._SetIIDsStale()}_GetLoadInstancesJson(){return this._loadInstancesJson}_ClearLoadInstancesJson(){this._loadInstancesJson=null}_SetupSceneGraphConnectionsOnChangeOfLayout(){for(let e=0,t=this._instances;e<t;++e)this._instances[e]._SetupSceneGraphConnectionsOnChangeOfLayout()}GetIObjectClass(){return this._iObjectClass}UserScriptDispatcher(){return this._userScriptDispatcher}_GetUserScriptInstanceClass(){return this._instanceUserScriptClass}_SetUserScriptInstanceClass(e){this._instanceUserScriptClass=e}DispatchUserScriptEvent(e){const t=this._runtime,s=t.IsDebug()&&!t.GetEventSheetManager().IsInEventEngine();s&&AG.StartMeasuringScriptTime(),this._userScriptDispatcher.dispatchEvent(e),s&&AG.AddScriptTime()}}}{const kG=self.C3;kG.Container=class extends kG.DefendedBase{constructor(e,t){super(),this._runtime=e,this._objectTypes=t;for(const e of this._objectTypes)e._SetContainer(this)}Release(){this._runtime=null}GetRuntime(){return this._runtime}GetObjectTypes(){return this._objectTypes}objectTypes(){return this._objectTypes}HasAnyWorldType(){return this._objectTypes.some((e=>e.IsWorldType()))}}}{const LG=self.C3,FG=self.C3Debugger,BG=self.IInstance,OG=LG.AddonManager,NG=[];let WG=0;const VG=new WeakMap,jG=new WeakMap,UG=1,HG=2,zG=4,XG=8,YG=16,qG=32,JG=64;LG.Instance=class extends LG.DefendedBase{constructor(e){if(LG.AddonManager!==OG)throw new Error("invalid addon manager");super(),this._runtime=e.runtime,this._objectType=e.objectType,this._worldInfo=null,this._sdkInst=null,this._iScriptInterface=null,this._iid=0,this._uid=e.uid,this._puid=WG++,this._flags=0,this._tagsSet=null;const t=LG.splitStringAndNormalize(e.tags);t.length>0&&(this._tagsSet=new Set(t)),this._instVarValues=NG,this._behaviorInstances=NG;const s=this._objectType.GetBehaviorTypesIncludingInherited();s.length>0&&(this._behaviorInstances=s.map(((e,t)=>LG.New(LG.BehaviorInstance,{runtime:this._runtime,behaviorType:e,instance:this,index:t})))),this._siblings=this._objectType.IsInContainer()?[]:null,this._timeScale=-1,this._dispatcher=null;const n=this.GetPlugin();if(n.MustPreDraw()&&(this._flags|=4),n.IsWorldType())if(this._worldInfo=LG.New(LG.WorldInfo,this,e.layer),e.worldData)this._worldInfo.Init(e.worldData);else{this._worldInfo.InitNoData();const[e,t]=this._objectType.GetDefaultInstanceSize();this._worldInfo.SetSize(e,t),this.GetObjectClass().UsesEffects()&&this._worldInfo.GetInstanceEffectList().LoadDefaultEffectParameters()}e.instVarData?this._LoadInstanceVariableData(e.instVarData):this._LoadDefaultInstanceVariables()}Release(){if(this._iScriptInterface&&(this._iScriptInterface._release(),this._iScriptInterface=null),this._behaviorInstances.length>0){for(const e of this._behaviorInstances)e.Release();LG.clearArray(this._behaviorInstances)}this._sdkInst&&(this._sdkInst.Release(),this._sdkInst=null);const e=VG.get(this);e&&(e.clear(),VG.delete(this));const t=jG.get(this);t&&(t.clear(),jG.delete(this)),this._siblings&&LG.clearArray(this._siblings),this._dispatcher&&(this._dispatcher.Release(),this._dispatcher=null),this._tagsSet&&this._tagsSet.clear(),this._tagsSet=null,this._runtime=null,this._objectType=null,this._instVarValues.length>0&&LG.clearArray(this._instVarValues),this._worldInfo&&(this._worldInfo.Release(),this._worldInfo=null)}_LoadInstanceVariableData(e){e.length>0&&(this._instVarValues=[],LG.shallowAssignArray(this._instVarValues,e))}_LoadDefaultInstanceVariables(){const e=this._objectType.GetInstanceVariablesCount();if(0===e)return;this._instVarValues=[];const t=[0,0,""];for(let s=0;s<e;++s)this._instVarValues.push(t[this._objectType.GetInstanceVariableType(s)])}_CreateSdkInstance(e,t){if(this._sdkInst)throw new Error("already got sdk instance");for(let e=0,s=this._behaviorInstances.length;e<s;++e)this._behaviorInstances[e]._CreateSdkInstance(t?t[e]:null);if(this.GetPlugin().GetSdkVersion()<2){if(this._sdkInst=LG.New(this._objectType.GetInstanceSdkCtor(),this,e),!(this._sdkInst instanceof LG.SDKInstanceBase))throw new Error("sdk type must derive from SDKInstanceBase");!this.GetPlugin().IsWorldType()&&this._objectType._GetUserScriptInstanceClass()&&this.GetInterfaceClass()}else{const t=this.GetPlugin().GetScriptInterfaceClass();this._InitUserScriptInterface(t.Instance,e)}}GetSdkInstance(){return this._sdkInst??this._iScriptInterface}GetWorldInfo(){return this._worldInfo}GetRuntime(){return this._runtime}GetTimeScale(){return this._timeScale}GetActiveTimeScale(){const e=this._timeScale;return-1===e?this.GetRuntime().GetTimeScale():e}SetTimeScale(e){((e=+e)<0||!isFinite(e))&&(e=0),this._timeScale=e,this.GetObjectClass().UsesEffects()&&this._runtime._SetTrackingInstanceTime(this,!0)}RestoreTimeScale(){this._timeScale=-1,this.GetObjectClass().UsesEffects()&&this._runtime._SetTrackingInstanceTime(this,!1)}GetInstanceGameTime(){return this._runtime._GetInstanceGameTime(this)}Dispatcher(){return this._dispatcher||(this._dispatcher=LG.New(LG.Event.Dispatcher)),this._dispatcher}Draw(e){this._sdkInst?this._sdkInst.Draw(e):this._iScriptInterface._draw(this._runtime.GetCanvasManager().GetIRenderer())}OnCreate(e){this._sdkInst.OnCreate(e)}_SetHasTilemap(){this._flags|=2}HasTilemap(){return!!(2&this._flags)}_MarkDestroyed(){this._flags|=1}IsDestroyed(){return!!(1&this._flags)}MustPreDraw(){return!!(4&this._flags)||this._sdkInst.MustPreDraw()}SetMustMitigateZFighting(){this._flags|=32}MustMitigateZFighting(){return!!(32&this._flags)}_IsSolidEnabled(){return!!(8&this._flags)}_SetSolidEnabled(e){e?this._flags|=8:this._flags&=-9}_IsJumpthruEnabled(){return!!(16&this._flags)}_SetJumpthruEnabled(e){e?this._flags|=16:this._flags&=-17}_IsDrawingWithEffects(){return!!(64&this._flags)}_SetIsDrawingWithEffects(e){e?this._flags|=64:this._flags&=-65}SetFlag(e,t){e<<=16,t?this._flags|=e:this._flags&=~e}GetFlag(e){return!!(this._flags&e<<16)}GetCurrentImageInfo(){return this._sdkInst.GetCurrentImageInfo()}GetCurrentSurfaceSize(){return this._sdkInst.GetCurrentSurfaceSize()}GetCurrentTexRect(){return this._sdkInst.GetCurrentTexRect()}GetCurrentTexQuad(){return this._sdkInst.GetCurrentTexQuad()}IsCurrentTexRotated(){return this._sdkInst.IsCurrentTexRotated()}GetImagePoint(e){return this._sdkInst.GetImagePoint(e)}GetObjectClass(){return this._objectType}RendersToOwnZPlane(){return this._sdkInst.RendersToOwnZPlane()}BelongsToObjectClass(e){return e.IsFamily()?e.FamilyHasMember(this.GetObjectClass()):this.GetObjectClass()===e}CollectInstancesToPick(e,t,s){const n=(t,s)=>{const n=s||t.GetObjectClass(),i=e.get(n);i?i.add(t):e.set(n,new Set([t]))};if(n(this,t),this.IsInContainer())for(const e of this.siblings())n(e);if(s)for(const e of this.allChildren())n(e)}VerifySupportsSceneGraph(){if(!this.GetPlugin().SupportsSceneGraph())throw new Error("object does not support scene graph")}HasParent(){return null!==this.GetParent()}GetParent(){const e=this.GetWorldInfo();if(!e)return null;const t=e.GetParent();return t?t.GetInstance():null}GetTopParent(){const e=this.GetWorldInfo();if(!e)return null;const t=e.GetTopParent();return t?t.GetInstance():null}*parents(){const e=this.GetWorldInfo();if(e)for(const t of e.parents())yield t.GetInstance()}HasChild(e){if(!e)return!1;for(const t of this.children())if(t===e)return!0;return!1}HasChildren(){const e=this.GetWorldInfo();return!!e&&e.HasChildren()}GetChildrenOfObjectClass(e){const t=this.GetWorldInfo();if(!t)return[];const s=e.GetName();return t.GetChildren().map((e=>e.GetInstance())).filter((e=>e.GetObjectClass().GetName()===s))}GetChildren(){const e=this.GetWorldInfo();return e?e.GetChildren().map((e=>e.GetInstance())):[]}*children(){const e=this.GetWorldInfo();if(e)for(const t of e.children())yield t.GetInstance()}*allChildren(){const e=this.GetWorldInfo();if(e)for(const t of e.allChildren())yield t.GetInstance()}GetChildCount(){const e=this.GetWorldInfo();return e?e.GetChildCount():0}GetParentCount(){return[...this.parents()].length}GetAllChildCount(){const e=this.GetWorldInfo();return e?e.GetAllChildCount():0}GetChildAt(e){const t=this.GetWorldInfo();if(!t)return null;const s=t.GetChildAt(e);return s?s.GetInstance():null}GetIndexInParent(){const e=this.GetWorldInfo();if(!e)return NaN;const t=e.GetParent();return t?t.GetChildIndex(e):NaN}HasChildWithUID(e){for(const t of this.GetWorldInfo().GetChildren())if(t.GetInstance().GetUID()===e)return!0;return!1}AddChild(e,t){this.VerifySupportsSceneGraph(),e.VerifySupportsSceneGraph(),this.GetWorldInfo().AddChild(e.GetWorldInfo(),t||{})}RemoveChild(e){const t=this.GetWorldInfo();t&&t.RemoveChild(e.GetWorldInfo())}GetDestroyWithParent(){const e=this.GetWorldInfo();return!!e&&e.GetDestroyWithParent()}SetupInitialSceneGraphConnections(){const e=this.GetWorldInfo();if(!e)return;const t=e.GetSceneGraphChildrenExportData();if(t)for(const e of t){const t=this._runtime.GetInstanceByUID(e[2]);if(t){const s=e[3];this.AddChild(t,{transformX:!!(1&s),transformY:!!(s>>1&1),transformWidth:!!(s>>2&1),transformHeight:!!(s>>3&1),transformAngle:!!(s>>4&1),destroyWithParent:!!(s>>5&1),transformZElevation:!!(s>>6&1),transformOpacity:!!(s>>7&1),transformVisibility:!!(s>>8&1)})}}}SetupPersistedSceneGraphConnections(e,t){const s=e.get(this);if(s)for(const e of s.sceneGraphJson.children){const s=t.get(e.index);if(!s)continue;const n=e.flags;this.AddChild(s,{transformX:!!(1&n),transformY:!!(n>>1&1),transformWidth:!!(n>>2&1),transformHeight:!!(n>>3&1),transformAngle:!!(n>>4&1),destroyWithParent:!!(n>>5&1),transformZElevation:!!(n>>6&1),transformOpacity:!!(n>>7&1),transformVisibility:!!(n>>8&1)})}}GetTemplateName(){const e=this._runtime.GetTemplateManager();return e?e.GetInstanceTemplateName(this):""}IsInContainer(){return null!==this._siblings}_ClearSiblings(){LG.clearArray(this._siblings)}_AddSibling(e){this._siblings.push(e)}GetSiblings(){return this._siblings}HasSibling(e){return!!this.GetSibling(e)}GetSibling(e){const t=this.siblings();if(null===t||0===t.length)return!1;for(const s of t)if(s.GetObjectClass()===e)return s;return null}siblings(){return this._siblings}SetSiblingsSinglePicked(){for(const e of this.siblings())e.GetObjectClass().GetCurrentSol().SetSinglePicked(e)}_PushSiblingsToSolInstances(){for(const e of this.siblings())e.GetObjectClass().GetCurrentSol()._PushInstance(e)}_SetSiblingsToSolInstancesIndex(e){for(const t of this.siblings())t.GetObjectClass().GetCurrentSol()._GetOwnInstances()[e]=t}_PushSiblingsToSolElseInstances(){for(const e of this.siblings())e.GetObjectClass().GetCurrentSol()._PushElseInstance(e)}_SetSiblingsToSolElseInstancesIndex(e){for(const t of this.siblings())t.GetObjectClass().GetCurrentSol()._GetOwnElseInstances()[e]=t}GetPlugin(){return this._objectType.GetPlugin()}_SetIID(e){this._iid=e}GetIID(){return this._objectType._UpdateIIDs(),this._iid}GetUID(){return this._uid}SetUID(e){this._uid=e}GetPUID(){return this._puid}_SetTagsSetFromJson(e){e?this.SetTagsSet(new Set(e)):this._tagsSet=null}SetTagsSet(e){if(0===e.size)this._tagsSet=null;else{this._tagsSet?this._tagsSet.clear():this._tagsSet=new Set;for(const t of e)this._tagsSet.add(t)}}GetTagsSet(){return this._tagsSet??new Set}GetTagsString(){return Array.from(this.GetTagsSet()).join(" ")}GetTagAt(e){e=Math.floor(e);for(const t of this.GetTagsSet()){if(0===e)return t;--e}return""}GetBehaviorInstances(){return this._behaviorInstances}GetBehaviorInstanceFromCtor(e){if(!e)return null;for(const t of this._behaviorInstances)if(t.GetBehavior()instanceof e)return t;return null}GetBehaviorSdkInstanceFromCtor(e){if(!e)return null;const t=this.GetBehaviorInstanceFromCtor(e);return t?t.GetSdkInstance():null}GetBehaviorIndexBySID(e){const t=this._behaviorInstances;for(let s=0,n=t.length;s<n;++s)if(t[s].GetBehaviorType().GetSID()===e)return s;return-1}GetAllInstanceVariableValues(){return this._instVarValues}_GetAllInstanceVariableNames(){return this._objectType._GetAllInstanceVariableNames()}GetInstanceVariableCount(){return this._instVarValues.length}GetInstanceVariableValue(e){e|=0;const t=this._instVarValues;if(e<0||e>=t.length)throw new RangeError("invalid instance variable");return t[e]}_GetInstanceVariableValueUnchecked(e){return this._instVarValues[e]}_GetInstanceVariableTypedValue(e){const t=this._instVarValues[e];return 0===this._objectType.GetInstanceVariableType(e)?!!t:t}SetInstanceVariableValue(e,t){e|=0;const s=this._instVarValues;if(e<0||e>=s.length)throw new RangeError("invalid instance variable");switch(this._objectType.GetInstanceVariableType(e)){case 0:s[e]=t?1:0;break;case 1:s[e]="number"==typeof t?t:parseFloat(t);break;case 2:s[e]="string"==typeof t?t:t.toString();break;default:throw new Error("unknown instance variable type")}}SetInstanceVariableOffset(e,t){if(0===t)return;e|=0;const s=this._instVarValues;if(e<0||e>=s.length)throw new RangeError("invalid instance variable");const n=s[e];if("number"!=typeof n)throw"boolean"==typeof n?new Error("can not set offset of boolean variable"):"string"==typeof n?new Error("can not set offset of string variable"):new Error("unknown instance variable type");s[e]+="number"==typeof t?t:parseFloat(t)}GetSavedDataMap(){let e=VG.get(this);return e||(e=new Map,VG.set(this,e),e)}GetUnsavedDataMap(){let e=jG.get(this);return e||(e=new Map,jG.set(this,e),e)}_HasAnyCreateDestroyHandler(e){const t=this.GetObjectClass();if(t.UserScriptDispatcher().HasAnyHandlerFor(e))return!0;for(const s of t.GetFamilies())if(s.UserScriptDispatcher().HasAnyHandlerFor(e))return!0;return!!this._runtime.UserScriptDispatcher().HasAnyHandlerFor(e)}_TriggerOnCreatedOnSelfAndRelated(e=void 0){const t=e??new Set;if(t.has(this))return;t.add(this);const s=this.GetWorldInfo();if(s&&s.HasChildren())for(const e of this.allChildren())if(t.add(e),e.IsInContainer())for(const s of e.siblings())t.add(s);if(this.IsInContainer())for(const e of this.siblings())e._TriggerOnCreatedOnSelfAndRelated(t);if(!e){for(const e of t.values())e._TriggerOnCreated();this._OnHierarchyReady()}}_OnCreatedCommon(){this._objectType._GetUserScriptInstanceClass()&&this.GetInterfaceClass();for(const e of this._behaviorInstances)e.PostCreate()}_OnCreatedForLoadingSavegame(){this._OnCreatedCommon()}_TriggerOnCreated(){if(this._OnCreatedCommon(),this._HasAnyCreateDestroyHandler("instancecreate")){const e=this.GetObjectClass(),t=new LG.Event("instancecreate");t.instance=this.GetInterfaceClass(),e.DispatchUserScriptEvent(t);for(const s of e.GetFamilies())s.DispatchUserScriptEvent(t);this._runtime.DispatchUserScriptEvent(t)}this._runtime.Trigger(this.GetPlugin().GetConstructor().Cnds.OnCreated,this,null)}_OnHierarchyReady(){if(this.GetPlugin().SupportsSceneGraph()){if(this.DispatchUserScriptEvent(new LG.Event("hierarchyready")),this._HasAnyCreateDestroyHandler("hierarchyready")){const e=this.GetObjectClass(),t=new LG.Event("hierarchyready");t.instance=this.GetInterfaceClass(),e.DispatchUserScriptEvent(t);for(const s of e.GetFamilies())s.DispatchUserScriptEvent(t);this._runtime.DispatchUserScriptEvent(t)}this._runtime.Trigger(this.GetPlugin().GetConstructor().Cnds.OnHierarchyReady,this,null)}}_TriggerOnDestroyed(){this._runtime.Trigger(this.GetPlugin().GetConstructor().Cnds.OnDestroyed,this,null)}_FireDestroyedScriptEvents(e){if(this._iScriptInterface){const t=new LG.Event("destroy");t.isEndingLayout=e,this.DispatchUserScriptEvent(t)}if(!this._HasAnyCreateDestroyHandler("instancedestroy"))return;const t=this.GetObjectClass(),s=new LG.Event("instancedestroy");s.instance=this.GetInterfaceClass(),s.isEndingLayout=e,t.DispatchUserScriptEvent(s);for(const e of t.GetFamilies())e.DispatchUserScriptEvent(s);this._runtime.DispatchUserScriptEvent(s)}_GetDebuggerProperties(){return this._sdkInst?this._sdkInst.GetDebuggerProperties():this._iScriptInterface._getDebuggerProperties()}SaveToJson(e="full",t=null){const s={};"full"===e?s.uid=this.GetUID():s.c3=!0;const n=this.GetTagsSet();if(n.size>0&&(s.tags=Array.from(n)),"visual-state"!==e){const t=VG.get(this);if(t&&t.size&&(s.ex=LG.ToSuperJSON(t)),-1!==this.GetTimeScale()&&(s.mts=this.GetTimeScale()),this._objectType.GetInstanceVariablesCount()>0){const e={},t=this._objectType.GetInstanceVariableSIDs();for(let s=0,n=this._instVarValues.length;s<n;++s)e[t[s].toString()]=this._instVarValues[s];s.ivs=e}if(this._behaviorInstances.length){const t={};for(const s of this._behaviorInstances){const n=s.SaveToJson(e);n&&(t[s.GetBehaviorType().GetSID().toString()]=n)}s.behs=t}}this._worldInfo&&(s.w=this._worldInfo._SaveToJson(e,t));const i=this._sdkInst?this._sdkInst.SaveToJson():this._iScriptInterface._saveToJson();return i&&(s.data=i),s}_OnBeforeLoad(e="full",t=null){this._worldInfo&&this._worldInfo._OnBeforeLoad(e)}_OnAfterLoad(e,t="full",s=null){this._worldInfo&&this._worldInfo._OnAfterLoad(e,t,s)}_OnAfterLoad2(e,t="full",s=null){this._worldInfo&&this._worldInfo._OnAfterLoad2(e,t,s)}_SetupSceneGraphConnectionsOnChangeOfLayout(){this.GetPlugin().IsWorldType()&&this._worldInfo._SetupSceneGraphConnectionsOnChangeOfLayout()}LoadFromJson(e,t="full",s=null){if("full"===t)this._uid=e.uid;else if(!e.c3)return;if(this._SetTagsSetFromJson(e.tags),"visual-state"!==t){let t=VG.get(this);t&&(t.clear(),VG.delete(this));const s=e.ex;s&&(t=LG.FromSuperJSON(s),VG.set(this,t)),this._timeScale=e.hasOwnProperty("mts")?e.mts:-1;const n=e.ivs;if(n)for(const[e,t]of Object.entries(n)){const s=parseInt(e,10),n=this._objectType.GetInstanceVariableIndexBySID(s);if(n<0||n>=this._instVarValues.length)continue;let i=t;null===i&&(i=NaN),this._instVarValues[n]=i}}if(this.GetPlugin().IsWorldType()){const n=e.w;if(n){const e=n.l;if(this._worldInfo.GetLayer().GetSID()!==e){const s=this._worldInfo.GetLayer(),n=s.GetLayout().GetLayerBySID(e);n?(this._worldInfo._SetLayer(n),s._RemoveInstance(this,!0),n._AddInstance(this,!0),n.SetZIndicesChanged(this),this._worldInfo.SetBboxChanged()):"full"===t&&this._runtime.DestroyInstance(this)}this._worldInfo._LoadFromJson(n,t,s)}}if("visual-state"!==t){const s=e.behs;if(s)for(const[e,n]of Object.entries(s)){const s=parseInt(e,10),i=this.GetBehaviorIndexBySID(s);i<0||i>=this._behaviorInstances.length||this._behaviorInstances[i].LoadFromJson(n,t)}}const n=e.data;n&&(this._sdkInst?this._sdkInst.LoadFromJson(n,t):this._iScriptInterface._loadFromJson(n))}MoveToLayerWithSID(e){if(this._worldInfo.GetLayer().GetSID()===e)return;const t=this._worldInfo.GetLayer(),s=t.GetLayout().GetLayerBySID(e);s&&(this._worldInfo._SetLayer(s),t._RemoveInstance(this,!0),s._AddInstance(this,!0),s.SetZIndicesChanged(this),this._worldInfo.SetBboxChanged())}GetInterfaceClass(){return this._iScriptInterface||this._InitUserScriptInterface()}HasScriptInterface(){return!!this._iScriptInterface}_InitUserScriptInterface(e,t){const s=this._worldInfo?e?self.ISDKWorldInstanceBase:self.IWorldInstance:e?self.ISDKInstanceBase:self.IInstance,n=e||this._sdkInst.GetScriptInterfaceClass(),i=this._objectType._GetUserScriptInstanceClass(),r=i||n||s,a=this.GetPlugin().GetSdkVersion();if(LG.AddonManager._PushInitObject(this,a),LG.AddonManager._PushInitProperties(t),this._iScriptInterface=new r,LG.AddonManager._PopInitProperties(),LG.AddonManager._PopInitObject(a),n&&!(this._iScriptInterface instanceof s))throw new TypeError(`script interface class '${n.name}' does not extend the right base class '${s.name}'`);if(i){const e=n||s;if(!(this._iScriptInterface instanceof e))throw new TypeError(`setInstanceClass(): class '${i.name}' does not extend the right base class - check it extends the right class, e.g. globalThis.InstanceType.MyObjectName`)}return this._iScriptInterface}_GetInstVarsScriptDescriptor(e){if(0===this._instVarValues.length)return;const t={},s=this._objectType._GetAllInstanceVariableJsPropNames();for(let e=0,n=s.length;e<n;++e)t[s[e]]={configurable:!1,enumerable:!0,get:LG.Instance.prototype._GetInstanceVariableTypedValue.bind(this,e),set:LG.Instance.prototype.SetInstanceVariableValue.bind(this,e)};const n=Object.create(Object.prototype,t);e.instVars={value:n,writable:!1}}_GetBehaviorsScriptDescriptor(e){const t=this._behaviorInstances;if(0===t.length)return;const s={};for(const e of t)s[e.GetBehaviorType().GetJsPropName()]={value:e.GetScriptInterface(),writable:!1};const n=Object.create(Object.prototype,s);e.behaviors={value:n,writable:!1}}DispatchUserScriptEvent(e){if(!this.HasScriptInterface())return;const t=this.GetInterfaceClass();e.instance=t;const s=this._runtime,n=s.IsDebug()&&!s.GetEventSheetManager().IsInEventEngine();n&&FG.StartMeasuringScriptTime(),t.dispatchEvent(e),n&&FG.AddScriptTime()}}}{const KG=self.C3,$G=new Map;KG.SceneGraphInfo=class extends KG.DefendedBase{constructor(e){super(),this._owner=e,this._parent=null,this._children=[],this._startWidth=e.GetWidth(),this._startHeight=e.GetHeight(),this._startScaleX=1,this._startScaleY=1,this._parentStartAngle=0,this._ownOpacity=1,this._startOpacity=e.GetOpacity(),this._tmpSceneGraphChildren=null,this._tmpSceneGraphChildrenIndexes=null,this._indexInParent=NaN,this._originalSizeKnown=!1,this._originalWidth=NaN,this._originalHeight=NaN,this._on_instance_create=t=>{if(t.instance!==this._parent.GetInstance())return;e.GetRuntime().Dispatcher().removeEventListener("instancecreate",this._on_instance_create);const s=this._parent.GetInstance().GetSdkInstance();this._originalSizeKnown=!!s.IsOriginalSizeKnown(),this._originalWidth=this._originalSizeKnown?s.GetOriginalWidth():NaN,this._originalHeight=this._originalSizeKnown?s.GetOriginalHeight():NaN}}Release(){this._parent=null,this._tmpSceneGraphChildren=null,this._tmpSceneGraphChildrenIndexes=null,this._indexInParent=NaN,this._originalSizeKnown=!1,this._originalWidth=NaN,this._originalHeight=NaN,KG.clearArray(this._children)}SetParent(e){if(this._ownOpacity=this._owner.GetOpacity(),this._startOpacity=this._ownOpacity,this._parent=e,this._parentStartAngle=e?e.GetAngle():0,this._parent){const e=this._owner.GetRuntime();if(this._parent.GetInstance().GetPlugin().GetSdkVersion()<2){const t=this._parent.GetInstance().GetSdkInstance();t?(this._originalSizeKnown=!!t.IsOriginalSizeKnown(),this._originalWidth=this._originalSizeKnown?t.GetOriginalWidth():NaN,this._originalHeight=this._originalSizeKnown?t.GetOriginalHeight():NaN):this._parent.GetInstance().IsDestroyed()||e.Dispatcher().addEventListener("instancecreate",this._on_instance_create)}else this._originalSizeKnown=!1,this._originalWidth=NaN,this._originalHeight=NaN}else this._originalSizeKnown=!1,this._originalWidth=NaN,this._originalHeight=NaN}GetParent(){return this._parent}HasChildren(){return this._children.length>0}GetChildren(){return this._children}_MaybeSortChildren(){this.HasChildren()&&1!==this._children.length&&(this._tmpSceneGraphChildrenIndexes?this._children.sort(((e,t)=>{const s=this._tmpSceneGraphChildrenIndexes.get(e.GetInstance()),n=this._tmpSceneGraphChildrenIndexes.get(t.GetInstance());return KG.IsFiniteNumber(s)&&KG.IsFiniteNumber(n)?s-n:0})):this._children.sort(((e,t)=>{const s=e._GetSceneGraphInfo()._GetIndexInParent(),n=t._GetSceneGraphInfo()._GetIndexInParent();return KG.IsFiniteNumber(s)&&KG.IsFiniteNumber(n)?s-n:0})))}_GetIndexInParent(){return this._indexInParent}GetStartScaleX(){return this._startScaleX}SetStartScaleX(e){this._startScaleX=e}GetStartScaleY(){return this._startScaleY}SetStartScaleY(e){this._startScaleY=e}GetStartOpacity(){return this._startOpacity}GetOwnOpacity(){return this._ownOpacity}SetOwnOpacity(e){this._ownOpacity=e}_GetStartWidth(){return 0===this._startWidth?Number.EPSILON:this._startWidth}_GetStartHeight(){return 0===this._startHeight?Number.EPSILON:this._startHeight}GetParentScaleX(){if(this._owner.GetTransformWithParentWidth()){const e=this._parent;let t=e.GetWidth(),s=e._GetSceneGraphInfo()._GetStartWidth();return 0===t&&(t=Number.EPSILON),s===Number.EPSILON&&t===Number.EPSILON?1:s===Number.EPSILON&&t!==Number.EPSILON&&this._originalSizeKnown?1+t/this._originalWidth:t/s}return 1}GetParentScaleY(){if(this._owner.GetTransformWithParentHeight()){const e=this._parent;let t=e.GetHeight(),s=e._GetSceneGraphInfo()._GetStartHeight();return 0===t&&(t=Number.EPSILON),s===Number.EPSILON&&t===Number.EPSILON?1:s===Number.EPSILON&&t!==Number.EPSILON&&this._originalSizeKnown?1+t/this._originalHeight:t/s}return 1}GetParentStartAngle(){return 0}_SaveToJsonProperties(){return{sw:this._startWidth,sh:this._startHeight,sx:this._startScaleX,sy:this._startScaleY,psa:this._parentStartAngle,oo:this._ownOpacity,so:this._startOpacity,pi:this._owner.GetInstance().GetIndexInParent()}}_SaveToJson(e,t=null){const s=this._SaveToJsonProperties();return t&&t.selfOnly?Object.assign(s,{p:null,c:[]}):Object.assign(s,{p:this._GetParentJson(e),c:this._GetChildrenJson(e)})}_GetFlagsString(e){let t="";return e.GetTransformWithParentX()&&(t+="x"),e.GetTransformWithParentY()&&(t+="y"),e.GetTransformWithParentWidth()&&(t+="w"),e.GetTransformWithParentHeight()&&(t+="h"),e.GetTransformWithParentAngle()&&(t+="a"),e.GetTransformWithParentZElevation()&&(t+="z"),e.GetDestroyWithParent()&&(t+="d"),e.GetTransformWithParentOpacity()&&(t+="o"),e.GetTransformWithParentVisibility()&&(t+="v"),t}_GetParentJson(e){return this._parent?!this._parent.GetInstance()||this._parent.GetInstance().IsDestroyed()?null:this._GetInstanceJson(this._parent,this._owner,e):null}_GetChildrenJson(e){return this._children.map((t=>this._GetInstanceJson(t,t,e))).filter((e=>e))}_GetInstanceJson(e,t,s){const n=e.GetInstance();if(n&&n.IsDestroyed())return null;const i={};return i.uid=n.GetUID(),i.f=this._GetFlagsString(t),i.offsets=t._SaveSceneGraphPropertiesToJson(),i.data=KG.SceneGraphInfo.GetSceneGraphInstanceDataFromInstance(n),i.oci=n.GetObjectClass().GetIndex(),"state"===s?(i.inst=n.SaveToJson("full",{selfOnly:!0}),i.instIndex=NaN):(i.instIndex=n.GetObjectClass().GetInstances().indexOf(n),i.inst=null),i}_LoadFromJson(e){this._startWidth=e.sw,this._startHeight=e.sh,this._startScaleX=e.sx,this._startScaleY=e.sy,this._parentStartAngle=e.psa,this._ownOpacity=e.oo,this._startOpacity=e.so,this._indexInParent=KG.IsFiniteNumber(e.pi)?e.pi:NaN}_SetTmpSceneGraphChildren(e,t,s,n){if(!e&&!t)if(n?.setFromJson){if(this._tmpSceneGraphChildren)for(const e of this._tmpSceneGraphChildren)e.IsDestroyed()||e.HasParent()||e.GetRuntime().DestroyInstance(e)}else if(this._tmpSceneGraphChildren)for(const e of this._tmpSceneGraphChildren)if(s.c&&s.c.length){if(!s.c.some((t=>t.uid===e.GetUID())))continue;e.IsDestroyed()||e.HasParent()||e.GetRuntime().DestroyInstance(e)}this._tmpSceneGraphChildren=e,this._tmpSceneGraphChildrenIndexes=t}_GetInstanceByUID(e){const t=this._owner.GetRuntime();return $G.has(e)?$G.get(e):t.GetInstanceByUID(e)}_OnAfterLoad(e,t){const s=this._owner,n=s.GetRuntime(),i=t?.processedWorldInfo??new Set;if(e.p&&!this._parent){const r=e.p.uid,a=this._GetInstanceByUID(r);if(a){const r=a.GetWorldInfo();a.HasChild(s.GetInstance())?this._parent=r:(a.HasChildWithUID(s.GetInstance().GetUID())?(n.DestroyInstance(s.GetInstance()),n._RemoveInstanceFromUIDMap(s.GetInstance().GetUID()),$G.delete(s.GetInstance().GetUID())):a.AddChild(s.GetInstance(),this._GetFlagsObj(e.p.f)),i.has(s)||(s._LoadSceneGraphPropertiesFromJson(e.p.offsets),this._LoadInstancePropertiesFromJson(a,e.p,t),this._UpdateUIDInstanceMap(a,a.GetUID(),s.GetRuntime(),t)),i.add(s),a.GetWorldInfo()._GetSceneGraphInfo()._MaybeSortChildren())}else if(KG.IsFiniteNumber(e.p.oci)){const i=n.CreateInstance(n.GetObjectClassByIndex(e.p.oci),s.GetLayer(),0,0,!0);if(i){const r=this._GetInstanceData(e.p,n);r&&i.LoadFromJson(r);const a=i.GetWorldInfo(),o=!!t?.setFromJson;a.GetLayer().SortAndAddInstancesByZIndex(i,!1,o),i.AddChild(s.GetInstance(),this._GetFlagsObj(e.p.f)),$G.set(i.GetUID(),i),this._UpdateUIDInstanceMap(i,i.GetUID(),n,t),i.GetWorldInfo()._GetSceneGraphInfo()._MaybeSortChildren()}}}const r=[];for(const t of e.c){const e=t.uid,s=this._GetInstanceByUID(e);s&&r.push(s)}let a=0;for(const o of e.c){const l=o.uid,c=this._GetInstanceByUID(l);if(c){if(this._tmpSceneGraphChildren){if(this._tmpSceneGraphChildren.includes(c)){const n=c;if(n.GetObjectClass()!==c.GetObjectClass()){a++;continue}if(n.IsDestroyed()){a++;continue}const o=e.c[a];if(!t?.setFromJson&&this._HasAllChildrenOfType(n,r,s)){if(s.GetInstance().GetChildAt(a)){const r=n.GetObjectClass().GetIndex(),l=o.oci,c=s.GetInstance().GetChildAt(a).GetObjectClass().GetIndex();if(r!==l||l!==c){this._RefreshAllChildren(e.c,s,i,t);break}this._UpdateInstance(a,o,s,i,t)}else this._UpdateInstance(a,o,s,i,t);a++;continue}if(n.HasParent()&&n.GetParent()!==s.GetInstance()){const e=this._CreateNewChildInstance(o,t);this._AddAndSetChildInstance(e,o,i,t),a++;continue}this._AddAndSetChildInstance(n.GetWorldInfo(),o,i,t,!0),a++;continue}if(this._tmpSceneGraphChildren[a]){const n=this._tmpSceneGraphChildren[a];if(n.GetObjectClass()!==c.GetObjectClass()){a++;continue}if(n.IsDestroyed()){a++;continue}const o=e.c[a];if(!t?.setFromJson&&this._HasAllChildrenOfType(n,r,s)){if(s.GetInstance().GetChildAt(a)){const r=n.GetObjectClass().GetIndex(),l=o.oci,c=s.GetInstance().GetChildAt(a).GetObjectClass().GetIndex();if(r!==l||l!==c){this._RefreshAllChildren(e.c,s,i,t);break}this._UpdateInstance(a,o,s,i,t)}else this._UpdateInstance(a,o,s,i,t);a++;continue}if(n.HasParent()&&n.GetParent()!==s.GetInstance()){const e=this._CreateNewChildInstance(o,t);this._AddAndSetChildInstance(e,o,i,t),a++;continue}this._AddAndSetChildInstance(n.GetWorldInfo(),o,i,t,!0),a++;continue}}const n=c.GetObjectClass();if(this._GetInstancesOfObjectClassCount(r,n)===s.GetInstance().GetChildrenOfObjectClass(n).length){for(const e of s.GetInstance().GetChildren()){if(e.GetObjectClass()!==n)continue;const s=e.GetWorldInfo();if(s&&!i.has(s)){i.add(s),s._LoadSceneGraphPropertiesFromJson(o.offsets),this._LoadInstancePropertiesFromJson(e,o,t);break}}a++;continue}if(c.HasParent()&&c.GetParent()!==s.GetInstance()){const e=this._CreateNewChildInstance(o,t);this._AddAndSetChildInstance(e,o,i,t),a++;continue}this._AddAndSetChildInstance(c.GetWorldInfo(),o,i,t)}else if(this._tmpSceneGraphChildren&&this._tmpSceneGraphChildren[a]){const l=this._tmpSceneGraphChildren[a],c=n.GetObjectClassByIndex(this._GetObjectClassIndex(o));if(l.GetObjectClass()!==c){a++;continue}if(l.IsDestroyed()){a++;continue}const h=e.c[a];if(!t?.setFromJson&&this._HasAllChildrenOfType(l,r,s)){if(s.GetInstance().GetChildAt(a)){const n=l.GetObjectClass().GetIndex(),r=h.oci,o=s.GetInstance().GetChildAt(a).GetObjectClass().GetIndex();if(n!==r||r!==o){this._RefreshAllChildren(e.c,s,i,t);break}this._UpdateInstance(a,h,s,i,t)}else this._UpdateInstance(a,h,s,i,t);a++;continue}if(l.HasParent()&&l.GetParent()!==s.GetInstance()){const e=this._CreateNewChildInstance(h,t);this._AddAndSetChildInstance(e,h,i,t),a++;continue}this._AddAndSetChildInstance(l.GetWorldInfo(),h,i,t)}else{const e=this._CreateNewChildInstance(o,t);this._AddAndSetChildInstance(e,o,i,t)}a++}}_RefreshAllChildren(e,t,s,n){const i=t.GetRuntime();for(const e of t.GetInstance().children())e&&!e.IsDestroyed()&&(i.DestroyInstance(e),i._RemoveInstanceFromUIDMap(e.GetUID()),$G.delete(e.GetUID()));this._tmpSceneGraphChildren&&(this._tmpSceneGraphChildren=[]),this._tmpSceneGraphChildrenIndexes&&(this._tmpSceneGraphChildrenIndexes=new WeakMap),Object.assign({},n,{assignZIndex:!1});for(const t of e){const e=this._CreateNewChildInstance(t,n);this._AddAndSetChildInstance(e,t,s,n),this._tmpSceneGraphChildren.push(e.GetInstance()),this._tmpSceneGraphChildrenIndexes.set(e.GetInstance(),this._tmpSceneGraphChildren.length-1)}t._GetSceneGraphInfo()._MaybeSortChildren()}_HasAllChildrenOfType(e,t,s){const n=e.GetObjectClass();return this._GetInstancesOfObjectClassCount(t,n)===s.GetInstance().GetChildrenOfObjectClass(n).length}_UpdateInstance(e,t,s,n,i){const r=s.GetInstance().GetChildAt(e);if(!r)return;const a=r.GetWorldInfo();a&&(n.has(a)||(a._LoadSceneGraphPropertiesFromJson(t.offsets),this._LoadInstancePropertiesFromJson(r,t,i)),n.add(a))}_GetFlagsObj(e){const t={};return t.transformX=e.includes("x"),t.transformY=e.includes("y"),t.transformWidth=e.includes("w"),t.transformHeight=e.includes("h"),t.transformAngle=e.includes("a"),t.transformZElevation=e.includes("z"),t.destroyWithParent=e.includes("d"),t.transformOpacity=e.includes("o"),t.transformVisibility=e.includes("v"),t}_GetObjectClassIndex(e){return KG.IsFiniteNumber(e.oci)?e.oci:e[1]}_CreateNewChildInstance(e,t){if(!KG.IsFiniteNumber(e.oci))return;const s=this._owner,n=s.GetRuntime();let i;const r=!t.hasOwnProperty("createHierarchy")||t.createHierarchy;if(i=e.data?n.CreateInstanceFromData(e.data,s.GetLayer(),!1,0,0,!1,r):n.CreateInstance(n.GetObjectClassByIndex(e.oci),s.GetLayer(),0,0,r),!i)return;const a=this._GetInstanceData(e,n);a&&i.LoadFromJson(a);const o=i.GetWorldInfo(),l=!!t?.setFromJson;return o.GetLayer().SortAndAddInstancesByZIndex(i,!0,l),o}_UpdateUIDInstanceMap(e,t,s,n){if(this._GetInstanceByUID(t)&&!n?.setFromJson){const n=this._GetInstanceByUID(t);n!==e&&s.DestroyInstance(n)}s._RemoveInstanceFromUIDMap(t),s._MapInstanceByUID(t,e)}_AddAndSetChildInstance(e,t,s,n,i=!0){const r=this._owner,a=r.AddChild(e,this._GetFlagsObj(t.f));a&&i?(s.has(e)||(e._LoadSceneGraphPropertiesFromJson(t.offsets),this._LoadInstancePropertiesFromJson(e.GetInstance(),t,n)),s.add(e)):a&&($G.set(e.GetInstance().GetUID(),e.GetInstance()),this._UpdateUIDInstanceMap(e.GetInstance(),t.uid,r.GetRuntime(),n)),this._MaybeSortChildren()}_LoadInstancePropertiesFromJson(e,t,s){let n=this._GetInstanceData(t,this._owner.GetRuntime());if(!n)return;const i=!s.hasOwnProperty("clearChildren")||s.clearChildren,r=!s.hasOwnProperty("assignZIndex")||s.assignZIndex,a=e.GetRuntime();if($G.set(e.GetUID(),e),n=JSON.parse(JSON.stringify(n)),i&&e.GetUID()!==n.uid){for(const t of e.children())t&&!t.IsDestroyed()&&(a.DestroyInstance(t),a._RemoveInstanceFromUIDMap(t.GetUID()),$G.delete(t.GetUID()));if(n.w?.sgi&&n.w.sgi.c?.length)for(const t of n.w.sgi.c){const n=Object.assign({},s,{clearChildren:!1,createHierarchy:!1}),i=this._CreateNewChildInstance(t,n);$G.set(i.GetInstance().GetUID(),i.GetInstance()),e.AddChild(i.GetInstance(),this._GetFlagsObj(t.f)),i._LoadSceneGraphPropertiesFromJson(t.offsets),this._LoadInstancePropertiesFromJson(i.GetInstance(),t,n)}}const o=n.w?.zi,l=n.w?.l;n.w=null,e.LoadFromJson(n),s?.setFromJson||(KG.IsFiniteNumber(o)&&r&&e.GetWorldInfo()._SetZIndex(o),KG.IsFiniteNumber(l)&&e.MoveToLayerWithSID(l)),this._UpdateUIDInstanceMap(e,n.uid,a,s)}_GetInstancesOfObjectClassCount(e,t){return e.filter((e=>e.GetObjectClass().GetName()===t.GetName())).length}_GetInstanceData(e,t){if(KG.IsFiniteNumber(e.instIndex)){const s=t.GetObjectClassByIndex(e.oci)._GetLoadInstancesJson();return s?s[e.instIndex]:null}return KG.IsString(e.inst)?JSON.parse(e.inst):e.inst?e.inst:void 0}static GetSceneGraphInstanceDataFromInstance(e){let t=e.GetWorldInfo().GetLayer().GetInitialInstanceData(e.GetUID());if(!t)return null;t=JSON.parse(JSON.stringify(t));const s=[];for(const t of[...e.GetChildren()]){const e=t.GetWorldInfo();s.push([e.GetLayout().GetSID(),e.GetLayer().GetIndex(),t.GetUID(),KG.SceneGraphInfo._GetFlagsNumber(e),t.GetObjectClass().IsInContainer()?1:0,e.GetZIndex(),KG.SceneGraphInfo.GetSceneGraphInstanceDataFromInstance(t)])}return KG.IsArray(t[0][14])?t[0][14][1]=s:(t[0][14]=[],t[0][14][0]=KG.SceneGraphInfo._GetDefaultFlagsNumber(),t[0][14][1]=s,t[0][14][2]=e.GetWorldInfo().GetZIndex()),t}static _GetFlagsNumber(e){let t=0;return t|=Number(e.GetTransformWithParentVisibility())<<8,t|=Number(e.GetTransformWithParentOpacity())<<7,t|=Number(e.GetTransformWithParentZElevation())<<6,t|=Number(e.GetDestroyWithParent())<<5,t|=Number(e.GetTransformWithParentAngle())<<4,t|=Number(e.GetTransformWithParentHeight())<<3,t|=Number(e.GetTransformWithParentWidth())<<2,t|=Number(e.GetTransformWithParentY())<<1,t|=0|Number(e.GetTransformWithParentX()),t}static _GetDefaultFlagsNumber(e){let t=0;return t|=256,t|=128,t|=64,t|=32,t|=16,t|=8,t|=4,t|=2,t|=1,511}static ClearUpdatedInstances(){$G.clear()}}}{const ZG=self.C3,QG=self.glMatrix,ev=QG.vec3,tv=QG.vec4,sv=ZG.New(ZG.Rect),nv=ZG.New(ZG.Quad),iv=ZG.New(ZG.Event,"bboxchange",!1),rv=ZG.New(ZG.Color,0,0,0,0),av=ZG.New(ZG.CollisionPoly),ov=ZG.New(ZG.Color,1,1,1,1),lv=ZG.New(ZG.Rect,0,0,-1,-1),cv=ZG.New(ZG.Rect,0,0,-1,-1),hv=new Set(["absolute","relative"]),_v=[];let uv=!0;const dv=1,pv=2,fv=4,mv=8,gv=16,Iv=32,Sv=64,yv=128,bv=256,Gv=512,vv=1024,xv=2048,Tv=4096,Cv=8192,wv=16384,Pv=32768,Av=1<<22,Rv=1<<23,Dv=12647936,Ev=65536,Mv=1<<17,kv=1<<18,Lv=1<<19,Fv=1<<20,Bv=1<<21,Ov=26,Nv=31<<26,Wv=new WeakMap,Vv=new WeakMap;ZG.WorldInfo=class extends ZG.DefendedBase{constructor(e,t){super(),this._inst=e,this._objectClass=e.GetObjectClass(),this._runtime=e.GetRuntime(),this._layer=t,this._objectClass._OnWorldInstanceLayerChanged(this,null,t),this._zIndex=-1,this._htmlZIndex=-1,this._flags=196635,this._objectClass.GetPlugin().IsRotatable()&&(this._flags|=128),this._x=NaN,this._y=NaN,this._zElevation=NaN,this._w=NaN,this._h=NaN,this._depth=NaN,this._a=NaN,this._sinA=NaN,this._cosA=NaN,this._ox=NaN,this._oy=NaN,this._boundingBox=ZG.New(ZG.Rect),this._boundingQuad=ZG.New(ZG.Quad),this._collisionCells=cv,this._renderCells=lv,this._sourceCollisionPoly=null,this._transformedPolyInfo=null,this._solidFilterTags=null,this._color=ov,this._colorPremultiplied=ov,this._stateGroup=null,this._instanceEffectList=null,this._inst.GetObjectClass().UsesEffects()&&(this._instanceEffectList=ZG.New(ZG.InstanceEffectList,this._inst,this)),this._sceneGraphInfo=null,this._tmpSceneGraphChildren=null,this._tmpSceneGraphChildrenIndexes=null,this._tmpHierarchyPosition=-1,this._meshInfo=null}_MarkDestroyed(){this._flags|=256}Release(){if(this._objectClass._OnWorldInstanceLayerChanged(this,this._layer,null),this._stateGroup&&(this._runtime.GetRenderer().ReleaseStateGroup(this._stateGroup),this._stateGroup=null),this._sourceCollisionPoly=null,this._transformedPolyInfo&&(this._transformedPolyInfo.poly.Release(),this._transformedPolyInfo=null),this._solidFilterTags&&(this._solidFilterTags.clear(),this._solidFilterTags=null),this.ReleaseMesh(),this._instanceEffectList&&this._instanceEffectList.Release(),this.HasParent()&&this.GetParent().RemoveChild(this),this.HasChildren()){const e=[...this.GetChildren()];for(const t of e)this.RemoveChild(t)}this._ReleaseSceneGraphInfo(),this._ReleaseTmpSceneGraphInfo(),Wv.delete(this),Vv.delete(this),this._inst=null,this._objectClass=null,this._runtime=null,this._layer=null}Init(e){if(uv=!1,this.SetXY(e[0],e[1]),this.SetZElevation(e[2]),this.SetSize(e[3],e[4]),this._depth=0,this.IsRotatable()?this.SetAngle(e[6]):this._a=0,rv.setFromJSON(e[7]),this._SetColor(rv),this.SetOriginX(e[8]),this.SetOriginY(e[9]),this.SetBlendMode(e[10]),this._instanceEffectList&&this._instanceEffectList._LoadEffectParameters(e[12]),e[14]&&Wv.set(this,{childrenData:e[14][1],zIndexData:e[14][2]}),e[15]){const t=e[15];this.CreateMesh(t[0],t[1]);const s=this.GetSourceMesh(),n=t[2];for(let e=0,t=n.length;e<t;++e){const t=n[e];for(let n=0,i=t.length;n<i;++n){const i=t[n],r=s.GetMeshPointAt(n,e);r.SetX(i[0]),r.SetY(i[1]),r.SetZElevation(i[2]),r.SetU(i[3]),r.SetV(i[4])}}}if(e[16]){const t=e[16][0],s=e[16][1],n=!!s,i=!n,r=this._runtime.GetTemplateManager();n&&r&&r.MapInstanceToTemplateName(this.GetInstance(),s),i&&r&&r.MapInstanceToTemplateName(this.GetInstance(),t)}uv=!0,this._UpdateRendererStateGroup()}InitNoData(){this._x=0,this._y=0,this._zElevation=0,this._w=0,this._h=0,this._depth=0,this._a=0,this._sinA=0,this._cosA=1,this._ox=0,this._oy=0,this._UpdateRendererStateGroup()}GetRuntime(){return this._runtime}GetObjectClass(){return this._objectClass}GetInstance(){return this._inst}_GetParentOffsetAngle(){return this.GetTransformWithParentAngle()?this._MaybeReflectAngleForMirrorFlip(this.GetParent()._GetAngleNoReflect()-this._sceneGraphInfo.GetParentStartAngle()):0}SetX(e){if(e=+e,this.GetTransformWithParentX()){const t=this._sceneGraphInfo,s=e-this.GetX(),n=-this._GetParentOffsetAngle();0===n?this._x+=s/t.GetParentScaleX():(this._x+=Math.cos(n)*s/t.GetParentScaleX(),this.GetTransformWithParentY()&&(this._y+=Math.sin(n)*s/t.GetParentScaleY()))}else this._x=e}OffsetX(e,t=!1){e=+e,t?this._x+=e:this.GetTransformWithParentX()?this.SetX(this.GetX()+e):this._x+=e}GetX(){if(this.GetTransformWithParentX()){let e=this._x;const t=this._sceneGraphInfo,s=this.GetParent(),n=this._GetParentOffsetAngle();return 0===n?e*=t.GetParentScaleX():(e=e*t.GetParentScaleX()*Math.cos(n),this.GetTransformWithParentY()&&(e-=this._y*t.GetParentScaleY()*Math.sin(n))),s.GetX()+e}return this._x}SetY(e){if(e=+e,this.GetTransformWithParentY()){const t=this._sceneGraphInfo,s=e-this.GetY(),n=-this._GetParentOffsetAngle();0===n?this._y+=s/t.GetParentScaleY():(this.GetTransformWithParentX()&&(this._x-=Math.sin(n)*s/t.GetParentScaleX()),this._y+=Math.cos(n)*s/t.GetParentScaleY())}else this._y=e}OffsetY(e,t=!1){e=+e,t?this._y+=e:this.GetTransformWithParentY()?this.SetY(this.GetY()+e):this._y+=e}GetY(){if(this.GetTransformWithParentY()){let e=this._y;const t=this._sceneGraphInfo,s=this.GetParent(),n=this._GetParentOffsetAngle();return 0===n?e*=t.GetParentScaleY():(e=e*t.GetParentScaleY()*Math.cos(n),this.GetTransformWithParentX()&&(e+=this._x*t.GetParentScaleX()*Math.sin(n))),s.GetY()+e}return this._y}SetXY(e,t){if(e=+e,t=+t,this.GetTransformWithParentXOrY()){const s=this.GetTransformWithParentX(),n=this.GetTransformWithParentY(),i=this._sceneGraphInfo,r=e-this.GetX(),a=t-this.GetY(),o=-this._GetParentOffsetAngle();if(0===o)s?this._x+=r/i.GetParentScaleX():this._x=e,n?this._y+=a/i.GetParentScaleY():this._y=t;else{const l=Math.sin(o),c=Math.cos(o);s?this._x+=n?(c*r-l*a)/i.GetParentScaleX():c*r/i.GetParentScaleX():this._x=e,n?this._y+=s?(l*r+c*a)/i.GetParentScaleY():c*a/i.GetParentScaleY():this._y=t}}else this._x=e,this._y=t}GetXY(){return[this.GetX(),this.GetY()]}OffsetXY(e,t){e=+e,t=+t,this.GetTransformWithParentXOrY()?this.SetXY(this.GetX()+e,this.GetY()+t):(this._x+=e,this._y+=t)}EqualsXY(e,t){return this.GetX()===e&&this.GetY()===t}SetZElevation(e){if(e=+e,this.GetTransformWithParentZElevation()&&(e-=this.GetParent().GetZElevation()),this._zElevation===e)return;this._zElevation=e,this._UpdateZElevation();const t=this.GetLayer();0!==this._zElevation&&t._SetAnyInstanceZElevated(),t.SetZIndicesChanged(this)}_UpdateZElevation(){if(this._UpdateRendererStateGroup(),this.HasChildren()){const e=this.GetChildren();for(let t=0,s=e.length;t<s;t++){const s=e[t];s.GetTransformWithParentZElevation()&&s._UpdateZElevation()}}}OffsetZElevation(e){this.SetZElevation(this.GetZElevation()+e)}GetZElevation(){return this.GetTransformWithParentZElevation()?this.GetParent().GetZElevation()+this._zElevation:this._zElevation}GetTotalZElevation(){return this.GetLayer().GetZElevation()+this.GetZElevation()}IsOriginalSizeKnown(){return this.GetInstance().GetPlugin().GetSdkVersion()<2&&this.GetInstance().GetSdkInstance().IsOriginalSizeKnown()}SetWidth(e){if(e=+e,this.GetTransformWithParentWidth()){const t=this.GetWidth();0===t?this._w=Number.EPSILON:this._w*=e/t}else this._w=e;this._MarkSinCosAngleChanged()}OffsetWidth(e,t){e=+e,t?this._w+=e:this.GetTransformWithParentWidth()?this.SetWidth(this.GetWidth()+e):this._w+=e,this._MarkSinCosAngleChanged()}GetWidth(){if(this.GetTransformWithParentWidth()){const e=this.GetParent(),t=e.GetWidth();return e._GetSceneGraphInfo()._GetStartWidth()===Number.EPSILON?(this._GetSceneGraphInfo()._GetStartWidth()+t)*this._w:t*this._w}return this._w}SetHeight(e){if(e=+e,this.GetTransformWithParentHeight()){const t=this.GetHeight();0===t?this._h=Number.EPSILON:this._h*=e/t}else this._h=e;this._MarkSinCosAngleChanged()}OffsetHeight(e,t){e=+e,t?this._h+=e:this.GetTransformWithParentHeight()?this.SetHeight(this.GetHeight()+e):this._h+=e,this._MarkSinCosAngleChanged()}GetHeight(){if(this.GetTransformWithParentHeight()){const e=this.GetParent(),t=e.GetHeight();return e._GetSceneGraphInfo()._GetStartHeight()===Number.EPSILON?(this._GetSceneGraphInfo()._GetStartHeight()+t)*this._h:t*this._h}return this._h}SetSize(e,t){if(e=+e,t=+t,this.GetTransformWithParentWidth()){const t=this.GetWidth();0===t?this._w=Number.EPSILON:this._w*=e/t}else this._w=e;if(this.GetTransformWithParentHeight()){const e=this.GetHeight();0===e?this._h=Number.EPSILON:this._h*=t/e}else this._h=t;this._MarkSinCosAngleChanged()}GetSize(){return[this.GetWidth(),this.GetHeight()]}GetDepth(){return this._depth}SetDepth(e){if(e<0)throw new RangeError("invalid depth");this._depth=e}GetSceneGraphScale(){if(this.HasParent()){const e=this._sceneGraphInfo;return Math.min(e.GetParentScaleX(),e.GetParentScaleY())}return 1}IsRotatable(){return!!(128&this._flags)}SetAngle(e){e=+e,this.IsRotatable()&&(this.GetTransformWithParentAngle()&&(e-=this.GetParent().GetAngle()),e=ZG.clampAngle(e),this._a!==e&&(this._a=e,this._MarkSinCosAngleChanged()))}OffsetAngle(e){0!==(e=+e)&&this.IsRotatable()&&(this._a=ZG.clampAngle(this._a+e),this._MarkSinCosAngleChanged())}_MarkSinCosAngleChanged(){if(this._flags|=262144,this.HasChildren()){const e=this.GetChildren();for(let t=0,s=e.length;t<s;t++)e[t]._MarkSinCosAngleChanged()}}GetAngle(){return this.GetTransformWithParentAngle()&&this.IsRotatable()?this._MaybeReflectAngleForMirrorFlip(ZG.clampAngle(this.GetParent()._GetAngleNoReflect()+this._a)):this._a}_GetAngleNoReflect(){return this.GetTransformWithParentAngle()&&this.IsRotatable()?ZG.clampAngle(this.GetParent()._GetAngleNoReflect()+this._a):this._a}_MaybeReflectAngleForMirrorFlip(e){return this.GetTransformWithParentWidth()&&this.GetTopParent().GetWidth()<0&&(e=ZG.clampAngle(ZG.angleReflect(e,this.GetTopParent().GetAngle()+Math.PI))),this.GetTransformWithParentHeight()&&this.GetTopParent().GetHeight()<0&&(e=ZG.angleReflect(e,this.GetTopParent().GetAngle())),e}_NeedsReflectAngleForMirrorOrFlip(){const e=this.GetParent();return!!(this.GetTransformWithParentWidth()&&e.GetWidth()<0)||!!(this.GetTransformWithParentHeight()&&e.GetHeight()<0)}_NeedsReflectAngleForMirrorAndFlip(){const e=this.GetParent();return!!(this.GetTransformWithParentWidth()&&e.GetWidth()<0&&this.GetTransformWithParentHeight()&&e.GetHeight()<0)}_MaybeUpdateSinCosAngle(){const e=this._flags;if(!(262144&e))return;const t=this.GetAngle();this._sinA=Math.sin(t),this._cosA=Math.cos(t),this._flags=-262145&e}GetSinAngle(){return this._MaybeUpdateSinCosAngle(),this._sinA}GetCosAngle(){return this._MaybeUpdateSinCosAngle(),this._cosA}SetOriginX(e){this._ox=+e}OffsetOriginX(e){this._ox+=+e}GetOriginX(){return this._ox}SetOriginY(e){this._oy=+e}OffsetOriginY(e){this._oy+=+e}GetOriginY(){return this._oy}_SetColor(e){this._color.equals(e)||(this._color===ov?(this._color=ZG.New(ZG.Color,e),this._colorPremultiplied=ZG.New(ZG.Color,e),this._colorPremultiplied.premultiply()):e.equalsRgba(1,1,1,1)?(this._color=ov,this._colorPremultiplied=ov):(this._color.set(e),this._colorPremultiplied.set(e),this._colorPremultiplied.premultiply()),this._UpdateRendererStateGroup())}SetOpacity(e){if(e=ZG.clamp(+e,0,1),this.GetTransformWithParentOpacity()){if(this._GetSceneGraphInfo().GetOwnOpacity()===e)return;this._GetSceneGraphInfo().SetOwnOpacity(e),e=this.GetOpacity()}else if(this._color.a===e)return;this._SetColorWithOpacity(e)}_SetOpacityOfChildren(){if(!this.HasChildren())return;const e=this.GetChildren();for(let t=0,s=e.length;t<s;t++){const s=e[t];s._SetColorWithOpacity(s.GetOpacity())}}_SetColorWithOpacity(e){rv.copyRgb(this._color),rv.a=e,this._SetColor(rv),this._SetOpacityOfChildren()}OffsetOpacity(e){this.GetTransformWithParentOpacity()?this.SetOpacity(this._GetSceneGraphInfo().GetOwnOpacity()+e):this.SetOpacity(this.GetOpacity()+e)}GetOpacity(){return this.GetTransformWithParentOpacity()?this.GetParent().GetOpacity()*this._GetSceneGraphInfo().GetOwnOpacity():this._color.a}SetUnpremultipliedColor(e){this._color.equalsIgnoringAlpha(e)||(rv.copyRgb(e),rv.a=this.GetOpacity(),this._SetColor(rv))}SetUnpremultipliedColorRGB(e,t,s){rv.setRgb(e,t,s),this.SetUnpremultipliedColor(rv)}OffsetUnpremultipliedColorRGB(e,t,s){0===e&&0===t&&0===s||(rv.copyRgb(this._color),rv.r+=e,rv.g+=t,rv.b+=s,this.SetUnpremultipliedColor(rv))}GetUnpremultipliedColor(){return this._color}GetPremultipliedColor(){return this._colorPremultiplied}GetDestroyWithParent(){return!!(512&this._flags)}SetDestroyWithParent(e){this._SetFlag(512,e)}GetTransformWithParentX(){return!!(1024&this._flags)}SetTransformWithParentX(e){this._SetFlag(1024,e)}GetTransformWithParentY(){return!!(2048&this._flags)}GetTransformWithParentXOrY(){return!!(3072&this._flags)}SetTransformWithParentY(e){this._SetFlag(2048,e)}GetTransformWithParentWidth(){return!!(4096&this._flags)}SetTransformWithParentWidth(e){this._SetFlag(4096,e)}GetTransformWithParentHeight(){return!!(8192&this._flags)}SetTransformWithParentHeight(e){this._SetFlag(8192,e)}GetTransformWithParentAngle(){return!!(16384&this._flags)}SetTransformWithParentAngle(e){this._SetFlag(16384,e)}GetTransformWithParentZElevation(){return!!(32768&this._flags)}SetTransformWithParentZElevation(e){this._SetFlag(32768,e)}GetTransformWithParentOpacity(){return!!(4194304&this._flags)}SetTransformWithParentOpacity(e){this._SetFlag(4194304,e)}GetTransformWithParentVisibility(){return!!(8388608&this._flags)}SetTransformWithParentVisibility(e){this._SetFlag(8388608,e)}_ClearAllSceneGraphFlags(){this._flags&=-12647937}AddChild(e,t){if(e===this)return!1;if(e.HasParent())return!1;if(this._HasChildRecursive(e))return!1;if(this._HasAnyParent(e))return!1;const s=e.GetX(),n=e.GetY(),i=e.GetWidth(),r=e.GetHeight(),a=e.GetAngle(),o=e.GetZElevation(),l=e.GetOpacity();e._SetParent(this),e.SetTransformWithParentX(t.transformX),e.SetTransformWithParentY(t.transformY),e.SetTransformWithParentWidth(t.transformWidth),e.SetTransformWithParentHeight(t.transformHeight),e.SetTransformWithParentAngle(t.transformAngle),e.SetTransformWithParentZElevation(t.transformZElevation),e.SetTransformWithParentOpacity(t.transformOpacity),e.SetTransformWithParentVisibility(t.transformVisibility),e.SetDestroyWithParent(t.destroyWithParent);const c=s-this.GetX(),h=n-this.GetY(),_=-this.GetAngle(),u=Math.cos(_),d=Math.sin(_);if(t.transformX&&(t.transformAngle?e._x=c*u-h*d:e._x=c,t.transformWidth)){const t=this.GetWidth()/this._sceneGraphInfo._GetStartWidth();0!==t&&(e._x/=t)}if(t.transformY&&(t.transformAngle?e._y=c*d+h*u:e._y=h,t.transformHeight)){const t=this.GetHeight()/this._sceneGraphInfo._GetStartHeight();0!==t&&(e._y/=t)}if(t.transformWidth){const t=this.GetWidth();0===t||t===Number.EPSILON?(e._w=1,e._sceneGraphInfo.SetStartScaleX(1)):(e._w=i/this.GetWidth(),e._sceneGraphInfo.SetStartScaleX(e._w))}if(t.transformHeight){const t=this.GetHeight();0===t||t===Number.EPSILON?(e._h=1,e._sceneGraphInfo.SetStartScaleY(1)):(e._h=r/this.GetHeight(),e._sceneGraphInfo.SetStartScaleY(e._h))}return t.transformAngle&&(e._a=a-this.GetAngle()),t.transformZElevation&&(e._zElevation=o-this.GetZElevation()),t.transformOpacity&&e._sceneGraphInfo.SetOwnOpacity(l),t.transformVisibility&&e.SetVisible(this.IsVisible()),this._AddChildToSceneGraphInfo(e),this.SetBboxChanged(),this._SetOpacityOfChildren(),!0}RemoveChild(e){if(e.GetParent()!==this)return;const t=e.GetX(),s=e.GetY(),n=e.GetWidth(),i=e.GetHeight(),r=e.GetAngle(),a=e.GetZElevation(),o=e.GetOpacity();e._SetParent(null),e._ClearAllSceneGraphFlags(),e.SetXY(t,s),e.SetSize(n,i),e.SetAngle(r),e.SetZElevation(a),e.SetOpacity(o),this._RemoveChildFromSceneGraphInfo(e),this.SetBboxChanged()}GetTmpHierarchyPosition(){return this._tmpHierarchyPosition}_ResetAllSceneGraphState(){this._BuildTmpSceneGraphData();const e=[...this.children()];for(const t of e)this.RemoveChild(t);const t=this.GetParent();t&&t.RemoveChild(this),this._ClearAllSceneGraphFlags()}_BuildTmpSceneGraphData(){if(this._SetTmpHierarchyPosition(),!this._tmpSceneGraphChildren){const e=[...this.children()];e.length&&(this._tmpSceneGraphChildren=[],this._tmpSceneGraphChildrenIndexes=new WeakMap);let t=0;for(const s of e){const e=s.GetInstance();this._tmpSceneGraphChildren.push(e),this._tmpSceneGraphChildrenIndexes.set(e,t),t++}}const e=this.GetParent();e&&e._BuildTmpSceneGraphData()}_SetTmpHierarchyPosition(){if(-1!==this._tmpHierarchyPosition)return;const e=[...this.parents()];this._tmpHierarchyPosition=e.length;for(const t of e)t._SetTmpHierarchyPosition();const t=[...this.children()];for(const e of t)e._SetTmpHierarchyPosition()}_ReleaseTmpSceneGraphInfo(){this._tmpSceneGraphChildren&&(this._tmpSceneGraphChildren.length=0),this._tmpSceneGraphChildren=null,this._tmpSceneGraphChildrenIndexes=null;const e=this.GetParent();e&&e._ReleaseTmpSceneGraphInfo(),this._tmpHierarchyPosition=-1}HasParent(){return null!==this.GetParent()}GetParent(){const e=this._sceneGraphInfo;return null!==e?e.GetParent():null}GetTopParent(){let e=this;for(;e.HasParent();)e=e.GetParent();return e}*parents(){let e=this.GetParent();for(;e;)yield e,e=e.GetParent()}HasChild(e){return this.GetChildren().includes(e)}HasChildren(){const e=this._sceneGraphInfo;return null!==e&&e.HasChildren()}GetChildren(){const e=this._sceneGraphInfo;return null!==e?e.GetChildren():_v}children(){return this.GetChildren()}*allChildren(){for(const e of this.children())yield e,yield*e.allChildren()}GetChildCount(){return this.GetChildren().length}GetAllChildCount(){return[...this.allChildren()].length}GetChildAt(e){const t=this.GetChildren();return(e=Math.floor(+e))<0||e>=t.length?null:t[e]}GetChildIndex(e){if(!e)return NaN;const t=this.GetChildren();if(!t)return NaN;for(let s=0;s<t.length;s++)if(e===t[s])return s;return NaN}_CreateSceneGraphInfo(e){this._sceneGraphInfo||(this._sceneGraphInfo=ZG.New(ZG.SceneGraphInfo,this)),e&&this._sceneGraphInfo.SetParent(e)}_GetSceneGraphInfo(){return this._sceneGraphInfo}_ReleaseSceneGraphInfo(){this._sceneGraphInfo&&(this._sceneGraphInfo.Release(),this._sceneGraphInfo=null)}_SetParent(e){e?(e._CreateSceneGraphInfo(null),this._CreateSceneGraphInfo(e)):(this._sceneGraphInfo&&this._sceneGraphInfo.SetParent(null),this.HasChildren()||this._ReleaseSceneGraphInfo())}_HasAnyParent(e){if(!this.HasParent())return!1;const t=this.GetParent();return t===e||t._HasAnyParent(e)}_HasChildRecursive(e){if(this.HasChild(e))return!0;for(const t of this.GetChildren())if(t._HasChildRecursive(e))return!0;return!1}_AddChildToSceneGraphInfo(e){this._sceneGraphInfo.GetChildren().push(e)}_RemoveChildFromSceneGraphInfo(e){const t=this._sceneGraphInfo.GetChildren(),s=t.indexOf(e);-1!==s&&t.splice(s,1),0!==t.length||this.HasParent()||this._ReleaseSceneGraphInfo(),e.HasChildren()||e._ReleaseSceneGraphInfo()}GetSceneGraphChildrenExportData(){const e=Wv.get(this);return e?e.childrenData:null}GetSceneGraphZIndexExportData(){const e=Wv.get(this);return e?e.zIndexData:NaN}GetSceneGraphZIndex(){const e=Vv.get(this);return ZG.IsFiniteNumber(e)?e:NaN}SetSceneGraphZIndex(e){Vv.set(this,e)}SetUsePointsShaderProgram(){this._SetFlag(524288,!0),this._UpdateRendererStateGroup()}_UpdateRendererStateGroup(){if(!uv)return;const e=this._runtime.GetRenderer();let t;this._stateGroup&&e.ReleaseStateGroup(this._stateGroup),t=524288&this._flags?e.GetPointsRenderingProgram()||"<point>":e.GetTextureFillShaderProgram()||"<default>",this._stateGroup=e.AcquireStateGroup(t,this.GetBlendMode(),this._colorPremultiplied,this.GetZElevation())}GetRendererStateGroup(){return this._stateGroup}HasDefaultColor(){return this._color===ov}SetBlendMode(e){if((e|=0)<0||e>31)throw new RangeError("invalid blend mode");this.GetBlendMode()!==e&&(this._flags=-2080374785&this._flags|e<<26,this._UpdateRendererStateGroup())}GetBlendMode(){return(2080374784&this._flags)>>26}_SetLayer(e,t){const s=t&&this._layer!==e;s&&this._RemoveFromRenderCells(),this._objectClass._OnWorldInstanceLayerChanged(this,this._layer,e),this._layer=e,s&&this._UpdateRenderCell(),0!==this.GetZElevation()&&this._layer._SetAnyInstanceZElevated()}GetLayer(){return this._layer}GetLayout(){return this.GetLayer().GetLayout()}_SetZIndex(e){this._zIndex=0|e}GetZIndex(){return this._layer._UpdateZIndices(),this._zIndex}_SetHTMLZIndex(e){this._htmlZIndex=0|e}GetHTMLZIndex(){return this._layer._UpdateHTMLZIndices(),this._htmlZIndex}_GetLastCachedZIndex(){return this._zIndex}_SetFlag(e,t){t?this._flags|=e:this._flags&=~e}IsVisible(){return!!(1&this._flags)}SetVisible(e){if(this._SetFlag(1,e),this.HasChildren())for(const t of this.GetChildren())t.GetTransformWithParentVisibility()&&t.SetVisible(e)}IsCollisionEnabled(){return!!(8&this._flags)}SetCollisionEnabled(e){e=!!e,this.IsCollisionEnabled()!==e&&(this._SetFlag(8,e),e?this.SetBboxChanged():this._RemoveFromCollisionCells())}SetSolidCollisionFilter(e,t){if(this._SetFlag(32,e),this._solidFilterTags&&this._solidFilterTags.clear(),t.trim()){this._solidFilterTags||(this._solidFilterTags=new Set);for(const e of t.split(" "))e&&this._solidFilterTags.add(e.toLowerCase())}else this._solidFilterTags=null}IsSolidCollisionAllowed(e){const t=!!(32&this._flags),s=this._solidFilterTags;if(!e||!s)return!t;for(const n of s)if(e.has(n))return t;return!t}SetBboxChanged(){if(this._flags|=65554,this._objectClass._SetAnyCollisionCellChanged(!0),this._runtime.UpdateRender(),this._layer.UsesRenderCells()&&(this.CalculateBbox(this._boundingBox,this._boundingQuad,!0),this._flags&=-3,this._UpdateRenderCell()),4&this._flags&&this._inst.Dispatcher().dispatchEvent(iv),null!==this._sceneGraphInfo){const e=this._sceneGraphInfo.GetChildren();for(let t=0,s=e.length;t<s;++t)e[t].SetBboxChanged()}}CalculateBbox(e,t,s){const n=this.GetX(),i=this.GetY(),r=this.GetWidth(),a=this.GetHeight(),o=this.GetAngle();e.setWH(n-this._ox*r,i-this._oy*a,r,a),s&&this.HasMesh()&&this._ExpandBboxForMesh(e),0===o?t.setFromRect(e):(e.offset(-n,-i),t.setFromRotatedRectPrecalc(e,this.GetSinAngle(),this.GetCosAngle()),t.offset(n,i),t.getBoundingBox(e)),e.normalize()}_UpdateBbox(){const e=this._flags;2&e&&(this.CalculateBbox(this._boundingBox,this._boundingQuad,!0),this._flags=-3&e)}GetBoundingBox(){return this._UpdateBbox(),this._boundingBox}GetBoundingQuad(){return this._UpdateBbox(),this._boundingQuad}PixelRoundQuad(e){const t=this.GetX(),s=this.GetY(),n=Math.round(t)-t,i=Math.round(s)-s;return 0===n&&0===i?e:(nv.copy(e),nv.offset(n,i),nv)}OverwriteBoundingBox(e){this._boundingBox.copy(e),this._boundingQuad.setFromRect(this._boundingBox),this._flags&=-3,this._UpdateCollisionCell(),this._UpdateRenderCell()}SetBboxChangeEventEnabled(e){this._SetFlag(4,e)}IsBboxChangeEventEnabled(){return!!(4&this._flags)}IsInViewport(e,t,s){return t&&0!==this.GetDepth()?this.IsInViewport3D(this.GetLayer()._GetViewFrustum()):0===this.GetZElevation()||s?e.intersectsRect(this.GetBoundingBox()):this._IsInViewport_ZElevated()}_IsInViewport_ZElevated(){const e=this.GetLayer(),t=this.GetTotalZElevation();return!(t>=e.Get2DCameraZ())&&(e.GetViewportForZ(t,sv),sv.intersectsRect(this.GetBoundingBox()))}IsInViewport3D(e){const t=this.GetBoundingBox(),s=t.getLeft(),n=t.getRight(),i=t.getTop(),r=t.getBottom(),a=this.GetTotalZElevation(),o=a+this.GetDepth();return e.ContainsAABB(s,i,a,n,r,o)}IsInViewport2(){const e=this.GetLayer();if(e.Has3DCamera())return this.IsInViewport3D(e._GetViewFrustum());{const t=e.GetLayout();return this.IsInViewport(e.GetViewport(),t.HasVanishingPointOutsideViewport(),t.IsOrthographicProjection())}}_SetDrawBackFaceOnly(e){this._SetFlag(1048576,e)}_SetDrawNonBackFacesOnly(e){this._SetFlag(2097152,e)}IsDrawBackFaceOnly(){return!!(1048576&this._flags)}IsDrawNonBackFacesOnly(){return!!(2097152&this._flags)}SetSourceCollisionPoly(e){this._sourceCollisionPoly=e,this._DiscardTransformedCollisionPoly(),this.HasMesh()&&(this._meshInfo.meshPoly=null)}GetSourceCollisionPoly(){return this._sourceCollisionPoly}HasOwnCollisionPoly(){return null!==this._sourceCollisionPoly||this.HasMesh()}GetTransformedCollisionPoly(){return this._GetCustomTransformedCollisionPolyPrecalc(this.GetWidth(),this.GetHeight(),this.GetAngle(),this.GetSinAngle(),this.GetCosAngle())}GetCustomTransformedCollisionPoly(e,t,s){let n=0,i=1;return 0!==s&&(n=Math.sin(s),i=Math.cos(s)),this._GetCustomTransformedCollisionPolyPrecalc(e,t,s,n,i)}_GetCustomTransformedCollisionPolyPrecalc(e,t,s,n,i){let r=this._transformedPolyInfo;null===r&&(r={poly:ZG.New(ZG.CollisionPoly),width:NaN,height:NaN,angle:NaN},this._transformedPolyInfo=r);const a=r.poly;if(r.width===e&&r.height===t&&r.angle===s)return a;const o=this._sourceCollisionPoly;if(this.HasMesh()){const s=this.GetOriginX(),r=this.GetOriginY(),l=this.GetSourceMesh();let c=this._meshInfo.meshPoly;c||(o?(av.copy(o),av.offset(s,r)):av.setDefaultPoints(),c=l.InsertPolyMeshVertices(av),this._meshInfo.meshPoly=c),l.TransformCollisionPoly(c,a),a.offset(-s,-r),a.transformPrecalc(e,t,n,i)}else o?(a.copy(o),a.transformPrecalc(e,t,n,i)):a.setFromQuad(this.GetBoundingQuad(),-this.GetX(),-this.GetY());return r.width=e,r.height=t,r.angle=s,a}_DiscardTransformedCollisionPoly(){this.SetPhysicsBodyChanged(!0);const e=this._transformedPolyInfo;null!==e&&(e.width=NaN)}CreateMesh(e,t){if(e=Math.floor(e),t=Math.floor(t),!this.GetInstance().GetPlugin().SupportsMesh())throw new Error("object does not support mesh");this.ReleaseMesh(),this._meshInfo={sourceMesh:ZG.New(ZG.Gfx.Mesh,e,t),transformedMesh:ZG.New(ZG.Gfx.Mesh,e,t),meshPoly:null}}HasMesh(){return null!==this._meshInfo}GetSourceMesh(){if(!this.HasMesh())throw new Error("no mesh");return this._meshInfo.sourceMesh}GetTransformedMesh(){if(!this.HasMesh())throw new Error("no mesh");return this._meshInfo.transformedMesh}SetMeshChanged(e){this._SetFlag(65536,e)}IsMeshChanged(){return!!(65536&this._flags)}SetPhysicsBodyChanged(e){this._SetFlag(131072,e)}IsPhysicsBodyChanged(){return!!(131072&this._flags)}_ExpandBboxForMesh(e){const t=this._meshInfo.sourceMesh,s=Math.min(t.GetMinX(),0),n=Math.min(t.GetMinY(),0),i=Math.max(t.GetMaxX(),1),r=Math.max(t.GetMaxY(),1),a=e.width(),o=e.height();e.offsetLeft(s*a),e.offsetTop(n*o),e.offsetRight((i-1)*a),e.offsetBottom((r-1)*o),this._depth=t.GetMaxZ()}ReleaseMesh(){this._meshInfo&&(this._meshInfo.sourceMesh.Release(),this._meshInfo.transformedMesh.Release(),this._meshInfo=null,this._DiscardTransformedCollisionPoly())}SetMeshPoint(e,t,s){e=Math.floor(e),t=Math.floor(t);const n=s.mode||"absolute";if(!hv.has(n))throw new Error("invalid mode");const i="relative"===n;let r=s.x,a=s.y;const o=s.zElevation;let l="number"==typeof s.u?s.u:i?0:-1,c="number"==typeof s.v?s.v:i?0:-1;if(!this.HasMesh())return!1;const h=this.GetSourceMesh(),_=h.GetMeshPointAt(e,t);if(null===_)return!1;let u=!1;return"number"==typeof o&&_.GetZElevation()!==o&&(_.SetZElevation(o),u=!0),i&&(r+=e/(h.GetHSize()-1),a+=t/(h.GetVSize()-1)),-1!==l||i?(i&&(l+=e/(h.GetHSize()-1)),l=ZG.clamp(l,0,1)):l=_.GetU(),-1!==c||i?(i&&(c+=t/(h.GetVSize()-1)),c=ZG.clamp(c,0,1)):c=_.GetV(),_.GetX()===r&&_.GetY()===a&&_.GetU()===l&&_.GetV()===c?u:(_.SetX(r),_.SetY(a),_.SetU(l),_.SetV(c),this._DiscardTransformedCollisionPoly(),!0)}HasTilemap(){return this._inst.HasTilemap()}ContainsPoint(e,t){return!!this.GetBoundingBox().containsPoint(e,t)&&!!this.GetBoundingQuad().containsPoint(e,t)&&(this.HasTilemap()?this._inst.GetSdkInstance().TestPointOverlapTile(e,t):!this.HasOwnCollisionPoly()||this.GetTransformedCollisionPoly().containsPoint(e-this.GetX(),t-this.GetY()))}_IsCollisionCellChanged(){return!!(16&this._flags)}_UpdateCollisionCell(){if(!this._IsCollisionCellChanged()||!this.IsCollisionEnabled()||256&this._flags)return;const e=this.GetBoundingBox(),t=this._objectClass._GetCollisionCellGrid(),s=this._collisionCells;if(sv.set(t.XToCell(e.getLeft()),t.YToCell(e.getTop()),t.XToCell(e.getRight()),t.YToCell(e.getBottom())),s.equals(sv))return;const n=this._inst;s===cv?(t.Update(n,null,sv),this._collisionCells=ZG.New(ZG.Rect,sv)):(t.Update(n,s,sv),s.copy(sv)),this._flags&=-17}_SetCollisionCellChanged(){this._flags|=16}_RemoveFromCollisionCells(){const e=this._collisionCells;e!==cv&&(this._objectClass._GetCollisionCellGrid().Update(this._inst,e,null),this._collisionCells=cv)}_UpdateRenderCell(){const e=this.GetLayer();if(!e.UsesRenderCells()||256&this._flags)return;const t=e.GetRenderGrid(),s=this.GetBoundingBox(),n=this._renderCells;if(sv.set(t.XToCell(s.getLeft()),t.YToCell(s.getTop()),t.XToCell(s.getRight()),t.YToCell(s.getBottom())),n.equals(sv))return;const i=this._inst;n===lv?(t.Update(i,null,sv),this._renderCells=ZG.New(ZG.Rect,sv)):(t.Update(i,n,sv),n.copy(sv)),e.SetRenderListStale()}_RemoveFromRenderCells(){const e=this._renderCells;e!==lv&&(this.GetLayer().GetRenderGrid().Update(this._inst,e,null),this._renderCells=lv)}GetRenderCellRange(){return this._renderCells}ZOrderMoveToTop(){const e=this._inst,t=this._layer,s=t._GetInstances();s.length&&s.at(-1)===e||(t._RemoveInstance(e,!1),t._AddInstance(e,!1),this._runtime.UpdateRender())}ZOrderMoveToBottom(){const e=this._inst,t=this._layer,s=t._GetInstances();s.length&&s[0]===e||(t._RemoveInstance(e,!1),t._PrependInstance(e,!1),this._runtime.UpdateRender())}ZOrderMoveToLayer(e){const t=this._inst,s=this._layer;if(s.GetLayout()!==e.GetLayout())throw new Error("layer from different layout");e!==s&&(s._RemoveInstance(t,!0),this._SetLayer(e),e._AddInstance(t,!0),this._runtime.UpdateRender())}ZOrderMoveAdjacentToInstance(e,t){const s=this._inst;let n=!1;const i=this._layer;if(e.GetUID()===s.GetUID())return;const r=e.GetWorldInfo();if(!r)throw new Error("expected world instance");const a=r.GetLayer();i.GetIndex()!==a.GetIndex()&&(i._RemoveInstance(s,!0),this._SetLayer(a),a._AddInstance(s,!0),n=!0);const o=a.MoveInstanceAdjacent(s,e,!!t);(n||o)&&this._runtime.UpdateRender()}GetInstanceEffectList(){return this._instanceEffectList}_SetHasAnyActiveEffect(e){this._SetFlag(64,e)}HasAnyActiveEffect(){return!!(64&this._flags)}_SaveToJson(e,t=null){const s={x:this.GetX(),y:this.GetY(),w:this.GetWidth(),h:this.GetHeight(),l:this.GetLayer().GetSID(),zi:this.GetZIndex()};0!==this.GetZElevation()&&(s.ze=this.GetZElevation()),0!==this.GetAngle()&&(s.a=this._GetAngleNoReflect()),this.HasDefaultColor()||(s.c=this._color.toJSON()),.5!==this.GetOriginX()&&(s.oX=this.GetOriginX()),.5!==this.GetOriginY()&&(s.oY=this.GetOriginY()),0!==this.GetBlendMode()&&(s.bm=this.GetBlendMode()),this.IsVisible()||(s.v=this.IsVisible()),this.IsCollisionEnabled()||(s.ce=this.IsCollisionEnabled()),this.IsBboxChangeEventEnabled()&&(s.be=this.IsBboxChangeEventEnabled()),this._instanceEffectList&&(s.fx=this._instanceEffectList._SaveToJson());const n=!!(32&this._flags);return n&&(s.sfi=n),this._solidFilterTags&&(s.sft=[...this._solidFilterTags].join(" ")),this._sceneGraphInfo&&"visual-state"!==e&&(s.sgi=this._sceneGraphInfo._SaveToJson(e,t),Wv.has(this)&&(s.sgcd=Wv.get(this).childrenData,s.sgzid=Wv.get(this).zIndexData)),this.HasMesh()&&(s.mesh=this.GetSourceMesh().SaveToJson()),s}_SaveSceneGraphPropertiesToJson(){return{x:this._x,y:this._y,z:this._zElevation,w:this._w,h:this._h,a:this._a,sgi:this._GetSceneGraphInfo()?this._GetSceneGraphInfo()._SaveToJsonProperties():null}}_LoadSceneGraphPropertiesFromJson(e){e&&(this._x=e.x,this._y=e.y,this._zElevation=e.z,this._w=e.w,this._h=e.h,this._a=e.a,e.sgi&&this._GetSceneGraphInfo()&&this._GetSceneGraphInfo()._LoadFromJson(e.sgi),this._MarkSinCosAngleChanged(),this.SetBboxChanged())}_SetupSceneGraphConnectionsOnChangeOfLayout(){this._ReleaseTmpSceneGraphInfo(),this._ResetAllSceneGraphState(),this._CreateSceneGraphInfo(null),this._sceneGraphInfo&&this._sceneGraphInfo._SetTmpSceneGraphChildren(this._tmpSceneGraphChildren,this._tmpSceneGraphChildrenIndexes)}_OnBeforeLoad(e){"visual-state"!==e&&this._ResetAllSceneGraphState()}_OnAfterLoad(e,t="full",s=null){if(e.hasOwnProperty("sgi")&&"visual-state"!==t){if(256&this._flags)return;this._sceneGraphInfo._OnAfterLoad(e.sgi,s)}}_OnAfterLoad2(e,t="full",s=null){if("visual-state"!==t)if(256&this._flags)this._ReleaseTmpSceneGraphInfo();else{if(e.hasOwnProperty("sgi"))this._sceneGraphInfo._SetTmpSceneGraphChildren(null,null,e.sgi,s);else if(s?.setFromJson&&this._tmpSceneGraphChildren)for(const e of this._tmpSceneGraphChildren)e.IsDestroyed()||this._runtime.DestroyInstance(e);this._ReleaseTmpSceneGraphInfo(),this.SetBboxChanged()}}_LoadFromJson(e,t,s=null){if(uv=!1,this.SetX(e.x),this.SetY(e.y),this.SetWidth(e.w),this.SetHeight(e.h),this._SetZIndex(e.zi),this.SetZElevation(e.hasOwnProperty("ze")?e.ze:0),this.SetAngle(e.hasOwnProperty("a")?e.a:0),e.hasOwnProperty("c")?rv.setFromJSON(e.c):e.hasOwnProperty("o")?(rv.copyRgb(this._color),rv.a=e.o):rv.setRgba(1,1,1,1),this._SetColor(rv),this.SetOriginX(e.hasOwnProperty("oX")?e.oX:.5),this.SetOriginY(e.hasOwnProperty("oY")?e.oY:.5),this.SetBlendMode(e.hasOwnProperty("bm")?e.bm:0),this.SetVisible(!e.hasOwnProperty("v")||e.v),this.SetCollisionEnabled(!e.hasOwnProperty("ce")||e.ce),this.SetBboxChangeEventEnabled(!!e.hasOwnProperty("be")&&e.be),this.SetSolidCollisionFilter(!!e.hasOwnProperty("sfi")&&e.sfi,e.hasOwnProperty("sft")?e.sft:""),this._instanceEffectList&&e.hasOwnProperty("fx")&&this._instanceEffectList._LoadFromJson(e.fx),e.hasOwnProperty("sgi")&&"visual-state"!==t){this._CreateSceneGraphInfo(null);const t=this._sceneGraphInfo,s=e.sgi;t._LoadFromJson(s),t._SetTmpSceneGraphChildren(this._tmpSceneGraphChildren,this._tmpSceneGraphChildrenIndexes),this._SetSceneGraphExportData(e.sgcd,e.sgzid)}if(e.hasOwnProperty("mesh")){const t=e.mesh;this.CreateMesh(t.cols,t.rows),this.GetSourceMesh().LoadFromJson(t)}else this.ReleaseMesh();this.SetBboxChanged(),uv=!0,this._UpdateRendererStateGroup(),"visual-state"!==t&&this._runtime.AddInstanceNeedingAfterLoad(this.GetInstance(),e)}_SetSceneGraphExportData(e,t){e&&ZG.IsFiniteNumber(t)&&Wv.set(this,{childrenData:e,zIndexData:t})}}}{const jv=self.C3;jv.BehaviorType=class extends jv.DefendedBase{constructor(e,t){super();const s=e.GetRuntime(),n=s.GetObjectReference(t[1]);s.GetAddonManager()._DelayCreateBehavior(n),this._runtime=s,this._objectClass=e,this._behavior=jv.AddonManager.GetBehaviorByConstructorFunction(n),this._sdkType=null,this._iBehaviorType=null,this._instSdkCtor=n.Instance,this._sid=t[2],this._name=t[0],this._jsPropName=this._runtime.GetJsPropName(t[3]);const i=this._behavior.GetSdkVersion();if(i<2&&(this._sdkType=jv.New(n.Type,this),!(this._sdkType instanceof jv.SDKBehaviorTypeBase)))throw new Error("v1 sdk type must derive from SDKBehaviorBase");if(jv.AddonManager._PushInitObject(this,i),i>=2){const e=n.Type??globalThis.ISDKBehaviorTypeBase;if(this._iBehaviorType=new e,!(this._iBehaviorType instanceof globalThis.ISDKBehaviorTypeBase))throw new Error("script interface class must derive from ISDKBehaviorTypeBase")}else this._iBehaviorType=new globalThis.IBehaviorType;jv.AddonManager._PopInitObject(i),this.OnCreate()}static Create(e,t){return jv.New(jv.BehaviorType,e,t)}Release(){this._runtime=null,this._behavior=null,this._sdkType&&(this._sdkType.Release(),this._sdkType=null),this._instSdkCtor=null}GetSdkType(){return this._sdkType}OnCreate(){this._sdkType?this._sdkType.OnCreate():this._iBehaviorType&&this._iBehaviorType._onCreate()}GetRuntime(){return this._runtime}GetObjectClass(){return this._objectClass}GetBehavior(){return this._behavior}GetInstanceSdkCtor(){return this._instSdkCtor}GetName(){return this._name}GetSID(){return this._sid}GetIBehaviorType(){return this._iBehaviorType}GetJsPropName(){return this._jsPropName}}}{const Uv=self.C3,Hv=self.IBehaviorInstance;Uv.BehaviorInstance=class extends Uv.DefendedBase{constructor(e){super(),this._runtime=e.runtime,this._behaviorType=e.behaviorType,this._behavior=this._behaviorType.GetBehavior(),this._inst=e.instance,this._index=e.index,this._sdkInst=null,this._iScriptInterface=null,this._behavior._AddInstance(this._inst)}Release(){this._iScriptInterface&&(this._iScriptInterface._release(),this._iScriptInterface=null),this._behavior._RemoveInstance(this._inst),this._sdkInst&&(this._sdkInst.Release(),this._sdkInst=null),this._runtime=null,this._behaviorType=null,this._behavior=null,this._inst=null}_CreateSdkInstance(e){if(this._sdkInst)throw new Error("already got sdk instance");if(this.GetBehavior().GetSdkVersion()<2){if(this._sdkInst=Uv.New(this._behaviorType.GetInstanceSdkCtor(),this,e),!(this._sdkInst instanceof Uv.SDKBehaviorInstanceBase))throw new Error("v1 sdk type must derive from SDKBehaviorInstanceBase")}else{const t=this.GetBehavior().GetScriptInterfaceClass();this._InitScriptInterface(t.Instance,e)}}GetSdkInstance(){return this._sdkInst??this._iScriptInterface}GetObjectInstance(){return this._inst}GetRuntime(){return this._runtime}GetBehaviorType(){return this._behaviorType}GetBehavior(){return this._behavior}_GetIndex(){return this._index}PostCreate(){this._sdkInst?this._sdkInst.PostCreate():this._iScriptInterface._postCreate()}OnSpriteFrameChanged(e,t){this._sdkInst&&this._sdkInst.OnSpriteFrameChanged(e,t)}_GetDebuggerProperties(){return this._sdkInst?this._sdkInst.GetDebuggerProperties():this._iScriptInterface._getDebuggerProperties()}SaveToJson(e="full"){return this._sdkInst?this._sdkInst.SaveToJson(e):this._iScriptInterface._saveToJson(e)}LoadFromJson(e,t="full"){if(this._sdkInst)return this._sdkInst.LoadFromJson(e,t);this._iScriptInterface._loadFromJson(e,t)}static SortByTickSequence(e,t,s){const n=globalThis.ISDKBehaviorInstanceBase;let i,r;i=t instanceof n?e._UnwrapScriptInterface(t):t.GetBehaviorInstance(),r=s instanceof n?e._UnwrapScriptInterface(s):s.GetBehaviorInstance();const a=i.GetObjectInstance(),o=r.GetObjectInstance(),l=a.GetObjectClass().GetIndex(),c=o.GetObjectClass().GetIndex();if(l!==c)return l-c;const h=a.GetPUID(),_=o.GetPUID();return h!==_?h-_:i._GetIndex()-r._GetIndex()}_InitScriptInterface(e,t){const s=Hv,n=e??this._sdkInst.GetScriptInterfaceClass(),i=n||s,r=this.GetBehavior().GetSdkVersion();if(Uv.AddonManager._PushInitObject(this,r),Uv.AddonManager._PushInitProperties(t),this._iScriptInterface=new i,Uv.AddonManager._PopInitProperties(),Uv.AddonManager._PopInitObject(r),n&&!(this._iScriptInterface instanceof s))throw new TypeError(`script interface class '${n.name}' does not extend the right base class '${s.name}'`);return this._iScriptInterface}GetScriptInterface(){return this._iScriptInterface||this._InitScriptInterface()}HasScriptInterface(){return!!this._iScriptInterface}}}{const zv=self.C3;zv.EffectList=class extends zv.DefendedBase{constructor(e,t){super(),this._owner=e,this._allEffectTypes=[],this._activeEffectTypes=[],this._effectTypesByName=new Map,this._effectParams=[],this._effectParamBuffers=[],this._allInstanceEffectLists=new Set,this._preservesOpaqueness=!0;for(const e of t){const t=zv.New(zv.EffectType,this,e,this._allEffectTypes.length);this._allEffectTypes.push(t),this._effectTypesByName.set(t.GetName().toLowerCase(),t),e.length>=3&&this._effectParams.push(this._LoadSingleEffectParameters(t,e[2]))}this.GetRuntime()._AddEffectList(this)}Release(){this.GetRuntime()._RemoveEffectList(this);for(const e of this._effectParamBuffers)e.Release();zv.clearArray(this._effectParamBuffers),zv.clearArray(this._allEffectTypes),zv.clearArray(this._activeEffectTypes),this._effectTypesByName.clear(),zv.clearArray(this._effectParams),this._owner=null}_AddInstanceEffectList(e){this._allInstanceEffectLists.add(e)}_RemoveInstanceEffectList(e){this._allInstanceEffectLists.delete(e)}_InitRenderer(e){e.IsWebGPU()&&(this._effectParamBuffers=this._allEffectTypes.map((e=>{const t=e.GetShaderProgram();return t.GetCustomParametersByteSize()>0?zv.New(zv.Gfx.WebGPUEffectCustomParamsBuffer,t):null})),this._UpdateAllEffectParamBuffers());for(const t of this._allInstanceEffectLists)t._InitRenderer(e)}PrependEffectTypes(e){if(e.length){this._allEffectTypes=e.concat(this._allEffectTypes);for(const t of e)this._effectTypesByName.set(t.GetName().toLowerCase(),t);for(let e=0,t=this._allEffectTypes.length;e<t;++e)this._allEffectTypes[e]._SetIndex(e)}}_LoadSingleEffectParameters(e,t){e.SetActive(t[0]);const s=t.slice(1);for(let e=0,t=s.length;e<t;++e){const t=s[e];if(Array.isArray(t)){const n=zv.New(zv.Color);n.setFromJSON(t),s[e]=n}}return s}GetOwner(){return this._owner}GetRuntime(){return this._owner.GetRuntime()}UpdateActiveEffects(){zv.clearArray(this._activeEffectTypes);let e=!0;for(const t of this._allEffectTypes)t.IsActive()&&(this._activeEffectTypes.push(t),t.GetShaderProgram().PreservesOpaqueness()||(e=!1));this._preservesOpaqueness=e}GetAllEffectTypes(){return this._allEffectTypes}HasAnyEffectType(){return this._allEffectTypes.length>0}GetEffectTypeByName(e){return this._effectTypesByName.get(e.toLowerCase())||null}GetEffectTypeByIndex(e){if((e=Math.floor(+e))<0||e>=this._allEffectTypes.length)throw new RangeError("invalid effect type index");return this._allEffectTypes[e]}IsEffectIndexActive(e){return this.GetEffectTypeByIndex(e).IsActive()}SetEffectIndexActive(e,t){this.GetEffectTypeByIndex(e).SetActive(t)}GetActiveEffectTypes(){return this._activeEffectTypes}HasAnyActiveEffect(){return this._activeEffectTypes.length>0}PreservesOpaqueness(){return this._preservesOpaqueness}GetEffectParametersForIndex(e){return this._effectParams[e]}_GetEffectChainShaderParametersForIndex(e){return e<this._effectParamBuffers.length?this._effectParamBuffers[e]:this._effectParams[e]}GetEffectParameter(e,t){if(e<0||e>=this._effectParams.length)return null;const s=this._effectParams[e];return t<0||t>=s.length?null:s[t]}SetEffectParameter(e,t,s){if(e<0||e>=this._effectParams.length)return!1;const n=this._effectParams[e];if(t<0||t>=n.length)return!1;const i=n[t];if(i instanceof zv.Color){if(i.equalsIgnoringAlpha(s))return!1;i.copyRgb(s)}else{if(i===s)return!1;n[t]=s}return e<this._effectParamBuffers.length&&this._effectParamBuffers[e].SetParameterValue(t,s),!0}_UpdateAllEffectParamBuffers(){const e=this._effectParams,t=this._effectParamBuffers;for(let s=0,n=Math.min(e.length,t.length);s<n;++s){const n=t[s],i=e[s];for(let e=0,t=i.length;e<t;++e)n.SetParameterValue(e,i[e])}}static SaveFxParamToJson(e){return e&&e instanceof zv.Color?{t:"color",v:e.toJSON()}:e}static LoadFxParamFromJson(e){if(null===e)return NaN;if("object"==typeof e){if("color"===e.t){const t=zv.New(zv.Color);return t.setFromJSON(e.v),t}throw new Error("invalid effect parameter type")}return e}static SaveFxParamsToJson(e){return e.map(zv.EffectList.SaveFxParamToJson)}static LoadFxParamsFromJson(e){return e.map(zv.EffectList.LoadFxParamFromJson)}SaveToJson(){return this._allEffectTypes.map((e=>({name:e.GetName(),active:e.IsActive(),params:zv.EffectList.SaveFxParamsToJson(this._effectParams[e.GetIndex()])})))}LoadFromJson(e){for(const t of e){const e=this.GetEffectTypeByName(t.name);e&&(e.SetActive(t.active),this._effectParams[e.GetIndex()]=zv.EffectList.LoadFxParamsFromJson(t.params))}this.UpdateActiveEffects(),this._UpdateAllEffectParamBuffers()}}}{const Xv=self.C3;Xv.EffectType=class extends Xv.DefendedBase{constructor(e,t,s){super(),this._effectList=e,this._id=t[0],this._name=t[1],this._index=s,this._shaderProgram=null,this._isActive=!0}Release(){this._effectList=null,this._shaderProgram=null}Clone(e){const t=Xv.New(Xv.EffectType,e,[this._id,this._name],-1);return t._shaderProgram=this._shaderProgram,t._isActive=this._isActive,t}_InitRenderer(e){const t=e.GetShaderProgramByName(this._id);if(!t)throw new Error("failed to find shader program '"+this._id+"'");this._shaderProgram=t}GetEffectList(){return this._effectList}GetName(){return this._name}_SetIndex(e){this._index=e}GetIndex(){return this._index}GetOwner(){return this._effectList.GetOwner()}GetRuntime(){return this._effectList.GetRuntime()}SetActive(e){this._isActive=!!e}IsActive(){return this._isActive}GetShaderProgram(){return this._shaderProgram}GetDefaultParameterValues(){const e=[];for(let t=0,s=this._shaderProgram.GetParameterCount();t<s;++t){const s=this._shaderProgram.GetParameterType(t);if("float"===s||"percent"===s)e.push(0);else{if("color"!==s)throw new TypeError("unknown effect parameter type");e.push(Xv.New(Xv.Color,1,1,1,1))}}return e}}}{const Yv=self.C3;Yv.InstanceEffectList=class extends Yv.DefendedBase{constructor(e,t){super(),this._inst=e,this._wi=t,this._effectList=e.GetObjectClass().GetEffectList(),this._needsRebuildSteps=!0,this._wasDefaultColor=!0,this._was3D=!1,this._wasRotatedOrNegativeSize=!1,this._wasTexRotated=!1,this._wasMustPreDraw=!1,this._effectChain=Yv.New(Yv.Gfx.EffectChain,e.GetRuntime().GetCanvasManager().GetEffectChainManager(),{drawContent:(e,t)=>{const s=t.GetContentObject(),n=s.GetWorldInfo();e.SetColor(n.GetPremultipliedColor()),e.SetCurrentZ(n.GetTotalZElevation()),s.Draw(e),e.SetCurrentZ(0)},getSourceTextureInfo:e=>{const t=e.GetCurrentTexRect(),[s,n]=e.GetCurrentSurfaceSize();return{srcTexRect:t,srcWidth:s,srcHeight:n}},getShaderParameters:e=>this._GetEffectChainShaderParametersForIndex(e)}),this._activeEffectFlags=[],this._activeEffectTypes=[],this._preservesOpaqueness=!0,this._effectParams=[],this._effectParamBuffers=[],this._InitRenderer(e.GetRuntime().GetRenderer());for(let e=0,t=this._effectList.GetAllEffectTypes().length;e<t;++e)this._activeEffectFlags.push(!0);this.UpdateActiveEffects(),this._effectList._AddInstanceEffectList(this)}Release(){this._effectList._RemoveInstanceEffectList(this);for(const e of this._effectParamBuffers)e&&e.Release();Yv.clearArray(this._effectParamBuffers),this._effectChain.Release(),this._effectChain=null,Yv.clearArray(this._activeEffectFlags),Yv.clearArray(this._activeEffectTypes),Yv.clearArray(this._effectParams),this._inst=null,this._effectList=null}_InitRenderer(e){e.IsWebGPU()&&(this._effectParamBuffers=this._effectList.GetAllEffectTypes().map((e=>{const t=e.GetShaderProgram();return t.GetCustomParametersByteSize()>0?Yv.New(Yv.Gfx.WebGPUEffectCustomParamsBuffer,t):null})))}_LoadEffectParameters(e){let t=0;for(const s of e)this._effectParams.push(this._LoadSingleEffectParameters(t,s)),++t;this._UpdateAllEffectParamBuffers(),this.UpdateActiveEffects()}_LoadSingleEffectParameters(e,t){this._activeEffectFlags[e]=t[0];const s=t.slice(1);for(let e=0,t=s.length;e<t;++e){const t=s[e];if(Array.isArray(t)){const n=Yv.New(Yv.Color);n.setFromJSON(t),s[e]=n}}return s}LoadDefaultEffectParameters(){for(const e of this._effectList.GetAllEffectTypes())this._effectParams.push(e.GetDefaultParameterValues());this._UpdateAllEffectParamBuffers()}GetOwner(){return this._owner}GetEffectList(){return this._effectList}GetEffectChain(){return this._MaybeRebuildEffectChainSteps(),this._effectChain}GetRuntime(){return this._inst.GetRuntime()}UpdateActiveEffects(){Yv.clearArray(this._activeEffectTypes);const e=this._wi,t=this._effectList.GetAllEffectTypes(),s=this._activeEffectTypes,n=this._activeEffectFlags;let i=!0;for(let e=0,r=t.length;e<r;++e)if(n[e]){const n=t[e];s.push(n),n.GetShaderProgram().PreservesOpaqueness()||(i=!1)}this._preservesOpaqueness=i,e._SetHasAnyActiveEffect(!!s.length),this._needsRebuildSteps=!0}_MaybeRebuildEffectChainSteps(){const e=this._inst,t=this._wi,s=t.HasDefaultColor(),n=e.GetPlugin().Is3D(),i=0!==t.GetAngle()||0!==t.GetLayer().GetAngle()||t.GetWidth()<0||t.GetHeight()<0,r=e.IsCurrentTexRotated(),a=e.MustPreDraw();(this._needsRebuildSteps||s!==this._wasDefaultColor||n!==this._was3D||i!==this._wasRotatedOrNegativeSize||r!==this._wasTexRotated||a!==this._wasMustPreDraw||this._effectChain.NeedsRebuild())&&(this._effectChain.BuildSteps(this._activeEffectTypes.map((e=>e.GetShaderProgram())),{indexMap:this._activeEffectTypes.map((e=>e.GetIndex())),forcePreDraw:!s||a,is3D:n,isSourceTextureRotated:r,isRotatedOrNegativeSizeInstance:i}),this._needsRebuildSteps=!1,this._wasDefaultColor=s,this._was3D=n,this._wasRotatedOrNegativeSize=i,this._wasTexRotated=r,this._wasMustPreDraw=a)}GetActiveEffectTypes(){return this._activeEffectTypes}GetEffectParametersForIndex(e){return this._effectParams[e]}_GetEffectChainShaderParametersForIndex(e){return e<this._effectParamBuffers.length?this._effectParamBuffers[e]:this._effectParams[e]}GetEffectParameter(e,t){if(e<0||e>=this._effectParams.length)return null;const s=this._effectParams[e];return t<0||t>=s.length?null:s[t]}SetEffectParameter(e,t,s){if(e<0||e>=this._effectParams.length)return!1;const n=this._effectParams[e];if(t<0||t>=n.length)return!1;const i=n[t];if(i instanceof Yv.Color){if(i.equalsIgnoringAlpha(s))return!1;i.copyRgb(s)}else{if(i===s)return!1;n[t]=s}return e<this._effectParamBuffers.length&&this._effectParamBuffers[e].SetParameterValue(t,s),!0}_UpdateAllEffectParamBuffers(){const e=this._effectParams,t=this._effectParamBuffers;for(let s=0,n=t.length;s<n;++s){const n=t[s],i=e[s];for(let e=0,t=i.length;e<t;++e)n.SetParameterValue(e,i[e])}}PreservesOpaqueness(){return this._preservesOpaqueness}HasAnyActiveBackgroundBlendingEffect(){return this._activeEffectTypes.some((e=>e.GetShaderProgram().BlendsBackground()))}IsEffectIndexActive(e){return this._activeEffectFlags[e]}SetEffectIndexActive(e,t){this._activeEffectFlags[e]=!!t}GetAllEffectTypes(){return this._effectList.GetAllEffectTypes()}_SaveToJson(){return this._effectList.GetAllEffectTypes().map((e=>({name:e.GetName(),active:this._activeEffectFlags[e.GetIndex()],params:Yv.EffectList.SaveFxParamsToJson(this._effectParams[e.GetIndex()])})))}_LoadFromJson(e){for(const t of e){const e=this._effectList.GetEffectTypeByName(t.name);e&&(this._activeEffectFlags[e.GetIndex()]=t.active,this._effectParams[e.GetIndex()]=Yv.EffectList.LoadFxParamsFromJson(t.params))}this.UpdateActiveEffects(),this._UpdateAllEffectParamBuffers()}}}{const qv=self.C3,Jv=[],Kv=[],$v=[],Zv=qv.New(qv.CollisionPoly),Qv=qv.New(qv.CollisionPoly),ex=qv.New(qv.Quad),tx=qv.New(qv.Rect),sx=qv.New(qv.Rect);let nx=null,ix=null,rx=null;qv.CollisionEngine=class extends qv.DefendedBase{constructor(e){super(),this._runtime=e,this._collisionCellWidth=0,this._collisionCellHeight=0,this._registeredCollisions=[],this._collisionCheckCount=0,this._collisionCheckSec=0,this._polyCheckCount=0,this._polyCheckSec=0,this._iCollisionEngine=new self.ICollisionEngine(this)}Release(){this._runtime=null}GetRuntime(){return this._runtime}GetICollisionEngine(){return this._iCollisionEngine}_Update1sStats(){this._collisionCheckSec=this._collisionCheckCount,this._collisionCheckCount=0,this._polyCheckSec=this._polyCheckCount,this._polyCheckCount=0}Get1secCollisionChecks(){return this._collisionCheckSec}Get1secPolyChecks(){return this._polyCheckSec}RegisterCollision(e,t){const s=e.GetWorldInfo(),n=t.GetWorldInfo();s&&n&&s.IsCollisionEnabled()&&n.IsCollisionEnabled()&&this._registeredCollisions.push([e,t])}AddRegisteredCollisionCandidates(e,t,s){for(const[n,i]of this._registeredCollisions){let r=null;if(e===n)r=i;else{if(e!==i)continue;r=n}r.BelongsToObjectClass(t)&&(s.includes(r)||s.push(r))}}CheckRegisteredCollision(e,t){if(!this._registeredCollisions.length)return!1;for(const[s,n]of this._registeredCollisions)if(e===s&&t===n||e===n&&t===s)return!0;return!1}ClearRegisteredCollisions(){qv.clearArray(this._registeredCollisions)}TestOverlap(e,t){if(!e||!t||e===t)return!1;const s=e.GetWorldInfo(),n=t.GetWorldInfo();if(!s.IsCollisionEnabled()||!n.IsCollisionEnabled())return!1;this._collisionCheckCount++;const i=s.GetLayer(),r=n.GetLayer();return i.IsTransformCompatibleWith(r)?this._TestOverlap_SameLayers(s,n):this._TestOverlap_DifferentLayers(s,n)}_TestOverlap_SameLayers(e,t){if(!e.GetBoundingBox().intersectsRect(t.GetBoundingBox()))return!1;if(this._polyCheckCount++,!e.GetBoundingQuad().intersectsQuad(t.GetBoundingQuad()))return!1;if(e.HasTilemap()&&t.HasTilemap())return!1;if(e.HasTilemap())return this.TestTilemapOverlap(e,t);if(t.HasTilemap())return this.TestTilemapOverlap(t,e);if(!e.HasOwnCollisionPoly()&&!t.HasOwnCollisionPoly())return!0;const s=e.GetTransformedCollisionPoly(),n=t.GetTransformedCollisionPoly();return s.intersectsPoly(n,t.GetX()-e.GetX(),t.GetY()-e.GetY())}_TestOverlap_DifferentLayers(e,t){const s=e.HasTilemap(),n=t.HasTilemap();if(s&&!n)return this.TestTilemapOverlapDifferentLayers(e,t);if(n&&!s)return this.TestTilemapOverlapDifferentLayers(t,e);if(n||s)return!1;{const s=e.GetLayer(),n=t.GetLayer();Zv.copy(e.GetTransformedCollisionPoly()),Qv.copy(t.GetTransformedCollisionPoly());const i=Zv.pointsArr();for(let t=0,n=i.length;t<n;t+=2){const n=t+1,r=i[t],a=i[n],[o,l]=s.LayerToCanvasCss(r+e.GetX(),a+e.GetY());i[t]=o,i[n]=l}const r=Qv.pointsArr();for(let e=0,s=r.length;e<s;e+=2){const s=e+1,i=r[e],a=r[s],[o,l]=n.LayerToCanvasCss(i+t.GetX(),a+t.GetY());r[e]=o,r[s]=l}return Zv.setBboxChanged(),Qv.setBboxChanged(),this._polyCheckCount++,Zv.intersectsPoly(Qv,0,0)}}TestTilemapOverlapDifferentLayers(e,t){const s=e.GetLayer(),n=t.GetLayer();nx||(nx=qv.New(qv.CollisionPoly)),ix||(ix=qv.New(qv.Rect)),rx||(rx=qv.New(qv.Quad));const i=t.GetX(),r=t.GetY(),[a,o]=n.LayerToCanvasCss(i,r),[l,c]=s.CanvasCssToLayer(a,o),h=l-i,_=c-r;if(ix.copy(t.GetBoundingBox()),ix.offset(h,_),!e.GetBoundingBox().intersectsRect(ix))return!1;if(rx.copy(t.GetBoundingQuad()),rx.offset(h,_),this._polyCheckCount++,!e.GetBoundingQuad().intersectsQuad(rx))return!1;nx.copy(t.GetTransformedCollisionPoly());const u=nx.pointsArr();for(let e=0,t=u.length;e<t;e+=2){const t=e+1;u[e]+=h,u[t]+=_}return nx.setBboxChanged(),this.TestTilemapOverlap(e,t,l,c,nx,ix,rx)}TestTilemapOverlap(e,t,s,n,i,r,a){const o=void 0!==r?r:t.GetBoundingBox(),l=e.GetX(),c=e.GetY(),h=e.GetInstance().GetSdkInstance(),_=void 0!==s?s:t.GetX(),u=void 0!==n?n:t.GetY(),d=t.HasOwnCollisionPoly(),p=void 0!==a?a:t.GetBoundingQuad(),f=Kv;h.GetCollisionRectCandidates(o,f);for(let e=0,s=f.length;e<s;++e){const s=f[e],n=s.GetRect();if(this._collisionCheckCount++,o.intersectsRectOffset(n,l,c)&&(ex.setFromRect(n),ex.offset(l,c),ex.intersectsQuad(p)))if(d){const e=void 0!==i?i:t.GetTransformedCollisionPoly();let r=_,a=u;void 0!==i&&(r=t.GetX(),a=t.GetY());const o=s.GetPoly();if(o){if(this._polyCheckCount++,o.intersectsPoly(e,r-(l+n.getLeft()),a-(c+n.getTop())))return qv.clearArray(f),!0}else if(Zv.setFromQuad(ex,0,0),Zv.intersectsPoly(e,r,a))return qv.clearArray(f),!0}else{const e=s.GetPoly();if(!e)return qv.clearArray(f),!0;if(Zv.setFromQuad(p,0,0),e.intersectsPoly(Zv,-(l+n.getLeft()),-(c+n.getTop())))return qv.clearArray(f),!0}}return qv.clearArray(f),!1}TestAndSelectCanvasPointOverlap(e,t,s){const n=e.GetCurrentSol(),i=this._runtime.GetCurrentEvent();if(!i)throw new Error("cannot call outside event");const r=i.IsOrBlock(),a=new qv.LayerStateCache;if(n.IsSelectAll()){s||(n._SetSelectAll(!1),qv.clearArray(n._GetOwnInstances())),r&&qv.clearArray(n._GetOwnElseInstances());for(const i of e.GetInstances()){const e=i.GetWorldInfo(),o=e.GetLayer();let l=!1;if(a.IsInteractive(o)&&e.IsInViewport2()&&(l=t.some((([t,s])=>{const[n,i]=a.CanvasCssToLayer(o,t,s,e.GetTotalZElevation());return e.ContainsPoint(n,i)}))),l){if(s)return!1;n._PushInstance(i)}else r&&n._PushElseInstance(i)}}else{let e,o=!1;r&&!i.IsFirstConditionOfType(this._runtime.GetCurrentCondition())?this._runtime.IsCurrentConditionFirst()&&!n._GetOwnElseInstances().length&&n._GetOwnInstances().length?e=n._GetOwnInstances():(e=n._GetOwnElseInstances(),o=!0):e=n._GetOwnInstances();let l=0;for(let i=0,c=e.length;i<c;++i){const c=e[i],h=c.GetWorldInfo(),_=h.GetLayer();let u=!1;if(a.IsInteractive(_)&&h.IsInViewport2()&&(u=t.some((([e,t])=>{const[s,n]=a.CanvasCssToLayer(_,e,t,h.GetTotalZElevation());return h.ContainsPoint(s,n)}))),u){if(s)return!1;o?n._PushInstance(c):e[l++]=c}else o?e[l++]=c:r&&n._PushElseInstance(c)}s||(e.length=l)}return e.ApplySolToContainer(),a.Release(),!!s||n.HasAnyInstances()}_ObjectClassCanUseCollisionCells(e,t){if(!e)return!0;for(const s of t.layersHasInstancesOn())if(!e.IsTransformCompatibleWith(s))return!1;return!0}GetCollisionCandidates(e,t,s,n){if(t.IsFamily())for(const i of t.GetFamilyMembers())this._ObjectClassCanUseCollisionCells(e,i)?(i._UpdateAllCollisionCells(),i._GetCollisionCellGrid().QueryRange(s,n)):qv.appendArray(n,i.GetInstances());else this._ObjectClassCanUseCollisionCells(e,t)?(t._UpdateAllCollisionCells(),t._GetCollisionCellGrid().QueryRange(s,n)):qv.appendArray(n,t.GetInstances())}GetObjectClassesCollisionCandidates(e,t,s,n){for(const i of t)this.GetCollisionCandidates(e,i,s,n)}GetSolidCollisionCandidates(e,t,s){const n=this._runtime.GetSolidBehavior();n&&this.GetObjectClassesCollisionCandidates(e,n.GetObjectClasses(),t,s)}GetJumpthruCollisionCandidates(e,t,s){const n=this._runtime.GetJumpthruBehavior();n&&this.GetObjectClassesCollisionCandidates(e,n.GetObjectClasses(),t,s)}IsSolidCollisionAllowed(e,t){return e._IsSolidEnabled()&&(!t||t.GetWorldInfo().IsSolidCollisionAllowed(e.GetSavedDataMap().get("solidTags")))}TestOverlapSolid(e){const t=e.GetWorldInfo();this.GetSolidCollisionCandidates(t.GetLayer(),t.GetBoundingBox(),Jv);for(const t of Jv)if(this.IsSolidCollisionAllowed(t,e)&&this.TestOverlap(e,t))return qv.clearArray(Jv),t;return qv.clearArray(Jv),null}TestRectOverlapSolid(e,t){this.GetSolidCollisionCandidates(null,e,Jv);for(const s of Jv)if(this.IsSolidCollisionAllowed(s,t)&&this.TestRectOverlap(e,s))return qv.clearArray(Jv),s;return qv.clearArray(Jv),null}TestOverlapJumpthru(e,t){let s=null;t&&(s=$v,qv.clearArray(s));const n=e.GetWorldInfo();this.GetJumpthruCollisionCandidates(n.GetLayer(),n.GetBoundingBox(),Jv);for(const n of Jv)if(n._IsJumpthruEnabled()&&this.TestOverlap(e,n)){if(!t)return qv.clearArray(Jv),n;s.push(n)}return qv.clearArray(Jv),s}PushOut(e,t,s,n,i){n=n||50;const r=e.GetWorldInfo(),a=r.GetX(),o=r.GetY();for(let l=0;l<n;++l)if(r.SetXY(a+t*l,o+s*l),r.SetBboxChanged(),!this.TestOverlap(e,i))return!0;return r.SetXY(a,o),r.SetBboxChanged(),!1}PushOutSolid(e,t,s,n,i,r){n=n||50;const a=e.GetWorldInfo(),o=a.GetX(),l=a.GetY();let c=null,h=null;for(let _=0;_<n;++_)if(a.SetXY(o+t*_,l+s*_),a.SetBboxChanged(),!this.TestOverlap(e,c))if(c=this.TestOverlapSolid(e),c)h=c;else if(i&&(c=r?this.TestOverlap(e,r)?r:null:this.TestOverlapJumpthru(e),c&&(h=c)),!c)return h&&this.PushInFractional(e,t,s,h,16,!0),!0;return a.SetXY(o,l),a.SetBboxChanged(),!1}PushOutSolidAxis(e,t,s,n){n=n||50;const i=e.GetWorldInfo(),r=i.GetX(),a=i.GetY();let o=null,l=null;for(let c=0;c<n;++c)for(let n=0;n<2;++n){const h=2*n-1;if(i.SetXY(r+t*c*h,a+s*c*h),i.SetBboxChanged(),!this.TestOverlap(e,o)){if(o=this.TestOverlapSolid(e),!o)return l&&this.PushInFractional(e,t*h,s*h,l,16,!0),!0;l=o}}return i.SetXY(r,a),i.SetBboxChanged(),!1}PushInFractional(e,t,s,n,i,r){let a=2,o=!1,l=!1;const c=e.GetWorldInfo();let h=c.GetX(),_=c.GetY();for(;a<=i;){const i=1/a;a*=2,c.OffsetXY(t*i*(o?1:-1),s*i*(o?1:-1)),c.SetBboxChanged(),this.TestOverlap(e,n)||r&&this.TestOverlapSolid(e)?(o=!0,l=!0):(o=!1,l=!1,h=c.GetX(),_=c.GetY())}l&&(c.SetXY(h,_),c.SetBboxChanged())}PushOutSolidNearest(e,t=100){let s=0;const n=e.GetWorldInfo(),i=n.GetX(),r=n.GetY();let a=0,o=this.TestOverlapSolid(e);if(!o)return!0;for(;s<=t;){let t=0,l=0;switch(a){case 0:t=0,l=-1,s++;break;case 1:t=1,l=-1;break;case 2:t=1,l=0;break;case 3:t=1,l=1;break;case 4:t=0,l=1;break;case 5:t=-1,l=1;break;case 6:t=-1,l=0;break;case 7:t=-1,l=-1}if(a=(a+1)%8,n.SetXY(Math.floor(i+t*s),Math.floor(r+l*s)),n.SetBboxChanged(),!this.TestOverlap(e,o)&&(o=this.TestOverlapSolid(e),!o))return!0}return n.SetXY(i,r),n.SetBboxChanged(),!1}CalculateBounceAngle(e,t,s,n){const i=e.GetWorldInfo(),r=i.GetX(),a=i.GetY(),o=Math.max(10,qv.distanceTo(t,s,r,a)),l=qv.angleTo(t,s,r,a),c=n||this.TestOverlapSolid(e);if(!c)return qv.clampAngle(l+Math.PI);let h=c,_=0,u=0;const d=qv.toRadians(5);let p;for(p=1;p<36;++p){const r=l-p*d;if(i.SetXY(t+Math.cos(r)*o,s+Math.sin(r)*o),i.SetBboxChanged(),!this.TestOverlap(e,h)&&(h=n?null:this.TestOverlapSolid(e),!h)){_=r;break}}for(36===p&&(_=qv.clampAngle(l+Math.PI)),h=c,p=1;p<36;++p){const r=l+p*d;if(i.SetXY(t+Math.cos(r)*o,s+Math.sin(r)*o),i.SetBboxChanged(),!this.TestOverlap(e,h)&&(h=n?null:this.TestOverlapSolid(e),!h)){u=r;break}}if(36===p&&(u=qv.clampAngle(l+Math.PI)),i.SetXY(r,a),i.SetBboxChanged(),u===_)return u;const f=qv.angleDiff(u,_)/2;let m;m=qv.angleClockwise(u,_)?qv.clampAngle(_+f+Math.PI):qv.clampAngle(u+f);const g=Math.cos(l),I=Math.sin(l),S=Math.cos(m),y=Math.sin(m),b=g*S+I*y,G=g-2*b*S,v=I-2*b*y;return qv.angleTo(0,0,G,v)}TestSegmentOverlap(e,t,s,n,i){if(!i)return!1;const r=i.GetWorldInfo();return!!r.IsCollisionEnabled()&&(this._collisionCheckCount++,tx.set(Math.min(e,s),Math.min(t,n),Math.max(e,s),Math.max(t,n)),!!r.GetBoundingBox().intersectsRect(tx)&&(i.HasTilemap()?this._TestSegmentOverlapTilemap(e,t,s,n,i,r):(this._polyCheckCount++,!!r.GetBoundingQuad().intersectsSegment(e,t,s,n)&&(!r.HasOwnCollisionPoly()||r.GetTransformedCollisionPoly().intersectsSegment(r.GetX(),r.GetY(),e,t,s,n)))))}_TestSegmentOverlapTilemap(e,t,s,n,i,r){const a=r.GetX(),o=r.GetY(),l=i.GetSdkInstance(),c=Kv;sx.set(e,t,s,n),sx.normalize(),l.GetCollisionRectCandidates(sx,c);for(let i=0,r=c.length;i<r;++i){const r=c[i],l=r.GetRect();if(this._collisionCheckCount++,tx.intersectsRectOffset(l,a,o)&&(ex.setFromRect(l),ex.offset(a,o),ex.intersectsSegment(e,t,s,n))){const i=r.GetPoly();if(!i)return qv.clearArray(c),!0;if(this._polyCheckCount++,i.intersectsSegment(a+l.getLeft(),o+l.getTop(),e,t,s,n))return qv.clearArray(c),!0}}return qv.clearArray(c),!1}TestRectOverlap(e,t){if(!t)return!1;const s=t.GetWorldInfo();if(!s.IsCollisionEnabled())return!1;if(this._collisionCheckCount++,!s.GetBoundingBox().intersectsRect(e))return!1;if(t.HasTilemap())return this._TestRectOverlapTilemap(e,t,s);if(this._polyCheckCount++,ex.setFromRect(e),!s.GetBoundingQuad().intersectsQuad(ex))return!1;if(!s.HasOwnCollisionPoly())return!0;const n=Zv;n.setFromRect(e,s.GetX(),s.GetY());const i=s.GetTransformedCollisionPoly();return n.intersectsPoly(i,0,0)}_TestRectOverlapTilemap(e,t,s){const n=s.GetX(),i=s.GetY(),r=t.GetSdkInstance(),a=Kv;r.GetCollisionRectCandidates(e,a);for(let t=0,s=a.length;t<s;++t){const s=a[t],r=s.GetRect();if(this._collisionCheckCount++,e.intersectsRectOffset(r,n,i)){const t=s.GetPoly();if(!t)return qv.clearArray(a),!0;if(this._polyCheckCount++,Zv.setFromRect(e,0,0),t.intersectsPoly(Zv,-(n+r.getLeft()),-(i+r.getTop())))return qv.clearArray(a),!0}}return qv.clearArray(a),!1}TestRayIntersectsInstance(e,t){if(!e)return;const s=e.GetWorldInfo();s.IsCollisionEnabled()&&(this._collisionCheckCount++,s.GetBoundingBox().intersectsRect(t.rect)&&(e.HasTilemap()?this._TestRayIntersectsTilemap(e,s,t):(this._polyCheckCount++,s.HasOwnCollisionPoly()?t.TestInstancePoly(e,s.GetX(),s.GetY(),s.GetTransformedCollisionPoly()):t.TestInstanceQuad(e,s.GetBoundingQuad()))))}_TestRayIntersectsTilemap(e,t,s){const n=t.GetX(),i=t.GetY(),r=Kv;e.GetSdkInstance().GetCollisionRectCandidates(s.rect,r);for(let a=0,o=r.length;a<o;a++){const o=r[a],l=o.GetRect();if(this._collisionCheckCount++,s.rect.intersectsRectOffset(l,n,i)){const r=o.GetPoly();this._polyCheckCount++,r?s.TestInstancePoly(e,n+l.getLeft(),i+l.getTop(),r):s.TestInstanceRect(e,t.GetX(),t.GetY(),l)}}qv.clearArray(r)}SetCollisionCellSize(e,t){if(e===this._collisionCellWidth&&t===this._collisionCellHeight)return;this._collisionCellWidth=e,this._collisionCellHeight=t;const s=this._runtime.GetAllObjectClasses();for(const n of s)if(n.IsWorldType()){for(const e of n.instancesIncludingPendingCreate())e.GetWorldInfo()._RemoveFromCollisionCells();n._GetCollisionCellGrid().SetCellSize(e,t),n._SetAnyCollisionCellChanged();for(const e of n.instancesIncludingPendingCreate()){const t=e.GetWorldInfo();t._SetCollisionCellChanged(),t._UpdateCollisionCell()}}}GetCollisionCellSize(){return[this._collisionCellWidth,this._collisionCellHeight]}_InitCollisionCellSize(e,t){this._collisionCellWidth=e,this._collisionCellHeight=t}}}{const ax=self.C3;ax.SparseGrid=class extends ax.DefendedBase{constructor(e,t){super(),this._cellWidth=e,this._cellHeight=t,this._cells=ax.New(ax.PairMap)}Release(){this._cells.Release(),this._cells=null}SetCellSize(e,t){if(!this._cells.IsEmpty())throw new Error("grid not empty");this._cellWidth=e,this._cellHeight=t}GetCell(e,t,s){let n=this._cells.Get(e,t);return n||(s?(n=ax.New(ax.GridCell,this,e,t),this._cells.Set(e,t,n),n):null)}XToCell(e){const t=Math.floor(e/this._cellWidth);return isFinite(t)?t:0}YToCell(e){const t=Math.floor(e/this._cellHeight);return isFinite(t)?t:0}Update(e,t,s){if(t)for(let n=t.getLeft(),i=t.getRight();n<=i;++n)for(let i=t.getTop(),r=t.getBottom();i<=r;++i){if(s&&s.containsPoint(n,i))continue;const t=this.GetCell(n,i,!1);t&&(t.Remove(e),t.IsEmpty()&&this._cells.Delete(n,i))}if(s)for(let n=s.getLeft(),i=s.getRight();n<=i;++n)for(let i=s.getTop(),r=s.getBottom();i<=r;++i)t&&t.containsPoint(n,i)||this.GetCell(n,i,!0).Insert(e)}QueryRange(e,t){let s=this.XToCell(e.getLeft());const n=this.YToCell(e.getTop()),i=this.XToCell(e.getRight()),r=this.YToCell(e.getBottom());if(isFinite(i)&&isFinite(r))for(;s<=i;++s)for(let e=n;e<=r;++e){const n=this.GetCell(s,e,!1);n&&n.Dump(t)}}}}{const ox=self.C3;ox.GridCell=class extends ox.DefendedBase{constructor(e,t,s){super(),this._grid=e,this._x=t,this._y=s,this._instances=ox.New(ox.ArraySet)}Release(){this._instances.Release(),this._instances=null,this._grid=null}IsEmpty(){return this._instances.IsEmpty()}Insert(e){this._instances.Add(e)}Remove(e){this._instances.Delete(e)}Dump(e){ox.appendArray(e,this._instances.GetArray())}}}{const lx=self.C3,cx=1e-6,hx=2;lx.Ray=class{constructor(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.dx=0,this.dy=0,this.rect=new lx.Rect,this.hitFraction=2,this.hitUid=null,this.hitNormal=0,this.hitNormalDx=0,this.hitNormalDy=0,this.hitX=0,this.hitY=0,this.distance=0,this.normalX=1,this.normalY=0,this.reflectionX=1,this.reflectionY=0}DidCollide(){return this.hitFraction<1.000001}Reset(){this.hitFraction=2}Set(e,t,s,n){return this.x1=e,this.y1=t,this.x2=s,this.y2=n,this.dx=s-e,this.dy=n-t,this.rect.set(e,t,s,n),this.rect.normalize(),this.hitFraction=2,this.hitUid=null,this.hitNormal=0,this.hitNormalDx=0,this.hitNormalDy=0,this.hitX=0,this.hitY=0,this.distance=0,this.normalX=1,this.normalY=0,this.reflectionX=1,this.reflectionY=0,this}Complete(){if(!1===this.DidCollide())return;const e=this.dx*this.hitFraction,t=this.dy*this.hitFraction,s=lx.hypot2DFast(e,t),n=e/s,i=t/s;this.distance=s-cx,this.hitX=this.x1+n*this.distance,this.hitY=this.y1+i*this.distance,this.hitNormal=Math.atan2(this.hitNormalDy,this.hitNormalDx)+Math.PI/2,this.normalX=Math.cos(this.hitNormal),this.normalY=Math.sin(this.hitNormal);const r=n*this.normalX+i*this.normalY;if(this.reflectionX=n-2*this.normalX*r,this.reflectionY=i-2*this.normalY*r,r>0){const e=Math.PI;this.hitNormal=lx.clampAngle(this.hitNormal+e),this.normalX=-this.normalX,this.normalY=-this.normalY}}TestInstanceSegment(e,t,s,n,i){const r=lx.rayIntersect(this.x1,this.y1,this.x2,this.y2,t,s,n,i);r>=0&&r<this.hitFraction&&(this.hitFraction=r,this.hitUid=e.GetUID(),this.hitNormalDx=t-n,this.hitNormalDy=s-i)}TestInstanceRect(e,t,s,n){const i=t+n.getLeft(),r=t+n.getRight(),a=s+n.getTop(),o=s+n.getBottom();this.TestInstanceSegment(e,i,a,r,a),this.TestInstanceSegment(e,r,a,r,o),this.TestInstanceSegment(e,r,o,i,o),this.TestInstanceSegment(e,i,o,i,a)}TestInstanceQuad(e,t){const s=t.getTlx(),n=t.getTly(),i=t.getTrx(),r=t.getTry(),a=t.getBrx(),o=t.getBry(),l=t.getBlx(),c=t.getBly();this.TestInstanceSegment(e,s,n,i,r),this.TestInstanceSegment(e,i,r,a,o),this.TestInstanceSegment(e,a,o,l,c),this.TestInstanceSegment(e,l,c,s,n)}TestInstancePoly(e,t,s,n){const i=n.pointsArr();for(let n=0,r=i.length;n<r;n+=2){const a=(n+2)%r,o=i[n]+t,l=i[n+1]+s,c=i[a]+t,h=i[a+1]+s;this.TestInstanceSegment(e,o,l,c,h)}}}}{const _x=self.C3;_x.LayerStateCache=class{constructor(){this._layerCache=new Map}Release(){for(const e of this._layerCache.values())e.layerPts.Clear();this._layerCache.clear()}_GetLayerCache(e){let t=this._layerCache.get(e);return void 0===t&&(t={isInteractive:null,layerPts:new _x.PairMap},this._layerCache.set(e,t)),t}IsInteractive(e){const t=this._GetLayerCache(e);return null===t.isInteractive&&(t.isInteractive=e.IsSelfAndParentsInteractive()),t.isInteractive}CanvasCssToLayer(e,t,s,n){if(0!==n)return e.CanvasCssToLayer(t,s,n);const i=this._GetLayerCache(e);let r=i.layerPts.Get(t,s);return void 0===r&&(r=e.CanvasCssToLayer(t,s,n),i.layerPts.Set(t,s,r)),r}}}{const ux=self.C3,dx=new Set(["off","crop","scale-inner","scale-outer","letterbox-scale","letterbox-integer-scale"]),px=new Set(["high","low"]),fx=self.glMatrix,mx=fx.mat4,gx=fx.vec3,Ix=mx.create(),Sx=300,yx=200,bx=120,Gx=8,vx=ux.New(ux.Quad),xx=ux.New(ux.Rect),Tx=3e3,Cx=200,wx=300;ux.CanvasManager=class extends ux.DefendedBase{constructor(e){super(),this._runtime=e,this._canvasLayers=[],this._isWebGPUEnabled=!1,this._webglRenderer=null,this._webgpuRenderer=null,this._iRenderer=null,this._gpuPreference="high-performance",this._isLimitedToWebGL1=!1,this._multitexturingMode="auto",this._windowInnerWidth=0,this._windowInnerHeight=0,this._cssDisplayMode="",this._canvasCssWidth=0,this._canvasCssHeight=0,this._canvasDeviceWidth=0,this._canvasDeviceHeight=0,this._canvasCssOffsetX=0,this._canvasCssOffsetY=0,this._zAxisScale="normalized",this._initFieldOfView=0,this._zNear=1,this._zFar=1e4,this._enableMipmaps=!0,this._textureAnisotropy=0,this._drawWidth=0,this._drawHeight=0,this._fullscreenMode="letterbox-scale",this._documentFullscreenMode="letterbox-scale",this._deviceTransformOffX=0,this._deviceTransformOffY=0,this._defaultProjectionMatrix=mx.create(),this._wantFullscreenScalingQuality="high",this._fullscreenScalingQuality=this._wantFullscreenScalingQuality,this._isDocumentFullscreen=!1,this._availableAdditionalRenderTargets=[],this._usedAdditionalRenderTargets=new Set,this._shaderData=self.C3_Shaders,this._effectChainManager=ux.New(ux.Gfx.EffectChainManager,{getDrawSize:()=>[this.GetDrawWidth(),this.GetDrawHeight()],getRenderTarget:()=>this.GetEffectCompositorRenderTarget(),releaseRenderTarget:e=>this.ReleaseEffectCompositorRenderTarget(e),getTime:()=>this.GetRuntime().GetGameTime(),redraw:()=>this.GetRuntime().UpdateRender()}),this._gpuTimeStartFrame=0,this._gpuTimeEndFrame=0,this._gpuLastUtilisation=NaN,this._gpuFrameTimingsBuffer=null,this._layersGpuProfile=new Map,this._gpuCurUtilisation=NaN,this._webgpuFrameTimings=new Map,this._snapshotFormat="",this._snapshotQuality=1,this._snapshotArea=ux.New(ux.Rect),this._snapshotUrl="",this._snapshotPromise=null,this._snapshotResolve=null,this._isPastingToDrawingCanvas=0,this._loaderStartTime=0,this._rafId=-1,this._loadingProgress=0,this._loadingprogress_handler=e=>this._loadingProgress=e.progress,this._percentText=null,this._splashTextures={logo:null,powered:null,website:null},this._splashFrameNumber=0,this._splashFadeInFinishTime=0,this._splashFadeOutStartTime=0,this._splashState="fade-in",this._splashDoneResolve=null,this._splashDonePromise=new Promise((e=>this._splashDoneResolve=e))}_SetGPUPowerPreference(e){this._gpuPreference=e}_SetWebGPUEnabled(e){this._isWebGPUEnabled=!!e}_SetZAxisScale(e){this._zAxisScale=e}GetZAxisScale(){return this._zAxisScale}_SetInitFieldOfView(e){this._initFieldOfView=e}_SetZDistances(e,t){this._zNear=e,this._zFar=t}_SetLimitedToWebGL1(e){this._isLimitedToWebGL1=!!e}_SetMultitexturingMode(e){this._multitexturingMode=e}async CreateCanvas(e){let t=e.canvas;this._canvasLayers.push({canvas:t,ctx:null}),this._runtime.AddDOMComponentMessageHandler("runtime","window-resize",(e=>this._OnWindowResize(e))),this._runtime.AddDOMComponentMessageHandler("runtime","fullscreenchange",(e=>this._OnFullscreenChange(e))),this._runtime.AddDOMComponentMessageHandler("runtime","fullscreenerror",(e=>this._OnFullscreenError(e))),t.addEventListener("webglcontextlost",(e=>this._OnWebGLContextLost(e))),t.addEventListener("webglcontextrestored",(e=>this._OnWebGLContextRestored(e))),this._isDocumentFullscreen=!!e.isFullscreen,this._cssDisplayMode=e.cssDisplayMode;const s=navigator.gpu&&this._isWebGPUEnabled;let n=!1;if(s)try{await this._InitWebGPUContext(!0)}catch(e){this._MaybeLogRendererError("WebGPU",e),this._webgpuRenderer=null}if(!this.GetRenderer())try{await this._InitWebGLContext(!0)}catch(e){this._MaybeLogRendererError("WebGL",e),this._webglRenderer=null}if(this.GetRenderer()||(n=!0),!this.GetRenderer()&&s)try{await this._InitWebGPUContext(!1)}catch(e){this._MaybeLogRendererError("WebGPU",e),this._webgpuRenderer=null}if(!this.GetRenderer())try{await this._InitWebGLContext(!1)}catch(e){this._MaybeLogRendererError("WebGL",e),this._webglRenderer=null}const i=this.GetRenderer();if(!i)throw new Error("failed to acquire a renderer - check WebGL or WebGPU is supported");i.SetHasMajorPerformanceCaveat(n),this._webgpuRenderer&&(this._webgpuRenderer.ondevicelost=()=>this._OnWebGPUDeviceLost(),this._webgpuRenderer.ondevicerestored=()=>this._OnWebGPUDeviceRestored()),"normalized"===this._zAxisScale?i.SetZAxisScaleNormalized():(i.SetZAxisScaleRegular(),i.SetFovY(this._initFieldOfView)),this.SetSize(e.windowInnerWidth,e.windowInnerHeight,!0),await this._InitRenderer()}_MaybeLogRendererError(e,t){t&&"string"==typeof t.message&&t.message.startsWith("renderer-unavailable")||console.error(`Error creating ${e} renderer: `,t)}async _InitWebGPUContext(e){const t={nearZ:this._zNear,farZ:this._zFar};let s=!0;"no"===this._multitexturingMode?s=!1:"auto"===this._multitexturingMode&&(s=ux.Platform.IsDesktop);const n={powerPreference:this._gpuPreference,depth:this._runtime.Uses3DFeatures(),failIfMajorPerformanceCaveat:e,usesBackgroundBlending:this._runtime.UsesAnyBackgroundBlending(),canSampleBackbuffer:this._runtime.UsesAnyCrossSampling(),canSampleDepth:this._runtime.UsesAnyDepthSampling(),isMultiTexturingAllowed:s};this._webgpuRenderer=ux.New(ux.Gfx.WebGPURenderer,t),await this._webgpuRenderer.Create(this._canvasLayers[0].canvas,n)}async _InitWebGLContext(e){const t={alpha:!0,powerPreference:this._gpuPreference,enableGpuProfiling:"xbox-uwp-webview2"!==this._runtime.GetExportType(),depth:this._runtime.Uses3DFeatures(),canSampleDepth:this._runtime.UsesAnyDepthSampling(),failIfMajorPerformanceCaveat:e,nearZ:this._zNear,farZ:this._zFar};this._isLimitedToWebGL1&&(t.maxWebGLVersion=1),this._webglRenderer=ux.New(ux.Gfx.WebGLRenderer,this._canvasLayers[0].canvas,t),await this._webglRenderer.InitState()}async _InitWebGPU(){if(this._shaderData){const e=[];for(const[t,s]of Object.entries(this._shaderData)){s.src=s.wgsl;const n=ux.Gfx.WebGPUShaderProgram.GetDefaultVertexShaderSource(this._webgpuRenderer.IsColorDataF16());e.push(this._webgpuRenderer.CreateShaderProgram(Object.assign({vertexSrc:n,name:t},s)))}await Promise.all(e)}}async _InitWebGL(){if(this._shaderData){const e=[];for(const[t,s]of Object.entries(this._shaderData)){let n;if(s.glslWebGL2&&this._webglRenderer.GetWebGLVersionNumber()>=2)s.src=s.glslWebGL2,n=ux.Gfx.WebGLShaderProgram.GetDefaultVertexShaderSource_WebGL2();else{if(!s.glsl)throw new Error(`shader '${t}' does not support WebGL 1`);s.src=s.glsl,n=ux.Gfx.WebGLShaderProgram.GetDefaultVertexShaderSource()}e.push(this._webglRenderer.CreateShaderProgram(Object.assign({vertexSrc:n,name:t},s)))}await Promise.all(e),this._webglRenderer.ResetLastProgram(),this._webglRenderer.SetTextureFillMode()}this._webglRenderer.SupportsGPUProfiling()&&(this._gpuFrameTimingsBuffer=ux.New(ux.Gfx.WebGLQueryResultBuffer,this._webglRenderer))}async _InitRenderer(){this._webgpuRenderer?await this._InitWebGPU():this._webglRenderer&&await this._InitWebGL();const e=this.GetRenderer();e.SetMipmapsEnabled(this._enableMipmaps),e.SupportsGPUProfiling()&&(this._gpuLastUtilisation=0);for(const t of this._runtime._GetAllEffectLists()){for(const s of t.GetAllEffectTypes())s._InitRenderer(e);t._InitRenderer(e),t.UpdateActiveEffects()}this._iRenderer=new self.IRenderer(this._runtime,e)}Release(){this._runtime=null,this._webglRenderer=null,this._canvasLayers.length=0}IsInWorker(){return this._runtime.IsInWorker()}_OnWindowResize(e){const t=this._runtime;if(t.IsExportToVideo())return;const s=e.devicePixelRatio;this.IsInWorker()&&(self.devicePixelRatio=s),t._SetDevicePixelRatio(s),this._isDocumentFullscreen=!!e.isFullscreen,this._cssDisplayMode=e.cssDisplayMode,this.SetSize(e.innerWidth,e.innerHeight),t.UpdateRender();const n=new ux.Event("window-resize");n.data=e,t.Dispatcher().dispatchEventAndWaitAsyncSequential(n);const i=new ux.Event("resize");i.cssWidth=this.GetCssWidth(),i.cssHeight=this.GetCssHeight(),i.deviceWidth=this.GetDeviceWidth(),i.deviceHeight=this.GetDeviceHeight(),t.DispatchUserScriptEvent(i),this._runtime.GetCurrentLayout()?.BoundScrolling(),t.IsDebug()&&(t.HitBreakpoint()||self.C3Debugger.IsDebuggerPaused())&&t.Render()}_OnFullscreenChange(e){this._isDocumentFullscreen=!!e.isFullscreen,this.SetSize(e.innerWidth,e.innerHeight,!0),this._runtime.UpdateRender()}_OnFullscreenError(e){this._isDocumentFullscreen=!!e.isFullscreen,this.SetSize(e.innerWidth,e.innerHeight,!0),this._runtime.UpdateRender()}SetSize(e,t,s=!1){if(e=Math.floor(e),t=Math.floor(t),e<=0||t<=0)throw new Error("invalid size");if(this._windowInnerWidth===e&&this._windowInnerHeight===t&&!s)return;this._windowInnerWidth=e,this._windowInnerHeight=t;const n=this.GetCurrentFullscreenMode();"letterbox-scale"===n?this._CalculateLetterboxScale(e,t):"letterbox-integer-scale"===n?this._CalculateLetterboxIntegerScale(e,t):"off"===n?this._CalculateFixedSizeCanvas(e,t):this._CalculateFullsizeCanvas(e,t),this._UpdateFullscreenScalingQuality(n);for(const{canvas:e}of this._canvasLayers)e.width=this._canvasDeviceWidth,e.height=this._canvasDeviceHeight;this._runtime.PostComponentMessageToDOM("canvas","update-size",{marginLeft:this._canvasCssOffsetX,marginTop:this._canvasCssOffsetY,styleWidth:this._canvasCssWidth,styleHeight:this._canvasCssHeight,displayScale:this.GetDisplayScale()});const i=this.GetRenderer();i.SetSize(this._canvasDeviceWidth,this._canvasDeviceHeight,!0);for(const e of this._availableAdditionalRenderTargets)i.DeleteRenderTarget(e);ux.clearArray(this._availableAdditionalRenderTargets),this.UpdateDefaultProjectionMatrix();const r=this._runtime.GetLayoutManager();r.SetAllLayerProjectionChanged(),r.SetAllLayerMVChanged()}UpdateDefaultProjectionMatrix(){this.GetRenderer().CalculatePerspectiveMatrix(this._defaultProjectionMatrix,this.GetDrawWidth()/this.GetDrawHeight())}GetDefaultProjectionMatrix(){return this._defaultProjectionMatrix}_CalculateLetterboxScale(e,t){const s=this._runtime.GetDevicePixelRatio(),n=this._runtime.GetOriginalViewportWidth(),i=this._runtime.GetOriginalViewportHeight(),r=n/i;if(e/t>r){const s=t*r;this._canvasCssWidth=Math.round(s),this._canvasCssHeight=t,this._canvasCssOffsetX=Math.floor((e-this._canvasCssWidth)/2),this._canvasCssOffsetY=0}else{const s=e/r;this._canvasCssWidth=e,this._canvasCssHeight=Math.round(s),this._canvasCssOffsetX=0,this._canvasCssOffsetY=Math.floor((t-this._canvasCssHeight)/2)}this._canvasDeviceWidth=Math.round(this._canvasCssWidth*s),this._canvasDeviceHeight=Math.round(this._canvasCssHeight*s),this._runtime.SetViewportSize(n,i)}_CalculateLetterboxIntegerScale(e,t){const s=this._runtime.GetDevicePixelRatio();1!==s&&(e+=1,t+=1);const n=this._runtime.GetOriginalViewportWidth(),i=this._runtime.GetOriginalViewportHeight(),r=n/i;let a;a=e/t>r?t*r*s/n:e/r*s/i,a>1?a=Math.floor(a):a<1&&(a=1/Math.ceil(1/a)),this._canvasDeviceWidth=Math.round(n*a),this._canvasDeviceHeight=Math.round(i*a),this._canvasCssWidth=this._canvasDeviceWidth/s,this._canvasCssHeight=this._canvasDeviceHeight/s,this._canvasCssOffsetX=Math.max(Math.floor((e-this._canvasCssWidth)/2),0),this._canvasCssOffsetY=Math.max(Math.floor((t-this._canvasCssHeight)/2),0),this._runtime.SetViewportSize(n,i)}_CalculateFullsizeCanvas(e,t){const s=this._runtime.GetDevicePixelRatio();this._canvasCssWidth=e,this._canvasCssHeight=t,this._canvasDeviceWidth=Math.round(this._canvasCssWidth*s),this._canvasDeviceHeight=Math.round(this._canvasCssHeight*s),this._canvasCssOffsetX=0,this._canvasCssOffsetY=0;const n=this.GetDisplayScale();this._runtime.SetViewportSize(this._canvasCssWidth/n,this._canvasCssHeight/n)}_CalculateFixedSizeCanvas(e,t){const s=this._runtime.GetDevicePixelRatio();this._canvasCssWidth=this._runtime.GetViewportWidth(),this._canvasCssHeight=this._runtime.GetViewportHeight(),this._canvasDeviceWidth=Math.round(this._canvasCssWidth*s),this._canvasDeviceHeight=Math.round(this._canvasCssHeight*s),this.IsDocumentFullscreen()?(this._canvasCssOffsetX=Math.floor((e-this._canvasCssWidth)/2),this._canvasCssOffsetY=Math.floor((t-this._canvasCssHeight)/2)):(this._canvasCssOffsetX=0,this._canvasCssOffsetY=0),this._runtime.SetViewportSize(this._runtime.GetViewportWidth(),this._runtime.GetViewportHeight())}_UpdateFullscreenScalingQuality(e){if("high"===this._wantFullscreenScalingQuality)this._drawWidth=this._canvasDeviceWidth,this._drawHeight=this._canvasDeviceHeight,this._fullscreenScalingQuality="high";else{let t,s;if("off"===this.GetCurrentFullscreenMode()?(t=this._runtime.GetViewportWidth(),s=this._runtime.GetViewportHeight()):(t=this._runtime.GetOriginalViewportWidth(),s=this._runtime.GetOriginalViewportHeight()),this._canvasDeviceWidth<t||this._canvasDeviceHeight<s)this._drawWidth=this._canvasDeviceWidth,this._drawHeight=this._canvasDeviceHeight,this._fullscreenScalingQuality="high";else if(this._drawWidth=t,this._drawHeight=s,this._fullscreenScalingQuality="low","scale-inner"===e){const e=t/s,n=this._windowInnerWidth/this._windowInnerHeight;n<e?this._drawWidth=this._drawHeight*n:n>e&&(this._drawHeight=this._drawWidth/n)}else if("scale-outer"===e){const e=t/s,n=this._windowInnerWidth/this._windowInnerHeight;n>e?this._drawWidth=this._drawHeight*n:n<e&&(this._drawHeight=this._drawWidth/n)}}}GetRuntime(){return this._runtime}GetMainCanvas(){return this._canvasLayers[0].canvas}GetEffectChainManager(){return this._effectChainManager}IsDocumentFullscreen(){return this._isDocumentFullscreen}GetCssDisplayMode(){return this._cssDisplayMode}SetFullscreenMode(e){if(!dx.has(e))throw new Error("invalid fullscreen mode");this._fullscreenMode=e;const t=this._runtime.GetLayoutManager();t.SetAllLayerProjectionChanged(),t.SetAllLayerMVChanged()}GetFullscreenMode(){return this._fullscreenMode}SetDocumentFullscreenMode(e){if(!dx.has(e))throw new Error("invalid fullscreen mode");this._documentFullscreenMode=e;const t=this._runtime.GetLayoutManager();t.SetAllLayerProjectionChanged(),t.SetAllLayerMVChanged()}GetDocumentFullscreenMode(){return this._documentFullscreenMode}GetCurrentFullscreenMode(){return this.IsDocumentFullscreen()?this.GetDocumentFullscreenMode():this.GetFullscreenMode()}SetFullscreenScalingQuality(e){if(!px.has(e))throw new Error("invalid fullscreen scaling quality");this._wantFullscreenScalingQuality=e,this._runtime.GetLayoutManager().SetAllLayerProjectionChanged()}GetSetFullscreenScalingQuality(){return this._wantFullscreenScalingQuality}GetCurrentFullscreenScalingQuality(){return this._fullscreenScalingQuality}static _FullscreenModeNumberToString(e){switch(e){case 0:return"off";case 1:return"crop";case 2:return"scale-inner";case 3:return"scale-outer";case 4:return"letterbox-scale";case 5:return"letterbox-integer-scale";default:throw new Error("invalid fullscreen mode")}}GetLastWidth(){return this._windowInnerWidth}GetLastHeight(){return this._windowInnerHeight}GetDrawWidth(){return this._drawWidth}GetDrawHeight(){return this._drawHeight}SetMipmapsEnabled(e){this._enableMipmaps=!!e}_SetTextureAnisotropy(e){this._textureAnisotropy=e}GetTextureAnisotropy(){return this._textureAnisotropy}IsRendererContextLost(){return this.GetRenderer().IsContextLost()}_OnWebGLContextLost(e){console.log("[Construct] WebGL context lost"),e.preventDefault(),this._availableAdditionalRenderTargets=[],this._usedAdditionalRenderTargets.clear(),this._effectChainManager.OnContextLost(),this._webglRenderer.OnContextLost(),this._runtime._OnRendererContextLost()}_OnWebGPUDeviceLost(){console.log("[Construct] WebGPU device lost"),this._availableAdditionalRenderTargets=[],this._usedAdditionalRenderTargets.clear(),this._effectChainManager.OnContextLost(),this._runtime._OnRendererContextLost()}async _OnWebGLContextRestored(e){await this._webglRenderer.OnContextRestored(),await this._InitRenderer(),await this._runtime._OnRendererContextRestored(),console.log("[Construct] WebGL context restored")}async _OnWebGPUDeviceRestored(){await this._InitRenderer(),await this._runtime._OnRendererContextRestored(),console.log("[Construct] WebGPU device restored")}GetWebGLRenderer(){return this._webglRenderer}GetWebGPURenderer(){return this._webgpuRenderer}GetRenderer(){return this._webgpuRenderer||this._webglRenderer}GetIRenderer(){return this._iRenderer}GetRendererString(){let e="";return e=this._runtime.GetWebGPURenderer()?"webgpu":"webgl"+this._runtime.GetWebGLRenderer().GetWebGLVersionNumber(),this._runtime.GetRenderer().HasMajorPerformanceCaveat()&&(e+="-software"),e}GetRendererDetailString(){return this._runtime.GetWebGPURenderer()?this._runtime.GetWebGPURenderer().GetAdapterInfoString():this._runtime.GetWebGLRenderer().GetUnmaskedRenderer()}GetRenderScale(){return"low"===this._fullscreenScalingQuality?1/this._runtime.GetDevicePixelRatio():this.GetDisplayScale()}GetDisplayScale(){const e=this.GetCurrentFullscreenMode();if("off"===e||"crop"===e)return 1;const t=this._runtime.GetOriginalViewportWidth(),s=this._runtime.GetOriginalViewportHeight(),n=t/s,i=this._canvasDeviceWidth/this._canvasDeviceHeight;return"scale-inner"!==e&&i>n||"scale-inner"===e&&i<n?this._canvasCssHeight/s:this._canvasCssWidth/t}GetEffectLayerScaleParam(){return"low"===this.GetCurrentFullscreenScalingQuality()?1:this.GetDisplayScale()}GetEffectDevicePixelRatioParam(){return"low"===this.GetCurrentFullscreenScalingQuality()?1:this._runtime.GetDevicePixelRatio()}SetDeviceTransformOffset(e,t){this._deviceTransformOffX=e,this._deviceTransformOffY=t}SetDeviceTransform(e,t,s,n=!0){t=t||this._drawWidth,s=s||this._drawHeight;const i=t/2+this._deviceTransformOffX,r=s/2+this._deviceTransformOffY;if(n){let n=this.GetDefaultProjectionMatrix();t===this._drawWidth&&s===this._drawHeight||(e.CalculatePerspectiveMatrix(Ix,t/s),n=Ix),e.SetProjectionMatrix(n)}const a=e.CalculateLookAtModelView2(i,r,e.GetDefaultCameraZ(s),i,r,0,s);e.SetModelViewMatrix(a)}SetCssTransform(e,t=!0){const s=this.GetCssWidth(),n=this.GetCssHeight(),i=s/2,r=n/2;t&&e.SetProjectionMatrix(this.GetDefaultProjectionMatrix());const a=e.CalculateLookAtModelView2(i,r,e.GetDefaultCameraZ(n),i,r,0,n);e.SetModelViewMatrix(a)}GetDeviceWidth(){return this._canvasDeviceWidth}GetDeviceHeight(){return this._canvasDeviceHeight}GetCssWidth(){return this._canvasCssWidth}GetCssHeight(){return this._canvasCssHeight}GetCanvasClientX(){return this._canvasCssOffsetX}GetCanvasClientY(){return this._canvasCssOffsetY}GetHTMLLayerCount(){return this._canvasLayers.length}_CanUseImageBitmapRenderingContext(){return"undefined"!=typeof OffscreenCanvas&&this.GetMainCanvas()instanceof OffscreenCanvas&&("Chromium"!==ux.Platform.BrowserEngine||ux.Platform.BrowserVersionNumber>=124)}async SetHTMLLayerCount(e,t=!1){if(e<1)throw new Error("invalid HTML layer count");if(this._canvasLayers.length===e)return;const s={count:e,layersDomState:this._runtime.GetLayoutManager().GetMainRunningLayout()._GetRootLayers().filter((e=>e.IsHTMLElementsLayer())).map((e=>e._GetHTMLLayerDOMState())),immediate:t,marginLeft:this._canvasCssOffsetX,marginTop:this._canvasCssOffsetY,styleWidth:this._canvasCssWidth,styleHeight:this._canvasCssHeight};let n;if(n=this.IsInWorker()?await this._runtime.PostComponentMessageToDOMAsync("canvas","set-html-layer-count",s):self.c3_runtimeInterface._OnSetHTMLLayerCount(s),e<this._canvasLayers.length)this._canvasLayers.length=e;else for(const e of n.addedCanvases){e.width=this._canvasDeviceWidth,e.height=this._canvasDeviceHeight;const t=this._CanUseImageBitmapRenderingContext()?"bitmaprenderer":"2d",s=e.getContext(t);if(!s)throw new Error(`failed to acquire '${t}' canvas context`);this._canvasLayers.push({canvas:e,ctx:s})}this._runtime.UpdateRender()}BlitMainCanvasToHTMLLayerCanvas(e){if(e>=this._canvasLayers.length)return;const t=this.GetMainCanvas(),s=this._canvasLayers[e].ctx;this._CanUseImageBitmapRenderingContext()?s.transferFromImageBitmap(t.transferToImageBitmap()):(s.globalCompositeOperation="copy",s.drawImage(t,0,0))}GetAdditionalRenderTarget(e){e.depth=this._runtime.Uses3DFeatures();const t=this._availableAdditionalRenderTargets,s=t.findIndex((t=>t.IsCompatibleWithOptions(e)));let n;return-1!==s?(n=t[s],t.splice(s,1)):n=this.GetRenderer().CreateRenderTarget(e),this._usedAdditionalRenderTargets.add(n),n}ReleaseAdditionalRenderTarget(e){if(!this._usedAdditionalRenderTargets.has(e))throw new Error("render target not in use");this._usedAdditionalRenderTargets.delete(e),this._availableAdditionalRenderTargets.push(e)}GetEffectCompositorRenderTarget(){const e={sampling:this._runtime.GetSampling()};return"low"===this.GetCurrentFullscreenScalingQuality()&&(e.width=this.GetDrawWidth(),e.height=this.GetDrawHeight()),this.GetAdditionalRenderTarget(e)}ReleaseEffectCompositorRenderTarget(e){this.ReleaseAdditionalRenderTarget(e)}*activeLayersGpuProfiles(){for(const e of this._runtime.GetLayoutManager().runningLayouts())for(const t of e.GetLayers()){const e=this._layersGpuProfile.get(t);e&&(yield e)}}GetLayerTimingsBuffer(e){if(!this.GetRenderer().SupportsGPUProfiling())return null;let t=this._layersGpuProfile.get(e);return t||(t={layer:e,name:e.GetName(),timingsBuffer:ux.New(ux.Gfx.WebGLQueryResultBuffer,this._webglRenderer),curUtilisation:0,lastTotalUtilisation:0,lastSelfUtilisation:0},this._layersGpuProfile.set(e,t)),t.timingsBuffer}_Update1sFrameRange(){const e=this.GetRenderer();if(e.SupportsGPUProfiling()&&0===this._gpuTimeEndFrame){this._gpuTimeEndFrame=e.GetFrameNumber(),this._gpuCurUtilisation=NaN;for(const e of this.activeLayersGpuProfiles())e.curUtilisation=NaN}}_UpdateTick(){this._webglRenderer&&this._webglRenderer.SupportsGPUProfiling()&&this._UpdateTick_WebGL(),this._webgpuRenderer&&this._webgpuRenderer.SupportsGPUProfiling()&&this._UpdateTick_WebGPU()}_UpdateTick_WebGL(){if(isNaN(this._gpuCurUtilisation)&&(this._gpuCurUtilisation=this._gpuFrameTimingsBuffer.GetFrameRangeResultSum(this._gpuTimeStartFrame,this._gpuTimeEndFrame),!isNaN(this._gpuCurUtilisation))){if(this._runtime.IsDebug())for(const e of this.activeLayersGpuProfiles())if(e.curUtilisation=e.timingsBuffer.GetFrameRangeResultSum(this._gpuTimeStartFrame,this._gpuTimeEndFrame),isNaN(e.curUtilisation))return;if(this._gpuFrameTimingsBuffer.DeleteAllBeforeFrameNumber(this._gpuTimeEndFrame),this._gpuLastUtilisation=Math.min(this._gpuCurUtilisation,1),this._runtime.IsDebug()){const e=new Map;for(const t of this.activeLayersGpuProfiles())t.timingsBuffer.DeleteAllBeforeFrameNumber(this._gpuTimeEndFrame),t.lastTotalUtilisation=Math.min(t.curUtilisation,1),e.set(t.layer,t.lastTotalUtilisation);for(const t of this.activeLayersGpuProfiles()){const s=t.layer,n=(e.get(s)||0)-s.GetSubLayers().reduce(((t,s)=>t+(e.get(s)||0)),0);t.lastSelfUtilisation=ux.clamp(n,0,1)}const t=this._runtime.GetMainRunningLayout(),s=this._gpuLastUtilisation-t._GetRootLayers().reduce(((t,s)=>t+(e.get(s)||0)),0);self.C3Debugger.UpdateGPUProfile(ux.clamp(s,0,1),this._gpuLastUtilisation,[...this.activeLayersGpuProfiles()])}this._gpuTimeStartFrame=this._gpuTimeEndFrame,this._gpuTimeEndFrame=0}}GetGPUFrameTimingsBuffer(){return this._gpuFrameTimingsBuffer}_UpdateTick_WebGPU(){if(0===this._gpuTimeEndFrame)return;for(let e=this._gpuTimeStartFrame;e<this._gpuTimeEndFrame;++e){const t=this._webgpuFrameTimings.get(e);if(t&&!t.HasResult())return}const e=this._runtime.GetMainRunningLayout(),t=ux.MakeFilledArray(e.GetLayerCount()+1,0);let s=0;for(let e=this._gpuTimeStartFrame;e<this._gpuTimeEndFrame;++e){const n=this._webgpuFrameTimings.get(e);if(!n)continue;const i=n.GetResult();let r=BigInt(0),a=BigInt(0);const o=BigInt(0);for(let e=0,s=Math.min(t.length,i.length/2);e<s;++e){const s=i[2*e],n=i[2*e+1];s!==o&&(r===o||s<r)&&(r=s),n>a&&(a=n);const l=Number(n-s)/1e9;t[e]+=l}s+=Number(a-r)/1e9}if(this._gpuLastUtilisation=ux.clamp(s,0,1),this._runtime.IsDebug()){const s=e.GetLayers(),n=new Map;for(let e=0,i=Math.min(s.length,t.length-1);e<i;++e){const i=t[e+1];n.set(s[e],i)}const i=[],r=new Map;for(const[e,t]of n){const s=[...e.selfAndAllSubLayers()].reduce(((e,t)=>e+(n.get(t)||0)),0);r.set(e,s),i.push({name:e.GetName(),lastSelfUtilisation:ux.clamp(t,0,1),lastTotalUtilisation:ux.clamp(s,0,1)})}const a=this._gpuLastUtilisation-e._GetRootLayers().reduce(((e,t)=>e+(r.get(t)||0)),0);self.C3Debugger.UpdateGPUProfile(ux.clamp(a,0,1),this._gpuLastUtilisation,i)}for(let e=this._gpuTimeStartFrame;e<this._gpuTimeEndFrame;++e)this._webgpuFrameTimings.delete(e);this._gpuTimeStartFrame=this._gpuTimeEndFrame,this._gpuTimeEndFrame=0}_AddWebGPUFrameTiming(e){this._webgpuFrameTimings.set(this._webgpuRenderer.GetFrameNumber(),e)}GetGPUUtilisation(){return this._gpuLastUtilisation}SnapshotCanvas(e,t,s,n,i,r){return this._snapshotFormat=e,this._snapshotQuality=t,this._snapshotArea.setWH(s,n,i,r),this._snapshotPromise||(this._snapshotPromise=new Promise((e=>{this._snapshotResolve=e}))),this._snapshotPromise}_MaybeTakeSnapshot(){if(!this._snapshotFormat)return;let e=this.GetMainCanvas();const t=this._snapshotArea,s=ux.clamp(Math.floor(t.getLeft()),0,e.width),n=ux.clamp(Math.floor(t.getTop()),0,e.height);let i=t.width();i=0===i?e.width-s:ux.clamp(Math.floor(i),0,e.width-s);let r=t.height();if(r=0===r?e.height-n:ux.clamp(Math.floor(r),0,e.height-n),(0!==s||0!==n||i!==e.width||r!==e.height)&&i>0&&r>0){const t=ux.CreateCanvas(i,r);t.getContext("2d").drawImage(e,s,n,i,r,0,0,i,r),e=t}ux.CanvasToBlob(e,this._snapshotFormat,this._snapshotQuality).then((e=>{this._snapshotUrl&&URL.revokeObjectURL(this._snapshotUrl),this._snapshotUrl=URL.createObjectURL(e),this._snapshotPromise=null,this._snapshotResolve(e)})),this._snapshotFormat="",this._snapshotQuality=1}GetCanvasSnapshotUrl(){return this._snapshotUrl}SetIsPastingToDrawingCanvas(e){e?this._isPastingToDrawingCanvas++:this._isPastingToDrawingCanvas--}IsPastingToDrawingCanvas(){return this._isPastingToDrawingCanvas>0}InitLoadingScreen(e){const t=this.GetRenderer();if(2===e)this._percentText=ux.New(ux.Gfx.RendererText,this.GetRenderer()),this._percentText.SetFontName("Arial"),this._percentText.SetFontSize(16),this._percentText.SetHorizontalAlignment("center"),this._percentText.SetVerticalAlignment("center"),this._percentText.SetSize(300,200);else if(0===e){const e=this._runtime.GetLoadingLogoAsset();e&&e.LoadStaticTexture(t).catch((e=>console.warn("[C3 runtime] Failed to create texture for loading logo: ",e)))}else 4===e&&(this._LoadSvgSplashImage("splash-images/splash-logo.svg").then((e=>{"done"===this._splashState?t.DeleteTexture(e):this._splashTextures.logo=e})).catch((e=>console.warn("Failed to load splash image: ",e))),this._LoadBitmapSplashImage("splash-images/splash-poweredby-512.png").then((e=>{"done"===this._splashState?t.DeleteTexture(e):this._splashTextures.powered=e})).catch((e=>console.warn("Failed to load splash image: ",e))),this._LoadBitmapSplashImage("splash-images/splash-website-512.png").then((e=>{"done"===this._splashState?t.DeleteTexture(e):this._splashTextures.website=e})).catch((e=>console.warn("Failed to load splash image: ",e))))}async _LoadSvgSplashImage(e){e=new URL(e,this._runtime.GetRuntimeBaseURL()).toString();const t=await ux.FetchBlob(e),s=await this._runtime.RasterSvgImage(t,2048,2048);return await this.GetRenderer().CreateStaticTextureAsync(s,{mipMapQuality:"high"})}async _LoadBitmapSplashImage(e){e=new URL(e,this._runtime.GetRuntimeBaseURL()).toString();const t=await ux.FetchBlob(e);return await this.GetRenderer().CreateStaticTextureAsync(t,{mipMapQuality:"high"})}HideCordovaSplashScreen(){this._runtime.PostComponentMessageToDOM("runtime","hide-cordova-splash")}StartLoadingScreen(){this._loaderStartTime=Date.now(),this._runtime.Dispatcher().addEventListener("loadingprogress",this._loadingprogress_handler),this._rafId=requestAnimationFrame((()=>this._DrawLoadingScreen())),3!==this._runtime.GetLoaderStyle()&&this.HideCordovaSplashScreen()}async EndLoadingScreen(){const e=this.GetRenderer();this._loadingProgress=1;const t=this._runtime.GetLoaderStyle();4===t&&await this._splashDonePromise,this._splashDoneResolve=null,this._splashDonePromise=null,-1!==this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=-1),this._runtime.Dispatcher().removeEventListener("loadingprogress",this._loadingprogress_handler),this._loadingprogress_handler=null,this._percentText&&(this._percentText.Release(),this._percentText=null),this._runtime.ReleaseLoadingLogoAsset(),e.Start(),this._splashTextures.logo&&(e.DeleteTexture(this._splashTextures.logo),this._splashTextures.logo=null),this._splashTextures.powered&&(e.DeleteTexture(this._splashTextures.powered),this._splashTextures.powered=null),this._splashTextures.website&&(e.DeleteTexture(this._splashTextures.website),this._splashTextures.website=null),e.ClearRgba(0,0,0,0),e.Finish(),this._splashState="done",this._gpuTimeStartFrame=e.GetFrameNumber(),3===t&&this.HideCordovaSplashScreen()}_DrawLoadingScreen(){if(-1===this._rafId)return;const e=this.GetRenderer();e.Start(),this._rafId=-1;const t=this._runtime.GetAssetManager().HasHadErrorLoading(),s=this._runtime.GetLoaderStyle();if(3!==s&&(this.SetCssTransform(e),e.ClearRgba(0,0,0,0),e.ResetColor(),e.SetTextureFillMode(),e.SetTexture(null)),0===s)this._DrawProgressBarAndLogoLoadingScreen(t);else if(1===s)this._DrawProgressBarLoadingScreen(t,120,0);else if(2===s)this._DrawPercentTextLoadingScreen(t);else if(3===s)ux.noop();else{if(4!==s)throw new Error("invalid loader style");this._DrawSplashLoadingScreen(t)}e.Finish(),this._rafId=requestAnimationFrame((()=>this._DrawLoadingScreen()))}_DrawPercentTextLoadingScreen(e){e?this._percentText.SetColorRgb(1,0,0):this._percentText.SetColorRgb(.6,.6,.6),this._percentText.SetText(Math.round(100*this._loadingProgress)+"%");const t=this._canvasCssWidth/2,s=this._canvasCssHeight/2;vx.setRect(t-150,s-100,t+150,s+100);const n=this.GetRenderer();n.SetTexture(this._percentText.GetTexture()),n.Quad3(vx,this._percentText.GetTexRect())}_DrawProgressBarLoadingScreen(e,t,s){const n=this.GetRenderer();n.SetColorFillMode(),e?n.SetColorRgba(1,0,0,1):n.SetColorRgba(.118,.565,1,1);const i=this._canvasCssWidth/2,r=this._canvasCssHeight/2,a=t/2;xx.setWH(i-a,r-4+s,Math.floor(t*this._loadingProgress),8),n.Rect(xx),xx.setWH(i-a,r-4+s,t,8),xx.offset(-.5,-.5),xx.inflate(.5,.5),n.SetColorRgba(0,0,0,1),n.LineRect2(xx),xx.inflate(1,1),n.SetColorRgba(1,1,1,1),n.LineRect2(xx)}_DrawProgressBarAndLogoLoadingScreen(e){const t=this.GetRenderer(),s=this._runtime.GetLoadingLogoAsset();if(!s)return void this._DrawProgressBarLoadingScreen(e,120,0);const n=s.GetTexture();if(!n)return void this._DrawProgressBarLoadingScreen(e,120,0);const i=n.GetWidth(),r=n.GetHeight(),a=this._canvasCssWidth/2,o=this._canvasCssHeight/2,l=i/2,c=r/2;vx.setRect(a-l,o-c,a+l,o+c),t.SetTexture(n),t.Quad(vx),this._DrawProgressBarLoadingScreen(e,i,c+16)}_DrawSplashLoadingScreen(e){const t=this.GetRenderer(),s=this._splashTextures.logo,n=this._splashTextures.powered,i=this._splashTextures.website,r=Date.now();0===this._splashFrameNumber&&(this._loaderStartTime=r);const a=this._runtime.IsPreview()||this._runtime.IsFBInstantAvailable()&&!this._runtime.IsCordova(),o=a?0:200,l=a?0:3e3;let c=1;"fade-in"===this._splashState?c=Math.min((r-this._loaderStartTime)/300,1):"fade-out"===this._splashState&&(c=Math.max(1-(r-this._splashFadeOutStartTime)/300,0)),t.SetColorFillMode(),t.SetColorRgba(.231*c,.251*c,.271*c,c),xx.set(0,0,this._canvasCssWidth,this._canvasCssHeight),t.Rect(xx);const h=Math.ceil(this._canvasCssWidth),_=Math.ceil(this._canvasCssHeight);let u,d;this._canvasCssHeight>256?(t.SetColorRgba(.302*c,.334*c,.365*c,c),u=h,d=Math.max(.005*_,2),xx.setWH(0,.8*_-d/2,u,d),t.Rect(xx),e?t.SetColorRgba(c,0,0,c):t.SetColorRgba(.161*c,.953*c,.816*c,c),u=h*this._loadingProgress,xx.setWH(.5*h-u/2,.8*_-d/2,u,d),t.Rect(xx),t.SetColorRgba(c,c,c,c),t.SetTextureFillMode(),n&&(u=1.5*ux.clamp(.22*_,105,.6*h),d=u/8,xx.setWH(.5*h-u/2,.2*_-d/2,u,d),t.SetTexture(n),t.Rect(xx)),s&&(u=Math.min(.395*_,.95*h),d=u,xx.setWH(.5*h-u/2,.485*_-d/2,u,d),t.SetTexture(s),t.Rect(xx)),i&&(u=1.5*ux.clamp(.22*_,105,.6*h),d=u/8,xx.setWH(.5*h-u/2,.868*_-d/2,u,d),t.SetTexture(i),t.Rect(xx))):(t.SetColorRgba(.302*c,.334*c,.365*c,c),u=h,d=Math.max(.005*_,2),xx.setWH(0,.85*_-d/2,u,d),t.Rect(xx),e?t.SetColorRgba(c,0,0,c):t.SetColorRgba(.161*c,.953*c,.816*c,c),u=h*this._loadingProgress,xx.setWH(.5*h-u/2,.85*_-d/2,u,d),t.Rect(xx),t.SetColorRgba(c,c,c,c),t.SetTextureFillMode(),s&&(u=.55*_,d=u,xx.setWH(.5*h-u/2,.45*_-d/2,u,d),t.SetTexture(s),t.Rect(xx))),this._splashFrameNumber++,"fade-in"===this._splashState&&r-this._loaderStartTime>=300&&this._splashFrameNumber>=2&&(this._splashState="wait",this._splashFadeInFinishTime=r),"wait"===this._splashState&&r-this._splashFadeInFinishTime>=l&&this._loadingProgress>=1&&(this._splashState="fade-out",this._splashFadeOutStartTime=r),("fade-out"===this._splashState&&r-this._splashFadeOutStartTime>=300+o||a&&this._loadingProgress>=1&&r-this._loaderStartTime<500)&&this._splashDoneResolve()}}}{const Px=self.C3,Ax=self.C3Debugger,Rx=self.assert,Dx=self.ISDKBehaviorInstanceBase,Ex={messagePort:null,runtimeBaseUrl:"",headless:!1,hasDom:!0,isInWorker:!1,useAudio:!0,exportType:""};let Mx=!0;Px.Runtime=class extends Px.DefendedBase{constructor(e){e=Object.assign({},Ex,e),super(),this._messagePort=e.messagePort,this._runtimeBaseUrl=e.runtimeBaseUrl,this._previewUrl=e.previewUrl,this._isHeadless=!!e.headless,this._hasDom=!!e.hasDom,this._isInWorker=!!e.isInWorker,Mx=e.ife,this._useAudio=!!e.useAudio,this._exportType=e.exportType,this._isNWjs=e.isNWjs,this._isiOSCordova=!!e.isiOSCordova,this._isiOSWebView=!!e.isiOSWebView,this._isWindowsWebView2=!!e.isWindowsWebView2,this._isAnyWebView2Wrapper=!!e.isAnyWebView2Wrapper,this._isFBInstantAvailable=!!e.isFBInstantAvailable,this._isDebug=!("preview"!==this._exportType||!e.isDebug),this._breakpointsEnabled=this._isDebug,this._isDebugging=this._isDebug,this._debuggingDisabled=0,this._additionalLoadPromises=[],this._additionalCreatePromises=[],this._isUsingCreatePromises=!1,this._projectName="",this._projectVersion="",this._projectUniqueId="",this._appId="",this._exportTimestamp=0,this._originalViewportWidth=0,this._originalViewportHeight=0,this._devicePixelRatio=self.devicePixelRatio,this._parallaxXorigin=0,this._parallaxYorigin=0,this._viewportWidth=0,this._viewportHeight=0,this._loaderStyle=0,this._usesLoaderLayout=!1,this._isLoading=!0,this._usesAnyBackgroundBlending=!1,this._usesAnyCrossSampling=!1,this._usesAnyDepthSampling=!1,this._loadingLogoAsset=null,this._assetManager=Px.New(Px.AssetManager,this,e),this._layoutManager=Px.New(Px.LayoutManager,this),this._eventSheetManager=Px.New(Px.EventSheetManager,this),this._addonManager=Px.New(Px.AddonManager,this,e.wrapperComponentIds),this._collisionEngine=Px.New(Px.CollisionEngine,this),this._timelineManager=Px.New(Px.TimelineManager,this),this._transitionManager=Px.New(Px.TransitionManager,this),this._templateManager=Px.New(Px.TemplateManager,this),this._flowchartManager=Px.New(Px.FlowchartManager,this),this._textIconManager=Px.New(Px.TextIconManager,{getIconSetMeta:e=>this._GetTextIconSetMeta(e),getIconSetContent:e=>this._GetTextIconSetContent(e)}),this._iconChangeHandlers=new Map,this._allObjectClasses=[],this._objectClassesByName=new Map,this._objectClassesBySid=new Map,this._familyCount=0,this._allContainers=[],this._allEffectLists=new Set,this._currentLayoutStack=[],this._instancesPendingCreate=[],this._instancesPendingDestroy=new Map,this._hasPendingInstances=!1,this._isFlushingPendingInstances=!1,this._objectCount=0,this._nextUid=0,this._instancesByUid=new Map,this._instancesPendingRelease=new Set,this._instancesPendingReleaseAffectedObjectClasses=new Set,this._objectReferenceTable=[],this._jsPropNameTable=[],this._canvasManager=null,this._uses3dFeatures=!1,this._framerateMode="vsync",this._sampling="trilinear",this._isPixelRoundingEnabled=!1,this._needRender=!0,this._pauseOnBlur=!1,this._isPausedOnBlur=!1,this._exportToVideo=null,this._tickCallbacks={normal:e=>{this._rafId=-1,this._ruafId=-1,this.Tick(e)},tickOnly:e=>{this._ruafId=-1,this.Tick(e,!1,"skip-render")},renderOnly:()=>{this._rafId=-1,this.Render()}},this._rafId=-1,this._ruafId=-1,this._tickCount=0,this._tickCountNoSave=0,this._hasStarted=!1,this._isInTick=!1,this._hasStartedTicking=!1,this._isLayoutFirstTick=!0,this._isAutoSuspendEnabled=!0,this._isPageVisibilitySuspended=!1,this._suspendCount=0,this._scheduleTriggersThrottle=new Px.PromiseThrottle(1),this._randomNumberCallback=()=>Math.random(),this._startTime=0,this._lastTickTime=0,this._dtRaw=0,this._dt1=0,this._dt=0,this._timeScale=1,this._maxDt=1/30,this._minDt=0,this._gameTime=Px.New(Px.KahanSum),this._gameTimeRaw=Px.New(Px.KahanSum),this._wallTime=Px.New(Px.KahanSum),this._instanceTimes=new Map,this._fpsFrameCount=-1,this._fpsLastTime=0,this._fps=0,this._tpsTickCount=-1,this._tps=0,this._mainThreadTimeCounter=0,this._mainThreadTime=0,this._isLoadingState=!1,this._saveToSlotName="",this._saveToJsonString=!1,this._loadFromSlotName="",this._loadFromJson=null,this._lastSaveJson="",this._projectStorage=null,this._savegamesStorage=null,this._dispatcher=Px.New(Px.Event.Dispatcher),this._domEventHandlers=new Map,this._pendingResponsePromises=new Map,this._nextDomResponseId=0,this._didRequestDeviceOrientationEvent=!1,this._didRequestDeviceMotionEvent=!1,this._isReadyToHandleEvents=!1,this._waitingToHandleEvents=[],this._eventObjects={pretick:Px.New(Px.Event,"pretick",!1),tick:Px.New(Px.Event,"tick",!1),tick2:Px.New(Px.Event,"tick2",!1),instancecreate:Px.New(Px.Event,"instancecreate",!1),instancedestroy:Px.New(Px.Event,"instancedestroy",!1),beforelayoutchange:Px.New(Px.Event,"beforelayoutchange",!1),layoutchange:Px.New(Px.Event,"layoutchange",!1)},this._eventObjects.instancecreate.instance=null,this._eventObjects.instancedestroy.instance=null,this._userScriptDispatcher=Px.New(Px.Event.Dispatcher),this._userScriptEventObjects=null;const t=(e,t)=>Px.BehaviorInstance.SortByTickSequence(this,e,t);this._behInstsToTick=Px.New(Px.RedBlackSet,t),this._behInstsToPostTick=Px.New(Px.RedBlackSet,t),this._behInstsToTick2=Px.New(Px.RedBlackSet,t),this._jobScheduler=Px.New(Px.JobSchedulerRuntime,this,e.jobScheduler),e.canvas&&(this._canvasManager=Px.New(Px.CanvasManager,this)),this._messagePort.onmessage=e=>this._OnMessageFromDOM(e.data),this.AddDOMComponentMessageHandler("runtime","visibilitychange",(e=>this._OnVisibilityChange(e))),this.AddDOMComponentMessageHandler("runtime","wrapper-extension-message",(e=>this._OnWrapperExtensionMessage(e))),this.AddDOMComponentMessageHandler("runtime","get-remote-preview-status-info",(()=>this._GetRemotePreviewStatusInfo())),this.AddDOMComponentMessageHandler("runtime","js-invoke-function",(e=>this._InvokeFunctionFromJS(e))),this.AddDOMComponentMessageHandler("runtime","go-to-last-error-script",self.goToLastErrorScript),this.AddDOMComponentMessageHandler("runtime","offline-audio-render-completed",(e=>this._OnOfflineAudioRenderCompleted(e))),this._dispatcher.addEventListener("window-blur",(e=>this._OnWindowBlur(e))),this._dispatcher.addEventListener("window-focus",(()=>this._OnWindowFocus())),this._timelineManager.AddRuntimeListeners(),this._templateManager.AddRuntimeListeners(),this._iRuntime=null,this._interfaceMap=new WeakMap,this._commonScriptInterfaces={keyboard:null,mouse:null,touch:null,timelineController:null},this._instancesNeedingAfterLoadMap=new WeakMap,this._instancesNeedingAfterLoadArray=[]}static Create(e){return Px.New(Px.Runtime,e)}Release(){Px.clearArray(this._allObjectClasses),this._objectClassesByName.clear(),this._objectClassesBySid.clear(),this._layoutManager.Release(),this._layoutManager=null,this._eventSheetManager.Release(),this._eventSheetManager=null,this._addonManager.Release(),this._addonManager=null,this._assetManager.Release(),this._assetManager=null,this._collisionEngine.Release(),this._collisionEngine=null,this._timelineManager.Release(),this._timelineManager=null,this._transitionManager.Release(),this._transitionManager=null,this._templateManager.Release(),this._templateManager=null,this._flowchartManager.Release(),this._flowchartManager=null,this._textIconManager.Release(),this._textIconManager=null,this._canvasManager&&(this._canvasManager.Release(),this._canvasManager=null),this._dispatcher.Release(),this._dispatcher=null,this._tickEvent=null}_OnMessageFromDOM(e){const t=e.type;if("event"===t)this._OnEventFromDOM(e);else{if("result"!==t)throw new Error(`unknown message '${t}'`);this._OnResultFromDOM(e)}}_OnEventFromDOM(e){if(!this._isReadyToHandleEvents)return void this._waitingToHandleEvents.push(e);const t=e.component,s=e.handler,n=e.data,i=e.dispatchOpts,r=!(!i||!i.dispatchRuntimeEvent),a=!(!i||!i.dispatchUserScriptEvent),o=e.responseId;if("runtime"===t){if(r){const e=new Px.Event(s);e.data=n,this._dispatcher.dispatchEventAndWaitAsyncSequential(e)}if(a){const e=new Px.Event(s,!0);for(const[t,s]of Object.entries(n))e[t]=s;this.DispatchUserScriptEvent(e)}}const l=this._domEventHandlers.get(t);if(!l)return void(r||a||console.warn(`[Runtime] No DOM event handlers for component '${t}'`));const c=l.get(s);if(!c)return void(r||a||console.warn(`[Runtime] No DOM handler '${s}' for component '${t}'`));let h=null;try{h=c(n)}catch(e){return console.error(`Exception in '${t}' handler '${s}':`,e),void(null!==o&&this._PostResultToDOM(o,!1,""+e))}null!==o&&(h&&h.then?h.then((e=>this._PostResultToDOM(o,!0,e))).catch((e=>{console.error(`Rejection from '${t}' handler '${s}':`,e),this._PostResultToDOM(o,!1,""+e)})):this._PostResultToDOM(o,!0,h))}_PostResultToDOM(e,t,s){this._messagePort.postMessage({type:"result",responseId:e,isOk:t,result:s})}_OnResultFromDOM(e){const t=e.responseId,s=e.isOk,n=e.result,i=this._pendingResponsePromises.get(t);s?i.resolve(n):i.reject(n),this._pendingResponsePromises.delete(t)}AddDOMComponentMessageHandler(e,t,s){let n=this._domEventHandlers.get(e);if(n||(n=new Map,this._domEventHandlers.set(e,n)),n.has(t))throw new Error(`[Runtime] Component '${e}' already has handler '${t}'`);n.set(t,s)}PostComponentMessageToDOM(e,t,s,n){this._messagePort.postMessage({type:"event",component:e,handler:t,data:s,responseId:null},n)}PostComponentMessageToDOMAsync(e,t,s,n){const i=this._nextDomResponseId++,r=new Promise(((e,t)=>{this._pendingResponsePromises.set(i,{resolve:e,reject:t})}));return this._messagePort.postMessage({type:"event",component:e,handler:t,data:s,responseId:i},n),r}SendWrapperExtensionMessage(e,t,s,n=-1){this.PostComponentMessageToDOM("runtime","send-wrapper-extension-message",{componentId:e,messageId:t,params:s,asyncId:n})}SendWrapperExtensionMessageAsync(e,t,s){const n=this._nextDomResponseId++,i=new Promise(((e,t)=>{this._pendingResponsePromises.set(n,{resolve:e,reject:t})}));return this.SendWrapperExtensionMessage(e,t,s,n),i}_OnWrapperExtensionMessage(e){if(-1!==e.asyncId){const t=e.asyncId;this._pendingResponsePromises.get(t).resolve(e.params),this._pendingResponsePromises.delete(t)}else this._OnEventFromDOM({component:"wrapper-extension:"+e.componentId,handler:e.messageId,data:e.params,responseId:null})}AddWrapperExtensionMessageHandler(e,t,s){this.AddDOMComponentMessageHandler("wrapper-extension:"+e,t,s)}HasWrapperComponentId(e){return this._addonManager.HasWrapperComponentId(e)}PostToDebugger(e){if(!this.IsDebug())throw new Error("not in debug mode");this.PostComponentMessageToDOM("runtime","post-to-debugger",e)}async Init(e){Px.CommonACES_SetRuntime(this),this.IsDebug()?await Ax.Init(this):self.C3Debugger&&self.C3Debugger.InitPreview(this);const t=await this._assetManager.FetchJson("data.json");if(await this._LoadDataJson(t),await this._InitialiseCanvas(e),this.IsPreview()||console.info("%cMade with Construct, the game and animation creation tool. Visit: https://www.construct.net","font-weight: bold"),this.GetWebGLRenderer()){const e=this.GetWebGLRenderer();console.info(`[C3 runtime] Hosted in ${this.IsInWorker()?"worker":"DOM"}, rendering with WebGL ${e.GetWebGLVersionNumber()} [${e.GetUnmaskedRenderer()}]`)}else this.GetWebGPURenderer()&&console.info(`[C3 runtime] Hosted in ${this.IsInWorker()?"worker":"DOM"}, rendering with WebGPU [${this.GetWebGPURenderer().GetAdapterInfoString()}]`);this.GetRenderer().HasMajorPerformanceCaveat()&&console.warn("[C3 runtime] The renderer indicates a major performance caveat. Software rendering may be in use. This can result in significantly degraded performance."),this._isReadyToHandleEvents=!0;for(const e of this._waitingToHandleEvents)this._OnEventFromDOM(e);Px.clearArray(this._waitingToHandleEvents),this._canvasManager&&this._canvasManager.StartLoadingScreen();for(const t of e.runOnStartupFunctions)this._additionalLoadPromises.push(this._RunOnStartupFunction(t));if(await Promise.all([this._assetManager.WaitForAllToLoad(),...this._additionalLoadPromises]),Px.clearArray(this._additionalLoadPromises),!this._assetManager.HasHadErrorLoading())return this._canvasManager&&await this._canvasManager.EndLoadingScreen(),await this._dispatcher.dispatchEventAndWaitAsync(new Px.Event("beforeruntimestart")),await this.Start(),this._messagePort.postMessage({type:"runtime-ready"}),this;this._canvasManager&&this._canvasManager.HideCordovaSplashScreen()}async _RunOnStartupFunction(e){try{await e(this._iRuntime)}catch(e){console.error("[C3 runtime] Error in runOnStartup function: ",e)}}async _LoadDataJson(e){const t=e.project;this._projectName=t[0],this._projectVersion=t[16],this._projectUniqueId=t[31],this._appId=t[38],this._exportTimestamp=t[36];const s=t[39]||"loading-logo.png";this._isPixelRoundingEnabled=!!t[9],this._originalViewportWidth=this._viewportWidth=t[10],this._originalViewportHeight=this._viewportHeight=t[11],this._collisionEngine._InitCollisionCellSize(this._originalViewportWidth,this._originalViewportHeight),this._parallaxXorigin=this._originalViewportWidth/2,this._parallaxYorigin=this._originalViewportHeight/2,this._framerateMode=t[37],this._uses3dFeatures=!!t[40],this._sampling=t[14],this._usesAnyBackgroundBlending=t[15],this._usesAnyCrossSampling=t[42],this._usesAnyDepthSampling=t[17],this._usesLoaderLayout=!!t[18],this._loaderStyle=t[19],this._nextUid=t[21],this._pauseOnBlur=t[22];const n=this._assetManager;if(n._SetFileStructure(t[45]),n._SetAudioFiles(t[7],t[25]),n._SetMediaSubfolder(t[8]),n._SetFontsSubfolder(t[32]),n._SetIconsSubfolder(t[28]),n._SetWebFonts(t[29]),0===this._loaderStyle){let e="";e="flat"===n.GetFileStructure()?n.GetIconsSubfolder()+s:s,e&&(this._loadingLogoAsset=n.LoadImage({url:e}))}this._canvasManager&&(this._canvasManager.SetFullscreenMode(Px.CanvasManager._FullscreenModeNumberToString(t[12])),this._canvasManager.SetFullscreenScalingQuality(t[23]?"high":"low"),this._canvasManager.SetMipmapsEnabled(0!==t[24]),this._canvasManager._SetGPUPowerPreference(t[34]),this._canvasManager._SetTextureAnisotropy(t[41]),this._canvasManager._SetWebGPUEnabled(t[13]),this._canvasManager._SetZAxisScale(t[30]),this._canvasManager._SetZDistances(t[46],t[47]),this._canvasManager._SetInitFieldOfView(t[26]),this._canvasManager._SetLimitedToWebGL1(t[48]),this._canvasManager._SetMultitexturingMode(t[50]));const i=t[43];i&&await this._LoadExportToVideoData(i),this._InitScriptInterfaces(),this._addonManager.CreateSystemPlugin(),this._objectReferenceTable=self.C3_GetObjectRefTable();const r=t[2];for(const e of r[1])this._addonManager.CreateBehavior(e);for(const e of r[0])this._addonManager.CreatePlugin(e);this._objectReferenceTable=self.C3_GetObjectRefTable(),this._LoadJsPropNameTable(),this._addonManager._InitAddonScriptInterfaces();for(const e of t[3]){const t=Px.ObjectClass.Create(this,this._allObjectClasses.length,e);this._allObjectClasses.push(t),this._objectClassesByName.set(t.GetName().toLowerCase(),t),this._objectClassesBySid.set(t.GetSID(),t)}for(const e of t[4])this._allObjectClasses[e[0]]._LoadFamily(e);for(const e of t[27]){const t=e.map((e=>this._allObjectClasses[e]));this._allContainers.push(Px.New(Px.Container,this,t))}this._InitObjectsScriptInterface();for(const e of this._allObjectClasses)e._OnAfterCreate();for(const e of t[5])this._layoutManager.Create(e);const a=t[1];if(a){const e=this._layoutManager.GetLayoutByName(a);e&&this._layoutManager.SetFirstLayout(e)}for(const e of t[35])this._transitionManager.Create(e);for(const e of t[33])this._timelineManager.Create(e);for(const e of t[44])this._templateManager.Create(e);this._templateManager.HasTemplates()||(this._templateManager.Release(),this._templateManager=null);for(const e of t[49])this._flowchartManager.Create(e);this._flowchartManager.HasFlowcharts()||(this._flowchartManager.Release(),this._flowchartManager=null);for(const e of t[6])this._eventSheetManager.Create(e);this._eventSheetManager._PostInit(),this._InitGlobalVariableScriptInterface(),Px.clearArray(this._objectReferenceTable),this.FlushPendingInstances();let o="any";const l=t[20];1===l?o="portrait":2===l&&(o="landscape"),this.PostComponentMessageToDOM("runtime","set-target-orientation",{targetOrientation:o})}async _LoadExportToVideoData(e){const t=e.format;"image-sequence"===t?this._exportToVideo=new self.C3ExportToImageSequence(this,e):"image-sequence-gif"===t?this._exportToVideo=new self.C3ExportToGIF(this,e):"webm"===t?this._exportToVideo=new self.C3ExportToWebMVideo(this,e):"mp4"===t&&(this._exportToVideo=new self.C3ExportToMP4Video(this,e)),this._framerateMode="unlimited-frame",this._canvasManager.SetFullscreenMode("off"),this._devicePixelRatio=1,self.devicePixelRatio=1,await this.PostComponentMessageToDOMAsync("runtime","set-exporting-to-video",{message:this._exportToVideo.GetExportingMessageForPercent(0),duration:this._exportToVideo.GetDuration()})}GetLoaderStyle(){return this._loaderStyle}IsExportToVideo(){return null!==this._exportToVideo}GetExportVideoDuration(){return this._exportToVideo.GetDuration()}GetExportVideoFramerate(){return this._exportToVideo.GetFramerate()}_InitExportToVideo(){return this._exportToVideo.Init({width:this._canvasManager.GetDeviceWidth(),height:this._canvasManager.GetDeviceHeight()})}_ExportToVideoAddFrame(){const e=this._tickCount/this.GetExportVideoFramerate();return this._exportToVideo.AddFrame(this._canvasManager.GetMainCanvas(),e)}_ExportToVideoAddKeyframe(){this._exportToVideo&&this._exportToVideo.AddKeyframe()}_OnOfflineAudioRenderCompleted(e){this._exportToVideo.OnOfflineAudioRenderCompleted(e)}_ExportToVideoFinish(){return this._exportToVideo.Finish()}IsFBInstantAvailable(){return this._isFBInstantAvailable}IsLoading(){return this._isLoading}AddLoadPromise(e){this._additionalLoadPromises.push(e)}SetUsingCreatePromises(e){this._isUsingCreatePromises=!!e}AddCreatePromise(e){this._isUsingCreatePromises&&this._additionalCreatePromises.push(e)}GetCreatePromises(){return this._additionalCreatePromises}_GetNextFamilyIndex(){return this._familyCount++}GetFamilyCount(){return this._familyCount}_AddEffectList(e){this._allEffectLists.add(e)}_RemoveEffectList(e){this._allEffectLists.delete(e)}_GetAllEffectLists(){return this._allEffectLists}async _InitialiseCanvas(e){this._canvasManager&&(await this._canvasManager.CreateCanvas(e),this._canvasManager.InitLoadingScreen(this._loaderStyle))}async Start(){this._hasStarted=!0,this._startTime=Date.now();let e=null;const t=new Promise((t=>e=t));if(this._usesLoaderLayout){for(const e of this._allObjectClasses)e.IsFamily()||e.IsOnLoaderLayout()||!e.IsWorldType()||e.OnCreate();(async()=>{await this._assetManager.WaitForAllToLoad(),await t,this._isLoading=!1,this._OnLoadFinished()})()}else this._isLoading=!1;this._assetManager.SetInitialLoadFinished(),this.IsDebug()&&Ax.RuntimeInit(Mx);for(const e of this._layoutManager.GetAllLayouts())e._CreateGlobalNonWorlds();this.IsExportToVideo()&&await this._InitExportToVideo();const s=this._layoutManager.GetFirstLayout();await s._Load(null,this.GetRenderer()),await s._StartRunning(!0),this._fpsLastTime=performance.now(),e(),this._usesLoaderLayout||this._OnLoadFinished(),(await this.PostComponentMessageToDOMAsync("runtime","before-start-ticking")).isSuspended&&!this.IsExportToVideo()?(this._suspendCount++,this._isPageVisibilitySuspended=!0):this.Tick()}_OnLoadFinished(){this.Trigger(Px.Plugins.System.Cnds.OnLoadFinished,null,null),this.PostComponentMessageToDOM("runtime","register-sw")}GetObjectReference(e){e=Math.floor(e);const t=this._objectReferenceTable;if(e<0||e>=t.length)throw new Error("invalid object reference");return t[e]}_LoadJsPropNameTable(){for(const e of self.C3_JsPropNameTable){const t=Px.first(Object.keys(e));this._jsPropNameTable.push(t)}}GetJsPropName(e){e=Math.floor(e);const t=this._jsPropNameTable;if(e<0||e>=t.length)throw new Error("invalid prop reference");return t[e]}HasDOM(){return this._hasDom}IsHeadless(){return this._isHeadless}IsInWorker(){return this._isInWorker}GetRuntimeBaseURL(){return this._runtimeBaseUrl}GetPreviewURL(){return this._previewUrl}GetEventSheetManager(){return this._eventSheetManager}GetEventStack(){return this._eventSheetManager.GetEventStack()}GetCurrentEventStackFrame(){return this._eventSheetManager.GetCurrentEventStackFrame()}GetCurrentEvent(){return this._eventSheetManager.GetCurrentEvent()}GetCurrentCondition(){return this._eventSheetManager.GetCurrentCondition()}IsCurrentConditionFirst(){return 0===this.GetCurrentEventStackFrame().GetConditionIndex()}GetCurrentAction(){return this._eventSheetManager.GetCurrentAction()}GetAddonManager(){return this._addonManager}GetSystemPlugin(){return this._addonManager.GetSystemPlugin()}GetObjectClassByIndex(e){if((e=Math.floor(e))<0||e>=this._allObjectClasses.length)throw new RangeError("invalid index");return this._allObjectClasses[e]}GetObjectClassByName(e){return this._objectClassesByName.get(e.toLowerCase())||null}GetObjectClassBySID(e){return this._objectClassesBySid.get(e)||null}GetSingleGlobalObjectClassByCtor(e){const t=Px.AddonManager.GetPluginByConstructorFunction(e);return t?t.GetSingleGlobalObjectClass():null}GetAllObjectClasses(){return this._allObjectClasses}*allInstances(){for(const e of this._allObjectClasses)e.IsFamily()||(yield*e.instances())}Dispatcher(){return this._dispatcher}UserScriptDispatcher(){return this._userScriptDispatcher}DispatchUserScriptEvent(e){e.runtime=this.GetIRuntime();const t=this.IsDebug()&&!this._eventSheetManager.IsInEventEngine();t&&Ax.StartMeasuringScriptTime(),this._userScriptDispatcher.dispatchEvent(e),t&&Ax.AddScriptTime()}DispatchUserScriptEventAsyncWait(e){return e.runtime=this.GetIRuntime(),this._userScriptDispatcher.dispatchEventAndWaitAsync(e)}GetOriginalViewportWidth(){return this._originalViewportWidth}GetOriginalViewportHeight(){return this._originalViewportHeight}SetOriginalViewportSize(e,t){if(this._originalViewportWidth===e&&this._originalViewportHeight===t)return;this._originalViewportWidth=e,this._originalViewportHeight=t;const s=this.GetLayoutManager();s.SetAllLayerProjectionChanged(),s.SetAllLayerMVChanged()}GetViewportWidth(){return this._viewportWidth}GetViewportHeight(){return this._viewportHeight}SetViewportSize(e,t){if(this._viewportWidth===e&&this._viewportHeight===t)return;this._viewportWidth=e,this._viewportHeight=t;const s=this.GetLayoutManager();s.SetAllLayerProjectionChanged(),s.SetAllLayerMVChanged()}_SetDevicePixelRatio(e){this.IsExportToVideo()||(this._devicePixelRatio=e)}GetDevicePixelRatio(){return this._devicePixelRatio}GetParallaxXOrigin(){return this._parallaxXorigin}GetParallaxYOrigin(){return this._parallaxYorigin}GetCanvasManager(){return this._canvasManager}GetDrawWidth(){return this._canvasManager?this._canvasManager.GetDrawWidth():this._viewportWidth}GetDrawHeight(){return this._canvasManager?this._canvasManager.GetDrawHeight():this._viewportHeight}GetRenderScale(){return this._canvasManager?this._canvasManager.GetRenderScale():1}GetDisplayScale(){return this._canvasManager?this._canvasManager.GetDisplayScale():1}GetEffectLayerScaleParam(){return this._canvasManager?this._canvasManager.GetEffectLayerScaleParam():1}GetEffectDevicePixelRatioParam(){return this._canvasManager?this._canvasManager.GetEffectDevicePixelRatioParam():1}GetCanvasClientX(){return this._canvasManager?this._canvasManager.GetCanvasClientX():0}GetCanvasClientY(){return this._canvasManager?this._canvasManager.GetCanvasClientY():0}GetCanvasCssWidth(){return this._canvasManager?this._canvasManager.GetCssWidth():0}GetCanvasCssHeight(){return this._canvasManager?this._canvasManager.GetCssHeight():0}GetFullscreenMode(){return this._canvasManager?this._canvasManager.GetFullscreenMode():"off"}GetAdditionalRenderTarget(e){return this._canvasManager?this._canvasManager.GetAdditionalRenderTarget(e):null}ReleaseAdditionalRenderTarget(e){this._canvasManager&&this._canvasManager.ReleaseAdditionalRenderTarget(e)}UsesAnyBackgroundBlending(){return this._usesAnyBackgroundBlending}UsesAnyCrossSampling(){return this._usesAnyCrossSampling}UsesAnyDepthSampling(){return this._usesAnyDepthSampling}GetGPUUtilisation(){return this._canvasManager?this._canvasManager.GetGPUUtilisation():NaN}IsLinearSampling(){return"nearest"!==this.GetSampling()}GetFramerateMode(){return this._framerateMode}_SetFramerateMode(e){this._framerateMode!==e&&(this._framerateMode=e,-1===this._rafId&&-1===this._ruafId||(this._CancelAnimationFrame(),this._RequestAnimationFrame()))}GetSampling(){return this._sampling}UsesLoaderLayout(){return this._usesLoaderLayout}GetLoadingLogoAsset(){return this._loadingLogoAsset}ReleaseLoadingLogoAsset(){this._loadingLogoAsset&&(this._loadingLogoAsset.ReleaseTexture(),this._loadingLogoAsset.Release(),this._loadingLogoAsset=null)}GetLayoutManager(){return this._layoutManager}GetMainRunningLayout(){return this._layoutManager.GetMainRunningLayout()}GetTimelineManager(){return this._timelineManager}GetTransitionManager(){return this._transitionManager}GetTemplateManager(){return this._templateManager}GetFlowchartManager(){return this._flowchartManager}GetAssetManager(){return this._assetManager}LoadImage(e){return this._assetManager.LoadImage(e)}CreateInstance(e,t,s,n,i,r){if(r&&this._templateManager){if(e instanceof Px.ObjectClass&&e.IsFamily()){const a=e.GetFamilyMembers(),o=Math.floor(this.Random()*a.length);return this.CreateInstance(a[o],t,s,n,i,r)}const a=this._templateManager.GetTemplateData(e,r);if(a){const e=this.CreateInstanceFromData(a,t,!1,s,n,!1,i,void 0,i);return this._templateManager.MapInstanceToTemplateName(e,r),e}}return this.CreateInstanceFromData(e,t,!1,s,n,!1,i,void 0,i)}CreateInstanceFromData(e,t,s,n,i,r,a,o,l){let c=null,h=null;if(e instanceof Px.ObjectClass){if(h=e,h.IsFamily()){const e=h.GetFamilyMembers();h=e[Math.floor(this.Random()*e.length)]}c=h.GetDefaultInstanceData()}else c=e,h=this.GetObjectClassByIndex(c[1]);const _=h.GetPlugin().IsWorldType();if(this._isLoading&&_&&!h.IsOnLoaderLayout())return null;const u=t;let d;_||(t=null),d=s&&!r&&c&&!this._instancesByUid.has(c[2])?c[2]:this._nextUid++;const p=c?c[0]:null,f=Px.New(Px.Instance,{runtime:this,objectType:h,layer:t,worldData:p,instVarData:c?c[3]:null,uid:d,tags:c?c[6]:null});this._instancesByUid.set(d,f);let m=null;if(_&&(m=f.GetWorldInfo(),void 0!==n&&void 0!==i&&(m.SetX(n),m.SetY(i)),h._SetAnyCollisionCellChanged(!0)),t&&(l||t._AddInstance(f,!0),t.GetLayout().MaybeLoadTexturesFor(h)),this._objectCount++,h.IsInContainer()&&!s&&!r){const e=new Set;for(const t of h.GetContainer().objectTypes()){if(t===h)continue;const s=this._MaybeGetChildInstanceForObjectTypeData(t,m,e);if(s){const e=this.CreateInstanceFromData(s,u,!1,m?m.GetX():n,m?m.GetY():i,!0,!1,void 0,l);f._AddSibling(e)}else{const e=this.CreateInstanceFromData(t,u,!1,m?m.GetX():n,m?m.GetY():i,!0,!1,void 0,l);f._AddSibling(e)}}for(const e of f.siblings()){e._AddSibling(f);for(const t of f.siblings())e!==t&&e._AddSibling(t)}}if(_&&!s&&a&&this._CreateChildInstancesFromData(f,p,m,t,n,i,l),h.IsInContainer()&&!s&&!r&&a)for(const e of f.siblings()){const s=e.GetWorldInfo();if(!s)continue;const n=e.GetPlugin(),i=e.GetObjectClass().GetDefaultInstanceData()[0];n.IsWorldType()?this._CreateChildInstancesFromData(e,i,s,t,s.GetX(),s.GetY(),l):this._CreateChildInstancesFromData(e,i,s,t,void 0,void 0,l)}if(!r&&a){void 0===n&&(n=p[0]),void 0===i&&(i=p[1]);const e=m.GetTopParent(),t=n-m.GetX()+e.GetX(),s=i-m.GetY()+e.GetY();e.SetXY(t,s)}h._SetIIDsStale();const g=c?Px.cloneArray(c[5]):null,I=c?c[4].map((e=>Px.cloneArray(e))):null,S=_&&p&&p[13];if(S&&f._SetHasTilemap(),f._CreateSdkInstance(g,I),S){const e=p[13];f.GetSdkInstance().LoadTilemapData(e[2],e[0],e[1])}this._instancesPendingCreate.push(f),this._hasPendingInstances=!0,this.IsDebug()&&Ax.InstanceCreated(f);const y=this._eventObjects.instancecreate;return y.instance=f,this._dispatcher.dispatchEvent(y),f}_GetInstanceData(e){const t=e[0],s=e[1],n=e[2],i=e[6];return i||this._layoutManager.GetLayoutBySID(t).GetLayer(s).GetInitialInstanceData(n)}_MaybeGetChildInstanceForObjectTypeData(e,t,s){const n=t?.GetSceneGraphChildrenExportData()??[];for(const t of n){const n=this._GetInstanceData(t),i=!!t[4],r=this.GetObjectClassByIndex(n[1]);if(!s.has(n)&&e===r&&i)return s.add(n),n}}_CreateChildInstancesFromData(e,t,s,n,i,r,a){const o=s.GetSceneGraphZIndexExportData(),l=s.GetSceneGraphChildrenExportData();if(e.GetWorldInfo().SetSceneGraphZIndex(o),!l)return;void 0===i&&(i=t[0]),void 0===r&&(r=t[1]);const c=new Set,h=t[0],_=t[1];for(const t of l){const s=t[0],o=t[1],l=t[2],u=t[3],d=!!t[4],p=t[5],f=t[6];let m;m=f||this._layoutManager.GetLayoutBySID(s).GetLayer(o).GetInitialInstanceData(l);const g=this.GetObjectClassByIndex(m[1]),I=e.HasSibling(g),S=c.has(g);if(I&&!S&&d){const t=e.GetSibling(g);t.GetWorldInfo().Init(m[0]);const s=i+m[0][0]-h,n=r+m[0][1]-_;t.GetWorldInfo().SetXY(s,n),t.GetWorldInfo().SetSceneGraphZIndex(p),e.AddChild(t,{transformX:!!(1&u),transformY:!!(u>>1&1),transformWidth:!!(u>>2&1),transformHeight:!!(u>>3&1),transformAngle:!!(u>>4&1),destroyWithParent:!!(u>>5&1),transformZElevation:!!(u>>6&1),transformOpacity:!!(u>>7&1),transformVisibility:!!(u>>8&1)}),c.add(g)}else{const t=i+m[0][0]-h,s=r+m[0][1]-_,o=this.CreateInstanceFromData(m,n,!1,t,s,!1,!0,e,a);o.GetWorldInfo().SetSceneGraphZIndex(p),e.AddChild(o,{transformX:!!(1&u),transformY:!!(u>>1&1),transformWidth:!!(u>>2&1),transformHeight:!!(u>>3&1),transformAngle:!!(u>>4&1),destroyWithParent:!!(u>>5&1),transformZElevation:!!(u>>6&1),transformOpacity:!!(u>>7&1),transformVisibility:!!(u>>8&1)})}}}DestroyInstance(e){if(this._instancesPendingRelease.has(e))return;const t=e.GetObjectClass();let s=this._instancesPendingDestroy.get(t);if(s){if(s.has(e))return;s.add(e)}else s=new Set,s.add(e),this._instancesPendingDestroy.set(t,s);if(this.IsDebug()&&Ax.InstanceDestroyed(e),e._MarkDestroyed(),this._hasPendingInstances=!0,e.IsInContainer())for(const t of e.siblings())this.DestroyInstance(t);for(const t of e.children())t.GetDestroyWithParent()&&this.DestroyInstance(t);if(!this._layoutManager.IsEndingLayout()&&!this._isLoadingState){const t=this.GetEventSheetManager();t.BlockFlushingInstances(!0),e._TriggerOnDestroyed(),t.BlockFlushingInstances(!1)}e._FireDestroyedScriptEvents(this._layoutManager.IsEndingLayout())}FlushPendingInstances(){this._hasPendingInstances&&(this._isFlushingPendingInstances=!0,this._FlushInstancesPendingCreate(),this._FlushInstancesPendingDestroy(),this._isFlushingPendingInstances=!1,this._hasPendingInstances=!1,this.UpdateRender())}_FlushInstancesPendingCreate(){for(const e of this._instancesPendingCreate){const t=e.GetObjectClass();t._AddInstance(e);for(const s of t.GetFamilies())s._AddInstance(e),s._SetIIDsStale()}Px.clearArray(this._instancesPendingCreate)}_FlushInstancesPendingDestroy(){this._dispatcher.SetDelayRemoveEventsEnabled(!0);for(const[e,t]of this._instancesPendingDestroy.entries())this._FlushInstancesPendingDestroyForObjectClass(e,t),t.clear();this._instancesPendingDestroy.clear(),this._dispatcher.SetDelayRemoveEventsEnabled(!1)}_FlushInstancesPendingDestroyForObjectClass(e,t){for(const e of t){const t=this._eventObjects.instancedestroy;t.instance=e,this._dispatcher.dispatchEvent(t),this._instancesByUid.delete(e.GetUID()),this._instanceTimes.delete(e);const s=e.GetWorldInfo();s&&(s._RemoveFromCollisionCells(),s._RemoveFromRenderCells(),s._MarkDestroyed()),this._instancesPendingRelease.add(e),this._objectCount--}Px.arrayRemoveAllInSet(e.GetInstances(),t),e._SetIIDsStale(),this._instancesPendingReleaseAffectedObjectClasses.add(e);for(const s of e.GetFamilies())Px.arrayRemoveAllInSet(s.GetInstances(),t),s._SetIIDsStale(),this._instancesPendingReleaseAffectedObjectClasses.add(s);if(e.GetPlugin().IsWorldType()){const e=new Set([...t].map((e=>e.GetWorldInfo().GetLayer())));for(const s of e)s._RemoveAllInstancesInSet(t)}}_GetInstancesPendingCreate(){return this._instancesPendingCreate}*instancesPendingCreateForObjectClass(e){for(const t of this._GetInstancesPendingCreate())e.IsFamily()?t.GetObjectClass().BelongsToFamily(e)&&(yield t):t.GetObjectClass()===e&&(yield t)}_GetNewUID(){return this._nextUid++}_MapInstanceByUID(e,t){this._instancesByUid.set(e,t)}_SetAutoSuspendEnabled(e){e=!!e,this._isAutoSuspendEnabled!==e&&(this._isAutoSuspendEnabled=!!e,this._isAutoSuspendEnabled&&this._isPageVisibilitySuspended&&(this.SetSuspended(!1),this._isPageVisibilitySuspended=!1))}_IsAutoSuspendEnabled(){return this._isAutoSuspendEnabled}_OnRendererContextLost(){this._dispatcher.dispatchEvent(Px.New(Px.Event,"renderercontextlost")),this.SetSuspended(!0);for(const e of this._allObjectClasses)!e.IsFamily()&&e.HasLoadedTextures()&&e.ReleaseTextures();const e=this.GetMainRunningLayout();e&&e._OnRendererContextLost(),Px.ImageInfo.OnRendererContextLost(),Px.ImageAsset.OnRendererContextLost()}async _OnRendererContextRestored(){await this.GetMainRunningLayout()._Load(null,this.GetRenderer()),this._dispatcher.dispatchEvent(Px.New(Px.Event,"renderercontextrestored")),this.SetSuspended(!1),this.UpdateRender()}_OnVisibilityChange(e){if(!this._isAutoSuspendEnabled)return;const t=e.hidden;this.SetSuspended(t),this._isPageVisibilitySuspended=t,t||this.UpdateRender()}_OnWindowBlur(e){this.IsPreview()&&this._pauseOnBlur&&!Px.Platform.IsMobile&&(e.data.parentHasFocus||(this.SetSuspended(!0),this._isPausedOnBlur=!0))}_OnWindowFocus(){this._isPausedOnBlur&&(this.SetSuspended(!1),this._isPausedOnBlur=!1)}_RequestAnimationFrame(){const e=this._tickCallbacks;"vsync"===this._framerateMode?-1===this._rafId&&(this._rafId=self.requestAnimationFrame(e.normal)):"unlimited-tick"===this._framerateMode?(-1===this._ruafId&&(this._ruafId=Px.RequestUnlimitedAnimationFrame(e.tickOnly)),-1===this._rafId&&(this._rafId=self.requestAnimationFrame(e.renderOnly))):-1===this._ruafId&&(this._ruafId=Px.RequestUnlimitedAnimationFrame(e.normal))}_CancelAnimationFrame(){-1!==this._rafId&&(self.cancelAnimationFrame(this._rafId),this._rafId=-1),-1!==this._ruafId&&(Px.CancelUnlimitedAnimationFrame(this._ruafId),this._ruafId=-1)}IsSuspended(){return this._suspendCount>0}SetSuspended(e){if(this.IsExportToVideo())return;const t=this.IsSuspended();this._suspendCount+=e?1:-1,this._suspendCount<0&&(this._suspendCount=0);const s=this.IsSuspended();if(!t&&s)console.log("[Construct] Suspending"),this._CancelAnimationFrame(),this._dispatcher.dispatchEvent(Px.New(Px.Event,"suspend")),this.DispatchUserScriptEvent(Px.New(Px.Event,"suspend")),this.Trigger(Px.Plugins.System.Cnds.OnSuspend,null,null);else if(t&&!s){console.log("[Construct] Resuming");const e=performance.now();this._lastTickTime=e,this._fpsLastTime=e,this._fpsFrameCount=0,this._fps=0,this._tpsTickCount=0,this._tps=0,this._mainThreadTime=0,this._mainThreadTimeCounter=0,this._dispatcher.dispatchEvent(Px.New(Px.Event,"resume")),this.DispatchUserScriptEvent(Px.New(Px.Event,"resume")),this.Trigger(Px.Plugins.System.Cnds.OnResume,null,null),this.HitBreakpoint()||this.Tick(e)}}_AddBehInstToTick(e){this._behInstsToTick.Add(e)}_AddBehInstToPostTick(e){this._behInstsToPostTick.Add(e)}_AddBehInstToTick2(e){this._behInstsToTick2.Add(e)}_RemoveBehInstToTick(e){this._behInstsToTick.Remove(e)}_RemoveBehInstToPostTick(e){this._behInstsToPostTick.Remove(e)}_RemoveBehInstToTick2(e){this._behInstsToTick2.Remove(e)}_CallBehaviorTickMethod(e,t){const s=t?performance.now():0;let n;return e instanceof Dx?(n=e._tick(),t&&Ax.AddIndividualBehaviorTickTime(e.behavior,performance.now()-s)):(n=e.Tick(),t&&Ax.AddIndividualBehaviorTickTime(e.GetBehavior(),performance.now()-s)),n}_BehaviorTick(){const e=this.IsDebug();this._behInstsToTick.SetQueueingEnabled(!0);for(const t of this._behInstsToTick)this._CallBehaviorTickMethod(t,e);this._behInstsToTick.SetQueueingEnabled(!1)}_CallBehaviorPostTickMethod(e,t){const s=t?performance.now():0;let n;return e instanceof Dx?(n=e._postTick(),t&&Ax.AddIndividualBehaviorTickTime(e.behavior,performance.now()-s)):(n=e.PostTick(),t&&Ax.AddIndividualBehaviorTickTime(e.GetBehavior(),performance.now()-s)),n}_BehaviorPostTick(){const e=this.IsDebug();this._behInstsToPostTick.SetQueueingEnabled(!0);for(const t of this._behInstsToPostTick)this._CallBehaviorPostTickMethod(t,e);this._behInstsToPostTick.SetQueueingEnabled(!1)}_CallBehaviorTick2Method(e,t){const s=t?performance.now():0;let n;return e instanceof Dx?(n=e._tick2(),t&&Ax.AddIndividualBehaviorTickTime(e.behavior,performance.now()-s)):(n=e.Tick2(),t&&Ax.AddIndividualBehaviorTickTime(e.GetBehavior(),performance.now()-s)),n}_BehaviorTick2(){const e=this.IsDebug();this._behInstsToTick2.SetQueueingEnabled(!0);for(const t of this._behInstsToTick2)this._CallBehaviorTick2Method(t,e);this._behInstsToTick2.SetQueueingEnabled(!1)}*_DebugBehaviorTick(){const e=this.IsDebug();this._behInstsToTick.SetQueueingEnabled(!0);for(const t of this._behInstsToTick){const s=this._CallBehaviorTickMethod(t,e);Px.IsIterator(s)&&(yield*s)}this._behInstsToTick.SetQueueingEnabled(!1)}*_DebugBehaviorPostTick(){const e=this.IsDebug();this._behInstsToPostTick.SetQueueingEnabled(!0);for(const t of this._behInstsToPostTick){const s=this._CallBehaviorPostTickMethod(t,e);Px.IsIterator(s)&&(yield*s)}this._behInstsToPostTick.SetQueueingEnabled(!1)}*_DebugBehaviorTick2(){const e=this.IsDebug();this._behInstsToTick2.SetQueueingEnabled(!0);for(const t of this._behInstsToTick2){const s=this._CallBehaviorTick2Method(t,e);Px.IsIterator(s)&&(yield*s)}this._behInstsToTick2.SetQueueingEnabled(!1)}async Tick(e,t,s){this._hasStartedTicking=!0;const n="background-wake"===s,i="background-wake"!==s&&"skip-render"!==s,r=this.GetLayoutManager(),a=this.GetCanvasManager();if(!this._hasStarted||this.IsSuspended()&&!t&&!n)return;const o=performance.now();this._isInTick=!0,this._MeasureDt(e||0),this._tpsTickCount++,this._ReleasePendingInstances();const l=this.Step_BeforePreTick();this.IsDebugging()&&await l;const c=this._dispatcher.dispatchEventAndWait_AsyncOptional(this._eventObjects.pretick);c instanceof Promise&&await c,this.DispatchUserScriptEvent(this._userScriptEventObjects.pretick);const h=this.Step_AfterPreTick();this.IsDebugging()&&await h,this._NeedsHandleSaveOrLoad()&&await this._HandleSaveOrLoad(),r.IsPendingChangeMainLayout()&&await this._MaybeChangeLayout();const _=this.Step_RunEventsEtc();this.IsDebugging()&&await _;const u=r.GetMainRunningLayout(),d=u._GetPendingSetHTMLLayerCount();let p=!1;if(-1!==d&&(u._ResetPendingHTMLLayerCount(),a.GetHTMLLayerCount()!==d)){const e=this.GetCanvasManager().SetHTMLLayerCount(d);this.IsInWorker()&&(p=!0,await e)}this.PostComponentMessageToDOM("canvas","update-html-layer-dom-state",{layersDomState:u._GetRootLayers().filter((e=>e.IsHTMLElementsLayer())).map((e=>e._GetHTMLLayerDOMState()))}),i&&this.Render(),p&&this.PostComponentMessageToDOM("canvas","cleanup-html-layers"),this.IsExportToVideo()&&(await this._ExportToVideoAddFrame(),this.GetGameTime()>=this.GetExportVideoDuration())?this._ExportToVideoFinish():(this.IsSuspended()||n||this._RequestAnimationFrame(),this._tickCount++,this._tickCountNoSave++,this._isInTick=!1,this._mainThreadTimeCounter+=performance.now()-o)}async Step_BeforePreTick(){const e=this._eventSheetManager,t=this.IsDebug();this.FlushPendingInstances(),e.BlockFlushingInstances(!0),this.PushCurrentLayout(this.GetMainRunningLayout()),t&&Ax.StartMeasuringTime(),this.IsDebugging()?await e.DebugRunScheduledWaits():e.RunScheduledWaits(),t&&Ax.AddEventsTime(),this.PopCurrentLayout(),e.BlockFlushingInstances(!1),this.FlushPendingInstances(),e.BlockFlushingInstances(!0)}async Step_AfterPreTick(){const e=this._eventSheetManager,t=this.IsDebug(),s=this.IsDebugging(),n=this._dispatcher,i=this._eventObjects,r=this._userScriptEventObjects;t&&Ax.StartMeasuringTime(),s?await this.DebugIterateAndBreak(this._DebugBehaviorTick()):this._BehaviorTick(),s?await this.DebugIterateAndBreak(this._DebugBehaviorPostTick()):this._BehaviorPostTick(),t&&Ax.AddBehaviorTotalTickTime(),t&&Ax.StartMeasuringTime(),s?await this.DebugFireGeneratorEventAndBreak(i.tick):n.dispatchEvent(i.tick),t&&Ax.AddPluginTotalTickTime(),e.BlockFlushingInstances(!1),this.DispatchUserScriptEvent(r.tick)}async Step_RunEventsEtc(){const e=this._eventSheetManager,t=this._dispatcher,s=this._eventObjects,n=this._userScriptEventObjects,i=this.IsDebug(),r=this.IsDebugging();i&&Ax.StartMeasuringTime(),r?await e.DebugRunEvents(this._layoutManager):e.RunEvents(this._layoutManager),i&&Ax.AddEventsTime(),this._collisionEngine.ClearRegisteredCollisions(),this._ReleasePendingInstances(),this._isLayoutFirstTick=!1,e.BlockFlushingInstances(!0),i&&Ax.StartMeasuringTime(),r?await this.DebugIterateAndBreak(this._DebugBehaviorTick2()):this._BehaviorTick2(),i&&Ax.AddBehaviorTotalTickTime(),i&&Ax.StartMeasuringTime(),r?await this.DebugFireGeneratorEventAndBreak(s.tick2):t.dispatchEvent(s.tick2),i&&Ax.AddPluginTotalTickTime(),e.BlockFlushingInstances(!1),this.DispatchUserScriptEvent(n.tick2),r&&await e.RunQueuedDebugTriggersAsync(),this.FlushPendingInstances(),this._ReleasePendingInstances()}_ReleasePendingInstances(){if(0===this._instancesPendingRelease.size)return;const e=this._dispatcher;e.SetDelayRemoveEventsEnabled(!0);for(const e of this._instancesPendingReleaseAffectedObjectClasses)e.GetSolStack().RemoveInstances(this._instancesPendingRelease);this._instancesPendingReleaseAffectedObjectClasses.clear(),this._eventSheetManager._OnInstancesReleased(this._instancesPendingRelease);for(const e of this._instancesPendingRelease)e.Release();this._instancesPendingRelease.clear(),e.SetDelayRemoveEventsEnabled(!1)}async _MaybeChangeLayout(){const e=this.GetLayoutManager();let t=0;for(;e.IsPendingChangeMainLayout()&&t++<10;)await this._DoChangeLayout(e.GetPendingChangeMainLayout())}_MeasureDt(e){let t=0;this.IsExportToVideo()?(t=1/this.GetExportVideoFramerate(),this._dtRaw=t,this._dt1=t):0!==this._lastTickTime&&(t=Math.max(e-this._lastTickTime,0)/1e3,t>.5&&(t=0),this._dtRaw=t,this._dt1=Px.clamp(t,this._minDt,this._maxDt)),this._lastTickTime=e,this._dt=this._dt1*this._timeScale,this._gameTime.Add(this._dt),this._gameTimeRaw.Add(t*this._timeScale),this._wallTime.Add(this._dt1);for(const[e,t]of this._instanceTimes)t.Add(this._dt1*e.GetTimeScale());this._canvasManager&&this._canvasManager._UpdateTick(),e-this._fpsLastTime>=1e3&&(this._fpsLastTime+=1e3,e-this._fpsLastTime>=1e3&&(this._fpsLastTime=e),this._fps=this._fpsFrameCount,this._fpsFrameCount=0,this._tps=this._tpsTickCount,this._tpsTickCount=0,this._mainThreadTime=Math.min(this._mainThreadTimeCounter/1e3,1),this._mainThreadTimeCounter=0,this._canvasManager&&this._canvasManager._Update1sFrameRange(),this._collisionEngine._Update1sStats(),this.IsDebug()&&Ax.Update1sPerfStats())}_SetTrackingInstanceTime(e,t){if(t){if(!this._instanceTimes.has(e)){const t=Px.New(Px.KahanSum);t.Copy(this._gameTime),this._instanceTimes.set(e,t)}}else this._instanceTimes.delete(e)}_GetInstanceGameTime(e){const t=this._instanceTimes.get(e);return t?t.Get():this.GetGameTime()}async _DoChangeLayout(e){const t=this._dispatcher,s=this.GetLayoutManager().GetMainRunningLayout();await s._StopRunning(),s._Unload(e,this.GetRenderer()),s===e&&this._eventSheetManager.ClearAllScheduledWaits(),this._collisionEngine.ClearRegisteredCollisions(),this._ReleasePendingInstances(),t.dispatchEvent(this._eventObjects.beforelayoutchange),Px.Asyncify.SetHighThroughputMode(!0),await e._Load(s,this.GetRenderer()),Px.Asyncify.SetHighThroughputMode(!1),await e._StartRunning(!1),t.dispatchEvent(this._eventObjects.layoutchange),this.UpdateRender(),this._isLayoutFirstTick=!0,this.FlushPendingInstances(),this._ExportToVideoAddKeyframe()}UpdateRender(){this._needRender=!0}GetWebGLRenderer(){return this._canvasManager?this._canvasManager.GetWebGLRenderer():null}GetWebGPURenderer(){return this._canvasManager?this._canvasManager.GetWebGPURenderer():null}GetRenderer(){return this._canvasManager?this._canvasManager.GetRenderer():null}Render(){const e=this._canvasManager;if(!e||e.IsRendererContextLost())return;const t=this.GetRenderer(),s=t.SupportsGPUProfiling(),n=s&&t.IsWebGL(),i=s&&t.IsWebGPU();if(n&&t.CheckForQueryResults(),!this._needRender&&!this.IsExportToVideo())return void t.IncrementFrameNumber();const r=this._layoutManager.GetMainRunningLayout();this._fpsFrameCount++,t.Start();const a=this.IsDebug();a&&Ax.StartMeasuringTime(),this._needRender=!1;let o=null;n&&(o=e.GetGPUFrameTimingsBuffer().AddTimeElapsedQuery(),t.StartQuery(o));let l=null;i&&(l=t.StartFrameTiming(2*(1+r.GetLayerCount())),t.StartMeasuringRenderPassTime(0,1)),this.Uses3DFeatures()&&"low"===e.GetCurrentFullscreenScalingQuality()?t.SetFixedSizeDepthBuffer(e.GetDrawWidth(),e.GetDrawHeight()):t.SetAutoSizeDepthBuffer(),this._Render(this.GetRenderer(),r),o&&t.EndQuery(o),i&&(t.StopMeasuringRenderPassTime(),this._canvasManager._AddWebGPUFrameTiming(l)),t.Finish(),a&&(Ax.AddDrawCallsTime(),Ax.UpdateInspectHighlight()),e&&e._MaybeTakeSnapshot()}_NeedsHTMLLayerCompositing(e){return"low"===this.GetCanvasManager().GetCurrentFullscreenScalingQuality()||e.IsWebGL()&&(this.UsesAnyBackgroundBlending()||this.Uses3DFeatures())}_Render(e,t){e.SetTextureFillMode(),e.SetAlphaBlend(),e.SetColorRgba(1,1,1,1),e.SetRenderTarget(null),e.SetTexture(null),e.SetDepthEnabled(this.Uses3DFeatures()),this._NeedsHTMLLayerCompositing(e)&&t._MaybeStartDrawToOwnTexture(e);const s=t.GetHTMLLayerCount();for(let n=1;n<s;++n)t.DrawForHTMLLayerIndex(e,n),e.IsWebGPU()&&e.Restart();this._NeedsHTMLLayerCompositing(e)||t._MaybeStartDrawToOwnTexture(e),t.DrawMain(e)}Trigger(e,t,s){if(!this._hasStarted)return!1;const n=!this._isInTick&&!this._eventSheetManager.IsInTrigger();let i=0;n&&(i=performance.now());const r=this.IsDebug();r&&this.SetDebuggingEnabled(!1);const a=this._eventSheetManager._Trigger(this._layoutManager,e,t,s);if(n){const e=performance.now()-i;this._mainThreadTimeCounter+=e,r&&Ax.AddTriggersTime(e)}return r&&this.SetDebuggingEnabled(!0),a}DebugTrigger(e,t,s){if(!this.IsDebugging())return this.Trigger(e,t,s);if(this.HitBreakpoint())throw new Error("called DebugTrigger() while stopped on breakpoint");if(!this._isInTick&&!this._eventSheetManager.IsInTrigger())throw new Error("called DebugTrigger() outside of event code - use TriggerAsync() instead");return this._eventSheetManager._DebugTrigger(this._layoutManager,e,t,s)}async TriggerAsync(e,t,s){if(!this.IsDebugging())return this.Trigger(e,t,s);if(!this._hasStarted)return!1;if(this.HitBreakpoint())return this._eventSheetManager.QueueDebugTrigger(e,t,s);if(!this.GetMainRunningLayout())return this._eventSheetManager.QueueTrigger(e,t,s);const n=performance.now(),i=this._eventSheetManager._DebugTrigger(this._layoutManager,e,t,s);let r=i.next();for(;!r.done;)await this.DebugBreak(r.value),r=i.next();return this.IsSuspended()||this._eventSheetManager.IsInTrigger()||(await this._eventSheetManager.RunQueuedDebugTriggersAsync(),this._hasStartedTicking&&!this._isInTick&&this._RequestAnimationFrame()),this._mainThreadTimeCounter+=performance.now()-n,r.value}FastTrigger(e,t,s){const n=this.IsDebug();n&&this.SetDebuggingEnabled(!1);const i=this._eventSheetManager._FastTrigger(this._layoutManager,e,t,s);return n&&this.SetDebuggingEnabled(!0),i}DebugFastTrigger(e,t,s){return this._eventSheetManager._DebugFastTrigger(this._layoutManager,e,t,s)}ScheduleTriggers(e){return this._scheduleTriggersThrottle.Add(e)}PushCurrentLayout(e){this._currentLayoutStack.push(e)}PopCurrentLayout(){if(!this._currentLayoutStack.length)throw new Error("layout stack empty");this._currentLayoutStack.pop()}GetCurrentLayout(){return this._currentLayoutStack.length?this._currentLayoutStack.at(-1):this.GetMainRunningLayout()}GetDt(e){return e&&-1!==e.GetTimeScale()?this._dt1*e.GetTimeScale():this._dt}_GetDtFast(){return this._dt}GetDt1(){return this._dt1}GetDtRaw(){return this._dtRaw}GetTimeScale(){return this._timeScale}SetTimeScale(e){(isNaN(e)||e<0)&&(e=0),this._timeScale=e}SetMinDt(e){this._minDt=Math.max(e,0)}GetMinDt(){return this._minDt}SetMaxDt(e){this._maxDt=Math.max(e,0)}GetMaxDt(){return this._maxDt}GetFramesPerSecond(){return this._fps}GetTicksPerSecond(){return this._tps}GetMainThreadTime(){return this._mainThreadTime}GetStartTime(){return this._startTime}GetGameTime(){return this._gameTime.Get()}GetGameTimeRaw(){return this._gameTimeRaw.Get()}GetWallTime(){return this._wallTime.Get()}GetTickCount(){return this._tickCount}GetTickCountNoSave(){return this._tickCountNoSave}GetObjectCount(){return this._objectCount}GetProjectName(){return this._projectName}GetProjectVersion(){return this._projectVersion}GetProjectUniqueId(){return this._projectUniqueId}GetAppId(){return this._appId}GetExportTimestamp(){return this._exportTimestamp}GetInstanceByUID(e){if(this._isLoadingState)throw new Error("cannot call while loading state - wait until afterload event");return this._instancesByUid.get(e)||null}_RemoveInstanceFromUIDMap(e){if(this._isLoadingState)throw new Error("cannot call while loading state - wait until afterload event");this._instancesByUid.delete(e)}_RefreshUidMap(){this._instancesByUid.clear();for(const e of this._allObjectClasses)if(!e.IsFamily())for(const t of e.GetInstances())this._instancesByUid.set(t.GetUID(),t)}IsPreview(){return"preview"===this._exportType}IsDebug(){return this._isDebug}GetExportType(){return this._exportType}IsNWjs(){return"nwjs"===this.GetExportType()||this._isNWjs}IsCordova(){return"cordova"===this._exportType}IsAndroidWebView(){return"Android"===Px.Platform.OS&&("cordova"===this._exportType||"playable-ad-single-file"===this._exportType||"playable-ad-zip"===this._exportType||"instant-games"===this._exportType)}IsiOSCordova(){return this._isiOSCordova}IsiOSWebView(){return this._isiOSWebView}IsWindowsWebView2(){return this._isWindowsWebView2}IsAnyWebView2Wrapper(){return this._isAnyWebView2Wrapper}GetCollisionEngine(){return this._collisionEngine}GetSolidBehavior(){return this._addonManager.GetSolidBehavior()}GetJumpthruBehavior(){return this._addonManager.GetJumpthruBehavior()}Uses3DFeatures(){return this._uses3dFeatures}GetZScaleFactor(){return this.GetRenderer().GetZAxisScaleFactor(this.GetViewportHeight())}GetDefaultCameraZ(e){return this.GetRenderer().GetDefaultCameraZ(e||this.GetViewportHeight())}IsLayoutFirstTick(){return this._isLayoutFirstTick}SetPixelRoundingEnabled(e){e=!!e,this._isPixelRoundingEnabled!==e&&(this._isPixelRoundingEnabled=e,this.GetLayoutManager().SetAllLayerMVChanged(),this.UpdateRender())}IsPixelRoundingEnabled(){return this._isPixelRoundingEnabled}GetTextIconSet(e){if(!this._iconChangeHandlers.has(e)){const t=()=>this.DeleteTextIconSet(e);this._iconChangeHandlers.set(e,t),e.Dispatcher().addEventListener("animationframeimagechange",t)}const t=this._textIconManager.GetIconSet(e);return t.HasLoaded()||t.LoadContent().then((()=>this.UpdateRender())),t}DeleteTextIconSet(e){this._textIconManager.DeleteIconSet(e)}_GetTextIconSetMeta(e){const t=[];for(const s of e.GetAnimations())for(const e of s.GetFrames()){const s=e.GetImageInfo();t.push({source:e,width:s.GetWidth(),height:s.GetHeight(),tag:e.GetTag()})}return{icons:t}}async _GetTextIconSetContent(e){const t=Px.New(Px.PromiseThrottle),s=[],n=new Map;for(const i of e.GetAnimations())for(const e of i.GetFrames()){const i=e.GetImageInfo().GetImageAsset();n.has(i)||(n.set(i,null),s.push(t.Add((async()=>{const e=await i.LoadToDrawable();n.set(i,e)}))))}await Promise.all(s);const i=[];for(const s of e.GetAnimations())for(const e of s.GetFrames())i.push(t.Add((async()=>{const t=e.GetImageInfo(),s=n.get(t.GetImageAsset()),i=await t.ExtractImageToCanvas(s);return{drawable:await createImageBitmap(i)}})));const r=await Promise.all(i);for(const e of n.values())e instanceof ImageBitmap&&e.close&&e.close();return{icons:r}}SaveToSlot(e){this._saveToSlotName=e,this._saveToJsonString=!1}SaveToJsonString(){this._saveToSlotName="",this._saveToJsonString=!0}LoadFromSlot(e){this._loadFromSlotName=e}LoadFromJsonString(e){this._loadFromJson=e}GetLastSaveJsonString(){return this._lastSaveJson}_NeedsHandleSaveOrLoad(){return!!(this._saveToSlotName||this._saveToJsonString||this._loadFromSlotName||null!==this._loadFromJson)}async _HandleSaveOrLoad(){if(this._saveToSlotName&&(this.FlushPendingInstances(),await this._DoSaveToSlot(this._saveToSlotName),this._ClearSaveOrLoad()),this._loadFromSlotName&&(await this._DoLoadFromSlot(this._loadFromSlotName),this._ClearSaveOrLoad(),this.IsDebug()&&Ax.StepIfPausedInDebugger()),this._saveToJsonString){const e=await this._SaveToJsonString();this._lastSaveJson=e,await this.TriggerAsync(Px.Plugins.System.Cnds.OnSaveComplete,null),this._lastSaveJson="",this._ClearSaveOrLoad()}if(null!==this._loadFromJson){this.FlushPendingInstances();try{await this._DoLoadFromJsonString(this._loadFromJson),this._lastSaveJson=this._loadFromJson,await this.TriggerAsync(Px.Plugins.System.Cnds.OnLoadComplete,null),this._lastSaveJson=""}catch(e){console.error("[Construct] Failed to load state from JSON string: ",e),await this.TriggerAsync(Px.Plugins.System.Cnds.OnLoadFailed,null)}this._ClearSaveOrLoad()}}_ClearSaveOrLoad(){this._saveToSlotName="",this._saveToJsonString=!1,this._loadFromSlotName="",this._loadFromJson=null}_GetProjectStorage(){return this._projectStorage||(this._projectStorage=localforage.createInstance({name:"c3-localstorage-"+this.GetProjectUniqueId(),description:this.GetProjectName()})),this._projectStorage}_GetSavegamesStorage(){return this._savegamesStorage||(this._savegamesStorage=localforage.createInstance({name:"c3-savegames-"+this.GetProjectUniqueId(),description:this.GetProjectName()})),this._savegamesStorage}async _DoSaveToSlot(e){const t=await this._SaveToJsonString();try{await this._GetSavegamesStorage().setItem(e,t),console.log("[Construct] Saved state to storage ("+t.length+" chars)"),this._lastSaveJson=t,await this.TriggerAsync(Px.Plugins.System.Cnds.OnSaveComplete,null),this._lastSaveJson=""}catch(e){console.error("[Construct] Failed to save state to storage: ",e),await this.TriggerAsync(Px.Plugins.System.Cnds.OnSaveFailed,null)}}async _DoLoadFromSlot(e){try{const t=await this._GetSavegamesStorage().getItem(e);if(!t)throw new Error("empty slot");console.log("[Construct] Loaded state from storage ("+t.length+" chars)"),await this._DoLoadFromJsonString(t),this._lastSaveJson=t,await this.TriggerAsync(Px.Plugins.System.Cnds.OnLoadComplete,null),this._lastSaveJson=""}catch(e){console.error("[Construct] Failed to load state from storage: ",e),await this.TriggerAsync(Px.Plugins.System.Cnds.OnLoadFailed,null)}}async _SaveToJsonString(){const e={c3save:!0,version:1,rt:{time:this.GetGameTime(),timeRaw:this.GetGameTimeRaw(),walltime:this.GetWallTime(),timescale:this.GetTimeScale(),tickcount:this.GetTickCount(),next_uid:this._nextUid,running_layout:this.GetMainRunningLayout().GetSID(),start_time_offset:Date.now()-this._startTime},types:{},layouts:{},events:this._eventSheetManager._SaveToJson(),timelines:this._timelineManager._SaveToJson(),user_script_data:null};for(const t of this._allObjectClasses)t.IsFamily()||t.HasNoSaveBehavior()||(e.types[t.GetSID().toString()]=t._SaveToJson());for(const t of this._layoutManager.GetAllLayouts())e.layouts[t.GetSID().toString()]=t._SaveToJson();const t=this._CreateUserScriptEvent("save");return t.saveData=null,await this.DispatchUserScriptEventAsyncWait(t),e.user_script_data=t.saveData,JSON.stringify(e)}IsLoadingState(){return this._isLoadingState}async _DoLoadFromJsonString(e){const t=this.GetLayoutManager(),s=JSON.parse(e);if(s.c2save)throw new Error("C2 saves are incompatible with C3 runtime");if(!s.c3save)throw new Error("not valid C3 save data");if(s.version>1)throw new Error("C3 save data from future version");this.ClearIntancesNeedingAfterLoad(),this._dispatcher.dispatchEvent(Px.New(Px.Event,"beforeload"));for(const e of this.allInstances())e.GetObjectClass().HasNoSaveBehavior()||e._OnBeforeLoad();const n=s.rt;this._gameTime.Set(n.time),n.hasOwnProperty("timeRaw")&&this._gameTimeRaw.Set(n.timeRaw),this._wallTime.Set(n.walltime),this._timeScale=n.timescale,this._tickCount=n.tickcount,this._startTime=Date.now()-n.start_time_offset;const i=n.running_layout;this._isLoadingState=!0;let r=!1;if(i!==this.GetMainRunningLayout().GetSID()){const e=t.GetLayoutBySID(i);if(!e)return;await this._DoChangeLayout(e),r=!0}for(const[e,n]of Object.entries(s.layouts)){const s=parseInt(e,10),i=t.GetLayoutBySID(s);i&&i._LoadFromJson(n)}const a=new Set;for(const[e,t]of Object.entries(s.types)){const s=parseInt(e,10),n=this.GetObjectClassBySID(s);!n||n.IsFamily()||n.HasNoSaveBehavior()||n._LoadFromJson(t,a)}for(const e of this._layoutManager.GetAllLayouts())for(const t of e.allLayers())t._LoadFromJsonAfterInstances();if(this.FlushPendingInstances(),this._RefreshUidMap(),this._isLoadingState=!1,r){for(const e of this.allInstances())e.SetupInitialSceneGraphConnections();for(const[e,t]of Object.entries(s.types)){const s=parseInt(e,10),n=this.GetObjectClassBySID(s);!n||n.IsFamily()||n.HasNoSaveBehavior()||n._SetupSceneGraphConnectionsOnChangeOfLayout(t)}}this._nextUid=n.next_uid,this._eventSheetManager._LoadFromJson(s.events);for(const e of this._allObjectClasses)if(!e.IsFamily()&&e.IsInContainer())for(const t of e.GetInstances()){const s=t.GetIID();t._ClearSiblings();for(const n of e.GetContainer().objectTypes()){if(n===e)continue;const i=n.GetInstances();if(s<0||s>=i.length)throw new Error("missing sibling instance");t._AddSibling(i[s])}}this._timelineManager._LoadFromJson(s.timelines),t.SetAllLayerProjectionChanged(),t.SetAllLayerMVChanged();for(const e of a)e._OnCreatedForLoadingSavegame();this.DoAfterLoad(),this._dispatcher.dispatchEvent(Px.New(Px.Event,"afterload")),this.DispatchUserScriptEvent(this._CreateUserScriptEvent("afterload"));for(const[e,t]of Object.entries(s.types)){const t=parseInt(e,10),s=this.GetObjectClassBySID(t);s&&s._ClearLoadInstancesJson()}const o=this._CreateUserScriptEvent("load");o.saveData=s.user_script_data,await this.DispatchUserScriptEventAsyncWait(o),this.UpdateRender()}SortOnTmpHierarchyPosition(e,t){return t.GetWorldInfo().GetTmpHierarchyPosition()-e.GetWorldInfo().GetTmpHierarchyPosition()}AddInstanceNeedingAfterLoad(e,t){e.GetWorldInfo()&&(this._instancesNeedingAfterLoadMap.has(e)||(this._instancesNeedingAfterLoadMap.set(e,t),this._instancesNeedingAfterLoadArray.push(e)))}ClearIntancesNeedingAfterLoad(){this._instancesNeedingAfterLoadMap=new WeakMap,Px.clearArray(this._instancesNeedingAfterLoadArray),Px.SceneGraphInfo.ClearUpdatedInstances()}DoAfterLoad(e="full",t=null){this._instancesNeedingAfterLoadArray.sort(this.SortOnTmpHierarchyPosition),t||(t={}),t.processedWorldInfo=new Set;const s=this._instancesNeedingAfterLoadArray.length;for(const s of this._instancesNeedingAfterLoadArray)s._OnAfterLoad(this._instancesNeedingAfterLoadMap.get(s),e,t);for(const s of this._instancesNeedingAfterLoadArray)s._OnAfterLoad2(this._instancesNeedingAfterLoadMap.get(s),e,t);if(this.ClearIntancesNeedingAfterLoad(),s){this.FlushPendingInstances(),this._RefreshUidMap();for(const e of this._layoutManager.GetAllLayouts())for(const t of e.allLayers())t._SortInstancesByLastCachedZIndex(),t.SetZIndicesChanged()}}async AddJobWorkerScripts(e){const t=await Promise.all(e.map((async e=>{if(this.IsCordova()&&this._assetManager.IsFileProtocol()||"playable-ad-single-file"===this.GetExportType()){const t=await this._assetManager.FetchBlob(e);return URL.createObjectURL(t)}return new URL(e,location.href).toString()})));this._jobScheduler.ImportScriptsToJobWorkers(t)}AddJobWorkerBlob(e,t){this._jobScheduler.SendBlobToJobWorkers(e,t)}AddJobWorkerBuffer(e,t){this._jobScheduler.SendBufferToJobWorkers(e,t)}AddJob(e,t,s,n){return this._jobScheduler.AddJob(e,t,s,null,null,n)}BroadcastJob(e,t,s,n){return this._jobScheduler.BroadcastJob(e,t,s,n)}GetMaxNumJobWorkers(){return this._jobScheduler.GetMaxNumWorkers()}InvokeDownload(e,t){this.PostComponentMessageToDOM("runtime","invoke-download",{url:e,filename:t})}async RasterSvgImage(e,t,s,n,i,r){if(n=n||t,i=i||s,this.IsInWorker())return(await this.PostComponentMessageToDOMAsync("runtime","raster-svg-image",{blob:e,imageWidth:t,imageHeight:s,surfaceWidth:n,surfaceHeight:i,imageBitmapOpts:r})).imageBitmap;{const a=await self.C3_RasterSvgImageBlob(e,t,s,n,i);return r?await self.createImageBitmap(a,r):a}}async GetSvgImageSize(e){return this.IsInWorker()?await this.PostComponentMessageToDOMAsync("runtime","get-svg-image-size",{blob:e}):await self.C3_GetSvgImageSize(e)}RequestDeviceOrientationEvent(){this._didRequestDeviceOrientationEvent||(this._didRequestDeviceOrientationEvent=!0,this.PostComponentMessageToDOM("runtime","enable-device-orientation"))}RequestDeviceMotionEvent(){this._didRequestDeviceMotionEvent||(this._didRequestDeviceMotionEvent=!0,this.PostComponentMessageToDOM("runtime","enable-device-motion"))}Random(){return this._randomNumberCallback()}SetRandomNumberGeneratorCallback(e){this._randomNumberCallback=e}_GetRemotePreviewStatusInfo(){const e=this.GetRenderer();return{fps:this.GetFramesPerSecond(),tps:this.GetTicksPerSecond(),cpu:this.GetMainThreadTime(),gpu:this.GetGPUUtilisation(),layout:this.GetMainRunningLayout()?this.GetMainRunningLayout().GetName():"",renderer:e.IsWebGL()?e.GetUnmaskedRenderer():e.GetAdapterInfoString()}}HitBreakpoint(){return!!this.IsDebug()&&Ax.HitBreakpoint()}DebugBreak(e){return this.IsDebugging()?Ax.DebugBreak(e):Promise.resolve()}DebugBreakNext(){return!!this.IsDebugging()&&Ax.BreakNext()}SetDebugBreakpointsEnabled(e){this._breakpointsEnabled=!!e,this._UpdateDebuggingFlag()}AreDebugBreakpointsEnabled(){return this._breakpointsEnabled}IsDebugging(){return this._isDebugging}SetDebuggingEnabled(e){e?this._debuggingDisabled--:this._debuggingDisabled++,this._UpdateDebuggingFlag()}_UpdateDebuggingFlag(){this._isDebugging=this.IsDebug()&&this._breakpointsEnabled&&0===this._debuggingDisabled}IsCPUProfiling(){return this.IsDebug()&&Ax.IsCPUProfiling()}IsGPUProfiling(){return this.IsDebug()&&this.GetRenderer().SupportsGPUProfiling()&&Ax.IsGPUProfiling()}async DebugIterateAndBreak(e){if(e)for(const t of e)await this.DebugBreak(t)}DebugFireGeneratorEventAndBreak(e){return this.DebugIterateAndBreak(this._dispatcher.dispatchGeneratorEvent(e))}_InvokeFunctionFromJS(e){return this._eventSheetManager._InvokeFunctionFromJS(e.name,e.params)}_GetHTMLLayerWrapElement(e){if(this.IsInWorker())throw new Error("not supported in worker mode");return self.c3_runtimeInterface._GetHTMLWrapElement(e)}GetIRuntime(){return this._iRuntime}_CreateUserScriptEvent(e){const t=Px.New(Px.Event,e,!1);return t.runtime=this._iRuntime,t}_InitScriptInterfaces(){this._iRuntime=new self.IRuntime(this),this._userScriptEventObjects={pretick:this._CreateUserScriptEvent("pretick"),tick:this._CreateUserScriptEvent("tick"),tick2:this._CreateUserScriptEvent("tick2")}}_InitObjectsScriptInterface(){const e={};for(const t of this._allObjectClasses)e[t.GetJsPropName()]={value:t.GetIObjectClass(),enumerable:!0,writable:!1};this._iRuntime._InitObjects(e)}_InitGlobalVariableScriptInterface(){const e={};for(const t of this.GetEventSheetManager().GetAllGlobalVariables())e[t.GetJsPropName()]=t._GetScriptInterfaceDescriptor();this._iRuntime._InitGlobalVars(e)}_GetCommonScriptInterfaces(){return this._commonScriptInterfaces}_MapScriptInterface(e,t){this._interfaceMap.set(e,t)}_UnwrapScriptInterface(e){return this._interfaceMap.get(e)}_UnwrapIObjectClass(e){if(!(e instanceof self.IObjectClass))throw new TypeError("expected IObjectClass");const t=this._UnwrapScriptInterface(e);if(!(t&&t instanceof Px.ObjectClass))throw new Error("invalid IObjectClass");return t}_UnwrapIInstance(e){if(!(e instanceof self.IInstance))throw new TypeError("expected IInstance");const t=this._UnwrapScriptInterface(e);if(!(t&&t instanceof Px.Instance))throw new Error("invalid IInstance");return t}_UnwrapIWorldInstance(e){if(!(e instanceof self.IWorldInstance))throw new TypeError("expected IWorldInstance");const t=this._UnwrapScriptInterface(e);if(!(t&&t instanceof Px.Instance))throw new Error("invalid IInstance");return t}},self.C3_CreateRuntime=Px.Runtime.Create,self.C3_InitRuntime=(e,t)=>e.Init(t)}{const kx=self.C3;kx.JobSchedulerRuntime=class extends kx.DefendedBase{constructor(e,t){super(),this._runtime=e,this._jobPromises=new Map,this._nextJobId=0,this._inputPort=t.inputPort,t.outputPort.onmessage=e=>this._OnJobWorkerMessage(e),this._maxNumWorkers=t.maxNumWorkers,this._jobWorkerCount=1,this._isCreatingWorker=!1,this._hadErrorCreatingWorker=!1}GetMaxNumWorkers(){return this._maxNumWorkers}ImportScriptsToJobWorkers(e){this._inputPort.postMessage({type:"_import_scripts",scripts:e})}SendBlobToJobWorkers(e,t){this._inputPort.postMessage({type:"_send_blob",blob:e,id:t})}SendBufferToJobWorkers(e,t){this._inputPort.postMessage({type:"_send_buffer",buffer:e,id:t},[e])}AddJob(e,t,s,n,i,r){if(s||(s=[]),"number"==typeof r&&(r=Math.floor(r))<=0)throw new Error("invalid maxWorkerNum");const a=this._nextJobId++,o={type:e,isBroadcast:!1,maxWorkerNum:r,jobId:a,params:t,transferables:s},l=new Promise(((e,t)=>{this._jobPromises.set(a,{resolve:e,progress:n,reject:t,cancelled:!1,maxWorkerNum:r})}));return i&&i.SetAction((()=>this._CancelJob(a))),this._inputPort.postMessage(o,s),this._MaybeCreateExtraWorker(),l}BroadcastJob(e,t,s,n){if(s||(s=[]),"number"==typeof n&&(n=Math.floor(n))<=0)throw new Error("invalid maxWorkerNum");const i={type:e,isBroadcast:!0,maxWorkerNum:n,jobId:this._nextJobId++,params:t,transferables:s};this._inputPort.postMessage(i,s)}_CancelJob(e){const t=this._jobPromises.get(e);t&&(t.cancelled=!0,t.resolve=null,t.progress=null,t.reject=null,this._inputPort.postMessage({type:"_cancel",jobId:e}))}_OnJobWorkerMessage(e){const t=e.data,s=t.type,n=t.jobId;switch(s){case"result":this._OnJobResult(n,t.result);break;case"progress":this._OnJobProgress(n,t.progress);break;case"error":this._OnJobError(n,t.error);break;case"ready":this._OnJobWorkerReady();break;default:throw new Error(`unknown message from worker '${s}'`)}}_OnJobResult(e,t){const s=this._jobPromises.get(e);if(!s)throw new Error("invalid job ID");s.cancelled||s.resolve(t),this._jobPromises.delete(e)}_OnJobProgress(e,t){const s=this._jobPromises.get(e);if(!s)throw new Error("invalid job ID");!s.cancelled&&s.progress&&s.progress(t)}_OnJobError(e,t){const s=this._jobPromises.get(e);if(!s)throw new Error("invalid job ID");s.cancelled||s.reject(t),this._jobPromises.delete(e)}_OnJobWorkerReady(){this._isCreatingWorker&&(this._isCreatingWorker=!1,this._jobWorkerCount++,this._jobWorkerCount<this._maxNumWorkers?this._MaybeCreateExtraWorker():this._inputPort.postMessage({type:"_no_more_workers"}))}_GetWorkerCountNeededForPendingJobs(){let e=0;const t=[...this._jobPromises.values()].sort(((e,t)=>(e.maxWorkerNum||1/0)-(t.maxWorkerNum||1/0)));for(const s of t)e<(s.maxWorkerNum||1/0)&&e++;return e}async _MaybeCreateExtraWorker(){if(!(this._jobWorkerCount>=this._maxNumWorkers||this._isCreatingWorker||this._hadErrorCreatingWorker||this._GetWorkerCountNeededForPendingJobs()<=this._jobWorkerCount))try{this._isCreatingWorker=!0,(await this._runtime.PostComponentMessageToDOMAsync("runtime","create-job-worker")).outputPort.onmessage=e=>this._OnJobWorkerMessage(e)}catch(e){this._hadErrorCreatingWorker=!0,this._isCreatingWorker=!1,console.error(`[Construct] Failed to create job worker; stopping creating any more (created ${this._jobWorkerCount} so far)`,e)}}}}self.C3_Shaders={},self.C3_Shaders.skymen_BetterOutline={glsl:"uniform lowp vec3 outlinecolor;\nuniform lowp float width;\nuniform lowp float precisionStep;\nuniform lowp float samples;\nuniform lowp float outlineOpacity;\nvarying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nuniform mediump vec2 srcStart;\nuniform mediump vec2 srcEnd;\nuniform mediump vec2 srcOriginStart;\nuniform mediump vec2 srcOriginEnd;\nuniform mediump vec2 layoutStart;\nuniform mediump vec2 layoutEnd;\nuniform lowp sampler2D samplerBack;\nuniform mediump vec2 destStart;\nuniform mediump vec2 destEnd;\nuniform mediump float seconds;\nuniform mediump vec2 pixelSize;\nuniform mediump float layerScale;\nuniform mediump float layerAngle;\n#define PI 3.14159265359\n#define SAMPLES 96\n#define PASSES 64\nvoid main(void)\n{\nif (width <= 0.0 || outlineOpacity <= 0.0) {\ngl_FragColor = texture2D( samplerFront, vTex );\nreturn;\n}\nmediump float outlineAlpha = 0.0;\nmediump vec2 actualWidth;\nmediump float widthCopy = width;\nmediump vec4 color = vec4(outlinecolor.x, outlinecolor.y, outlinecolor.z, 1.0);\nmediump float angle;\nmediump vec2 layoutSize = abs(vec2(layoutEnd.x-layoutStart.x,(layoutEnd.y-layoutStart.y)));\nmediump vec2 texelSize = abs(srcOriginEnd-srcOriginStart)/layoutSize;\nmediump vec4 fragColor;\nmediump vec2 testPoint;\nmediump float sampledAlpha;\nint passes = int(clamp(width / precisionStep, 1.0, float(PASSES)));\nfor (int j=0; j<PASSES; j++) {\nif (j >= passes ) break;\nwidthCopy = mix(0.0, width, float(j)/float(passes));\nactualWidth = widthCopy * texelSize;\nangle = 0.0;\nfor( int i=0; i<SAMPLES; i++ ){\nif (i >= int(samples)) break;\nangle += 1.0/(clamp(samples, 0.0, float(SAMPLES))/2.0) * PI;\ntestPoint = vTex + actualWidth * vec2(cos(angle), sin(angle));\nsampledAlpha = texture2D( samplerFront,  testPoint ).a;\noutlineAlpha = max( outlineAlpha, sampledAlpha );\n}\n}\nfragColor = color * outlineAlpha * outlineOpacity;\nmediump vec4 tex0 = texture2D( samplerFront, vTex );\ngl_FragColor = fragColor * (1. - tex0.a) + tex0;\n}",glslWebGL2:"#version 300 es\nin mediump vec2 vTex;\nout lowp vec4 outColor;\n#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nprecision lowp float;\nuniform lowp sampler2D samplerFront;\nuniform mediump vec2 srcStart;\nuniform mediump vec2 srcEnd;\nuniform mediump vec2 srcOriginStart;\nuniform mediump vec2 srcOriginEnd;\nuniform mediump vec2 layoutStart;\nuniform mediump vec2 layoutEnd;\nuniform lowp sampler2D samplerBack;\nuniform lowp sampler2D samplerDepth;\nuniform mediump vec2 destStart;\nuniform mediump vec2 destEnd;\nuniform highmedp float seconds;\nuniform mediump vec2 pixelSize;\nuniform mediump float layerScale;\nuniform mediump float layerAngle;\nuniform mediump float devicePixelRatio;\nuniform mediump float zNear;\nuniform mediump float zFar;\nuniform lowp vec3 outlinecolor;\nuniform lowp float width;\nuniform lowp float precisionStep;\nuniform lowp float samples;\nuniform lowp float outlineOpacity;\n#define PI 3.14159265359\n#define SAMPLES 96\n#define PASSES 64\nvoid main(void)\n{\nif (width <= 0.0 || outlineOpacity <= 0.0) {\noutColor = texture( samplerFront, vTex );\nreturn;\n}\nmediump float outlineAlpha = 0.0;\nmediump vec2 actualWidth;\nmediump float widthCopy = width;\nmediump vec4 color = vec4(outlinecolor.x, outlinecolor.y, outlinecolor.z, 1.0);\nmediump float angle;\nmediump vec2 layoutSize = abs(vec2(layoutEnd.x-layoutStart.x,(layoutEnd.y-layoutStart.y)));\nmediump vec2 texelSize = abs(srcOriginEnd-srcOriginStart)/layoutSize;\nmediump vec4 fragColor;\nmediump vec2 testPoint;\nmediump float sampledAlpha;\nint passes = int(clamp(width / precisionStep, 1.0, float(PASSES)));\nint sampleCount = int(clamp(samples, 0.0, float(SAMPLES)));\nfor (int j = 0; j <= passes; j++) {\nwidthCopy = mix(0.0, width, float(j)/float(passes));\nactualWidth = widthCopy * texelSize;\nangle = 0.0;\nfor( int i = 0; i < sampleCount; i++ ) {\nangle += 1.0/(float(sampleCount)/2.0) * PI;\ntestPoint = vTex + actualWidth * vec2(cos(angle), sin(angle));\nsampledAlpha = texture( samplerFront,  testPoint ).a;\noutlineAlpha = max( outlineAlpha, sampledAlpha );\n}\n}\nfragColor = color * outlineAlpha * outlineOpacity;\nmediump vec4 tex0 = texture( samplerFront, vTex );\noutColor = fragColor * (1. - tex0.a) + tex0;\n}",wgsl:"%%FRAGMENTINPUT_STRUCT%%\n/* input struct contains the following fields:\nfragUV : vec2<f32>\nfragPos : vec4<f32>\nfn c3_getBackUV(fragPos : vec2<f32>, texBack : texture_2d<f32>) -> vec2<f32>\nfn c3_getDepthUV(fragPos : vec2<f32>, texDepth : texture_depth_2d) -> vec2<f32>\n*/\n%%FRAGMENTOUTPUT_STRUCT%%\n%%SAMPLERFRONT_BINDING%% var samplerFront : sampler;\n%%TEXTUREFRONT_BINDING%% var textureFront : texture_2d<f32>;\nstruct ShaderParams {\noutlinecolor : vec3<f32>,\nwidth : f32,\nprecisionStep : f32,\nsamples : f32,\noutlineOpacity : f32\n};\n%%SHADERPARAMS_BINDING%% var<uniform> shaderParams : ShaderParams;\n%%C3PARAMS_STRUCT%%\n/* c3Params struct contains the following fields:\nsrcStart : vec2<f32>,\nsrcEnd : vec2<f32>,\nsrcOriginStart : vec2<f32>,\nsrcOriginEnd : vec2<f32>,\nlayoutStart : vec2<f32>,\nlayoutEnd : vec2<f32>,\ndestStart : vec2<f32>,\ndestEnd : vec2<f32>,\ndevicePixelRatio : f32,\nlayerScale : f32,\nlayerAngle : f32,\nseconds : f32,\nzNear : f32,\nzFar : f32,\nisSrcTexRotated : u32\nfn c3_srcToNorm(p : vec2<f32>) -> vec2<f32>\nfn c3_normToSrc(p : vec2<f32>) -> vec2<f32>\nfn c3_srcOriginToNorm(p : vec2<f32>) -> vec2<f32>\nfn c3_normToSrcOrigin(p : vec2<f32>) -> vec2<f32>\nfn c3_clampToSrc(p : vec2<f32>) -> vec2<f32>\nfn c3_clampToSrcOrigin(p : vec2<f32>) -> vec2<f32>\nfn c3_getLayoutPos(p : vec2<f32>) -> vec2<f32>\nfn c3_srcToDest(p : vec2<f32>) -> vec2<f32>\nfn c3_clampToDest(p : vec2<f32>) -> vec2<f32>\nfn c3_linearizeDepth(depthSample : f32) -> f32\n*/\n/*\nfn c3_premultiply(c : vec4<f32>) -> vec4<f32>\nfn c3_unpremultiply(c : vec4<f32>) -> vec4<f32>\nfn c3_grayscale(rgb : vec3<f32>) -> f32\nfn c3_getPixelSize(t : texture_2d<f32>) -> vec2<f32>\nfn c3_RGBtoHSL(color : vec3<f32>) -> vec3<f32>\nfn c3_HSLtoRGB(hsl : vec3<f32>) -> vec3<f32>\n*/\nconst PI:f32 = 3.14159265359;\nconst SAMPLES:i32 = 96;\nconst PASSES:i32 = 64;\n@fragment\nfn main(input : FragmentInput) -> FragmentOutput\n{\nvar output : FragmentOutput;\nif (shaderParams.width <= 0.0 || shaderParams.outlineOpacity <= 0.0) {\noutput.color = textureSample(textureFront, samplerFront, input.fragUV );\nreturn output;\n}\nvar outlineAlpha: f32 = 0.0;\nvar actualWidth: vec2<f32>;\nvar widthCopy: f32 = shaderParams.width;\nvar color: vec4<f32> = vec4<f32>(shaderParams.outlinecolor.x, shaderParams.outlinecolor.y, shaderParams.outlinecolor.z, 1.0);\nvar angle: f32;\nlet layoutSize: vec2<f32> = abs(vec2<f32>(c3Params.layoutEnd.x - c3Params.layoutStart.x, c3Params.layoutEnd.y - c3Params.layoutStart.y));\nlet texelSize: vec2<f32> = abs(c3Params.srcOriginEnd - c3Params.srcOriginStart) / layoutSize;\nvar fragColor: vec4<f32>;\nvar testPoint: vec2<f32>;\nvar sampledAlpha: f32;\nlet passes: u32 = u32(clamp(shaderParams.width / shaderParams.precisionStep, 1.0, f32(SAMPLES)));\nlet sampleCount: u32 = u32(clamp(shaderParams.samples, 0.0, f32(SAMPLES)));\nfor (var j: u32 = 0u; j <= passes; j = j + 1u) {\nwidthCopy = mix(0.0, shaderParams.width, f32(j) / f32(passes));\nactualWidth = widthCopy * texelSize;\nangle = 0.0;\nfor (var i: u32 = 0u; i < sampleCount; i = i + 1u) {\nangle = angle + 1.0 / (f32(sampleCount) / 2.0) * PI;\ntestPoint = input.fragUV + actualWidth * vec2<f32>(cos(angle), sin(angle));\nsampledAlpha = textureSample(textureFront, samplerFront, testPoint).a; // Assuming 'samplerFrontSampler' is the sampler associated with 'samplerFront'\noutlineAlpha = max(outlineAlpha, sampledAlpha);\n}\n}\nfragColor = color * outlineAlpha * shaderParams.outlineOpacity;\nvar tex0 : vec4<f32> = textureSample(textureFront, samplerFront, input.fragUV );\noutput.color = fragColor * (1. - tex0.a) + tex0;\nreturn output;\n}",blendsBackground:!1,usesDepth:!1,extendBoxHorizontal:50,extendBoxVertical:50,crossSampling:!0,mustPreDraw:!0,preservesOpaqueness:!1,supports3dDirectRendering:!1,animated:!1,parameters:[["outlinecolor",0,"color"],["width",0,"float"],["precisionStep",0,"float"],["samples",0,"float"],["outlineOpacity",0,"percent"]]},self.C3_Shaders.water={glsl:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n#define highmedp highp\n#else\n#define highmedp mediump\n#endif\nvarying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nuniform mediump vec2 srcStart;\nuniform mediump vec2 srcEnd;\nprecision mediump float;\nuniform highmedp float seconds;\nuniform mediump vec2 pixelSize;\nconst float PI = 3.1415926535897932;\nuniform float speed;\nuniform float speed_x;\nuniform float speed_y;\nuniform float intensity;\nconst float steps = 8.0;\nuniform float frequency;\nuniform float angle; // better when a prime\nuniform float delta;\nuniform float intence;\nuniform float emboss;\nfloat col(vec2 coord)\n{\nfloat delta_theta = 2.0 * PI / angle;\nfloat col = 0.0;\nfloat theta = 0.0;\nfor (float i = 0.0; i < steps; i++)\n{\nvec2 adjc = coord;\ntheta = delta_theta*i;\nadjc.x += cos(theta)*seconds*speed + seconds * speed_x;\nadjc.y -= sin(theta)*seconds*speed - seconds * speed_y;\ncol = col + cos( (adjc.x*cos(theta) - adjc.y*sin(theta))*frequency)*intensity;\n}\nreturn cos(col);\n}\nvoid main(void)\n{\nmediump vec2 tex = (vTex - srcStart) / (srcEnd - srcStart);\nvec2 p = tex, c1 = p, c2 = p;\nfloat cc1 = col(c1);\nc2.x += (1.0 / pixelSize.x) / delta;\nfloat dx = emboss*(cc1-col(c2))/delta;\nc2.x = p.x;\nc2.y += (1.0 / pixelSize.y) / delta;\nfloat dy = emboss*(cc1-col(c2))/delta;\nc1.x += dx;\nc1.y = -(c1.y+dy);\nfloat alpha = 1.+dot(dx,dy)*intence;\nc1.y = -c1.y;\nc1 = clamp(c1, 0.0, 1.0);\ngl_FragColor = texture2D(samplerFront, mix(srcStart, srcEnd, c1)) * alpha;\n}",glslWebGL2:"",wgsl:"%%SAMPLERFRONT_BINDING%% var samplerFront : sampler;\n%%TEXTUREFRONT_BINDING%% var textureFront : texture_2d<f32>;\nstruct ShaderParams {\nspeed : f32,\nspeed_x : f32,\nspeed_y : f32,\nintensity : f32,\nfrequency : f32,\nangle : f32,\ndelta : f32,\nintence : f32,\nemboss : f32\n};\n%%SHADERPARAMS_BINDING%% var<uniform> shaderParams : ShaderParams;\n%%C3PARAMS_STRUCT%%\n%%C3_UTILITY_FUNCTIONS%%\n%%FRAGMENTINPUT_STRUCT%%\n%%FRAGMENTOUTPUT_STRUCT%%\nconst pi : f32 = 3.1415926535897932;\nconst steps = 8.0;\nfn col(coord : vec2<f32>) -> f32\n{\nvar delta_theta : f32 = 2.0 * pi / shaderParams.angle;\nvar col : f32 = 0.0;\nvar theta : f32 = 0.0;\nfor (var i : f32 = 0.0; i < steps; i = i + 1.0)\n{\nvar adjc : vec2<f32> = coord;\ntheta = delta_theta * i;\nadjc.x = adjc.x + cos(theta) * c3Params.seconds * shaderParams.speed + c3Params.seconds * shaderParams.speed_x;\nadjc.y = adjc.y - (sin(theta) * c3Params.seconds * shaderParams.speed - c3Params.seconds * shaderParams.speed_y);\ncol = col + cos((adjc.x * cos(theta) - adjc.y * sin(theta)) * shaderParams.frequency) * shaderParams.intensity;\n}\nreturn cos(col);\n}\n@fragment\nfn main(input : FragmentInput) -> FragmentOutput\n{\nvar texSize : vec2<f32> = vec2<f32>(textureDimensions(textureFront));\nvar tex : vec2<f32> = c3_srcToNorm(input.fragUV);\nvar p : vec2<f32> = tex;\nvar c1 : vec2<f32> = tex;\nvar c2 : vec2<f32> = tex;\nvar cc1 : f32 = col(c1);\nc2.x = c2.x + texSize.x / shaderParams.delta;\nvar dx : f32 = shaderParams.emboss * (cc1 - col(c2)) / shaderParams.delta;\nc2.x = p.x;\nc2.y = c2.y + texSize.y / shaderParams.delta;\nvar dy : f32 = shaderParams.emboss * (cc1 - col(c2)) / shaderParams.delta;\nc1.x = c1.x + dx;\nc1.y = -(c1.y + dy);\nvar alpha : f32 = 1.0 + dx * dy * shaderParams.intence;\nc1.y = -c1.y;\nc1 = c3_clamp2(c1, 0.0, 1.0);\nvar output : FragmentOutput;\noutput.color = textureSample(textureFront, samplerFront, mix(c3Params.srcStart, c3Params.srcEnd, c1)) * alpha;\nreturn output;\n}",blendsBackground:!1,usesDepth:!1,extendBoxHorizontal:40,extendBoxVertical:40,crossSampling:!1,mustPreDraw:!1,preservesOpaqueness:!1,supports3dDirectRendering:!1,animated:!0,parameters:[["speed",0,"percent"],["speed_x",0,"percent"],["speed_y",0,"percent"],["intensity",0,"float"],["frequency",0,"float"],["angle",0,"float"],["delta",0,"float"],["intence",0,"float"],["emboss",0,"percent"]]};{let Lx=function(e,t){const s=e[1],n=t[1];if("number"==typeof s&&"number"==typeof n)return s-n;{const e=""+s,t=""+n;return e<t?-1:e>t?1:0}};ForEachOrdered_SortInstances=Lx;const Fx=self.C3;let Bx=null,Ox="",Nx="",Wx=[],Vx="",jx="",Ux="";const Hx=Fx.New(Fx.ArrayStack);Fx.Plugins.System=class extends Fx.SDKPluginBase{constructor(e){super(e),this._loopStack=this._runtime.GetEventSheetManager().GetLoopStack(),this._eventStack=this._runtime.GetEventSheetManager().GetEventStack(),this._imagesLoadingTotal=0,this._imagesLoadingComplete=0,this._functionMaps=new Map}Release(){super.Release()}UpdateRender(){this._runtime.UpdateRender()}Trigger(e){this._runtime.Trigger(e,null,null)}GetRegex(e,t){return Bx&&e===Ox&&t===Nx||(Bx=new RegExp(e,t),Ox=e,Nx=t),Bx.lastIndex=0,Bx}GetRegexMatches(e,t,s){if(e===Vx&&t===jx&&s===Ux)return Wx;const n=this.GetRegex(t,s);return Wx=e.match(n),Vx=e,jx=t,Ux=s,Wx}async _LoadTexturesForObjectClasses(e,t){if(!t.length)return;this._imagesLoadingTotal+=t.length;const s=[];for(const n of t)s.push(e.MaybeLoadTexturesFor(n));await Fx.PromiseAllWithProgress(s,(()=>{this._imagesLoadingComplete++})),this._imagesLoadingComplete++,this._imagesLoadingComplete===this._imagesLoadingTotal&&(this._imagesLoadingComplete=0,this._imagesLoadingTotal=0,this._runtime.Trigger(Fx.Plugins.System.Cnds.OnImageLoadingComplete,null,null))}GetImageLoadingProgress(){return 0===this._imagesLoadingTotal?1:this._imagesLoadingComplete/this._imagesLoadingTotal}_UnloadTexturesForObjectClasses(e,t){for(const s of t)0===s.GetInstanceCount()&&e.MaybeUnloadTexturesFor(s)}_GetForEachStack(){return Hx}_Repeat(e){const t=this._runtime.GetEventSheetManager(),s=t.GetEventStack(),n=s.GetCurrentStackFrame(),i=n.GetCurrentEvent(),r=i.GetSolModifiers(),a=n.IsSolModifierAfterCnds(),o=s.Push(i),l=t.GetLoopStack(),c=l.Push();if(c.SetEnd(e),a)for(let s=0;s<e&&!c.IsStopped();++s)t.PushCopySol(r),c.SetIndex(s),i.Retrigger(n,o),t.PopSol(r);else for(let t=0;t<e&&!c.IsStopped();++t)c.SetIndex(t),i.Retrigger(n,o);return s.Pop(),l.Pop(),!1}*_DebugRepeat(e){const t=this._runtime.GetEventSheetManager(),s=t.GetEventStack(),n=s.GetCurrentStackFrame(),i=n.GetCurrentEvent(),r=i.GetSolModifiers(),a=n.IsSolModifierAfterCnds(),o=s.Push(i),l=t.GetLoopStack(),c=l.Push();if(c.SetEnd(e),a)for(let s=0;s<e&&!c.IsStopped();++s)t.PushCopySol(r),c.SetIndex(s),yield*i.DebugRetrigger(n,o),t.PopSol(r);else for(let t=0;t<e&&!c.IsStopped();++t)c.SetIndex(t),yield*i.DebugRetrigger(n,o);return s.Pop(),l.Pop(),!1}_While(){const e=this._runtime.GetEventSheetManager(),t=e.GetEventStack(),s=t.GetCurrentStackFrame(),n=s.GetCurrentEvent(),i=n.GetSolModifiers(),r=s.IsSolModifierAfterCnds(),a=t.Push(n),o=e.GetLoopStack(),l=o.Push();if(r)for(let t=0;!l.IsStopped();++t)e.PushCopySol(i),l.SetIndex(t),n.Retrigger(s,a)||l.Stop(),e.PopSol(i);else for(let e=0;!l.IsStopped();++e)l.SetIndex(e),n.Retrigger(s,a)||l.Stop();return t.Pop(),o.Pop(),!1}*_DebugWhile(){const e=this._runtime.GetEventSheetManager(),t=e.GetEventStack(),s=t.GetCurrentStackFrame(),n=s.GetCurrentEvent(),i=n.GetSolModifiers(),r=s.IsSolModifierAfterCnds(),a=t.Push(n),o=e.GetLoopStack(),l=o.Push();if(r)for(let t=0;!l.IsStopped();++t)e.PushCopySol(i),l.SetIndex(t),(yield*n.DebugRetrigger(s,a))||l.Stop(),e.PopSol(i);else for(let e=0;!l.IsStopped();++e)l.SetIndex(e),(yield*n.DebugRetrigger(s,a))||l.Stop();return t.Pop(),o.Pop(),!1}_For(e,t,s){const n=this._runtime.GetEventSheetManager(),i=n.GetEventStack(),r=i.GetCurrentStackFrame(),a=r.GetCurrentEvent(),o=a.GetSolModifiers(),l=r.IsSolModifierAfterCnds(),c=i.Push(a),h=n.GetLoopStack(),_=h.Push();if(_.SetName(e),_.SetEnd(s),s<t)if(l)for(let e=t;e>=s&&!_.IsStopped();--e)n.PushCopySol(o),_.SetIndex(e),a.Retrigger(r,c),n.PopSol(o);else for(let e=t;e>=s&&!_.IsStopped();--e)_.SetIndex(e),a.Retrigger(r,c);else if(l)for(let e=t;e<=s&&!_.IsStopped();++e)n.PushCopySol(o),_.SetIndex(e),a.Retrigger(r,c),n.PopSol(o);else for(let e=t;e<=s&&!_.IsStopped();++e)_.SetIndex(e),a.Retrigger(r,c);return i.Pop(),h.Pop(),!1}*_DebugFor(e,t,s){const n=this._runtime.GetEventSheetManager(),i=n.GetEventStack(),r=i.GetCurrentStackFrame(),a=r.GetCurrentEvent(),o=a.GetSolModifiers(),l=r.IsSolModifierAfterCnds(),c=i.Push(a),h=n.GetLoopStack(),_=h.Push();if(_.SetName(e),_.SetEnd(s),s<t)if(l)for(let e=t;e>=s&&!_.IsStopped();--e)n.PushCopySol(o),_.SetIndex(e),yield*a.DebugRetrigger(r,c),n.PopSol(o);else for(let e=t;e>=s&&!_.IsStopped();--e)_.SetIndex(e),yield*a.DebugRetrigger(r,c);else if(l)for(let e=t;e<=s&&!_.IsStopped();++e)n.PushCopySol(o),_.SetIndex(e),yield*a.DebugRetrigger(r,c),n.PopSol(o);else for(let e=t;e<=s&&!_.IsStopped();++e)_.SetIndex(e),yield*a.DebugRetrigger(r,c);return i.Pop(),h.Pop(),!1}_ForEach(e){const t=e.GetCurrentSol(),s=t.GetInstances();if(0===s.length)return!1;const n=this._runtime.GetEventSheetManager(),i=n.GetEventStack(),r=i.GetCurrentStackFrame(),a=r.GetCurrentEvent(),o=a.GetSolModifiers(),l=r.IsSolModifierAfterCnds(),c=i.Push(a),h=n.GetLoopStack(),_=h.Push(),u=e.IsInContainer(),d=Hx.Push();if(Fx.shallowAssignArray(d,s),_.SetEnd(d.length),l)for(let t=0,s=d.length;t<s&&!_.IsStopped();++t){n.PushCopySol(o);const s=d[t];e.GetCurrentSol().SetSinglePicked(s),u&&s.SetSiblingsSinglePicked(),_.SetIndex(t),a.Retrigger(r,c),n.PopSol(o)}else{t._SetSelectAll(!1);const e=t._GetOwnInstances();Fx.clearArray(e),e.push(null);for(let t=0,s=d.length;t<s&&!_.IsStopped();++t){const s=d[t];e[0]=s,u&&s.SetSiblingsSinglePicked(),_.SetIndex(t),a.Retrigger(r,c)}}return i.Pop(),h.Pop(),Fx.clearArray(d),Hx.Pop(),!1}*_DebugForEach(e){const t=e.GetCurrentSol(),s=t.GetInstances();if(0===s.length)return!1;const n=this._runtime.GetEventSheetManager(),i=n.GetEventStack(),r=i.GetCurrentStackFrame(),a=r.GetCurrentEvent(),o=a.GetSolModifiers(),l=r.IsSolModifierAfterCnds(),c=i.Push(a),h=n.GetLoopStack(),_=h.Push(),u=e.IsInContainer(),d=Hx.Push();if(Fx.shallowAssignArray(d,s),_.SetEnd(d.length),l)for(let t=0,s=d.length;t<s&&!_.IsStopped();++t){n.PushCopySol(o);const s=d[t];e.GetCurrentSol().SetSinglePicked(s),u&&s.SetSiblingsSinglePicked(),_.SetIndex(t),yield*a.DebugRetrigger(r,c),n.PopSol(o)}else{t._SetSelectAll(!1);const e=t._GetOwnInstances();Fx.clearArray(e),e.push(null);for(let t=0,s=d.length;t<s&&!_.IsStopped();++t){const s=d[t];e[0]=s,u&&s.SetSiblingsSinglePicked(),_.SetIndex(t),yield*a.DebugRetrigger(r,c)}}return i.Pop(),h.Pop(),Fx.clearArray(d),Hx.Pop(),!1}_ForEachOrdered(e,t){const s=e.GetCurrentSol(),n=s.GetInstances();if(0===n.length)return!1;const i=this._runtime.GetEventSheetManager(),r=i.GetEventStack(),a=i.GetCurrentCondition(),o=r.GetCurrentStackFrame(),l=o.GetCurrentEvent(),c=l.GetSolModifiers(),h=o.IsSolModifierAfterCnds(),_=r.Push(l),u=i.GetLoopStack(),d=u.Push(),p=e.IsInContainer(),f=Hx.Push();Fx.clearArray(f),d.SetEnd(n.length);for(let e=0,t=n.length;e<t;++e)f.push([n[e],a.ReevaluateParameter(1,e)]);if(f.sort(Lx),1===t&&f.reverse(),h)for(let t=0,s=f.length;t<s&&!d.IsStopped();++t){i.PushCopySol(c);const s=f[t][0];e.GetCurrentSol().SetSinglePicked(s),p&&s.SetSiblingsSinglePicked(),d.SetIndex(t),l.Retrigger(o,_),i.PopSol(c)}else{s._SetSelectAll(!1);const e=s._GetOwnInstances();Fx.clearArray(e),e.push(null);for(let t=0,s=f.length;t<s&&!d.IsStopped();++t){const s=f[t][0];e[0]=s,p&&s.SetSiblingsSinglePicked(),d.SetIndex(t),l.Retrigger(o,_)}}return r.Pop(),u.Pop(),Fx.clearArray(f),Hx.Pop(),!1}*_DebugForEachOrdered(e,t){const s=e.GetCurrentSol(),n=s.GetInstances();if(0===n.length)return!1;const i=this._runtime.GetEventSheetManager(),r=i.GetEventStack(),a=i.GetCurrentCondition(),o=r.GetCurrentStackFrame(),l=o.GetCurrentEvent(),c=l.GetSolModifiers(),h=o.IsSolModifierAfterCnds(),_=r.Push(l),u=i.GetLoopStack(),d=u.Push(),p=e.IsInContainer(),f=Hx.Push();Fx.clearArray(f),d.SetEnd(n.length);for(let e=0,t=n.length;e<t;++e)f.push([n[e],a.ReevaluateParameter(1,e)]);if(f.sort(Lx),1===t&&f.reverse(),h)for(let t=0,s=f.length;t<s&&!d.IsStopped();++t){i.PushCopySol(c);const s=f[t][0];e.GetCurrentSol().SetSinglePicked(s),p&&s.SetSiblingsSinglePicked(),d.SetIndex(t),yield*l.DebugRetrigger(o,_),i.PopSol(c)}else{s._SetSelectAll(!1);const e=s._GetOwnInstances();Fx.clearArray(e),e.push(null);for(let t=0,s=f.length;t<s&&!d.IsStopped();++t){const s=f[t][0];e[0]=s,p&&s.SetSiblingsSinglePicked(),d.SetIndex(t),yield*l.DebugRetrigger(o,_)}}return r.Pop(),u.Pop(),Fx.clearArray(f),Hx.Pop(),!1}_GetFunctionMap(e,t){let s=this._functionMaps.get(e);return s||(t?(s={defaultFunc:null,strMap:new Map},this._functionMaps.set(e,s),s):null)}_DoCallMappedFunction(e,t,s,n,i){t.GetEventBlock().RunAsMappedFunctionCall(s,t.IsCopyPicked()),n&&e.PopSol(i)}*_DebugDoCallMappedFunction(e,t,s,n,i){yield*t.GetEventBlock().DebugRunAsMappedFunctionCall(s,t.IsCopyPicked()),n&&e.PopSol(i)}}}{const zx=self.C3;zx.Plugins.System.Type=class extends zx.DefendedBase{constructor(e){super(),this._objectClass=e,this._runtime=e.GetRuntime(),this._plugin=e.GetPlugin()}OnCreate(){}Release(){this._objectClass=null,this._runtime=null,this._plugin=null}}}{const Xx=self.C3;Xx.Plugins.System.Instance=class extends Xx.DefendedBase{constructor(e,t){super(),this._inst=e,this._objectClass=this._inst.GetObjectClass(),this._sdkType=this._objectClass.GetSdkType(),this._runtime=this._inst.GetRuntime()}Release(){this._inst=null,this._objectClass=null,this._sdkType=null,this._runtime=null}}}{const Yx=self.C3,qx=[];Yx.Plugins.System.Cnds={EveryTick:()=>!0,OnLayoutStart:()=>!0,OnLayoutEnd:()=>!0,OnSuspend:()=>!0,OnResume:()=>!0,IsSuspended(){return this._runtime.IsSuspended()},Else(){const e=this._runtime.GetCurrentEventStackFrame();return!e.GetElseBranchRan()&&!e.GetLastEventTrue()},TriggerOnce(){const e=this._runtime.GetCurrentCondition().GetSavedDataMap();let t=e.get("TriggerOnce_lastTick");void 0===t&&(t=-1,e.set("TriggerOnce_lastTick",-1));const s=this._runtime.GetTickCount();return e.set("TriggerOnce_lastTick",s),this._runtime.IsLayoutFirstTick()||t!==s-1},Every(e){const t=this._runtime.GetCurrentCondition().GetSavedDataMap(),s=t.get("Every_lastTime")||0,n=this._runtime.GetGameTime();t.has("Every_seconds")||t.set("Every_seconds",e);const i=t.get("Every_seconds");return n>=s+i?(t.set("Every_lastTime",s+i),n>=t.get("Every_lastTime")+.04&&t.set("Every_lastTime",n),t.set("Every_seconds",e),!0):(n<s-.1&&t.set("Every_lastTime",n),!1)},IsGroupActive(e){const t=this._runtime.GetEventSheetManager().GetEventGroupByName(e);return t&&t.IsGroupActive()},IsPreview(){return this._runtime.IsPreview()},IsMobile:()=>Yx.Platform.IsMobile,OnLoadFinished:()=>!0,OnCanvasSnapshot:()=>!0,EffectsSupported:()=>!0,OnSaveComplete:()=>!0,OnSaveFailed:()=>!0,OnLoadComplete:()=>!0,OnLoadFailed:()=>!0,ObjectUIDExists(e){return!!this._runtime.GetInstanceByUID(e)},IsOnPlatform(e){switch(e){case 0:return"browser"===Yx.Platform.Context;case 1:return"iOS"===Yx.Platform.OS;case 2:return"Android"===Yx.Platform.OS;case 8:return"cordova"===Yx.Platform.Context;case 9:return"scirra-arcade"===this._runtime.GetExportType();case 10:return"nwjs"===Yx.Platform.Context;case 13:return"windows-uwp"===this._runtime.GetExportType();default:return!1}},RegexTest(e,t,s){return this.GetRegex(t,s).test(e)},Compare:(e,t,s)=>Yx.compare(e,t,s),CompareBetween:(e,t,s)=>e>=t&&e<=s,CompareVar:(e,t,s)=>Yx.compare(e.GetValue(),t,s),CompareBoolVar:e=>!!e.GetValue(),CompareTime(e,t){const s=this._runtime.GetGameTime();if(0===e){const e=this._runtime.GetCurrentCondition().GetSavedDataMap();return!e.get("CompareTime_executed")&&s>=t&&(e.set("CompareTime_executed",!0),!0)}return Yx.compare(s,e,t)},IsNaN:e=>isNaN(e),AngleWithin:(e,t,s)=>Yx.angleDiff(Yx.toRadians(e),Yx.toRadians(s))<=Yx.toRadians(t),IsClockwiseFrom:(e,t)=>Yx.angleClockwise(Yx.toRadians(e),Yx.toRadians(t)),IsBetweenAngles(e,t,s){let n=Yx.toRadians(e),i=Yx.toRadians(t),r=Yx.toRadians(s);return Yx.angleClockwise(r,i)?Yx.angleClockwise(n,i)&&!Yx.angleClockwise(n,r):!(!Yx.angleClockwise(n,i)&&Yx.angleClockwise(n,r))},IsValueType:(e,t)=>"number"==typeof e?0===t:1===t,EvaluateExpression:e=>!!e,OnSignal(e){return e.toLowerCase()===this._runtime.GetEventSheetManager().GetCurrentSignalTag()},PickByComparison(e,t,s,n){if(!e)return!1;const i=this._GetForEachStack(),r=i.Push(),a=e.GetCurrentSol();Yx.shallowAssignArray(r,a.GetInstances()),a.IsSelectAll()&&Yx.clearArray(a._GetOwnElseInstances());const o=this._runtime.GetCurrentCondition();let l=0;for(let e=0,i=r.length;e<i;++e){const i=r[e];r[l]=i,t=o.ReevaluateParameter(1,e),n=o.ReevaluateParameter(3,e),Yx.compare(t,s,n)?++l:a._PushElseInstance(i)}Yx.truncateArray(r,l),a.SetArrayPicked(r);const c=!!r.length;return Yx.clearArray(r),i.Pop(),e.ApplySolToContainer(),c},PickByEvaluate(e,t){if(!e)return!1;const s=this._GetForEachStack(),n=s.Push(),i=e.GetCurrentSol();Yx.shallowAssignArray(n,i.GetInstances()),i.IsSelectAll()&&Yx.clearArray(i._GetOwnElseInstances());const r=this._runtime.GetCurrentCondition();let a=0;for(let e=0,t=n.length;e<t;++e){const t=n[e];n[a]=t,r.ReevaluateParameter(1,e)?++a:i._PushElseInstance(t)}Yx.truncateArray(n,a),i.SetArrayPicked(n);const o=!!n.length;return Yx.clearArray(n),s.Pop(),e.ApplySolToContainer(),o},PickByHighestLowestValue(e,t,s){if(!e)return!1;const n=e.GetCurrentSol(),i=n.GetInstances();if(0===i.length)return!1;const r=this._runtime.GetCurrentCondition();let a=null,o=0;for(let e=0,n=i.length;e<n;++e){const n=i[e];s=r.ReevaluateParameter(2,e),(null===a||0===t&&s<o||1===t&&s>o)&&(o=s,a=n)}return n.PickOne(a),e.ApplySolToContainer(),!0},PickNth(e,t){if(!e)return!1;const s=e.GetCurrentSol(),n=s.GetInstances();if((t=Math.floor(t))>=n.length)return!1;const i=n[t];return s.PickOne(i),e.ApplySolToContainer(),!0},PickRandom(e){if(!e)return!1;const t=e.GetCurrentSol(),s=t.GetInstances(),n=Math.floor(this._runtime.Random()*s.length);if(n>=s.length)return!1;const i=s[n];return t.PickOne(i),e.ApplySolToContainer(),!0},PickAll:e=>!!e&&(!!e.GetInstanceCount()&&(e.GetCurrentSol()._SetSelectAll(!0),e.ApplySolToContainer(),!0)),PickOverlappingPoint(e,t,s){if(!e)return!1;const n=e.GetCurrentSol(),i=n.GetInstances(),r=this._runtime.GetCurrentEvent().IsOrBlock(),a=this._runtime.GetCurrentCondition().IsInverted();n.IsSelectAll()?(Yx.shallowAssignArray(qx,i),n.ClearArrays(),n._SetSelectAll(!1)):r?(Yx.shallowAssignArray(qx,n._GetOwnElseInstances()),Yx.clearArray(n._GetOwnElseInstances())):(Yx.shallowAssignArray(qx,n._GetOwnInstances()),Yx.clearArray(n._GetOwnInstances()));for(let e=0,i=qx.length;e<i;++e){const i=qx[e];Yx.xor(i.GetWorldInfo().ContainsPoint(t,s),a)?n._PushInstance(i):n._PushElseInstance(i)}return e.ApplySolToContainer(),Yx.xor(!!n._GetOwnInstances().length,a)},PickLastCreated(e){if(!e)return!1;const t=e.IsFamily();let s=null;const n=this._runtime._GetInstancesPendingCreate();for(let i=n.length-1;i>=0;--i){const r=n[i];if(t){if(r.GetObjectClass().BelongsToFamily(e)){s=r;break}}else if(r.GetObjectClass()===e){s=r;break}}if(!s){const t=e.GetInstances();t.length&&(s=t.at(-1))}return!!s&&(e.GetCurrentSol().PickOne(s),e.ApplySolToContainer(),!0)},Repeat(e){return this._runtime.IsDebugging()?this._DebugRepeat(e):this._Repeat(e)},While(){return this._runtime.IsDebugging()?this._DebugWhile():this._While()},For(e,t,s){return this._runtime.IsDebugging()?this._DebugFor(e,t,s):this._For(e,t,s)},ForEach(e){return this._runtime.IsDebugging()?this._DebugForEach(e):this._ForEach(e)},ForEachOrdered(e,t,s){return this._runtime.IsDebugging()?this._DebugForEachOrdered(e,s):this._ForEachOrdered(e,s)},LayerVisible:e=>!!e&&e.IsVisible(),LayerInteractive:e=>!!e&&e.IsSelfAndParentsInteractive(),LayerIsHTML:e=>!!e&&e.IsHTMLElementsLayer(),LayerEmpty:e=>!!e&&!e.GetInstanceCount(),LayerCmpOpacity:(e,t,s)=>!!e&&Yx.compare(100*e.GetOpacity(),t,s),LayerNameExists(e){const t=this._runtime.GetMainRunningLayout();return!!t&&t.HasLayerByName(e)},OnImageLoadingComplete:()=>!0,IsLoadingImages(){return this._imagesLoadingTotal>0},TemplateExists(e,t){const s=this._runtime.GetTemplateManager();return!!s&&!!t&&!!s.GetTemplateData(e,t)}}}{let Jx=function(e,t){const s=e[0]-t[0];return 0!==s?s:e[1]-t[1]},Kx=function(e,t){return e[1]-t[1]};SortZOrderList=Jx,SortInstancesByValue=Kx;const $x=self.C3,Zx=[],Qx=[],eT=$x.New($x.Rect),tT=$x.New($x.Color),sT=[];$x.Plugins.System.Acts={SetVar(e,t){e.SetValue(t)},AddVar(e,t){e.IsNumber()&&"number"!=typeof t&&(t=parseFloat(t)),e.SetValue(e.GetValue()+t)},SubVar(e,t){e.IsNumber()&&e.SetValue(e.GetValue()-t)},SetBoolVar(e,t){e.SetValue(!!t)},ToggleBoolVar(e){e.SetValue(!e.GetValue())},ResetEventVar(e){e.SetValue(e.GetInitialValue())},ResetGlobals(e){this._runtime.GetEventSheetManager().ResetAllGlobalsToInitialValue(e)},CreateObject(e,t,s,n,i,r){if(!e||!t)return;const a=this._runtime.CreateInstance(e,t,s,n,i,r);if(!a)return;i&&t.SortAndAddInstancesByZIndex(a);const o=this._runtime.GetEventSheetManager();o.BlockFlushingInstances(!0),a._TriggerOnCreatedOnSelfAndRelated(),o.BlockFlushingInstances(!1);const l=new Map;a.CollectInstancesToPick(l,e,i);for(const[e,t]of l)e.GetCurrentSol().SetSetPicked(t)},CreateObjectByName(e,t,s,n,i,r){if(!e||!t)return;const a=this._runtime.GetObjectClassByName(e);a&&$x.Plugins.System.Acts.CreateObject.call(this,a,t,s,n,i,r)},RecreateInitialObjects(e,t,s,n,i,r,a,o,l,c,h){if(!e)return;const _=this._runtime.GetCurrentLayout();let u=_;if(r){const e=this._runtime.GetLayoutManager().GetLayoutByName(r);if(!e)return;u=e}let d=null;if(("number"!=typeof a||a>=0)&&(d=u.GetLayer(a),!d))return;let p=null;if(("number"!=typeof o||o>=0)&&(p=_.GetLayer(o),!p))return;eT.set(t,s,n,i);const f=u.RecreateInitialObjects(e,eT,d,p,l,c,h);e.GetCurrentSol().SetArrayPicked(f),e.ApplySolToContainer()},StopLoop(){const e=this._loopStack;e.IsInLoop()&&e.GetCurrent().Stop()},SetGroupActive(e,t){const s=this._runtime.GetEventSheetManager().GetEventGroupByName(e);s&&(0===t?s.SetGroupActive(!1):1===t?s.SetGroupActive(!0):s.SetGroupActive(!s.IsGroupActive()))},SetTimescale(e){this._runtime.SetTimeScale(e)},SetObjectTimescale(e,t){if(t<0&&(t=0),!e)return;const s=e.GetCurrentSol().GetInstances();for(const e of s)e.SetTimeScale(t)},RestoreObjectTimescale(e){if(!e)return;const t=e.GetCurrentSol().GetInstances();for(const e of t)e.RestoreTimeScale()},Wait(e,t){if(e<0)return;const s=this._runtime.GetEventSheetManager().AddScheduledWait();return t?s.InitTimer(e):s.InitWallTimer(e),!0},WaitForSignal(e){return this._runtime.GetEventSheetManager().AddScheduledWait().InitSignal(e),!0},WaitForPreviousActions(){const e=this._runtime.GetEventSheetManager();return e.AddScheduledWait().InitPromise(e.GetPromiseForAllAsyncActions()),!0},Signal(e){this._runtime.GetEventSheetManager().Signal(e)},async SnapshotCanvas(e,t,s,n,i,r){const a=this._runtime.GetCanvasManager();a&&(this.UpdateRender(),await a.SnapshotCanvas(0===e?"image/png":"image/jpeg",t/100,s,n,i,r),await this._runtime.TriggerAsync($x.Plugins.System.Cnds.OnCanvasSnapshot,null))},SetCanvasSize(e,t){if(e<=0||t<=0)return;this._runtime.SetViewportSize(e,t),this._runtime.GetCurrentLayout().BoundScrolling();const s=this._runtime.GetCanvasManager();s&&("off"===s.GetCurrentFullscreenMode()||this._runtime.SetOriginalViewportSize(e,t),s.SetSize(s.GetLastWidth(),s.GetLastHeight(),!0),this._runtime.UpdateRender())},SetFullscreenQuality(e){const t=this._runtime.GetCanvasManager();t&&"off"!==t.GetCurrentFullscreenMode()&&(t.SetFullscreenScalingQuality(0!==e?"high":"low"),t.SetSize(t.GetLastWidth(),t.GetLastHeight(),!0))},SaveState(e){this._runtime.SaveToSlot(e)},SaveStateJSON(){this._runtime.SaveToJsonString()},LoadState(e){this._runtime.LoadFromSlot(e)},LoadStateJSON(e){this._runtime.LoadFromJsonString(e)},SetHalfFramerateMode(e){},ResetPersisted(){for(const e of this._runtime.GetLayoutManager().GetAllLayouts())e.ResetPersistData()},SetPixelRounding(e){this._runtime.SetPixelRoundingEnabled(0!==e)},SetFramerateMinMax(e,t){this._runtime.SetMaxDt(1/e),this._runtime.SetMinDt(1/t)},SetDeltaTimeMinMax(e,t){this._runtime.SetMinDt(e),this._runtime.SetMaxDt(t)},SetFramerateMode(e){this._runtime._SetFramerateMode(["vsync","unlimited-tick","unlimited-frame"][e])},SortZOrderByInstVar(e,t){if(!e)return;const s=e.GetCurrentSol().GetInstances(),n=Zx,i=Qx,r=this._runtime.GetCurrentLayout(),a=e.IsFamily(),o=e.GetFamilyIndex();for(let e=0,r=s.length;e<r;++e){const r=s[e],l=r.GetWorldInfo();if(!l)continue;let c;c=a?r.GetInstanceVariableValue(t+r.GetObjectClass().GetFamilyInstanceVariableOffset(o)):r.GetInstanceVariableValue(t),n.push([l.GetLayer().GetIndex(),l.GetZIndex()]),i.push([r,c])}if(!n.length)return;n.sort(Jx),i.sort(Kx);let l=!1;for(let e=0,t=n.length;e<t;++e){const t=i[e][0],s=r.GetLayerByIndex(n[e][0]),a=n[e][1],o=s._GetInstances();o[a]!==t&&(o[a]=t,t.GetWorldInfo()._SetLayer(s,!0),s.SetZIndicesChanged(t),l=!0)}l&&this._runtime.UpdateRender(),$x.clearArray(Zx),$x.clearArray(Qx)},SetCollisionCellSize(e,t){e=Math.floor(e),t=Math.floor(t),e<=0||t<=0||!Number.isFinite(e)||!Number.isFinite(t)||this._runtime.GetCollisionEngine().SetCollisionCellSize(e,t)},GoToLayout(e){if(this._runtime.IsLoading())return;const t=this._runtime.GetLayoutManager();t.IsPendingChangeMainLayout()||t.ChangeMainLayout(e)},GoToLayoutByName(e){if(this._runtime.IsLoading())return;const t=this._runtime.GetLayoutManager();if(t.IsPendingChangeMainLayout())return;const s=t.GetLayoutByName(e);s&&t.ChangeMainLayout(s)},NextPrevLayout(e){if(this._runtime.IsLoading())return;const t=this._runtime.GetLayoutManager();if(t.IsPendingChangeMainLayout())return;const s=t.GetAllLayouts(),n=s.indexOf(t.GetMainRunningLayout());if(e&&0===n)return;if(!e&&n===s.length-1)return;const i=s[n+(e?-1:1)];t.ChangeMainLayout(i)},RestartLayout(){if(this._runtime.IsLoading())return;const e=this._runtime.GetLayoutManager();e.IsPendingChangeMainLayout()||(e.ChangeMainLayout(e.GetMainRunningLayout()),this._runtime.GetEventSheetManager().ResetAllGroupsInitialActivation())},SetLayerVisible(e,t){e&&e.SetVisible(t)},SetLayerInteractive(e,t){e&&e.SetInteractive(t)},SetLayerHTML(e,t){e&&e.SetIsHTMLElementsLayer(t)},SetLayerOpacity(e,t){e&&e.SetOpacity(t/100)},SetLayerScale(e,t){e&&e.SetOwnScale(t)},SetLayerScaleRate(e,t){e&&e.SetScaleRate(t)},SetLayerAngle(e,t){e&&e.SetAngle($x.toRadians(+t))},SetLayerScroll(e,t,s){e&&(e.SetOwnScrollPositionEnabled(!0),e.SetScrollX(t),e.SetScrollY(s))},RestoreLayerScroll(e){e&&e.SetOwnScrollPositionEnabled(!1)},SetLayerParallax(e,t,s){e&&e.SetParallax(t/100,s/100)},SetLayerZElevation(e,t){e&&e.SetZElevation(+t)},SetLayerRenderingMode(e,t){e&&e.SetRenderAs3D(1===t)},SetLayerBackground(e,t){if(!e)return;tT.setFromRgbValue(t),tT.clamp();const s=e.GetBackgroundColor();s.equalsIgnoringAlpha(tT)||(s.copyRgb(tT),this.UpdateRender())},SetLayerTransparent(e,t){e&&e.SetTransparent(t)},SetLayerBlendMode(e,t){e&&e.SetBlendMode(t)},SetLayerEffectEnabled(e,t,s){if(!e)return;const n=e.GetEffectList().GetEffectTypeByName(s);if(!n)return;const i=1===t;n.IsActive()!==i&&(n.SetActive(i),e.UpdateActiveEffects(),this._runtime.UpdateRender())},SetLayerEffectParam(e,t,s,n){if(!e)return;const i=e.GetEffectList(),r=i.GetEffectTypeByName(t);if(!r)return;s=Math.floor(s);const a=r.GetShaderProgram().GetParameterType(s);a&&("color"===a?(tT.setFromRgbValue(n),n=tT):"percent"===a&&(n/=100),i.SetEffectParameter(r.GetIndex(),s,n)&&r.IsActive()&&this._runtime.UpdateRender())},SetLayerForceOwnTexture(e,t){e&&e.SetForceOwnTexture(t)},SetLayoutScale(e){this._runtime.GetCurrentLayout().SetScale(+e)},SetLayoutAngle(e){this._runtime.GetCurrentLayout().SetAngle($x.toRadians(+e))},SetLayoutEffectEnabled(e,t){const s=this._runtime.GetCurrentLayout(),n=s.GetEffectList().GetEffectTypeByName(t);if(!n)return;const i=1===e;n.IsActive()!==i&&(n.SetActive(i),s.UpdateActiveEffects(),this._runtime.UpdateRender())},SetLayoutEffectParam(e,t,s){const n=this._runtime.GetCurrentLayout().GetEffectList(),i=n.GetEffectTypeByName(e);if(!i)return;t=Math.floor(t);const r=i.GetShaderProgram().GetParameterType(t);r&&("color"===r?(tT.setFromRgbValue(s),s=tT):"percent"===r&&(s/=100),n.SetEffectParameter(i.GetIndex(),t,s)&&i.IsActive()&&this._runtime.UpdateRender())},SetLayoutVanishingPoint(e,t){this._runtime.GetCurrentLayout().SetVanishingPointXY(e/100,t/100)},SetLayoutProjection(e){const t=this._runtime.GetCurrentLayout();0===e?t.SetPerspectiveProjection():t.SetOrthographicProjection()},ScrollX(e){this._runtime.GetCurrentLayout().SetScrollX(e)},ScrollY(e){this._runtime.GetCurrentLayout().SetScrollY(e)},Scroll(e,t){const s=this._runtime.GetCurrentLayout();s.SetScrollX(e),s.SetScrollY(t)},ScrollToObject(e){if(!e)return;const t=e.GetFirstPicked();if(!t)return;const s=t.GetWorldInfo();if(!s)return;const n=this._runtime.GetCurrentLayout();n.SetScrollX(s.GetX()),n.SetScrollY(s.GetY())},AddLayer(e,t,s){const n=this._runtime.GetCurrentLayout();try{n.AddLayer(e,t,s)}catch(e){console.warn("[Construct] Cannot add layer: ",e)}},MoveLayer(e,t,s){if(!e)return;const n=this._runtime.GetCurrentLayout();try{n.MoveLayer(e,t,s)}catch(e){console.warn("[Construct] Cannot move layer: ",e)}},RemoveLayer(e){e&&this._runtime.GetCurrentLayout().RemoveLayer(e)},RemoveAllDynamicLayers(){this._runtime.GetCurrentLayout().RemoveAllDynamicLayers()},async LoadObjectTextures(e){const t=this._runtime.GetMainRunningLayout();if(!t||!e||this._runtime.IsLoading())return;const s=e.IsFamily()?e.GetFamilyMembers():[e];await this._LoadTexturesForObjectClasses(t,s)},async LoadObjectTexturesByName(e){await $x.Plugins.System.Acts.LoadObjectTextures.call(this,this._runtime.GetObjectClassByName(e))},UnloadObjectTextures(e){const t=this._runtime.GetMainRunningLayout();if(!t||!e)return;const s=e.IsFamily()?e.GetFamilyMembers():[e];this._UnloadTexturesForObjectClasses(t,s)},UnloadObjectTexturesByName(e){$x.Plugins.System.Acts.UnloadObjectTextures.call(this,this._runtime.GetObjectClassByName(e))},UnloadUnusedTextures(){const e=this._runtime.GetMainRunningLayout();if(!e)return;const t=e._GetTextureLoadedObjectTypes();this._UnloadTexturesForObjectClasses(e,t)},async LoadLayoutTextures(e){const t=this._runtime.GetMainRunningLayout();e&&t&&!this._runtime.IsLoading()&&await this._LoadTexturesForObjectClasses(t,e._GetInitialObjectClasses())},async LoadLayoutTexturesByName(e){const t=this._runtime.GetMainRunningLayout(),s=this._runtime.GetLayoutManager().GetLayoutByName(e);s&&t&&!this._runtime.IsLoading()&&await this._LoadTexturesForObjectClasses(t,s._GetInitialObjectClasses())},SetFunctionReturnValue(e){const t=this._eventStack.GetCurrentExpFuncStackFrame();if(t)switch(t.GetFunctionReturnType()){case 1:"number"==typeof e&&t.SetFunctionReturnValue(e);break;case 2:"string"==typeof e&&t.SetFunctionReturnValue(e);break;case 3:t.SetFunctionReturnValue(e)}},MapFunction(e,t,s){const n=this._GetFunctionMap(e.toLowerCase(),!0),i=n.strMap,r=t.toLowerCase();i.has(r)&&console.warn(`[Construct] Function map '${e}' string '${t}' already in map; overwriting entry`);const a=$x.first(i.values())||n.defaultFunc;a&&0!==a.GetReturnType()!=(0!==s.GetReturnType())?console.error(`[Construct] Function map '${e}' string '${t}' function return type not compatible with other functions in the map; entry ignored`):i.set(r,s)},MapFunctionDefault(e,t){const s=this._GetFunctionMap(e.toLowerCase(),!0);s.defaultFunc&&console.warn(`[Construct] Function map '${e}' already has a default; overwriting entry`);const n=$x.first(s.strMap.values())||s.defaultFunc;n&&0!==n.GetReturnType()!=(0!==t.GetReturnType())?console.error(`[Construct] Function map '${e}' default: function return type not compatible with other functions in the map; entry ignored`):s.defaultFunc=t},CallMappedFunction(e,t,s){const n=this._runtime,i=n.IsDebugging()?sT:null;s=Math.floor(s);const r=this._GetFunctionMap(e.toLowerCase(),!1);if(!r)return console.warn(`[Construct] Call mapped function: map name '${e}' not found; call ignored`),i;let a=r.strMap.get(t.toLowerCase());if(!a){if(!r.defaultFunc)return console.warn(`[Construct] Call mapped function: no function associated with map '${e}' string '${t}'; call ignored (consider setting a default)`),i;a=r.defaultFunc,s=0}if(!a.IsEnabled())return i;if(0!==a.GetReturnType())return console.warn(`[Construct] Call mapped function: map '${e}' string '${t}' has a return type so cannot be called`),i;const o=n.GetEventSheetManager(),l=o.GetCurrentEvent(),c=l.GetSolModifiersIncludingParents(),h=c.length>0;h&&(a.IsCopyPicked()?o.PushCopySol(c):o.PushCleanSol(c));const _=[],u=o.FindFirstFunctionBlockParent(l);if(u){const e=u.GetFunctionParameters();for(let t=s,n=e.length;t<n;++t)_.push(e[t].GetValue())}const d=a.GetFunctionParameters();for(let e=_.length,t=d.length;e<t;++e)_.push(d[e].GetInitialValue());return n.IsDebugging()?this._DebugDoCallMappedFunction(o,a,_,h,c):this._DoCallMappedFunction(o,a,_,h,c)}}}{const nT=self.C3;nT.Plugins.System.Exps={int:function(e){return"string"==typeof e&&(e=parseInt(e,10),isNaN(e)&&(e=0)),Math.floor(e)},float:function(e){return"string"==typeof e&&(e=parseFloat(e),isNaN(e)&&(e=0)),e},str:e=>e.toString(),len:e=>"string"==typeof e?e.length:0,random(e,t){return void 0===t?this._runtime.Random()*e:this._runtime.Random()*(t-e)+e},choose(...e){return e[Math.floor(this._runtime.Random()*e.length)]},chooseindex:(e,...t)=>("number"!=typeof e&&(e=0),t[e=nT.clamp(Math.floor(e),0,t.length-1)]),pi:()=>Math.PI,infinity:()=>1/0,sqrt:e=>Math.sqrt(e),abs:e=>Math.abs(e),round:e=>Math.round(e),roundtodp(e,t){t=Math.max(Math.floor(t),0);const s=Math.pow(10,t);return Math.round((e+Number.EPSILON)*s)/s},floor:e=>Math.floor(e),ceil:e=>Math.ceil(e),sign:e=>Math.sign(e),sin:e=>Math.sin(nT.toRadians(e)),cos:e=>Math.cos(nT.toRadians(e)),tan:e=>Math.tan(nT.toRadians(e)),asin:e=>nT.toDegrees(Math.asin(e)),acos:e=>nT.toDegrees(Math.acos(e)),atan:e=>nT.toDegrees(Math.atan(e)),exp:e=>Math.exp(e),ln:e=>Math.log(e),log10:e=>Math.log10(e),max(...e){let t=e[0];"number"!=typeof t&&(t=0);for(let s=1,n=e.length;s<n;++s){let n=e[s];"number"==typeof n&&t<n&&(t=n)}return t},min(...e){let t=e[0];"number"!=typeof t&&(t=0);for(let s=1,n=e.length;s<n;++s){let n=e[s];"number"==typeof n&&t>n&&(t=n)}return t},clamp:(e,t,s)=>nT.clamp(e,t,s),distance:(e,t,s,n)=>nT.distanceTo(e,t,s,n),angle:(e,t,s,n)=>nT.toDegrees(nT.angleTo(e,t,s,n)),lerp:(e,t,s)=>nT.lerp(e,t,s),unlerp:(e,t,s)=>nT.unlerp(e,t,s),qarp:(e,t,s,n)=>nT.qarp(e,t,s,n),cubic:(e,t,s,n,i)=>nT.cubic(e,t,s,n,i),cosp:(e,t,s)=>nT.cosp(e,t,s),anglediff:(e,t)=>nT.toDegrees(nT.angleDiff(nT.toRadians(e),nT.toRadians(t))),anglelerp:(e,t,s)=>nT.toDegrees(nT.angleLerp(nT.toRadians(e),nT.toRadians(t),s)),anglerotate:(e,t,s)=>nT.toDegrees(nT.angleRotate(nT.toRadians(e),nT.toRadians(t),nT.toRadians(s))),setbit:(e,t,s)=>(e|=0)&~(1<<(t|=0))|(s=0!==s?1:0)<<t,togglebit:(e,t)=>(e|=0)^1<<t,getbit:(e,t)=>(e|=0)&1<<(t|=0)?1:0,newline:()=>"\n",uppercase:e=>"string"==typeof e?e.toUpperCase():"",lowercase:e=>"string"==typeof e?e.toLowerCase():"",left:(e,t)=>"string"==typeof e?e.substr(0,t):"",mid:(e,t,s)=>"string"!=typeof e?"":s<0?e.substr(t):e.substr(t,s),right:(e,t)=>"string"==typeof e?e.substr(Math.max(e.length-t,0)):"",trim:e=>"string"==typeof e?e.trim():"",tokenat(e,t,s){if("string"!=typeof e||"string"!=typeof s)return"";let n=e.split(s);return(t=Math.floor(t))<0||t>=n.length?"":n[t]},tokencount:(e,t)=>"string"==typeof e&&"string"==typeof t&&e.length?e.split(t).length:0,find:(e,t)=>"string"==typeof e&&"string"==typeof t?e.search(new RegExp(nT.EscapeRegex(t),"i")):-1,findcase:(e,t)=>"string"==typeof e&&"string"==typeof t?e.search(new RegExp(nT.EscapeRegex(t),"")):-1,replace:(e,t,s)=>"string"==typeof e&&"string"==typeof t&&"string"==typeof s?e.replace(new RegExp(nT.EscapeRegex(t),"gi"),s):"string"==typeof e?e:"",stringsub(e,...t){let s=e;for(let e=0,n=t.length;e<n;++e)s=s.replaceAll(`{${e}}`,t[e].toString());return s},regexsearch(e,t,s){const n=this.GetRegex(t,s);return e?e.search(n):-1},regexreplace(e,t,s,n){const i=this.GetRegex(t,s);return e?e.replace(i,n):""},regexmatchcount(e,t,s){const n=this.GetRegexMatches(e.toString(),t,s);return n?n.length:0},regexmatchat(e,t,s,n){n=Math.floor(n);const i=this.GetRegexMatches(e.toString(),t,s);return!i||n<0||n>=i.length?"":i[n]},zeropad(e,t){let s=e<0?"-":"";e<0&&(e=-e);const n=t-e.toString().length;return s+="0".repeat(Math.max(n,0)),s+e.toString()},urlencode:e=>encodeURIComponent(e),urldecode:e=>decodeURIComponent(e),dt(){return this._runtime._GetDtFast()},wallclockdt(){return this._runtime.GetDt1()},timescale(){return this._runtime.GetTimeScale()},wallclocktime(){return(Date.now()-this._runtime.GetStartTime())/1e3},unixtime:()=>Date.now(),time(){return this._runtime.GetGameTime()},tickcount(){return this._runtime.GetTickCount()},objectcount(){return this._runtime.GetObjectCount()},fps(){return this._runtime.GetFramesPerSecond()},cpuutilisation(){return this._runtime.GetMainThreadTime()},gpuutilisation(){return this._runtime.GetGPUUtilisation()},windowwidth(){return this._runtime.GetCanvasManager().GetDeviceWidth()},windowheight(){return this._runtime.GetCanvasManager().GetDeviceHeight()},originalwindowwidth(){return this._runtime.GetOriginalViewportWidth()},originalwindowheight(){return this._runtime.GetOriginalViewportHeight()},originalviewportwidth(){return this._runtime.GetOriginalViewportWidth()},originalviewportheight(){return this._runtime.GetOriginalViewportHeight()},scrollx(){return this._runtime.GetCurrentLayout().GetScrollX()},scrolly(){return this._runtime.GetCurrentLayout().GetScrollY()},layoutname(){return this._runtime.GetCurrentLayout().GetName()},layoutscale(){return this._runtime.GetCurrentLayout().GetScale()},layoutangle(){return nT.toDegrees(this._runtime.GetCurrentLayout().GetAngle())},layoutwidth(){return this._runtime.GetCurrentLayout().GetWidth()},layoutheight(){return this._runtime.GetCurrentLayout().GetHeight()},vanishingpointx(){return 100*this._runtime.GetCurrentLayout().GetVanishingPointX()},vanishingpointy(){return 100*this._runtime.GetCurrentLayout().GetVanishingPointY()},viewportleft(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().getLeft():0},viewporttop(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().getTop():0},viewportright(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().getRight():0},viewportbottom(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().getBottom():0},viewportwidth(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().width():0},viewportheight(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetViewport3D().height():0},viewportmidx(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);if(t){const e=t.GetViewport3D();return(e.getLeft()+e.getRight())/2}return 0},viewportmidy(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);if(t){const e=t.GetViewport3D();return(e.getTop()+e.getBottom())/2}return 0},canvastolayerx(e,t,s){const n=this._runtime.GetCurrentLayout().GetLayer(e);return n?n.CanvasCssToLayer(t,s)[0]:0},canvastolayery(e,t,s){const n=this._runtime.GetCurrentLayout().GetLayer(e);return n?n.CanvasCssToLayer(t,s)[1]:0},layertocanvasx(e,t,s){const n=this._runtime.GetCurrentLayout().GetLayer(e);return n?n.LayerToCanvasCss(t,s)[0]:0},layertocanvasy(e,t,s){const n=this._runtime.GetCurrentLayout().GetLayer(e);return n?n.LayerToCanvasCss(t,s)[1]:0},layertolayerx(e,t,s,n){const i=this._runtime.GetCurrentLayout(),r=i.GetLayer(e),a=i.GetLayer(t);if(!r||!a||r===a)return s;const[o,l]=r.LayerToCanvasCss(s,n);return a.CanvasCssToLayer(o,l)[0]},layertolayery(e,t,s,n){const i=this._runtime.GetCurrentLayout(),r=i.GetLayer(e),a=i.GetLayer(t);if(!r||!a||r===a)return n;const[o,l]=r.LayerToCanvasCss(s,n);return a.CanvasCssToLayer(o,l)[1]},layerscale(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetOwnScale():0},layerangle(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?nT.toDegrees(t.GetOwnAngle()):0},layeropacity(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?100*t.GetOpacity():0},layerscalerate(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetScaleRate():0},layerscrollx(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetScrollX():0},layerscrolly(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetScrollY():0},layerparallaxx(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?100*t.GetParallaxX():0},layerparallaxy(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?100*t.GetParallaxY():0},layerzelevation(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetZElevation():0},layerindex(e){const t=this._runtime.GetCurrentLayout().GetLayer(e);return t?t.GetIndex():-1},canvassnapshot(){const e=this._runtime.GetCanvasManager();return e?e.GetCanvasSnapshotUrl():""},loopindex(e){const t=this._loopStack;if(!t.IsInLoop())return 0;if(e){const s=t.FindByName(e);return s?s.GetIndex():0}return t.GetCurrent().GetIndex()},savestatejson(){return this._runtime.GetLastSaveJsonString()},callmapped(e,t,...s){const n=this._GetFunctionMap(e.toLowerCase(),!1);if(!n)return console.warn(`[Construct] Call mapped function: map name '${e}' not found; returning 0`),0;let i=n.strMap.get(t.toLowerCase());if(!i){if(!n.defaultFunc)return console.warn(`[Construct] Call mapped function: no function associated with map '${e}' string '${t}'; returning 0 (consider setting a default)`),0;i=n.defaultFunc}const r=i.GetReturnType(),a=i.GetDefaultReturnValue();if(0===r)return console.warn(`[Construct] Call mapped function: map '${e}' string '${t}' has no return type so cannot be called from an expression; returning 0`),0;if(!i.IsEnabled())return a;const o=this._runtime.GetEventSheetManager(),l=o.GetCurrentEvent().GetSolModifiersIncludingParents(),c=l.length>0;c&&(i.IsCopyPicked()?o.PushCopySol(l):o.PushCleanSol(l));const h=i.GetFunctionParameters();for(let e=s.length,t=h.length;e<t;++e)s.push(h[e].GetInitialValue());const _=i.GetEventBlock(),u=_.RunAsExpressionFunctionCall(_.GetSolModifiersIncludingParents(),i.IsCopyPicked(),r,a,...s);return c&&o.PopSol(l),u},loadingprogress(){return this._runtime.GetAssetManager().GetLoadProgress()},imageloadingprogress(){return this.GetImageLoadingProgress()},renderer(){return this._runtime.GetWebGPURenderer()?"webgpu":"webgl"},rendererdetail(){return this._runtime.GetWebGPURenderer()?this._runtime.GetWebGPURenderer().GetAdapterInfoString():this._runtime.GetWebGLRenderer().GetUnmaskedRenderer()},imagememoryusage(){let e=this._runtime.GetRenderer().GetEstimatedTextureMemoryUsage();return Math.round(100*e/1048576)/100},rgb:(e,t,s)=>nT.PackRGB(e,t,s),rgbex:(e,t,s)=>nT.PackRGBEx(e/100,t/100,s/100),rgba:(e,t,s,n)=>nT.PackRGBAEx(e/100,t/100,s/100,n/100),rgbex255:(e,t,s)=>nT.PackRGBEx(e/255,t/255,s/255),rgba255:(e,t,s,n)=>nT.PackRGBAEx(e/255,t/255,s/255,n/255),projectname(){return this._runtime.GetProjectName()},projectversion(){return this._runtime.GetProjectVersion()},projectid(){return this._runtime.GetAppId()},projectuniqueid(){return this._runtime.GetProjectUniqueId()},currenteventsheetname(){return this._runtime.GetCurrentEvent().GetEventSheet().GetName()},currenteventnumber(){return this._runtime.GetCurrentEvent().GetDisplayNumber()}}}{const iT=self.C3;iT.Plugins.AJAX=class extends iT.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const rT=self.C3;rT.Plugins.AJAX.Type=class extends rT.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const aT=self.C3;aT.Plugins.AJAX.Instance=class extends aT.SDKInstanceBase{constructor(e,t){if(super(e),this._lastData="",this._lastStatusCode=0,this._curTag="",this._progress=0,this._timeout=-1,this._nextRequestHeaders=new Map,this._nextReponseBinaryData=null,this._nextRequestOverrideMimeType="",this._nextRequestWithCredentials=!1,this._nwjsFs=null,this._nwjsPath=null,this._nwjsAppFolder=null,this._isNWjs=this._runtime.IsNWjs(),this._isNWjs){this._nwjsFs=__require("fs"),this._nwjsPath=__require("path");const e=self.process||nw.process;this._nwjsAppFolder=this._nwjsPath.dirname(e.execPath)+"\\"}}Release(){super.Release()}async _TriggerError(e,t,s){console.error(`[Construct] AJAX request to '${t}' (tag '${e}') failed: `,s),this._curTag=e,await this.TriggerAsync(aT.Plugins.AJAX.Cnds.OnAnyError),this._curTag=e,await this.TriggerAsync(aT.Plugins.AJAX.Cnds.OnError)}async _TriggerComplete(e){this._curTag=e,await this.TriggerAsync(aT.Plugins.AJAX.Cnds.OnAnyComplete),this._curTag=e,await this.TriggerAsync(aT.Plugins.AJAX.Cnds.OnComplete)}async _OnProgress(e,t){t.lengthComputable&&(this._progress=t.loaded/t.total,this._curTag=e,await this.TriggerAsync(aT.Plugins.AJAX.Cnds.OnProgress))}async _OnUploadProgress(e,t){t.lengthComputable&&(this._progress=t.loaded/t.total,this._curTag=e,await this.TriggerAsync(aT.Plugins.AJAX.Cnds.OnUploadProgress))}_OnError(e,t,s){if(!this._isNWjs)return void this._TriggerError(e,t,s);const n=this._nwjsFs,i=this._nwjsAppFolder+t;n.existsSync(i)?n.readFile(i,{encoding:"utf8"},((s,n)=>{s?this._TriggerError(e,t,s):(this._lastData=n.replace(/\r\n/g,"\n"),this._TriggerComplete(e))})):this._TriggerError(e,t,s)}async _DoCordovaRequest(e,t){const s=this._runtime.GetAssetManager(),n=this._nextReponseBinaryData;this._nextReponseBinaryData=null;try{if(n){const i=await s.CordovaFetchLocalFileAsArrayBuffer(t);n.SetArrayBufferTransfer(i),this._lastData="",this._lastStatusCode=0,this._TriggerComplete(e)}else{const n=await s.CordovaFetchLocalFileAsText(t);this._lastData=n.replace(/\r\n/g,"\n"),this._lastStatusCode=0,this._TriggerComplete(e)}}catch(s){this._TriggerError(e,t,s)}}_DoRequest(e,t,s,n){return new Promise((i=>{const r=s=>{this._OnError(e,t,s),i()},a=this._nextReponseBinaryData;this._nextReponseBinaryData=null;try{const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(4===o.readyState){if(this._lastData=a?"":(o.responseText||"").replace(/\r\n/g,"\n"),this._lastStatusCode=o.status,o.status>=400)this._TriggerError(e,t,o.status+o.statusText);else{const t=this._lastData.length||a&&o.response instanceof ArrayBuffer;this._isNWjs&&!t||!this._isNWjs&&0===o.status&&!t||(a&&a.SetArrayBufferTransfer(o.response),this._TriggerComplete(e))}i()}},o.onerror=r,o.ontimeout=r,o.onabort=r,o.onprogress=t=>this._OnProgress(e,t),o.upload.onprogress=t=>this._OnUploadProgress(e,t),o.open(s,t),this._timeout>=0&&void 0!==o.timeout&&(o.timeout=this._timeout),o.responseType=a?"arraybuffer":"text",n&&!this._nextRequestHeaders.has("Content-Type")&&("string"!=typeof n?o.setRequestHeader("Content-Type","application/octet-stream"):o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));for(const[e,t]of this._nextRequestHeaders)try{o.setRequestHeader(e,t)}catch(s){console.error(`[Construct] AJAX: Failed to set header '${e}: ${t}': `,s)}if(this._nextRequestHeaders.clear(),this._nextRequestOverrideMimeType){try{o.overrideMimeType(this._nextRequestOverrideMimeType)}catch(e){console.error("[Construct] AJAX: failed to override MIME type: ",e)}this._nextRequestOverrideMimeType=""}this._nextRequestWithCredentials&&(o.withCredentials=!0,this._nextRequestWithCredentials=!1),n?o.send(n):o.send()}catch(e){r(e)}}))}GetDebuggerProperties(){const e="plugins.ajax.debugger";return[{title:e+".title",properties:[{name:e+".last-status-code",value:this._lastStatusCode},{name:e+".last-data",value:this._lastData}]}]}SaveToJson(){return{lastData:this._lastData,lastStatusCode:this._lastStatusCode}}LoadFromJson(e){this._lastData=e.lastData,this._lastStatusCode=e.hasOwnProperty("lastStatusCode")?e.lastStatusCode:0,this._curTag="",this._progress=0}}}{const oT=self.C3;oT.Plugins.AJAX.Cnds={OnComplete(e){return oT.equalsNoCase(this._curTag,e)},OnAnyComplete:()=>!0,OnError(e){return oT.equalsNoCase(this._curTag,e)},OnAnyError:()=>!0,OnProgress(e){return oT.equalsNoCase(this._curTag,e)},OnUploadProgress(e){return oT.equalsNoCase(this._curTag,e)}}}{const lT=self.C3;lT.Plugins.AJAX.Acts={async Request(e,t){this._runtime.IsCordova()&&lT.IsRelativeURL(t)&&this._runtime.GetAssetManager().IsFileProtocol()?await this._DoCordovaRequest(e,t):await this._DoRequest(e,t,"GET",null)},async RequestFile(e,t){this._runtime.IsCordova()&&this._runtime.GetAssetManager().IsFileProtocol()?await this._DoCordovaRequest(e,t):await this._DoRequest(e,t,"GET",null)},async Post(e,t,s,n){await this._DoRequest(e,t,n,s)},async PostBinary(e,t,s,n){if(!s)return;const i=s.GetFirstPicked(this._inst);if(!i)return;const r=i.GetSdkInstance().GetArrayBufferReadOnly();await this._DoRequest(e,t,n,r)},SetTimeout(e){this._timeout=1e3*e},SetHeader(e,t){this._nextRequestHeaders.set(e,t)},SetResponseBinary(e){if(!e)return;const t=e.GetFirstPicked(this._inst);t&&(this._nextReponseBinaryData=t.GetSdkInstance())},OverrideMIMEType(e){this._nextRequestOverrideMimeType=e},SetWithCredentials(e){this._nextRequestWithCredentials=!!e}}}self.C3.Plugins.AJAX.Exps={LastData(){return this._lastData},LastStatusCode(){return this._lastStatusCode},Progress(){return this._progress},Tag(){return this._curTag}};{const cT=self.C3;cT.Plugins.Arr=class extends cT.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const hT=self.C3;hT.Plugins.Arr.Type=class extends hT.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{let _T=function(e,t,s){if(t<e.length)uT.truncateArray(e,t);else if(t>e.length)if("function"==typeof s)for(let n=e.length;n<t;++n)e.push(s());else for(let n=e.length;n<t;++n)e.push(s)};ResizeArray=_T;const uT=self.C3,dT=self.C3X,pT=self.IInstance;uT.Plugins.Arr.Instance=class extends uT.SDKInstanceBase{constructor(e,t){super(e),this._cx=10,this._cy=1,this._cz=1,this._arr=null,this._forX=[],this._forY=[],this._forZ=[],this._forDepth=-1,t&&(this._cx=t[0],this._cy=t[1],this._cz=t[2]),this._arr=uT.MakeFilledArray(this._cx,(()=>uT.MakeFilledArray(this._cy,(()=>uT.MakeFilledArray(this._cz,0)))))}Release(){this._arr=null,super.Release()}At(e,t,s){return e=Math.floor(e),t=Math.floor(t),s=Math.floor(s),e>=0&&e<this._cx&&t>=0&&t<this._cy&&s>=0&&s<this._cz?this._arr[e][t][s]:0}Set(e,t,s,n){e=Math.floor(e),t=Math.floor(t),s=Math.floor(s),e>=0&&e<this._cx&&t>=0&&t<this._cy&&s>=0&&s<this._cz&&(this._arr[e][t][s]=n)}SetSize(e,t,s){if(e=Math.floor(e),t=Math.floor(t),s=Math.floor(s),e<0&&(e=0),t<0&&(t=0),s<0&&(s=0),this._cx===e&&this._cy===t&&this._cz===s)return;this._cx=e,this._cy=t,this._cz=s;const n=this._arr;_T(n,e,(()=>uT.MakeFilledArray(t,(()=>uT.MakeFilledArray(s,0)))));for(let i=0;i<e;++i){_T(n[i],t,(()=>uT.MakeFilledArray(s,0)));for(let e=0;e<t;++e)_T(n[i][e],s,0)}}GetWidth(){return this._cx}GetHeight(){return this._cy}GetDepth(){return this._cz}_ShuffleHelper(e,t,s,n,i){for(;t>0;){const r=Math.floor(this._runtime.Random()*t);if(--t,0===e){const e=this.At(t,n,i),s=this.At(r,n,i);this.Set(t,n,i,s),this.Set(r,n,i,e)}else if(1===e){const e=this.At(s,t,i),n=this.At(s,r,i);this.Set(s,t,i,n),this.Set(s,r,i,e)}else if(2===e){const e=this.At(s,n,t),i=this.At(s,n,r);this.Set(s,n,t,i),this.Set(s,n,r,e)}}}GetDebuggerProperties(){const e="plugins.arr.debugger",t="plugins.arr.properties",s=[{title:e+".array-properties.title",properties:[{name:t+".width.name",value:this._cx,onedit:e=>this.SetSize(e,this._cy,this._cz)},{name:t+".height.name",value:this._cy,onedit:e=>this.SetSize(this._cx,e,this._cz)},{name:t+".depth.name",value:this._cz,onedit:e=>this.SetSize(this._cx,this._cy,e)},{name:t+".elements.name",value:this._cx*this._cy*this._cz}]}],n=[];if(1===this._cy&&1===this._cz)for(let e=0;e<this._cx;++e)n.push({name:"$"+e,value:this._arr[e][0][0],onedit:t=>this._arr[e][0][0]=t});else for(let e=0;e<this._cx;++e)n.push({name:"$"+e,value:this._arr[e].toString()});return n.length&&s.push({title:e+".array-data.title",properties:n}),s}GetAsJsonString(){return JSON.stringify({c2array:!0,size:[this._cx,this._cy,this._cz],data:this._arr})}SaveToJson(){return{size:[this._cx,this._cy,this._cz],data:this._arr}}LoadFromJson(e){const t=e.size;this._cx=t[0],this._cy=t[1],this._cz=t[2],this._arr=e.data}_GetForX(){return this._forDepth>=0&&this._forDepth<this._forX.length?this._forX[this._forDepth]:0}_GetForY(){return this._forDepth>=0&&this._forDepth<this._forY.length?this._forY[this._forDepth]:0}_GetForZ(){return this._forDepth>=0&&this._forDepth<this._forZ.length?this._forZ[this._forDepth]:0}GetScriptInterfaceClass(){return self.IArrayInstance}};const fT=new WeakMap;self.IArrayInstance=class extends pT{constructor(){super(),fT.set(this,pT._GetInitInst().GetSdkInstance())}get width(){return fT.get(this).GetWidth()}get height(){return fT.get(this).GetHeight()}get depth(){return fT.get(this).GetDepth()}setSize(e,t=1,s=1){dT.RequireFiniteNumber(e),dT.RequireFiniteNumber(t),dT.RequireFiniteNumber(s),fT.get(this).SetSize(e,t,s)}getAt(e,t=0,s=0){return dT.RequireFiniteNumber(e),dT.RequireFiniteNumber(t),dT.RequireFiniteNumber(s),fT.get(this).At(e,t,s)}setAt(e,t,s=0,n=0){if(dT.RequireFiniteNumber(t),dT.RequireFiniteNumber(s),dT.RequireFiniteNumber(n),"number"!=typeof e&&"string"!=typeof e)throw new TypeError("invalid type");fT.get(this).Set(t,s,n,e)}}}{let mT=function(e,t,s,n,i,r){e.PushCopySol(s),r.GetObjectClass().GetCurrentSol().PickOne(r.GetInstance()),t.Retrigger(n,i),e.PopSol(s)};DoForEachTrigger=mT;const gT=self.C3;gT.Plugins.Arr.Cnds={CompareX(e,t,s){return gT.compare(this.At(e,0,0),t,s)},CompareXY(e,t,s,n){return gT.compare(this.At(e,t,0),s,n)},CompareXYZ(e,t,s,n,i){return gT.compare(this.At(e,t,s),n,i)},ArrForEach(e){const t=this._runtime,s=t.GetEventSheetManager(),n=t.GetCurrentEvent(),i=n.GetSolModifiers(),r=t.GetEventStack(),a=r.GetCurrentStackFrame(),o=r.Push(n),l=++this._forDepth,c=this._forX,h=this._forY,_=this._forZ,u=this._cx,d=this._cy,p=this._cz;if(l===this._forX.length?(c.push(0),h.push(0),_.push(0)):(c[l]=0,h[l]=0,_[l]=0),t.SetDebuggingEnabled(!1),0===e)for(let e=0;e<u;++e)for(let t=0;t<d;++t)for(let r=0;r<p;++r)c[l]=e,h[l]=t,_[l]=r,mT(s,n,i,a,o,this);else if(1===e)for(let e=0;e<u;++e)for(let t=0;t<d;++t)c[l]=e,h[l]=t,mT(s,n,i,a,o,this);else for(let e=0;e<u;++e)c[l]=e,mT(s,n,i,a,o,this);return t.SetDebuggingEnabled(!0),this._forDepth--,r.Pop(),!1},CompareCurrent(e,t){return gT.compare(this.At(this._GetForX(),this._GetForY(),this._GetForZ()),e,t)},Contains(e){const t=this._cx,s=this._cy,n=this._cz,i=this._arr;for(let r=0;r<t;++r)for(let t=0;t<s;++t)for(let s=0;s<n;++s)if(i[r][t][s]===e)return!0;return!1},IsEmpty(){return 0===this._cx||0===this._cy||0===this._cz},CompareSize(e,t,s){let n=0;switch(e){case 0:n=this._cx;break;case 1:n=this._cy;break;case 2:n=this._cz}return gT.compare(n,t,s)}}}{let IT=function(e,t){if("number"==typeof e&&"number"==typeof t)return e-t;{const s=e.toString(),n=t.toString();return s<n?-1:s>n?1:0}};CompareValues=IT;const ST=self.C3;ST.Plugins.Arr.Acts={Clear(e){const t=this._cx,s=this._cy,n=this._cz,i=this._arr;for(let r=0;r<t;++r)for(let t=0;t<s;++t)for(let s=0;s<n;++s)i[r][t][s]=e},SetSize(e,t,s){this.SetSize(e,t,s)},SetX(e,t){this.Set(e,0,0,t)},SetXY(e,t,s){this.Set(e,t,0,s)},SetXYZ(e,t,s,n){this.Set(e,t,s,n)},Push(e,t,s){const n=this._cx,i=this._cy,r=this._cz,a=this._arr;if(0===s){const s=ST.MakeFilledArray(i,(()=>ST.MakeFilledArray(r,t)));0===e?a.push(s):a.unshift(s),this._cx++}else if(1===s){for(let s=0;s<n;++s){const n=ST.MakeFilledArray(r,t);0===e?a[s].push(n):a[s].unshift(n)}this._cy++}else{for(let s=0;s<n;++s)for(let n=0;n<i;++n)0===e?a[s][n].push(t):a[s][n].unshift(t);this._cz++}},Pop(e,t){const s=this._cx,n=this._cy,i=this._cz,r=this._arr;if(0===t){if(0===s)return;0===e?r.pop():r.shift(),this._cx--}else if(1===t){if(0===n)return;for(let t=0;t<s;++t)0===e?r[t].pop():r[t].shift();this._cy--}else{if(0===i)return;for(let t=0;t<s;++t)for(let s=0;s<n;++s)0===e?r[t][s].pop():r[t][s].shift();this._cz--}},Reverse(e){const t=this._cx,s=this._cy,n=this._cz,i=this._arr;if(0!==t&&0!==s&&0!==n)if(0===e)i.reverse();else if(1===e)for(let e=0;e<t;++e)i[e].reverse();else for(let e=0;e<t;++e)for(let t=0;t<s;++t)i[e][t].reverse()},Sort(e){const t=this._cx,s=this._cy,n=this._cz,i=this._arr;if(0!==t&&0!==s&&0!==n)if(0===e)i.sort(((e,t)=>IT(e[0][0],t[0][0])));else if(1===e)for(let e=0;e<t;++e)i[e].sort(((e,t)=>IT(e[0],t[0])));else for(let e=0;e<t;++e)for(let t=0;t<s;++t)i[e][t].sort(IT)},Sort2(e){const t=this._cx,s=this._cy,n=this._cz,i=this._arr;if(0!==t&&0!==s&&0!==n)if(0===e)i.sort(((e,t)=>{for(let n=0;n<s;++n){const s=IT(e[n][0],t[n][0]);if(0!==s)return s}return 0}));else if(1===e)for(let e=0;e<s;++e){const s=[];for(let n=0;n<t;++n)s.push(i[n][e]);s.sort(((e,t)=>IT(e[0],t[0])));for(let n=0;n<t;++n)i[n][e]=s[n]}else if(2===e){const e=[];for(let t=0;t<s;++t)e.push(t);e.sort(((e,s)=>{for(let n=0;n<t;++n){const t=IT(i[n][e],i[n][s]);if(0!==t)return t}return 0}));for(let s=0;s<t;++s){let t=[];for(const n of e)t.push(i[s][n]);i[s]=t}}else if(3===e)for(let e=0;e<t;++e)i[e].sort(((e,t)=>IT(e[0],t[0])));else for(let e=0;e<t;++e)for(let t=0;t<s;++t)i[e][t].sort(IT)},Shuffle(e){const t=this._cx,s=this._cy,n=this._cz;if(0!==t&&0!==s&&0!==n)if(0===e)for(let i=0;i<s;++i)for(let s=0;s<n;++s)this._ShuffleHelper(e,t,0,i,s);else if(1===e)for(let i=0;i<t;++i)for(let t=0;t<n;++t)this._ShuffleHelper(e,s,i,0,t);else for(let i=0;i<t;++i)for(let t=0;t<s;++t)this._ShuffleHelper(e,n,i,t,0)},Delete(e,t){if((e=Math.floor(e))<0)return;const s=this._cx,n=this._cy,i=this._cz,r=this._arr;if(0===t){if(e>=s)return;r.splice(e,1),this._cx--}else if(1===t){if(e>=n)return;for(let t=0;t<s;++t)r[t].splice(e,1);this._cy--}else{if(e>=i)return;for(let t=0;t<s;++t)for(let s=0;s<n;++s)r[t][s].splice(e,1);this._cz--}},Insert(e,t,s){if((t=Math.floor(t))<0)return;const n=this._cx,i=this._cy,r=this._cz,a=this._arr;if(0===s){if(t>n)return;a.splice(t,0,ST.MakeFilledArray(i,(()=>ST.MakeFilledArray(r,e)))),this._cx++}else if(1===s){if(t>i)return;for(let s=0;s<n;++s)a[s].splice(t,0,ST.MakeFilledArray(r,e));this._cy++}else{if(t>r)return;for(let s=0;s<n;++s)for(let n=0;n<i;++n)a[s][n].splice(t,0,e);this._cz++}},SplitString(e,t,s){const n=e.split(t);this.SetSize(n.length,1,1);for(let e=0,t=n.length;e<t;++e){let t=n[e];0===s?String(Number(t))===t&&(t=Number(t)):2===s&&(t=Number(t)),this.Set(e,0,0,t)}},JSONLoad(e){let t=null;try{t=JSON.parse(e)}catch(e){return void console.error("[Construct] Failed to parse JSON: ",e)}if(!t.c2array)return;const s=t.size;this._cx=s[0],this._cy=s[1],this._cz=s[2],this._arr=t.data},JSONDownload(e){const t=URL.createObjectURL(new Blob([this.GetAsJsonString()],{type:"application/json"}));this._runtime.InvokeDownload(t,e)}}}self.C3.Plugins.Arr.Exps={At(e,t,s){return this.At(e,t||0,s||0)},Width(){return this._cx},Height(){return this._cy},Depth(){return this._cz},CurX(){return this._GetForX()},CurY(){return this._GetForY()},CurZ(){return this._GetForZ()},CurValue(){return this.At(this._GetForX(),this._GetForY(),this._GetForZ())},Front(){return this.At(0,0,0)},Back(){return this.At(this._cx-1,0,0)},IndexOf(e){const t=this._arr;for(let s=0,n=this._cx;s<n;++s)if(t[s][0][0]===e)return s;return-1},LastIndexOf(e){const t=this._arr;for(let s=this._cx-1;s>=0;--s)if(t[s][0][0]===e)return s;return-1},JoinString(e){let t=[];for(let e=0;e<this._cx;++e)t.push(this.At(e,0,0));return t.join(e)},AsJSON(){return this.GetAsJsonString()}};{const yT=self.C3,bT=[];yT.Plugins.Audio=class extends yT.SDKPluginBase{constructor(e){super(e)}_AddActionPromise(e){bT.push(e)}static async WaitForAllActionPromises(){await Promise.all(bT),yT.clearArray(bT)}Release(){super.Release()}}}{let GT=function(){return CT.GetSingleGlobalInstance().GetSdkInstance()},vT=function(){if(self.C3Audio_DOMInterface)return self.C3Audio_DOMInterface;throw new Error("audio scripting API cannot be used here - make sure the project is using DOM mode, not worker mode")};GetAudioSdkInstance=GT,GetAudioDOMInterface=vT;const xT=self.C3,TT=self.C3X;xT.Plugins.Audio.Type=class extends xT.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}GetScriptInterfaceClass(){return self.IAudioObjectType}};let CT=null;self.IAudioObjectType=class extends self.IObjectType{constructor(e){super(e),CT=e}get audioContext(){return vT().GetAudioContextExtern()}get destinationNode(){return vT().GetDestinationNodeExtern()}get isSilent(){return GT()._IsSilent()}set isSilent(e){GT()._SetSilent(e)}get masterVolume(){return GT()._GetMasterVolume()}set masterVolume(e){TT.RequireFiniteNumber(e),GT()._SetMasterVolume(e)}stopAll(){GT()._StopAll()}}}{const wT=self.C3,PT="audio",AT=["interactive","balanced","playback"];wT.Plugins.Audio.Instance=class extends wT.SDKInstanceBase{constructor(e,t){super(e,PT),this._nextPlayTime=0,this._nextPlayOffset=0,this._triggerTags=[],this._enableMultiTags=!0,this._timeScaleMode=0,this._saveLoadMode=0,this._playInBackground=!1,this._panningModel=1,this._distanceModel=1,this._listenerPos=[this._runtime.GetViewportWidth()/2,this._runtime.GetViewportHeight()/2,600],this._listenerForwardVec=[0,0,-1],this._listenerUpVec=[0,1,0],this._referenceDistance=600,this._maxDistance=1e4,this._rolloffFactor=1,this._listenerInst=null,this._loadListenerUid=-1,this._masterVolume=1,this._isSilent=!1,this._sampleRate=0,this._audioContextState="suspended",this._outputLatency=0,this._effectCount=new Map,this._preloadTotal=0,this._preloadCount=0,this._bufferMetadata=new Map,this._remoteUrls=new Map;let s="interactive";t&&(this._timeScaleMode=t[0],this._saveLoadMode=t[1],this._playInBackground=t[2],s=AT[t[3]],this._enableMultiTags=t[4],this._panningModel=t[5],this._distanceModel=t[6],this._listenerPos[2]=t[7],this._referenceDistance=t[8],this._maxDistance=t[9],this._rolloffFactor=t[10]),this._lastAIState=[],this._lastFxState=[],this._lastAnalysersData=[],this.AddDOMMessageHandlers([["state",e=>this._OnUpdateState(e)],["audiocontext-state",e=>this._OnAudioContextStateChanged(e)],["fxstate",e=>this._OnUpdateFxState(e)],["trigger",e=>this._OnTrigger(e)],["buffer-metadata",e=>this._OnBufferMetadata(e)]]);const n=this.GetRuntime().Dispatcher();this._disposables=new wT.CompositeDisposable(wT.Disposable.From(n,"instancedestroy",(e=>this._OnInstanceDestroyed(e.instance))),wT.Disposable.From(n,"afterload",(()=>this._OnAfterLoad())),wT.Disposable.From(n,"suspend",(()=>this._OnSuspend())),wT.Disposable.From(n,"resume",(()=>this._OnResume())));const i=this._runtime.GetExportType(),r="Safari"===wT.Platform.Browser,a=this._runtime.IsiOSWebView()||"macos-wkwebview"===i,o=this._runtime.GetAssetManager().IsFileProtocol(),l="playable-ad-single-file"===this._runtime.GetExportType(),c=r||a||o||l;this._runtime.AddLoadPromise(this.PostToDOMAsync("create-audio-context",{preloadList:this._runtime.GetAssetManager().GetAudioToPreload().map((e=>({originalUrl:e.originalUrl,url:e.url,type:e.type,fileSize:e.fileSize}))),timeScaleMode:this._timeScaleMode,latencyHint:s,panningModel:this._panningModel,distanceModel:this._distanceModel,refDistance:this._referenceDistance,maxDistance:this._maxDistance,rolloffFactor:this._rolloffFactor,listenerPos:this._listenerPos,usePlayMusicAsSoundWorkaround:c}).then((e=>{this._sampleRate=e.sampleRate,this._audioContextState=e.audioContextState,this._outputLatency=e.outputLatency}))),this._StartTicking()}Release(){this._listenerInst=null,super.Release()}_SplitTags(e){return this._enableMultiTags?e.split(" ").filter((e=>!!e)):e?[e]:[]}_MatchTagLists(e,t){for(const s of t){let t=!1;for(const n of e)if(wT.equalsNoCase(n,s)){t=!0;break}if(!t)return!1}return!0}_MatchTagListToStr(e,t){return this._MatchTagLists(e,this._SplitTags(t))}_AddActionPromise(e){this.GetPlugin()._AddActionPromise(e)}_OnInstanceDestroyed(e){this._listenerInst===e&&(this._listenerInst=null)}DbToLinearNoCap(e){return Math.pow(10,e/20)}DbToLinear(e){const t=this.DbToLinearNoCap(e);return isFinite(t)?Math.max(Math.min(t,1),0):0}LinearToDbNoCap(e){return Math.log(e)/Math.log(10)*20}LinearToDb(e){return this.LinearToDbNoCap(Math.max(Math.min(e,1),0))}_GetScheduledPlayInfo(){let e=0;const t=!!self.C3_GetAudioContextCurrentTime;return e=t?this._nextPlayTime:this._nextPlayOffset,this._nextPlayTime=0,this._nextPlayOffset=0,{playOffset:e,isTrueClock:t}}_OnSuspend(){this._playInBackground||this.PostToDOM("set-suspended",{isSuspended:!0})}_OnResume(){this._playInBackground||this.PostToDOM("set-suspended",{isSuspended:!1})}_OnUpdateState(e){const t=e.tickCount;this._outputLatency=e.outputLatency;const s=this._lastAIState.filter((e=>e.hasOwnProperty("placeholder")&&(e.placeholder>t||-1===e.placeholder)));this._lastAIState=e.audioInstances,this._lastAnalysersData=e.analysers,s.length>0&&wT.appendArray(this._lastAIState,s)}_OnBufferMetadata(e){this._bufferMetadata.set(e.originalUrl,{duration:e.duration})}_OnAudioContextStateChanged(e){this._audioContextState=e.audioContextState}GetAudioContextState(){return this._runtime.IsExportToVideo()?"running":this._audioContextState}_OnUpdateFxState(e){this._lastFxState=e.fxstate}_GetFirstAudioStateByTags(e){const t=this._SplitTags(e);for(const e of this._lastAIState)if(this._MatchTagLists(e.tags,t))return e;return null}_IsTagPlaying(e){const t=this._SplitTags(e);return this._lastAIState.some((e=>this._MatchTagLists(e.tags,t)&&e.isPlaying))}_MaybeMarkAsPlaying(e,t,s,n,i){if(this._IsTagPlaying(t))return null;const r=this._bufferMetadata.get(e),a={tags:this._SplitTags(t),duration:r?r.duration:0,volume:i,isPlaying:!0,playbackTime:0,playbackRate:1,uid:-1,bufferOriginalUrl:e,bufferUrl:"",bufferType:"",isMusic:s,isLooping:n,isMuted:!1,resumePosition:0,pan:null,placeholder:-1};return this._lastAIState.push(a),a}_MaybeMarkAsStopped(e){const t=this._SplitTags(e);for(const e of this._lastAIState)this._MatchTagLists(e.tags,t)&&(e.isPlaying=!1)}async _OnTrigger(e){const t=e.type;this._triggerTags=e.tags;const s=e.aiid;if("ended"===t){for(const e of this._lastAIState)if(e.aiid===s){e.isPlaying=!1;break}await this.TriggerAsync(wT.Plugins.Audio.Cnds.OnEnded)}else"fade-ended"===t&&await this.TriggerAsync(wT.Plugins.Audio.Cnds.OnFadeEnded)}_MatchTriggerTag(e){return this._MatchTagListToStr(this._triggerTags,e)}Tick(){const e={timeScale:this._runtime.GetTimeScale(),gameTime:this._runtime.GetGameTimeRaw(),instPans:this.GetInstancePans(),tickCount:this._runtime.GetTickCountNoSave()};if(this._listenerInst){const t=this._listenerInst.GetWorldInfo();this._listenerPos[0]=t.GetX(),this._listenerPos[1]=t.GetY(),e.listenerPos=this._listenerPos,e.listenerOrientation=[...this._listenerForwardVec,...this._listenerUpVec]}this.PostToDOM("tick",e)}rotatePtAround(e,t,s,n,i){if(0===s)return[e,t];const r=Math.sin(s),a=Math.cos(s),o=(e-=n)*r;return e=e*a-(t-=i)*r,t=t*a+o,[e+=n,t+=i]}GetInstancePans(){return this._lastAIState.filter((e=>-1!==e.uid)).map((e=>this._runtime.GetInstanceByUID(e.uid))).filter((e=>e)).map((e=>{const t=e.GetWorldInfo(),s=t.GetLayer().GetAngle(),[n,i]=this.rotatePtAround(t.GetX(),t.GetY(),-s,this._listenerPos[0],this._listenerPos[1]);return{uid:e.GetUID(),x:n,y:i,z:t.GetTotalZElevation(),angle:t.GetAngle()-s}}))}GetAnalyserData(e,t){for(const s of this._lastAnalysersData)if(s.index===t&&wT.equalsNoCase(s.tag,e))return s;return null}_IncrementEffectCount(e){for(const t of this._SplitTags(e)){const e=t.toLowerCase();this._effectCount.set(e,(this._effectCount.get(e)||0)+1)}}_IsSilent(){return this._isSilent}_SetSilent(e){e=!!e,this._isSilent!==e&&(this._isSilent=e,this.PostToDOM("set-silent",{isSilent:e}))}_GetMasterVolume(){return this._masterVolume}_SetMasterVolume(e){this._masterVolume!==e&&(this._masterVolume=e,this.PostToDOM("set-master-volume",{vol:e}))}_StopAll(){this.PostToDOM("stop-all");for(const e of this._lastAIState)e.isPlaying=!1}_ShouldSave(e){return!(e.hasOwnProperty("placeholder")||3===this._saveLoadMode||e.isMusic&&1===this._saveLoadMode||!e.isMusic&&2===this._saveLoadMode)}SaveToJson(){return{isSilent:this._isSilent,masterVolume:this._masterVolume,listenerZ:this._listenerPos[2],listenerForwardVec:this._listenerForwardVec,listenerUpVec:this._listenerUpVec,listenerUid:this._listenerInst?this._listenerInst.GetUID():-1,remoteUrls:[...this._remoteUrls.entries()],playing:this._lastAIState.filter((e=>this._ShouldSave(e))),effects:this._lastFxState,analysers:this._lastAnalysersData}}LoadFromJson(e){if(this._isSilent=e.isSilent,this._masterVolume=e.masterVolume,this._listenerPos[2]=e.listenerZ,this._listenerInst=null,this._loadListenerUid=e.listenerUid,e.hasOwnProperty("listenerForwardVec")?this._listenerForwardVec=e.listenerForwardVec:this._listenerForwardVec=[0,0,-1],e.hasOwnProperty("listenerUpVec")?this._listenerUpVec=e.listenerUpVec:this._listenerUpVec=[0,1,0],this._remoteUrls.clear(),e.remoteUrls)for(const[t,s]of e.remoteUrls)this._remoteUrls.set(t,s);this._lastAIState=e.playing;for(const e of this._lastAIState)e.hasOwnProperty("tag")&&!e.hasOwnProperty("tags")&&(e.tags=[e.tag].filter((e=>!!e)));this._lastFxState=e.effects,this._lastAnalysersData=e.analysers}_OnAfterLoad(){if(-1!==this._loadListenerUid&&(this._listenerInst=this._runtime.GetInstanceByUID(this._loadListenerUid),this._loadListenerUid=-1,this._listenerInst)){const e=this._listenerInst.GetWorldInfo();this._listenerPos[0]=e.GetX(),this._listenerPos[1]=e.GetY()}for(const e of this._lastAIState){const t=this._runtime.GetAssetManager().GetProjectAudioFileUrl(e.bufferOriginalUrl);t?(e.bufferUrl=t.url,e.bufferType=t.type):e.bufferUrl=null}for(const e of Object.values(this._lastFxState))for(const t of e)if(t.hasOwnProperty("bufferOriginalUrl")){const e=this._runtime.GetAssetManager().GetProjectAudioFileUrl(t.bufferOriginalUrl);e&&(t.bufferUrl=e.url,t.bufferType=e.type)}this.PostToDOM("load-state",{saveLoadMode:this._saveLoadMode,timeScale:this._runtime.GetTimeScale(),gameTime:this._runtime.GetGameTimeRaw(),listenerPos:this._listenerPos,listenerOrientation:[...this._listenerForwardVec,...this._listenerUpVec],isSilent:this._isSilent,masterVolume:this._masterVolume,playing:this._lastAIState.filter((e=>null!==e.bufferUrl)),effects:this._lastFxState})}GetDebuggerProperties(){const e=[];for(const[t,s]of Object.entries(this._lastFxState))e.push({name:"$"+t,value:s.map((e=>e.type)).join(", ")});const t="plugins.audio.debugger";return[{title:t+".tag-effects",properties:e},{title:t+".currently-playing",properties:[{name:t+".currently-playing-count",value:this._lastAIState.length},...this._lastAIState.map(((e,t)=>({name:"$#"+t,value:`${e.bufferOriginalUrl} ("${e.tags}") ${Math.round(10*e.playbackTime)/10} / ${Math.round(10*e.duration)/10}`})))]}]}}}self.C3.Plugins.Audio.Cnds={OnEnded(e){return this._MatchTriggerTag(e)},OnFadeEnded(e){return this._MatchTriggerTag(e)},PreloadsComplete(){return this._preloadCount===this._preloadTotal},AdvancedAudioSupported:()=>!0,IsSilent(){return this._IsSilent()},IsAnyPlaying(){for(const e of this._lastAIState)if(e.isPlaying)return!0;return!1},IsTagPlaying(e){return this._IsTagPlaying(e)}};{const RT=self.C3,DT=["lowpass","highpass","bandpass","lowshelf","highshelf","peaking","notch","allpass"];RT.Plugins.Audio.Acts={Play(e,t,s,n,i){const r=RT.Plugins.Audio.Acts._DoPlay.call(this,e,t,s,n,i);return this._AddActionPromise(r),r},PlayFromTimeline(e,t,s,n){RT.Plugins.Audio.Acts._DoPlay.call(this,e,0,t,0,s,n)},async _DoPlay(e,t,s,n,i,r){if(this._isSilent)return;const a=e[1],o=this._runtime.GetAssetManager().GetProjectAudioFileUrl(e[0]);if(!o)return;const{playOffset:l,isTrueClock:c}=this._GetScheduledPlayInfo(),h=this._MaybeMarkAsPlaying(e[0],i,a,0!==t,this.DbToLinear(s));try{await this.PostToDOMAsync("play",{originalUrl:e[0],url:o.url,type:o.type,isMusic:a,tags:this._SplitTags(i),isLooping:0!==t,vol:this.DbToLinear(s),stereoPan:RT.clamp(n/100,-1,1),pos:r||0,off:l,trueClock:c})}finally{h&&(h.placeholder=this._runtime.GetTickCountNoSave())}},async PlayAtPosition(e,t,s,n,i,r,a,o,l,c,h){if(this._isSilent)return;const _=e[1],u=this._runtime.GetAssetManager().GetProjectAudioFileUrl(e[0]);if(!u)return;const{playOffset:d,isTrueClock:p}=this._GetScheduledPlayInfo(),f=this._MaybeMarkAsPlaying(e[0],h,_,0!==t,this.DbToLinear(s));try{await this.PostToDOMAsync("play",{originalUrl:e[0],url:u.url,type:u.type,isMusic:_,tags:this._SplitTags(h),isLooping:0!==t,vol:this.DbToLinear(s),pos:0,off:d,trueClock:p,panning:{x:n,y:i,z:r,angle:RT.toRadians(a),innerAngle:RT.toRadians(o),outerAngle:RT.toRadians(l),outerGain:this.DbToLinear(c)}})}finally{f&&(f.placeholder=this._runtime.GetTickCountNoSave())}},async PlayAtObject(e,t,s,n,i,r,a,o){if(this._isSilent)return;if(!n)return;const l=n.GetFirstPicked();if(!l||!l.GetWorldInfo())return;const c=l.GetWorldInfo(),h=c.GetLayer().GetAngle(),[_,u]=this.rotatePtAround(c.GetX(),c.GetY(),-h,this._listenerPos[0],this._listenerPos[1]),d=e[1],p=this._runtime.GetAssetManager().GetProjectAudioFileUrl(e[0]);if(!p)return;const{playOffset:f,isTrueClock:m}=this._GetScheduledPlayInfo(),g=this._MaybeMarkAsPlaying(e[0],o,d,0!==t,this.DbToLinear(s));try{await this.PostToDOMAsync("play",{originalUrl:e[0],url:p.url,type:p.type,isMusic:d,tags:this._SplitTags(o),isLooping:0!==t,vol:this.DbToLinear(s),pos:0,off:f,trueClock:m,panning:{x:_,y:u,z:c.GetTotalZElevation(),angle:c.GetAngle()-h,innerAngle:RT.toRadians(i),outerAngle:RT.toRadians(r),outerGain:this.DbToLinear(a),uid:l.GetUID()}})}finally{g&&(g.placeholder=this._runtime.GetTickCountNoSave())}},async PlayByName(e,t,s,n,i,r){if(this._isSilent)return;const a=1===e,o=this._runtime.GetAssetManager().GetProjectAudioFileUrl(t)||this._remoteUrls.get(t.toLowerCase());if(!o)return;const{playOffset:l,isTrueClock:c}=this._GetScheduledPlayInfo(),h=this._MaybeMarkAsPlaying(t,r,a,0!==s,this.DbToLinear(n));try{await this.PostToDOMAsync("play",{originalUrl:t,url:o.url,type:o.type,isMusic:a,tags:this._SplitTags(r),isLooping:0!==s,vol:this.DbToLinear(n),stereoPan:RT.clamp(i/100,-1,1),pos:0,off:l,trueClock:c})}finally{h&&(h.placeholder=this._runtime.GetTickCountNoSave())}},async PlayAtPositionByName(e,t,s,n,i,r,a,o,l,c,h,_){if(this._isSilent)return;const u=1===e,d=this._runtime.GetAssetManager().GetProjectAudioFileUrl(t)||this._remoteUrls.get(t.toLowerCase());if(!d)return;const{playOffset:p,isTrueClock:f}=this._GetScheduledPlayInfo(),m=this._MaybeMarkAsPlaying(t,_,u,0!==s,this.DbToLinear(n));try{await this.PostToDOMAsync("play",{originalUrl:t,url:d.url,type:d.type,isMusic:u,tags:this._SplitTags(_),isLooping:0!==s,vol:this.DbToLinear(n),pos:0,off:p,trueClock:f,panning:{x:i,y:r,z:a,angle:RT.toRadians(o),innerAngle:RT.toRadians(l),outerAngle:RT.toRadians(c),outerGain:this.DbToLinear(h)}})}finally{m&&(m.placeholder=this._runtime.GetTickCountNoSave())}},async PlayAtObjectByName(e,t,s,n,i,r,a,o,l){if(this._isSilent)return;if(this._isSilent)return;if(!i)return;const c=i.GetFirstPicked();if(!c||!c.GetWorldInfo())return;const h=c.GetWorldInfo(),_=h.GetLayer().GetAngle(),[u,d]=this.rotatePtAround(h.GetX(),h.GetY(),-_,this._listenerPos[0],this._listenerPos[1]),p=1===e,f=this._runtime.GetAssetManager().GetProjectAudioFileUrl(t)||this._remoteUrls.get(t.toLowerCase());if(!f)return;const{playOffset:m,isTrueClock:g}=this._GetScheduledPlayInfo(),I=this._MaybeMarkAsPlaying(t,l,p,0!==s,this.DbToLinear(n));try{await this.PostToDOMAsync("play",{originalUrl:t,url:f.url,type:f.type,isMusic:p,tags:this._SplitTags(l),isLooping:0!==s,vol:this.DbToLinear(n),pos:0,off:m,trueClock:g,panning:{x:u,y:d,z:h.GetTotalZElevation(),angle:h.GetAngle()-_,innerAngle:RT.toRadians(r),outerAngle:RT.toRadians(a),outerGain:this.DbToLinear(o),uid:c.GetUID()}})}finally{I&&(I.placeholder=this._runtime.GetTickCountNoSave())}},SetLooping(e,t){this.PostToDOM("set-looping",{tags:this._SplitTags(e),isLooping:0===t})},SetMuted(e,t){this.PostToDOM("set-muted",{tags:this._SplitTags(e),isMuted:0===t})},SetVolume(e,t){this.PostToDOM("set-volume",{tags:this._SplitTags(e),vol:this.DbToLinear(t)})},FadeVolume(e,t,s,n){this.PostToDOM("fade-volume",{tags:this._SplitTags(e),vol:this.DbToLinear(t),duration:s,stopOnEnd:0===n})},SetStereoPan(e,t){this.PostToDOM("set-stereo-pan",{tags:this._SplitTags(e),p:RT.clamp(t/100,-1,1)})},async Preload(e){const t=e[1],s=this._runtime.GetAssetManager().GetProjectAudioFileUrl(e[0]);s&&(this._preloadTotal++,await this.PostToDOMAsync("preload",{originalUrl:e[0],url:s.url,type:s.type,isMusic:t}),this._preloadCount++)},async PreloadByName(e,t){const s=1===e,n=this._runtime.GetAssetManager().GetProjectAudioFileUrl(t)||this._remoteUrls.get(t.toLowerCase());n&&(this._preloadTotal++,await this.PostToDOMAsync("preload",{originalUrl:t,url:n.url,type:n.type,isMusic:s}),this._preloadCount++)},SetPlaybackRate(e,t){this.PostToDOM("set-playback-rate",{tags:this._SplitTags(e),rate:Math.max(t,0)})},Stop(e){this._MaybeMarkAsStopped(e),this.PostToDOM("stop",{tags:this._SplitTags(e)})},StopAll(){this._StopAll()},SetPaused(e,t){this.PostToDOM("set-paused",{tags:this._SplitTags(e),paused:0===t})},Seek(e,t){this.PostToDOM("seek",{tags:this._SplitTags(e),pos:t})},SetSilent(e){2===e&&(e=this._IsSilent()?1:0),this._SetSilent(0===e)},SetMasterVolume(e){const t=this.DbToLinear(e);this._SetMasterVolume(t)},AddFilterEffect(e,t,s,n,i,r,a){const o=DT[t];this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"filter",tags:this._SplitTags(e),params:[o,s,n,i,r,RT.clamp(a/100,0,1)]})},AddDelayEffect(e,t,s,n){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"delay",tags:this._SplitTags(e),params:[t,this.DbToLinear(s),RT.clamp(n/100,0,1)]})},AddFlangerEffect(e,t,s,n,i,r){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"flanger",tags:this._SplitTags(e),params:[t/1e3,s/1e3,n,i/100,RT.clamp(r/100,0,1)]})},AddPhaserEffect(e,t,s,n,i,r,a){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"phaser",tags:this._SplitTags(e),params:[t,s,n,i,r,RT.clamp(a/100,0,1)]})},AddConvolutionEffect(e,t,s,n){const i=this._runtime.GetAssetManager().GetProjectAudioFileUrl(t[0]);i&&(this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"convolution",tags:this._SplitTags(e),bufferOriginalUrl:t[0],bufferUrl:i.url,bufferType:i.type,params:[0===s,RT.clamp(n/100,0,1)]}))},AddGainEffect(e,t){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"gain",tags:this._SplitTags(e),params:[this.DbToLinear(t)]})},AddStereoPanEffect(e,t){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"stereopan",tags:this._SplitTags(e),params:[RT.clamp(t/100,-1,1)]})},AddMuteEffect(e){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"gain",tags:this._SplitTags(e),params:[0]})},AddTremoloEffect(e,t,s){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"tremolo",tags:this._SplitTags(e),params:[t,RT.clamp(s/100,0,1)]})},AddRingModEffect(e,t,s){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"ringmod",tags:this._SplitTags(e),params:[t,RT.clamp(s/100,0,1)]})},AddDistortionEffect(e,t,s,n,i,r){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"distortion",tags:this._SplitTags(e),params:[this.DbToLinearNoCap(t),this.DbToLinearNoCap(s),n,this.DbToLinearNoCap(i),RT.clamp(r/100,0,1)]})},AddCompressorEffect(e,t,s,n,i,r){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"compressor",tags:this._SplitTags(e),params:[t,s,n,i/1e3,r/1e3]})},AddAnalyserEffect(e,t,s){this._IncrementEffectCount(e),this.PostToDOM("add-effect",{type:"analyser",tags:this._SplitTags(e),params:[t,s]})},RemoveEffects(e){const t=this._SplitTags(e);for(const e of t)this._effectCount.set(e.toLowerCase(),0);this.PostToDOM("remove-effects",{tags:t}),this._lastFxState={}},SetEffectParameter(e,t,s,n,i,r){this.PostToDOM("set-effect-param",{tags:this._SplitTags(e),index:Math.floor(t),param:s,value:n,ramp:i,time:r})},SetListenerObject(e){if(!e)return;const t=e.GetFirstPicked();t&&t.GetWorldInfo()&&(this._listenerInst=t)},SetListenerZ(e){this._listenerPos[2]=e},SetListenerOrientation(e,t,s,n,i,r){this._listenerForwardVec[0]=e,this._listenerForwardVec[1]=t,this._listenerForwardVec[2]=-s,this._listenerUpVec[0]=n,this._listenerUpVec[1]=i,this._listenerUpVec[2]=-r},ScheduleNextPlay(e){this._nextPlayTime=Math.max(e,0),this._nextPlayOffset=Math.max(e-performance.now()/1e3,0)},UnloadAudio(e){const t=e[1],s=this._runtime.GetAssetManager().GetProjectAudioFileUrl(e[0]);s&&this.PostToDOM("unload",{url:s.url,type:s.type,isMusic:t})},UnloadAudioByName(e,t){const s=1===e,n=this._runtime.GetAssetManager().GetProjectAudioFileUrl(t)||this._remoteUrls.get(t.toLowerCase());n&&this.PostToDOM("unload",{url:n.url,type:n.type,isMusic:s})},UnloadAll(){this.PostToDOM("unload-all")},AddRemoteURL(e,t,s){this._remoteUrls.set(s.toLowerCase(),{url:e,type:t})}}}{const ET=self.C3;ET.Plugins.Audio.Exps={Duration(e){const t=this._GetFirstAudioStateByTags(e);return t?t.duration:0},PlaybackTime(e){const t=this._GetFirstAudioStateByTags(e);return t?t.playbackTime:0},PlaybackRate(e){const t=this._GetFirstAudioStateByTags(e);return t?t.playbackRate:0},Volume(e){const t=this._GetFirstAudioStateByTags(e);return t?this.LinearToDb(t.volume):0},MasterVolume(){return this.LinearToDb(this._GetMasterVolume())},EffectCount(e){return this._effectCount.get(e.toLowerCase())||0},AnalyserFreqBinCount(e,t){const s=this.GetAnalyserData(e,Math.floor(t));return s?s.binCount:0},AnalyserFreqBinAt(e,t,s){const n=this.GetAnalyserData(e,Math.floor(t));return n?(s=Math.floor(s))<0||s>=n.binCount?0:n.freqBins[s]:0},AnalyserPeakLevel(e,t){const s=this.GetAnalyserData(e,Math.floor(t));return s?s.peak:0},AnalyserRMSLevel(e,t){const s=this.GetAnalyserData(e,Math.floor(t));return s?s.rms:0},SampleRate(){return this._sampleRate},CurrentTime:()=>self.C3_GetAudioContextCurrentTime?self.C3_GetAudioContextCurrentTime():performance.now()/1e3,OutputLatency(){return this._outputLatency},NormalizedVolume(e,t){return 0==(e=ET.clamp(+e,0,100)/100)?-1/0:e<.1?this.LinearToDb(ET.lerp(0,this.DbToLinear(t),10*e)):ET.lerp(t,0,(e-.1)/.9)}}}{const MT=self.C3;MT.Plugins.Sprite=class extends MT.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const kT=self.C3,LT=self.C3X,FT=[];kT.Plugins.Sprite.Type=class extends kT.SDKTypeBase{constructor(e){super(e),this._animations=e.GetAnimations()}Release(){kT.clearArray(this._animations),super.Release()}OnCreate(){for(const e of this._animations)e.LoadAllAssets(this._runtime)}LoadTextures(e){const t={sampling:this._runtime.GetSampling()};return Promise.all(this._animations.map((s=>s.LoadAllTextures(e,t))))}ReleaseTextures(){for(const e of this._animations)e.ReleaseAllTextures()}OnDynamicTextureLoadComplete(){this._UpdateAllCurrentTexture()}_UpdateAllCurrentTexture(){for(const e of this._objectClass.instancesIncludingPendingCreate())e.GetSdkInstance()._UpdateCurrentTexture()}FinishCondition(e){kT.Plugins.Sprite.FinishCollisionCondition(this,e)}BeforeRunAction(e){FT.push({objectClass:null,createHierarchy:!1,instances:[]})}_SpawnPickInstance(e,t,s){const n=FT.at(-1);n.objectClass=e,n.createHierarchy=s,n.instances.push(t)}AfterRunAction(e){const t=FT.pop(),s=t.objectClass,n=t.createHierarchy;if(!s)return;const i=new Map;for(const e of t.instances)e.CollectInstancesToPick(i,s,n);for(const[e,t]of i)e.GetCurrentSol().SetSetPicked(t)}_AddAnimation(e){const t=this.GetObjectClass().AddAnimation(e),s=this.GetRuntime();return t.GetFrameAt(0).GetImageInfo().LoadStaticTexture(s.GetRenderer(),{sampling:s.GetSampling()}).then((()=>this._UpdateAllCurrentTexture())),t}_RemoveAnimation(e){for(const t of this._objectClass.instancesIncludingPendingCreate())t.GetSdkInstance()._OnAnimationRemoved(e);this.GetObjectClass().RemoveAnimation(e)}_AddAnimationFrame(e,t){const s=this._objectClass.GetAnimationByName(e);if(!s)throw new Error(`cannot find animation name '${e}'`);let n=s.FrameTagOrIndexToIndex(t);n<0&&(n+=s.GetFrameCount()+1);const i=kT.AnimationFrameInfo.CreateDynamic(this.GetRuntime());s.InsertFrameAt(i,n);const r=this.GetRuntime();i.GetImageInfo().LoadStaticTexture(r.GetRenderer(),{sampling:r.GetSampling()}).then((()=>this._UpdateAllCurrentTexture()));for(const e of this._objectClass.instancesIncludingPendingCreate())e.GetSdkInstance()._OnAnimationFramesChanged();return i}_RemoveAnimationFrame(e,t){const s=this._objectClass.GetAnimationByName(e);if(!s)throw new Error(`cannot find animation name '${e}'`);if(1===s.GetFrameCount())throw new Error(`cannot remove last frame from animation '${e}'`);let n=s.FrameTagOrIndexToIndex(t);n<0&&(n+=s.GetFrameCount()),s.RemoveFrameAt(n);for(const e of this._objectClass.instancesIncludingPendingCreate())e.GetSdkInstance()._OnAnimationFramesChanged()}GetScriptInterfaceClass(){return self.ISpriteObjectType}};const BT=new WeakMap;self.ISpriteObjectType=class extends self.IObjectType{constructor(e){super(e),BT.set(this,e.GetSdkType())}getAnimation(e){LT.RequireString(e);const t=BT.get(this).GetObjectClass().GetAnimationByName(e);return t?t.GetIAnimation():null}getAllAnimations(){return BT.get(this).GetObjectClass().GetAllAnimations().map((e=>e.GetIAnimation()))}addAnimation(e){return LT.RequireString(e),BT.get(this)._AddAnimation(e).GetIAnimation()}removeAnimation(e){LT.RequireString(e),BT.get(this)._RemoveAnimation(e)}addAnimationFrame(e,t){if(LT.RequireString(e),"number"!=typeof t&&"string"!=typeof t)throw new TypeError("invalid insert location");return BT.get(this)._AddAnimationFrame(e,t).GetIAnimationFrame()}removeAnimationFrame(e,t){if(LT.RequireString(e),"number"!=typeof t&&"string"!=typeof t)throw new TypeError("invalid insert location");BT.get(this)._RemoveAnimationFrame(e,t)}}}{const OT=self.C3,NT=self.C3X,WT=0,VT=1,jT=2,UT=3,HT=OT.New(OT.Rect),zT=OT.New(OT.Quad),XT=OT.New(OT.Vector2),YT=1,qT=2,JT=4;OT.Plugins.Sprite.Instance=class extends OT.SDKWorldInstanceBase{constructor(e,t){super(e);let s=!0,n="",i=0,r=!0;t&&(s=!!t[WT],n=t[VT],i=t[jT],r=t[UT]),this._currentAnimation=this._objectClass.GetAnimationByName(n)||this._objectClass.GetAnimations()[0],this._currentFrameIndex=OT.clamp(i,0,this._currentAnimation.GetFrameCount()-1),this._currentAnimationFrame=this._currentAnimation.GetFrameAt(this._currentFrameIndex);const a=this._currentAnimationFrame.GetImageInfo();this._currentTexture=a.GetTexture(),this._currentRcTex=a.GetTexRect(),this._currentQuadTex=a.GetTexQuad(),this.HandleRendererContextLoss(),e.SetFlag(qT,!0),e.SetFlag(YT,this._currentAnimation.GetSpeed()>=0),this._currentAnimationSpeed=Math.abs(this._currentAnimation.GetSpeed()),this._currentAnimationRepeatTo=this._currentAnimation.GetRepeatTo(),this._animationTimer=OT.New(OT.KahanSum),this._frameStartTime=0,this._animationRepeats=0,this._animTriggerName="",this._changeAnimFrameIndex=-1,this._changeAnimationName="",this._changeAnimationFrom=0;const o=this.GetWorldInfo();this._bquadRef=o.GetBoundingQuad(),o.SetVisible(s),o.SetCollisionEnabled(r),o.SetOriginX(this._currentAnimationFrame.GetOriginX()),o.SetOriginY(this._currentAnimationFrame.GetOriginY()),o.SetSourceCollisionPoly(this._currentAnimationFrame.GetCollisionPoly()),o.SetBboxChanged(),1===this._objectClass.GetAnimationCount()&&1===this._objectClass.GetAnimations()[0].GetFrameCount()||0===this._currentAnimationSpeed||this._StartTicking()}Release(){this._currentAnimation=null,this._currentAnimationFrame=null,this._currentTexture=null,this._animationTimer=null,super.Release()}GetCurrentImageInfo(){return this._currentAnimationFrame.GetImageInfo()}IsOriginalSizeKnown(){return!0}OnRendererContextLost(){this._currentTexture=null}OnRendererContextRestored(){this._UpdateCurrentTexture()}Draw(e){const t=this._currentTexture;if(null===t)return;e.SetTexture(t);const s=this.GetWorldInfo();s.HasMesh()?this._DrawMesh(s,e):this._DrawStandard(s,e)}_DrawStandard(e,t){let s=this._bquadRef;this._runtime.IsPixelRoundingEnabled()&&(s=e.PixelRoundQuad(s)),t.Quad4(s,this._currentQuadTex)}_DrawMesh(e,t){const s=e.GetTransformedMesh();if(e.IsMeshChanged()){e.CalculateBbox(HT,zT,!1);let t=zT;this._runtime.IsPixelRoundingEnabled()&&(t=e.PixelRoundQuad(t)),s.CalculateTransformedMesh(e.GetSourceMesh(),t,this._currentQuadTex),e.SetMeshChanged(!1)}s.Draw(t)}GetAnimationTime(){return this._animationTimer.Get()}IsAnimationPlaying(){return this._inst.GetFlag(qT)}SetAnimationPlaying(e){this._inst.SetFlag(qT,e)}IsPlayingForwards(){return this._inst.GetFlag(YT)}SetPlayingForwards(e){this._inst.SetFlag(YT,e)}IsInAnimationTrigger(){return this._inst.GetFlag(JT)}SetInAnimationTrigger(e){this._inst.SetFlag(JT,e)}Tick(){this._changeAnimationName&&this._DoChangeAnimation(),this._changeAnimFrameIndex>=0&&this._DoChangeAnimFrame();const e=this._currentAnimationSpeed;if(!this.IsAnimationPlaying()||0===e)return void this._StopTicking();const t=this._runtime.GetDt(this._inst);this._animationTimer.Add(t);const s=this.GetAnimationTime(),n=this._currentAnimationFrame,i=n.GetDuration()/e;if(s<this._frameStartTime+i)return;const r=this._currentAnimation,a=this._currentAnimationRepeatTo,o=r.GetFrameCount(),l=r.GetRepeatCount(),c=r.IsLooping(),h=r.IsPingPong();this.IsPlayingForwards()?this._currentFrameIndex++:this._currentFrameIndex--,this._frameStartTime+=i,this._currentFrameIndex>=o&&(h?(this.SetPlayingForwards(!1),this._currentFrameIndex=o-2):c?this._currentFrameIndex=a:(this._animationRepeats++,this._animationRepeats>=l?this._FinishAnimation(!1):this._currentFrameIndex=a)),this._currentFrameIndex<0&&(h?(this._currentFrameIndex=1,this.SetPlayingForwards(!0),c||(this._animationRepeats++,this._animationRepeats>=l&&this._FinishAnimation(!0))):c?this._currentFrameIndex=a:(this._animationRepeats++,this._animationRepeats>=l?this._FinishAnimation(!0):this._currentFrameIndex=a)),this._currentFrameIndex=OT.clamp(this._currentFrameIndex,0,o-1);const _=r.GetFrameAt(this._currentFrameIndex);s>this._frameStartTime+_.GetDuration()/e&&(this._frameStartTime=s),this._OnFrameChanged(n,_)}_FinishAnimation(e){this._currentFrameIndex=e?0:this._currentAnimation.GetFrameCount()-1,this.SetAnimationPlaying(!1),this._animTriggerName=this._currentAnimation.GetName(),this.SetInAnimationTrigger(!0),this.DispatchScriptEvent("animationend",!1,{animationName:this._animTriggerName}),this.Trigger(OT.Plugins.Sprite.Cnds.OnAnyAnimFinished),this.Trigger(OT.Plugins.Sprite.Cnds.OnAnimFinished),this.SetInAnimationTrigger(!1),this._animationRepeats=0}_OnFrameChanged(e,t,s){if(e===t)return;const n=this.GetWorldInfo(),i=e.GetImageInfo(),r=t.GetImageInfo(),a=i.GetWidth(),o=i.GetHeight(),l=r.GetWidth(),c=r.GetHeight();s&&s.onFrameChange?s.onFrameChange(n,a,o,l,c):(a!==l&&n.SetWidth(n.GetWidth()*(l/a)),o!==c&&n.SetHeight(n.GetHeight()*(c/o))),n.SetOriginX(t.GetOriginX()),n.SetOriginY(t.GetOriginY()),n.SetSourceCollisionPoly(t.GetCollisionPoly()),n.SetBboxChanged(),this._currentAnimationFrame=t,this._currentTexture=r.GetTexture(),this._currentRcTex=r.GetTexRect(),this._currentQuadTex=r.GetTexQuad();const h=this.GetInstance().GetBehaviorInstances();for(let s=0,n=h.length;s<n;++s)h[s].OnSpriteFrameChanged(e,t);this.DispatchScriptEvent("framechange",!1,{animationName:this._currentAnimation.GetName(),animationFrame:this._currentFrameIndex}),this.Trigger(OT.Plugins.Sprite.Cnds.OnFrameChanged),this._runtime.UpdateRender()}_StartAnim(e){this.SetAnimationPlaying(!0),this._frameStartTime=this.GetAnimationTime(),1===e&&0!==this._currentFrameIndex&&(this._changeAnimFrameIndex=0,this.IsInAnimationTrigger()||this._DoChangeAnimFrame()),this._StartTicking()}_SetAnim(e,t,s){this._changeAnimationName=e,this._changeAnimationFrom=t,this._StartTicking(),!s&&this.IsInAnimationTrigger()||this._DoChangeAnimation()}_GetCurrentAnimation(){return this._currentAnimation}_GetCurrentAnimationName(){return this._changeAnimationName?this._changeAnimationName:this._currentAnimation.GetName()}_OnAnimationRemoved(e){OT.equalsNoCase(e,this._GetCurrentAnimationName())&&this._SetAnim(this._objectClass.GetFirstAnimation().GetName(),1,!0)}_SetAnimFrame(e){if("string"==typeof e)if(String(Number(e))===e)e=Number(e);else{const t=this._objectClass.GetAnimationByName(this._GetCurrentAnimationName());if(!t)return;if(-1===(e=t.GetFrameIndexByTag(e)))return}isFinite(e)&&(this._changeAnimFrameIndex=e,this.IsInAnimationTrigger()||this._DoChangeAnimFrame())}_OnAnimationFramesChanged(){if(this._changeAnimationName||-1!==this._changeAnimFrameIndex)return;const e=this._currentAnimationFrame,t=this._currentAnimation.GetFrameAt(OT.clamp(this._currentFrameIndex,0,this._currentAnimation.GetFrameCount()-1));e!==t&&this._OnFrameChanged(e,t),this._currentAnimation.GetFrameCount()>1&&this._currentAnimationSpeed>0&&this._StartTicking()}_GetAnimFrame(){return this._currentFrameIndex}_GetAnimFrameTag(){return this._currentAnimationFrame.GetTag()}_SetAnimSpeed(e){this._currentAnimationSpeed=Math.abs(e),this.SetPlayingForwards(e>=0),this._currentAnimationSpeed>0&&this._StartTicking()}_GetAnimSpeed(){return this.IsPlayingForwards()?this._currentAnimationSpeed:-this._currentAnimationSpeed}_SetAnimRepeatToFrame(e){"string"==typeof e&&-1===(e=this._currentAnimation.GetFrameIndexByTag(e))||(e=OT.clamp(Math.floor(e),0,this._currentAnimation.GetFrameCount()-1),this._currentAnimationRepeatTo=e)}_GetAnimRepeatToFrame(){return this._currentAnimationRepeatTo}_DoChangeAnimation(e){const t=this._currentAnimationFrame,s=this._objectClass.GetAnimationByName(this._changeAnimationName);if(this._changeAnimationName="",!s)return;if(s===this._currentAnimation&&this.IsAnimationPlaying())return;this._currentAnimation=s,this.SetPlayingForwards(s.GetSpeed()>=0),this._currentAnimationSpeed=Math.abs(s.GetSpeed()),this._currentAnimationRepeatTo=s.GetRepeatTo(),this._currentFrameIndex=OT.clamp(this._currentFrameIndex,0,this._currentAnimation.GetFrameCount()-1),1===this._changeAnimationFrom&&(this._currentFrameIndex=0),this.SetAnimationPlaying(!0),this._frameStartTime=this.GetAnimationTime();const n=this._currentAnimation.GetFrameAt(this._currentFrameIndex);this._OnFrameChanged(t,n,e)}_DoChangeAnimFrame(e){const t=this._currentAnimationFrame,s=this._currentFrameIndex;if(this._currentFrameIndex=OT.clamp(Math.floor(this._changeAnimFrameIndex),0,this._currentAnimation.GetFrameCount()-1),this._changeAnimFrameIndex=-1,!e&&s===this._currentFrameIndex)return;const n=this._currentAnimation.GetFrameAt(this._currentFrameIndex);this._OnFrameChanged(t,n),this._frameStartTime=this.GetAnimationTime()}_UpdateCurrentTexture(){const e=this._currentAnimationFrame.GetImageInfo();this._currentTexture=e.GetTexture(),this._currentRcTex=e.GetTexRect(),this._currentQuadTex=e.GetTexQuad(),this.GetWorldInfo().SetMeshChanged(!0)}GetTexture(){return this._currentTexture}GetTexRect(){return this._currentRcTex}GetTexQuad(){return this._currentQuadTex}GetImagePointCount(){return this._currentAnimationFrame.GetImagePointCount()}GetImagePoint(e){const t=this._currentAnimationFrame,s=this.GetWorldInfo();let n=null;if("string"==typeof e)n=t.GetImagePointByName(e);else{if("number"!=typeof e)throw new TypeError("expected string or number");n=t.GetImagePointByIndex(e-1)}let i=s.GetTotalZElevation();if(!n)return[s.GetX(),s.GetY(),i];if(XT.copy(n.GetVec2()),s.HasMesh()){const[e,t,n]=s.GetSourceMesh().TransformPoint(XT.getX(),XT.getY());XT.set(e,t),i+=n}return XT.offset(-t.GetOriginX(),-t.GetOriginY()),XT.scale(s.GetWidth(),s.GetHeight()),XT.rotate(s.GetAngle()),XT.offset(s.GetX(),s.GetY()),[XT.getX(),XT.getY(),i]}GetCollisionPolyPointCount(){return this.GetWorldInfo().GetTransformedCollisionPoly().pointCount()}GetCollisionPolyPoint(e){e=Math.floor(e);const t=this.GetWorldInfo(),s=t.GetTransformedCollisionPoly(),n=s.pointCount();if(e===n&&(e=0),e<0||e>=n)return[0,0];const i=s.pointsArr();return[i[2*e+0]+t.GetX(),i[2*e+1]+t.GetY()]}GetDebuggerProperties(){const e=OT.Plugins.Sprite.Acts,t="plugins.sprite.debugger.animation-properties";return[{title:t+".title",properties:[{name:t+".current-animation",value:this._currentAnimation.GetName(),onedit:t=>this.CallAction(e.SetAnim,t,0)},{name:t+".current-frame",value:this._currentFrameIndex,onedit:t=>this.CallAction(e.SetAnimFrame,t)},{name:t+".is-playing",value:this.IsAnimationPlaying(),onedit:t=>t?this.CallAction(e.StartAnim,0):this.CallAction(e.StopAnim)},{name:t+".speed",value:this._currentAnimationSpeed,onedit:t=>this.CallAction(e.SetAnimSpeed,t)},{name:t+".repeats",value:this._animationRepeats,onedit:e=>this._animationRepeats=e}]}]}SaveToJson(){const e={a:this._currentAnimation.GetSID()};0!==this._frameStartTime&&(e.fs=this._frameStartTime);const t=this.GetAnimationTime();0!==t&&(e.at=t),0!==this._currentFrameIndex&&(e.f=this._currentFrameIndex),0!==this._currentAnimationSpeed&&(e.cas=this._currentAnimationSpeed),1!==this._animationRepeats&&(e.ar=this._animationRepeats),0!==this._currentAnimationRepeatTo&&(e.rt=this._currentAnimationRepeatTo),this.IsAnimationPlaying()||(e.ap=this.IsAnimationPlaying()),this.IsPlayingForwards()||(e.af=this.IsPlayingForwards());const s=this.GetWorldInfo();return s.IsCollisionEnabled()&&(e.ce=s.IsCollisionEnabled()),e}LoadFromJson(e){const t=this.GetObjectClass().GetAnimationBySID(e.a);t&&(this._currentAnimation=t),this._frameStartTime=e.hasOwnProperty("fs")?e.fs:0,this._animationTimer.Set(e.hasOwnProperty("at")?e.at:0);const s=e.hasOwnProperty("f")?e.f:0;this._currentFrameIndex=OT.clamp(s,0,this._currentAnimation.GetFrameCount()-1),this._currentAnimationSpeed=e.hasOwnProperty("cas")?e.cas:0,this._animationRepeats=e.hasOwnProperty("ar")?e.ar:1;const n=e.hasOwnProperty("rt")?e.rt:0;this._currentAnimationRepeatTo=OT.clamp(n,0,this._currentAnimation.GetFrameCount()-1),this.SetAnimationPlaying(!e.hasOwnProperty("ap")||!!e.ap),this.SetPlayingForwards(!e.hasOwnProperty("af")||!!e.af);const i=this._currentAnimation.GetFrameAt(this._currentFrameIndex);this._currentAnimationFrame=i,this._UpdateCurrentTexture();const r=this.GetWorldInfo();r.SetOriginX(i.GetOriginX()),r.SetOriginY(i.GetOriginY()),r.SetSourceCollisionPoly(i.GetCollisionPoly()),r.SetCollisionEnabled(!!e.ce),this.IsAnimationPlaying()&&this._StartTicking()}GetPropertyValueByIndex(e){const t=this.GetWorldInfo();switch(e){case UT:return t.IsCollisionEnabled();case jT:return OT.clamp(this._currentFrameIndex,0,this._currentAnimation.GetFrameCount()-1);case VT:return this._currentAnimation.GetName()}}SetPropertyValueByIndex(e,t,s){const n=this.GetWorldInfo();switch(e){case UT:n.SetCollisionEnabled(!!t);break;case jT:{this.SetAnimationPlaying(!1);const e=this._currentAnimation.GetFrameCount()-1,n=t=OT.clamp(t,0,e),i=this._currentAnimation.GetFrameAt(this._currentFrameIndex),r=this._currentAnimation.GetFrameAt(n);this._OnFrameChanged(i,r,s),this._currentFrameIndex=OT.clamp(n,0,e);break}case VT:this._changeAnimationName=t,this._DoChangeAnimation(s),this._currentAnimation.GetFrameCount()>1&&this._currentAnimation.GetSpeed()>0?this._StartTicking():this._StopTicking()}}GetScriptInterfaceClass(){return self.ISpriteInstance}};const KT=new WeakMap,$T=new Map([["current-frame",0],["beginning",1]]);self.ISpriteInstance=class extends self.IWorldInstance{constructor(){super(),KT.set(this,self.IInstance._GetInitInst().GetSdkInstance())}getImagePointCount(){return KT.get(this).GetImagePointCount()}getImagePointX(e){return this.getImagePoint(e)[0]}getImagePointY(e){return this.getImagePoint(e)[1]}getImagePointZ(e){return this.getImagePoint(e)[2]}getImagePoint(e){if("string"!=typeof e&&"number"!=typeof e)throw new TypeError("expected string or number");return KT.get(this).GetImagePoint(e)}getPolyPointCount(){return KT.get(this).GetCollisionPolyPointCount()}getPolyPointX(e){return NT.RequireFiniteNumber(e),KT.get(this).GetCollisionPolyPoint(e)[0]}getPolyPointY(e){return NT.RequireFiniteNumber(e),KT.get(this).GetCollisionPolyPoint(e)[1]}getPolyPoint(e){return NT.RequireFiniteNumber(e),KT.get(this).GetCollisionPolyPoint(e)}stopAnimation(){KT.get(this).SetAnimationPlaying(!1)}startAnimation(e="current-frame"){NT.RequireString(e);const t=$T.get(e);if(void 0===t)throw new Error("invalid mode");KT.get(this)._StartAnim(t)}setAnimation(e,t="beginning"){NT.RequireString(e),NT.RequireString(t);const s=$T.get(t);if(void 0===s)throw new Error("invalid mode");const n=KT.get(this);if(!n.GetObjectClass().GetAnimationByName(e))throw new Error(`animation name "${e}" does not exist`);n._SetAnim(e,s)}getAnimation(e){NT.RequireString(e);const t=KT.get(this).GetObjectClass().GetAnimationByName(e);return t?t.GetIAnimation():null}get animation(){return KT.get(this)._GetCurrentAnimation().GetIAnimation()}get animationName(){return KT.get(this)._GetCurrentAnimationName()}set animationFrame(e){NT.RequireFiniteNumber(e),KT.get(this)._SetAnimFrame(e)}get animationFrame(){return KT.get(this)._GetAnimFrame()}set animationFrameTag(e){NT.RequireString(e),KT.get(this)._SetAnimFrame(e)}get animationFrameTag(){return KT.get(this)._GetAnimFrameTag()}set animationSpeed(e){NT.RequireFiniteNumber(e),KT.get(this)._SetAnimSpeed(e)}get animationSpeed(){return KT.get(this)._GetAnimSpeed()}set animationRepeatToFrame(e){NT.RequireFiniteNumber(e),KT.get(this)._SetAnimRepeatToFrame(e)}get animationRepeatToFrame(){return KT.get(this)._GetAnimRepeatToFrame()}get imageWidth(){return KT.get(this).GetCurrentImageInfo().GetWidth()}get imageHeight(){return KT.get(this).GetCurrentImageInfo().GetHeight()}getImageSize(){const e=KT.get(this).GetCurrentImageInfo();return[e.GetWidth(),e.GetHeight()]}async replaceCurrentAnimationFrame(e){NT.RequireInstanceOf(e,Blob);const t=KT.get(this),s=t.GetRuntime(),n=t.GetCurrentImageInfo(),i=OT.New(OT.ImageInfo);if(i.LoadDynamicBlobAsset(s,e),await i.LoadStaticTexture(s.GetRenderer(),{sampling:s.GetSampling()}),t.WasReleased())return void i.Release();n.ReplaceWith(i);const r=t.GetSdkType();r._UpdateAllCurrentTexture(),r.GetObjectClass().Dispatcher().dispatchEvent(new OT.Event("animationframeimagechange")),s.UpdateRender()}setSolidCollisionFilter(e,t){NT.RequireString(t),KT.get(this).GetWorldInfo().SetSolidCollisionFilter(!!e,t)}}}{const ZT=self.C3;ZT.Plugins.Sprite.Cnds={IsAnimPlaying(e){return ZT.equalsNoCase(this._GetCurrentAnimationName(),e)},CompareFrame(e,t){return ZT.compare(this._currentFrameIndex,e,t)},CompareFrameTag(e,t){if("string"!=typeof t)return!1;const s=this._currentAnimationFrame.GetTag();return ZT.compare(s.toLowerCase(),e,t.toLowerCase())},CompareAnimSpeed(e,t){return ZT.compare(this._GetAnimSpeed(),e,t)},OnAnimFinished(e){return ZT.equalsNoCase(this._animTriggerName,e)},OnAnyAnimFinished:()=>!0,OnFrameChanged:()=>!0,IsMirrored(){return this.GetWorldInfo().GetWidth()<0},IsFlipped(){return this.GetWorldInfo().GetHeight()<0},OnURLLoaded:()=>!0,OnURLFailed:()=>!0,IsCollisionEnabled(){return this.GetWorldInfo().IsCollisionEnabled()}}}{const QT=self.C3;QT.Plugins.Sprite.Acts={Spawn(e,t,s,n,i){if(!e||!t)return;const[r,a]=this.GetImagePoint(s),o=this._runtime.CreateInstance(e,t,r,a,n,i);if(!o)return;if(n&&t.SortAndAddInstancesByZIndex(o),e.GetPlugin().IsRotatable()){const e=o.GetWorldInfo();e.SetAngle(this.GetWorldInfo().GetAngle()),e.SetBboxChanged()}const l=this._runtime.GetEventSheetManager();l.BlockFlushingInstances(!0),o._TriggerOnCreatedOnSelfAndRelated(),l.BlockFlushingInstances(!1),e!==this._runtime.GetCurrentAction().GetObjectClass()&&this._sdkType._SpawnPickInstance(e,o,n)},StopAnim(){this.SetAnimationPlaying(!1)},StartAnim(e){this._StartAnim(e)},SetAnim(e,t){this._SetAnim(e,t)},SetAnimFrame(e){this._SetAnimFrame(e)},SetAnimSpeed(e){this._SetAnimSpeed(e)},SetAnimRepeatToFrame(e){this._SetAnimRepeatToFrame(e)},AddRemoveAnimation(e,t){try{0===e?this.GetSdkType()._AddAnimation(t):this.GetSdkType()._RemoveAnimation(t)}catch(t){console.error(`[Construct] Error ${0===e?"adding":"removing"} animation: `,t)}},AddRemoveAnimationFrame(e,t,s){try{0===e?this.GetSdkType()._AddAnimationFrame(t,s):this.GetSdkType()._RemoveAnimationFrame(t,s)}catch(t){console.error(`[Construct] Error ${0===e?"adding":"removing"} animation frame: `,t)}},SetMirrored(e){const t=this.GetWorldInfo(),s=t.GetWidth(),n=Math.abs(s)*(0===e?-1:1);s!==n&&(t.SetWidth(n),t.SetBboxChanged())},SetFlipped(e){const t=this.GetWorldInfo(),s=t.GetHeight(),n=Math.abs(s)*(0===e?-1:1);s!==n&&(t.SetHeight(n),t.SetBboxChanged())},SetScale(e){const t=this._currentAnimationFrame.GetImageInfo(),s=this.GetWorldInfo(),n=s.GetWidth()<0?-1:1,i=s.GetHeight()<0?-1:1,r=t.GetWidth()*e*n,a=t.GetHeight()*e*i;s.GetWidth()===r&&s.GetHeight()===a||(s.SetSize(r,a),s.SetBboxChanged())},async LoadURL(e,t,s){const n=this._currentAnimationFrame.GetImageInfo(),i=this.GetWorldInfo(),r=this._runtime,a=this._sdkType;if(n.GetURL()===e)return 0===t&&(i.SetSize(n.GetWidth(),n.GetHeight()),i.SetBboxChanged()),void this.Trigger(QT.Plugins.Sprite.Cnds.OnURLLoaded);const o=QT.New(QT.ImageInfo);try{if(await o.LoadDynamicAsset(r,e),!o.IsLoaded())throw new Error("image failed to load");if(this.WasReleased())return void o.Release();await o.LoadStaticTexture(r.GetRenderer(),{sampling:r.GetSampling()})}catch(e){return console.error("Load image from URL failed: ",e),void(this.WasReleased()||this.Trigger(QT.Plugins.Sprite.Cnds.OnURLFailed))}this.WasReleased()?o.Release():(n.ReplaceWith(o),a._UpdateAllCurrentTexture(),a.GetObjectClass().Dispatcher().dispatchEvent(new QT.Event("animationframeimagechange")),r.UpdateRender(),0===t&&(i.SetSize(n.GetWidth(),n.GetHeight()),i.SetBboxChanged()),await this.TriggerAsync(QT.Plugins.Sprite.Cnds.OnURLLoaded))},SetCollisions(e){this.GetWorldInfo().SetCollisionEnabled(e)},SetSolidCollisionFilter(e,t){this.GetWorldInfo().SetSolidCollisionFilter(0===e,t)},SetEffect(e){this.GetWorldInfo().SetBlendMode(e),this._runtime.UpdateRender()}}}self.C3.Plugins.Sprite.Exps={AnimationFrame(){return this._GetAnimFrame()},AnimationFrameTag(){return this._GetAnimFrameTag()},AnimationFrameCount(){return this._currentAnimation.GetFrameCount()},AnimationName(){return this._currentAnimation.GetName()},AnimationSpeed(){return this._GetAnimSpeed()},OriginalAnimationSpeed(){return this._currentAnimation.GetSpeed()},ImagePointX(e){return this.GetImagePoint(e)[0]},ImagePointY(e){return this.GetImagePoint(e)[1]},ImagePointZ(e){return this.GetImagePoint(e)[2]},ImagePointCount(){return this.GetImagePointCount()},ImageWidth(){return this.GetCurrentImageInfo().GetWidth()},ImageHeight(){return this.GetCurrentImageInfo().GetHeight()},PolyPointXAt(e){return this.GetCollisionPolyPoint(e)[0]},PolyPointYAt(e){return this.GetCollisionPolyPoint(e)[1]},PolyPointCount(){return this.GetCollisionPolyPointCount()}};{const eC=self.C3;eC.Plugins.Browser=class extends eC.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const tC=self.C3;tC.Plugins.Browser.Type=class extends tC.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const sC=self.C3,nC="browser";sC.Plugins.Browser.Instance=class extends sC.SDKInstanceBase{constructor(e,t){super(e,nC),this._initLocationStr="",this._isOnline=!1,this._referrer="",this._docTitle="",this._isCookieEnabled=!1,this._screenWidth=0,this._screenHeight=0,this._windowOuterWidth=0,this._windowOuterHeight=0,this._windowHasFocus=!1,this._isConstructArcade=!1,this._cssStyleMap=new Map,this._isInstallAvailable=!1,this._installResult="",this._isWarnOnCloseEnabled=!1,this.AddDOMMessageHandlers([["online-state",e=>this._OnOnlineStateChanged(e)],["backbutton",()=>this._OnBackButton()],["sw-message",e=>this._OnSWMessage(e)],["hashchange",e=>this._OnHashChange(e)],["install-available",()=>this._OnInstallAvailable()],["app-installed",e=>this._OnAppInstalled(e)]]);const s=this.GetRuntime().Dispatcher();this._disposables=new sC.CompositeDisposable(sC.Disposable.From(s,"afterfirstlayoutstart",(()=>this._OnAfterFirstLayoutStart())),sC.Disposable.From(s,"window-resize",(()=>this._OnWindowResize())),sC.Disposable.From(s,"window-focus",(()=>this._OnWindowFocus())),sC.Disposable.From(s,"window-blur",(()=>this._OnWindowBlur())),sC.Disposable.From(s,"suspend",(()=>this._OnSuspend())),sC.Disposable.From(s,"resume",(()=>this._OnResume()))),this._runtime.AddLoadPromise(this.PostToDOMAsync("get-initial-state",{exportType:this._runtime.GetExportType()}).then((e=>{this._initLocationStr=e.location,this._isOnline=e.isOnline,this._referrer=e.referrer,this._docTitle=e.title,this._isCookieEnabled=e.isCookieEnabled,this._screenWidth=e.screenWidth,this._screenHeight=e.screenHeight,this._windowOuterWidth=e.windowOuterWidth,this._windowOuterHeight=e.windowOuterHeight,this._windowHasFocus=e.windowHasFocus,this._isConstructArcade=e.isConstructArcade})))}Release(){super.Release()}_OnAfterFirstLayoutStart(){this.PostToDOM("ready-for-sw-messages")}async _OnOnlineStateChanged(e){const t=!!e.isOnline;this._isOnline!==t&&(this._isOnline=t,this._isOnline?await this.TriggerAsync(sC.Plugins.Browser.Cnds.OnOnline):await this.TriggerAsync(sC.Plugins.Browser.Cnds.OnOffline))}async _OnWindowResize(){await this.TriggerAsync(sC.Plugins.Browser.Cnds.OnResize)}async _OnWindowFocus(){this._windowHasFocus=!0,await this.TriggerAsync(sC.Plugins.Browser.Cnds.OnWindowFocus)}async _OnWindowBlur(){this._windowHasFocus=!1,await this.TriggerAsync(sC.Plugins.Browser.Cnds.OnWindowBlur)}_OnSuspend(){this.Trigger(sC.Plugins.Browser.Cnds.OnPageHidden)}_OnResume(){this.Trigger(sC.Plugins.Browser.Cnds.OnPageVisible)}async _OnBackButton(){await this.TriggerAsync(sC.Plugins.Browser.Cnds.OnBackButton)}_OnSWMessage(e){const t=e.type;"downloading-update"===t?this.Trigger(sC.Plugins.Browser.Cnds.OnUpdateFound):"update-ready"===t||"update-pending"===t?this.Trigger(sC.Plugins.Browser.Cnds.OnUpdateReady):"offline-ready"===t&&this.Trigger(sC.Plugins.Browser.Cnds.OnOfflineReady)}_OnHashChange(e){this._initLocationStr=e.location,this.Trigger(sC.Plugins.Browser.Cnds.OnHashChange)}_OnInstallAvailable(){this._isInstallAvailable=!0,this.Trigger(sC.Plugins.Browser.Cnds.OnInstallAvailable)}_OnAppInstalled(e){this._isInstallAvailable=!1,this.Trigger(sC.Plugins.Browser.Cnds.OnAppInstalled)}_IsWarnOnCloseEnabled(){return this._isWarnOnCloseEnabled}_SetWarnOnCloseEnabled(e){e=!!e,this._isWarnOnCloseEnabled!==e&&(this._isWarnOnCloseEnabled=e,this.PostToDOM("set-warn-on-close",{enabled:e}))}GetDebuggerProperties(){const e="plugins.browser.debugger";return[{title:"plugins.browser.name",properties:[{name:e+".user-agent",value:navigator.userAgent},{name:e+".is-online",value:this._isOnline},{name:e+".is-fullscreen",value:this._runtime.GetCanvasManager().IsDocumentFullscreen()}]}]}}}{const iC=self.C3;iC.Plugins.Browser.Cnds={IsOnline(){return this._isOnline},OnOnline:()=>!0,OnOffline:()=>!0,OnResize:()=>!0,OnWindowFocus:()=>!0,OnWindowBlur:()=>!0,WindowHasFocus(){return this._windowHasFocus},CookiesEnabled(){return this._isCookieEnabled},IsFullscreen(){return this._runtime.GetCanvasManager().IsDocumentFullscreen()},OnBackButton:()=>!0,IsPortraitLandscape(e){return(this._runtime.GetCanvasManager().GetLastWidth()<=this._runtime.GetCanvasManager().GetLastHeight()?0:1)===e},OnUpdateFound:()=>!0,OnUpdateReady:()=>!0,OnOfflineReady:()=>!0,OnHashChange:()=>!0,OnInstallAvailable:()=>!0,IsInstallAvailable(){return this._isInstallAvailable},OnInstallResult(e){switch(e){case 0:return"accepted"===this._installResult;case 1:return"dismissed"===this._installResult;case 2:return"error"===this._installResult;case 3:return!0;default:return!1}},OnAppInstalled:()=>!0,CompareDisplayMode(e){const t=this._runtime.GetCanvasManager().GetCssDisplayMode();switch(e){case 0:return"browser"===t;case 1:return"minimal-ui"===t;case 2:return"standalone"===t;case 3:return"fullscreen"===t;default:return!1}},IsWarnOnCloseEnabled(){return this._IsWarnOnCloseEnabled()},PageVisible(){return!this._runtime.IsSuspended()},OnPageHidden:()=>!0,OnPageVisible:()=>!0,HasJava:()=>!1,IsDownloadingUpdate:()=>!1,OnMenuButton:()=>!1,OnSearchButton:()=>!1,IsMetered:()=>!1,IsCharging:()=>!0,SupportsFullscreen:()=>!0}}{const C3=self.C3,ORIENTATIONS=["portrait","landscape","portrait-primary","portrait-secondary","landscape-primary","landscape-secondary"];C3.Plugins.Browser.Acts={Alert(e){this.PostToDOM("alert",{message:e.toString()})},Close(){this._isConstructArcade||(this._runtime.IsDebug()?self.C3Debugger.CloseWindow():this.PostToDOM("close"))},Focus(){this.PostToDOM("set-focus",{isFocus:!0})},Blur(){this.PostToDOM("set-focus",{isFocus:!1})},GoBack(){this._isConstructArcade||this.PostToDOM("navigate",{type:"back"})},GoForward(){this._isConstructArcade||this.PostToDOM("navigate",{type:"forward"})},GoHome(){},Reload(){this._isConstructArcade||(this._runtime.IsDebug()?this._runtime.PostToDebugger({type:"reload"}):this.PostToDOM("navigate",{type:"reload"}))},GoToURL(e,t){this._PostToDOMMaybeSync("navigate",{type:"url",url:e,target:t,exportType:this._runtime.GetExportType()})},GoToURLWindow(e,t){this._PostToDOMMaybeSync("navigate",{type:"new-window",url:e,tag:t,exportType:this._runtime.GetExportType()})},RequestFullScreen(e,t){e>=2&&(e+=1),6===e&&(e=2),1===e&&(e=0);const s=C3.CanvasManager._FullscreenModeNumberToString(e);this._runtime.GetCanvasManager().SetDocumentFullscreenMode(s),this._PostToDOMMaybeSync("request-fullscreen",{navUI:t})},CancelFullScreen(){this._PostToDOMMaybeSync("exit-fullscreen")},Vibrate(e){const t=e.split(",");for(let e=0,s=t.length;e<s;++e)t[e]=parseInt(t[e],10);this._PostToDOMMaybeSync("vibrate",{pattern:t})},async InvokeDownload(e,t){if(!e||!t)return;const s=await this._runtime.GetAssetManager().GetProjectFileUrl(e);this._runtime.InvokeDownload(s,t)},InvokeDownloadString(e,t,s){if(!s)return;const n=`data:${t},${encodeURIComponent(e)}`;this._runtime.InvokeDownload(n,s)},ConsoleLog(e,t){t=t.toString(),0===e?console.log(t):1===e?console.warn(t):2===e&&console.error(t)},ConsoleGroup(e){console.group(e)},ConsoleGroupEnd(){console.groupEnd()},ExecJs(jsStr){try{eval(jsStr)}catch(e){console.error("Error executing JavaScript: ",e)}},LockOrientation(e){if((e=Math.floor(e))<0||e>=ORIENTATIONS.length)return;const t=ORIENTATIONS[e];this._PostToDOMMaybeSync("lock-orientation",{orientation:t})},UnlockOrientation(){this._PostToDOMMaybeSync("unlock-orientation")},LoadStyleSheet(e){this._runtime.GetAssetManager().LoadStyleSheet(e)},async SetDocumentCSSStyle(e,t,s,n){await this.PostToDOMAsync("set-document-css-style",{prop:C3.CSSToCamelCase(e),value:t,selector:s,"is-all":0!==n})},async GetDocumentCSSStyle(e,t,s){const n=await this.PostToDOMAsync("get-document-css-style",{prop:e,selector:t});n.isOk&&this._cssStyleMap.set(s.toLowerCase(),n.result.trim())},SetHash(e){this.PostToDOM("set-hash",{hash:e})},SetWindowSize(e,t){this.PostToDOM("set-window-size",{windowWidth:e,windowHeight:t})},SetWindowPosition(e,t){this.PostToDOM("set-window-position",{windowX:e,windowY:t})},async RequestInstall(){const e=await this.PostToDOMAsync("request-install");this._installResult=e.result,this.Trigger(C3.Plugins.Browser.Cnds.OnInstallResult)},SetWarnOnClose(e){this._SetWarnOnCloseEnabled(e)}}}{const C3=self.C3;C3.Plugins.Browser.Exps={URL(){return this._runtime.IsInWorker()?this._initLocationStr:location.toString()},Protocol(){return this._runtime.IsInWorker()?new URL(this._initLocationStr).protocol:location.protocol},Domain(){return this._runtime.IsInWorker()?new URL(this._initLocationStr).hostname:location.hostname},Port(){return this._runtime.IsInWorker()?new URL(this._initLocationStr).port:location.port},PathName(){return this._runtime.IsInWorker()?new URL(this._initLocationStr).pathname:location.pathname},Hash(){return this._runtime.IsInWorker()?new URL(this._initLocationStr).hash:location.hash},QueryString(){return this._runtime.IsInWorker()?new URL(this._initLocationStr).search:location.search},QueryParam(e){const t=this._runtime.IsInWorker()?new URL(this._initLocationStr).search:location.search,s=RegExp("[?&]"+e+"=([^&]*)").exec(t);return s?decodeURIComponent(s[1].replace(/\+/g," ")):""},Referrer(){return this._referrer},Title(){return this._docTitle},Language:()=>navigator.language,Platform:()=>navigator.platform,UserAgent:()=>navigator.userAgent,ExecJS(jsStr){let result=0;try{result=eval(jsStr)}catch(e){console.error("Error executing JavaScript: ",e)}return"number"==typeof result||"string"==typeof result?result:"boolean"==typeof result&&result?1:0},CSSStyleValue(e){return this._cssStyleMap.get(e)||""},Name:()=>navigator.appName,Version:()=>navigator.appVersion,Product:()=>navigator.product,Vendor:()=>navigator.vendor,BatteryLevel:()=>1,BatteryTimeLeft:()=>1/0,Bandwidth(){const e=navigator.connection;return e&&(e.downlink||e.downlinkMax||e.bandwidth)||1/0},ConnectionType(){const e=navigator.connection;return e&&e.type||"unknown"},DevicePixelRatio:()=>self.devicePixelRatio,ScreenWidth(){return this._screenWidth},ScreenHeight(){return this._screenHeight},WindowInnerWidth(){return this._runtime.GetCanvasManager().GetLastWidth()},WindowInnerHeight(){return this._runtime.GetCanvasManager().GetLastHeight()},WindowOuterWidth(){return this._windowOuterWidth},WindowOuterHeight(){return this._windowOuterWidth},DisplayMode(){return this._runtime.GetCanvasManager().GetCssDisplayMode()},InstallResult(){return this._installResult}}}{const rC=self.C3;rC.Plugins.Text=class extends rC.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const aC=self.C3;aC.Plugins.Text.Type=class extends aC.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}LoadTextures(e){}ReleaseTextures(){}}}{const oC=self.C3,lC=self.C3X,cC=[0,0,0],hC=0,_C=1,uC=2,dC=3,pC=4,fC=5,mC=6,gC=7,IC=8,SC=9,yC=10,bC=11,GC=12,vC=13,xC=15,TC=["left","center","right"],CC=["top","center","bottom"],wC=["ltr","rtl"],PC=["word","cjk","character"],AC=new oC.Rect,RC=new oC.Quad,DC=new oC.Color,EC=oC.New(oC.Vector2),MC=new Map([["b","strong"],["i","em"],["s","s"],["u","u"],["iconoffsety",null]]);oC.Plugins.Text.Instance=class extends oC.SDKWorldInstanceBase{constructor(e,t){if(super(e),this._text="",this._enableBBcode=!0,this._faceName="Arial",this._ptSize=12,this._lineHeightOffset=0,this._isBold=!1,this._isItalic=!1,this._color=oC.New(oC.Color),this._horizontalAlign=0,this._verticalAlign=0,this._wrapMode="word",this._textDirection=0,this._resolutionMode="auto",this._fixedScaleFactor=1,this._iconObjectClass=null,this._htmlString="",this._isHtmlStringUpToDate=!1,this._readAloud=!1,this._screenReaderText=null,this._typewriterStartTime=-1,this._typewriterEndTime=-1,this._typewriterLength=0,this._rendererText=oC.New(oC.Gfx.RendererText,this._runtime.GetRenderer(),{timeout:5}),this._rendererText.ontextureupdate=()=>this._runtime.UpdateRender(),this._animationframeimagechange_handler=()=>this._OnIconObjectClassImageChanged(),this._pendingUpdateIconSet=!1,t){this._text=t[hC],this._enableBBcode=!!t[_C],this._faceName=t[uC],this._ptSize=t[dC],this._lineHeightOffset=t[pC],this._isBold=!!t[fC],this._isItalic=!!t[mC],this._horizontalAlign=t[IC],this._verticalAlign=t[SC],this._wrapMode=PC[t[yC]],this._textDirection=t[bC],this._SetIconObjectClass(this._runtime.GetObjectClassBySID(t[GC]));const e=t[gC];this._color.setRgb(e[0],e[1],e[2]),this.GetWorldInfo().SetVisible(t[vC]),this._readAloud=!!t[xC]}this._UpdateTextSettings(),this._UpdateScreenReaderText()}Release(){this._SetIconObjectClass(null),this._CancelTypewriter(),this._screenReaderText&&(this._screenReaderText.Release(),this._screenReaderText=null),this._rendererText.Release(),this._rendererText=null,super.Release()}_UpdateTextSettings(){const e=this._rendererText;e.SetText(this._text),e.SetBBCodeEnabled(this._enableBBcode),this._rendererText.IsBBCodeEnabled()&&this._iconObjectClass?this._rendererText.SetIconSet(this.GetRuntime().GetTextIconSet(this._iconObjectClass)):this._rendererText.SetIconSet(null),e.SetIconSmoothing("nearest"!==this._runtime.GetSampling()),e.SetFontName(this._faceName),e.SetLineHeight(this._lineHeightOffset),e.SetBold(this._isBold),e.SetItalic(this._isItalic),e.SetColor(this._color),e.SetHorizontalAlignment(TC[this._horizontalAlign]),e.SetVerticalAlignment(CC[this._verticalAlign]),e.SetWordWrapMode(this._wrapMode),e.SetTextDirection(wC[this._textDirection])}_UpdateTextSize(){const e=this.GetWorldInfo();this._rendererText.SetFontSize(this._ptSize),this._rendererText.SetFontSizeScale(e.GetSceneGraphScale());const t=e.GetLayer();let s;"auto"===this._resolutionMode?s=t.GetResolutionScaleFactorToZ(e.GetTotalZElevation()):"fixed"===this._resolutionMode&&(s=this._fixedScaleFactor),e.HasMesh()&&s!==this._rendererText.GetZoom()&&e.SetMeshChanged(!0),this._rendererText.SetSize(e.GetWidth(),e.GetHeight(),s)}_SetIconObjectClass(e){e&&(e.IsFamily()||e.GetPlugin().constructor!==oC.Plugins.Sprite)||e!==this._iconObjectClass&&(this._iconObjectClass&&this._iconObjectClass.Dispatcher().removeEventListener("animationframeimagechange",this._animationframeimagechange_handler),this._iconObjectClass=e,this._iconObjectClass&&this._iconObjectClass.Dispatcher().addEventListener("animationframeimagechange",this._animationframeimagechange_handler),this._UpdateTextSettings(),this._isHtmlStringUpToDate=!1,this._runtime.UpdateRender())}_OnIconObjectClassImageChanged(){this._runtime.DeleteTextIconSet(this._iconObjectClass),this._runtime.UpdateRender(),this._pendingUpdateIconSet=!0}_UpdateScreenReaderText(){if(this._readAloud){let e=this._text;this._enableBBcode&&(e=oC.BBString.StripAnyTags(e)),this._screenReaderText?this._screenReaderText.SetText(e):this._screenReaderText=oC.New(oC.ScreenReaderText,this._runtime,e)}else this._screenReaderText&&(this._screenReaderText.Release(),this._screenReaderText=null)}Draw(e){const t=this.GetWorldInfo();this._UpdateTextSize(),this._pendingUpdateIconSet&&(this._pendingUpdateIconSet=!1,this._rendererText.IsBBCodeEnabled()&&this._iconObjectClass&&this._rendererText.SetIconSet(this.GetRuntime().GetTextIconSet(this._iconObjectClass)));const s=this._rendererText.GetTexture();if(!s)return;const n=t.GetLayer();if(0===t.GetAngle()&&0===n.GetAngle()&&0===t.GetTotalZElevation()&&!t.HasMesh()&&n.RendersIn2DMode()){const i=t.GetBoundingQuad(),[r,a]=n.LayerToDrawSurface(i.getTlx(),i.getTly()),[o,l]=n.LayerToDrawSurface(i.getBrx(),i.getBry()),c=r-Math.round(r),h=a-Math.round(a);AC.set(r,a,o,l),AC.offset(-c,-h),RC.setFromRect(AC);const[_,u]=e.GetRenderTargetSize(e.GetRenderTarget());this._runtime.GetCanvasManager().SetDeviceTransform(e,_,u),e.SetTexture(s),e.Quad3(RC,this._rendererText.GetTexRect()),n._SetTransform(e)}else e.SetTexture(s),t.HasMesh()?this._DrawMesh(t,e):this._DrawStandard(t,e)}_DrawStandard(e,t){let s=e.GetBoundingQuad();this._runtime.IsPixelRoundingEnabled()&&(s=this._PixelRoundQuad(s)),t.Quad3(s,this._rendererText.GetTexRect())}_DrawMesh(e,t){const s=e.GetTransformedMesh();if(e.IsMeshChanged()){e.CalculateBbox(AC,RC,!1);let t=RC;this._runtime.IsPixelRoundingEnabled()&&(t=this._PixelRoundQuad(t)),s.CalculateTransformedMesh(e.GetSourceMesh(),t,this._rendererText.GetTexRect()),e.SetMeshChanged(!1)}s.Draw(t)}_PixelRoundQuad(e){const t=e.getTlx()-Math.round(e.getTlx()),s=e.getTly()-Math.round(e.getTly());return 0===t&&0===s?e:(RC.copy(e),RC.offset(-t,-s),RC)}GetCurrentSurfaceSize(){const e=this._rendererText.GetTexture();return e?[e.GetWidth(),e.GetHeight()]:[100,100]}GetCurrentTexRect(){return this._rendererText.GetTexRect()}IsCurrentTexRotated(){return!1}SaveToJson(){const e={t:this._text,c:this._color.toJSON(),fn:this._faceName,ps:this._ptSize};return this._enableBBcode&&(e.bbc=this._enableBBcode),0!==this._horizontalAlign&&(e.ha=this._horizontalAlign),0!==this._verticalAlign&&(e.va=this._verticalAlign),"word"!==this._wrapMode&&(e.wr=this._wrapMode),0!==this._lineHeightOffset&&(e.lho=this._lineHeightOffset),this._isBold&&(e.b=this._isBold),this._isItalic&&(e.i=this._isItalic),-1!==this._typewriterEndTime&&(e.tw={st:this._typewriterStartTime,en:this._typewriterEndTime,l:this._typewriterLength}),this._iconObjectClass&&(e.ioc=this._iconObjectClass.GetSID()),"fixed"===this._resolutionMode&&(e.fs=this._fixedScaleFactor),e}LoadFromJson(e){if(this._CancelTypewriter(),this._text=e.t,this._color.setFromJSON(e.c),this._faceName=e.fn,this._ptSize=e.ps,this._enableBBcode=!!e.hasOwnProperty("bbc")&&e.bbc,this._horizontalAlign=e.hasOwnProperty("ha")?e.ha:0,this._verticalAlign=e.hasOwnProperty("va")?e.va:0,e.hasOwnProperty("wr")){const t=e.wr;this._wrapMode="boolean"==typeof t?t?"word":"character":t}else this._wrapMode="word";if(this._lineHeightOffset=e.hasOwnProperty("lho")?e.lho:0,this._isBold=!!e.hasOwnProperty("b")&&e.b,this._isItalic=!!e.hasOwnProperty("i")&&e.i,e.hasOwnProperty("tw")){const t=e.tw;this._typewriterStartTime=t.st,this._typewriterEndTime=t.en,this._typewriterLength=t.l}if(e.hasOwnProperty("ioc")){const t=this.GetRuntime().GetObjectClassBySID(e.ioc);t&&this._SetIconObjectClass(t)}else this._SetIconObjectClass(null);e.hasOwnProperty("fs")?(this._resolutionMode="fixed",this._fixedScaleFactor=e.fs):this._resolutionMode="auto",this._UpdateTextSettings(),this._UpdateScreenReaderText(),this._isHtmlStringUpToDate=!1,-1!==this._typewriterEndTime&&this._StartTicking()}GetPropertyValueByIndex(e){switch(e){case hC:return this.GetText();case _C:return this._enableBBcode;case uC:return this._GetFontFace();case dC:return this._GetFontSize();case pC:return this._GetLineHeight();case fC:return this._IsBold();case mC:return this._IsItalic();case gC:return cC[0]=this._color.getR(),cC[1]=this._color.getG(),cC[2]=this._color.getB(),cC;case IC:return this._GetHAlign();case SC:return this._GetVAlign();case yC:return this._GetWrapMode();case xC:return this._IsReadAloud()}}SetPropertyValueByIndex(e,t){switch(e){case hC:this._SetText(t);break;case _C:if(this._enableBBcode===!!t)return;this._enableBBcode=!!t,this._UpdateTextSettings();break;case uC:this._SetFontFace(t);break;case dC:this._SetFontSize(t);break;case pC:this._SetLineHeight(t);break;case fC:this._SetBold(t);break;case mC:this._SetItalic(t);break;case gC:const e=this._color,s=t;if(e.getR()===s[0]&&e.getG()===s[1]&&e.getB()===s[2])return;this._color.setRgb(s[0],s[1],s[2]),this._UpdateTextSettings();break;case IC:this._SetHAlign(t);break;case SC:this._SetVAlign(t);break;case yC:this._SetWrapMode(t)}}SetPropertyColorOffsetValueByIndex(e,t,s,n){0===t&&0===s&&0===n||e!==gC||(this._color.addRgb(t,s,n),this._UpdateTextSettings())}_SetText(e){this._text!==e&&(this._text=e,this._rendererText.SetText(e),this._UpdateScreenReaderText(),this._isHtmlStringUpToDate=!1,this._runtime.UpdateRender())}GetText(){return this._text}_StartTypewriter(e,t){this._UpdateTextSize(),this._SetText(e),this._typewriterStartTime=this._runtime.GetWallTime(),this._typewriterEndTime=this._typewriterStartTime+t/this.GetInstance().GetActiveTimeScale(),this._typewriterLength=this._rendererText.GetLengthInGraphemes(),this._rendererText.SetDrawMaxCharacterCount(0),this._StartTicking()}_CancelTypewriter(){this._typewriterStartTime=-1,this._typewriterEndTime=-1,this._typewriterLength=0,this._rendererText.SetDrawMaxCharacterCount(-1),this._StopTicking()}_FinishTypewriter(){-1!==this._typewriterEndTime&&(this._CancelTypewriter(),this.Trigger(oC.Plugins.Text.Cnds.OnTypewriterTextFinished),this._runtime.UpdateRender())}_SetFontFace(e){this._faceName!==e&&(this._faceName=e,this._rendererText.SetFontName(e),this._runtime.UpdateRender())}_GetFontFace(){return this._faceName}_SetBold(e){e=!!e,this._isBold!==e&&(this._isBold=e,this._rendererText.SetBold(e),this._runtime.UpdateRender())}_IsBold(){return this._isBold}_SetItalic(e){e=!!e,this._isItalic!==e&&(this._isItalic=e,this._rendererText.SetItalic(e),this._runtime.UpdateRender())}_IsItalic(){return this._isItalic}_SetFontSize(e){this._ptSize!==e&&(this._ptSize=e,this._runtime.UpdateRender())}_GetFontSize(){return this._ptSize}_SetFontColor(e){this._color.equalsIgnoringAlpha(e)||(this._color.copyRgb(e),this._rendererText.SetColor(this._color),this._runtime.UpdateRender())}_GetFontColor(){return this._color}_SetLineHeight(e){this._lineHeightOffset!==e&&(this._lineHeightOffset=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetLineHeight(){return this._lineHeightOffset}_SetHAlign(e){this._horizontalAlign!==e&&(this._horizontalAlign=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetHAlign(){return this._horizontalAlign}_SetVAlign(e){this._verticalAlign!==e&&(this._verticalAlign=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetVAlign(){return this._verticalAlign}_SetWrapModeByIndex(e){this._SetWrapMode(PC[e])}_SetWrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetWrapMode(){return this._wrapMode}_SetTextDirection(e){this._textDirection!==e&&(this._textDirection=e,this._UpdateTextSettings(),this._runtime.UpdateRender())}_GetTextDirection(){return this._textDirection}_SetReadAloud(e){this._readAloud=!!e,this._UpdateScreenReaderText()}_IsReadAloud(){return this._readAloud}_SetResolutionMode(e){this._resolutionMode!==e&&(this._resolutionMode=e,this._runtime.UpdateRender())}_GetResolutionMode(){return this._resolutionMode}_SetFixedScaleFactor(e){this._fixedScaleFactor!==e&&(this._fixedScaleFactor=e,"fixed"===this._resolutionMode&&this._runtime.UpdateRender())}_GetFixedScaleFactor(){return this._fixedScaleFactor}_GetTextWidth(){return this._UpdateTextSize(),this._rendererText.GetTextWidth()}_GetTextHeight(){return this._UpdateTextSize(),this._rendererText.GetTextHeight()}_GetTagAtPosition(e,t){this._UpdateTextSize();const s=this.GetWorldInfo();EC.set(e-s.GetX(),t-s.GetY()),EC.rotate(-s.GetAngle()),EC.offset(s.GetWidth()*s.GetOriginX(),s.GetHeight()*s.GetOriginY()),EC.divide(s.GetWidth(),s.GetHeight()),EC.scale(this._rendererText.GetWidth(),this._rendererText.GetHeight());const n=this._rendererText.HitTestFragment(EC.getX(),EC.getY());if(n){const e=n.GetStyleTag("tag");if(e)return e.param}return""}_HasTagAtPosition(e,t,s){const n=this._GetTagAtPosition(t,s);return n&&oC.equalsNoCase(e,n)}_GetTagPosition(e,t){this._UpdateTextSize(),t=Math.floor(t);const s=this._rendererText.FindFragmentWithTag(e,t);if(!s)return null;const n=this.GetWorldInfo(),i=this._rendererText.GetDrawScale(),r=s.GetPosX(),a=s.GetPosY()-(s.GetHeight()-s.GetFontBoundingBoxDescent())*i,o=s.GetWidth()*i/this._rendererText.GetWidth()*n.GetWidth(),l=s.GetHeight()*i/this._rendererText.GetHeight()*n.GetHeight();return EC.set(r,a),EC.divide(this._rendererText.GetWidth(),this._rendererText.GetHeight()),EC.scale(n.GetWidth(),n.GetHeight()),EC.offset(-n.GetWidth()*n.GetOriginX(),-n.GetHeight()*n.GetOriginY()),EC.rotate(n.GetAngle()),EC.offset(n.GetX(),n.GetY()),{x:EC.getX(),y:EC.getY(),width:o,height:l}}_GetTagCount(e){return this._UpdateTextSize(),this._rendererText.CountFragmentsWithTag(e)}_GetHTMLCloseTag(e){let t=MC.get(e);return null===t?"":(t||(t="span"),`</${t||"span"}>`)}_GetHTMLOpenTag(e,t){let s=MC.get(e);if(null===s)return"";switch(s||(s="span"),e){case"color":return`<${s} style="color: ${t}">`;case"font":return`<${s} style="font-family: '${t}'">`;case"opacity":return`<${s} style="opacity: ${t}%">`;case"size":return`<${s} style="font-size: ${t}pt">`;case"background":return`<${s} style="background-color: ${t}">`;case"hide":return`<${s} style="visibility: hidden">`;case"class":return`<${s} class="${t}">`;case"tag":return`<${s} data-tag="${t}">`;default:return`<${s}>`}}async _UpdateHTMLString(){if(this._isHtmlStringUpToDate)return this._htmlString;const e=new oC.BBString(this._text,{noEscape:!0}).toFragmentList(),t=new Map;let s='<span class="c3-text"';const n=[];n.push(`font-family: '${this._GetFontFace()}';`),this._IsBold()&&n.push("font-weight: bold;"),this._IsItalic()&&n.push("font-style: italic;"),"character"===this._GetWrapMode()&&n.push("word-break: break-all;"),s+=` style="${n.join(" ")}">`;const i=this._iconObjectClass?this.GetRuntime().GetTextIconSet(this._iconObjectClass):null;if(this._iconObjectClass){const s=oC.New(oC.PromiseThrottle),n=[],r=new Map;for(const t of e)if(t.IsIcon()){const e=t.GetTextIcon(i);if(e){const t=e.GetSource().GetImageInfo().GetImageAsset();if(r.has(t))continue;r.set(t,null),n.push(s.Add((async()=>{const e=await t.LoadToDrawable();r.set(t,e)})))}}await Promise.all(n);const a=[];for(const n of e)if(n.IsIcon()){const e=n.GetTextIcon(i);if(e){const n=e.GetSource(),i=n.GetImageInfo().GetImageAsset();a.push(s.Add((async()=>{const s=await n.GetImageInfo().ExtractImageToBlobURL(r.get(i));t.set(e,s)})))}}await Promise.all(a);for(const e of r.values())e instanceof ImageBitmap&&e.close&&e.close()}const r=new Map;for(const n of e){const e=n.GetStyleMap();let a=[...r.keys()];a.reverse();for(const t of a)e.has(t)&&e.get(t)===r.get(t)||(r.delete(t),s+=this._GetHTMLCloseTag(t));for(const[t,n]of e)r.has(t)||(r.set(t,n),s+=this._GetHTMLOpenTag(t,n));if(n.IsText()&&(s+=oC.ReplaceAll(oC.EscapeHTML(n.GetCharacterArray().join("")),"\n","<br>")),n.IsIcon()&&i){const r=n.GetTextIcon(i);if(r){const i=t.get(r);if(i){const t=[];let a="0.2em";const o=e.get("iconoffsety");if(o){let e=o.trim();a=e.endsWith("%")?parseFloat(e)/100+"em":e+"px"}t.push(`top: ${a}`),"nearest"===this._runtime.GetSampling()&&t.push("image-rendering: pixelated"),s+=`<img class="c3-text-icon" data-icon="${n.GetIconParameter()}" width="${r.GetWidth()}" height="${r.GetHeight()}" style="${t.join(";")}" src="${i}">`}}}}const a=[...r.keys()];a.reverse();for(const e of a)s+=this._GetHTMLCloseTag(e);return s+="</span>",this._htmlString=s,this._isHtmlStringUpToDate=!0,this._htmlString}Tick(){const e=this._runtime.GetWallTime();if(e>=this._typewriterEndTime)this._CancelTypewriter(),this.Trigger(oC.Plugins.Text.Cnds.OnTypewriterTextFinished),this._runtime.UpdateRender();else{let t=oC.relerp(this._typewriterStartTime,this._typewriterEndTime,e,0,this._typewriterLength);t=Math.floor(t),t!==this._rendererText.GetDrawMaxCharacterCount()&&(this._rendererText.SetDrawMaxCharacterCount(t),this._runtime.UpdateRender())}}GetDebuggerProperties(){const e="plugins.text";return[{title:e+".name",properties:[{name:e+".properties.text.name",value:this.GetText(),onedit:e=>this._SetText(e)},{name:e+".properties.font.name",value:this._GetFontFace(),onedit:e=>this._SetFontFace(e)},{name:e+".properties.size.name",value:this._GetFontSize(),onedit:e=>this._SetFontSize(e)},{name:e+".properties.line-height.name",value:this._GetLineHeight(),onedit:e=>this._SetLineHeight(e)},{name:e+".properties.bold.name",value:this._IsBold(),onedit:e=>this._SetBold(e)},{name:e+".properties.italic.name",value:this._IsItalic(),onedit:e=>this._SetItalic(e)}]}]}GetScriptInterfaceClass(){return self.ITextInstance}};const kC=new WeakMap,LC=new Map([["left",0],["center",1],["right",2]]),FC=new Map([["top",0],["center",1],["bottom",2]]),BC=["ltr","rtl"];self.ITextInstance=class extends self.IWorldInstance{constructor(){super(),kC.set(this,self.IInstance._GetInitInst().GetSdkInstance())}get text(){return kC.get(this).GetText()}set text(e){lC.RequireString(e);const t=kC.get(this);t._CancelTypewriter(),t._SetText(e)}typewriterText(e,t){lC.RequireString(e),lC.RequireFiniteNumber(t);const s=kC.get(this);s._CancelTypewriter(),s._StartTypewriter(e,t)}typewriterFinish(){kC.get(this)._FinishTypewriter()}set fontFace(e){lC.RequireString(e),kC.get(this)._SetFontFace(e)}get fontFace(){return kC.get(this)._GetFontFace()}set isBold(e){kC.get(this)._SetBold(e)}get isBold(){return kC.get(this)._IsBold()}set isItalic(e){kC.get(this)._SetItalic(e)}get isItalic(){return kC.get(this)._IsItalic()}set sizePt(e){lC.RequireFiniteNumber(e),kC.get(this)._SetFontSize(e)}get sizePt(){return kC.get(this)._GetFontSize()}set fontColor(e){if(lC.RequireArray(e),e.length<3)throw new Error("expected 3 elements");DC.setRgb(e[0],e[1],e[2]),kC.get(this)._SetFontColor(DC)}get fontColor(){const e=kC.get(this)._GetFontColor();return[e.getR(),e.getG(),e.getB()]}set lineHeight(e){lC.RequireFiniteNumber(e),kC.get(this)._SetLineHeight(e)}get lineHeight(){return kC.get(this)._GetLineHeight()}set horizontalAlign(e){lC.RequireString(e);const t=LC.get(e);if(void 0===t)throw new Error("invalid mode");kC.get(this)._SetHAlign(t)}get horizontalAlign(){return TC[kC.get(this)._GetHAlign()]}set verticalAlign(e){lC.RequireString(e);const t=FC.get(e);if(void 0===t)throw new Error("invalid mode");kC.get(this)._SetVAlign(t)}get verticalAlign(){return CC[kC.get(this)._GetVAlign()]}set wordWrapMode(e){if(!PC.includes(e))throw new Error("invalid mode");kC.get(this)._SetWrapMode(e)}get wordWrapMode(){return kC.get(this)._GetWrapMode()}set textDirection(e){lC.RequireString(e);const t=BC.indexOf(e);if(-1===t)throw new Error("invalid text direction");kC.get(this)._SetTextDirection(t)}get textDirection(){return BC[kC.get(this)._GetTextDirection()]}set readAloud(e){kC.get(this)._SetReadAloud(!!e)}get readAloud(){return kC.get(this)._IsReadAloud()}setFixedResolutionMode(e){lC.RequireFiniteNumber(e);const t=kC.get(this);t._SetResolutionMode("fixed"),t._SetFixedScaleFactor(e)}setAutoResolutionMode(){kC.get(this)._SetResolutionMode("auto")}get textWidth(){return kC.get(this)._GetTextWidth()}get textHeight(){return kC.get(this)._GetTextHeight()}getTextSize(){const e=kC.get(this);return[e._GetTextWidth(),e._GetTextHeight()]}hasTagAtPosition(e,t,s){return lC.RequireString(e),lC.RequireFiniteNumber(t),lC.RequireFiniteNumber(s),kC.get(this)._HasTagAtPosition(e,t,s)}getTagAtPosition(e,t){return lC.RequireFiniteNumber(e),lC.RequireFiniteNumber(t),kC.get(this)._GetTagAtPosition(e,t)}getTagPositionAndSize(e,t=0){return lC.RequireString(e),lC.RequireFiniteNumber(t),kC.get(this)._GetTagPosition(e,t)}getTagCount(e){return lC.RequireString(e),kC.get(this)._GetTagCount(e)}changeIconSet(e){const t=kC.get(this),s=t.GetRuntime()._UnwrapIObjectClass(e);t._SetIconObjectClass(s)}getAsHtmlString(){return kC.get(this)._UpdateHTMLString()}}}{const OC=self.C3;OC.Plugins.Text.Cnds={CompareText(e,t){return t?this._text===e:OC.equalsNoCase(this._text,e)},IsRunningTypewriterText(){return-1!==this._typewriterEndTime},OnTypewriterTextFinished:()=>!0,HasTagAtPosition(e,t,s){return this._HasTagAtPosition(e,t,s)}}}{const NC=self.C3,WC=NC.New(NC.Color);NC.Plugins.Text.Acts={SetText(e){this._CancelTypewriter(),"number"==typeof e&&e<1e9&&(e=Math.round(1e10*e)/1e10),this._SetText(e.toString())},AppendText(e){this._CancelTypewriter(),"number"==typeof e&&e<1e9&&(e=Math.round(1e10*e)/1e10),(e=e.toString())&&this._SetText(this._text+e)},TypewriterText(e,t){this._CancelTypewriter(),"number"==typeof e&&e<1e9&&(e=Math.round(1e10*e)/1e10),this._StartTypewriter(e.toString(),t)},SetFontFace(e,t){let s=!1,n=!1;switch(t){case 1:s=!0;break;case 2:n=!0;break;case 3:s=!0,n=!0}e===this._faceName&&s===this._isBold&&n===this._isItalic||(this._SetFontFace(e),this._SetBold(s),this._SetItalic(n))},SetFontSize(e){this._SetFontSize(e)},SetFontColor(e){WC.setFromRgbValue(e),WC.clamp(),this._SetFontColor(WC)},SetWebFont(e,t){console.warn("[Text] 'Set web font' action is deprecated and no longer has any effect")},SetEffect(e){this.GetWorldInfo().SetBlendMode(e),this._runtime.UpdateRender()},TypewriterFinish(){this._FinishTypewriter()},SetLineHeight(e){this._SetLineHeight(e)},SetHAlign(e){this._SetHAlign(e)},SetVAlign(e){this._SetVAlign(e)},SetWrapping(e){this._SetWrapModeByIndex(e)},SetTextDirection(e){this._SetTextDirection(e)},ChangeIconSet(e){this._SetIconObjectClass(e)},UpdateHTML(){return this._UpdateHTMLString()},SetReadAloud(e){this._SetReadAloud(e)},SetResolutionMode(e,t){this._SetResolutionMode(["auto","fixed"][e]),this._SetFixedScaleFactor(t)}}}{const VC=self.C3;VC.Plugins.Text.Exps={Text(){return this._text},PlainText(){return this._enableBBcode?VC.BBString.StripAnyTags(this._text):this._text},FaceName(){return this._faceName},FaceSize(){return this._ptSize},TextWidth(){return this._GetTextWidth()},TextHeight(){return this._GetTextHeight()},LineHeight(){return this._lineHeightOffset},TagAtPosition(e,t){return this._GetTagAtPosition(e,t)},TagCount(e){return this._GetTagCount(e)},TagX(e,t){const s=this._GetTagPosition(e,t);return s?s.x:0},TagY(e,t){const s=this._GetTagPosition(e,t);return s?s.y:0},TagWidth(e,t){const s=this._GetTagPosition(e,t);return s?s.width:0},TagHeight(e,t){const s=this._GetTagPosition(e,t);return s?s.height:0},AsHTML(){return this._htmlString}}}{const jC=self.C3;jC.Plugins.Dictionary=class extends jC.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const UC=self.C3;UC.Plugins.Dictionary.Type=class extends UC.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const HC=self.C3,zC=(self.C3X,self.IInstance);HC.Plugins.Dictionary.Instance=class extends HC.SDKInstanceBase{constructor(e,t){super(e),this._data=new Map,this._curKey=""}Release(){this._data.clear(),super.Release()}GetAsJsonString(){return JSON.stringify({c2dictionary:!0,data:HC.MapToObject(this._data)})}GetDataMap(){return this._data}SaveToJson(){return HC.MapToObject(this._data)}LoadFromJson(e){HC.ObjectToMap(e,this._data)}GetDebuggerProperties(){const e="plugins.dictionary";return[{title:e+".name",properties:[{name:e+".debugger.key-count",value:this._data.size},...[...this._data].map((e=>({name:"$"+e[0],value:e[1],onedit:t=>this._data.set(e[0],t)})))]}]}GetScriptInterfaceClass(){return self.IDictionaryInstance}};const XC=new WeakMap;self.IDictionaryInstance=class extends zC{constructor(){super(),XC.set(this,zC._GetInitInst().GetSdkInstance())}getDataMap(){return XC.get(this).GetDataMap()}}}{const YC=self.C3;YC.Plugins.Dictionary.Cnds={CompareValue(e,t,s){const n=this._data.get(e);return void 0!==n&&YC.compare(n,t,s)},ForEachKey(){const e=this._runtime,t=e.GetEventSheetManager(),s=e.GetCurrentEvent(),n=s.GetSolModifiers(),i=e.GetEventStack(),r=i.GetCurrentStackFrame(),a=i.Push(s);e.SetDebuggingEnabled(!1);for(const e of this._data.keys())this._curKey=e,t.PushCopySol(n),this.GetObjectClass().GetCurrentSol().PickOne(this.GetInstance()),s.Retrigger(r,a),t.PopSol(n);return e.SetDebuggingEnabled(!0),this._curKey="",i.Pop(),!1},CompareCurrentValue(e,t){const s=this._data.get(this._curKey);return void 0!==s&&YC.compare(s,e,t)},HasKey(e){return this._data.has(e)},IsEmpty(){return 0===this._data.size}}}{const qC=self.C3;qC.Plugins.Dictionary.Acts={AddKey(e,t){this._data.set(e,t)},SetKey(e,t){this._data.has(e)&&this._data.set(e,t)},DeleteKey(e){this._data.delete(e)},Clear(){this._data.clear()},JSONLoad(e){let t=null;try{t=JSON.parse(e)}catch(e){return void console.error("[Construct] Error parsing JSON: ",e)}t.c2dictionary&&qC.ObjectToMap(t.data,this._data)},JSONDownload(e){const t=URL.createObjectURL(new Blob([this.GetAsJsonString()],{type:"application/json"}));this._runtime.InvokeDownload(t,e)}}}self.C3.Plugins.Dictionary.Exps={Get(e){const t=this._data.get(e);return void 0===t?0:t},GetDefault(e,t){const s=this._data.get(e);return void 0===s?t:s},KeyCount(){return this._data.size},CurrentKey(){return this._curKey},CurrentValue(){return this._data.get(this._curKey)??0},AsJSON(){return this.GetAsJsonString()}};{const JC=self.C3;JC.Plugins.Json=class extends JC.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const KC=self.C3;KC.Plugins.Json.Type=class extends KC.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const $C=self.C3,ZC=self.C3X,QC=self.IInstance;$C.Plugins.Json.Instance=class extends $C.SDKInstanceBase{constructor(e,t){super(e),this._valueCache=[null,null],this._locationCache=[null,null],this._data={},this._path=[],this._currentKey="",this._currentValue=0}Release(){super.Release()}_InvalidateValueCache(){this._valueCache[0]=null,this._valueCache[1]=null}_HasValueCache(e,t){const s=this._valueCache[0];if(null===e||null===s)return!1;if(s===e||$C.arraysEqual(s,e))return!0;if(t&&s.length>0){for(let t=0,n=Math.min(e.length,s.length);t<n;++t)if(e[t]!==s[t])return!1;return!0}return!1}_GetValueCache(){return this._valueCache[1]}_UpdateValueCache(e,t){this._valueCache[0]=e,this._valueCache[1]=t}_InvalidateLocationCache(){this._locationCache[0]=null,this._locationCache[1]=null}_HasLocationCache(e){return this._locationCache[0]===e}_GetLocationCache(){return this._locationCache[1]}_UpdateLocationCache(e,t){this._locationCache[0]=e,this._locationCache[1]=t}_SetData(e){this._data=e,this._InvalidateValueCache(),this._SetPath("")}_GetData(){return this._data}_SetPath(e){this._path=this._ParsePathUnsafe(e),this._InvalidateLocationCache()}_ParsePath(e){return $C.cloneArray(this._ParsePathUnsafe(e))}_ParsePathUnsafe(e){const t=[];let s,n=!1;if(this._HasLocationCache(e))return this._GetLocationCache();"."===e[0]?(s=$C.cloneArray(this._path),e=e.slice(1)):s=[];for(const i of e)n?(t.push(i),n=!1):"\\"===i?n=!0:"."===i?(s.push(t.join("")),$C.clearArray(t)):t.push(i);return 0!==t.length&&s.push(t.join("")),this._UpdateLocationCache(e,s),s}_GetValueAtFullPath(e,t){if(this._HasValueCache(e,!1))return this._GetValueCache();let s=this._data;for(const n of e)if(Array.isArray(s)){const e=parseInt(n,10);if(e<0||e>=s.length||!isFinite(e)){s=null;break}s=s[e]}else{if("object"!=typeof s||null===s){s=null;break}if(s.hasOwnProperty(n))s=s[n];else{if(!t){s=null;break}{const e={};s[n]=e,s=e}}}return this._UpdateValueCache(e,s),s}_GetValue(e){const t=this._ParsePath(e);if(!t.length)return this._data;const s=t.pop(),n=this._GetValueAtFullPath(t,!1);if(Array.isArray(n)){const e=parseInt(s,10);return e>=0&&e<n.length?n[e]:null}return"object"==typeof n&&null!==n&&n.hasOwnProperty(s)?n[s]:null}_JSONTypeOf(e){return null===e?"null":Array.isArray(e)?"array":typeof e}_GetTypeOf(e){const t=this._GetValue(e);return this._JSONTypeOf(t)}_ToSafeValue(e){const t=typeof e;return"number"===t||"string"===t?e:"boolean"===t&&e?1:0}_GetSafeValue(e){return this._ToSafeValue(this._GetValue(e))}_HasKey(e){const t=this._ParsePath(e);if(!t.length)return!1;const s=t.pop(),n=this._GetValueAtFullPath(t,!1);if(Array.isArray(n)){const e=parseInt(s,10);return e>=0&&e<n.length}return"object"==typeof n&&null!==n&&n.hasOwnProperty(s)}_SetValue(e,t){const s=this._ParsePath(e);if(!s.length)return!1;this._HasValueCache(s,!0)&&this._InvalidateValueCache();const n=s.pop(),i=this._GetValueAtFullPath(s,!0);if(Array.isArray(i)){const e=parseInt(n,10);return!(!isFinite(e)||e<0||e>=i.length||(i[e]=t,0))}return"object"==typeof i&&null!==i&&(i[n]=t,!0)}_DeleteKey(e){const t=this._ParsePath(e);if(!t.length)return!1;this._HasValueCache(t,!0)&&this._InvalidateValueCache();const s=t.pop(),n=this._GetValueAtFullPath(t,!1);return!Array.isArray(n)&&"object"==typeof n&&null!==n&&(delete n[s],!0)}SaveToJson(){return{path:this._path,data:this._data}}LoadFromJson(e){this._InvalidateValueCache(),this._InvalidateLocationCache(),this._path=e.path,this._data=e.data}_SanitizeValue(e){return"number"==typeof e?isFinite(e)?e:0:"object"==typeof e?JSON.stringify(e):e+""}GetDebuggerProperties(){const e="plugins.json.debugger";let t;try{t=this._SanitizeValue(this._data)}catch(e){t='"invalid"'}return[{title:e+".title",properties:[{name:e+".data",value:t,onedit:e=>{try{const t=JSON.parse(e);this._SetData(t)}catch(e){}}},{name:e+".path",value:this._path.map((e=>e.replace(/\./g,"\\."))).join(".")}]}]}GetScriptInterfaceClass(){return self.IJSONInstance}};const ew=new WeakMap;self.IJSONInstance=class extends QC{constructor(){super(),ew.set(this,QC._GetInitInst().GetSdkInstance())}getJsonDataCopy(){const e=ew.get(this)._GetData();return JSON.parse(JSON.stringify(e))}setJsonDataCopy(e){try{const t=JSON.parse(JSON.stringify(e));ew.get(this)._SetData(t)}catch(e){throw console.error("[JSON plugin] setJsonData: object is not valid JSON: ",e),e}}setJsonString(e){ZC.RequireString(e);try{const t=JSON.parse(e);ew.get(this)._SetData(t)}catch(e){throw console.error("[JSON plugin] setJsonString: string is not valid JSON: ",e),e}}toCompactString(){return JSON.stringify(ew.get(this)._GetData())}toBeautifiedString(){return JSON.stringify(ew.get(this)._GetData(),null,4)}}}{const tw=self.C3,sw=["null","boolean","number","string","object","array"];tw.Plugins.Json.Cnds={HasKey(e){return this._HasKey(e)},CompareType(e,t){return this._GetTypeOf(e)===sw[t]},CompareValue(e,t,s){return tw.compare(this._GetSafeValue(e),t,s)},IsBooleanSet(e){return!0===this._GetValue(e)},ForEach(e){const t=this._GetValue(e);if("object"!=typeof t||null===t)return!1;const s=this._runtime,n=s.GetEventSheetManager(),i=s.GetCurrentEvent(),r=i.GetSolModifiers(),a=s.GetEventStack(),o=a.GetCurrentStackFrame(),l=a.Push(i),c=this._path,h=this._currentKey,_=this._currentValue,u=this._ParsePathUnsafe(e);s.SetDebuggingEnabled(!1);for(const[e,s]of Object.entries(t))this._path=tw.cloneArray(u),this._path.push(e),this._currentKey=e,this._currentValue=s,n.PushCopySol(r),this.GetObjectClass().GetCurrentSol().PickOne(this.GetInstance()),i.Retrigger(o,l),n.PopSol(r);return s.SetDebuggingEnabled(!0),this._path=c,this._InvalidateLocationCache(),this._currentKey=h,this._currentValue=_,a.Pop(),!1},OnParseError:()=>!0,OnParseSuccess:()=>!0}}{const iw=self.C3;iw.Plugins.Json.Acts={Parse(e){try{this._SetData(JSON.parse(e)),this.Trigger(iw.Plugins.Json.Cnds.OnParseSuccess)}catch(e){console.warn("[JSON plugin] Failed to parse JSON data: ",e),this._SetData({}),this.Trigger(iw.Plugins.Json.Cnds.OnParseError)}},SetPath(e){this._SetPath(e)},SetValue(e,t){this._SetValue(e,t)},SetArray(e,t){let s=this._GetValue(e);Array.isArray(s)?iw.resizeArray(s,t,0):(s=[],iw.extendArray(s,t,0),this._SetValue(e,s))},SetObject(e){this._SetValue(e,{})},SetJSON(e,t){let s=null;try{s=JSON.parse(t),this.Trigger(iw.Plugins.Json.Cnds.OnParseSuccess)}catch(e){console.warn("[JSON plugin] Failed to parse JSON data: ",e),this.Trigger(iw.Plugins.Json.Cnds.OnParseError)}this._SetValue(e,s)},SetNull(e){this._SetValue(e,null)},SetBoolean(e,t){this._SetValue(e,0!==t)},ToggleBoolean(e){const t=this._GetValue(e);"boolean"==typeof t&&this._SetValue(e,!t)},AddTo(e,t){const s=this._GetValue(e);"number"==typeof s&&this._SetValue(e,s+t)},SubtractFrom(e,t){const s=this._GetValue(e);"number"==typeof s&&this._SetValue(e,s-t)},DeleteKey(e){this._DeleteKey(e)},PushValue(e,t,s){const n=this._GetValue(t);Array.isArray(n)&&(0===e?n.push(s):n.unshift(s),this._InvalidateValueCache())},PopValue(e,t){const s=this._GetValue(t);Array.isArray(s)&&(0===e?s.pop():s.shift(),this._InvalidateValueCache())},InsertValue(e,t,s){const n=this._GetValue(t);Array.isArray(n)&&(n.splice(s,0,e),this._InvalidateValueCache())},RemoveValues(e,t,s){const n=this._GetValue(t);Array.isArray(n)&&e>0&&(n.splice(s,e),this._InvalidateValueCache())}}}self.C3.Plugins.Json.Exps={ToCompactString(){try{return JSON.stringify(this._data)}catch(e){return""}},ToBeautifiedString(){try{return JSON.stringify(this._data,null,4)}catch(e){return""}},Get(e){return this._GetSafeValue(e)},GetAsCompactString(e){const t=this._GetValue(e);return JSON.stringify(t)},GetAsBeautifiedString(e){const t=this._GetValue(e);return JSON.stringify(t,null,4)},Front(e){const t=this._GetValue(e);if(Array.isArray(t)){const e=t[0];return this._ToSafeValue(e)}return-1},Back(e){const t=this._GetValue(e);if(Array.isArray(t)){const e=t.at(-1);return this._ToSafeValue(e)}return-1},Type(e){return this._GetTypeOf(e)},ArraySize(e){const t=this._GetValue(e);return Array.isArray(t)?t.length:-1},Path(){return this._path.map((e=>e.replace(/\./g,"\\."))).join(".")},CurrentKey(){return this._currentKey},CurrentValue(){return this._ToSafeValue(this._currentValue)},CurrentType(){return this._JSONTypeOf(this._currentValue)}};{const rw=self.C3;rw.Plugins.LocalStorage=class extends rw.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const aw=self.C3;aw.Plugins.LocalStorage.Type=class extends aw.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const ow=self.C3,lw="localstorage";ow.Plugins.LocalStorage.Instance=class extends ow.SDKInstanceBase{constructor(e,t){super(e,lw),this._currentKey="",this._lastValue="",this._keyNamesList=[],this._errorMessage="",this._isPersistent=!1,this._pendingGets=0,this._pendingSets=0,this._isInMemoryOnly=!1,t&&(this._isInMemoryOnly=t[0]);const s=this._runtime._GetProjectStorage();this._storage=null,this._isInMemoryOnly?this._storage=s.createInstance({forceInMemoryFallback:!0}):this._storage=s,this._debugCache=new Map,this._isLoadingDebugCache=!1,this._runtime.AddLoadPromise(this._Init())}async _Init(){const e=await Promise.race([this.PostToDOMAsync("init"),ow.Wait(3e3)]);e&&(this._isPersistent=e.isPersistent)}Release(){super.Release()}async _TriggerStorageError(e){this._errorMessage=this._GetErrorString(e),await this.TriggerAsync(ow.Plugins.LocalStorage.Cnds.OnError)}_GetErrorString(e){return e?"string"==typeof e?e:"string"==typeof e.message?e.message:"string"==typeof e.name?e.name:"string"==typeof e.data?e.data:"unknown error":"unknown error"}GetDebuggerProperties(){return this._isLoadingDebugCache||this._DebugCacheStorage(),[{title:"plugins.localstorage.name",properties:[...this._debugCache.entries()].map((e=>({name:"$"+e[0],value:e[1],onedit:t=>this._storage.setItem(e[0],t)})))}]}async _DebugCacheStorage(){this._isLoadingDebugCache=!0;try{const e=await this._storage.keys();e.sort(((e,t)=>{const s=e.toLowerCase(),n=t.toLowerCase();return s<n?-1:n<s?1:0}));const t=await Promise.all(e.map((e=>this._storage.getItem(e))));this._debugCache.clear();for(let s=0,n=e.length;s<n;++s)this._debugCache.set(e[s],t[s])}catch(e){console.warn("[C3 debugger] Error displaying local storage: ",e)}finally{this._isLoadingDebugCache=!1}}}}{const cw=self.C3;cw.Plugins.LocalStorage.Cnds={OnItemSet(e){return this._currentKey===e},OnAnyItemSet:()=>!0,OnItemGet(e){return this._currentKey===e},OnAnyItemGet:()=>!0,OnItemRemoved(e){return this._currentKey===e},OnAnyItemRemoved:()=>!0,OnCleared:()=>!0,OnAllKeyNamesLoaded:()=>!0,OnError:()=>!0,OnItemExists(e){return this._currentKey===e},OnItemMissing(e){return this._currentKey===e},CompareKey(e,t){return cw.compare(this._currentKey,e,t)},CompareValue(e,t){return cw.compare(this._lastValue,e,t)},IsProcessingSets(){return this._pendingSets>0},IsProcessingGets(){return this._pendingGets>0},OnAllSetsComplete:()=>!0,OnAllGetsComplete:()=>!0,IsPersistent(){return this._isPersistent}}}{let hw=function(e){return"string"==typeof e||"number"==typeof e};IsExpressionType=hw;const _w=self.C3;_w.Plugins.LocalStorage.Acts={async SetItem(e,t){this._pendingSets++;try{const s=await this._storage.setItem(e,t);await this.ScheduleTriggers((async()=>{this._currentKey=e,this._lastValue=s,await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAnyItemSet),await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnItemSet)}))}catch(e){await this._TriggerStorageError(e)}finally{this._pendingSets--,0===this._pendingSets&&await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAllSetsComplete)}},async SetBinaryItem(e,t){if(!t)return;const s=t.GetFirstPicked(this._inst);if(!s)return;const n=s.GetSdkInstance();if(!n)return;const i=n.GetArrayBufferReadOnly();this._pendingSets++;try{await this._storage.setItem(e,i),await this.ScheduleTriggers((async()=>{this._currentKey=e,this._lastValue="",await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAnyItemSet),await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnItemSet)}))}catch(e){await this._TriggerStorageError(e)}finally{this._pendingSets--,0===this._pendingSets&&await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAllSetsComplete)}},async GetItem(e){this._pendingGets++;try{const t=await this._storage.getItem(e);await this.ScheduleTriggers((async()=>{this._currentKey=e,this._lastValue=hw(t)?t:"",await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAnyItemGet),await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnItemGet)}))}catch(e){await this._TriggerStorageError(e)}finally{this._pendingGets--,0===this._pendingGets&&await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAllGetsComplete)}},async GetBinaryItem(e,t){if(!t)return;const s=t.GetFirstPicked(this._inst);if(!s)return;const n=s.GetSdkInstance();this._pendingGets++;try{let t=await this._storage.getItem(e);t=t instanceof ArrayBuffer?t:new ArrayBuffer(0),await this.ScheduleTriggers((async()=>{this._lastValue="",this._currentKey=e,n.SetArrayBufferTransfer(t),await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAnyItemGet),await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnItemGet)}))}catch(e){await this._TriggerStorageError(e)}finally{this._pendingGets--,0===this._pendingGets&&await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAllGetsComplete)}},async CheckItemExists(e){try{const t=await this._storage.getItem(e);await this.ScheduleTriggers((async()=>{this._currentKey=e,null==t?(this._lastValue="",await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnItemMissing)):(this._lastValue=hw(t)?t:"",await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnItemExists))}))}catch(e){await this._TriggerStorageError(e)}},async RemoveItem(e){try{await this._storage.removeItem(e),await this.ScheduleTriggers((async()=>{this._currentKey=e,this._lastValue="",await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAnyItemRemoved),await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnItemRemoved)}))}catch(e){await this._TriggerStorageError(e)}},async ClearStorage(){try{await this._storage.clear(),await this.ScheduleTriggers((async()=>{this._currentKey="",this._lastValue="",_w.clearArray(this._keyNamesList),await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnCleared)}))}catch(e){await this._TriggerStorageError(e)}},async GetAllKeyNames(){try{const e=await this._storage.keys();await this.ScheduleTriggers((async()=>{this._keyNamesList=e,await this.TriggerAsync(_w.Plugins.LocalStorage.Cnds.OnAllKeyNamesLoaded)}))}catch(e){await this._TriggerStorageError(e)}},async RequestPersistent(){const e=await this.PostToDOMAsync("request-persistent");e.isOk&&(this._isPersistent=e.isPersistent)},LoadMemoryFromJSON(e){if(!this._isInMemoryOnly)return;let t;try{t=JSON.parse(e)}catch(e){return void console.error("[Local Storage] Failed to parse memory storage JSON: ",e)}t&&t["is-c3-storage"]&&Array.isArray(t.items)||console.error("[Local Storage] Failed to load memory storage JSON: invalid data"),this._storage.SetMemoryStorage(new Map(t.items))}}}self.C3.Plugins.LocalStorage.Exps={ItemValue(){return this._lastValue},Key(){return this._currentKey},KeyCount(){return this._keyNamesList.length},KeyAt(e){return(e=Math.floor(e))<0||e>=this._keyNamesList.length?"":this._keyNamesList[e]},ErrorMessage(){return this._errorMessage},MemoryStorageAsJSON(){return this._isInMemoryOnly?JSON.stringify({"is-c3-storage":!0,items:[...this._storage.GetMemoryStorage()]}):""}};{const uw=self.C3;uw.Plugins.PlatformInfo=class extends uw.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const dw=self.C3;dw.Plugins.PlatformInfo.Type=class extends dw.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const pw=self.C3,fw="platform-info";pw.Plugins.PlatformInfo.Instance=class extends pw.SDKInstanceBase{constructor(e,t){super(e,fw),this._screenWidth=0,this._screenHeight=0,this._windowOuterWidth=0,this._windowOuterHeight=0,this._safeAreaInset=[0,0,0,0],this._supportsWakeLock=!1,this._isWakeLockActive=!1,this.AddDOMMessageHandlers([["window-resize",e=>this._OnWindowResize(e)],["wake-lock-acquired",e=>this._OnWakeLockAcquired(e)],["wake-lock-error",e=>this._OnWakeLockError(e)],["wake-lock-released",e=>this._OnWakeLockReleased(e)]]),navigator.connection&&navigator.connection.addEventListener("change",(()=>this._OnNetworkChange())),this._runtime.AddLoadPromise(this.PostToDOMAsync("get-initial-state").then((e=>{this._screenWidth=e.screenWidth,this._screenHeight=e.screenHeight,this._windowOuterWidth=e.windowOuterWidth,this._windowOuterHeight=e.windowOuterHeight,this._safeAreaInset=e.safeAreaInset,this._supportsWakeLock=e.supportsWakeLock})))}Release(){super.Release()}_OnWindowResize(e){this._windowOuterWidth=e.windowOuterWidth,this._windowOuterHeight=e.windowOuterHeight,this._safeAreaInset=e.safeAreaInset}async _OnNetworkChange(){await this.TriggerAsync(pw.Plugins.PlatformInfo.Cnds.OnNetworkChange)}async _OnWakeLockAcquired(){this._isWakeLockActive=!0,await this.TriggerAsync(pw.Plugins.PlatformInfo.Cnds.OnWakeLockAcquired)}async _OnWakeLockError(){this._isWakeLockActive=!1,await this.TriggerAsync(pw.Plugins.PlatformInfo.Cnds.OnWakeLockError)}async _OnWakeLockReleased(){this._isWakeLockActive=!1,await this.TriggerAsync(pw.Plugins.PlatformInfo.Cnds.OnWakeLockReleased)}}}{const mw=self.C3;mw.Plugins.PlatformInfo.Cnds={IsOnMobile:()=>mw.Platform.IsMobile,IsOnWindows:()=>"Windows"===mw.Platform.OS,IsOnMacOS:()=>"macOS"===mw.Platform.OS,IsOnLinux:()=>"Linux"===mw.Platform.OS,IsOnChromeOS:()=>"Chrome OS"===mw.Platform.OS,IsOnAndroid:()=>"Android"===mw.Platform.OS,IsOniOS:()=>"iOS"===mw.Platform.OS,IsWebExport(){const e=this._runtime.GetExportType();return"html5"===e||"scirra-arcade"===e||"preview"===e||"instant-games"===e},IsCordovaExport(){return this._runtime.IsCordova()},IsNWjsExport(){return this._runtime.IsNWjs()},IsWindowsUWPExport(){return"windows-uwp"===this._runtime.GetExportType()},IsWindowsWebView2Export(){return this._runtime.IsWindowsWebView2()},IsMacOSWKWebView2Export(){return"macos-wkwebview"===this._runtime.GetExportType()},IsLinuxCEFExport(){return"linux-cef"===this._runtime.GetExportType()},OnNetworkChange:()=>!0,OnWakeLockAcquired:()=>!0,OnWakeLockError:()=>!0,OnWakeLockReleased:()=>!0,IsWakeLockActive(){return this._isWakeLockActive},IsWakeLockSupported(){return this._supportsWakeLock}}}self.C3.Plugins.PlatformInfo.Acts={RequestWakeLock(){this._supportsWakeLock&&this._PostToDOMMaybeSync("request-wake-lock")},ReleaseWakeLock(){this._supportsWakeLock&&(this._isWakeLockActive=!1,this.PostToDOM("release-wake-lock"))}},self.C3.Plugins.PlatformInfo.Exps={Renderer(){return this._runtime.GetCanvasManager().GetRendererString()},RendererDetail(){return this._runtime.GetCanvasManager().GetRendererDetailString()},DevicePixelRatio(){return this._runtime.GetDevicePixelRatio()},ScreenWidth(){return this._screenWidth},ScreenHeight(){return this._screenHeight},WindowInnerWidth(){return this._runtime.GetCanvasManager().GetLastWidth()},WindowInnerHeight(){return this._runtime.GetCanvasManager().GetLastHeight()},WindowOuterWidth(){return this._windowOuterWidth},WindowOuterHeight(){return this._windowOuterHeight},CanvasCssWidth(){return this._runtime.GetCanvasManager().GetCssWidth()},CanvasCssHeight(){return this._runtime.GetCanvasManager().GetCssHeight()},CanvasDeviceWidth(){return this._runtime.GetCanvasManager().GetDeviceWidth()},CanvasDeviceHeight(){return this._runtime.GetCanvasManager().GetDeviceHeight()},Downlink:()=>navigator.connection&&navigator.connection.downlink||0,DownlinkMax:()=>navigator.connection&&navigator.connection.downlinkMax||0,ConnectionType:()=>navigator.connection&&navigator.connection.type||"unknown",ConnectionEffectiveType:()=>navigator.connection&&navigator.connection.effectiveType||"unknown",ConnectionRTT:()=>navigator.connection&&navigator.connection.rtt||0,HardwareConcurrency:()=>navigator.hardwareConcurrency||0,DeviceMemory:()=>navigator.deviceMemory||0,SafeAreaInsetTop(){return this._safeAreaInset[0]},SafeAreaInsetRight(){return this._safeAreaInset[1]},SafeAreaInsetBottom(){return this._safeAreaInset[2]},SafeAreaInsetLeft(){return this._safeAreaInset[3]},FramesPerSecond(){return this._runtime.GetFramesPerSecond()},TicksPerSecond(){return this._runtime.GetTicksPerSecond()}};{const gw=self.C3;gw.Plugins.Touch=class extends gw.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{let Iw=function(){return bw.GetSingleGlobalInstance().GetSdkInstance()};GetTouchSdkInstance=Iw;const Sw=self.C3,yw=self.C3X;Sw.Plugins.Touch.Type=class extends Sw.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}GetScriptInterfaceClass(){return self.ITouchObjectType}};let bw=null;self.ITouchObjectType=class extends self.IObjectType{constructor(e){super(e),bw=e,e.GetRuntime()._GetCommonScriptInterfaces().touch=this}requestPermission(e){yw.RequireString(e);const t=Iw();if("orientation"===e)return t._RequestPermission(0);if("motion"===e)return t._RequestPermission(1);throw new Error("invalid type")}}}{const Gw=self.C3,vw="touch";Gw.Plugins.Touch.Instance=class extends Gw.SDKInstanceBase{constructor(e,t){super(e,vw),this._touches=new Map,this._useMouseInput=!1,this._isMouseDown=!1,this._orientCompassHeading=0,this._orientAlpha=0,this._orientBeta=0,this._orientGamma=0,this._accX=0,this._accY=0,this._accZ=0,this._accWithGX=0,this._accWithGY=0,this._accWithGZ=0,this._triggerIndex=0,this._triggerId=0,this._triggerPermission=0,this._curTouchX=0,this._curTouchY=0,this._getTouchIndex=0,this._triggerType=0,this._permissionPromises=[],t&&(this._useMouseInput=t[0]),this.AddDOMMessageHandler("permission-result",(e=>this._OnPermissionResult(e)));const s=this.GetRuntime().Dispatcher();this._disposables=new Gw.CompositeDisposable(Gw.Disposable.From(s,"pointerdown",(e=>this._OnPointerDown(e.data))),Gw.Disposable.From(s,"pointermove",(e=>this._OnPointerMove(e.data))),Gw.Disposable.From(s,"pointerup",(e=>this._OnPointerUp(e.data,!1))),Gw.Disposable.From(s,"pointercancel",(e=>this._OnPointerUp(e.data,!0))),Gw.Disposable.From(s,"deviceorientation",(e=>this._OnDeviceOrientation(e.data))),Gw.Disposable.From(s,"deviceorientationabsolute",(e=>this._OnDeviceOrientationAbsolute(e.data))),Gw.Disposable.From(s,"devicemotion",(e=>this._OnDeviceMotion(e.data))),Gw.Disposable.From(s,"tick2",(e=>this._OnTick2())))}Release(){this._touches.clear(),super.Release()}_OnPointerDown(e){if("mouse"===e.pointerType){if(!this._useMouseInput)return;this._isMouseDown=!0}const t=e.pointerId;if(this._touches.has(t))return;const s=e.pageX-this._runtime.GetCanvasClientX(),n=e.pageY-this._runtime.GetCanvasClientY(),i=performance.now(),r=this._touches.size;this._triggerIndex=r,this._triggerId=t;const a=Gw.New(Gw.Plugins.Touch.TouchInfo);a.Init(i,s,n,t,r),this._touches.set(t,a),this.Trigger(Gw.Plugins.Touch.Cnds.OnNthTouchStart),this.Trigger(Gw.Plugins.Touch.Cnds.OnTouchStart),this._curTouchX=s,this._curTouchY=n,this._triggerType=0,this.Trigger(Gw.Plugins.Touch.Cnds.OnTouchObject)}_OnPointerMove(e){if("mouse"===e.pointerType&&!this._isMouseDown)return;const t=this._touches.get(e.pointerId);if(!t)return;const s=performance.now();if(s-t.GetTime()<2)return;const n=e.pageX-this._runtime.GetCanvasClientX(),i=e.pageY-this._runtime.GetCanvasClientY();t.Update(s,n,i,e.width,e.height,e.pressure)}_OnPointerUp(e,t){if("mouse"===e.pointerType){if(!this._isMouseDown)return;this._isMouseDown=!1}const s=performance.now(),n=e.pointerId,i=this._touches.get(n);if(i){if(this._triggerIndex=i.GetStartIndex(),this._triggerId=i.GetId(),!t){const t=e.pageX-this._runtime.GetCanvasClientX(),s=e.pageY-this._runtime.GetCanvasClientY();this._curTouchX=t,this._curTouchY=s,this._triggerType=1,this.Trigger(Gw.Plugins.Touch.Cnds.OnTouchObject)}if(this.Trigger(Gw.Plugins.Touch.Cnds.OnNthTouchEnd),this.Trigger(Gw.Plugins.Touch.Cnds.OnTouchEnd),!t){const e=i.ShouldTriggerTap(s);"single-tap"===e?(this.Trigger(Gw.Plugins.Touch.Cnds.OnTapGesture),this._curTouchX=i.GetX(),this._curTouchY=i.GetY(),this.Trigger(Gw.Plugins.Touch.Cnds.OnTapGestureObject)):"double-tap"===e&&(this.Trigger(Gw.Plugins.Touch.Cnds.OnDoubleTapGesture),this._curTouchX=i.GetX(),this._curTouchY=i.GetY(),this.Trigger(Gw.Plugins.Touch.Cnds.OnDoubleTapGestureObject))}i.Release(),this._touches.delete(n)}}_RequestPermission(e){return this._PostToDOMMaybeSync("request-permission",{type:e}),new Promise(((t,s)=>{this._permissionPromises.push({type:e,resolve:t,reject:s})}))}_OnPermissionResult(e){const t=e.result,s=e.type;this._triggerPermission=s;const n=this._permissionPromises.filter((e=>e.type===s));for(const e of n)e.resolve(t?"granted":"denied");this._permissionPromises=this._permissionPromises.filter((e=>e.type!==s)),t?(this.Trigger(Gw.Plugins.Touch.Cnds.OnPermissionGranted),0===s?this._runtime.RequestDeviceOrientationEvent():this._runtime.RequestDeviceMotionEvent()):this.Trigger(Gw.Plugins.Touch.Cnds.OnPermissionDenied)}_OnDeviceOrientation(e){"number"==typeof e.webkitCompassHeading?this._orientCompassHeading=e.webkitCompassHeading:e.absolute&&(this._orientCompassHeading=e.alpha),this._orientAlpha=e.alpha,this._orientBeta=e.beta,this._orientGamma=e.gamma}_OnDeviceOrientationAbsolute(e){this._orientCompassHeading=e.alpha}_OnDeviceMotion(e){const t=e.acceleration;t&&(this._accX=t.x,this._accY=t.y,this._accZ=t.z);const s=e.accelerationIncludingGravity;s&&(this._accWithGX=s.x,this._accWithGY=s.y,this._accWithGZ=s.z)}_OnTick2(){const e=performance.now();let t=0;for(const s of this._touches.values())s.GetTime()<=e-50&&s._SetLastTime(e),s.ShouldTriggerHold(e)&&(this._triggerIndex=s.GetStartIndex(),this._triggerId=s.GetId(),this._getTouchIndex=t,this.Trigger(Gw.Plugins.Touch.Cnds.OnHoldGesture),this._curTouchX=s.GetX(),this._curTouchY=s.GetY(),this.Trigger(Gw.Plugins.Touch.Cnds.OnHoldGestureObject),this._getTouchIndex=0),++t}_GetTouchByIndex(e){e=Math.floor(e);for(const t of this._touches.values()){if(0===e)return t;--e}return null}_IsClientPosOnCanvas(e,t){return e>=0&&t>=0&&e<this._runtime.GetCanvasCssWidth()&&t<this._runtime.GetCanvasCssHeight()}GetDebuggerProperties(){return[{title:"plugins.touch.debugger.touches",properties:[...this._touches.values()].map((e=>({name:"$"+e.GetId(),value:e.GetX()+", "+e.GetY()})))}]}}}{const xw=self.C3;xw.Plugins.Touch.Cnds={OnTouchStart:()=>!0,OnTouchEnd:()=>!0,IsInTouch(){return this._touches.size>0},OnTouchObject(e,t){return!!e&&t===this._triggerType&&!!this._IsClientPosOnCanvas(this._curTouchX,this._curTouchY)&&this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,[[this._curTouchX,this._curTouchY]],!1)},IsTouchingObject(e){if(!e)return!1;const t=this._runtime.GetCurrentCondition().IsInverted(),s=[...this._touches.values()].filter((e=>this._IsClientPosOnCanvas(e.GetX(),e.GetY()))).map((e=>[e.GetX(),e.GetY()]));return xw.xor(this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,s,t),t)},CompareTouchSpeed(e,t,s){const n=this._GetTouchByIndex(e);return!!n&&xw.compare(n.GetSpeed(),t,s)},OrientationSupported:()=>!0,MotionSupported:()=>!0,CompareOrientation(e,t,s){this._runtime.RequestDeviceOrientationEvent();let n=0;return n=0===e?this._orientAlpha:1===e?this._orientBeta:this._orientGamma,xw.compare(n,t,s)},CompareAcceleration(e,t,s){this._runtime.RequestDeviceMotionEvent();let n=0;return n=0===e?this._accWithGX:1===e?this._accWithGY:2===e?this._accWithGZ:3===e?this._accX:4===e?this._accY:this._accZ,xw.compare(n,t,s)},OnNthTouchStart(e){return(e=Math.floor(e))===this._triggerIndex},OnNthTouchEnd(e){return(e=Math.floor(e))===this._triggerIndex},HasNthTouch(e){return e=Math.floor(e),this._touches.size>=e+1},OnHoldGesture:()=>!0,OnTapGesture:()=>!0,OnDoubleTapGesture:()=>!0,OnHoldGestureObject(e){return!!e&&!!this._IsClientPosOnCanvas(this._curTouchX,this._curTouchY)&&this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,[[this._curTouchX,this._curTouchY]],!1)},OnTapGestureObject(e){return!!e&&!!this._IsClientPosOnCanvas(this._curTouchX,this._curTouchY)&&this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,[[this._curTouchX,this._curTouchY]],!1)},OnDoubleTapGestureObject(e){return!!e&&!!this._IsClientPosOnCanvas(this._curTouchX,this._curTouchY)&&this._runtime.GetCollisionEngine().TestAndSelectCanvasPointOverlap(e,[[this._curTouchX,this._curTouchY]],!1)},OnPermissionGranted(e){return this._triggerPermission===e},OnPermissionDenied(e){return this._triggerPermission===e}}}self.C3.Plugins.Touch.Acts={RequestPermission(e){this._RequestPermission(e)}};{const Tw=self.C3;Tw.Plugins.Touch.Exps={TouchCount(){return this._touches.size},X(e){const t=this._GetTouchByIndex(this._getTouchIndex);return t?t.GetPositionForLayer(this._runtime.GetCurrentLayout(),e,!0):0},Y(e){const t=this._GetTouchByIndex(this._getTouchIndex);return t?t.GetPositionForLayer(this._runtime.GetCurrentLayout(),e,!1):0},XAt(e,t){const s=this._GetTouchByIndex(e);return s?s.GetPositionForLayer(this._runtime.GetCurrentLayout(),t,!0):0},YAt(e,t){const s=this._GetTouchByIndex(e);return s?s.GetPositionForLayer(this._runtime.GetCurrentLayout(),t,!1):0},XForID(e,t){const s=this._touches.get(e);return s?s.GetPositionForLayer(this._runtime.GetCurrentLayout(),t,!0):0},YForID(e,t){const s=this._touches.get(e);return s?s.GetPositionForLayer(this._runtime.GetCurrentLayout(),t,!1):0},AbsoluteX(){const e=this._GetTouchByIndex(0);return e?e.GetX():0},AbsoluteY(){const e=this._GetTouchByIndex(0);return e?e.GetY():0},AbsoluteXAt(e){const t=this._GetTouchByIndex(e);return t?t.GetX():0},AbsoluteYAt(e){const t=this._GetTouchByIndex(e);return t?t.GetY():0},AbsoluteXForID(e){const t=this._touches.get(e);return t?t.GetX():0},AbsoluteYForID(e){const t=this._touches.get(e);return t?t.GetY():0},SpeedAt(e){const t=this._GetTouchByIndex(e);return t?t.GetSpeed():0},SpeedForID(e){const t=this._touches.get(e);return t?t.GetSpeed():0},AngleAt(e){const t=this._GetTouchByIndex(e);return t?Tw.toDegrees(t.GetAngle()):0},AngleForID(e){const t=this._touches.get(e);return t?Tw.toDegrees(t.GetAngle()):0},CompassHeading(){return this._runtime.RequestDeviceOrientationEvent(),this._orientCompassHeading},Alpha(){return this._runtime.RequestDeviceOrientationEvent(),this._orientAlpha},Beta(){return this._runtime.RequestDeviceOrientationEvent(),this._orientBeta},Gamma(){return this._runtime.RequestDeviceOrientationEvent(),this._orientGamma},AccelerationXWithG(){return this._runtime.RequestDeviceMotionEvent(),this._accWithGX},AccelerationYWithG(){return this._runtime.RequestDeviceMotionEvent(),this._accWithGY},AccelerationZWithG(){return this._runtime.RequestDeviceMotionEvent(),this._accWithGZ},AccelerationX(){return this._runtime.RequestDeviceMotionEvent(),this._accX},AccelerationY(){return this._runtime.RequestDeviceMotionEvent(),this._accY},AccelerationZ(){return this._runtime.RequestDeviceMotionEvent(),this._accZ},TouchIndex(){return this._triggerIndex},TouchID(){return this._triggerId},WidthForID(e){const t=this._touches.get(e);return t?t.GetWidth():0},HeightForID(e){const t=this._touches.get(e);return t?t.GetHeight():0},PressureForID(e){const t=this._touches.get(e);return t?t.GetPressure():0}}}{const Cw=self.C3,ww=15,Pw=500,Aw=333,Rw=25;let Dw=-1e3,Ew=-1e3,Mw=-1e4;Cw.Plugins.Touch.TouchInfo=class extends Cw.DefendedBase{constructor(){super(),this._pointerId=0,this._startIndex=0,this._startTime=0,this._time=0,this._lastTime=0,this._startX=0,this._startY=0,this._x=0,this._y=0,this._lastX=0,this._lastY=0,this._width=0,this._height=0,this._pressure=0,this._hasTriggeredHold=!1,this._isTooFarForHold=!1}Release(){}Init(e,t,s,n,i){this._pointerId=n,this._startIndex=i,this._time=e,this._lastTime=e,this._startTime=e,this._startX=t,this._startY=s,this._x=t,this._y=s,this._lastX=t,this._lastY=s}Update(e,t,s,n,i,r){this._lastTime=this._time,this._time=e,this._lastX=this._x,this._lastY=this._y,this._x=t,this._y=s,this._width=n,this._height=i,this._pressure=r,!this._isTooFarForHold&&Cw.distanceTo(this._startX,this._startY,this._x,this._y)>=15&&(this._isTooFarForHold=!0)}GetId(){return this._pointerId}GetStartIndex(){return this._startIndex}GetTime(){return this._time}_SetLastTime(e){this._lastTime=e}GetX(){return this._x}GetY(){return this._y}GetSpeed(){const e=Cw.distanceTo(this._x,this._y,this._lastX,this._lastY),t=(this._time-this._lastTime)/1e3;return t>0?e/t:0}GetAngle(){return Cw.angleTo(this._lastX,this._lastY,this._x,this._y)}GetWidth(){return this._width}GetHeight(){return this._height}GetPressure(){return this._pressure}ShouldTriggerHold(e){return!this._hasTriggeredHold&&e-this._startTime>=500&&!this._isTooFarForHold&&Cw.distanceTo(this._startX,this._startY,this._x,this._y)<15&&(this._hasTriggeredHold=!0,!0)}ShouldTriggerTap(e){return this._hasTriggeredHold?"":e-this._startTime<=333&&!this._isTooFarForHold&&Cw.distanceTo(this._startX,this._startY,this._x,this._y)<15?e-Mw<=666&&Cw.distanceTo(Dw,Ew,this._x,this._y)<25?(Dw=-1e3,Ew=-1e3,Mw=-1e4,"double-tap"):(Dw=this._x,Ew=this._y,Mw=e,"single-tap"):""}GetPositionForLayer(e,t,s){if(void 0===t)return e.GetLayerByIndex(0).CanvasCssToLayer_DefaultTransform(this._x,this._y)[s?0:1];{const n=e.GetLayer(t);return n?n.CanvasCssToLayer(this._x,this._y)[s?0:1]:0}}}}{const kw=self.C3;kw.Plugins.NinePatch=class extends kw.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const Lw=self.C3;Lw.Plugins.NinePatch.Type=class extends Lw.SDKTypeBase{constructor(e){super(e),this._textureSet=null,this._drawable=null}Release(){this.ReleaseTextures(),super.Release()}OnCreate(){this.GetImageInfo().LoadAsset(this._runtime)}async LoadTextures(e){const t=this.GetImageInfo();this._drawable=await t.ExtractImageToCanvas()}CreatePatch(e,t,s,n){!this._textureSet&&this._drawable&&(this._textureSet=new self.NinePatchTextureSet(this),this._textureSet.CreateTextures(this._drawable,e,t,s,n))}ReleaseTextures(){this._textureSet&&(this._textureSet.Release(),this._textureSet=null)}GetTextureSet(){return this._textureSet}}}{const Fw=self.C3,Bw=0,Ow=1,Nw=2,Ww=3,Vw=4,jw=5,Uw=6,Hw=8,zw=Fw.New(Fw.Rect),Xw=Fw.New(Fw.Rect),Yw=Fw.New(Fw.Quad);Fw.Plugins.NinePatch.Instance=class extends Fw.SDKWorldInstanceBase{constructor(e,t){super(e),this._leftMargin=16,this._rightMargin=16,this._topMargin=16,this._bottomMargin=16,this._edges=1,this._fill=1,this._isSeamless=!0,this._callback3d=null,t&&(this._leftMargin=t[Bw],this._rightMargin=t[Ow],this._topMargin=t[Nw],this._bottomMargin=t[Ww],this._edges=t[Vw],this._fill=t[jw],this._isSeamless=!!t[Hw],this.GetWorldInfo().SetVisible(!!t[Uw])),this._sdkType.CreatePatch(this._leftMargin,this._rightMargin,this._topMargin,this._bottomMargin)}Release(){super.Release()}_Set3DCallback(e){this._callback3d=e}Draw(e){const t=this.GetWorldInfo(),s=t.GetBoundingQuad();this._Draw(e,s.getTlx(),s.getTly(),t.GetWidth(),t.GetHeight())}_Draw(e,t,s,n,i){let r=this._sdkType.GetTextureSet();if(!r&&(this._sdkType.CreatePatch(this._leftMargin,this._rightMargin,this._topMargin,this._bottomMargin),r=this._sdkType.GetTextureSet(),!r))return;const a=r.GetImageWidth(),o=r.GetImageHeight(),l=Math.min(this._leftMargin,a),c=Math.min(this._rightMargin,a),h=Math.min(this._topMargin,o),_=Math.min(this._bottomMargin,o),u=a-c,d=o-_,p=this._isSeamless?1:0,f=this._edges,m=this._fill;if(l>0&&h>0&&this._DrawPatch(e,r.GetTexture(),0,0,l+p,h+p,t,s,l+p,h+p),c>0&&h>0&&this._DrawPatch(e,r.GetTexture(),u-p,0,c+p,h+p,t+n-c-p,s,c+p,h+p),c>0&&_>0&&this._DrawPatch(e,r.GetTexture(),u-p,d-p,c+p,_+p,t+n-c-p,s+i-_-p,c+p,_+p),l>0&&_>0&&this._DrawPatch(e,r.GetTexture(),0,d-p,l+p,_+p,t,s+i-_-p,l+p,_+p),0===f){const a=2===m?0:p;l>0&&d>h&&this._TilePatch(e,r.GetLeftTexture(),t,s+h,l+a,i-h-_,0,0),c>0&&d>h&&this._TilePatch(e,r.GetRightTexture(),t+n-c-a,s+h,c+a,i-h-_,a,0),h>0&&u>l&&this._TilePatch(e,r.GetTopTexture(),t+l,s,n-l-c,h+a,0,0),_>0&&u>l&&this._TilePatch(e,r.GetBottomTexture(),t+l,s+i-_-a,n-l-c,_+a,0,a)}else 1===f&&(l>0&&d>h&&this._DrawPatch(e,r.GetTexture(),0,h,l,d-h,t,s+h,l,i-h-_),c>0&&d>h&&this._DrawPatch(e,r.GetTexture(),u,h,c,d-h,t+n-c,s+h,c,i-h-_),h>0&&u>l&&this._DrawPatch(e,r.GetTexture(),l,0,u-l,h,t+l,s,n-l-c,h),_>0&&u>l&&this._DrawPatch(e,r.GetTexture(),l,d,u-l,_,t+l,s+i-_,n-l-c,_));d>h&&u>l&&(0===m?this._TilePatch(e,r.GetFillTexture(),t+l,s+h,n-l-c,i-h-_,0,0):1===m&&this._DrawPatch(e,r.GetTexture(),l,h,u-l,d-h,t+l,s+h,n-l-c,i-h-_))}_DrawPatch(e,t,s,n,i,r,a,o,l,c){const h=t.GetWidth(),_=t.GetHeight();if(e.SetTexture(t),zw.set(a,o,a+l,o+c),Xw.set(s/h,n/_,(s+i)/h,(n+r)/_),null===this._callback3d){const t=this.GetWorldInfo(),s=t.GetBoundingQuad(),n=s.getTlx(),i=s.getTly();zw.offset(-n,-i),Yw.setFromRotatedRect(zw,t.GetAngle()),Yw.offset(n,i),e.Quad3(Yw,Xw)}else this._callback3d(zw,Xw)}_TilePatch(e,t,s,n,i,r,a,o){const l=t.GetWidth(),c=t.GetHeight();if(e.SetTexture(t),zw.set(s,n,s+i,n+r),Xw.set(-a/l,-o/c,(i-a)/l,(r-o)/c),null===this._callback3d){const t=this.GetWorldInfo(),s=t.GetBoundingQuad(),n=s.getTlx(),i=s.getTly();zw.offset(-n,-i),Yw.setFromRotatedRect(zw,t.GetAngle()),Yw.offset(n,i),e.Quad3(Yw,Xw)}else this._callback3d(zw,Xw)}GetCurrentImageInfo(){this._objectClass.GetImageInfo()}GetPropertyValueByIndex(e){}SetPropertyValueByIndex(e,t){}}}self.C3.Plugins.NinePatch.Cnds={},self.C3.Plugins.NinePatch.Acts={SetEffect(e){this.GetWorldInfo().SetBlendMode(e),this._runtime.UpdateRender()}},self.C3.Plugins.NinePatch.Exps={};{let qw=function(e){const t=Jw.CreateCanvas(e.width,e.height);return t.getContext("2d").drawImage(e,0,0),t};CloneDrawable=qw;const Jw=self.C3;self.NinePatchTextureSet=class{constructor(e){this._sdkType=e,this._runtime=this._sdkType.GetRuntime(),this._texture=null,this._fillTexture=null,this._leftTexture=null,this._rightTexture=null,this._topTexture=null,this._bottomTexture=null,this._imageWidth=0,this._imageHeight=0,this._renderer=this._runtime.GetRenderer(),this._isLoading=!1,this._wasReleased=!1}Release(){this._renderer.IsContextLost()||(this._renderer.DeleteTexture(this._texture),this._renderer.DeleteTexture(this._fillTexture),this._renderer.DeleteTexture(this._leftTexture),this._renderer.DeleteTexture(this._rightTexture),this._renderer.DeleteTexture(this._topTexture),this._renderer.DeleteTexture(this._bottomTexture)),this._texture=null,this._fillTexture=null,this._leftTexture=null,this._rightTexture=null,this._topTexture=null,this._bottomTexture=null,this._sdkType=null,this._renderer=null,this._wasReleased=!0}WasReleased(){return this._wasReleased}CreateTextures(e,t,s,n,i){this._SliceImage(e,t,s,n,i)}HasCreatedTextures(){return!!this._texture}_SliceImage(e,t,s,n,i){if(this._wasReleased)return;const r=e.width,a=e.height;this._imageWidth=r,this._imageHeight=a,t=Math.min(Math.floor(t),r),s=Math.min(Math.floor(s),r),n=Math.min(Math.floor(n),a);const o=r-s,l=a-(i=Math.min(Math.floor(i),a)),c=this._runtime.GetSampling(),h=this._runtime.GetCanvasManager().GetTextureAnisotropy();this._texture=this._renderer.CreateStaticTexture(qw(e),{sampling:c,anisotropy:h}),o>t&&l>n&&(this._fillTexture=this._renderer.CreateStaticTexture(this._SliceSubImage(qw(e),t,n,o,l),{wrapX:"repeat",wrapY:"repeat",sampling:c,anisotropy:h})),t>0&&l>n&&(this._leftTexture=this._renderer.CreateStaticTexture(this._SliceSubImage(qw(e),0,n,t,l),{wrapY:"repeat",sampling:c,anisotropy:h})),s>0&&l>n&&(this._rightTexture=this._renderer.CreateStaticTexture(this._SliceSubImage(qw(e),o,n,r,l),{wrapY:"repeat",sampling:c,anisotropy:h})),n>0&&o>t&&(this._topTexture=this._renderer.CreateStaticTexture(this._SliceSubImage(qw(e),t,0,o,n),{wrapX:"repeat",sampling:c,anisotropy:h})),i>0&&o>t&&(this._bottomTexture=this._renderer.CreateStaticTexture(this._SliceSubImage(qw(e),t,l,o,a),{wrapX:"repeat",sampling:c,anisotropy:h}))}_SliceSubImage(e,t,s,n,i){const r=n-t,a=i-s,o=Jw.CreateCanvas(r,a);return o.getContext("2d").drawImage(e,t,s,r,a,0,0,r,a),o}GetImageWidth(){return this._imageWidth}GetImageHeight(){return this._imageHeight}GetTexture(){return this._texture}GetFillTexture(){return this._fillTexture}GetLeftTexture(){return this._leftTexture}GetRightTexture(){return this._rightTexture}GetTopTexture(){return this._topTexture}GetBottomTexture(){return this._bottomTexture}}}{const Kw=self.C3;Kw.Plugins.CSV=class extends Kw.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{let $w=function(){return eP.GetSingleGlobalInstance().GetSdkInstance()};GetSdkInstance=$w;const Zw=self.C3,Qw=self.C3X;Zw.Plugins.CSV.Type=class extends Zw.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}GetScriptInterfaceClass(){return self.ICSVObjectType}};let eP=null;const tP=["auto","string","number"];self.ICSVObjectType=class extends self.IObjectType{constructor(e){super(e),eP=e}parseCsv(e,t=",",s="auto"){Qw.RequireString(e),Qw.RequireString(t);const n=tP.indexOf(s);if(-1===n)throw new Error("invalid data type");return $w()._ParseCSV(e,t,n)}generateCsv(e,t=","){return Qw.RequireArray(e),Qw.RequireString(t),$w()._StringifyCSV(e,t)}}}{const sP=self.C3;sP.Plugins.CSV.Instance=class extends sP.SDKInstanceBase{constructor(e,t){super(e),this._generatedCsv=""}Release(){super.Release()}_GetArraySdkInstance(e){if(!e)return null;const t=e.GetFirstPicked(this._inst);return t?t.GetSdkInstance():null}_ParseCSV(e,t,s){return self.csv_parse_sync.parse(e,{delimiter:t,relax_column_count:!0,skip_empty_lines:!0,cast:(e,t)=>{if(0===s){if(t.quoting)return e;const s=e.trim();return s===String(Number(s))?Number(s):e}return 2===s?Number(e.trim()):e}})}_StringifyCSV(e,t){return self.csv_stringify_sync.stringify(e,{delimiter:t,cast:{string:e=>String(Number(e))===e?{value:e,quoted:!0}:{value:e}}})}}}self.C3.Plugins.CSV.Cnds={OnParseError:()=>!0,OnParseSuccess:()=>!0};{const nP=self.C3;nP.Plugins.CSV.Acts={ParseCSV(e,t,s,n){const i=this._GetArraySdkInstance(s);if(i)try{const s=this._ParseCSV(e,t,n),r=s.reduce(((e,t)=>Math.max(e,t.length)),0);i.SetSize(r,s.length,1);for(let e=0,t=s.length;e<t;++e){const t=s[e];for(let s=0,n=t.length;s<n;++s)i.Set(s,e,0,t[s]);for(let s=t.length;s<r;s++)i.Set(s,e,0,1===n?"":0)}this.Trigger(nP.Plugins.CSV.Cnds.OnParseSuccess)}catch(e){console.error("Error parsing CSV: ",e),this.Trigger(nP.Plugins.CSV.Cnds.OnParseError)}},GenerateCSV(e,t){this._generatedCsv="";const s=this._GetArraySdkInstance(e);if(!s)return;const n=s.GetWidth(),i=s.GetHeight();if(0===s.GetDepth())return;const r=[];for(let e=0;e<i;++e){const t=[];for(let i=0;i<n;++i)t.push(s.At(i,e,0));r.push(t)}this._generatedCsv=this._StringifyCSV(r,t)}}}self.C3.Plugins.CSV.Exps={GeneratedCSV(){return this._generatedCsv},TabCharacter:()=>"\t"};{const iP=self.C3;iP.Plugins.Particles=class extends iP.SDKPluginBase{constructor(e){super(e)}Release(){super.Release()}}}{const rP=self.C3;rP.Plugins.Particles.Type=class extends rP.SDKTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){this.GetImageInfo().LoadAsset(this._runtime)}LoadTextures(e){return this.GetImageInfo().LoadStaticTexture(e,{sampling:this._runtime.GetSampling()})}ReleaseTextures(){this.GetImageInfo().ReleaseTexture()}}}{let aP=function(e){return MP.get(e).GetParticleEngine()};GetParticleEngine=aP;const oP=self.C3,lP=self.C3X,cP=0,hP=1,_P=2,uP=3,dP=4,pP=5,fP=6,mP=7,gP=8,IP=9,SP=10,yP=11,bP=12,GP=13,vP=14,xP=15,TP=16,CP=17,wP=18,PP=19,AP=20,RP=0,DP=1,EP=oP.New(oP.Rect);oP.Plugins.Particles.Instance=class extends oP.SDKWorldInstanceBase{constructor(e,t){super(e),this._isFirstTick=!0;const s=oP.New(self.ParticleEngine);this._particleEngine=s,s.ononeshotfinish=()=>this._OnOneShotFinish(),this._spawnObjectClass=null,this._particleUpdateCallback=(e,t,s,n,i,r)=>this._OnParticleUpdate(e,t,s,n,i,r),this._particleDestroyCallback=e=>this._OnParticleDestroy(e),this._hasAnyDefaultParticle=!0;let n=!0;t&&(s.SetRate(t[cP]),s.SetSprayCone(oP.toRadians(t[hP])),s.SetSprayType(t[_P]?"one-shot":"continuous-spray"),this._SetParticleObjectClass(this._runtime.GetObjectClassBySID(t[uP])),n=t[dP],s.SetInitSpeed(t[pP]),s.SetInitSize(t[fP]),s.SetInitOpacity(t[mP]/100),s.SetGrowRate(t[gP]),s.SetInitXRandom(t[IP]),s.SetInitYRandom(t[SP]),s.SetInitSpeedRandom(t[yP]),s.SetInitSizeRandom(t[bP]),s.SetGrowRandom(t[GP]),s.SetAcceleration(t[vP]),s.SetGravity(t[xP]),s.SetLifeAngleRandom(t[TP]),s.SetLifeSpeedRandom(t[CP]),s.SetLifeOpacityRandom(t[wP]),s.SetDestroyModeIndex(t[PP]),s.SetTimeout(t[AP])),this._UpdateEngineParameters(),this._spawnObjectClass&&(this._hasAnyDefaultParticle=!1),"one-shot"===s.GetSprayType()?s.CreateOneShotSpray():s.SetSpraying(!0);const i=this.GetWorldInfo();i.SetVisible(n),i.SetBboxChangeEventEnabled(!0),this._inst.Dispatcher().addEventListener("bboxchange",(()=>{i.OverwriteBoundingBox(this._particleEngine.GetBoundingBox())})),this.GetRuntime().GetRenderer().IsWebGPU()&&i.SetUsePointsShaderProgram(),this._afterLoad=e=>this._OnAfterLoad(e),this.GetRuntime().Dispatcher().addEventListener("afterload",this._afterLoad),this._StartTicking()}Release(){this.GetRuntime().Dispatcher().removeEventListener("afterload",this._afterLoad),this._afterLoad=null,this._particleEngine.Release(),this._particleEngine=null,this._particleUpdateCallback=null,this._particleDestroyCallback=null,super.Release()}GetParticleEngine(){return this._particleEngine}_SetRate(e){this._particleEngine.SetRate(e),"one-shot"===this._particleEngine.GetSprayType()&&this._isFirstTick&&this._particleEngine.SetParticleCount(e)}_SetParticleObjectClass(e){e===this.GetObjectClass()&&(e=null),e!==this._spawnObjectClass&&(this._spawnObjectClass=e,this._particleEngine.onparticlecreate=e?e=>this._OnParticleCreate(e):null,this._spawnObjectClass||(this._hasAnyDefaultParticle=!0))}_UpdateEngineParameters(){const e=this._particleEngine,t=this.GetWorldInfo();e.SetMasterOpacity(t.GetOpacity()),e.SetPixelRounding(this._runtime.IsPixelRoundingEnabled()),e.SetSpawnX(t.GetX()),e.SetSpawnY(t.GetY()),e.SetSpawnAngle(t.GetAngle()),e.SetInitSizeScale(Math.abs(t.GetSceneGraphScale()))}_OnOneShotFinish(){this._runtime.DestroyInstance(this._inst)}Draw(e){if(!this._hasAnyDefaultParticle)return;const t=this._objectClass.GetImageInfo(),s=t.GetTexture();if(!s)return;const n=this.GetWorldInfo(),i=n.GetLayer(),r=EP;this._runtime.GetCanvasManager().IsPastingToDrawingCanvas()?r.set(-1/0,-1/0,1/0,1/0):i.Has3DCamera()?i.CalculateViewport3D(n.GetTotalZElevation(),r):i.GetViewportForZ(n.GetTotalZElevation(),r),e.SetTexture(s);const a=i.Get2DScaleFactorToZ(n.GetTotalZElevation());this._particleEngine.SetParticleScale(i.GetRenderScale()*a),this._particleEngine.Draw(e,t.GetTexQuad(),r,i.Has3DCamera())}SaveToJson(){const e=this._particleEngine;return{r:e.GetRate(),sc:e.GetSprayCone(),st:e.GetSprayType(),isp:e.GetInitSpeed(),isz:e.GetInitSize(),io:e.GetInitOpacity(),gr:e.GetGrowRate(),xr:e.GetInitXRandom(),yr:e.GetInitYRandom(),spr:e.GetInitSpeedRandom(),szr:e.GetInitSizeRandom(),grnd:e.GetGrowRandom(),acc:e.GetAcceleration(),g:e.GetGravity(),lar:e.GetLifeAngleRandom(),lsr:e.GetLifeSpeedRandom(),lor:e.GetLifeOpacityRandom(),dm:e.GetDestroyModeIndex(),to:e.GetTimeout(),s:e.IsSpraying(),pcc:e._GetCreateCounter(),ft:this._isFirstTick,soc:this._spawnObjectClass?this._spawnObjectClass.GetSID():null,p:e.GetParticles().map((e=>e.toJSON()))}}LoadFromJson(e,t){const s=this._particleEngine;if(s.SetRate(e.r),s.SetSprayCone(e.sc),s.SetSprayType(e.st),s.SetInitSpeed(e.isp),s.SetInitSize(e.isz),s.SetInitOpacity(e.io),s.SetGrowRate(e.gr),s.SetInitXRandom(e.xr),s.SetInitYRandom(e.yr),s.SetInitSpeedRandom(e.spr),s.SetInitSizeRandom(e.szr),s.SetGrowRandom(e.grnd),s.SetAcceleration(e.acc),s.SetGravity(e.g),s.SetLifeAngleRandom(e.lar),s.SetLifeSpeedRandom(e.lsr),s.SetLifeOpacityRandom(e.lor),s.SetDestroyModeIndex(e.dm),s.SetTimeout(e.to),s.SetSpraying(e.s),s._SetCreateCounter(e.pcc),this._isFirstTick=e.ft,e.hasOwnProperty("soc")){const t=this.GetRuntime().GetObjectClassBySID(e.soc);t&&this._SetParticleObjectClass(t)}const n=e.p;s.SetParticleCount(n.length,!1);const i=s.GetParticles();for(let e=0,t=i.length;e<t;++e)i[e].setFromJSON(n[e]);"state"===t&&this._spawnObjectClass&&(s.UpdateAllParticlesUserData(),s.ApplyParticleDataToUserData(this))}_OnAfterLoad(){const e=this._particleEngine;e.UpdateAllParticlesUserData(),e.ApplyParticleDataToUserData(this);const t=e.GetParticles();for(let e=0,s=t.length;e<s;++e){const s=t[e],n=s.GetUserData();if(!n)continue;const i=n.GetWorldInfo();if(!i)continue;const r=i.GetInstance();if(!r)continue;const a=s.GetUserDataUID(),o=r.GetUID();if(("number"!=typeof a||"number"!=typeof o||a!==o)&&"number"==typeof a){const e=this.GetRuntime(),t=e.GetInstanceByUID(a);t&&e.DestroyInstance(t)}}}Tick(){const e=this._runtime.GetDt(this._inst);this._UpdateEngineParameters(),this._isFirstTick&&"one-shot"===this._particleEngine.GetSprayType()&&this._particleEngine.ReInitAllParticles(),this._particleEngine.Tick(e),this._particleEngine.IsSpraying()&&this._runtime.UpdateRender(),this.GetWorldInfo().SetBboxChanged(),this._isFirstTick=!1}_FastForward(e){const t=1/60;for(this._isFirstTick&&"one-shot"===this._particleEngine.GetSprayType()&&this._particleEngine.ReInitAllParticles();e>0;)this._particleEngine.Tick(t),e-=t;this._particleEngine.IsSpraying()&&this._runtime.UpdateRender(),this.GetWorldInfo().SetBboxChanged(),this._isFirstTick=!1}_OnParticleCreate(e,t){let s;"number"==typeof t&&(s=this._runtime.GetInstanceByUID(t)),s&&s.GetObjectClass()!==this._spawnObjectClass&&(s=null),s||(s=this._runtime.CreateInstance(this._spawnObjectClass,this.GetWorldInfo().GetLayer(),e.GetX(),e.GetY()));const n=s.GetWorldInfo();return n.SetSize(e.GetSize(),e.GetSize()),n.SetAngle(e.GetAngle()),n.SetOpacity(e.GetOpacity()),n.SetUnpremultipliedColor(this.GetWorldInfo().GetUnpremultipliedColor()),n.SetBboxChanged(),n.ZOrderMoveAdjacentToInstance(this.GetInstance(),!0),s._TriggerOnCreated(),e.SetUpdateCallback(this._particleUpdateCallback),e.SetDestroyCallback(this._particleDestroyCallback),s}_OnParticleUpdate(e,t,s,n,i,r){if(e.IsDestroyed())return;const a=e.GetWorldInfo();a.OffsetXY(t,s),a.SetSize(a.GetWidth()+n,a.GetHeight()+n),a.SetAngle(a.GetAngle()+i),a.SetOpacity(a.GetOpacity()+r),a.SetBboxChanged()}_OnParticleDestroy(e){e.IsDestroyed()||this._runtime.DestroyInstance(e)}GetPropertyValueByIndex(e){const t=this._particleEngine;switch(e){case cP:return t.GetRate();case hP:return oP.toDegrees(t.GetSprayCone());case _P:return"one-shot"===t.GetSprayType()?DP:RP;case pP:return t.GetInitSpeed();case fP:return t.GetInitSize();case mP:return 100*t.GetInitOpacity();case gP:return t.GetGrowRate();case IP:return t.GetInitXRandom();case SP:return t.GetInitYRandom();case yP:return t.GetInitSpeedRandom();case bP:return t.GetInitSizeRandom();case GP:return t.GetGrowRandom();case vP:return t.GetAcceleration();case xP:return t.GetGravity();case TP:return t.GetLifeAngleRandom();case CP:return t.GetLifeSpeedRandom();case wP:return t.GetLifeOpacityRandom();case PP:return t.GetDestroyModeIndex();case AP:return t.GetTimeout()}}SetPropertyValueByIndex(e,t){const s=this._particleEngine;switch(e){case cP:s.SetRate(t);break;case hP:s.SetSprayCone(oP.toRadians(t));break;case _P:s.SetSprayType(t?"one-shot":"continuous-spray");break;case pP:s.SetInitSpeed(t);break;case fP:s.SetInitSize(t);break;case mP:s.SetInitOpacity(t/100);break;case gP:s.SetGrowRate(t);break;case IP:s.SetInitXRandom(t);break;case SP:s.SetInitYRandom(t);break;case yP:s.SetInitSpeedRandom(t);break;case bP:s.SetInitSizeRandom(t);break;case GP:s.SetGrowRandom(t);break;case vP:s.SetAcceleration(t);break;case xP:s.SetGravity(t);break;case TP:s.SetLifeAngleRandom(t);break;case CP:s.SetLifeSpeedRandom(t);break;case wP:s.SetLifeOpacityRandom(t);break;case PP:s.SetDestroyModeIndex(t);break;case AP:s.SetTimeout(t)}}GetDebuggerProperties(){const e="plugins.particles",t=e+".properties",s=e+".debugger",n=this._particleEngine;return[{title:e+".name",properties:[{name:s+".particle-count",value:n.GetParticleCount()},{name:t+".type.name",value:[t+".type.items."+n.GetSprayType()]},{name:s+".is-spraying",value:n.IsSpraying(),onedit:e=>n.SetSpraying(e)},{name:t+".rate.name",value:n.GetRate(),onedit:e=>n.SetRate(e)},{name:t+".spray-cone.name",value:oP.toDegrees(n.GetSprayCone()),onedit:e=>n.SetSprayCone(oP.toRadians(e))},{name:t+".speed.name",value:n.GetInitSpeed(),onedit:e=>n.SetInitSpeed(e)},{name:t+".size.name",value:n.GetInitSize(),onedit:e=>n.SetInitSize(e)},{name:t+".opacity.name",value:n.GetInitOpacity(),onedit:e=>n.SetInitOpacity(e)},{name:t+".grow-rate.name",value:n.GetGrowRate(),onedit:e=>n.SetGrowRate(e)},{name:t+".x-randomiser.name",value:n.GetInitXRandom(),onedit:e=>n.SetInitXRandom(e)},{name:t+".y-randomiser.name",value:n.GetInitYRandom(),onedit:e=>n.SetInitYRandom(e)},{name:t+".initial-speed-randomiser.name",value:n.GetInitSpeedRandom(),onedit:e=>n.SetInitSpeedRandom(e)},{name:t+".size-randomiser.name",value:n.GetInitSizeRandom(),onedit:e=>n.SetInitSizeRandom(e)},{name:t+".grow-rate-randomiser.name",value:n.GetGrowRandom(),onedit:e=>n.SetGrowRandom(e)},{name:t+".acceleration.name",value:n.GetAcceleration(),onedit:e=>n.SetAcceleration(e)},{name:t+".gravity.name",value:n.GetGravity(),onedit:e=>n.SetGravity(e)},{name:t+".angle-randomiser.name",value:n.GetLifeAngleRandom(),onedit:e=>n.SetLifeAngleRandom(e)},{name:t+".life-speed-randomiser.name",value:n.GetLifeSpeedRandom(),onedit:e=>n.SetLifeSpeedRandom(e)},{name:t+".opacity-randomiser.name",value:n.GetLifeOpacityRandom(),onedit:e=>n.SetLifeOpacityRandom(e)},{name:t+".timeout.name",value:n.GetTimeout(),onedit:e=>n.SetTimeout(e)}]}]}GetScriptInterfaceClass(){return self.IParticlesInstance}};const MP=new WeakMap;self.IParticlesInstance=class extends self.IWorldInstance{constructor(){super(),MP.set(this,self.IInstance._GetInitInst().GetSdkInstance())}set isSpraying(e){aP(this).SetSpraying(!!e)}get isSpraying(){return aP(this).IsSpraying()}set rate(e){lP.RequireFiniteNumber(e),MP.get(this)._SetRate(e)}get rate(){return aP(this).GetRate()}set sprayCone(e){lP.RequireFiniteNumber(e),aP(this).SetSprayCone(e)}get sprayCone(){return aP(this).GetSprayCone()}set initSpeed(e){lP.RequireFiniteNumber(e),aP(this).SetInitSpeed(e)}get initSpeed(){return aP(this).GetInitSpeed()}set initSize(e){lP.RequireFiniteNumber(e),aP(this).SetInitSize(e)}get initSize(){return aP(this).GetInitSize()}set initOpacity(e){lP.RequireFiniteNumber(e),aP(this).SetInitOpacity(e)}get initOpacity(){return aP(this).GetInitOpacity()}set initXRandom(e){lP.RequireFiniteNumber(e),aP(this).SetInitXRandom(e)}get initXRandom(){return aP(this).GetInitXRandom()}set initYRandom(e){lP.RequireFiniteNumber(e),aP(this).SetInitYRandom(e)}get initYRandom(){return aP(this).GetInitYRandom()}set initSpeedRandom(e){lP.RequireFiniteNumber(e),aP(this).SetInitSpeedRandom(e)}get initSpeedRandom(){return aP(this).GetInitSpeedRandom()}set initSizeRandom(e){lP.RequireFiniteNumber(e),aP(this).SetInitSizeRandom(e)}get initSizeRandom(){return aP(this).GetInitSizeRandom()}set initGrowRate(e){lP.RequireFiniteNumber(e),aP(this).SetGrowRate(e)}get initGrowRate(){return aP(this).GetGrowRate()}set initGrowRandom(e){lP.RequireFiniteNumber(e),aP(this).SetGrowRandom(e)}get initGrowRandom(){return aP(this).GetGrowRandom()}set acceleration(e){lP.RequireFiniteNumber(e),aP(this).SetAcceleration(e)}get acceleration(){return aP(this).GetAcceleration()}set gravity(e){lP.RequireFiniteNumber(e),aP(this).SetGravity(e)}get gravity(){return aP(this).GetGravity()}set lifeAngleRandom(e){lP.RequireFiniteNumber(e),aP(this).SetLifeAngleRandom(e)}get lifeAngleRandom(){return aP(this).GetLifeAngleRandom()}set lifeSpeedRandom(e){lP.RequireFiniteNumber(e),aP(this).SetLifeSpeedRandom(e)}get lifeSpeedRandom(){return aP(this).GetLifeSpeedRandom()}set lifeOpacityRandom(e){lP.RequireFiniteNumber(e),aP(this).SetLifeOpacityRandom(e)}get lifeOpacityRandom(){return aP(this).GetLifeOpacityRandom()}set timeout(e){lP.RequireFiniteNumber(e),aP(this).SetTimeout(e)}get timeout(){return aP(this).GetTimeout()}fastForward(e){lP.RequireFiniteNumber(e),MP.get(this)._FastForward(e)}setParticleObjectClass(e){const t=MP.get(this);e?t._SetParticleObjectClass(t.GetRuntime()._UnwrapIObjectClass(e)):t._SetParticleObjectClass(null)}}}self.C3.Plugins.Particles.Cnds={IsSpraying(){return this._particleEngine.IsSpraying()}};{const kP=self.C3;kP.Plugins.Particles.Acts={SetSpraying(e){this._particleEngine.SetSpraying(0!==e)},SetRate(e){this._SetRate(e)},SetParticleObject(e){this._SetParticleObjectClass(e)},UnsetParticleObject(){this._SetParticleObjectClass(null)},SetSprayCone(e){this._particleEngine.SetSprayCone(kP.toRadians(e))},SetInitSpeed(e){this._particleEngine.SetInitSpeed(e)},SetInitSize(e){this._particleEngine.SetInitSize(e)},SetInitOpacity(e){this._particleEngine.SetInitOpacity(e/100)},SetGrowRate(e){this._particleEngine.SetGrowRate(e)},SetXRandomiser(e){this._particleEngine.SetInitXRandom(e)},SetYRandomiser(e){this._particleEngine.SetInitYRandom(e)},SetSpeedRandomiser(e){this._particleEngine.SetInitSpeedRandom(e)},SetSizeRandomiser(e){this._particleEngine.SetInitSizeRandom(e)},SetGrowRateRandomiser(e){this._particleEngine.SetGrowRandom(e)},SetParticleAcc(e){this._particleEngine.SetAcceleration(e)},SetGravity(e){this._particleEngine.SetGravity(e)},SetAngleRandomiser(e){this._particleEngine.SetLifeAngleRandom(e)},SetLifeSpeedRandomiser(e){this._particleEngine.SetLifeSpeedRandom(e)},SetOpacityRandomiser(e){this._particleEngine.SetLifeOpacityRandom(e)},SetTimeout(e){this._particleEngine.SetTimeout(e)},FastForward(e){this._FastForward(e)},SetEffect(e){this.GetWorldInfo().SetBlendMode(e),this._runtime.UpdateRender()}}}{const LP=self.C3;LP.Plugins.Particles.Exps={ParticleCount(){return this._particleEngine.GetParticleCount()},Rate(){return this._particleEngine.GetRate()},SprayCone(){return LP.toDegrees(this._particleEngine.GetSprayCone())},InitSpeed(){return this._particleEngine.GetInitSpeed()},InitSize(){return this._particleEngine.GetInitSize()},InitOpacity(){return 100*this._particleEngine.GetInitOpacity()},InitGrowRate(){return this._particleEngine.GetGrowRate()},XRandom(){return this._particleEngine.GetInitXRandom()},YRandom(){return this._particleEngine.GetInitYRandom()},InitSizeRandom(){return this._particleEngine.GetInitSizeRandom()},InitSpeedRandom(){return this._particleEngine.GetInitSpeedRandom()},InitGrowRandom(){return this._particleEngine.GetGrowRandom()},ParticleAcceleration(){return this._particleEngine.GetAcceleration()},Gravity(){return this._particleEngine.GetGravity()},ParticleAngleRandom(){return this._particleEngine.GetLifeAngleRandom()},ParticleSpeedRandom(){return this._particleEngine.GetLifeSpeedRandom()},ParticleOpacityRandom(){return this._particleEngine.GetLifeOpacityRandom()},Timeout(){return this._particleEngine.GetTimeout()}}}{const FP=self.C3,BP=[],OP=1e3,NP=new Set(["continuous-spray","one-shot"]),WP=["fade-to-invisible","timeout-expired","particle-stopped"],VP=FP.New(FP.Rect);self.ParticleEngine=class{constructor(){this._rate=0,this._sprayCone=0,this._sprayType="continuous-spray",this._isSpraying=!1,this._masterOpacity=0,this._isPixelRounding=!1,this._spawnX=0,this._spawnY=0,this._spawnAngle=0,this._initSpeed=0,this._initSize=0,this._initSizeScale=1,this._initOpacity=0,this._growRate=0,this._xRandom=0,this._yRandom=0,this._initSpeedRandom=0,this._initSizeRandom=0,this._growRandom=0,this._acceleration=0,this._gravity=0,this._lifeAngleRandom=0,this._lifeSpeedRandom=0,this._lifeOpacityRandom=0,this._destroyMode=0,this._timeout=0,this._createCounter=0,this._particleScale=1,this.ononeshotfinish=null,this.onparticlecreate=null,this._particles=[],this._boundingBox=new FP.Rect,this._color=new FP.Color,this._devicePixelRatio=globalThis.devicePixelRatio||1}Release(){this.Cancel(),FP.clearArray(this._particles),this._particles=null,this.ononeshotfinish=null,this.onparticlecreate=null,this._boundingBox=null,this._color=null}Cancel(){const e=this._particles;for(let t=0,s=e.length;t<s;++t)e[t].Destroy();FP.appendArray(BP,e),FP.clearArray(e),BP.length>1e3&&FP.truncateArray(BP,1e3),this._isSpraying=!1}CreateOneShotSpray(){for(let e=0,t=this._rate;e<t;++e)this._CreateParticle();this._particles.length&&(this._isSpraying=!0)}_CreateParticle(e=!0){let t=null;return BP.length?(t=BP.pop(),t.SetEngine(this)):t=FP.New(self.Particle,this),this._particles.push(t),e?t.Init(this.onparticlecreate):t.Init(),t}ReInitAllParticles(){const e=this._particles,t=this.onparticlecreate;for(let s=0,n=e.length;s<n;++s)e[s].Init(t)}UpdateAllParticlesUserData(){const e=this._particles,t=this.onparticlecreate;for(let s=0,n=e.length;s<n;++s)e[s].UpdateUserData(t)}ApplyParticleDataToUserData(e){const t=this._particles;for(let s=0,n=t.length;s<n;++s){const n=t[s],i=n.GetUserData();if(i){const t=i.GetWorldInfo();t.SetX(n.GetX()),t.SetY(n.GetY()),t.SetSize(n.GetSize(),n.GetSize()),t.SetOpacity(n.GetOpacity()),t.SetAngle(n.GetAngle()),t.SetUnpremultipliedColor(e.GetWorldInfo().GetUnpremultipliedColor()),t.SetBboxChanged()}}}SetParticleCount(e,t=!0){const s=this._particles;if(e<s.length){const t=s.length-e;for(let e=0;e<t;++e){const e=s.pop();e.Destroy(),BP.push(e)}BP.length>1e3&&FP.truncateArray(BP,1e3)}else if(e>s.length){const n=e-s.length;for(let e=0;e<n;++e)this._CreateParticle(t)}}GetParticles(){return this._particles}GetParticleCount(){return this._particles.length}Tick(e){this._SpawnContinuous(e),this._TickParticles(e),this._MaybeFinishOneShot()}_SpawnContinuous(e){if("continuous-spray"===this._sprayType&&this._isSpraying){this._createCounter+=e*this._rate;const t=Math.floor(this._createCounter);this._createCounter-=t;for(let e=0;e<t;++e)this._CreateParticle()}}_SetCreateCounter(e){this._createCounter=e}_GetCreateCounter(){return this._createCounter}_TickParticles(e){const t=this._boundingBox;t.set(this._spawnX,this._spawnY,this._spawnX,this._spawnY);const s=this._particles;let n=0;for(let i=0,r=s.length;i<r;++i){const r=s[i];s[n]=r,r.Tick(e),r.IsActive()?(++n,t.expandToContain(r.GetBoundingBox())):(r.Destroy(),BP.push(r))}FP.truncateArray(s,n),BP.length>1e3&&FP.truncateArray(BP,1e3)}_MaybeFinishOneShot(){"one-shot"===this._sprayType&&0===this._particles.length&&this._isSpraying&&(this.ononeshotfinish&&this.ononeshotfinish(),this._isSpraying=!1)}Draw(e,t,s,n){this._devicePixelRatio=globalThis.devicePixelRatio||1,VP.set(t.getTlx(),t.getTly(),t.getBrx(),t.getBry()),e.StartRenderingPoints(VP),this._color.copy(e.GetColor());const i=this._particles;for(let r=0,a=i.length;r<a;++r){const a=i[r];s.intersectsRect(a.GetBoundingBox())&&a.Draw(e,t,n)}e.FinishRenderingPoints()}GetColor(){return this._color}SetRate(e){this._rate=+e}GetRate(){return this._rate}SetSprayCone(e){this._sprayCone=+e}GetSprayCone(){return this._sprayCone}SetSprayType(e){if(!NP.has(e))throw new Error("invalid spray type");this._sprayType=e}GetSprayType(){return this._sprayType}SetSpraying(e){this._isSpraying=!!e}IsSpraying(){return this._isSpraying}SetMasterOpacity(e){this._masterOpacity=+e}GetMasterOpacity(){return this._masterOpacity}SetPixelRounding(e){this._isPixelRounding=!!e}IsPixelRounding(){return this._isPixelRounding}SetSpawnX(e){this._spawnX=+e}GetSpawnX(){return this._spawnX}SetSpawnY(e){this._spawnY=+e}GetSpawnY(){return this._spawnY}SetSpawnAngle(e){this._spawnAngle=+e}GetInitAngle(){return this._spawnAngle}SetInitSpeed(e){this._initSpeed=+e}GetInitSpeed(){return this._initSpeed}SetInitSize(e){this._initSize=+e}GetInitSize(){return this._initSize}SetInitSizeScale(e){this._initSizeScale=+e}GetInitSizeScale(){return this._initSizeScale}SetInitOpacity(e){this._initOpacity=+e}GetInitOpacity(){return this._initOpacity}SetGrowRate(e){this._growRate=+e}GetGrowRate(){return this._growRate}SetInitXRandom(e){this._xRandom=+e}GetInitXRandom(){return this._xRandom}SetInitYRandom(e){this._yRandom=+e}GetInitYRandom(){return this._yRandom}SetInitSpeedRandom(e){this._initSpeedRandom=+e}GetInitSpeedRandom(){return this._initSpeedRandom}SetInitSizeRandom(e){this._initSizeRandom=+e}GetInitSizeRandom(){return this._initSizeRandom}SetGrowRandom(e){this._growRandom=+e}GetGrowRandom(){return this._growRandom}SetAcceleration(e){this._acceleration=+e}GetAcceleration(){return this._acceleration}SetGravity(e){this._gravity=+e}GetGravity(){return this._gravity}SetLifeAngleRandom(e){this._lifeAngleRandom=+e}GetLifeAngleRandom(){return this._lifeAngleRandom}SetLifeSpeedRandom(e){this._lifeSpeedRandom=+e}GetLifeSpeedRandom(){return this._lifeSpeedRandom}SetLifeOpacityRandom(e){this._lifeOpacityRandom=+e}GetLifeOpacityRandom(){return this._lifeOpacityRandom}SetDestroyMode(e){let t=WP.indexOf(e);if(-1===t)throw new Error("invalid destroy mode");this._destroyMode=t}SetDestroyModeIndex(e){this.SetDestroyMode(WP[e])}GetDestroyMode(){return WP[this._destroyMode]}GetDestroyModeIndex(){return this._destroyMode}SetTimeout(e){this._timeout=+e}GetTimeout(){return this._timeout}SetParticleScale(e){this._particleScale=+e}GetParticleScale(){return this._particleScale}GetBoundingBox(){return this._boundingBox}GetDevicePixelRatio(){return this._devicePixelRatio}}}{let jP=function(e){return Math.random()*e-e/2};randomOffset=jP;const UP=self.C3,HP=self.ParticleEngine,zP=new UP.Quad,XP=new UP.Color;let YP=!1;self.Particle=class{constructor(e){this._engine=e,this._isActive=!1,this._x=0,this._y=0,this._speed=0,this._angle=0,this._opacity=1,this._lastOpacity=0,this._grow=0,this._size=0,this._halfSize=0,this._gs=0,this._age=0,this._bbox=new UP.Rect,this._userData=null,this._userDataUid=NaN,this._updateCallback=null,this._destroyCallback=null}SetEngine(e){this._engine=e}Init(e){const t=this._engine;this._isActive=!0,this._x=t.GetSpawnX()+jP(t.GetInitXRandom()),this._y=t.GetSpawnY()+jP(t.GetInitYRandom()),this._speed=t.GetInitSpeed()+jP(t.GetInitSpeedRandom()),this._angle=t.GetInitAngle()+jP(t.GetSprayCone()),this._opacity=t.GetInitOpacity(),this._lastOpacity=this._opacity,this._size=(t.GetInitSize()+jP(t.GetInitSizeRandom()))*t.GetInitSizeScale(),this._halfSize=this._size/2,this._grow=t.GetGrowRate()+jP(t.GetGrowRandom()),this._gs=0,this._age=0,this._UpdateBoundingBox(),e?this._userData||(this._userData=e(this)):(this._userData=null,this._updateCallback=null,this._destroyCallback=null)}UpdateUserData(e){e?this._userData&&!this._userData.IsDestroyed()||(this._userData=e(this,this._userDataUid)):(this._userData=null,this._updateCallback=null,this._destroyCallback=null)}SetUpdateCallback(e){this._updateCallback=e}SetDestroyCallback(e){this._destroyCallback=e}Destroy(){const e=this._destroyCallback;e&&e(this._userData),this._userData=null,this._updateCallback=null,this._destroyCallback=null}toJSON(){let e;return this._userData&&this._userData.GetWorldInfo()&&(e=this._userData.GetWorldInfo().GetInstance().GetUID()),[this._x,this._y,this._speed,this._angle,this._opacity,this._grow,this._size,this._gs,this._age,e]}setFromJSON(e){this._x=e[0],this._y=e[1],this._speed=e[2],this._angle=e[3],this._opacity=e[4],this._lastOpacity=this._opacity,this._grow=e[5],this._size=e[6],this._gs=e[7],this._age=e[8],this._userDataUid=e[9],this._halfSize=this._size/2,this._UpdateBoundingBox()}Tick(e){const t=this._engine,s=this._speed*e,n=this._angle,i=Math.cos(n)*s,r=Math.sin(n)*s+this._gs*e;this._x+=i,this._y+=r;const a=this._grow*e;this._size+=a,this._halfSize=this._size/2,this._speed+=t.GetAcceleration()*e,this._gs+=t.GetGravity()*e,this._age+=e,this._UpdateBoundingBox();const o=t.GetLifeAngleRandom(),l=t.GetLifeSpeedRandom(),c=t.GetLifeOpacityRandom();let h=0;0!==o&&(h=jP(o*e),this._angle+=h),0!==l&&(this._speed+=jP(l*e)),0!==c&&(this._opacity=UP.clamp(this._opacity+jP(c*e),0,1));const _=this._size>=1&&(2===t.GetDestroyModeIndex()?this._speed>0:this._age<t.GetTimeout()),u=this._updateCallback;if(u&&_){let e=t.GetMasterOpacity()*this._opacity;0===t.GetDestroyModeIndex()&&(e*=1-this._age/t.GetTimeout());const s=e-this._lastOpacity;this._lastOpacity=e,u(this._userData,i,r,a,h,s)}this._isActive=_}IsActive(){return this._isActive}GetBoundingBox(){return this._bbox}_UpdateBoundingBox(){const e=this._x,t=this._y,s=this._halfSize;this._bbox.set(e-s,t-s,e+s,t+s)}Draw(e,t,s){if(this._userData)return;const n=this._engine;let i=n.GetMasterOpacity()*this._opacity;if(0===n.GetDestroyModeIndex()&&(i*=1-this._age/n.GetTimeout()),i<=0)return;const r=this._size,a=r*n.GetParticleScale()*n.GetDevicePixelRatio();if(a<1)return;let o=this._x,l=this._y;n.IsPixelRounding()&&(o=o+.5|0,l=l+.5|0),e.IsWebGPU()?e.Point(o,l,r,i):s||a>e.GetMaxPointSize()||a<e.GetMinPointSize()?(XP.copy(n.GetColor()),XP.multiplyAlpha(i),e.SetColor(XP),YP=!0,zP.setFromRect(this._bbox),e.Quad4(zP,t)):(YP&&(e.SetColor(n.GetColor()),YP=!1),e.Point(o,l,a,i))}GetUserData(){return this._userData}GetUserDataUID(){return this._userDataUid}GetX(){return this._x}GetY(){return this._y}GetSize(){return this._size}GetAngle(){return this._angle}GetOpacity(){return this._opacity}}}{const qP=self.C3;qP.Behaviors.MoveTo=class extends qP.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const JP=self.C3;JP.Behaviors.MoveTo.Type=class extends JP.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const KP=self.C3,$P=self.C3X,ZP=self.IBehaviorInstance,QP=0,eA=1,tA=2,sA=3,nA=4,iA=5,rA=6;KP.Behaviors.MoveTo.Instance=class extends KP.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._maxSpeed=200,this._acc=600,this._dec=600,this._rotateSpeed=0,this._setAngle=!0,this._stopOnSolids=!1,this._isEnabled=!0,this._speed=0,this._movingAngle=this.GetWorldInfo().GetAngle(),this._waypoints=[],t&&(this._maxSpeed=t[QP],this._acc=t[eA],this._dec=t[tA],this._rotateSpeed=KP.toRadians(t[sA]),this._setAngle=t[nA],this._stopOnSolids=t[iA],this._isEnabled=t[rA]),this._timelineInfo=null,this._lastTargetX=NaN,this._lastTargetY=NaN,this._lastTargetAngle=NaN,this._tRange=[0,0],this._timelineInfoProjectionRange={tRange:this._tRange}}Release(){this._timelineInfo&&(this._timelineInfo.Release(),this._timelineInfo=null),this._lastTargetX=NaN,this._lastTargetY=NaN,this._lastTargetAngle=NaN,this._tRange=null,this._timelineInfoProjectionRange=null,super.Release()}SaveToJson(){return{ms:this._maxSpeed,acc:this._acc,dec:this._dec,rs:this._rotateSpeed,sa:this._setAngle,sos:this._stopOnSolids,s:this._speed,ma:this._movingAngle,wp:this._waypoints.map((e=>({x:e.x,y:e.y}))),e:this._isEnabled}}LoadFromJson(e){this._maxSpeed=e.ms,this._acc=e.acc,this._dec=e.dec,this._rotateSpeed=e.rs,this._setAngle=e.sa,this._stopOnSolids=e.sos,this._speed=e.s,this._movingAngle=e.ma,this._waypoints=e.wp.map((e=>({x:e.x,y:e.y}))),this._SetEnabled(e.e),this._isEnabled&&this._waypoints.length>0&&this._StartTicking()}_AddWaypoint(e,t,s,n){s&&KP.clearArray(this._waypoints),this._waypoints.push({x:e,y:t,opts:n}),this._isEnabled&&this._StartTicking()}_GetWaypointCount(){return this._waypoints.length}_GetWaypointXAt(e){return(e=Math.floor(e))<0||e>=this._waypoints.length?0:this._waypoints[e].x}_GetWaypointYAt(e){return(e=Math.floor(e))<0||e>=this._waypoints.length?0:this._waypoints[e].y}_IsMoving(){return this._waypoints.length>0}_Stop(){KP.clearArray(this._waypoints),this._speed=0,this._StopTicking()}_GetTargetX(){return this._waypoints.length>0?this._waypoints[0].x:0}_GetTargetY(){return this._waypoints.length>0?this._waypoints[0].y:0}_GetTargetIsBezier(){if(this._waypoints.length>0){const e=this._waypoints[0];if(e.opts)return e.opts.isBezier}return!1}_GetTargetIsBezierFirst(){if(this._waypoints.length>0){const e=this._waypoints[0];if(e.opts)return e.opts.isBezier&&e.opts.isFirst}return!1}_GetTargetBezierAngle(){if(this._waypoints.length>0){const e=this._waypoints[0];if(e.opts)return e.opts.bezierAngle}return NaN}_SetSpeed(e){this._IsMoving()&&(this._speed=Math.min(e,this._maxSpeed))}_GetSpeed(){return this._speed}_SetMaxSpeed(e){this._maxSpeed=Math.max(e,0),this._SetSpeed(this._speed)}_GetMaxSpeed(){return this._maxSpeed}_IsRotationEnabled(){return 0!==this._rotateSpeed}Tick(){if(!this._isEnabled||!this._IsMoving())return;const e=this._runtime.GetDt(this._inst),t=this._inst.GetWorldInfo(),s=t.GetX(),n=t.GetY(),i=t.GetAngle();let r=this._speed,a=this._maxSpeed;const o=this._acc,l=this._dec,c=this._GetTargetX(),h=this._GetTargetY(),_=KP.angleTo(s,n,c,h);let u=!1;if(l>0&&1===this._waypoints.length){const e=.5*r*r/l*1.0001;if(u=KP.distanceSquared(s,n,c,h)<=e*e,u){const e=KP.distanceTo(s,n,c,h);r=Math.sqrt(2*l*e),a=r,this._speed=r}}if(this._IsRotationEnabled()){const e=KP.angleDiff(this._movingAngle,_);if(e>Number.EPSILON){const s=e/this._rotateSpeed,n=KP.distanceTo(t.GetX(),t.GetY(),c,h)/(2*Math.sin(e))*e;a=Math.min(a,KP.clamp(n/s,0,this._maxSpeed))}}let d=u?-l:o;const p=Math.min(r*e+.5*d*e*e,a*e);if(u){if(l>0&&(this._speed=Math.max(this._speed-l*e,0),0===this._speed))return void this._OnArrived(t,c,h)}else this._speed=0===o?a:Math.min(this._speed+o*e,a);if(KP.distanceSquared(t.GetX(),t.GetY(),c,h)<=p*p)this._OnArrived(t,c,h);else{if(this._IsRotationEnabled()?this._movingAngle=KP.angleRotate(this._movingAngle,_,this._rotateSpeed*e):this._movingAngle=_,t.OffsetXY(Math.cos(this._movingAngle)*p,Math.sin(this._movingAngle)*p),this._setAngle){const e=this._GetTargetIsBezier(),s=this._GetTargetIsBezierFirst();if(e&&!s){const e=KP.distanceTo(this._lastTargetX,this._lastTargetY,t.GetX(),t.GetY())/KP.distanceTo(this._lastTargetX,this._lastTargetY,c,h);t.SetAngle(KP.angleLerp(this._lastTargetAngle,this._GetTargetBezierAngle(),e))}else t.SetAngle(this._movingAngle),this._lastTargetX=NaN,this._lastTargetY=NaN,this._lastTargetAngle=NaN}t.SetBboxChanged(),this._CheckSolidCollision(s,n,i)}}_OnArrived(e,t,s){e.SetXY(t,s);const n=this._waypoints[0];n.opts&&n.opts.isBezier?(this._lastTargetX=n.x,this._lastTargetY=n.y,this._lastTargetAngle=n.opts.bezierAngle,this._setAngle&&e.SetAngle(this._lastTargetAngle)):(this._lastTargetX=NaN,this._lastTargetY=NaN,this._lastTargetAngle=NaN),e.SetBboxChanged(),this._waypoints.shift(),0===this._waypoints.length&&(this._timelineInfo&&(this._timelineInfo.Release(),this._timelineInfo=null,this._lastTargetX=NaN,this._lastTargetY=NaN,this._lastTargetAngle=NaN),this._speed=0,this._StopTicking()),this.DispatchScriptEvent("arrived"),this.Trigger(KP.Behaviors.MoveTo.Cnds.OnArrived)}_CheckSolidCollision(e,t,s){const n=this._runtime.GetCollisionEngine();if(this._stopOnSolids&&n.TestOverlapSolid(this._inst)){this._Stop();const i=this._inst.GetWorldInfo(),r=i.GetX(),a=i.GetY(),o=KP.angleTo(r,a,e,t),l=KP.distanceTo(r,a,e,t);n.PushOutSolid(this._inst,Math.cos(o),Math.sin(o),Math.max(l,1))||(i.SetXY(e,t),i.SetAngle(s),i.SetBboxChanged()),this.DispatchScriptEvent("hitsolid"),this.Trigger(KP.Behaviors.MoveTo.Cnds.OnHitSolid)}}_IsSetAngle(){return this._setAngle}_SetSetAngle(e){this._setAngle=!!e}_SetAngleOfMotion(e){if(this._movingAngle=e,this._isEnabled&&this._setAngle&&!this._IsMoving()){const e=this.GetWorldInfo();e.SetAngle(this._movingAngle),e.SetBboxChanged()}}_GetAngleOfMotion(){return this._movingAngle}_SetAcceleration(e){this._acc=Math.max(e,0)}_GetAcceleration(){return this._acc}_SetDeceleration(e){this._dec=Math.max(e,0)}_GetDeceleration(){return this._dec}_SetRotateSpeed(e){this._rotateSpeed=Math.max(e,0)}_GetRotateSpeed(){return this._rotateSpeed}_SetStopOnSolids(e){this._stopOnSolids=!!e}_IsStopOnSolids(){return this._stopOnSolids}_SetEnabled(e){e=!!e,this._isEnabled!==e&&(this._isEnabled=e,this._isEnabled&&this._IsMoving()?this._StartTicking():this._StopTicking())}_IsEnabled(){return this._isEnabled}GetPropertyValueByIndex(e){switch(e){case QP:return this._GetMaxSpeed();case eA:return this._GetAcceleration();case tA:return this._GetDeceleration();case sA:return KP.toDegrees(this._GetRotateSpeed());case nA:return this._IsSetAngle();case iA:return this._IsStopOnSolids();case rA:return this._IsEnabled()}}SetPropertyValueByIndex(e,t){switch(e){case QP:this._SetMaxSpeed(t);break;case eA:this._SetAcceleration(t);break;case tA:this._SetDeceleration(t);break;case sA:this._SetRotateSpeed(KP.toRadians(t));break;case nA:this._SetSetAngle(t);break;case iA:this._SetStopOnSolids(t);break;case rA:this._SetEnabled(t)}}GetDebuggerProperties(){const e="behaviors.moveto";return[{title:"$"+this.GetBehaviorType().GetName(),properties:[{name:e+".debugger.speed",value:this._GetSpeed(),onedit:e=>this._SetSpeed(e)},{name:e+".debugger.angle-of-motion",value:KP.toDegrees(this._GetAngleOfMotion()),onedit:e=>this._movingAngle=KP.toRadians(e)},{name:e+".debugger.target-x",value:this._GetTargetX()},{name:e+".debugger.target-y",value:this._GetTargetY()},{name:e+".debugger.waypoint-count",value:this._GetWaypointCount()},{name:e+".properties.max-speed.name",value:this._GetMaxSpeed(),onedit:e=>this._SetMaxSpeed(e)},{name:e+".properties.acceleration.name",value:this._GetAcceleration(),onedit:e=>this._SetAcceleration(e)},{name:e+".properties.deceleration.name",value:this._GetDeceleration(),onedit:e=>this._SetDeceleration(e)},{name:e+".properties.rotate-speed.name",value:KP.toDegrees(this._GetRotateSpeed()),onedit:e=>this._SetRotateSpeed(KP.toRadians(e))},{name:e+".properties.enabled.name",value:this._IsEnabled(),onedit:e=>this._SetEnabled(e)}]}]}GetScriptInterfaceClass(){return self.IMoveToBehaviorInstance}};const aA=new WeakMap;self.IMoveToBehaviorInstance=class extends ZP{constructor(){super(),aA.set(this,ZP._GetInitInst().GetSdkInstance())}moveToPosition(e,t,s=!0){$P.RequireFiniteNumber(e),$P.RequireFiniteNumber(t),aA.get(this)._AddWaypoint(e,t,!!s)}getTargetX(){return aA.get(this)._GetTargetX()}getTargetY(){return aA.get(this)._GetTargetY()}getTargetPosition(){const e=aA.get(this);return[e._GetTargetX(),e._GetTargetY()]}getWaypointCount(){return aA.get(this)._GetWaypointCount()}getWaypointX(e){return $P.RequireFiniteNumber(e),aA.get(this)._GetWaypointXAt(e)}getWaypointY(e){return $P.RequireFiniteNumber(e),aA.get(this)._GetWaypointYAt(e)}getWaypoint(e){$P.RequireFiniteNumber(e);const t=aA.get(this);return[t._GetWaypointXAt(e),t._GetWaypointYAt(e)]}stop(){aA.get(this)._Stop()}get isMoving(){return aA.get(this)._IsMoving()}get speed(){return aA.get(this)._GetSpeed()}set speed(e){$P.RequireFiniteNumber(e),aA.get(this)._SetSpeed(e)}get maxSpeed(){return aA.get(this)._GetMaxSpeed()}set maxSpeed(e){$P.RequireFiniteNumber(e),aA.get(this)._SetMaxSpeed(e)}get acceleration(){return aA.get(this)._GetAcceleration()}set acceleration(e){$P.RequireFiniteNumber(e),aA.get(this)._SetAcceleration(e)}get deceleration(){return aA.get(this)._GetDeceleration()}set deceleration(e){$P.RequireFiniteNumber(e),aA.get(this)._SetDeceleration(e)}get angleOfMotion(){return aA.get(this)._GetAngleOfMotion()}set angleOfMotion(e){$P.RequireFiniteNumber(e),aA.get(this)._SetAngleOfMotion(e)}get rotateSpeed(){return aA.get(this)._GetRotateSpeed()}set rotateSpeed(e){$P.RequireFiniteNumber(e),aA.get(this)._SetRotateSpeed(e)}get isStopOnSolids(){return aA.get(this)._IsStopOnSolids()}set isStopOnSolids(e){aA.get(this)._SetStopOnSolids(e)}get isEnabled(){return aA.get(this)._IsEnabled()}set isEnabled(e){aA.get(this)._SetEnabled(e)}}}{const oA=self.C3;oA.Behaviors.MoveTo.Cnds={IsMoving(){return this._IsMoving()},CompareSpeed(e,t){return oA.compare(this._GetSpeed(),e,t)},IsEnabled(){return this._IsEnabled()},OnArrived:()=>!0,OnHitSolid:()=>!0}}{const lA=self.C3,cA=25;lA.Behaviors.MoveTo.Acts={MoveToPosition(e,t,s){this._AddWaypoint(e,t,0===s)},MoveToObject(e,t,s){if(!e)return;const n=e.GetPairedInstance(this._inst);if(!n||!n.GetWorldInfo())return;const[i,r]=n.GetImagePoint(t);this._AddWaypoint(i,r,0===s)},MoveAlongPathfindingPath(e){const t=this._inst.GetBehaviorSdkInstanceFromCtor(lA.Behaviors.Pathfinding);if(!t)return;const s=t._GetPath();if(0!==s.length)for(let t=0,n=s.length;t<n;++t){const n=s[t];this._AddWaypoint(n.x,n.y,0===t&&0===e)}},MoveAlongTimeline(e,t,s){const n=lA.New(lA.TimelineInfo,e,t);if(!n.WasInitialized())return void n.Release();n.SetOrigin(this._inst.GetWorldInfo());let i=!0;for(const e of n.segments())switch(e.GetType()){case"line":{const t=e.GetX(),n=e.GetY();this._AddWaypoint(t,n,i&&0===s),i=!1;break}case"cubic-bezier":for(let t=0;t<=e.GetStepCount();t++){const n=t*e.GetStepIncrement(),r=e.Map(n),a=r[0],o=r[1],l=this._GetWaypointXAt(this._GetWaypointCount()-1),c=this._GetWaypointYAt(this._GetWaypointCount()-1);!i&&lA.IsFiniteNumber(l)&&lA.IsFiniteNumber(c)&&lA.distanceSquared(l,c,a,o)<cA||(this._AddWaypoint(a,o,i&&0===s,{isBezier:!0,isFirst:i,bezierAngle:Math.atan2(o-c,a-l)}),i=!1)}}this._timelineInfo=n},MoveAlongTimelineByName(e,t,s){const n=this._runtime.GetTimelineManager().GetTimelineByName(e);n&&lA.Behaviors.MoveTo.Acts.MoveAlongTimeline.call(this,n,t,s)},Stop(){this._Stop()},SetMovingAngle(e){this._SetAngleOfMotion(lA.toRadians(e))},SetSpeed(e){this._SetSpeed(e)},SetMaxSpeed(e){this._SetMaxSpeed(e)},SetAcceleration(e){this._SetAcceleration(e)},SetDeceleration(e){this._SetDeceleration(e)},SetRotateSpeed(e){this._SetRotateSpeed(lA.toRadians(e))},SetStopOnSolids(e){this._SetStopOnSolids(e)},SetEnabled(e){this._SetEnabled(e)}}}{const hA=self.C3;hA.Behaviors.MoveTo.Exps={Speed(){return this._GetSpeed()},MaxSpeed(){return this._GetMaxSpeed()},Acceleration(){return this._GetAcceleration()},Deceleration(){return this._GetDeceleration()},MovingAngle(){return hA.toDegrees(this._GetAngleOfMotion())},RotateSpeed(){return hA.toDegrees(this._GetRotateSpeed())},TargetX(){return this._GetTargetX()},TargetY(){return this._GetTargetY()},WaypointCount(){return this._GetWaypointCount()},WaypointXAt(e){return this._GetWaypointXAt(e)},WaypointYAt(e){return this._GetWaypointYAt(e)}}}{const _A=self.C3;_A.Behaviors.Pin=class extends _A.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const uA=self.C3;uA.Behaviors.Pin.Type=class extends uA.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const dA=self.C3;dA.Behaviors.Pin.Instance=class extends dA.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._pinInst=null,this._pinUid=-1,this._mode="",this._propSet=new Set,this._pinDist=0,this._pinAngle=0,this._pinImagePoint=0,this._dx=0,this._dy=0,this._dWidth=0,this._dHeight=0,this._dAngle=0,this._dz=0,this._lastKnownAngle=0,this._destroy=!1,t&&(this._destroy=t[0]);const s=this._runtime.Dispatcher();this._disposables=new dA.CompositeDisposable(dA.Disposable.From(s,"instancedestroy",(e=>this._OnInstanceDestroyed(e.instance))),dA.Disposable.From(s,"afterload",(e=>this._OnAfterLoad())))}Release(){this._pinInst=null,super.Release()}_SetPinInst(e){e?(this._pinInst=e,this._StartTicking2()):(this._pinInst=null,this._StopTicking2())}_Pin(e,t,s){if(!e)return;const n=e.GetFirstPicked(this._inst);if(!n)return;this._mode=t,this._SetPinInst(n);const i=this._inst.GetWorldInfo(),r=n.GetWorldInfo();if("properties"===this._mode){const e=this._propSet;e.clear();for(const t of s)e.add(t);this._dx=i.GetX()-r.GetX(),this._dy=i.GetY()-r.GetY(),this._dAngle=i.GetAngle()-r.GetAngle(),this._lastKnownAngle=i.GetAngle(),this._dz=i.GetZElevation()-r.GetZElevation(),e.has("x")&&e.has("y")&&(this._pinAngle=dA.angleTo(r.GetX(),r.GetY(),i.GetX(),i.GetY())-r.GetAngle(),this._pinDist=dA.distanceTo(r.GetX(),r.GetY(),i.GetX(),i.GetY())),e.has("width-abs")?this._dWidth=i.GetWidth()-r.GetWidth():e.has("width-scale")&&(this._dWidth=i.GetWidth()/r.GetWidth()),e.has("height-abs")?this._dHeight=i.GetHeight()-r.GetHeight():e.has("height-scale")&&(this._dHeight=i.GetHeight()/r.GetHeight())}else this._pinDist=dA.distanceTo(r.GetX(),r.GetY(),i.GetX(),i.GetY())}SaveToJson(){const e=this._propSet,t=this._mode,s={uid:this._pinInst&&!this._pinInst.IsDestroyed()?this._pinInst.GetUID():-1,m:t,d:this._destroy};return"rope"===t||"bar"===t?s.pd=this._pinDist:"properties"===t&&(s.ps=[...this._propSet],e.has("imagepoint")?s.ip=this._pinImagePoint:e.has("x")&&e.has("y")?(s.pa=this._pinAngle,s.pd=this._pinDist):(e.has("x")&&(s.dx=this._dx),e.has("y")&&(s.dy=this._dy)),e.has("angle")&&(s.da=this._dAngle,s.lka=this._lastKnownAngle),(e.has("width-abs")||e.has("width-scale"))&&(s.dw=this._dWidth),(e.has("height-abs")||e.has("height-scale"))&&(s.dh=this._dHeight),e.has("z")&&(s.dz=this._dz)),s}LoadFromJson(e){const t=e.m,s=this._propSet;if(s.clear(),this._pinUid=e.uid,"number"!=typeof t){if(this._mode=t,e.hasOwnProperty("d")&&(this._destroy=!!e.d),"rope"===t||"bar"===t)this._pinDist=e.pd;else if("properties"===t){for(const t of e.ps)s.add(t);s.has("imagepoint")?this._pinImagePoint=e.ip:s.has("x")&&s.has("y")?(this._pinAngle=e.pa,this._pinDist=e.pd):(s.has("x")&&(this._dx=e.dx),s.has("y")&&(this._dy=e.dy)),s.has("angle")&&(this._dAngle=e.da,this._lastKnownAngle=e.lka||0),(s.has("width-abs")||s.has("width-scale"))&&(this._dWidth=e.dw),(s.has("height-abs")||s.has("height-scale"))&&(this._dHeight=e.dh),s.has("z")&&(this._dz=e.dz)}}else this._LoadFromJson_Legacy(e)}_LoadFromJson_Legacy(e){const t=this._propSet,s=e.msa,n=e.tsa,i=e.pa,r=e.pd;switch(e.m){case 0:this._mode="properties",t.add("x").add("y").add("angle"),this._pinAngle=i,this._pinDist=r,this._dAngle=s-n,this._lastKnownAngle=e.lka;break;case 1:this._mode="properties",t.add("x").add("y"),this._pinAngle=i,this._pinDist=r;break;case 2:this._mode="properties",t.add("angle"),this._dAngle=s-n,this._lastKnownAngle=e.lka;break;case 3:this._mode="rope",this._pinDist=e.pd;break;case 4:this._mode="bar",this._pinDist=e.pd}}_OnAfterLoad(){-1===this._pinUid?this._SetPinInst(null):(this._SetPinInst(this._runtime.GetInstanceByUID(this._pinUid)),this._pinUid=-1)}_OnInstanceDestroyed(e){this._pinInst===e&&(this._SetPinInst(null),this._destroy&&this._runtime.DestroyInstance(this._inst))}Tick2(){const e=this._pinInst;if(!e||e.IsDestroyed())return;const t=e.GetWorldInfo(),s=this._inst.GetWorldInfo(),n=this._mode;let i=!1;if("rope"===n||"bar"===n){const e=dA.distanceTo(s.GetX(),s.GetY(),t.GetX(),t.GetY());if(e>this._pinDist||"bar"===n&&e<this._pinDist){const e=dA.angleTo(t.GetX(),t.GetY(),s.GetX(),s.GetY());s.SetXY(t.GetX()+Math.cos(e)*this._pinDist,t.GetY()+Math.sin(e)*this._pinDist),i=!0}}else{const n=this._propSet;let r=0;if(n.has("imagepoint")){const[t,n]=e.GetImagePoint(this._pinImagePoint);s.EqualsXY(t,n)||(s.SetXY(t,n),i=!0)}else if(n.has("x")&&n.has("y")){const e=t.GetX()+Math.cos(t.GetAngle()+this._pinAngle)*this._pinDist,n=t.GetY()+Math.sin(t.GetAngle()+this._pinAngle)*this._pinDist;s.EqualsXY(e,n)||(s.SetXY(e,n),i=!0)}else r=t.GetX()+this._dx,n.has("x")&&r!==s.GetX()&&(s.SetX(r),i=!0),r=t.GetY()+this._dy,n.has("y")&&r!==s.GetY()&&(s.SetY(r),i=!0);n.has("angle")&&(this._lastKnownAngle!==s.GetAngle()&&(this._dAngle=dA.clampAngle(this._dAngle+(s.GetAngle()-this._lastKnownAngle))),r=dA.clampAngle(t.GetAngle()+this._dAngle),r!==s.GetAngle()&&(s.SetAngle(r),i=!0),this._lastKnownAngle=s.GetAngle()),n.has("width-abs")&&(r=t.GetWidth()+this._dWidth,r!==s.GetWidth()&&(s.SetWidth(r),i=!0)),n.has("width-scale")&&(r=t.GetWidth()*this._dWidth,r!==s.GetWidth()&&(s.SetWidth(r),i=!0)),n.has("height-abs")&&(r=t.GetHeight()+this._dHeight,r!==s.GetHeight()&&(s.SetHeight(r),i=!0)),n.has("height-scale")&&(r=t.GetHeight()*this._dHeight,r!==s.GetHeight()&&(s.SetHeight(r),i=!0)),n.has("z")&&(r=t.GetZElevation()+this._dz,r!==s.GetZElevation()&&(s.SetZElevation(r),this._runtime.UpdateRender()))}i&&s.SetBboxChanged()}GetDebuggerProperties(){const e="behaviors.pin.debugger";return[{title:"$"+this.GetBehaviorType().GetName(),properties:[{name:e+".is-pinned",value:!!this._pinInst},{name:e+".pinned-uid",value:this._pinInst?this._pinInst.GetUID():0}]}]}}}self.C3.Behaviors.Pin.Cnds={IsPinned(){return!!this._pinInst},WillDestroy(){return this._destroy}},self.C3.Behaviors.Pin.Acts={PinByDistance(e,t){this._Pin(e,0===t?"rope":"bar")},PinByProperties(e,t,s,n,i,r,a){const o=[];t&&o.push("x"),s&&o.push("y"),n&&o.push("angle"),a&&o.push("z"),1===i?o.push("width-abs"):2===i&&o.push("width-scale"),1===r?o.push("height-abs"):2===r&&o.push("height-scale"),0!==o.length&&this._Pin(e,"properties",o)},PinByImagePoint(e,t,s,n,i,r){const a=["imagepoint"];s&&a.push("angle"),r&&a.push("z"),1===n?a.push("width-abs"):2===n&&a.push("width-scale"),1===i?a.push("height-abs"):2===i&&a.push("height-scale"),this._pinImagePoint=t,this._Pin(e,"properties",a)},SetPinDistance(e){"rope"!==this._mode&&"bar"!==this._mode||(this._pinDist=Math.max(e,0))},SetDestroy(e){this._destroy=e},Unpin(){this._SetPinInst(null),this._mode="",this._propSet.clear(),this._pinImagePoint=""},Pin(e,t){switch(t){case 0:this._Pin(e,"properties",["x","y","angle"]);break;case 1:this._Pin(e,"properties",["x","y"]);break;case 2:this._Pin(e,"properties",["angle"]);break;case 3:this._Pin(e,"rope");break;case 4:this._Pin(e,"bar")}}},self.C3.Behaviors.Pin.Exps={PinnedUID(){return this._pinInst?this._pinInst.GetUID():-1}};{const pA=self.C3;pA.Behaviors.Tween=class extends pA.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const fA=self.C3;fA.Behaviors.Tween.Type=class extends fA.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const mA=self.C3,gA=mA.Behaviors.Tween,IA=0;gA.Instance=class extends mA.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._allowMultiple=!1,this._enabled=!0,t&&(this._allowMultiple=!1,this._enabled=!!t[IA]),this._activeTweens=new Map,this._disabledTweens=[],this._waitingForReleaseTweens=new Map,this._finishingTween=null,this._activeTweensJson=null,this._disabledTweensJson=null,this._waitingForReleaseTweensJson=null,this._finishingTweenName="",this._triggerTweens=[],this._afterLoad=e=>this._OnAfterLoad(),this.GetRuntime().Dispatcher().addEventListener("afterload",this._afterLoad)}Release(){this.GetRuntime().Dispatcher().removeEventListener("afterload",this._afterLoad),this._afterLoad=null,this._finishingTween&&(this.ReleaseAndCompleteTween(this._finishingTween),this._finishingTween=null),this.ReleaseAndCompleteTweens(),this._tweens=null,this.ClearDisabledList(),this._disabledTweens=null,this._ReleaseWaitingTweens(),this._waitingForReleaseTweens=null,this._triggerTweens=null,super.Release()}PushTriggerTween(e){this._triggerTweens.push(e)}PopTriggerTween(){this._triggerTweens.pop()}GetTriggerTween(){return this._triggerTweens[this._triggerTweens.length-1]}SetEnabled(e){this._enabled=!!e,e?this._waitingForReleaseTweens&&this._waitingForReleaseTweens.size&&this._StartTicking2():this._StopTicking2();for(const t of this.AllTweens())e?this.IsInDisabledList(t)&&t.Resume():((t.IsPlaying()||t.IsScheduled())&&this.AddToDisabledList(t),t.Stop());e&&this.ClearDisabledList()}IsEnabled(){return this._enabled}AddToDisabledList(e){this._disabledTweens.push(e)}IsInDisabledList(e){return this._disabledTweens.includes(e)}ClearDisabledList(){mA.clearArray(this._disabledTweens)}GetFinishingTween(){return this._finishingTween}IsInstanceValid(){const e=this.GetObjectInstance();return!!e&&!e.IsDestroyed()}GetTween(e,t,s=!1){const n=t?this.PropertyTweens(t,s):this.AllTweens(s);if(n&&n.length)for(const t of n)if(t.HasTags(e))return t}CheckTweensWithTags(e,t){for(const s of this._activeTweens.values())for(const n of s)if(!n.IsReleased()&&n.HasTags(e)&&t(n))return!0;for(const s of this._waitingForReleaseTweens.values())for(const n of s)if(!n.IsReleased()&&n.HasTags(e)&&t(n))return!0;return!1}CheckTweens(e){for(const t of this._activeTweens.values())for(const s of t)if(!s.IsReleased()&&e(s))return!0;for(const t of this._waitingForReleaseTweens.values())for(const s of t)if(!s.IsReleased()&&e(s))return!0;return!1}GetTweenIncludingWaitingForRelease(e,t){return this.GetTween(e,t,!0)}*GetTweens(e,t,s=!1){const n=t?this.PropertyTweens(t,s):this.AllTweens(s);if(n&&n.length)for(const t of n)t.HasTags(e)&&(yield t)}*GetTweensIncludingWaitingForRelease(e,t){yield*this.GetTweens(e,t,!0)}PropertyTweens(e,t){if(t){let t=this._activeTweens.get(e),s=this._waitingForReleaseTweens.get(e);return t||(t=[]),s||(s=[]),t.concat(s).filter((e=>e)).filter((e=>!e.IsReleased()))}{let t=this._activeTweens.get(e);return t||(t=[]),t.filter((e=>e)).filter((e=>!e.IsReleased()))}}AllTweens(e){if(e){const e=[...this._activeTweens.values()].flat(),t=[...this._waitingForReleaseTweens.values()].flat();return e.concat(t).filter((e=>e)).filter((e=>!e.IsReleased()))}return[...this._activeTweens.values()].flat().filter((e=>e)).filter((e=>!e.IsReleased()))}AllTweensIncludingWaitingForRelease(){return this.AllTweens(!0)}SaveToJson(e="full"){return{s:!1,e:!!this._enabled,at:this._SaveActiveTweensToJson(),dt:this._SaveDisabledTweensToJson(),wt:this._SaveWaitingForReleaseTweensToJson(),ft:this._SaveFinishingTweenToJson()}}LoadFromJson(e,t="full"){e&&(this._activeTweensJson=e.at,this._disabledTweensJson=e.dt,this._waitingForReleaseTweensJson=e.wt,this._finishingTweenName=e.ft,this._allowMultiple=!1,this._enabled=!!e.e,"state"===t&&this._OnAfterLoad())}_OnAfterLoad(){const e=this.GetRuntime().GetTimelineManager();if(this._PopulateTweenMap(this._activeTweensJson,this._activeTweens,e),this._disabledTweensJson){mA.clearArray(this._disabledTweens);for(const t of this._disabledTweensJson)this._PopulateTweenArray(this._disabledTweens,t,e)}this._PopulateTweenMap(this._waitingForReleaseTweensJson,this._waitingForReleaseTweens,e),this._finishingTween=this._GetTween(this._finishingTweenName,e),this._enabled?this._waitingForReleaseTweens&&this._waitingForReleaseTweens.size&&this._StartTicking2():this._StopTicking2()}_PopulateTweenMap(e,t,s){if(e)for(const n in e){let i=t.get(n);i?mA.clearArray(i):i=[];const r=e[n];for(const e of r)if(this._PopulateTweenArray(i,e.name,s))this._LoadTweenFromJson(e.name,e,s);else{const t=mA.TweenState.Build({runtime:this.GetRuntime(),json:e});mA.TweenState.SetInstanceUID(t,this.GetObjectInstance().GetUID()),t.AddCompletedCallback((e=>this._FinishTriggers(e))),t.SetBehaviorInstance(this),s.AddScheduledTimeline(t),this._PopulateTweenArray(i,t,s)}t.set(n,i)}}_GetTween(e,t){return t.GetScheduledOrPlayingTimelineByName(e)}_PopulateTweenArray(e,t,s){if("string"!=typeof t)return!!e.push(t);{const n=this._GetTween(t,s);if(n)return!!e.push(n)}return!1}_LoadTweenFromJson(e,t,s){if("string"==typeof e){const n=this._GetTween(e,s);n&&(n._LoadFromJson(t),mA.TweenState.SetInstanceUID(n,this.GetObjectInstance().GetUID()),mA.TweenState.SetBehaviorInstance(n,this))}else e._LoadFromJson(t),mA.TweenState.SetInstanceUID(e,this.GetObjectInstance().GetUID()),mA.TweenState.SetBehaviorInstance(e,this)}_SaveActiveTweensToJson(){const e={};for(const[t,s]of this._activeTweens)e[t]=s.filter((e=>!e.IsReleased())).map((e=>e._SaveToJson()));return e}_SaveDisabledTweensToJson(){return this._disabledTweens.filter((e=>!e.IsReleased())).map((e=>e.GetName()))}_SaveWaitingForReleaseTweensToJson(){const e={};for(const[t,s]of this._waitingForReleaseTweens)e[t]=s.map((e=>e._SaveToJson()));return e}_SaveFinishingTweenToJson(){return this._finishingTween?this._finishingTween.GetName():""}Tick2(){this._ReleaseWaitingTweens()}CreateTween(e){const t=gA.Config.GetPropertyTracksConfig(e.property,e.startValue,e.endValue,e.ease,e.resultMode,this.GetObjectInstance()),s=gA.Maps.GetPropertyFromIndex(e.property);gA.Maps.IsValueId(s)||this.ReleaseTweens(e.property);const n=mA.TweenState.Build({runtime:this.GetRuntime(),id:s,tags:e.tags,time:e.time,instance:this.GetObjectInstance(),releaseOnComplete:!!e.releaseOnComplete,loop:!!e.loop,pingPong:!!e.pingPong,repeatCount:e.repeatCount,initialValueMode:e.initialValueMode,propertyTracksConfig:t});return n.AddCompletedCallback((e=>this._FinishTriggers(e))),n.SetBehaviorInstance(this),this._AddTween(n,e.property),n}_MaybeRemoveFromActiveTweenMap(e){const t=e.GetId();if(this._activeTweens.has(t)){const s=this._activeTweens.get(t);if(s){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}}ReleaseTween(e,t=!1){this._MaybeRemoveFromActiveTweenMap(e),e.IsReleased()||this._IsInWaitingList(e)||(e.Stop(t),this._AddToWaitingList(e))}ReleaseTweens(e,t=!1){if(mA.IsFiniteNumber(e)){const s=gA.Maps.GetPropertyFromIndex(e);if(!this._activeTweens.has(s))return;const n=this._activeTweens.get(s),i=this.GetFinishingTween();for(const e of n)e!==i&&(e.IsReleased()||this._IsInWaitingList(e)||(e.Stop(t),e.Release()));mA.clearArray(n)}else{const e=this.GetFinishingTween();for(const s of this.AllTweens())s!==e&&(s.IsReleased()||this._IsInWaitingList(s)||(s.Stop(t),s.Release()));for(const e of this._activeTweens.keys())mA.clearArray(this._activeTweens.get(e)),this._activeTweens.delete(e);this._activeTweens.clear()}}ReleaseAndCompleteTween(e){this.ReleaseTween(e,!0)}ReleaseAndCompleteTweens(){this.ReleaseTweens(NaN,!0)}GetPropertyValueByIndex(e){if(e===IA)return this._enabled}SetPropertyValueByIndex(e,t){e===IA&&(this._enabled=!!t)}_GetBehaviorType(e){const t=e.GetInstance().GetBehaviorInstances();for(const e of t){const t=e.GetBehaviorType();if(t.GetInstanceSdkCtor()===this.constructor)return t}}Trigger(e,t,s,n){return this._runtime?super.Trigger(e):t.Trigger(e,s,n)}_FinishTriggers(e){let t,s;if(this._finishingTween=e,gA.Cnds.SetFinishingTween(e),this.GetRuntime())t=this._inst,s=this._runtime,this.Trigger(gA.Cnds.OnTweensFinished),this.Trigger(gA.Cnds.OnAnyTweensFinished),this.ReleaseTween(e);else{if(t=e.GetInstance(),!t)return;if(t&&t.IsDestroyed())return;s=t.GetRuntime();const n=this._GetBehaviorType(e);this.Trigger(gA.Cnds.OnTweensFinished,s,t,n),this.Trigger(gA.Cnds.OnAnyTweensFinished,s,t,n),e.Stop()}this._finishingTween=null,gA.Cnds.SetFinishingTween(null),e.GetDestroyInstanceOnComplete()&&s.DestroyInstance(t)}_AddTween(e,t){const s=gA.Maps.GetPropertyFromIndex(t);this._activeTweens.has(s)||this._activeTweens.set(s,[]),this._activeTweens.get(s).push(e)}_AddToWaitingList(e){const t=e.GetId();this._waitingForReleaseTweens.has(t)||this._waitingForReleaseTweens.set(t,[]),this._waitingForReleaseTweens.get(t).push(e),this.IsTicking2()||this._StartTicking2()}_IsInWaitingList(e){const t=e.GetId();return!!this._waitingForReleaseTweens.has(t)&&this._waitingForReleaseTweens.get(t).includes(e)}_ReleaseWaitingTweens(){if(this._waitingForReleaseTweens.size){for(const e of this._waitingForReleaseTweens.values()){for(const t of e)t.IsReleased()||t.Release();mA.clearArray(e)}this._waitingForReleaseTweens.clear(),this.IsTicking2()&&this._StopTicking2()}}GetDebuggerProperties(){return[{title:"$"+this.GetBehaviorType().GetName(),properties:[{name:"behaviors.tween.properties.enabled.name",value:this.IsEnabled(),onedit:e=>this.SetEnabled(e)}]}]}GetScriptInterfaceClass(){return self.ITweenBehaviorInstance}}}{const SA=self.C3;let yA=null;SA.Behaviors.Tween.Cnds={OnAnyTweenLoop:()=>!0,OnTweensLoop(e){const t=this.GetTriggerTween();return!!t&&t.HasTags(e)},OnAnyTweenPingPong(e){const t=this.GetTriggerTween();return!!t&&(t.GetPingPongState()===e||2===e)},OnTweensPingPong(e,t){const s=this.GetTriggerTween();return!!s&&(s.GetPingPongState()===t||2===t)&&s.HasTags(e)},SetFinishingTween(e){yA=e},OnTweensFinished:e=>yA.HasTags(e),OnAnyTweensFinished:()=>!0,IsPlaying(e){return this.CheckTweensWithTags(e,SA.TweenState.IsPlaying)},IsAnyPlaying(){return this.CheckTweens(SA.TweenState.IsPlaying)},IsPaused(e){return this.CheckTweensWithTags(e,SA.TweenState.IsPaused)},IsAnyPaused(){return this.CheckTweens(SA.TweenState.IsPaused)},IsPingPong(e,t){return 0===t?this.CheckTweensWithTags(e,SA.TweenState.IsPing):1===t&&this.CheckTweensWithTags(e,SA.TweenState.IsPong)},IsAnyPingPong(e){return 0===e?this.CheckTweens(SA.TweenState.IsPing):1===e&&this.CheckTweens(SA.TweenState.IsPong)}}}{const bA=self.C3,GA=self.Ease,vA=bA.Behaviors.Tween;vA.Acts={SetEnabled(e){this.SetEnabled(!!e)},async TweenOneProperty(...e){if(!this.IsEnabled()||!this.IsInstanceValid())return;const t=this.CreateTween(vA.TweenArguments.OneProperty(this,...e));t.Play()&&await t.GetPlayPromise()},async TweenTwoProperties(...e){if(!this.IsEnabled()||!this.IsInstanceValid())return;const t=this.CreateTween(vA.TweenArguments.TwoProperties(this,...e));t.Play()&&await t.GetPlayPromise()},async TweenValue(...e){if(!this.IsEnabled()||!this.IsInstanceValid())return;const t=this.CreateTween(vA.TweenArguments.ValueProperty(this,...e));t.Play()&&await t.GetPlayPromise()},PauseTweens(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.GetTweens(e))t.Stop()},PauseAllTweens(){if(this.IsEnabled()&&this.IsInstanceValid())for(const e of this.AllTweens())e.Stop()},ResumeTweens(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.GetTweens(e))t.Resume()},ResumeAllTweens(){if(this.IsEnabled()&&this.IsInstanceValid())for(const e of this.AllTweens())e.Resume()},StopTweens(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.GetTweens(e))this.ReleaseTween(t)},StopAllTweens(){if(this.IsEnabled()&&this.IsInstanceValid())for(const e of this.AllTweens())this.ReleaseTween(e)},SetOnePropertyTweensEndValue(e,t,s){if(!this.IsEnabled()||!this.IsInstanceValid())return;const n=bA.Behaviors.Tween.Maps.GetSinglePropertyFromIndex(t);for(const t of this.GetTweens(e))t.BeforeSetEndValues([n]),t.SetEndValue(s,n)},SetTwoPropertiesTweensEndValue(e,t,s,n){if(!this.IsEnabled()||!this.IsInstanceValid())return;const i=bA.Behaviors.Tween.Maps.GetRealProperties(t);for(const t of this.GetTweens(e))t.BeforeSetEndValues(i),t.SetEndValue(s,i[0]),t.SetEndValue(n,i[1])},SetValuePropertyTweensStartValue(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e,"value"))s.SetStartValue(t,"value")},SetValuePropertyTweensEndValue(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e,"value"))s.BeforeSetEndValues(["value"]),s.SetEndValue(t,"value")},SetTweensEase(e,t){if(!this.IsEnabled()||!this.IsInstanceValid())return;const s=GA.GetEaseFromIndex(t);for(const t of this.GetTweens(e))t.SetEase(s)},SetAllTweensEase(e){if(!this.IsEnabled()||!this.IsInstanceValid())return;const t=GA.GetEaseFromIndex(e);for(const e of this.AllTweens())e.SetEase(t)},SetTweensTime(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e))s.SetTime(t)},SetAllTweensTime(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.AllTweens())t.SetTime(e)},SetTweensPlaybackRate(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e))s.SetPlaybackRate(t)},SetAllTweensPlaybackRate(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.AllTweens())t.SetPlaybackRate(e)},SetTweensDestroyOnComplete(e,t){if(this.IsEnabled()&&this.IsInstanceValid())for(const s of this.GetTweens(e))s.SetDestroyInstanceOnComplete(!!t)},SetAllTweensDestroyOnComplete(e){if(this.IsEnabled()&&this.IsInstanceValid())for(const t of this.AllTweens())t.SetDestroyInstanceOnComplete(!!e)}}}self.C3.Behaviors.Tween.Exps={Time(e){const t=this.GetTweenIncludingWaitingForRelease(e);return t?t.GetTime():0},Progress(e){const t=this.GetTweenIncludingWaitingForRelease(e);return t?t.GetTime()/t.GetTotalTime():0},PlaybackRate(e){const t=this.GetTweenIncludingWaitingForRelease(e);return t?t.GetPlaybackRate():0},Value(e){const t=this.GetTweenIncludingWaitingForRelease(e,"value");return t?t.GetPropertyTrack("value").GetSourceAdapterValue():0},Tags(){let e=this.GetFinishingTween();return e?e.GetStringTags():(e=this.GetTriggerTween(),e?e.GetStringTags():"")}};{const xA=self.C3,TA=self.Ease,CA=["position","size","scale"],wA=["offsetX","offsetY","offsetWidth","offsetHeight","offsetAngle","offsetOpacity","offsetColor","offsetZElevation","offsetScaleX","offsetScaleY"],PA=["value"],AA=[].concat(CA).concat(wA).concat(PA),RA={position:["offsetX","offsetY"],size:["offsetWidth","offsetHeight"],scale:["offsetScaleX","offsetScaleY"]},DA=Object.assign({},AA.reduce(((e,t)=>Object.assign({},e,{[t]:[t]})),{}),RA);xA.Behaviors.Tween.Maps=class{constructor(){}static GetEases(){return[...TA.GetRuntimeEaseNames()]}static GetEaseFromIndex(e){return[...TA.GetRuntimeEaseNames()][e]}static GetPropertyFromIndex(e){return AA[e]}static GetPropertyIndexFromName(e){return AA.indexOf(e)}static GetPairPropertyFromIndex(e){return CA[e]}static GetSinglePropertyFromIndex(e){return wA[e]}static GetValuePropertyFromIndex(e){return PA[e]}static GetPairProperties(e){return RA[e]}static GetRealProperties(e){return xA.IsString(e)?DA[e]:DA[AA[e]]}static IsPairId(e){return!!RA[e]}static IsColorId(e){return"offsetColor"===e}static IsAngleId(e){return"offsetAngle"===e}static IsOpacityId(e){return"offsetOpacity"===e}static IsValueId(e){return"value"===e}}}{const EA=self.C3,MA=EA.Behaviors.Tween,kA=new Map;MA.Config=class{constructor(){}static GetPropertyTracksConfig(e,t,s,n,i,r){0===kA.size&&this._CreateConfigObjects();const a=MA.PropertyTypes.Pick(e);let o=kA.get(a);return EA.IsFiniteNumber(e)&&(e=MA.Maps.GetPropertyFromIndex(e)),this._GetConfig(o,e,t,s,n,i,r)}static TransformValue(e,t){return EA.Behaviors.Tween.GetPropertyTracksConfig(e).valueGetter(t)}static _CreateConfigObjects(){const e=MA.PropertyTypes,t=MA.ValueGetters;this._AddConfigObject(e.PAIR,this._GetPairConfig,t._GetPropertyValue),this._AddConfigObject(e.COLOR,this._GetColorConfig,t._GetColorPropertyValue),this._AddConfigObject(e.ANGLE,this._GetAngleConfig,t._GetPropertyAngleValue),this._AddConfigObject(e.VALUE,this._GetValueConfig,t._GetPropertyValue),this._AddConfigObject(e.OTHER,this._GetCommonConfig,t._GetPropertyValue)}static _AddConfigObject(e,t,s){kA.set(e,this._CreateConfigObject(e,t,s))}static _CreateConfigObject(e,t,s){return{name:e,configFunc:t,valueGetter:s}}static _GetConfig(e,t,s,n,i,r,a){return e.configFunc(t,e.valueGetter(s),e.valueGetter(n),i,r,a)}static _GetPairConfig(e,t,s,n,i,r){return MA.Maps.GetPairProperties(e).map(((e,r)=>({sourceId:"world-instance",property:e,type:"float",valueType:"numeric",startValue:t[r],endValue:s[r],ease:MA.Maps.GetEaseFromIndex(n),resultMode:i})))}static _GetColorConfig(e,t,s,n,i,r){return EA.Plugins.Text&&r.GetPlugin()instanceof EA.Plugins.Text?{sourceId:"plugin",sourceArgs:[7],property:"color",type:"color",valueType:"color",startValue:t,endValue:s,ease:MA.Maps.GetEaseFromIndex(n),resultMode:i}:{sourceId:"world-instance",property:e,type:"color",valueType:"color",startValue:t,endValue:s,ease:MA.Maps.GetEaseFromIndex(n),resultMode:i}}static _GetAngleConfig(e,t,s,n,i,r){return{sourceId:"world-instance",property:e,type:"angle",valueType:"angle",startValue:t,endValue:s,ease:MA.Maps.GetEaseFromIndex(n),resultMode:i}}static _GetCommonConfig(e,t,s,n,i,r){return{sourceId:"world-instance",property:e,type:"float",valueType:"numeric",startValue:t,endValue:s,ease:MA.Maps.GetEaseFromIndex(n),resultMode:i}}static _GetValueConfig(e,t,s,n,i,r){return{sourceId:"value",property:e,type:"float",valueType:"numeric",startValue:t,endValue:s,ease:MA.Maps.GetEaseFromIndex(n),resultMode:i}}}}{const LA=self.C3,FA=LA.Behaviors.Tween,BA={resultMode:"absolute"},OA=Object.assign({},BA,{tags:"",property:"",time:0,ease:0,releaseOnComplete:0,loop:!1,pingPong:!1,repeatCount:1}),NA=Object.assign({},OA,{initialValueMode:"current-state",startValue:0,endValue:0}),WA=Object.assign({},OA,{initialValueMode:"current-state",startValue:[0,0],endValue:[0,0]}),VA=Object.assign({},OA,{initialValueMode:"current-state",startValue:[0,0,0],endValue:[0,0,0]}),jA=Object.assign({},NA,{initialValueMode:"start-value"}),UA=0,HA=1,zA=0,XA=1,YA=2;FA.TweenArguments=class{constructor(){}static _SetCommonProperties(e,t,s,n,i,r,a,o){e.tags=t,e.time=s,e.ease=n,e.releaseOnComplete=i,e.loop=r,e.pingPong=a,e.repeatCount=o}static OneProperty(e,t,s,n,i,r,a,o,l,c){const h="string"==typeof s?s:FA.Maps.GetSinglePropertyFromIndex(s),_=FA.Maps.IsColorId(h)?VA:NA;return this._SetCommonProperties(_,t,i,r,a,o,l,c),FA.Maps.IsColorId(h)?(VA.endValue[0]=LA.GetRValue(n),VA.endValue[1]=LA.GetGValue(n),VA.endValue[2]=LA.GetBValue(n),VA.property=FA.Maps.GetPropertyIndexFromName(h)):FA.Maps.IsOpacityId(h)?NA.endValue=n/100:NA.endValue=n,_.property=FA.Maps.GetPropertyIndexFromName(h),_}static TwoProperties(e,t,s,n,i,r,a,o,l,c,h){this._SetCommonProperties(WA,t,r,a,o,l,c,h);const _="string"==typeof s?s:FA.Maps.GetPairPropertyFromIndex(s);return WA.endValue[0]=n,WA.endValue[1]=i,WA.property=FA.Maps.GetPropertyIndexFromName(_),WA}static ValueProperty(e,t,s,n,i,r,a,o,l,c){return this._SetCommonProperties(jA,t,i,r,a,o,l,c),jA.startValue=s,jA.endValue=n,jA.property=FA.Maps.GetPropertyIndexFromName("value"),jA}}}{const qA=self.C3,JA=qA.Behaviors.Tween,KA=[];JA.PropertyTypes=class{constructor(){}static Pick(e){if(0===KA.length){const e=KA;e.push({checkFunc:JA.Maps.IsPairId,result:this.PAIR}),e.push({checkFunc:JA.Maps.IsColorId,result:this.COLOR}),e.push({checkFunc:JA.Maps.IsAngleId,result:this.ANGLE}),e.push({checkFunc:JA.Maps.IsValueId,result:this.VALUE}),e.push({checkFunc:()=>!0,result:this.OTHER})}qA.IsFiniteNumber(e)&&(e=qA.Behaviors.Tween.Maps.GetPropertyFromIndex(e));for(const t of KA)if(t.checkFunc(e))return t.result}static get PAIR(){return"pair"}static get COLOR(){return"color"}static get ANGLE(){return"angle"}static get VALUE(){return"value"}static get OTHER(){return"other"}}}{const $A=self.C3,ZA=$A.Behaviors.Tween;ZA.ValueGetters=class{constructor(){}static _GetPropertyAngleValue(e){const t=$A.toRadians(parseFloat(e));return $A.clampAngle(t)}static _GetColorPropertyValue(e){return e.slice(0)}static _GetPropertyValue(e){return e}}}{let QA=function(e){sR.RequireString(e);const t=iR.ToInternal(e);let s;if(s=t?iR.GetIndexForEase(t,null):iR.GetIndexForEase(e,null),-1===s)throw new Error(`invalid ease name '${e}'`);return s},eR=function(e,t=!1){if(!(t&&null==e||"string"==typeof e||Array.isArray(e)))throw new Error("invalid tags")};getIndexForEase=QA,ValidateTags=eR;const tR=self.C3,sR=self.C3X,nR=self.IBehaviorInstance,iR=self.Ease,rR=tR.Behaviors.Tween,aR=new WeakMap,oR=new Map([["x",{name:"offsetX",type:"one"}],["y",{name:"offsetY",type:"one"}],["width",{name:"offsetWidth",type:"one"}],["height",{name:"offsetHeight",type:"one"}],["angle",{name:"offsetAngle",type:"one"}],["opacity",{name:"offsetOpacity",type:"one"}],["color",{name:"offsetColor",type:"color"}],["z-elevation",{name:"offsetZElevation",type:"one"}],["x-scale",{name:"offsetScaleX",type:"one"}],["y-scale",{name:"offsetScaleY",type:"one"}],["position",{name:"position",type:"two"}],["size",{name:"size",type:"two"}],["scale",{name:"scale",type:"two"}],["value",{name:"value",type:"value"}]]),lR={tags:"",destroyOnComplete:!1,loop:!1,pingPong:!1,repeatCount:1,startValue:0},cR={easeToIndexFunc:QA};self.ITweenBehaviorInstance=class extends nR{constructor(){super(),aR.set(this,nR._GetInitInst().GetSdkInstance())}startTween(e,t,s,n,i){const r=aR.get(this);if(!r.IsEnabled()||!r.IsInstanceValid())return null;const a=oR.get(e);if(!a)throw new Error("invalid tween property");"one"===a.type||"value"===a.type?sR.RequireNumber(t):(sR.RequireArray(t),"two"===a.type?(sR.RequireNumber(t[0]),sR.RequireNumber(t[1])):"color"===a.type&&(sR.RequireNumber(t[0]),sR.RequireNumber(t[1]),sR.RequireNumber(t[2]))),"angle"===e?t=tR.toDegrees(t):"opacity"===e?t*=100:"color"===e&&(t=tR.PackRGBEx(t[0],t[1],t[2]));const o=QA(n);let l;if(sR.RequireFiniteNumber(s),i=Object.assign({},lR,i),"value"===a.type&&sR.RequireNumber(i.startValue),eR(i.tags,!0),"one"===a.type||"color"===a.type?l=r.CreateTween(rR.TweenArguments.OneProperty(r,i.tags,a.name,t,s,o,!!i.destroyOnComplete,!!i.loop,!!i.pingPong,i.repeatCount)):"two"===a.type?l=r.CreateTween(rR.TweenArguments.TwoProperties(r,i.tags,a.name,t[0],t[1],s,o,!!i.destroyOnComplete,!!i.loop,!!i.pingPong,i.repeatCount)):"value"===a.type&&(l=r.CreateTween(rR.TweenArguments.ValueProperty(r,i.tags,i.startValue,t,s,o,!!i.destroyOnComplete,!!i.loop,!!i.pingPong,i.repeatCount))),l.SetBehaviorInstance(r.GetBehaviorInstance().GetSdkInstance()),!l.Play())throw new Error("failed to start tween");return l.GetITweenState(r,cR)}*allTweens(){const e=aR.get(this);for(const t of e.AllTweens())yield t.GetITweenState(e,cR)}*tweensByTags(e){eR(e);const t=aR.get(this);for(const s of t.GetTweens(e))yield s.GetITweenState(t,cR)}get isEnabled(){return aR.get(this).IsEnabled()}set isEnabled(e){aR.get(this).SetEnabled(e)}}}{const hR=self.C3;hR.Behaviors.DragnDrop=class extends hR.SDKBehaviorBase{constructor(e){super(e);const t=this._runtime.Dispatcher();this._disposables=new hR.CompositeDisposable(hR.Disposable.From(t,"pointerdown",(e=>this._OnPointerDown(e.data))),hR.Disposable.From(t,"pointermove",(e=>this._OnPointerMove(e.data))),hR.Disposable.From(t,"pointerup",(e=>this._OnPointerUp(e.data,!1))),hR.Disposable.From(t,"pointercancel",(e=>this._OnPointerUp(e.data,!0))))}Release(){this._disposables.Release(),this._disposables=null,super.Release()}_OnPointerDown(e){"mouse"===e.pointerType&&0!==e.button||this._OnInputDown(e.pointerId.toString(),e.pageX-this._runtime.GetCanvasClientX(),e.pageY-this._runtime.GetCanvasClientY())}_OnPointerMove(e){1&e.lastButtons&&!(1&e.buttons)?this._OnInputUp(e.pointerId.toString()):this._OnInputMove(e.pointerId.toString(),e.pageX-this._runtime.GetCanvasClientX(),e.pageY-this._runtime.GetCanvasClientY())}_OnPointerUp(e,t){"mouse"===e.pointerType&&0!==e.button||this._OnInputUp(e.pointerId.toString())}async _OnInputDown(e,t,s){const n=this.GetInstances();let i=null,r=null,a=0,o=0;for(const e of n){const n=e.GetBehaviorSdkInstanceFromCtor(hR.Behaviors.DragnDrop);if(!n.IsEnabled()||n.IsDragging()||e.IsDestroyed())continue;const l=e.GetWorldInfo(),c=l.GetLayer(),[h,_]=c.CanvasCssToLayer(t,s,l.GetTotalZElevation());if(!c.IsSelfAndParentsInteractive()||!l.ContainsPoint(h,_))continue;if(!i){i=e,r=n,a=h,o=_;continue}const u=i.GetWorldInfo();(c.GetIndex()>u.GetLayer().GetIndex()||c.GetIndex()===u.GetLayer().GetIndex()&&l.GetZIndex()>u.GetZIndex())&&(i=e,r=n,a=h,o=_)}i&&await r._OnDown(e,a,o)}_OnInputMove(e,t,s){const n=this.GetInstances();for(const i of n){const n=i.GetBehaviorSdkInstanceFromCtor(hR.Behaviors.DragnDrop);if(!n.IsEnabled()||!n.IsDragging()||n.IsDragging()&&n.GetDragSource()!==e)continue;const r=i.GetWorldInfo(),a=r.GetLayer(),[o,l]=a.CanvasCssToLayer(t,s,r.GetTotalZElevation());n._OnMove(o,l)}}async _OnInputUp(e){const t=this.GetInstances();for(const s of t){const t=s.GetBehaviorSdkInstanceFromCtor(hR.Behaviors.DragnDrop);t.IsDragging()&&t.GetDragSource()===e&&await t._OnUp()}}}}{const _R=self.C3;_R.Behaviors.DragnDrop.Type=class extends _R.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const uR=self.C3,dR=(self.C3X,self.IBehaviorInstance),pR=0,fR=1;uR.Behaviors.DragnDrop.Instance=class extends uR.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._isDragging=!1,this._dx=0,this._dy=0,this._dragSource="<none>",this._axes=0,this._isEnabled=!0,t&&(this._axes=t[pR],this._isEnabled=t[fR])}Release(){super.Release()}SaveToJson(){return{a:this._axes,e:this._isEnabled}}LoadFromJson(e){this._axes=e.a,this._isEnabled=e.e,this._isDragging=!1}_SetEnabled(e){this._isEnabled=!!e,this._isEnabled||(this._isDragging=!1)}IsEnabled(){return this._isEnabled}_SetAxes(e){this._axes=e}_GetAxes(){return this._axes}_Drop(){this._isDragging&&this._OnUp()}IsDragging(){return this._isDragging}GetDragSource(){return this._dragSource}async _OnDown(e,t,s){const n=this.GetWorldInfo();this._dx=t-n.GetX(),this._dy=s-n.GetY(),this._isDragging=!0,this._dragSource=e,this.DispatchScriptEvent("dragstart"),await this.TriggerAsync(uR.Behaviors.DragnDrop.Cnds.OnDragStart)}_OnMove(e,t){const s=this.GetWorldInfo(),n=e-this._dx,i=t-this._dy;0===this._axes?s.GetX()===n&&s.GetY()===i||(s.SetXY(n,i),s.SetBboxChanged()):1===this._axes?s.GetX()!==n&&(s.SetX(n),s.SetBboxChanged()):2===this._axes&&s.GetY()!==i&&(s.SetY(i),s.SetBboxChanged())}async _OnUp(){this._isDragging=!1,this.DispatchScriptEvent("drop"),await this.TriggerAsync(uR.Behaviors.DragnDrop.Cnds.OnDrop)}GetPropertyValueByIndex(e){switch(e){case pR:return this._GetAxes();case fR:return this.IsEnabled()}}SetPropertyValueByIndex(e,t){switch(e){case pR:this._SetAxes(t);break;case fR:this._SetEnabled(!!t)}}GetDebuggerProperties(){const e="behaviors.dragndrop",t=e+".properties.axes";let s="";return 0===this._axes?s=t+".items.both":1===this._axes?s=t+".items.horizontal-only":2===this._axes&&(s=t+".items.vertical-only"),[{title:"$"+this.GetBehaviorType().GetName(),properties:[{name:e+".debugger.is-dragging",value:this.IsDragging()},{name:t+".name",value:[s]},{name:e+".properties.enabled.name",value:this.IsEnabled(),onedit:e=>this._SetEnabled(e)}]}]}GetScriptInterfaceClass(){return self.IDragDropBehaviorInstance}};const mR=new WeakMap,gR=["both","horizontal","vertical"];self.IDragDropBehaviorInstance=class extends dR{constructor(){super(),mR.set(this,dR._GetInitInst().GetSdkInstance())}set axes(e){const t=gR.indexOf(e);if(-1===t)throw new Error("invalid axes");mR.get(this)._SetAxes(t)}get axes(){return gR[mR.get(this)._GetAxes()]}drop(){mR.get(this)._Drop()}get isDragging(){return mR.get(this).IsDragging()}get isEnabled(){return mR.get(this).IsEnabled()}set isEnabled(e){mR.get(this)._SetEnabled(e)}}}self.C3.Behaviors.DragnDrop.Cnds={IsDragging(){return this.IsDragging()},OnDragStart:()=>!0,OnDrop:()=>!0,IsEnabled(){return this.IsEnabled()}},self.C3.Behaviors.DragnDrop.Acts={SetEnabled(e){this._SetEnabled(!!e)},SetAxes(e){this._SetAxes(e)},Drop(){this._Drop()}},self.C3.Behaviors.DragnDrop.Exps={};{const IR=self.C3;IR.Behaviors.CV_BoundedDragnDrop=class extends IR.SDKBehaviorBase{constructor(e){super(e);const t=this._runtime.Dispatcher();this._disposables=new IR.CompositeDisposable(IR.Disposable.From(t,"pointerdown",(e=>this._OnPointerDown(e.data))),IR.Disposable.From(t,"pointermove",(e=>this._OnPointerMove(e.data))),IR.Disposable.From(t,"pointerup",(e=>this._OnPointerUp(e.data,!1))),IR.Disposable.From(t,"pointercancel",(e=>this._OnPointerUp(e.data,!0))))}Release(){this._disposables.Release(),this._disposables=null,super.Release()}_OnPointerDown(e){this._OnInputDown(e.pointerId.toString(),e.clientX-this._runtime.GetCanvasClientX(),e.clientY-this._runtime.GetCanvasClientY())}_OnPointerMove(e){this._OnInputMove(e.pointerId.toString(),e.clientX-this._runtime.GetCanvasClientX(),e.clientY-this._runtime.GetCanvasClientY())}_OnPointerUp(e){this._OnInputUp(e.pointerId.toString())}async _OnInputDown(e,t,s){const n=this.GetInstances();let i=null,r=null,a=0,o=0;for(const e of n){const n=e.GetBehaviorSdkInstanceFromCtor(IR.Behaviors.CV_BoundedDragnDrop);if(!n.IsEnabled()||n.IsDragging())continue;const l=e.GetWorldInfo(),c=l.GetLayer(),[h,_]=c.CanvasCssToLayer(t,s,l.GetTotalZElevation());if(!l.ContainsPoint(h,_))continue;if(!i){i=e,r=n,a=h,o=_;continue}const u=i.GetWorldInfo();(c.GetIndex()>u.GetLayer().GetIndex()||c.GetIndex()===u.GetLayer().GetIndex()&&l.GetZIndex()>u.GetZIndex())&&(i=e,r=n,a=h,o=_)}i&&await r._OnDown(e,a,o)}_OnInputMove(e,t,s){const n=this.GetInstances();for(const i of n){const n=i.GetBehaviorSdkInstanceFromCtor(IR.Behaviors.CV_BoundedDragnDrop);if(!n.IsEnabled()||!n.IsDragging()||n.IsDragging()&&n.GetDragSource()!==e)continue;const r=i.GetWorldInfo(),a=r.GetLayer(),[o,l]=a.CanvasCssToLayer(t,s,r.GetTotalZElevation());n._OnMove(o,l)}}async _OnInputUp(e){const t=this.GetInstances();for(const s of t){const t=s.GetBehaviorSdkInstanceFromCtor(IR.Behaviors.CV_BoundedDragnDrop);t.IsDragging()&&t.GetDragSource()===e&&await t._OnUp()}}}}{const SR=self.C3;SR.Behaviors.CV_BoundedDragnDrop.Type=class extends SR.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const yR=self.C3;yR.Behaviors.CV_BoundedDragnDrop.Instance=class extends yR.SDKBehaviorInstanceBase{constructor(e,t){super(e);const s=this._inst.GetWorldInfo();t&&(this.axes=t[0],this.enabled=t[1],this.dragging=!1,this.dx=0,this.dy=0,this.dragsource="<none>",this.axes=t[0],this.enabled=0!==t[1],this.boundTo=t[2],this.boundBy=t[3],this.boundMethod=t[4],this.boundXRadius=t[5],this.boundYRadius=t[6],this.boundMinX=t[7],this.boundMaxX=t[8],this.boundMinY=t[9],this.boundMaxY=t[10],this.boundEnabled=!1,this.radiusBound=!1,this.posBound=!1,this.posX=s.GetX(),this.posY=s.GetY(),this.radiusExceeded=!1,this.positionExceeded=!1,this.getBoundValues=function(){0===this.boundTo?(this.boundEnabled=!1,this.radiusBound=!1,this.posBound=!1):1===this.boundTo?(this.boundEnabled=!0,0!==this.boundXRadius||0!==this.boundYRadius?(this.radiusBound=!0,0===this.boundXRadius&&(0!==this.axes&&1!==this.axes||(this.axes=2)),0===this.boundYRadius&&(0!==this.axes&&2!==this.axes||(this.axes=1))):this.radiusBound=!1,this.posBound=!0):2===this.boundTo?0===this.boundXRadius&&0===this.boundYRadius||(this.boundEnabled=!0,0!==this.boundXRadius||0!==this.boundYRadius?(this.radiusBound=!0,0===this.boundXRadius&&(0!==this.axes&&1!==this.axes||(this.axes=2)),0===this.boundYRadius&&(0!==this.axes&&2!==this.axes||(this.axes=1))):this.radiusBound=!1,this.posBound=!1):(this.boundEnabled=!0,this.radiusBound=!1,this.posBound=!0)},this.getBoundValues()),this.inst={get:{x:s.GetX(),y:s.GetY()},set:{x:function(e){return s.SetX(e)},y:function(e){return s.SetY(e)}},set_bbox_changed:function(){s.SetBboxChanged()},hotspotX:s.GetOriginX(),hotspotY:s.GetOriginY(),width:s.GetWidth(),height:s.GetHeight()}}Release(){super.Release()}SaveToJson(){return{a:this.axes,e:this.enabled}}LoadFromJson(e){this.axes=e.a,this.enabled=e.e,this.dragging=!1}IsEnabled(){return this.enabled}IsDragging(){return this.dragging}GetDragSource(){return this.dragsource}async _OnDown(e,t,s){const n=this.GetWorldInfo();this.dx=t-n.GetX(),this.dy=s-n.GetY(),this.dragging=!0,this.dragsource=e,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnDragStart)}_OnMove(e,t){var s=e-this.dx,n=t-this.dy;if(0===this.axes)if(this.boundEnabled)if(0===this.boundBy){this.limitLowX=this.posX-this.boundXRadius,this.limitHighX=this.posX+this.boundXRadius,this.limitLowY=this.posY-this.boundYRadius,this.limitHighY=this.posY+this.boundYRadius,this.limitLowPosX=this.boundMinX,this.limitHighPosX=this.boundMaxX,this.limitLowPosY=this.boundMinY,this.limitHighPosY=this.boundMaxY;var i=!1,r=!1;this.radiusBound&&(s<this.limitLowX||s>this.limitHighX||n<this.limitLowY||n>this.limitHighY)?(i=!1,this.radiusExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnRadiusExceeded)):(i=!0,this.radiusExceeded=!1),this.posBound&&(s<this.limitLowPosX||s>this.limitHighPosX||n<this.limitLowPosY||n>this.limitHighPosY)?(r=!1,this.positionExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnPositionExceeded)):(r=!0,this.positionExceeded=!1),0===this.boundMethod?i&&r&&(this.inst.get.x===s&&this.inst.get.y===n||(this.inst.set.x(s),this.inst.set.y(n),this.inst.set_bbox_changed())):(i||(s<this.limitLowX&&(s=this.limitLowX),s>this.limitHighX&&(s=this.limitHighX),n<this.limitLowY&&(n=this.limitLowY),n>this.limitHighY&&(n=this.limitHighY)),r||(s<this.limitLowPosX&&(s=this.limitLowPosX),s>this.limitHighPosX&&(s=this.limitHighPosX),n<this.limitLowPosY&&(n=this.limitLowPosY),n>this.limitHighPosY&&(n=this.limitHighPosY)),this.inst.get.x===s&&this.inst.get.y===n||(this.inst.set.x(s),this.inst.set.y(n),this.inst.set_bbox_changed()))}else{var a=this.inst.hotspotX,o=this.inst.hotspotY,l=a*this.inst.width,c=(1-a)*this.inst.width,h=o*this.inst.height,_=(1-o)*this.inst.height;this.limitLowX=this.posX+l-this.boundXRadius,this.limitHighX=this.posX-c+this.boundXRadius,this.limitLowY=this.posY+h-this.boundYRadius,this.limitHighY=this.posY-_+this.boundYRadius,this.limitLowPosX=this.boundMinX+l,this.limitHighPosX=this.boundMaxX-c,this.limitLowPosY=this.boundMinY+h,this.limitHighPosY=this.boundMaxY-_;i=!1,r=!1;this.radiusBound&&(s<this.limitLowX||s>this.limitHighX||n<this.limitLowY||n>this.limitHighY)?(i=!1,this.radiusExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnRadiusExceeded)):(i=!0,this.radiusExceeded=!1),this.posBound&&(s<this.limitLowPosX||s>this.limitHighPosX||n<this.limitLowPosY||n>this.limitHighPosY)?(r=!1,this.positionExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnPositionExceeded)):(r=!0,this.positionExceeded=!1),0===this.boundMethod?i&&r&&(this.inst.get.x===s&&this.inst.get.y===n||(this.inst.set.x(s),this.inst.set.y(n),this.inst.set_bbox_changed())):(i||(s<this.limitLowX&&(s=this.limitLowX),s>this.limitHighX&&(s=this.limitHighX),n<this.limitLowY&&(n=this.limitLowY),n>this.limitHighY&&(n=this.limitHighY)),r||(s<this.limitLowPosX&&(s=this.limitLowPosX),s>this.limitHighPosX&&(s=this.limitHighPosX),n<this.limitLowPosY&&(n=this.limitLowPosY),n>this.limitHighPosY&&(n=this.limitHighPosY)),this.inst.get.x===s&&this.inst.get.y===n||(this.inst.set.x(s),this.inst.set.y(n),this.inst.set_bbox_changed()))}else this.inst.get.x===s&&this.inst.get.y===n||(this.inst.set.x(s),this.inst.set.y(n),this.inst.set_bbox_changed());else if(1===this.axes)if(this.boundEnabled)if(0===this.boundBy){this.limitLowX=this.posX-this.boundXRadius,this.limitHighX=this.posX+this.boundXRadius,this.limitLowPosX=this.boundMinX,this.limitHighPosX=this.boundMaxX;i=!1,r=!1;this.radiusBound&&(s<this.limitLowX||s>this.limitHighX)?(i=!1,this.radiusExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnRadiusExceeded)):(i=!0,this.radiusExceeded=!1),this.posBound&&(s<this.limitLowPosX||s>this.limitHighPosX)?(r=!1,this.positionExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnPositionExceeded)):(r=!0,this.positionExceeded=!1),0===this.boundMethod?i&&r&&this.inst.get.x!==s&&(this.inst.set.x(s),this.inst.set_bbox_changed()):(i||(s<this.limitLowX&&(s=this.limitLowX),s>this.limitHighX&&(s=this.limitHighX),n<this.limitLowY&&(n=this.limitLowY),n>this.limitHighY&&(n=this.limitHighY)),r||(s<this.limitLowPosX&&(s=this.limitLowPosX),s>this.limitHighPosX&&(s=this.limitHighPosX),n<this.limitLowPosY&&(n=this.limitLowPosY),n>this.limitHighPosY&&(n=this.limitHighPosY)),this.inst.get.x!==s&&(this.inst.set.x(s),this.inst.set_bbox_changed()))}else{l=(a=this.inst.hotspotX)*this.inst.width,c=(1-a)*this.inst.width;this.limitLowX=this.posX+l-this.boundXRadius,this.limitHighX=this.posX-c+this.boundXRadius,this.limitLowPosX=this.boundMinX+l,this.limitHighPosX=this.boundMaxX-c;i=!1,r=!1;this.radiusBound&&(s<this.limitLowX||s>this.limitHighX)?(i=!1,this.radiusExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnRadiusExceeded)):(i=!0,this.radiusExceeded=!1),this.posBound&&(s<this.limitLowPosX||s>this.limitHighPosX)?(r=!1,this.positionExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnPositionExceeded)):(r=!0,this.positionExceeded=!1),0===this.boundMethod?i&&r&&this.inst.get.x!==s&&(this.inst.set.x(s),this.inst.set_bbox_changed()):(i||(s<this.limitLowX&&(s=this.limitLowX),s>this.limitHighX&&(s=this.limitHighX),n<this.limitLowY&&(n=this.limitLowY),n>this.limitHighY&&(n=this.limitHighY)),r||(s<this.limitLowPosX&&(s=this.limitLowPosX),s>this.limitHighPosX&&(s=this.limitHighPosX),n<this.limitLowPosY&&(n=this.limitLowPosY),n>this.limitHighPosY&&(n=this.limitHighPosY)),this.inst.get.x!==s&&(this.inst.set.x(s),this.inst.set_bbox_changed()))}else this.inst.get.x!==s&&(this.inst.set.x(s),this.inst.set_bbox_changed());else if(2===this.axes)if(this.boundEnabled)if(0===this.boundBy){this.limitLowY=this.posY-this.boundYRadius,this.limitHighY=this.posY+this.boundYRadius,this.limitLowPosY=this.boundMinY,this.limitHighPosY=this.boundMaxY;i=!1,r=!1;this.radiusBound&&(n<this.limitLowY||n>this.limitHighY)?(i=!1,this.radiusExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnRadiusExceeded)):(i=!0,this.radiusExceeded=!1),this.posBound&&(n<this.limitLowPosY||n>this.limitHighPosY)?(r=!1,this.positionExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnPositionExceeded)):(r=!0,this.positionExceeded=!1),0===this.boundMethod?i&&r&&this.inst.get.y!==n&&(this.inst.set.y(n),this.inst.set_bbox_changed()):(i||(s<this.limitLowX&&(s=this.limitLowX),s>this.limitHighX&&(s=this.limitHighX),n<this.limitLowY&&(n=this.limitLowY),n>this.limitHighY&&(n=this.limitHighY)),r||(s<this.limitLowPosX&&(s=this.limitLowPosX),s>this.limitHighPosX&&(s=this.limitHighPosX),n<this.limitLowPosY&&(n=this.limitLowPosY),n>this.limitHighPosY&&(n=this.limitHighPosY)),this.inst.get.y!==n&&(this.inst.set.y(n),this.inst.set_bbox_changed()))}else{h=(o=this.inst.hotspotY)*this.inst.height,_=(1-o)*this.inst.height;this.limitLowY=this.posY+h-this.boundYRadius,this.limitHighY=this.posY-_+this.boundYRadius,this.limitLowPosY=this.boundMinY+h,this.limitHighPosY=this.boundMaxY-_;i=!1,r=!1;this.radiusBound&&(n<this.limitLowY||n>this.limitHighY)?(i=!1,this.radiusExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnRadiusExceeded)):(i=!0,this.radiusExceeded=!1),this.posBound&&(n<this.limitLowPosY||n>this.limitHighPosY)?(r=!1,this.positionExceeded=!0,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnAnyBoundExceeded),this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnPositionExceeded)):(r=!0,this.positionExceeded=!1),0===this.boundMethod?i&&r&&this.inst.get.y!==n&&(this.inst.set.y(n),this.inst.set_bbox_changed()):(i||(s<this.limitLowX&&(s=this.limitLowX),s>this.limitHighX&&(s=this.limitHighX),n<this.limitLowY&&(n=this.limitLowY),n>this.limitHighY&&(n=this.limitHighY)),r||(s<this.limitLowPosX&&(s=this.limitLowPosX),s>this.limitHighPosX&&(s=this.limitHighPosX),n<this.limitLowPosY&&(n=this.limitLowPosY),n>this.limitHighPosY&&(n=this.limitHighPosY)),this.inst.get.y!==n&&(this.inst.set.y(n),this.inst.set_bbox_changed()))}else this.inst.get.y!==n&&(this.inst.set.y(n),this.inst.set_bbox_changed())}_OnUp(){this.dragging=!1,this.Trigger(yR.Behaviors.CV_BoundedDragnDrop.Cnds.OnDrop)}_GetPropertyValueByIndex(e){return 0===e?this.axes:1===e?this.enabled:void 0}_SetPropertyValueByIndex(e,t){0===e?this.axes=t:1===e&&(this.enabled=!!t)}}}{const bR=self.C3;bR.Behaviors.CV_BoundedDragnDrop.Cnds={IsDragging(){return this.dragging},OnDragStart:()=>!0,OnDrop:()=>!0,IsEnabled(){return!!this.enabled},OnAnyBoundExceeded:()=>!0,OnRadiusExceeded:()=>!0,OnPositionExceeded:()=>!0,IsRadiusExceeded(){return this.radiusExceeded},IsPositionExceeded(){return this.positionExceeded}}}{const GR=self.C3;GR.Behaviors.CV_BoundedDragnDrop.Acts={SetEnabled(e){this.enabled=0!==e,this.enabled||(this.dragging=!1)},Drop(){this.dragging&&this.onUp()},SetBoundTo(e){this.boundTo=e,this.getBoundValues()},SetBoundBy(e){this.boundBy=e,this.getBoundValues()},SetBoundMethod(e){this.boundMethod=e},SetXYRadius(e,t){this.boundXRadius=e,this.boundYRadius=t,this.getBoundValues()},SetXRadius(e){this.boundXRadius=e,this.getBoundValues()},SetYRadius(e){this.boundYRadius=e,this.getBoundValues()},SetBoundPosition(e,t,s,n){this.boundMinX=e,this.boundMaxX=t,this.boundMinY=s,this.boundMaxY=n,this.getBoundValues()},SetBoundX(e,t){this.boundMinX=e,this.boundMaxX=t,this.getBoundValues()},SetBoundY(e,t){this.boundMinY=e,this.boundMaxY=t,this.getBoundValues()},OverwriteOrigin(e,t){this.posX=e,this.posY=t,this.getBoundValues()}}}{const vR=self.C3;vR.Behaviors.CV_BoundedDragnDrop.Exps={BoundTo(){var e;switch(this.boundTo){case 0:e="Off";break;case 1:e="Both";break;case 2:e="Radius";break;case 3:e="Position"}return e},BoundBy(){var e;switch(this.boundBy){case 0:e="Origin";break;case 1:e="Edge"}return e},BoundMethod(){var e;switch(this.boundMethod){case 0:e="Halt";break;case 1:e="Clamp"}return e},xBoundRadius(){return this.boundXRadius},yBoundRadius(){return this.boundYRadius},xMinBoundPos(){return this.boundMinX},xMaxBoundPos(){return this.boundMaxX},yMinBoundPos(){return this.boundMinY},yMaxBoundPos(){return this.boundMaxY},xOrigin(){return this.posX},yOrigin(){return this.posY}}}{const xR=self.C3;xR.Behaviors.Sin=class extends xR.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const TR=self.C3;TR.Behaviors.Sin.Type=class extends TR.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const CR=self.C3,wR=self.C3X,PR=self.IBehaviorInstance,AR=0,RR=1,DR=2,ER=3,MR=4,kR=5,LR=6,FR=7,BR=8,OR=0,NR=1,WR=2,VR=3,jR=4,UR=5,HR=6,zR=7,XR=8,YR=9,qR=0,JR=1,KR=2,$R=3,ZR=4,QR=2*Math.PI,eD=Math.PI/2,tD=3*Math.PI/2,sD=[0,1,8,3,4,2,5,6,9,7];CR.Behaviors.Sin.Instance=class extends CR.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._i=0,this._movement=0,this._wave=0,this._period=0,this._mag=0,this._isEnabled=!0,this._basePeriod=0,this._basePeriodOffset=0,this._baseMag=0,this._periodRandom=0,this._periodOffsetRandom=0,this._magnitudeRandom=0,this._initialValue=0,this._initialValue2=0,this._lastKnownValue=0,this._lastKnownValue2=0,this._ratio=0,t&&(this._movement=sD[t[AR]],this._wave=t[RR],this._periodRandom=this._runtime.Random()*t[ER],this._basePeriod=t[DR],this._period=t[DR],this._period+=this._periodRandom,this._basePeriodOffset=t[MR],0!==this._period&&(this._periodOffsetRandom=this._runtime.Random()*t[kR],this._i=t[MR]/this._period*QR,this._i+=this._periodOffsetRandom/this._period*QR),this._magnitudeRandom=this._runtime.Random()*t[FR],this._baseMag=t[LR],this._mag=t[LR],this._mag+=this._magnitudeRandom,this._isEnabled=!!t[BR]),this._movement===UR&&(this._mag=CR.toRadians(this._mag)),this.Init(),this._isEnabled&&this._StartTicking()}Release(){super.Release()}SaveToJson(){return{i:this._i,e:this._isEnabled,mv:this._movement,w:this._wave,p:this._period,mag:this._mag,iv:this._initialValue,iv2:this._initialValue2,r:this._ratio,lkv:this._lastKnownValue,lkv2:this._lastKnownValue2}}LoadFromJson(e){this._i=e.i,this._SetEnabled(e.e),this._movement=e.mv,this._wave=e.w,this._period=e.p,this._mag=e.mag,this._initialValue=e.iv,this._initialValue2=e.iv2,this._ratio=e.r,this._lastKnownValue=e.lkv,this._lastKnownValue2=e.lkv2}Init(){const e=this._inst.GetWorldInfo();switch(this._movement){case OR:this._initialValue=e.GetX();break;case NR:this._initialValue=e.GetY();break;case WR:this._initialValue=e.GetWidth(),this._ratio=e.GetHeight()/e.GetWidth();break;case VR:this._initialValue=e.GetWidth();break;case jR:this._initialValue=e.GetHeight();break;case UR:this._initialValue=e.GetAngle();break;case HR:this._initialValue=e.GetOpacity();break;case zR:this._initialValue=0;break;case XR:this._initialValue=e.GetX(),this._initialValue2=e.GetY();break;case YR:this._initialValue=e.GetZElevation()}this._lastKnownValue=this._initialValue,this._lastKnownValue2=this._initialValue2}WaveFunc(e){switch(e%=QR,this._wave){case qR:return Math.sin(e);case JR:return e<=eD?e/eD:e<=tD?1-2*(e-eD)/Math.PI:(e-tD)/eD-1;case KR:return 2*e/QR-1;case $R:return-2*e/QR+1;case ZR:return e<Math.PI?-1:1}return 0}Tick(){const e=this._runtime.GetDt(this._inst);this._isEnabled&&0!==e&&(0===this._period?this._i=0:this._i=(this._i+e/this._period*QR)%QR,this._UpdateFromPhase())}_UpdateFromPhase(){const e=this._inst.GetWorldInfo();switch(this._movement){case OR:e.GetX()!==this._lastKnownValue&&(this._initialValue+=e.GetX()-this._lastKnownValue),e.SetX(this._initialValue+this.WaveFunc(this._i)*this._mag),this._lastKnownValue=e.GetX();break;case NR:e.GetY()!==this._lastKnownValue&&(this._initialValue+=e.GetY()-this._lastKnownValue),e.SetY(this._initialValue+this.WaveFunc(this._i)*this._mag),this._lastKnownValue=e.GetY();break;case WR:e.SetWidth(this._initialValue+this.WaveFunc(this._i)*this._mag),e.SetHeight(e.GetWidth()*this._ratio);break;case VR:e.SetWidth(this._initialValue+this.WaveFunc(this._i)*this._mag);break;case jR:e.SetHeight(this._initialValue+this.WaveFunc(this._i)*this._mag);break;case UR:e.GetAngle()!==this._lastKnownValue&&(this._initialValue=CR.clampAngle(this._initialValue+(e.GetAngle()-this._lastKnownValue))),e.SetAngle(this._initialValue+this.WaveFunc(this._i)*this._mag),this._lastKnownValue=e.GetAngle();break;case HR:e.SetOpacity(this._initialValue+this.WaveFunc(this._i)*this._mag/100);break;case XR:e.GetX()!==this._lastKnownValue&&(this._initialValue+=e.GetX()-this._lastKnownValue),e.GetY()!==this._lastKnownValue2&&(this._initialValue2+=e.GetY()-this._lastKnownValue2),e.SetX(this._initialValue+Math.cos(e.GetAngle())*this.WaveFunc(this._i)*this._mag),e.SetY(this._initialValue2+Math.sin(e.GetAngle())*this.WaveFunc(this._i)*this._mag),this._lastKnownValue=e.GetX(),this._lastKnownValue2=e.GetY();break;case YR:e.SetZElevation(this._initialValue+this.WaveFunc(this._i)*this._mag)}e.SetBboxChanged()}_OnSpriteFrameChanged(e,t){}_SetPeriod(e){this._period=e}_GetPeriod(){return this._period}_SetMagnitude(e){this._mag=e}_SetMagnitude_ConvertAngle(e){5===this._movement&&(e=CR.toRadians(e)),this._SetMagnitude(e)}_GetMagnitude(){return this._mag}_GetMagnitude_ConvertAngle(){let e=this._GetMagnitude();return 5===this._movement&&(e=CR.toDegrees(e)),e}_SetMovement(e){5===this._movement&&5!==e&&(this._mag=CR.toDegrees(this._mag)),this._movement=e,this.Init()}_GetMovement(){return this._movement}_SetWave(e){this._wave=e}_GetWave(){return this._wave}_SetPhase(e){this._i=CR.clamp(e,0,2*Math.PI),this._UpdateFromPhase()}_GetPhase(){return this._i}_SetEnabled(e){this._isEnabled=!!e,this._isEnabled?this._StartTicking():this._StopTicking()}_IsEnabled(){return this._isEnabled}GetPropertyValueByIndex(e){switch(e){case AR:return this._movement;case RR:return this._wave;case DR:return this._basePeriod;case LR:return this._baseMag;case BR:return this._isEnabled}}SetPropertyValueByIndex(e,t){switch(e){case AR:this._movement=sD[t],this.Init();break;case RR:this._wave=t;break;case DR:this._basePeriod=t,this._period=this._basePeriod+this._periodRandom,this._isEnabled||(0!==this._period?(this._i=this._basePeriodOffset/this._period*QR,this._i+=this._periodOffsetRandom/this._period*QR):this._i=0);break;case LR:this._baseMag=t,this._mag=this._baseMag+this._magnitudeRandom,this._movement===UR&&(this._mag=CR.toRadians(this._mag));break;case BR:this._isEnabled=!!t}}GetDebuggerProperties(){const e="behaviors.sin";return[{title:"$"+this.GetBehaviorType().GetName(),properties:[{name:e+".properties.enabled.name",value:this._IsEnabled(),onedit:e=>this._SetEnabled(e)},{name:e+".properties.period.name",value:this._GetPeriod(),onedit:e=>this._SetPeriod(e)},{name:e+".properties.magnitude.name",value:this._GetMagnitude_ConvertAngle(),onedit:e=>this._SetMagnitude_ConvertAngle(e)},{name:e+".debugger.value",value:this.WaveFunc(this._GetPhase())*this._GetMagnitude_ConvertAngle()}]}]}GetScriptInterfaceClass(){return self.ISineBehaviorInstance}};const nD=new WeakMap,iD=["horizontal","vertical","size","width","height","angle","opacity","value-only","forwards-backwards","z-elevation"],rD=["sine","triangle","sawtooth","reverse-sawtooth","square"];self.ISineBehaviorInstance=class extends PR{constructor(){super(),nD.set(this,PR._GetInitInst().GetSdkInstance())}set period(e){wR.RequireFiniteNumber(e),nD.get(this)._SetPeriod(e)}get period(){return nD.get(this)._GetPeriod()}set magnitude(e){wR.RequireFiniteNumber(e),nD.get(this)._SetMagnitude(e)}get magnitude(){return nD.get(this)._GetMagnitude()}set phase(e){nD.get(this)._SetPhase(e)}get phase(){return nD.get(this)._GetPhase()}set movement(e){wR.RequireString(e);const t=iD.indexOf(e);if(-1===t)throw new Error("invalid movement");nD.get(this)._SetMovement(t)}get movement(){return iD[nD.get(this)._GetMovement()]}set wave(e){wR.RequireString(e);const t=rD.indexOf(e);if(-1===t)throw new Error("invalid wave");nD.get(this)._SetWave(t)}get wave(){return rD[nD.get(this)._GetWave()]}get value(){const e=nD.get(this);return e.WaveFunc(e._GetPhase())*e._GetMagnitude()}updateInitialState(){nD.get(this).Init()}set isEnabled(e){nD.get(this)._SetEnabled(!!e)}get isEnabled(){return nD.get(this)._IsEnabled()}}}{const aD=self.C3;aD.Behaviors.Sin.Cnds={IsEnabled(){return this._IsEnabled()},CompareMovement(e){return this._GetMovement()===e},ComparePeriod(e,t){return aD.compare(this._GetPeriod(),e,t)},CompareMagnitude(e,t){return aD.compare(this._GetMagnitude_ConvertAngle(),e,t)},CompareWave(e){return this._GetWave()===e}}}self.C3.Behaviors.Sin.Acts={SetEnabled(e){this._SetEnabled(0!==e)},SetPeriod(e){this._SetPeriod(e)},SetMagnitude(e){this._SetMagnitude_ConvertAngle(e)},SetMovement(e){this._SetMovement(e)},SetWave(e){this._wave=e},SetPhase(e){const t=2*Math.PI;this._SetPhase(e*t%t)},UpdateInitialState(){this.Init()}},self.C3.Behaviors.Sin.Exps={CyclePosition(){return this._GetPhase()/(2*Math.PI)},Period(){return this._GetPeriod()},Magnitude(){return this._GetMagnitude_ConvertAngle()},Value(){return this.WaveFunc(this._GetPhase())*this._GetMagnitude_ConvertAngle()}};{const oD=self.C3;oD.Behaviors.bound=class extends oD.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const lD=self.C3;lD.Behaviors.bound.Type=class extends lD.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const cD=self.C3,hD=0;cD.Behaviors.bound.Instance=class extends cD.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._mode=0,t&&(this._mode=t[hD]),this._StartTicking2()}Release(){super.Release()}SaveToJson(){return{m:this._mode}}LoadFromJson(e){this._mode=e.m}Tick2(){const e=this._inst.GetWorldInfo(),t=e.GetBoundingBox(),s=e.GetLayout();let n=!1;0===this._mode?(e.GetX()<0&&(e.SetX(0),n=!0),e.GetY()<0&&(e.SetY(0),n=!0),e.GetX()>s.GetWidth()&&(e.SetX(s.GetWidth()),n=!0),e.GetY()>s.GetHeight()&&(e.SetY(s.GetHeight()),n=!0)):(t.getLeft()<0&&(e.OffsetX(-t.getLeft()),n=!0),t.getTop()<0&&(e.OffsetY(-t.getTop()),n=!0),t.getRight()>s.GetWidth()&&(e.OffsetX(-(t.getRight()-s.GetWidth())),n=!0),t.getBottom()>s.GetHeight()&&(e.OffsetY(-(t.getBottom()-s.GetHeight())),n=!0)),n&&e.SetBboxChanged()}GetPropertyValueByIndex(e){if(e===hD)return this._mode}SetPropertyValueByIndex(e,t){e===hD&&(this._mode=t)}}}self.C3.Behaviors.bound.Cnds={},self.C3.Behaviors.bound.Acts={},self.C3.Behaviors.bound.Exps={};{const _D=self.C3;_D.Behaviors.Rotate=class extends _D.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const uD=self.C3;uD.Behaviors.Rotate.Type=class extends uD.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const dD=self.C3,pD=self.C3X,fD=self.IBehaviorInstance,mD=0,gD=1,ID=2;dD.Behaviors.Rotate.Instance=class extends dD.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._speed=0,this._acceleration=0,this._isEnabled=!0,t&&(this._speed=dD.toRadians(t[mD]),this._acceleration=dD.toRadians(t[gD]),this._isEnabled=t[ID]),this._isEnabled&&this._StartTicking()}Release(){super.Release()}_SetSpeed(e){this._speed=e}_GetSpeed(){return this._speed}_SetAcceleration(e){this._acceleration=e}_GetAcceleration(){return this._acceleration}SaveToJson(){return{s:this._speed,a:this._acceleration,e:this._isEnabled}}LoadFromJson(e){this._speed=e.s,this._acceleration=e.a,this._SetEnabled(e.e)}Tick(){if(!this._isEnabled)return;const e=this._runtime.GetDt(this._inst);if(0!==e&&(0!==this._acceleration&&(this._speed+=this._acceleration*e),0!==this._speed)){const t=this._inst.GetWorldInfo();t.SetAngle(t.GetAngle()+this._speed*e),t.SetBboxChanged()}}GetPropertyValueByIndex(e){switch(e){case mD:return dD.toDegrees(this._GetSpeed());case gD:return dD.toDegrees(this._GetAcceleration());case ID:return this._IsEnabled()}}SetPropertyValueByIndex(e,t){switch(e){case mD:this._SetSpeed(dD.toRadians(t));break;case gD:this._SetAcceleration(dD.toRadians(t));break;case ID:this._SetEnabled(t)}}_SetEnabled(e){this._isEnabled=!!e,this._isEnabled?this._StartTicking():this._StopTicking()}_IsEnabled(){return this._isEnabled}GetDebuggerProperties(){const e="behaviors.rotate";return[{title:"$"+this.GetBehaviorType().GetName(),properties:[{name:e+".properties.speed.name",value:dD.toDegrees(this._GetSpeed()),onedit:e=>this._SetSpeed(dD.toRadians(e))},{name:e+".properties.acceleration.name",value:dD.toDegrees(this._GetAcceleration()),onedit:e=>this._SetAcceleration(dD.toRadians(e))},{name:e+".properties.enabled.name",value:this._IsEnabled(),onedit:e=>this._SetEnabled(e)}]}]}GetScriptInterfaceClass(){return self.IRotateBehaviorInstance}};const SD=new WeakMap;self.IRotateBehaviorInstance=class extends fD{constructor(){super(),SD.set(this,fD._GetInitInst().GetSdkInstance())}set speed(e){pD.RequireFiniteNumber(e),SD.get(this)._SetSpeed(e)}get speed(){return SD.get(this)._GetSpeed()}set acceleration(e){pD.RequireFiniteNumber(e),SD.get(this)._SetAcceleration(e)}get acceleration(){return SD.get(this)._GetAcceleration()}get isEnabled(){return SD.get(this)._IsEnabled()}set isEnabled(e){SD.get(this)._SetEnabled(e)}}}self.C3.Behaviors.Rotate.Cnds={IsEnabled(){return this._IsEnabled()}};{const yD=self.C3;yD.Behaviors.Rotate.Acts={SetSpeed(e){this._SetSpeed(yD.toRadians(e))},SetAcceleration(e){this._SetAcceleration(yD.toRadians(e))},SetEnabled(e){this._SetEnabled(e)}}}{const bD=self.C3;bD.Behaviors.Rotate.Exps={Speed(){return bD.toDegrees(this._GetSpeed())},Acceleration(){return bD.toDegrees(this._GetAcceleration())}}}{const GD=self.C3;GD.Behaviors.destroy=class extends GD.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const vD=self.C3;vD.Behaviors.destroy.Type=class extends vD.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const xD=self.C3;xD.Behaviors.destroy.Instance=class extends xD.SDKBehaviorInstanceBase{constructor(e,t){super(e),this._StartTicking()}Release(){super.Release()}Tick(){const e=this._inst.GetWorldInfo(),t=e.GetBoundingBox(),s=e.GetLayout();(t.getRight()<0||t.getBottom()<0||t.getLeft()>s.GetWidth()||t.getTop()>s.GetHeight())&&this._runtime.DestroyInstance(this._inst)}}}self.C3.Behaviors.destroy.Cnds={},self.C3.Behaviors.destroy.Acts={},self.C3.Behaviors.destroy.Exps={};{let TD=function(e,t,s){const n=e.GetSavedDataMap(),i=t.GetSavedDataMap();if(s){const s=n.get(MD);s&&s.delete(t.GetSID());const r=i.get(MD);r&&r.delete(e.GetSID())}else{let s=n.get(MD);s||(s=new Set,n.set(MD,s));let r=i.get(MD);r||(r=new Set,i.set(MD,r)),s.add(t.GetSID()),r.add(e.GetSID())}};SetObjectTypeCollisionsEnabled=TD;const CD=self.C3,wD=self.C3X;let PD=null,AD=null,RD=[],DD=null,ED=null;const MD="Physics_DisabledCollisions";CD.Behaviors.Physics=class extends CD.SDKBehaviorBase{constructor(e){super(e),ED=this,this._world=null,this._worldG=10,this._worldScale=.02,this._worldManifold=null,this._lastUpdateTick=-1,this._steppingMode=1,this._velocityIterations=8,this._positionIterations=3,this._allCollisionsEnabled=!0,this._runtime.AddLoadPromise(this._LoadBox2DWasm())}GetScriptInterfaceClass(){return self.IPhysicsBehavior}async _LoadBox2DWasm(){const e=await this._runtime.GetAssetManager().GetProjectFileUrl("box2d.wasm");await new Promise((t=>{self.Box2DWasmModule({wasmBinaryFile:e}).then((e=>{DD=e,this._InitBox2DWorld(),t()}))}))}_InitBox2DWorld(){const e=this._runtime.GetCollisionEngine();PD=CD.Behaviors.Physics.GetVec2(0,0),AD=CD.Behaviors.Physics.GetVec2(0,0),this._world=new DD.b2World(CD.Behaviors.Physics.GetTempVec2A(0,this._worldG),!0);const t=new DD.JSContactListener;t.BeginContact=t=>{const s=DD.wrapPointer(t,DD.b2Contact),n=CD.Behaviors.Physics.Instance.LookupBehInstFromBody(s.GetFixtureA().GetBody()),i=CD.Behaviors.Physics.Instance.LookupBehInstFromBody(s.GetFixtureB().GetBody());e.RegisterCollision(n.GetObjectInstance(),i.GetObjectInstance())},t.EndContact=()=>{},t.PreSolve=()=>{},t.PostSolve=()=>{},this._world.SetContactListener(t);const s=new DD.JSContactFilter;s.ShouldCollide=(e,t)=>{if(this._allCollisionsEnabled)return!0;const s=DD.wrapPointer(e,DD.b2Fixture),n=DD.wrapPointer(t,DD.b2Fixture),i=CD.Behaviors.Physics.Instance.LookupBehInstFromBody(s.GetBody()),r=CD.Behaviors.Physics.Instance.LookupBehInstFromBody(n.GetBody()),a=i.GetObjectInstance().GetObjectClass(),o=r.GetObjectInstance().GetObjectClass(),l=a.GetSID(),c=o.GetSID(),h=a.GetSavedDataMap().get(MD);if(h&&h.has(c))return!1;const _=o.GetSavedDataMap().get(MD);return!_||!_.has(l)},this._world.SetContactFilter(s),this._worldManifold=new DD.b2WorldManifold}Release(){super.Release()}GetBox2D(){return DD}GetWorld(){return this._world}GetWorldScale(){return this._worldScale}GetSteppingMode(){return this._steppingMode}SetSteppingMode(e){this._steppingMode=e}SetLastUpdateTick(e){this._lastUpdateTick=e}GetLastUpdateTick(){return this._lastUpdateTick}SetVelocityIterations(e){this._velocityIterations=Math.max(e,1)}GetVelocityIterations(){return this._velocityIterations}SetPositionIterations(e){this._positionIterations=Math.max(e,1)}GetPositionIterations(){return this._positionIterations}SetIterations(e,t){this.SetVelocityIterations(e),this.SetPositionIterations(t)}GetGravity(){return this._worldG}SetGravity(e){e!==this._worldG&&(this._world.SetGravity(CD.Behaviors.Physics.GetTempVec2A(0,e)),this._worldG=e,this._WakeUpAllPhysicsBodies())}_WakeUpAllPhysicsBodies(){for(const e of this.GetInstances()){const t=CD.Behaviors.Physics.Instance.LookupBehInstFromInst(e);if(!t)continue;const s=t.GetBody();s&&s.SetAwake(!0)}}DisableShouldCollideFastPath(){this._allCollisionsEnabled=!1}SetCollisionsEnabled(e,t,s){if(s=!!s,e&&t){if(t.IsFamily())for(const n of t.GetFamilyMembers())TD(e,n,s);else TD(e,t,s);this.DisableShouldCollideFastPath()}}GetWorldManifold(){return this._worldManifold}static GetPhysicsCollisionKey(){return MD}static GetVec2(e,t){if(RD.length){const s=RD.pop();return s.set_x(e),s.set_y(t),s}return new(0,DD.b2Vec2)(e,t)}static FreeVec2(e){RD.push(e)}static GetTempVec2A(e,t){return PD.set_x(e),PD.set_y(t),PD}static GetTempVec2B(e,t){return AD.set_x(e),AD.set_y(t),AD}static CreatePolygonShape(e){const t=new(0,DD.b2PolygonShape),s=DD._malloc(8*e.length);let n=0;for(let t=0;t<e.length;++t)DD.HEAPF32[s+n>>2]=e[t].get_x(),DD.HEAPF32[s+(n+4)>>2]=e[t].get_y(),n+=8;const i=DD.wrapPointer(s,DD.b2Vec2);return t.Set(i,e.length),DD._free(s),t}};const kD=["fixed","variable"];self.IPhysicsBehavior=class extends self.IBehavior{constructor(){super()}set worldGravity(e){wD.RequireFiniteNumber(e),ED.SetGravity(e)}get worldGravity(){return ED.GetGravity()}set steppingMode(e){const t=kD.indexOf(e);if(t<0)throw new Error("invalid stepping mode");ED.SetSteppingMode(kD[t])}get steppingMode(){return kD[ED.GetSteppingMode()]}set velocityIterations(e){wD.RequireFiniteNumber(e),ED.SetVelocityIterations(e)}get velocityIterations(){return ED.GetVelocityIterations()}set positionIterations(e){wD.RequireFiniteNumber(e),ED.SetPositionIterations(e)}get positionIterations(){return ED.GetPositionIterations()}setCollisionsEnabled(e,t,s){const n=ED.GetRuntime(),i=n._UnwrapIObjectClass(e),r=n._UnwrapIObjectClass(t);s=!!s,ED.SetCollisionsEnabled(i,r,s)}}}{const LD=self.C3;LD.Behaviors.Physics.Type=class extends LD.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{let FD=function(e,t){return oE.get(e).GetRuntime()._UnwrapIWorldInstance(t)};UnwrapIWorldInstance=FD;const BD=self.C3,OD=self.C3X,ND=self.IBehaviorInstance,WD=(self.assert,0),VD=1,jD=2,UD=3,HD=4,zD=5,XD=6,YD=7,qD=8,JD=9,KD=new WeakMap,$D=new WeakMap,ZD=new WeakMap,QD=-2147483648,eE=1073741824,tE=536870912,sE=3758096384,nE=BD.Behaviors.Physics.GetTempVec2A,iE=BD.Behaviors.Physics.GetTempVec2B,rE=BD.New(BD.Rect),aE=BD.New(BD.Quad);BD.Behaviors.Physics.Instance=class extends BD.SDKBehaviorInstanceBase{constructor(e,t){super(e);const s=this.GetBehavior(),n=this.GetWorldInfo();this._box2d=s.GetBox2D(),this._world=s.GetWorld(),this._worldScale=s.GetWorldScale(),this._isImmovable=!1,this._collisionMask=0,this._actualCollisionMask=0,this._preventRotation=!1,this._density=1,this._friction=.5,this._restitution=.2,this._linearDamping=0,this._angularDamping=.01,this._isBullet=!1,this._isEnabled=!0,this._body=null,this._fixtures=[],this._myJoints=[],this._myCreatedJoints=[],this._joiningMe=new Set,this._lastKnownX=n.GetX(),this._lastKnownY=n.GetY(),this._lastKnownAngle=n.GetAngle(),this._lastWidth=0,this._lastHeight=0,this._lastTickOverride=!1,t&&(this._isImmovable=!!t[WD],this._collisionMask=t[VD],this._preventRotation=!!t[jD],this._density=t[UD],this._friction=t[HD],this._restitution=t[zD],this._linearDamping=t[XD],this._angularDamping=t[YD],this._isBullet=!!t[qD],this._isEnabled=!!t[JD]);const i=this._runtime.Dispatcher();this._disposables=new BD.CompositeDisposable(BD.Disposable.From(i,"instancedestroy",(e=>this._OnInstanceDestroyed(e.instance))),BD.Disposable.From(i,"beforeload",(()=>this._OnBeforeLoad())),BD.Disposable.From(i,"afterload",(()=>this._OnAfterLoad()))),$D.set(this._inst,this),this._isEnabled&&this._StartTicking()}PostCreate(){this._CreateBody()}Release(){this._DestroyMyJoints(),BD.clearArray(this._myCreatedJoints),this._joiningMe.clear(),this._body&&(this._DestroyFixtures(),this._world.DestroyBody(this._body),this._body=null),super.Release()}_CreateFixture(e){if(!this._body)return;const t=this._body.CreateFixture(e);return this._fixtures.push(t),t}_DestroyFixtures(){if(this._body){for(const e of this._fixtures)this._body.DestroyFixture(e);BD.clearArray(this._fixtures)}}_GetBoundingQuadExcludingMesh(){const e=this.GetWorldInfo();return e.HasMesh()?(e.CalculateBbox(rE,aE,!1),aE):e.GetBoundingQuad()}_Destroy(e){this._box2d.destroy(e)}_CreateBody(){if(!this._isEnabled)return;const e=this._box2d.b2FixtureDef,t=this._box2d.b2BodyDef,s=this.GetWorldInfo(),n=s.HasOwnCollisionPoly();if(this._actualCollisionMask=this._collisionMask,n||this._inst.HasTilemap()||0!==this._actualCollisionMask||(this._actualCollisionMask=1),!this._body){const e=new t;e.set_type(this._isImmovable?0:2);let n=s.GetX()*this._worldScale,i=s.GetY()*this._worldScale;if(2===this._actualCollisionMask){const e=this._GetBoundingQuadExcludingMesh();n=e.midX()*this._worldScale,i=e.midY()*this._worldScale}e.set_position(iE(n,i)),e.set_angle(s.GetAngle()),e.set_fixedRotation(this._preventRotation),e.set_linearDamping(this._linearDamping),e.set_angularDamping(this._angularDamping),e.set_bullet(this._isBullet),this._body=this._world.CreateBody(e),this._Destroy(e),KD.set(this._body,this)}this._DestroyFixtures();const i=new e;i.set_density(this._density),i.set_friction(this._friction),i.set_restitution(this._restitution);const r=Math.max(Math.abs(s.GetWidth()),1),a=Math.max(Math.abs(s.GetHeight()),1);0===this._actualCollisionMask?this._inst.HasTilemap()?this._CreateTilemapFixtures(i):this._CreatePolygonFixture(i,r,a):1===this._actualCollisionMask?this._CreateBoundingBoxFixture(i,s,r,a):this._CreateCircleFixture(i,r,a),this._lastWidth=s.GetWidth(),this._lastHeight=s.GetHeight(),s.SetPhysicsBodyChanged(!1),this._Destroy(i)}_CreateBoundingBoxFixture(e,t,s,n){const i=new(0,this._box2d.b2PolygonShape),r=s*this._worldScale,a=n*this._worldScale;let o=t.GetOriginX(),l=t.GetOriginY();t.GetWidth()<0&&(o=1-o),t.GetHeight()<0&&(l=1-l);const c=(.5-o)*r,h=(.5-l)*a,_=BD.Behaviors.Physics.GetVec2(c,h);i.SetAsBox(r/2,a/2,_,0),e.set_shape(i),this._CreateFixture(e),this._Destroy(i),BD.Behaviors.Physics.FreeVec2(_)}_CreateCircleFixture(e,t,s){const n=new(0,this._box2d.b2CircleShape);n.set_m_radius(Math.min(t,s)*this._worldScale*.5),e.set_shape(n),this._CreateFixture(e),this._Destroy(n)}_CreatePolygonFixture(e,t,s){const n=this.GetWorldInfo(),i=n.GetWidth()<0,r=n.GetHeight()<0,a=this._worldScale,o=n.GetCustomTransformedCollisionPoly(i?-t:t,r?-s:s,0).pointsArr(),l=o.length/2,c=[];for(let e=0;e<l;++e)c.push(BD.Behaviors.Physics.GetVec2(o[2*e],o[2*e+1]));i!==r&&c.reverse();const h=BD.Behaviors.Physics.Separator.Separate(c,t*s);for(const e of c)BD.Behaviors.Physics.FreeVec2(e);if(h.length)for(const t of h){for(const e of t)e.set_x(e.get_x()*a),e.set_y(e.get_y()*a);const s=BD.Behaviors.Physics.CreatePolygonShape(t);e.set_shape(s),this._CreateFixture(e),this._Destroy(s);for(const e of t)BD.Behaviors.Physics.FreeVec2(e)}else this._CreateBoundingBoxFixture(e,n,t,s)}_CreateTilemapFixtures(e){const t=this._worldScale,s=BD.Behaviors.Physics.GetVec2,n=BD.Behaviors.Physics.FreeVec2,i=[];this._inst.GetSdkInstance().GetAllCollisionRects(i);const r=[];for(let a=0,o=i.length;a<o;++a){const o=i[a],l=o.GetRect(),c=o.GetPoly();if(c){let i=ZD.get(c);if(!i){const e=c.pointsArr(),t=c.pointCount();for(let n=0;n<t;++n)r.push(s(e[2*n],e[2*n+1]));const a=o.GetTileId()&sE;(a===QD||a===eE||a===tE||a&QD&&a&eE&&a&tE)&&r.reverse(),i=BD.Behaviors.Physics.Separator.Separate(r,l.width()*l.height()),ZD.set(c,i);for(const e of r)n(e);BD.clearArray(r)}for(let a=0,o=i.length;a<o;++a){const o=i[a];for(let e=0,n=o.length;e<n;++e)r.push(s((l.getLeft()+o[e].get_x())*t,(l.getTop()+o[e].get_y())*t));const c=BD.Behaviors.Physics.CreatePolygonShape(r);e.set_shape(c),this._CreateFixture(e),this._Destroy(c);for(const e of r)n(e);BD.clearArray(r)}}else{r.push(s(l.getLeft()*t,l.getTop()*t)),r.push(s(l.getRight()*t,l.getTop()*t)),r.push(s(l.getRight()*t,l.getBottom()*t)),r.push(s(l.getLeft()*t,l.getBottom()*t));const n=BD.Behaviors.Physics.CreatePolygonShape(r);e.set_shape(n),this._CreateFixture(e),this._Destroy(n)}for(const e of r)n(e);BD.clearArray(r)}}_DestroyBody(){this._body&&(this._DestroyMyJoints(),KD.delete(this._body),this._DestroyFixtures(),this._world.DestroyBody(this._body),this._body=null)}_DestroyMyJoints(){for(const e of this._myJoints)this._world.DestroyJoint(e);BD.clearArray(this._myJoints)}_RecreateMyJoints(){for(const e of this._myCreatedJoints)switch(e.type){case 0:this._DoCreateDistanceJoint(...e.params);break;case 1:this._DoCreateRevoluteJoint(...e.params);break;case 2:this._DoCreateLimitedRevoluteJoint(...e.params);break;case 3:this._DoCreatePrismaticJoint(...e.params)}}_GetInstImagePoint(e){const t=this.GetWorldInfo();if(-1===e)return[t.GetX(),t.GetY()];if(0===e&&this._body){const e=this._body.GetWorldCenter();return[e.get_x()/this._worldScale,e.get_y()/this._worldScale]}return this._inst.GetImagePoint(e)}_CreateDistanceJoint(e,t,s,n,i){if(!this._isEnabled||!t||t===this._inst)return;const r=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(t);r&&r._IsEnabled()&&(this._myCreatedJoints.push({type:0,params:[e,t.GetUID(),s,n,i]}),this._DoCreateDistanceJoint(e,t.GetUID(),s,n,i))}_DoCreateDistanceJoint(e,t,s,n,i){if(!this._isEnabled)return;const r=this._runtime.GetInstanceByUID(t);if(!r||r===this._inst)return;const a=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(r);if(!a||!a._IsEnabled())return;a._joiningMe.add(this._inst),this._UpdateBodyToMatchInstance(!1),a._UpdateBodyToMatchInstance(!1);const[o,l]=this._GetInstImagePoint(e),[c,h]=r.GetImagePoint(s),_=o-c,u=l-h,d=this._box2d.b2DistanceJointDef,p=this._worldScale,f=new d;f.Initialize(this._body,a.GetBody(),nE(o*p,l*p),iE(c*p,h*p)),f.set_length(Math.hypot(_,u)*p),f.set_dampingRatio(n),f.set_frequencyHz(i),this._myJoints.push(this._world.CreateJoint(f)),this._Destroy(f)}_CreateRevoluteJoint(e,t){if(!this._isEnabled||!t||t===this._inst)return;const s=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(t);s&&s._IsEnabled()&&(this._myCreatedJoints.push({type:1,params:[e,t.GetUID()]}),this._DoCreateRevoluteJoint(e,t.GetUID()))}_DoCreateRevoluteJoint(e,t){if(!this._isEnabled)return;const s=this._runtime.GetInstanceByUID(t);if(!s||s===this._inst)return;const n=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(s);if(!n||!n._IsEnabled())return;n._joiningMe.add(this._inst),this._UpdateBodyToMatchInstance(!1),n._UpdateBodyToMatchInstance(!1);const[i,r]=this._GetInstImagePoint(e),a=this._box2d.b2RevoluteJointDef,o=this._worldScale,l=new a;l.Initialize(this._body,n.GetBody(),nE(i*o,r*o)),this._myJoints.push(this._world.CreateJoint(l)),this._Destroy(l)}_CreateLimitedRevoluteJoint(e,t,s,n){if(!this._isEnabled||!t||t===this._inst)return;const i=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(t);i&&i._IsEnabled()&&(s=BD.toDegrees(s),n=BD.toDegrees(n),this._myCreatedJoints.push({type:2,params:[e,t.GetUID(),s,n]}),this._DoCreateLimitedRevoluteJoint(e,t.GetUID(),s,n))}_DoCreateLimitedRevoluteJoint(e,t,s,n){if(!this._isEnabled)return;const i=this._runtime.GetInstanceByUID(t);if(!i||i===this._inst)return;const r=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(i);if(!r||!r._IsEnabled())return;r._joiningMe.add(this._inst),this._UpdateBodyToMatchInstance(!1),r._UpdateBodyToMatchInstance(!1);const[a,o]=this._GetInstImagePoint(e),l=this._box2d.b2RevoluteJointDef,c=this._worldScale,h=new l;h.Initialize(this._body,r.GetBody(),nE(a*c,o*c)),h.set_enableLimit(!0),h.set_lowerAngle(BD.toRadians(s)),h.set_upperAngle(BD.toRadians(n)),this._myJoints.push(this._world.CreateJoint(h)),this._Destroy(h)}_CreatePrismaticJoint(e,t,s,n,i,r,a,o,l){if(!this._isEnabled||!t||t===this._inst)return;const c=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(t);c&&c._IsEnabled()&&(s=BD.toDegrees(s),o=BD.toDegrees(o),this._myCreatedJoints.push({type:3,params:[e,t.GetUID(),s,n,i,r,a,o,l]}),this._DoCreatePrismaticJoint(e,t.GetUID(),s,n,i,r,a,o,l))}_DoCreatePrismaticJoint(e,t,s,n,i,r,a,o,l){if(!this._isEnabled)return;const c=this._runtime.GetInstanceByUID(t);if(!c||c===this._inst)return;const h=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(c);if(!h||!h._IsEnabled())return;h._joiningMe.add(this._inst),this._UpdateBodyToMatchInstance(!1),h._UpdateBodyToMatchInstance(!1);const[_,u]=this._GetInstImagePoint(e);s=BD.toRadians(s);const d=Math.cos(s),p=Math.sin(s),f=this._box2d.b2PrismaticJointDef,m=this._worldScale,g=new f;g.Initialize(this._body,h.GetBody(),nE(_*m,u*m),iE(d,p)),g.set_enableLimit(!!n),g.set_lowerTranslation(i*m),g.set_upperTranslation(r*m),g.set_enableMotor(!!a),g.set_motorSpeed(BD.toRadians(o)),g.set_maxMotorForce(l),this._myJoints.push(this._world.CreateJoint(g)),this._Destroy(g)}_RemoveJoints(){this._isEnabled&&(this._DestroyMyJoints(),BD.clearArray(this._myCreatedJoints),this._joiningMe.clear())}_RemoveOtherInstanceJointsToMe(){for(const e of this._joiningMe){const t=BD.Behaviors.Physics.Instance.LookupBehInstFromInst(e);if(!t||!t._IsEnabled())return;t._DestroyJointsForInstance(this._inst)}this._joiningMe.clear()}_OnInstanceDestroyed(e){this._DestroyJointsForInstance(e)}_DestroyJointsForInstance(e){const t=e.GetUID();let s=0;for(let e=0,n=this._myCreatedJoints.length;e<n;++e)this._myCreatedJoints[s]=this._myCreatedJoints[e],s<this._myJoints.length&&(this._myJoints[s]=this._myJoints[e]),this._myCreatedJoints[e].params[1]===t?e<this._myJoints.length&&this._world.DestroyJoint(this._myJoints[e]):++s;BD.truncateArray(this._myCreatedJoints,s),s<this._myJoints.length&&BD.truncateArray(this._myJoints,s),this._joiningMe.delete(e)}GetBody(){return this._body}static LookupBehInstFromBody(e){return KD.get(e)||null}static LookupBehInstFromInst(e){return $D.get(e)||null}SaveToJson(){const e={e:this._isEnabled,im:this._isImmovable,pr:this._preventRotation,d:this._density,fr:this._friction,re:this._restitution,ld:this._linearDamping,ad:this._angularDamping,b:this._isBullet,mcj:this._myCreatedJoints};if(this._isEnabled){const t=this._body.GetLinearVelocity();e.vx=t.get_x(),e.vy=t.get_y(),e.om=this._body.GetAngularVelocity()}return e}_OnBeforeLoad(){this._DestroyMyJoints(),BD.clearArray(this._myCreatedJoints),this._joiningMe.clear()}LoadFromJson(e){this._DestroyBody(),this._isEnabled=e.e,e.hasOwnProperty("im")&&(this._isImmovable=!!e.im),this._preventRotation=e.pr,this._density=e.d,this._friction=e.fr,this._restitution=e.re,this._linearDamping=e.ld,this._angularDamping=e.ad,this._isBullet=e.b,this._myCreatedJoints=e.mcj;const t=this.GetWorldInfo();this._lastKnownX=t.GetX(),this._lastKnownY=t.GetY(),this._lastKnownAngle=t.GetAngle(),this._lastWidth=t.GetWidth(),this._lastHeight=t.GetHeight(),this._isEnabled&&(this._CreateBody(),this._body.SetLinearVelocity(nE(e.vx,e.vy)),this._body.SetAngularVelocity(e.om),0===e.vx&&0===e.vy&&0===e.om||this._body.SetAwake(!0),this._myCreatedJoints=e.mcj),this._isEnabled?this._StartTicking():this._StopTicking()}_OnAfterLoad(){this._isEnabled&&this._RecreateMyJoints()}Tick(){if(!this._isEnabled)return;const e=this._runtime,t=this.GetBehavior();let s=0;0===t.GetSteppingMode()?s=e.GetTimeScale()/60:(s=e.GetDt(this._inst),s>1/30&&(s=1/30));const n=e.GetTickCountNoSave();n>t.GetLastUpdateTick()&&e.GetTimeScale()>0&&(0!==s&&this._world.Step(s,t.GetVelocityIterations(),t.GetPositionIterations()),this._world.ClearForces(),t.SetLastUpdateTick(n)),this._UpdateBodyToMatchInstance(!0)}_UpdateBodyToMatchInstance(e){const t=this._inst.GetWorldInfo(),s=this._worldScale;(t.GetWidth()!==this._lastWidth||t.GetHeight()!==this._lastHeight||t.IsPhysicsBodyChanged())&&this._CreateBody();const n=this._body,i=t.GetX(),r=t.GetY(),a=i-this._lastKnownX,o=r-this._lastKnownY,l=Math.abs(a)>.001||Math.abs(o)>.001,c=t.GetAngle()!==this._lastKnownAngle;let h=i,_=r;if(2===this._actualCollisionMask){const e=this._GetBoundingQuadExcludingMesh();h=e.midX(),_=e.midY()}l?(c?n.SetTransform(nE(h*s,_*s),t.GetAngle()):n.SetTransform(nE(h*s,_*s),n.GetAngle()),e&&(n.SetLinearVelocity(nE(a,o)),this._lastTickOverride=!0),n.SetAwake(!0)):e&&this._lastTickOverride&&(this._lastTickOverride=!1,n.SetLinearVelocity(nE(0,0)),n.SetTransform(nE(h*s,_*s),n.GetAngle())),!l&&c&&(n.SetTransform(n.GetPosition(),t.GetAngle()),n.SetAwake(!0));const u=n.GetPosition(),d=u.get_x()/s,p=u.get_y()/s,f=n.GetAngle();if((d!==t.GetX()||p!==t.GetY()||f!==t.GetAngle())&&(t.SetXY(d,p),t.SetAngle(f),t.SetBboxChanged(),2===this._actualCollisionMask)){const e=this._GetBoundingQuadExcludingMesh(),s=e.midX()-t.GetX(),n=e.midY()-t.GetY();0===s&&0===n||(t.OffsetXY(-s,-n),t.SetBboxChanged())}this._lastKnownX=t.GetX(),this._lastKnownY=t.GetY(),this._lastKnownAngle=t.GetAngle()}GetPropertyValueByIndex(e){switch(e){case jD:return this._IsPreventRotate();case UD:return this._GetDensity();case HD:return this._GetFriction();case zD:return this._GetElasticity();case XD:return this._GetLinearDamping();case YD:return this._GetAngularDamping();case qD:return this._IsBullet();case JD:return this._IsEnabled()}}SetPropertyValueByIndex(e,t){switch(e){case jD:this._SetPreventRotate(t);break;case UD:this._SetDensity(t);break;case HD:this._SetFriction(t);break;case zD:this._SetElasticity(t);break;case XD:this._SetLinearDamping(t);break;case YD:this._SetAngularDamping(t);break;case qD:this._SetBullet(t);break;case JD:this._SetEnabled(t)}}_SetEnabled(e){e=!!e,this._isEnabled&&!e?(this._RemoveOtherInstanceJointsToMe(),this._DestroyBody(),this._isEnabled=!1,this._StopTicking()):!this._isEnabled&&e&&(this._isEnabled=!0,this._CreateBody(),this._StartTicking())}_IsEnabled(){return this._isEnabled}GetDebuggerProperties(){const e="behaviors.physics",t=[{name:e+".properties.enabled.name",value:this._IsEnabled(),onedit:e=>this._SetEnabled(e)},{name:e+".properties.immovable.name",value:this._IsImmovable(),onedit:e=>this._SetImmovable(e)},{name:e+".properties.density.name",value:this._GetDensity(),onedit:e=>this._SetDensity(e)},{name:e+".properties.friction.name",value:this._GetFriction(),onedit:e=>this._SetFriction(e)},{name:e+".properties.elasticity.name",value:this._GetElasticity(),onedit:e=>this._SetElasticity(e)},{name:e+".properties.linear-damping.name",value:this._GetLinearDamping(),onedit:e=>this._SetLinearDamping(e)},{name:e+".properties.angular-damping.name",value:this._GetAngularDamping(),onedit:e=>this._SetAngularDamping(e)}];return this._isEnabled&&(t.push({name:e+".debugger.is-sleeping",value:!this._IsAwake()}),t.push({name:e+".debugger.velocity-x",value:this._GetVelocityX(),onedit:e=>this._SetVelocity(e,this._GetVelocityY())}),t.push({name:e+".debugger.velocity-y",value:this._GetVelocityY(),onedit:e=>this._SetVelocity(this._GetVelocityX(),e)}),t.push({name:e+".debugger.angular-velocity",value:BD.toDegrees(this._GetAngularVelocity()),onedit:e=>this._SetAngularVelocity(BD.toRadians(e))}),t.push({name:e+".debugger.mass",value:this._GetMass()})),[{title:"$"+this.GetBehaviorType().GetName(),properties:t}]}_ApplyForce(e,t,s){const[n,i]=this._GetInstImagePoint(s);this._DoApplyForce(e,t,n,i)}_ApplyForceToward(e,t,s,n){const[i,r]=this._GetInstImagePoint(n),a=BD.angleTo(i,r,t,s);this._DoApplyForce(Math.cos(a)*e,Math.sin(a)*e,i,r)}_ApplyForceAtAngle(e,t,s){const[n,i]=this._GetInstImagePoint(s);this._DoApplyForce(Math.cos(t)*e,Math.sin(t)*e,n,i)}_DoApplyForce(e,t,s,n){if(!this._isEnabled)return;const i=this._worldScale;this._body.ApplyForce(nE(e,t),iE(s*i,n*i),!0)}_ApplyImpulse(e,t,s){const[n,i]=this._GetInstImagePoint(s);this._DoApplyImpulse(e,t,n,i)}_ApplyImpulseToward(e,t,s,n){const[i,r]=this._GetInstImagePoint(n),a=BD.angleTo(i,r,t,s);this._DoApplyImpulse(Math.cos(a)*e,Math.sin(a)*e,i,r)}_ApplyImpulseAtAngle(e,t,s){const[n,i]=this._GetInstImagePoint(s);this._DoApplyImpulse(Math.cos(t)*e,Math.sin(t)*e,n,i)}_DoApplyImpulse(e,t,s,n){if(!this._isEnabled)return;const i=this._worldScale;this._body.ApplyLinearImpulse(nE(e,t),iE(s*i,n*i),!0);const r=this.GetWorldInfo();this._lastKnownX=r.GetX(),this._lastKnownY=r.GetY(),this._lastTickOverride=!1}_ApplyTorque(e){this._isEnabled&&this._body.ApplyTorque(e,!0)}_ApplyTorqueToAngle(e,t){const s=BD.angleClockwise(this.GetWorldInfo().GetAngle(),t)?-1:1;this._ApplyTorque(e*s)}_ApplyTorqueToPosition(e,t,s){const n=this.GetWorldInfo(),i=BD.angleTo(n.GetX(),n.GetY(),t,s),r=BD.angleClockwise(n.GetAngle(),i)?-1:1;this._ApplyTorque(e*r)}_SetAngularVelocity(e){this._isEnabled&&(this._body.SetAngularVelocity(e),this._body.SetAwake(!0))}_GetAngularVelocity(){return this._isEnabled?this._body.GetAngularVelocity():0}_SetVelocity(e,t){if(!this._isEnabled)return;const s=this._worldScale;this._body.SetLinearVelocity(nE(e*s,t*s)),this._body.SetAwake(!0);const n=this.GetWorldInfo();this._lastKnownX=n.GetX(),this._lastKnownY=n.GetY(),this._lastTickOverride=!1}_GetVelocity(){if(!this._isEnabled)return[0,0];const e=this._worldScale,t=this._body.GetLinearVelocity();return[t.get_x()/e,t.get_y()/e]}_GetVelocityX(){return this._isEnabled?this._body.GetLinearVelocity().get_x()/this._worldScale:0}_GetVelocityY(){return this._isEnabled?this._body.GetLinearVelocity().get_y()/this._worldScale:0}_Teleport(e,t){if(!this._isEnabled)return;const s=this._worldScale;this._body.SetTransform(nE(e*s,t*s),this._body.GetAngle());const n=this.GetWorldInfo();n.SetXY(e,t),n.SetBboxChanged(),this._lastKnownX=n.GetX(),this._lastKnownY=n.GetY()}_SetDensity(e){if(this._isEnabled&&this._density!==e){this._density=e;for(const t of this._fixtures)t.SetDensity(e);this._body.ResetMassData()}}_GetDensity(){return this._isEnabled?this._density:0}_SetFriction(e){if(this._isEnabled&&this._friction!==e){this._friction=e;for(const t of this._fixtures)t.SetFriction(e);if(this._body)for(let e=this._body.GetContactList();this._box2d.getPointer(e);e=e.get_next()){const t=e.get_contact();t&&t.ResetFriction()}}}_GetFriction(){return this._isEnabled?this._friction:0}_SetElasticity(e){if(this._isEnabled&&this._restitution!==e){this._restitution=e;for(const t of this._fixtures)t.SetRestitution(e)}}_GetElasticity(){return this._isEnabled?this._restitution:0}_SetLinearDamping(e){this._isEnabled&&this._linearDamping!==e&&(this._linearDamping=e,this._body.SetLinearDamping(e))}_GetLinearDamping(){return this._isEnabled?this._linearDamping:0}_SetAngularDamping(e){this._isEnabled&&this._angularDamping!==e&&(this._angularDamping=e,this._body.SetAngularDamping(e))}_GetAngularDamping(){return this._isEnabled?this._angularDamping:0}_SetImmovable(e){this._isEnabled&&(e=!!e,this._isImmovable!==e&&(this._isImmovable=e,this._body.SetType(this._isImmovable?0:2),this._body.SetAwake(!0)))}_IsImmovable(){return this._isImmovable}_SetPreventRotate(e){this._isEnabled&&(e=!!e,this._preventRotation!==e&&(this._preventRotation=e,this._body.SetFixedRotation(this._preventRotation),this._body.SetAngularVelocity(0),this._body.SetAwake(!0)))}_IsPreventRotate(){return this._preventRotation}_SetBullet(e){this._isEnabled&&(e=!!e,this._isBullet!==e&&(this._isBullet=e,this._body.SetBullet(this._isBullet),this._body.SetAwake(!0)))}_IsBullet(){return this._isBullet}_SetAwake(e){this._isEnabled&&this._body.SetAwake(!!e)}_IsAwake(){return!!this._isEnabled&&this._body.IsAwake()}_GetMass(){return this._isEnabled?this._body.GetMass()/this._worldScale:0}_GetCenterOfMassX(){return this._isEnabled?this._body.GetWorldCenter().get_x()/this._worldScale:0}_GetCenterOfMassY(){return this._isEnabled?this._body.GetWorldCenter().get_y()/this._worldScale:0}_GetCenterOfMass(){if(!this._isEnabled)return[0,0];const e=this._body.GetWorldCenter(),t=this._worldScale;return[e.get_x()/t,e.get_y()/t]}_GetContactCount(){if(!this._isEnabled)return 0;let e=0;for(let t=this._body.GetContactList();this._box2d.getPointer(t);t=t.get_next()){const s=t.get_contact();s&&(e+=s.GetManifold().get_pointCount())}return e}_GetContactPositionAt(e){if(e=Math.floor(e),!this._isEnabled)return[0,0];let t=0;for(let s=this._body.GetContactList();this._box2d.getPointer(s);s=s.get_next()){const n=s.get_contact();if(!n)continue;const i=n.GetManifold().get_pointCount();if(e>=t&&e<t+i){const s=e-t,i=this.GetBehavior().GetWorldManifold();n.GetWorldManifold(i);const r=i.get_points(s);return[r.get_x()/this._worldScale,r.get_y()/this._worldScale]}t+=i}return[0,0]}GetScriptInterfaceClass(){return self.IPhysicsBehaviorInstance}};const oE=new WeakMap;self.IPhysicsBehaviorInstance=class extends ND{constructor(){super(),oE.set(this,ND._GetInitInst().GetSdkInstance())}get isEnabled(){return oE.get(this)._IsEnabled()}set isEnabled(e){oE.get(this)._SetEnabled(e)}applyForce(e,t,s=0){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),oE.get(this)._ApplyForce(e,t,s)}applyForceTowardPosition(e,t,s,n=0){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),OD.RequireFiniteNumber(s),oE.get(this)._ApplyForceToward(e,t,s,n)}applyForceAtAngle(e,t,s=0){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),oE.get(this)._ApplyForceAtAngle(e,t,s)}applyImpulse(e,t,s=0){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),oE.get(this)._ApplyImpulse(e,t,s)}applyImpulseTowardPosition(e,t,s,n=0){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),OD.RequireFiniteNumber(s),oE.get(this)._ApplyImpulseToward(e,t,s,n)}applyImpulseAtAngle(e,t,s=0){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),oE.get(this)._ApplyImpulseAtAngle(e,t,s)}applyTorque(e){OD.RequireFiniteNumber(e),oE.get(this)._ApplyTorque(e)}applyTorqueToAngle(e,t){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),oE.get(this)._ApplyTorqueToAngle(e,t)}applyTorqueToPosition(e,t,s){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),OD.RequireFiniteNumber(s),oE.get(this)._ApplyTorqueToPosition(e,t,s)}set angularVelocity(e){OD.RequireFiniteNumber(e),oE.get(this)._SetAngularVelocity(e)}get angularVelocity(){return oE.get(this)._GetAngularVelocity()}setVelocity(e,t){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),oE.get(this)._SetVelocity(e,t)}getVelocityX(){return oE.get(this)._GetVelocityX()}getVelocityY(){return oE.get(this)._GetVelocityY()}getVelocity(){return oE.get(this)._GetVelocity()}teleport(e,t){OD.RequireFiniteNumber(e),OD.RequireFiniteNumber(t),oE.get(this)._Teleport(e,t)}set density(e){OD.RequireFiniteNumber(e),oE.get(this)._SetDensity(e)}get density(){return oE.get(this)._GetDensity()}set friction(e){OD.RequireFiniteNumber(e),oE.get(this)._SetFriction(e)}get friction(){return oE.get(this)._GetFriction()}set elasticity(e){OD.RequireFiniteNumber(e),oE.get(this)._SetElasticity(e)}get elasticity(){return oE.get(this)._GetElasticity()}set linearDamping(e){OD.RequireFiniteNumber(e),oE.get(this)._SetLinearDamping(e)}get linearDamping(){return oE.get(this)._GetLinearDamping()}set angularDamping(e){OD.RequireFiniteNumber(e),oE.get(this)._SetAngularDamping(e)}get angularDamping(){return oE.get(this)._GetAngularDamping()}set isImmovable(e){oE.get(this)._SetImmovable(e)}get isImmovable(){return oE.get(this)._IsImmovable()}set isPreventRotation(e){oE.get(this)._SetPreventRotate(e)}get isPreventRotation(){return oE.get(this)._IsPreventRotate()}set isBullet(e){oE.get(this)._SetBullet(e)}get isBullet(){return oE.get(this)._IsBullet()}get mass(){return oE.get(this)._GetMass()}getCenterOfMassX(){return oE.get(this)._GetCenterOfMassX()}getCenterOfMassY(){return oE.get(this)._GetCenterOfMassY()}getCenterOfMass(){return oE.get(this)._GetCenterOfMass()}getContactCount(){return oE.get(this)._GetContactCount()}getContactX(e){return OD.RequireFiniteNumber(e),oE.get(this)._GetContactPositionAt(e)[0]}getContactY(e){return OD.RequireFiniteNumber(e),oE.get(this)._GetContactPositionAt(e)[1]}getContact(e){return OD.RequireFiniteNumber(e),oE.get(this)._GetContactPositionAt(e)}set isAwake(e){oE.get(this)._SetAwake(!!e)}get isAwake(){return oE.get(this)._IsAwake()}get isSleeping(){return!oE.get(this)._IsAwake()}createDistanceJoint(e,t,s,n,i){OD.RequireFiniteNumber(n),OD.RequireFiniteNumber(i);const r=FD(this,t);oE.get(this)._CreateDistanceJoint(e,r,s,n,i)}createRevoluteJoint(e,t){const s=FD(this,t);oE.get(this)._CreateRevoluteJoint(e,s)}createLimitedRevoluteJoint(e,t,s,n){OD.RequireFiniteNumber(s),OD.RequireFiniteNumber(n);const i=FD(this,t);oE.get(this)._CreateLimitedRevoluteJoint(e,i,s,n)}createPrismaticJoint(e,t,s,n,i,r,a,o,l){const c=FD(this,t);oE.get(this)._CreatePrismaticJoint(e,c,s,n,i,r,a,o,l)}removeAllJoints(){oE.get(this)._RemoveJoints()}}}{const lE=self.C3;lE.Behaviors.Physics.Cnds={IsSleeping(){return!this._IsAwake()},IsImmovable(){return this._IsImmovable()},CompareVelocity(e,t,s){if(!this._isEnabled)return!1;let n=0;if(0===e)n=this._GetVelocityX();else if(1===e)n=this._GetVelocityY();else{const[e,t]=this._GetVelocity();n=Math.hypot(e,t)}return lE.compare(n,t,s)},CompareAngularVelocity(e,t){if(!this._isEnabled)return!1;const s=lE.toDegrees(this._GetAngularVelocity());return lE.compare(s,e,t)},CompareMass(e,t){if(!this._isEnabled)return!1;const s=this._GetMass();return lE.compare(s,e,t)},IsEnabled(){return this._IsEnabled()}}}{const cE=self.C3;cE.Behaviors.Physics.Acts={ApplyForce(e,t,s){this._ApplyForce(e,t,s)},ApplyForceToward(e,t,s,n){this._ApplyForceToward(e,t,s,n)},ApplyForceAtAngle(e,t,s){this._ApplyForceAtAngle(e,cE.toRadians(t),s)},ApplyImpulse(e,t,s){this._ApplyImpulse(e,t,s)},ApplyImpulseToward(e,t,s,n){this._ApplyImpulseToward(e,t,s,n)},ApplyImpulseAtAngle(e,t,s){this._ApplyImpulseAtAngle(e,cE.toRadians(t),s)},ApplyTorque(e){this._ApplyTorque(cE.toRadians(e))},ApplyTorqueToAngle(e,t){this._ApplyTorqueToAngle(cE.toRadians(e),cE.toRadians(t))},ApplyTorqueToPosition(e,t,s){this._ApplyTorqueToPosition(cE.toRadians(e),t,s)},SetAngularVelocity(e){this._SetAngularVelocity(cE.toRadians(e))},CreateDistanceJoint(e,t,s,n,i){if(!t)return;const r=t.GetFirstPicked(this._inst);this._CreateDistanceJoint(e,r,s,n,i)},CreateRevoluteJoint(e,t){if(!t)return;const s=t.GetFirstPicked(this._inst);this._CreateRevoluteJoint(e,s)},CreateLimitedRevoluteJoint(e,t,s,n){if(!t)return;const i=t.GetFirstPicked(this._inst);this._CreateLimitedRevoluteJoint(e,i,cE.toRadians(s),cE.toRadians(n))},CreatePrismaticJoint(e,t,s,n,i,r,a,o,l){if(!t)return;const c=t.GetFirstPicked(this._inst);this._CreatePrismaticJoint(e,c,cE.toRadians(s),n,i,r,a,cE.toRadians(o),l)},RemoveJoints(){this._RemoveJoints()},SetWorldGravity(e){this.GetBehavior().SetGravity(e)},SetSteppingMode(e){this.GetBehavior().SetSteppingMode(e)},SetIterations(e,t){this.GetBehavior().SetIterations(e,t)},SetVelocity(e,t){this._SetVelocity(e,t)},Teleport(e,t){this._Teleport(e,t)},SetDensity(e){this._SetDensity(e)},SetFriction(e){this._SetFriction(e)},SetElasticity(e){this._SetElasticity(e)},SetLinearDamping(e){this._SetLinearDamping(e)},SetAngularDamping(e){this._SetAngularDamping(e)},SetImmovable(e){this._SetImmovable(e)},EnableCollisions(e,t){this.GetBehavior().SetCollisionsEnabled(this.GetObjectClass(),e,0!==t)},SetPreventRotate(e){this._SetPreventRotate(0!==e)},SetBullet(e){this._SetBullet(0!==e)},SetAwake(e){this._SetAwake(!!e)},SetEnabled(e){this._SetEnabled(0!==e)}}}{const hE=self.C3;hE.Behaviors.Physics.Exps={VelocityX(){return this._GetVelocityX()},VelocityY(){return this._GetVelocityY()},AngularVelocity(){return hE.toDegrees(this._GetAngularVelocity())},Mass(){return this._GetMass()},CenterOfMassX(){return this._GetCenterOfMassX()},CenterOfMassY(){return this._GetCenterOfMassY()},Density(){return this._GetDensity()},Friction(){return this._GetFriction()},Elasticity(){return this._GetElasticity()},LinearDamping(){return this._GetLinearDamping()},AngularDamping(){return this._GetAngularDamping()},ContactCount(){return this._GetContactCount()},ContactXAt(e){return this._GetContactPositionAt(e)[0]},ContactYAt(e){return this._GetContactPositionAt(e)[1]}}}{let _E=function(e){return mE(e.get_x(),e.get_y())},uE=function(e){const t=[];for(const s of e)s.length<=8?t.push(s):t.push.apply(t,dE(s));return t},dE=function(e){const t=[];t.push(e.splice(0,8));const s=t[0][0];let n=t[0][7];for(;e.length;){const i=e.splice(0,Math.min(e.length,6));let r=i.at(-1);i.push(_E(s)),i.push(_E(n)),t.push(i),n=r}return t};CloneVec2=_E,SplitConvexPolysOver8Points=uE,SplitConvexPoly=dE;const pE=self.C3,fE={};pE.Behaviors.Physics.Separator=fE;const mE=pE.Behaviors.Physics.GetVec2,gE=pE.Behaviors.Physics.FreeVec2;fE.det=function(e,t,s,n,i,r){return e*n+s*r+i*t-t*s-n*i-r*e},fE.hitRay=function(e,t,s,n,i,r,a,o){const l=s-e,c=n-t,h=a-i,_=o-r,u=(h*(r-t)-_*(i-e))/(c*h-l*_),d=e+u*l,p=t+u*c,f=fE.isOnSegment(s,n,e,t,d,p),m=fE.isOnSegment(d,p,i,r,a,o);return f&&m?mE(d,p):null},fE.isOnSegment=function(e,t,s,n,i,r){return(s+.1>=e&&e>=i-.1||s-.1<=e&&e<=i+.1)&&(n+.1>=t&&t>=r-.1||n-.1<=t&&t<=r+.1)&&fE.isOnLine(e,t,s,n,i,r)},fE.isOnLine=function(e,t,s,n,i,r){if(Math.abs(i-s)>.1){const a=(r-n)/(i-s)*(e-s)+n;return Math.abs(a-t)<.1}return Math.abs(e-s)<.1},fE.pointsMatch=function(e,t,s,n){return Math.abs(s-e)<.1&&Math.abs(n-t)<.1},fE.Separate=function(e,t){if(3===e.length)return[e.map((e=>mE(e.get_x(),e.get_y())))];const s=fE.calcShapes(e);let n=[];for(let e=0,i=s.length;e<i;++e){const i=s[e],r=[];let a=0;for(let e=0,t=i.length;e<t;++e){const s=i[e],n=i[(e+1)%t];a+=s.get_x()*n.get_y()-s.get_y()*n.get_x(),r.push(mE(s.get_x(),s.get_y()))}if(a=Math.abs(a/2),a>=.001*t)n.push(r);else for(let e=0,t=r.length;e<t;e++)gE(r[e])}return n=uE(n),n},fE.calcShapes=function(e){let t,s,n,i,r,a,o,l=[],c=0,h=0,_=0,u=0,d=0,p=0,f=0,m=0,g=0,I=0,S=0,y=0,b=0,G=0,v=0,x=[],T=[],C=!1,w=[],P=[],A=!1;for(P.push(e);P.length;){for(l=P[0],h=l.length,C=!0,c=0;c<h;c++)if(g=c,I=c<h-1?c+1:c+1-h,S=c<h-2?c+2:c+2-h,t=l[g],s=l[I],n=l[S],u=fE.det(t.get_x(),t.get_y(),s.get_x(),s.get_y(),n.get_x(),n.get_y()),u<0){for(C=!1,m=1e9,_=0;_<h;_++)_!==g&&_!==I&&(y=_,b=_<h-1?_+1:0,i=l[y],r=l[b],a=fE.hitRay(t.get_x(),t.get_y(),s.get_x(),s.get_y(),i.get_x(),i.get_y(),r.get_x(),r.get_y()),a&&(p=s.get_x()-a.get_x(),f=s.get_y()-a.get_y(),d=p*p+f*f,d<m?(v=y,G=b,o=a,m=d):gE(a)));if(1e9===m)return[];for(x=[],T=[],y=v,b=G,i=l[y],r=l[b],A=!1,fE.pointsMatch(o.get_x(),o.get_y(),r.get_x(),r.get_y())||(x.push(o),A=!0),fE.pointsMatch(o.get_x(),o.get_y(),i.get_x(),i.get_y())||(T.push(o),A=!0),A||gE(o),v=-1,G=g;;){if(G===b){if(v<0||v>=h)return[];fE.isOnSegment(r.get_x(),r.get_y(),l[v].get_x(),l[v].get_y(),t.get_x(),t.get_y())||x.push(l[G]);break}x.push(l[G]),v=G,G-1<0?G=h-1:G--}for(x.reverse(),v=-1,G=I;;){if(G===y){if(v<0||v>=h)return[];G!==y||fE.isOnSegment(i.get_x(),i.get_y(),l[v].get_x(),l[v].get_y(),s.get_x(),s.get_y())||T.push(l[G]);break}T.push(l[G]),v=G,G+1>h-1?G=0:G++}P.push(x,T),P.shift();break}C&&w.push(P.shift())}return w}}{const IE=self.C3;IE.Behaviors.solid=class extends IE.SDKBehaviorBase{constructor(e){super(e)}Release(){super.Release()}}}{const SE=self.C3;SE.Behaviors.solid.Type=class extends SE.SDKBehaviorTypeBase{constructor(e){super(e)}Release(){super.Release()}OnCreate(){}}}{const yE=self.C3,bE=self.C3X,GE=self.IBehaviorInstance,vE=0,xE=1,TE=new Set;yE.Behaviors.solid.Instance=class extends yE.SDKBehaviorInstanceBase{constructor(e,t){super(e),this.SetEnabled(!0),t&&(this.SetEnabled(t[vE]),this.SetTags(t[xE]))}Release(){super.Release()}SetEnabled(e){this._inst._SetSolidEnabled(!!e)}IsEnabled(){return this._inst._IsSolidEnabled()}SetTags(e){const t=this._inst.GetSavedDataMap();if(!e.trim())return void t.delete("solidTags");let s=t.get("solidTags");s||(s=new Set,t.set("solidTags",s)),s.clear();for(const t of e.split(" "))t&&s.add(t.toLowerCase())}GetTags(){return this._inst.GetSavedDataMap().get("solidTags")||TE}_GetTagsString(){return[...this.GetTags()].join(" ")}SaveToJson(){return{e:this.IsEnabled()}}LoadFromJson(e){this.SetEnabled(e.e)}GetPropertyValueByIndex(e){if(e===vE)return this.IsEnabled()}SetPropertyValueByIndex(e,t){e===vE&&this.SetEnabled(t)}GetDebuggerProperties(){return[{title:"$"+this.GetBehaviorType().GetName(),properties:[{name:"behaviors.solid.properties.enabled.name",value:this.IsEnabled(),onedit:e=>this.SetEnabled(e)},{name:"behaviors.solid.properties.tags.name",value:this._GetTagsString(),onedit:e=>this.SetTags(e)}]}]}GetScriptInterfaceClass(){return self.ISolidBehaviorInstance}};const CE=new WeakMap;self.ISolidBehaviorInstance=class extends GE{constructor(){super(),CE.set(this,GE._GetInitInst().GetSdkInstance())}set isEnabled(e){CE.get(this).SetEnabled(!!e)}get isEnabled(){return CE.get(this).IsEnabled()}set tags(e){bE.RequireString(e),CE.get(this).SetTags(e)}get tags(){return CE.get(this)._GetTagsString()}}}self.C3.Behaviors.solid.Cnds={IsEnabled(){return this.IsEnabled()}},self.C3.Behaviors.solid.Acts={SetEnabled(e){this.SetEnabled(e)},SetTags(e){this.SetTags(e)}},self.C3.Behaviors.solid.Exps={};{let wE=function(e){return"number"==typeof e?-e:e},PE=function(e,t){return"number"==typeof e&&"number"==typeof t},AE=function(e,t){return PE(e,t)?e+t:e},RE=function(e,t){return PE(e,t)?e-t:e},DE=function(e,t){return PE(e,t)?e*t:e},EE=function(e,t){return PE(e,t)?e/t:e},ME=function(e,t){return PE(e,t)?e%t:e},kE=function(e,t){return PE(e,t)?Math.pow(e,t):e},LE=function(e,t){if("string"==typeof e||"string"==typeof t){let s,n;return s="number"==typeof e?(Math.round(1e10*e)/1e10).toString():e,n="number"==typeof t?(Math.round(1e10*t)/1e10).toString():t,s+n}return e&&t?1:0},FE=function(e,t){return PE(e,t)?e||t?1:0:e};unaryminus=wE,bothNumbers=PE,add=AE,subtract=RE,multiply=DE,divide=EE,mod=ME,pow=kE,and=LE,or=FE;const BE=self.C3;self.C3_ExpressionFuncs=[()=>"ButtonClick",e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>LE("Level",t.ExpObject(s.GetValue()))},()=>"Basic",()=>0,e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>LE(LE(t.ExpObject("LEVEL_TITLE")," "),s.GetValue())},()=>"black",()=>"game",e=>{const t=e._GetNode(0).GetVar();return()=>LE("+",t.GetValue())},e=>{const t=e._GetNode(0);return()=>t.ExpObject("coins")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject())},()=>60,()=>14,()=>38,()=>16,()=>18,()=>68,()=>10,()=>34,()=>12,()=>"Functions",()=>"coins",e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>AE(t.ExpObject("coins"),s.GetValue())},()=>"gamedata",e=>{const t=e._GetNode(0);return()=>t.ExpObject()},()=>"getcoins",()=>1,()=>"poki commercial",e=>{const t=e._GetNode(0);return()=>t.ExpObject("level")},()=>"level",e=>{const t=e._GetNode(0).GetVar();return()=>t.GetValue()},()=>.5,()=>"ui",()=>375,()=>600,()=>"",()=>"tick",()=>"Fail",()=>"array_skipped",()=>"music",()=>"sound",()=>"type",e=>{const t=e._GetNode(0);return()=>t.ExpObject("SETTINGS_TITLE")},e=>{const t=e._GetNode(0);return()=>t.ExpObject("LEVEL_END_FAIL")},e=>{const t=e._GetNode(0);return()=>t.ExpObject("LEVEL_END_RESTART")},e=>{const t=e._GetNode(0);return()=>t.ExpObject("LEVEL_END_WON")},e=>{const t=e._GetNode(0);return()=>t.ExpObject("WATCH_VIDEO_BUTTON")},e=>{const t=e._GetNode(0);return()=>t.ExpObject("WATCH_VIDEO_TITLE")},e=>{const t=e._GetNode(0);return()=>t.ExpInstVar()},()=>"SOUND",e=>{const t=e._GetNode(0);return()=>t.ExpObject("SETTINGS_SOUND")},()=>"MUSIC",e=>{const t=e._GetNode(0);return()=>t.ExpObject("_SETTINGS_MUSIC")},()=>"LANGUAGE",e=>{const t=e._GetNode(0);return()=>t.ExpObject("SETTINGS_LANGUAGE")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetVar();return()=>t(s.GetValue(),"{0}",n.GetValue())},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetVar();return()=>t.ExpObject(LE("LEVEL_TEXT_",s.ExpObject(n.GetValue(),0,0)))},()=>"0",e=>{const t=e._GetNode(0);return()=>t.ExpObject("LEVEL_TEXT_0")},()=>360,()=>-2240,()=>640,()=>"hint",e=>{const t=e._GetNode(0);return()=>t.ExpObject("UNLOCK_HINT")},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2),i=e._GetNode(3).GetVar();return()=>t.ExpObject(LE("HINT_",s(n.ExpObject(i.GetValue(),0,0)))+"_1")},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2),i=e._GetNode(3).GetVar();return()=>t.ExpObject(LE("HINT_",s(n.ExpObject(i.GetValue(),0,0)))+"_2")},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2),i=e._GetNode(3).GetVar();return()=>t.ExpObject(LE("HINT_",s(n.ExpObject(i.GetValue(),0,0)))+"_3")},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2),i=e._GetNode(3).GetVar();return()=>t.ExpObject(LE("HINT_",s(n.ExpObject(i.GetValue(),0,0)))+"_4")},e=>{const t=e._GetNode(0).GetVar();return()=>LE(t.GetValue(),"_1")},e=>{const t=e._GetNode(0).GetVar();return()=>LE(t.GetValue(),"_2")},e=>{const t=e._GetNode(0).GetVar();return()=>LE(t.GetValue(),"_3")},e=>{const t=e._GetNode(0).GetVar();return()=>LE(t.GetValue(),"_4")},e=>{const t=e._GetNode(0);return()=>t.ExpInstVar_Family()},e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetBoundMethod();return()=>LE(LE(t.GetValue(),"_"),s())},()=>25,e=>{const t=e._GetNode(0);return()=>RE(t.ExpObject("coins"),25)},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t()},()=>.2,()=>2,()=>3,()=>4,()=>"touch",()=>40,()=>570,()=>-1327,()=>"watchvideo",()=>3209,()=>"gameStart",()=>"settings",()=>"language",()=>"ru",()=>24,e=>{const t=e._GetNode(0).GetVar();return()=>"CurrentLayout :"+t.GetValue()},()=>"Start",()=>853,e=>{const t=e._GetNode(0).GetVar();return()=>LE("level : ",t.GetValue())},()=>621,()=>682,()=>"home",()=>"watchvideo2",()=>140,()=>363,()=>633,()=>373,()=>279,()=>828,()=>7,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+10},()=>26,e=>{const t=e._GetNode(0).GetVar();return()=>LE("videoOfferOpen :",t.GetValue())},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-10},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetBoundMethod();return()=>t(s(),"Chrome")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetBoundMethod();return()=>t(s(),"Safari")},()=>-1,e=>{const t=e._GetNode(0);return()=>t.ExpObject("EXTRA_100_1")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject("EXTRA_100_2"),2)},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1),n=e._GetNode(2).GetBoundMethod(),i=e._GetNode(3);return()=>t(s.ExpObject("EXTRA_100_2"),n(i.ExpObject("EXTRA_100_2"))-2)},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"100")},()=>535,()=>220,()=>44,()=>61,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"100","1")},()=>785,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+7},()=>5,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"<alpha=#00>","")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"</color>","")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"100","     ")},()=>335,()=>.7,()=>339,()=>"balltween",()=>789,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject("language"),2)},()=>"tr",()=>286.7,()=>234.628,()=>"es",()=>493.33,()=>236.746,()=>"en",()=>464.56,()=>234.015,()=>"pt",()=>335.079,()=>235.144,()=>"pl",()=>462.89,()=>236.36,()=>"it",()=>385.98,()=>235.87,()=>"de",()=>412.65,()=>213.029,()=>"id",()=>254.13,()=>253.13,()=>"ms",()=>390.088357,()=>269.563918,()=>543.156,()=>236.99,()=>"ja",()=>467.46,()=>211.486,()=>"ko",()=>294.71,()=>219.59,()=>"th",()=>424.47,()=>234.67,()=>"vi",()=>527.03,()=>234.098,()=>"ar",()=>173.62,()=>238,()=>"hu",()=>269.2,()=>235.09,()=>"ro",()=>233.98,()=>252.96,()=>"zh",()=>330.068,()=>232.69,()=>610,()=>247,()=>-47863786876927,()=>1.4,()=>"100",()=>345,()=>862,()=>357,()=>"mill",()=>379,()=>851,()=>135,()=>674,()=>355,()=>.6,()=>11,()=>1.5,()=>612,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(420,650)},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(500,600)},()=>191,()=>826,()=>"canPush",()=>185,()=>822,()=>"last",()=>.3,()=>280,()=>791,()=>333,()=>200,()=>"count",e=>{const t=e._GetNode(0);return()=>AE(t.ExpObject("count"),1)},()=>768,e=>{const t=e._GetNode(0);return()=>LE("",t.ExpInstVar_Family())},()=>"back",e=>{const t=e._GetNode(0);return()=>RE(t.ExpObject("count"),1)},()=>212,()=>687,e=>{const t=e._GetNode(0);return()=>t.ExpObject("EXTRA_107_1")},()=>730,()=>282,()=>440,()=>512,()=>656,()=>353,()=>2e3,()=>1e3,()=>670,()=>830,()=>580,e=>{const t=e._GetNode(0);return()=>t.ExpInstVar()+1},()=>"Lily Wuhuhu",()=>"i",()=>9,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t("i")},()=>8,()=>"fr",()=>"cs",()=>6,()=>341,()=>574,()=>374,()=>595,()=>389,()=>306,()=>410,()=>320,()=>354,()=>390,()=>424,()=>319,()=>334,()=>370,()=>404,()=>"N",()=>"E",()=>"C",()=>"U",()=>"A",()=>"L",()=>"Q",()=>"W",()=>"S",()=>"G",()=>"D",()=>"Z",()=>"I",()=>"P",()=>"M",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"",()=>"rusca yes",()=>"rusca no",()=>"",()=>"",()=>"",()=>"",()=>"R",()=>"H",()=>"T",()=>"O",()=>"",()=>683,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+30},()=>270,()=>178,()=>788,()=>613,()=>147,()=>"GoClothes",()=>230,()=>546,()=>30.6,()=>"5",()=>1.1,()=>123,()=>992,()=>993,()=>691,()=>337,()=>872,()=>695,()=>1.05,()=>368,()=>696,()=>432,()=>927,()=>.9,()=>"151donut fall",()=>"Bobba shocked",()=>469,()=>951,()=>1.2,()=>"Lily - bilmis gulus AHA!",()=>500,()=>547,()=>103,()=>638,()=>625,()=>770,()=>"43_ bobba angry",()=>"Lily - scared",()=>550,()=>"26 - eat",()=>519,()=>606,()=>35,()=>21,()=>"26 - burb",()=>188,()=>197,()=>180,()=>189,()=>722,()=>.4,()=>"Lily - kikirdeme",()=>"Shift kolu",()=>120.1,()=>.8,()=>671,()=>75,()=>267,()=>977,()=>286,()=>990,()=>285,()=>296,()=>908,()=>274,()=>231.3,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+1},()=>604,()=>557,()=>577,()=>232,()=>145,()=>"BobbaEyesTween",()=>"Bobba_very_hungry",()=>"Bobba laugh 2",()=>"8",()=>388.6924982070923,()=>277.1710014343262,()=>292.3933140039444,()=>284.3163642883301,()=>183.5043182373047,()=>282.18798828125,()=>155,()=>1.02,()=>352,()=>49.6,()=>305.4,()=>483,()=>675,()=>26.6,()=>487,()=>666,()=>90,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-35},()=>350,()=>405,()=>762,()=>1.03,()=>"Rotate",()=>111,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+2},()=>340,()=>648,()=>420,()=>725,()=>207.7,()=>-33,()=>66,()=>821,()=>275.5,()=>399,()=>847,()=>240,()=>769,()=>-54,()=>55,()=>120,()=>773,()=>380,()=>760,()=>935,()=>45,()=>402,()=>835,()=>582,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-50},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-7},()=>286.9,()=>311.3,()=>121.538755,()=>831.539174,()=>630,()=>866,()=>748,()=>192.3,()=>879,()=>"Turn",e=>{const t=e._GetNode(0);return()=>t.ExpObject()-180},()=>565,()=>944,()=>"Turn2",e=>{const t=e._GetNode(0);return()=>t.ExpObject()+535},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+3},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+200},()=>"Cicek acarken",()=>250,()=>"Lily Yaay!",()=>"Appear Uzun",()=>820,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"<alpha=000>","")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"1000"," 000")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"1.000"," 000")},()=>322.046,()=>273.12,()=>"de",()=>581.97,()=>233.47,()=>"Pagar",()=>149.01,()=>275.04,()=>"Payer",()=>169.262996,()=>273.994569,()=>"Pay",()=>321.3,()=>264.35,()=>487.284053,()=>283.030177,()=>"Zapa",()=>455.64,()=>263.16,()=>"Paga",()=>566.78,()=>232.56,()=>"Zahle",()=>"Bayar",()=>541.93,()=>264,()=>"",()=>83.81,()=>273.57,()=>"",()=>358.35,()=>264.032,()=>"",()=>345.02,()=>274.53,()=>"",()=>109.18,()=>274.25,()=>"Tr",()=>108.96,()=>214.82,()=>274.17,()=>"",()=>461.29,()=>262.69,()=>"Fizets",()=>497.41,()=>274.02,()=>"Pltete",()=>"cz",()=>56.09,()=>273.9,()=>"Zaplatit",()=>216.01,()=>273.72,()=>"",()=>213,()=>"Hayrettin Fahrettin Nizamettin Hepcivanolu",()=>"Agathon Imogne Saint-Bernard Nvrose",()=>"Tangorino Federico Machiaviello Ravioli",()=>"Innocenty Bartolomeo Kalasanty Ros",()=>"Girolamo Serbelloni Antani Prematurato",()=>"Jiewa Ghisau Haetikue Morono",()=>"  ",()=>"jp",()=>"   ",()=>"    ",()=>"\n\n",()=>"Bc S Bo Suy Ngh Nhiu D Mc Bnh Lo u",()=>"Dontworry Go To Campus",()=>"   ",()=>"Megyek-Brmi ron Elemr",()=>"Decebal Traian Gelu Menumorut",()=>"cn",()=>"",()=>"7",()=>960,()=>307,()=>331,()=>309,()=>465,()=>478,()=>76.9,()=>490,()=>92.8,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+1.5},()=>516,()=>742,()=>248,()=>721,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(550,600)},()=>940,()=>506,()=>776,()=>356,()=>532,()=>711,()=>564,()=>754,()=>305,()=>"GoFinger",e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(0)},()=>"GoBack",()=>466,()=>403,()=>372.2,()=>608.8,()=>543.6154549540006,()=>606.7319883570242,()=>308,()=>254,()=>347,()=>13,()=>.1,()=>"XScaled",()=>-90,()=>"YScaled",()=>92,()=>631,()=>703,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>90*Math.round(t(0)/90)},()=>1.3,()=>342,()=>"tiki_sing",()=>236,()=>743,()=>343.6,()=>355.7,()=>707.47,()=>294.6,()=>733.4,()=>358.7,()=>217.9,()=>707,()=>328,()=>"FallLeft",()=>20,()=>"FallRight",e=>{const t=e._GetNode(0);return()=>"bubbleText : "+t.ExpObject()},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-60},()=>464.9,()=>676.12,()=>348,()=>697,()=>575,()=>688,()=>"Kedi Miyavlama",e=>{const t=e._GetNode(0);return()=>t.ExpInstVar_Family()+1},e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>t.ExpObject()-s.ExpObject()},()=>510,()=>485,()=>684,()=>141,()=>223,()=>192.803622,()=>706.265764,()=>359.3,()=>-80,()=>343,()=>257,()=>865,()=>-25,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+32},()=>750,()=>"WhiteCat",()=>119,()=>52,()=>"Angry1",()=>"Angry2",()=>"Angry3",e=>{const t=e._GetNode(0);return()=>t.ExpObject()+.3},()=>917,()=>1.6,()=>607.6,()=>697.7,()=>850,()=>"Snake",()=>388.16,()=>830.6,()=>52.8,()=>"Snake2",()=>15,()=>-1412,()=>"StretchPicture",()=>594,()=>710,()=>252.2,()=>962.5,()=>290.2,()=>954.1,()=>229.2,()=>895.2,()=>271.9,()=>883.1,()=>278.6,()=>996.5,()=>765,()=>690,()=>-22,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(1)},()=>883,()=>"cardown",()=>524,()=>912,()=>"carforward",()=>242,()=>193,()=>2.5,e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod();return()=>t.ExpObject()+250*s()},()=>1848,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-4600},()=>332,()=>344,()=>"Shake",e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>t.ExpObject()+s.ExpObject()/2},()=>190,()=>1040,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"ate","       ")},()=>"ate",()=>429.32,()=>240.25,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"encender","               ")},()=>"encender",()=>425,()=>218.82,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"encender","                  ")},()=>106.8,()=>259.41,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"zapali","           ")},()=>"zapali",()=>356.69,()=>239.778,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"Allumez","           ")},()=>"Allumez",()=>417.61,()=>218.57,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"luce","       ")},()=>"luce",()=>234.4,()=>219.95,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"Licht","         ")},()=>"Licht",()=>169.47,()=>260.98,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"api","       ")},()=>"api",()=>224.35,()=>259.204,()=>"my",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"nyalakan","           ")},()=>"nyalakan",()=>434,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"light","       ")},()=>"light",()=>431.38,()=>219.68,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"","                     ")},()=>288,()=>"",()=>213.186,()=>219.778,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"","       ")},()=>"",()=>251,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"","      ")},()=>"",()=>164.12,()=>258.184,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"","        ")},()=>"",()=>132.03,()=>259.79,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"thp","        ")},()=>"thp",()=>317.1,()=>219.749,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"","          ")},()=>"",()=>99.65,()=>222.887,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"fny","        ")},()=>"fny",()=>454.998,()=>220.338,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"aprind","          ")},()=>"aprind",()=>142.78,()=>258.765,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"","      ")},()=>"",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject(),"Zaplit","           ")},()=>"Zaplit",()=>372.58,()=>240.205,()=>"milk",()=>100,()=>160,()=>70,()=>80,()=>537,()=>718,()=>715,()=>"angle",()=>545,()=>605,()=>543,()=>759,()=>706,()=>598,()=>"wave",()=>165,()=>-45,()=>225,()=>175,e=>{const t=e._GetNode(0);return()=>LE("bobba : ",t.ExpObject())},()=>170,()=>69,()=>-50,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+50},()=>"up",e=>{const t=e._GetNode(0);return()=>t.ExpObject()-75},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-3},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+75},()=>920,()=>"robot",()=>590,()=>3.5,()=>"fake",()=>4.5,()=>"isGameEnd",()=>293,()=>395,()=>297,()=>427,()=>50,()=>448,()=>858,e=>{const t=e._GetNode(0);return()=>t.ExpObject("EXTRA_67_1")},()=>300,()=>790,()=>801,()=>291,()=>377,()=>782,()=>322,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+40},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+15},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-15},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-5},()=>-30,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+5},()=>276,()=>259,()=>894,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-30},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-65},()=>87.4,()=>678,()=>127,()=>632,()=>497,()=>492,()=>569,()=>629,()=>672,e=>{const t=e._GetNode(0);return()=>.5+.1*t.ExpInstVar()},()=>800,()=>"moon",()=>400,()=>"gray",()=>"sun",e=>{const t=e._GetNode(0);return()=>.5+.25*t.ExpInstVar()},()=>1009,()=>49,()=>255,()=>"Yemek yeme",e=>{const t=e._GetNode(0);return()=>t.ExpObject()-40},()=>.75,()=>423,()=>815,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(2)},()=>1353,()=>508,()=>680,()=>10.4,()=>16.6,()=>1357,()=>495,()=>814,()=>33,()=>3144,()=>1324,()=>499,()=>766,()=>94,()=>522,()=>609,()=>732,()=>42,()=>659,()=>181,e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod();return()=>t.ExpObject()+200*s()},e=>{const t=e._GetNode(0).GetVar();return()=>"lang : "+t.GetValue()},()=>585,()=>290,()=>85,()=>310,()=>202,()=>30,()=>275,()=>150,()=>"kickingBall",e=>{const t=e._GetNode(0);return()=>t.ExpObject()-100},()=>284,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-1},()=>428,()=>486,()=>787,()=>700,()=>171,()=>778,()=>159,()=>534,()=>507,()=>-1587,()=>-1189,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-2},()=>679,()=>681,()=>378,()=>409,()=>797,()=>152,()=>812,()=>315,()=>109,()=>798,()=>856,()=>2057,()=>273,()=>278,()=>542,()=>272,()=>544,()=>"Y",()=>2058,()=>622,()=>720,()=>618,()=>901,()=>272.9,()=>473,()=>271,()=>318,()=>481,()=>468,()=>470,()=>156,()=>243,()=>488,()=>23,()=>464,()=>287,()=>"left",()=>"right",()=>"top",()=>825,()=>330,()=>316,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+2e3},()=>458,()=>636,()=>194.4,e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>t.ExpObject()+s.ExpObject()},()=>"?",()=>"leg",()=>233,()=>"ball",()=>460,()=>502,()=>386,()=>561,()=>252,()=>513,()=>325,()=>"down",()=>215,()=>"marbleCount",()=>"6",e=>{const t=e._GetNode(0);return()=>AE(150,DE(t.ExpObject("marbleCount"),75))},e=>{const t=e._GetNode(0);return()=>AE(t.ExpObject("marbleCount"),1)},()=>-216,()=>1312,()=>"gameEnd",()=>167,()=>646,()=>"mouth",e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(140,310)},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(821,906)},()=>"None",()=>"Mat",()=>"Bobba",e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(0,0)},()=>5e4,e=>{const t=e._GetNode(0);return()=>AE(t.ExpObject("count"),300)},e=>{const t=e._GetNode(0);return()=>t.ExpObject("count")},()=>"50K",()=>"order",e=>{const t=e._GetNode(0);return()=>t.ExpObject("order")},()=>98,()=>864,()=>36.7,()=>59,()=>884,()=>153,()=>881,()=>137,()=>857,()=>97,()=>-441763660195839,()=>"running",e=>{const t=e._GetNode(0);return()=>t.ExpObject("EXTRA_97_1")},()=>392,()=>511,()=>444,()=>246,()=>397,()=>143,()=>435,()=>"rival",()=>740,()=>"jenny",()=>-278,()=>1020,e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod();return()=>t.ExpObject()-400*s()},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+1300},e=>{const t=e._GetNode(0);return()=>t.ExpObject("NEW_LEVELS")},e=>{const t=e._GetNode(0);return()=>t.ExpObject("COMING_SOON")},()=>454,()=>871,()=>125,()=>"appear",()=>"levelOnly",e=>{const t=e._GetNode(0);return()=>t.ExpObject("SKIP_TEXT")},e=>{const t=e._GetNode(0);return()=>t.ExpObject("SKIP")},e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>ME(AE(t.ExpObject(s.ExpInstVar_Family()),1),2)},()=>"UI_Button_Appear",()=>"UI_Click_Close",()=>"levels",e=>{const t=e._GetNode(0);return()=>RE(t.ExpObject("coins"),50)},()=>"levelSelect",()=>37,()=>36,()=>48,()=>73,()=>72,()=>84,()=>96,()=>121,()=>108,()=>133,()=>132,()=>157,()=>144,()=>169,()=>168,()=>210,()=>192,()=>"out",()=>"in",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2).GetVar();return()=>t("in")+1+5*s("out")+n.GetValue()},()=>204,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>160+200*t("in")},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>360+160*t("out")},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2).GetVar();return()=>t("in")+1+3*s("out")+n.GetValue()},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2).GetBoundMethod(),i=e._GetNode(3).GetVar();return()=>LE(LE("game data level : ",t.ExpObject("level"))+"levelCount : ",s("in")+1+3*n("out")+i.GetValue())},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar(),n=e._GetNode(2);return()=>LE("levelselect :",t.ExpObject(s.GetValue()))+" arrays : "+n.ExpObject()},()=>"watchvideo3",e=>{const t=e._GetNode(0).GetBoundMethod();return()=>LE(Math.round(100*t()),"%")},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>437*t()+360},()=>"GameLevelsData",()=>"levelsData",()=>",",e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>LE("language: ",t.ExpObject("language"))+" AsJSON: "+s.ExpObject()},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2),i=e._GetNode(3);return()=>LE(LE("LanguageOrderDic: ",AE(t.ExpObject(s(n.ExpObject("language"),2)),1))+"language: ",i.ExpObject("language"))},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1),n=e._GetNode(2),i=e._GetNode(3).GetBoundMethod(),r=e._GetNode(4),a=e._GetNode(5).GetBoundMethod();return()=>t(s.ExpObject(AE(n.ExpObject(i(r.ExpObject("language"),2)),1),a(),0))},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod();return()=>t.ExpObject(0,s(),0)},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod();return()=>t.ExpObject(1,s(),0)},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetBoundMethod(),i=e._GetNode(3),r=e._GetNode(4).GetBoundMethod();return()=>t.ExpObject(AE(s.ExpObject(n(i.ExpObject("language"),2)),1),r(),0)},e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>t.ExpObject(""+s.ExpInstVar())},()=>"ajax work",()=>"GameCharactersData",()=>"characterData",()=>"HelperFunctions",e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>t.ExpObject(s.GetValue(),0,0)},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2),i=e._GetNode(3),r=e._GetNode(4),a=e._GetNode(5),o=e._GetNode(6);return()=>LE(LE(LE(LE("NewCutOffText.Text : "+t.ExpObject()+" ***** NewCutOffText.FaceSize :",s.ExpObject())+" - ",n.ExpInstVar_Family())+" - "+i.ExpObject()+" TextHeight : ",r.ExpObject())+" Height : ",a.ExpObject())+" LayerName : "+o.ExpObject()},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2),i=e._GetNode(3);return()=>LE(LE(LE("***NewCutOffText.Text : "+t.ExpObject()+" FaceSize :",s.ExpObject())+" TextHeight: ",n.ExpObject())+" Height: ",i.ExpObject())},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>LE("***NewCutOffText.Text : "+t.ExpObject()+" isTextShrink: ",s.GetValue())},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>LE("***NewCutOffText.Text japonca : "+t.ExpObject()+" isTextShrink: ",s.GetValue())},()=>"trke",()=>"espaol",()=>"italiano",()=>"franais",()=>"deutsch",()=>"polski",()=>"portugus",()=>"indonesia",()=>"magyar",()=>"etina",()=>"",()=>"",()=>"ting vit",()=>"",()=>"",()=>"Romn",()=>"",()=>"",()=>"english",()=>-1900,e=>{const t=e._GetNode(0);return()=>"Game Data : "+t.ExpObject()},()=>"start",()=>"data",()=>"levelEndCharacter",e=>{const t=e._GetNode(0);return()=>"Game data exist : "+t.ExpObject()},e=>{const t=e._GetNode(0);return()=>t.ExpObject("array_skipped")},()=>"introShown",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetBoundMethod();return()=>t(s(),2)},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>682*t()},()=>"success start",()=>"OnlyText",()=>"DoubleTalk",()=>"SingleTalk",()=>"konfeti",e=>{const t=e._GetNode(0);return()=>t.ExpObject("NEXT_BUTTON")},()=>"success",()=>1281,()=>676,()=>28,()=>736,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(400,450)},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(2e3,2400)},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(0)-100},()=>480,()=>"alkis",e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(0)-200},()=>"Cheer_Applause1",()=>"tippopup",()=>"cheer_applause",()=>2.4,()=>1914,()=>"ShowTalksLayer",e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetVar(),i=e._GetNode(3),r=e._GetNode(4).GetVar();return()=>LE(LE("Json_LevelEndCharacterData.ArraySize: ",t.ExpObject(LE(".",s.ExpObject(n.GetValue(),0,0))))+" levelID: ",i.ExpObject(r.GetValue(),0,0))},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetVar();return()=>t.ExpObject(LE("",s.ExpObject(n.GetValue(),0,0)))},()=>"double talk first",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1),n=e._GetNode(2),i=e._GetNode(3).GetVar();return()=>t(s.ExpObject(LE("END_",n.ExpObject(i.GetValue(),0,0))+"_1"))},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1),n=e._GetNode(2),i=e._GetNode(3).GetVar();return()=>t(s.ExpObject(LE("END_",n.ExpObject(i.GetValue(),0,0))+"_2"))},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetVar(),i=e._GetNode(3),r=e._GetNode(4),a=e._GetNode(5).GetVar();return()=>LE(LE(LE("ArrayLevels.At: ",t.ExpObject(s.GetValue(),0,0))+" level: ",n.GetValue())+" Json_GameData: ",i.ExpObject(LE("END_",r.ExpObject(a.GetValue(),0,0))+"_1"))},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetVar();return()=>t.ExpObject(LE(s.ExpObject(n.GetValue(),0,0),".0"))},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetVar();return()=>t.ExpObject(LE(s.ExpObject(n.GetValue(),0,0),".1"))},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetVar();return()=>t.ExpObject(LE("END_",s.ExpObject(n.GetValue(),0,0))+"_1")},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetVar();return()=>t.ExpObject(LE("END_",s.ExpObject(n.GetValue(),0,0))+"_2")},e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetVar();return()=>"firstText: "+t.GetValue()+" secondText: "+s.GetValue()},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1),n=e._GetNode(2),i=e._GetNode(3).GetVar();return()=>t(s.ExpObject(LE("",n.ExpObject(i.GetValue(),0,0))))},()=>"double talk second",e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2).GetVar(),i=e._GetNode(3),r=e._GetNode(4).GetVar();return()=>LE(LE("Json_LevelEndCharacterData single: ",t.ExpObject(LE(".",s.ExpObject(n.GetValue(),0,0))+".0"))+" ArrayLevels: ",i.ExpObject(r.GetValue(),0,0))},e=>{const t=e._GetNode(0).GetVar();return()=>"firstText: "+t.GetValue()},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar();return()=>LE("",t.ExpObject(s.GetValue(),0,0))+".0"},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar();return()=>t(s.GetValue())},()=>79,()=>22,()=>624,()=>897,e=>{const t=e._GetNode(0);return()=>t.ExpObject("EXTRA_114_1")},()=>"pos",e=>{const t=e._GetNode(0);return()=>t.ExpObject(1)},()=>"scale",()=>.001,()=>503,()=>21.7,()=>285.5,()=>201,()=>538,()=>275.2,()=>162,()=>531,()=>270.8,()=>262,()=>407,()=>705,e=>{const t=e._GetNode(0);return()=>t.ExpInstVar_Family()+30},()=>"tween",()=>116.5,()=>528,()=>793,e=>{const t=e._GetNode(0);return()=>.25*t.ExpInstVar()},()=>453,()=>442,()=>272.7,()=>327,()=>"10",()=>-156,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1);return()=>t(s.ExpObject())+1},()=>"2",e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>LE("Text: "+t.ExpObject()+" maxCount: ",s.ExpInstVar())},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetBoundMethod();return()=>t.ExpObject()+s.GetValue()*n()},e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>t.ExpObject(s.ExpInstVar())},()=>450,e=>{const t=e._GetNode(0).GetVar();return()=>t.GetValue()+50},e=>{const t=e._GetNode(0).GetVar();return()=>t.GetValue()/10},()=>265,e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>LE(LE("order: ",t.ExpInstVar())+" lvl121_whiteBody.X: ",s.ExpObject())},e=>{const t=e._GetNode(0);return()=>t.ExpInstVar()-1},()=>1100,()=>1332,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-1242},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-1e3},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-300},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+1e3},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+300},()=>665,()=>381,()=>2.99,()=>418,()=>57.8,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>.7*t()},e=>{const t=e._GetNode(0).GetVar();return()=>300+200*t.GetValue()},e=>{const t=e._GetNode(0);return()=>LE("lvl126_astroids.MoveToAstroids.MaxSpeed: ",t.ExpBehavior())},()=>"Layer 0",()=>1e-5,()=>176,()=>323,()=>269,()=>654,()=>193.2,e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(1,2.5)},()=>950,e=>{const t=e._GetNode(0);return()=>t.ExpInstVar()+.15},()=>.15,()=>910,()=>924,()=>620,()=>614,()=>338,()=>408,()=>712,e=>{const t=e._GetNode(0);return()=>t.ExpObject("LEVEL_TEXT_136")},()=>"<alpha=#00></color> ",()=>"Hehe! B B <alpha=#00>Tiki</color> li nh da mnh,  xem ai h ai no!",e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetVar();return()=>t(s.GetValue(),n.GetValue())},e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetBoundMethod(),n=e._GetNode(2).GetVar();return()=>t.GetValue()+s(n.GetValue())},e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetVar();return()=>t.GetValue()-s.GetValue()},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetVar(),i=e._GetNode(3).GetVar();return()=>t(s.GetValue(),n.GetValue(),i.GetValue())},e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetBoundMethod(),i=e._GetNode(3).GetVar(),r=e._GetNode(4).GetVar(),a=e._GetNode(5).GetBoundMethod(),o=e._GetNode(6).GetVar();return()=>t(s.GetValue(),n(i.GetValue())-(r.GetValue()+a(o.GetValue())))},e=>{const t=e._GetNode(0).GetVar(),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetVar(),i=e._GetNode(3).GetVar(),r=e._GetNode(4).GetVar();return()=>t.GetValue()+s.GetValue()+n.GetValue()+i.GetValue()+r.GetValue()},e=>{const t=e._GetNode(0).GetVar();return()=>"SonucMetni: "+t.GetValue()},()=>"!           ",()=>"",()=>207,()=>65,()=>208,()=>124,()=>172,()=>115,()=>91,()=>99,()=>578,()=>903,()=>336,()=>900,e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>LE(LE("lvl137_body.UID: ",t.ExpObject())+" fakeDrag.Angle: ",s.ExpObject())},()=>"martian",()=>"guitar",()=>"eat",()=>472,()=>"meat",()=>777,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-500},()=>-281510008041471,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+35},e=>{const t=e._GetNode(0);return()=>t.ExpObject("EXTRA_165_1")},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+100},()=>567,()=>845,()=>235,()=>724,()=>867,()=>-100,()=>755,()=>"arm touched",()=>41,()=>205,()=>"end",()=>"worded",()=>1500,()=>216,()=>539,()=>525,()=>734,e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetVar();return()=>LE(LE(LE("UID 0: ",t.ExpObject())+" firstPosX: ",s.GetValue())+" firstPosY: ",n.GetValue())},e=>{const t=e._GetNode(0),s=e._GetNode(1).GetVar(),n=e._GetNode(2).GetVar();return()=>LE(LE(LE("UID 1: ",t.ExpObject())+" firstPosX2: ",s.GetValue())+" firstPosY2: ",n.GetValue())},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2),i=e._GetNode(3);return()=>LE(LE(LE(LE("UID 0: ",t.ExpObject())+" firstPosX: ",s.ExpInstVar_Family())+" firstPosY: ",n.ExpInstVar_Family())+" X: ",i.ExpObject())},e=>{const t=e._GetNode(0),s=e._GetNode(1),n=e._GetNode(2),i=e._GetNode(3);return()=>LE(LE(LE(LE("UID 1: ",t.ExpObject())+" firstPosX: ",s.ExpInstVar_Family())+" firstPosY: ",n.ExpInstVar_Family())+" X: ",i.ExpObject())},()=>560,()=>775,()=>104,()=>214,()=>515,()=>455,()=>551,()=>27,()=>891,e=>{const t=e._GetNode(0).GetVar();return()=>t.GetValue()+1},()=>501,()=>268,()=>1032,()=>290.445093,()=>635.04594,()=>25.1,()=>607,()=>348.563725,()=>591.479917,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-4},()=>961,()=>286.1,()=>1057,()=>369,()=>129,()=>552,()=>"first",()=>753,()=>"second",()=>174,()=>667,()=>"third",()=>-349,()=>1232,()=>"tiki",()=>326,()=>611,()=>43,()=>651,()=>"tiki2",()=>146,()=>779,()=>482,()=>763,()=>896,()=>355.806088,()=>636.287359,()=>355.521381,()=>593.421642,()=>245,()=>559,()=>641,e=>{const t=e._GetNode(0);return()=>-t.ExpObject()},()=>158.276173,()=>846.317165,()=>50.9,()=>207.78974,()=>903.547685,()=>169.924707,()=>878.43332,()=>237.457276,()=>891.398796,()=>273.5,()=>260,()=>95,()=>304.450558,()=>727.381633,()=>400.227646,()=>691.811497,()=>358,()=>686,()=>317,()=>58,()=>599,()=>413,()=>581,()=>361,()=>295,()=>"brush",()=>628,e=>{const t=e._GetNode(0);return()=>t.ExpObject("EXTRA_145_1")},()=>136,()=>902,()=>258,()=>31,()=>-316,()=>186,()=>923,()=>580.712758,()=>941.837618,()=>15.2,()=>608,()=>387,()=>467,e=>{const t=e._GetNode(0),s=e._GetNode(1);return()=>t.ExpObject()+s.ExpObject()/4},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+4},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-200},()=>456,()=>644,()=>"one",()=>139,()=>959,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+104.5},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-12},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-43},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-228.8},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-2.4},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+19},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-66},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-7.6},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-29},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+12},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+43},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+228.8},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-104.5},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+7.6},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+29},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+2.4},e=>{const t=e._GetNode(0);return()=>t.ExpObject()-19},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+66},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(300,400)},e=>{const t=e._GetNode(0).GetBoundMethod();return()=>t(600,670)},()=>918,()=>419,()=>657,()=>-1e3,()=>958,()=>-500,()=>134,()=>436,()=>587,()=>694,()=>456.5,()=>716.3,e=>{const t=e._GetNode(0);return()=>t.ExpObject("EXTRA_175_1")},()=>.77,()=>1.7,()=>321,()=>366.92,()=>768.57,()=>231.1,()=>308.5,()=>792.6,()=>17.5,()=>293.35,()=>830.5,()=>11.4,()=>"gorilla1",()=>493.19,()=>745.37,()=>91.7,()=>440.021242,()=>779.829803,()=>13.9,()=>-575,()=>324,()=>905,()=>311,()=>1570,()=>1052707,()=>"bobba1",()=>"bobba2",()=>702,()=>"bobba3",()=>637,()=>664,()=>158,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+6},()=>-300,e=>{const t=e._GetNode(0),s=e._GetNode(1).GetBoundMethod();return()=>t.ExpObject()-500*s()},()=>-1676,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+3500},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+53},()=>647,e=>{const t=e._GetNode(0);return()=>t.ExpObject("LEVEL_TEXT_184")},()=>" <alpha=#00></color>",()=>"  <alpha=#00> </color>  .,",()=>490.26979064941406,()=>208.31,()=>272.29576110839844,()=>226.5,()=>448.48716735839844,()=>208.22,()=>367.7552490234375,()=>207.43,()=>435.95660400390625,()=>364.53057861328125,()=>299.55670166015625,()=>228,()=>291.3478698730469,()=>248.93,()=>306.9218444824219,()=>226.75,()=>490.463134765625,()=>413.18275451660156,()=>228.89,()=>253.5565948486328,()=>230.13,()=>441.2854377441406,()=>227.69,()=>337.23486328125,()=>228.24,()=>296.8121032714844,()=>227.53,()=>295.39398681640625,()=>224.32,()=>254.03482055664062,()=>226.82,()=>306.6436004638672,()=>226.79,()=>460.5045166015625,()=>207.48,()=>340.94793701171875,()=>228.59,()=>"explosion",()=>303,()=>"arm",e=>{const t=e._GetNode(0);return()=>t.ExpObject()+44},()=>298,()=>213.4,()=>520,()=>455.5,()=>471,()=>758,()=>205.697299,()=>931.154979,()=>201.2,()=>591.269366,()=>936.39182,()=>3.1,()=>355.866846,()=>737.25826,()=>.73,()=>414,()=>699,()=>346,()=>382,()=>517,()=>447,()=>735,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-68},e=>{const t=e._GetNode(0);return()=>t.ExpObject()+68},()=>757,()=>37.6,()=>130.82736,()=>808.824066,()=>126.840415,()=>826.17431,()=>291.8,()=>669,()=>430.678996,()=>732.411732,()=>330.28678,()=>742.905444,()=>332.4,()=>439,()=>726,()=>76,()=>1970,()=>956,()=>877,e=>{const t=e._GetNode(0);return()=>t.ExpObject()+90},()=>.5346,()=>1083,()=>371,()=>836,()=>619,()=>391,()=>617,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-6},()=>"forward",()=>113,()=>947,()=>57,()=>31.8,()=>351,()=>933,()=>771,()=>-135,()=>-399,()=>1200,e=>{const t=e._GetNode(0).GetBoundMethod(),s=e._GetNode(1),n=e._GetNode(2).GetVar();return()=>t(s.ExpObject(),"{car}",LE("",n.GetValue()))},()=>1112,()=>-1200,()=>"blueCar",e=>{const t=e._GetNode(0);return()=>t.ExpObject("LEVEL_TEXT_199")},()=>234,e=>{const t=e._GetNode(0);return()=>t.ExpObject()-400}]}}}),import_c3runtime=__toESM(require_c3runtime()),C32=self.C3;function OnBeforeProjectStart(e){window.addEventListener("keydown",(e=>{["ArrowDown","ArrowUp"," "].includes(e.key)&&e.preventDefault()})),window.addEventListener("wheel",(e=>e.preventDefault()),{passive:!1})}self.C3_GetObjectRefTable=function(){return[C32.Plugins.AJAX,C32.Plugins.Arr,C32.Plugins.Audio,C32.Plugins.Sprite,C32.Plugins.Browser,C32.Plugins.Text,C32.Behaviors.MoveTo,C32.Behaviors.Pin,C32.Behaviors.Tween,C32.Plugins.Dictionary,C32.Plugins.Json,C32.Plugins.LocalStorage,C32.Plugins.PlatformInfo,C32.Plugins.Touch,C32.Behaviors.DragnDrop,C32.Behaviors.CV_BoundedDragnDrop,C32.Behaviors.Sin,C32.Behaviors.bound,C32.Behaviors.Rotate,C32.Plugins.NinePatch,C32.Plugins.CSV,C32.Behaviors.destroy,C32.Plugins.Particles,C32.Behaviors.Physics,C32.Behaviors.solid,C32.Plugins.Touch.Cnds.OnTouchObject,C32.JavaScriptInEvents.Faile_Event1_Act3,C32.Plugins.System.Cnds.OnLayoutStart,C32.JavaScriptInEvents.Faile_Event2_Act1,C32.Plugins.PlatformInfo.Cnds.IsOnMobile,C32.JavaScriptInEvents.Faile_Event3_Act1,C32.Plugins.System.Cnds.Else,C32.JavaScriptInEvents.Faile_Event4_Act1,C32.Plugins.Browser.Cnds.IsPortraitLandscape,C32.Plugins.System.Acts.GoToLayoutByName,C32.Plugins.Arr.Exps.At,C32.Plugins.System.Cnds.OnLayoutEnd,C32.JavaScriptInEvents.Faile_Event8_Act1,C32.Plugins.System.Cnds.IsGroupActive,C32.Plugins.System.Acts.SetVar,C32.Plugins.System.Acts.SetBoolVar,C32.Plugins.Text.Acts.SetText,C32.Plugins.Json.Exps.Get,C32.Plugins.System.Acts.SetLayerOpacity,C32.Plugins.System.Acts.SetLayerInteractive,C32.Plugins.System.Cnds.EveryTick,C32.Plugins.Dictionary.Exps.Get,C32.Plugins.System.Cnds.Compare,C32.Plugins.System.Exps.len,C32.Plugins.Text.Exps.Text,C32.Plugins.Text.Acts.SetFontSize,C32.Plugins.Dictionary.Acts.SetKey,C32.Plugins.LocalStorage.Acts.SetItem,C32.Plugins.Dictionary.Exps.AsJSON,C32.Plugins.System.Acts.AddVar,C32.JavaScriptInEvents.Globale_Event12_Act2,C32.Plugins.System.Cnds.CompareVar,C32.Plugins.System.Acts.Wait,C32.Plugins.System.Acts.CreateObject,C32.Plugins.System.Acts.GoToLayout,C32.Plugins.System.Acts.RestartLayout,C32.Plugins.Arr.Acts.Push,C32.Plugins.Arr.Exps.AsJSON,C32.JavaScriptInEvents.Globale_Event18_Act5,C32.Plugins.Audio.Acts.SetPaused,C32.Plugins.Audio.Acts.Stop,C32.Plugins.Dictionary.Cnds.CompareValue,C32.Plugins.System.Cnds.CompareBoolVar,C32.Plugins.Audio.Acts.PlayByName,C32.Plugins.System.Cnds.PickByComparison,C32.Plugins.System.Acts.SetFunctionReturnValue,C32.Plugins.System.Exps.replace,C32.Plugins.Sprite.Acts.SetPos,C32.Plugins.System.Exps.int,C32.Plugins.System.Cnds.ForEach,C32.Plugins.Sprite.Acts.Destroy,C32.Plugins.Dictionary.Cnds.HasKey,C32.Plugins.Sprite.Acts.SetAnimFrame,C32.Plugins.Text.Acts.SetVisible,C32.Plugins.Sprite.Cnds.IsOverlapping,C32.Plugins.Text.Acts.Destroy,C32.Plugins.Touch.Cnds.OnTapGestureObject,C32.Plugins.Sprite.Cnds.CompareFrame,C32.Plugins.System.Cnds.For,C32.Plugins.System.Exps.loopindex,C32.Plugins.Dictionary.Acts.AddKey,C32.Behaviors.Tween.Acts.TweenOneProperty,C32.Plugins.System.Acts.StopLoop,C32.JavaScriptInEvents.Globale_Event61_Act1,C32.JavaScriptInEvents.Globale_Event75_Act3,C32.JavaScriptInEvents.Globale_Event75_Act4,C32.JavaScriptInEvents.Globale_Event75_Act5,C32.Plugins.System.Cnds.LayerCmpOpacity,C32.JavaScriptInEvents.Globale_Event77_Act1,C32.Plugins.System.Acts.WaitForPreviousActions,C32.JavaScriptInEvents.Globale_Event78_Act1,C32.Plugins.Sprite.Cnds.CompareY,C32.JavaScriptInEvents.Globale_Event80_Act1,C32.Plugins.Touch.Cnds.IsTouchingObject,C32.JavaScriptInEvents.Globale_Event82_Act1,C32.JavaScriptInEvents.Globale_Event92_Act4,C32.JavaScriptInEvents.Globale_Event93_Act1,C32.JavaScriptInEvents.Globale_Event94_Act1,C32.Plugins.System.Cnds.IsPreview,C32.JavaScriptInEvents.Globale_Event97_Act1,C32.JavaScriptInEvents.Globale_Event98_Act2,C32.JavaScriptInEvents.Globale_Event100_Act1,C32.Plugins.System.Cnds.Every,C32.Behaviors.MoveTo.Acts.MoveToPosition,C32.JavaScriptInEvents.Homee_Event5_Act1,C32.JavaScriptInEvents.Homee_Event5_Act2,C32.Plugins.System.Cnds.TriggerOnce,C32.JavaScriptInEvents.Homee_Event9_Act1,C32.JavaScriptInEvents.Homee_Event9_Act4,C32.JavaScriptInEvents.Homee_Event10_Act2,C32.JavaScriptInEvents.Homee_Event11_Act2,C32.JavaScriptInEvents.Homee_Event14_Act3,C32.JavaScriptInEvents.Homee_Event14_Act4,C32.JavaScriptInEvents.Homee_Event17_Act3,C32.Behaviors.MoveTo.Cnds.OnArrived,C32.Plugins.Sprite.Cnds.CompareX,C32.Plugins.Text.Acts.SetY,C32.Plugins.Text.Exps.Y,C32.Plugins.Text.Cnds.OnCreated,C32.Plugins.PlatformInfo.Cnds.IsOniOS,C32.Plugins.PlatformInfo.Cnds.IsOnMacOS,C32.Plugins.System.Exps.find,C32.Plugins.Browser.Exps.UserAgent,C32.Plugins.System.Exps.left,C32.Plugins.System.Exps.right,C32.Plugins.Sprite.Cnds.IsBoolInstanceVarSet,C32.Plugins.Sprite.Acts.SetBoolInstanceVar,C32.Plugins.Sprite.Cnds.OnCollision,C32.Behaviors.DragnDrop.Cnds.IsEnabled,C32.Behaviors.DragnDrop.Acts.SetEnabled,C32.Plugins.Sprite.Acts.SetAngle,C32.Behaviors.Tween.Acts.TweenTwoProperties,C32.Plugins.NinePatch.Cnds.IsBoolInstanceVarSet,C32.Plugins.Sprite.Acts.AddInstanceVar,C32.Plugins.Sprite.Exps.Y,C32.Plugins.NinePatch.Acts.SetVisible,C32.Plugins.NinePatch.Acts.SetBoolInstanceVar,C32.Plugins.Sprite.Acts.SetVisible,C32.Plugins.Text.Cnds.IsBoolInstanceVarSet,C32.Plugins.Text.Acts.SetPos,C32.Behaviors.DragnDrop.Cnds.OnDrop,C32.Plugins.Sprite.Acts.SetDefaultColor,C32.Plugins.Text.Acts.SetBoolInstanceVar,C32.Behaviors.Tween.Acts.StopAllTweens,C32.Plugins.Sprite.Cnds.CompareInstanceVar,C32.Behaviors.Tween.Acts.PauseAllTweens,C32.Behaviors.Tween.Acts.ResumeAllTweens,C32.Plugins.Sprite.Acts.SetInstanceVar,C32.Plugins.Sprite.Exps.X,C32.Plugins.Sprite.Acts.SetX,C32.Plugins.Sprite.Acts.MoveToTop,C32.Plugins.System.Exps.random,C32.Plugins.Sprite.Cnds.CompareFrameTag,C32.Plugins.Touch.Cnds.OnTouchEnd,C32.Behaviors.MoveTo.Acts.SetMaxSpeed,C32.Behaviors.CV_BoundedDragnDrop.Acts.SetEnabled,C32.Behaviors.Tween.Cnds.OnTweensFinished,C32.Plugins.NinePatch.Cnds.CompareY,C32.Plugins.Sprite.Acts.SetY,C32.Plugins.Touch.Cnds.OnTouchStart,C32.Plugins.Touch.Exps.X,C32.Plugins.System.Acts.SetLayerVisible,C32.Plugins.System.Exps.trim,C32.Plugins.Sprite.Acts.SetMirrored,C32.Behaviors.DragnDrop.Cnds.IsDragging,C32.Plugins.Touch.Exps.Y,C32.Plugins.Sprite.Acts.SetScale,C32.Plugins.Touch.Cnds.OnHoldGestureObject,C32.Plugins.Sprite.Acts.RemoveFromParent,C32.Behaviors.Tween.Acts.SetEnabled,C32.Behaviors.Tween.Acts.StopTweens,C32.Plugins.Sprite.Acts.SetCollisions,C32.Plugins.Sprite.Acts.AddChild,C32.Plugins.Sprite.Acts.SetSize,C32.Plugins.Sprite.Exps.Angle,C32.Plugins.Touch.Cnds.OnHoldGesture,C32.Plugins.Touch.Cnds.CompareTouchSpeed,C32.Plugins.System.Cnds.CompareBetween,C32.Plugins.Touch.Exps.AngleAt,C32.Plugins.Touch.Cnds.IsInTouch,C32.Plugins.Audio.Acts.Play,C32.Behaviors.Tween.Cnds.IsAnyPlaying,C32.Behaviors.Tween.Cnds.OnAnyTweensFinished,C32.Plugins.Sprite.Acts.SubInstanceVar,C32.Plugins.Sprite.Cnds.IsOnScreen,C32.Plugins.Sprite.Acts.SetHeight,C32.Plugins.System.Exps.viewportmidy,C32.Plugins.System.Exps.dt,C32.Plugins.Sprite.Exps.Width,C32.Plugins.Sprite.Exps.Height,C32.Plugins.Text.Acts.SetWidth,C32.Behaviors.DragnDrop.Cnds.OnDragStart,C32.Plugins.Sprite.Cnds.CompareHeight,C32.Behaviors.Sin.Acts.SetEnabled,C32.Plugins.Sprite.Acts.RotateClockwise,C32.Plugins.Sprite.Cnds.IsVisible,C32.Plugins.Sprite.Acts.SetFlipped,C32.Plugins.Sprite.Acts.MoveToBottom,C32.Plugins.Touch.Exps.SpeedAt,C32.Plugins.Sprite.Cnds.IsBetweenAngles,C32.Plugins.System.Cnds.PickAll,C32.Plugins.Sprite.Cnds.HasParent,C32.Behaviors.CV_BoundedDragnDrop.Acts.Drop,C32.Plugins.Sprite.Cnds.CompareChildCount,C32.Plugins.Sprite.Acts.RemoveChild,C32.Plugins.Text.Acts.MoveToTop,C32.Behaviors.CV_BoundedDragnDrop.Cnds.IsDragging,C32.Behaviors.MoveTo.Acts.Stop,C32.Plugins.System.Acts.SubVar,C32.Plugins.Sprite.Cnds.PickChildren,C32.Behaviors.DragnDrop.Acts.Drop,C32.Plugins.Sprite.Cnds.PickByUID,C32.Plugins.Sprite.Cnds.IsMirrored,C32.Plugins.Text.Acts.SetX,C32.Plugins.Sprite.Acts.SetWidth,C32.Behaviors.CV_BoundedDragnDrop.Cnds.OnDragStart,C32.Plugins.Text.Cnds.CompareX,C32.Plugins.Text.Cnds.CompareY,C32.Plugins.System.Cnds.ForEachOrdered,C32.Plugins.Sprite.Acts.SetOpacity,C32.Plugins.Text.Cnds.CompareText,C32.Plugins.Sprite.Exps.Count,C32.Plugins.Sprite.Cnds.PickInstVarHiLow,C32.Behaviors.Tween.Cnds.IsPlaying,C32.Behaviors.CV_BoundedDragnDrop.Cnds.OnDrop,C32.Plugins.NinePatch.Acts.Destroy,C32.Plugins.NinePatch.Cnds.CompareInstanceVar,C32.Plugins.NinePatch.Cnds.CompareHeight,C32.Plugins.NinePatch.Acts.SetHeight,C32.Plugins.NinePatch.Exps.Height,C32.Plugins.Dictionary.Acts.Clear,C32.Plugins.System.Acts.MoveLayer,C32.JavaScriptInEvents.Levelglobale_Event17_Act2,C32.JavaScriptInEvents.Levelglobale_Event17_Act3,C32.JavaScriptInEvents.Levelglobale_Event18_Act1,C32.JavaScriptInEvents.Levelglobale_Event18_Act2,C32.JavaScriptInEvents.Levelglobale_Event31_Act2,C32.JavaScriptInEvents.Levelglobale_Event32_Act6,C32.JavaScriptInEvents.Levelglobale_Event34_Act4,C32.JavaScriptInEvents.Levelglobale_Event34_Act6,C32.JavaScriptInEvents.Levelglobale_Event36_Act2,C32.JavaScriptInEvents.Levelselecte_Event33_Act1,C32.JavaScriptInEvents.Levelselecte_Event33_Act6,C32.JavaScriptInEvents.Levelselecte_Event34_Act1,C32.JavaScriptInEvents.Levelselecte_Event34_Act5,C32.JavaScriptInEvents.Levelselecte_Event35_Act1,C32.JavaScriptInEvents.Levelselecte_Event35_Act5,C32.JavaScriptInEvents.Levelselecte_Event36_Act1,C32.JavaScriptInEvents.Levelselecte_Event36_Act4,C32.JavaScriptInEvents.Levelselecte_Event40_Act3,C32.JavaScriptInEvents.Levelselecte_Event42_Act1,C32.Plugins.System.Cnds.OnLoadFinished,C32.Plugins.System.Exps.loadingprogress,C32.Plugins.AJAX.Cnds.OnComplete,C32.Plugins.CSV.Acts.ParseCSV,C32.Plugins.AJAX.Exps.LastData,C32.Plugins.Arr.Acts.SetSize,C32.Plugins.Arr.Exps.Height,C32.Plugins.Json.Acts.SetValue,C32.Plugins.Browser.Acts.ConsoleLog,C32.Plugins.AJAX.Acts.RequestFile,C32.Plugins.Arr.Acts.SetXY,C32.Plugins.Arr.Acts.Clear,C32.Plugins.Text.Exps.FaceSize,C32.Plugins.Text.Exps.ObjectTypeName,C32.Plugins.Text.Exps.TextHeight,C32.Plugins.Text.Exps.Height,C32.Plugins.Text.Exps.LayerName,C32.Plugins.System.Cnds.While,C32.Plugins.Text.Acts.SetInstanceVar,C32.JavaScriptInEvents.Settingse_Event29_Act2,C32.JavaScriptInEvents.Settingse_Event33_Act2,C32.Plugins.Text.Cnds.CompareInstanceVar,C32.JavaScriptInEvents.Settingse_Event72_Act1,C32.Plugins.LocalStorage.Acts.CheckItemExists,C32.Plugins.Json.Acts.Parse,C32.Plugins.Json.Cnds.ForEach,C32.Plugins.Json.Exps.CurrentKey,C32.Plugins.Json.Exps.CurrentValue,C32.Plugins.LocalStorage.Cnds.OnItemMissing,C32.Plugins.LocalStorage.Cnds.OnItemExists,C32.Plugins.Dictionary.Acts.JSONLoad,C32.Plugins.LocalStorage.Exps.ItemValue,C32.Plugins.Arr.Acts.JSONLoad,C32.Plugins.Browser.Exps.Language,C32.Plugins.Particles.Acts.Destroy,C32.JavaScriptInEvents.Successe_Event1_Act12,C32.JavaScriptInEvents.Successe_Event1_Act16,C32.JavaScriptInEvents.Successe_Event3_Act1,C32.JavaScriptInEvents.Successe_Event4_Act1,C32.Plugins.System.Exps.windowwidth,C32.JavaScriptInEvents.Successe_Event6_Act1,C32.JavaScriptInEvents.Successe_Event7_Act1,C32.Plugins.System.Cnds.PickNth,C32.Behaviors.MoveTo.Acts.MoveToObject,C32.Behaviors.MoveTo.Acts.SetAcceleration,C32.JavaScriptInEvents.Successe_Event22_Act2,C32.JavaScriptInEvents.Successe_Event25_Act1,C32.JavaScriptInEvents.Successe_Event27_Act1,C32.Plugins.System.Exps.viewporttop,C32.Plugins.System.Exps.viewportbottom,C32.Plugins.Sprite.Acts.SetAnimSpeed,C32.Plugins.Json.Exps.ArraySize,C32.Plugins.System.Exps.uppercase,C32.JavaScriptInEvents.Successe_Event36_Act1,C32.JavaScriptInEvents.Successe_Event37_Act1,C32.Plugins.Json.Cnds.CompareValue,C32.JavaScriptInEvents.Successe_Event41_Act1,C32.JavaScriptInEvents.Successe_Event44_Act1,C32.JavaScriptInEvents.Successe_Event47_Act1,C32.Plugins.System.Cnds.IsBetweenAngles,C32.Plugins.Sprite.Cnds.HasChildren,C32.Plugins.Sprite.Exps.PickedCount,C32.Plugins.System.Cnds.PickRandom,C32.Plugins.Sprite.Exps.ImagePointX,C32.Plugins.Sprite.Exps.ImagePointY,C32.Plugins.Text.Acts.AppendText,C32.Plugins.Sprite.Cnds.IsFlipped,C32.Plugins.Sprite.Acts.Spawn,C32.Behaviors.Rotate.Acts.SetEnabled,C32.Behaviors.MoveTo.Acts.SetEnabled,C32.Behaviors.MoveTo.Exps.MaxSpeed,C32.Behaviors.MoveTo.Cnds.IsMoving,C32.Plugins.System.Exps.mid,C32.Plugins.Text.Exps.X,C32.Plugins.Text.Cnds.IsOnScreen,C32.Plugins.Sprite.Cnds.PickParent,C32.Plugins.Sprite.Exps.UID,C32.Plugins.Sprite.Acts.ZMoveToObject,C32.Plugins.Sprite.Cnds.CompareOpacity,C32.Plugins.Sprite.Exps.Opacity,C32.Behaviors.CV_BoundedDragnDrop.Cnds.IsEnabled,C32.Plugins.NinePatch.Acts.SetPos,C32.Plugins.NinePatch.Acts.MoveToBottom,C32.Plugins.NinePatch.Acts.MoveToTop,C32.Plugins.NinePatch.Acts.SetAngle,C32.Plugins.Text.Acts.SetHeight,C32.Plugins.Touch.Cnds.OnTapGesture,C32.Plugins.Sprite.Cnds.OnAnimFinished,C32.Behaviors.Rotate.Acts.SetSpeed,C32.Behaviors.DragnDrop.Acts.SetAxes,C32.Plugins.Sprite.Cnds.AngleWithin]},self.C3_JsPropNameTable=[{AJAX:0},{ArrayLevels:0},{ArraySkipped:0},{Audio:0},{background2:0},{box:0},{Browser:0},{bubbletext:0},{bubbletext2:0},{bubbletext3:0},{coin_price:0},{coin_price2:0},{value:0},{MoveTo:0},{coin_price3:0},{Pin:0},{coinAmpul3:0},{coinbg:0},{cointext:0},{control:0},{control4:0},{control5:0},{CorrectIcon:0},{Tween:0},{dialog_speech:0},{dialog_speech3:0},{val:0},{earncoinText:0},{earncoinText2:0},{explosion:0},{GameData:0},{gameplay_hint_cost:0},{id:0},{gameplay_hint_opened:0},{gameplay_hint_opened2:0},{gameplay_hint_opened3:0},{gameplay_hint_opened4:0},{hint_lock:0},{hint_price:0},{hintBack:0},{hintClose:0},{defaultFontSize:0},{hintText1:0},{hintText2:0},{hintText3:0},{hintText4:0},{hintTitle1:0},{home_levels:0},{JSON:0},{levelcompletedtext2:0},{NextBackground:0},{levelend_next:0},{levelend_restart:0},{levelend_restart_failed:0},{levelnumberText:0},{levelnumberText2:0},{levelnumberText3:0},{level:0},{levels_bonus_locked:0},{levels_checkmark:0},{levels_checkmark2:0},{levels_checkmark3:0},{levels_gundolf_locked:0},{levels_locked:0},{line:0},{loadText:0},{LocalStorage:0},{PlatformInfo:0},{restartText:0},{settings:0},{settingsText:0},{settingsTxt:0},{sureBack:0},{hint:0},{sureBtn:0},{sureBtnText:0},{sureClose:0},{surePrice:0},{sureText:0},{Touch:0},{WrongIcon:0},{buttons_back:0},{buttons_music_off:0},{buttons_music_on:0},{buttons_sound_off:0},{buttons_sound_on:0},{levelend_rate_bg:0},{isTouched:0},{isMusicOpened:0},{isMusicClosed:0},{music_On_Off:0},{data_new:0},{isSoundOpened:0},{isSoundClosed:0},{sound_On_Off:0},{m_white_sprite:0},{CorrectIcon2:0},{coin_price4:0},{splashikon2:0},{sureBtnLevelSelect:0},{hints_global:0},{rewarded_gameplay_global:0},{reward_bulb_global:0},{rewardPriceText_global:0},{skip_button_global:0},{isVisible:0},{skipBack:0},{skipBtn:0},{skipBtnText:0},{skipClose:0},{coinAmpul4:0},{surePrice2:0},{skipText:0},{Json_GameData:0},{Json_LevelEndCharacterData:0},{leveltext:0},{firstPosX:0},{firstPosY:0},{beaf:0},{burrito:0},{chicken:0},{isSuccess:0},{order:0},{option_bg:0},{firstX:0},{firstY:0},{plate:0},{saliva:0},{Table:0},{isWrongSelected:0},{A:0},{isCorrectSelected:0},{B:0},{C:0},{DragDrop:0},{plate_right:0},{lvl_158_order:0},{carpet:0},{control_2:0},{donut:0},{donut2:0},{donut3:0},{donut4:0},{donut5:0},{isOnTable:0},{isFirstTouch:0},{donut6:0},{fireplace:0},{sofa:0},{ball:0},{EatingCount:0},{Bobba_Head_Whole:0},{ors:0},{smalltable:0},{tableback:0},{flower_closed:0},{floweropen_big:0},{isWrong:0},{floweropen_small:0},{soilwflowers:0},{initPosX:0},{initPosY:0},{sun:0},{lvl_160_cookiebig:0},{cookiesmall:0},{catCounter:0},{isClicked:0},{isArrived:0},{cat:0},{cat2:0},{cat3:0},{cat4:0},{cat5:0},{checkmark:0},{fish:0},{plate2:0},{table2:0},{cake_eaten:0},{goUp:0},{posX:0},{posY:0},{BoundedDragDrop:0},{cat_Tail:0},{actionFinished:0},{cat_tongue:0},{catbig:0},{smudge:0},{smudge2:0},{smudge3:0},{cat_tongue2:0},{smudge4:0},{nb_cat_Tail:0},{bandaid:0},{bandaid2:0},{car_tileless:0},{hiprounded:0},{lever:0},{nail:0},{Sprite5:0},{tire:0},{tirebumped:0},{lvl_68_compressor:0},{bush:0},{bush2:0},{Sprite6:0},{Sprite8:0},{carrot_big:0},{carrot_normal:0},{carrot_small:0},{floorline:0},{holeline:0},{comb:0},{dandruff:0},{dandruff2:0},{dandruff3:0},{dandruff4:0},{dandruff5:0},{dandruff6:0},{dandruff7:0},{shampoo:0},{shampoo2:0},{Lily_Angry:0},{Lily_Back_Arm2:0},{Lily_Back_Leg_:0},{Lily_Back_Leg_2:0},{Lily_Body:0},{Lily_Crying:0},{Lily_Eyes:0},{Lily_Eyes_Inside:0},{Sine:0},{Lily_Front_Arm:0},{Lily_Front_Arm2:0},{Lily_Front_Leg_:0},{Lily_Front_Leg_2:0},{Lily_Hair_Piece_:0},{Lily_Hair_Piece_2:0},{Lily_Happy:0},{Lily_Head:0},{Lily_Lids:0},{Lily_whole_face:0},{Lily_Skirt:0},{Lily_Smile:0},{Lily_Body2:0},{xPos:0},{dandrufCount:0},{Lily_Head2:0},{Lily_Front_Arm3:0},{Lily_Back_Arm_3:0},{Lily_Front_Arm4:0},{Lily_Normal2:0},{Lily_Hair_Piece_3:0},{Lily_Hair_Piece_4:0},{Lily_Happy2:0},{Lily_Body_Main:0},{Lily_Front_Arm7:0},{Lily_Happy4:0},{Lily_Front_Arm8:0},{Lily_Front_Arm9:0},{Lily_whole_face_lvl_14:0},{Lily_Front_Arm12:0},{Lily_Front_Arm112:0},{Lily_Front_Arm13:0},{Lily_Back_Arm3:0},{Lily_Front_Arm14:0},{Lily_Front_Arm15:0},{Lily_Front_Arm113:0},{Lily_Back_Arm4:0},{houses_floorline:0},{main_back_house:0},{main_back_house2:0},{main_back_house4:0},{main_bottommenu_line:0},{main_clouds:0},{main_front_house:0},{main_front_house2:0},{main_grass:0},{main_play:0},{main_tree:0},{Main_MailBox:0},{main_clouds2:0},{lvl124_OBJ:0},{LVL214_obj:0},{amy_head:0},{avatarbg:0},{lvl121_obj1:0},{lvl207_bigdumbble:0},{callbutton:0},{closebuton:0},{lvl137_obj:0},{lvl140_obj:0},{finishline:0},{key:0},{general_localize_text:0},{hat:0},{index:0},{souceAngle:0},{lvl108_chocolatesouce:0},{lvl108_cookie:0},{lvl108_cookie_drop:0},{lvl108_drop:0},{lvl108_minitable:0},{lvl109_bone:0},{lvl109_dog1_angry:0},{lvl109_dog1_bark:0},{lvl109_dog1_calm:0},{lvl109_dog2_angry:0},{lvl109_dog2_bark:0},{lvl109_dog2_calm:0},{lvl109_rope_loose:0},{lvl109_rope_stiff:0},{lvl109_stick_out:0},{isLeft:0},{lvl109_stick_tided:0},{lvl110_box:0},{lvl110_emptyside:0},{lvl110_submit:0},{lvl111_ghost:0},{donaltCount:0},{BoundToLayout:0},{lvl111_plate3:0},{lvl111_sugarbig:0},{lvl111_sugargrains:0},{lvl111_sugargrains_single:0},{frstX:0},{lvl111_whitedonut:0},{lvl112_dog1_angry:0},{lvl112_dog1_bark:0},{lvl112_dog_moth:0},{lvl112_Fence:0},{lvl112_lilyStick:0},{lvl112_steak:0},{lvl112_stick:0},{lvl112_wall:0},{lvl114_obj11:0},{lvl114_obj2:0},{lvl114_obj3:0},{lvl114_obj4:0},{lvl114_trash:0},{lvl114_trash_front:0},{lvl116_Equal2:0},{lvl116_multiply:0},{lvl116_number10:0},{lvl116_number11:0},{lvl116_number12:0},{lvl116_number13:0},{lvl116_number6:0},{lvl116_number7:0},{lvl116_number8:0},{lvl116_number9:0},{lvl116_plus2:0},{lvl116_Qmark:0},{tapCount:0},{lvl118_bottle_flushed:0},{lvl118_bottle_splash:0},{lvl118_frog:0},{lvl118_frog_flying:0},{lvl118_hole2:0},{lvl118_jumplines:0},{lvl118_jumplines2:0},{lvl118_lake:0},{lvl118_leafbig:0},{lvl118_leafsmall:0},{maxCount:0},{lvl119_colorNumberText:0},{isRight:0},{lvl119_greenbutton:0},{lvl119_greencircle:0},{lvl119_greencircle2:0},{lvl119_handle:0},{isEnd:0},{lvl119_machine:0},{lvl119_redcircle:0},{lvl119_redcircle2:0},{lvl119_Screen_off:0},{lvl120_dog:0},{lvl120_dog1:0},{lvl120_dog10:0},{lvl120_dog11:0},{lvl120_dog12:0},{lvl120_dog2:0},{lvl120_dog3:0},{lvl120_dog4:0},{lvl120_dog5:0},{lvl120_dog6:0},{lvl120_dog7:0},{lvl120_dog8:0},{lvl120_dog9:0},{lvl120_dogHands:0},{lvl120_dogHandsLeft:0},{lvl120_dogHandsLeft2:0},{lvl120_dogLegs:0},{lvl120_dogLegs2:0},{lvl120_dogRightArm:0},{lvl120_martianThirdEye:0},{isTouch:0},{lvl120_NumberBG:0},{lvl120_road:0},{lvl120_speed:0},{lvl121_4Text:0},{lvl121_blackBody:0},{lvl121_greenpiece:0},{lvl121_hotdog:0},{lvl121_number2:0},{lvl121_pricesign:0},{lvl121_pricesign_leg:0},{currentOrder:0},{lvl121_rocket:0},{lvl121_rocket_flame:0},{lvl121_rocketglass:0},{lvl121_stand:0},{lvl121_whiteBody:0},{lvl122_astreoid_big:0},{direction:0},{lvl122_astreoid_crack:0},{lvl122_astreoid_piece:0},{lvl122_astreoid_piece2:0},{lvl122_astreoid_piece3:0},{targetX:0},{targetY:0},{Rotate:0},{lvl122_astreoid_small:0},{lvl122_star:0},{lvl122_star2:0},{lvl122_star3:0},{lvl122_star4:0},{lvl123_lily_eyes1:0},{lvl123_lilyEyes:0},{lvl123_lilyMouth:0},{lvl124_juicebox:0},{lvl124_juicepiece:0},{lvl124_tape:0},{lvl124_tapedmouth:0},{lvl124_water:0},{lvl125_astreoid_small:0},{lvl125_planet:0},{lvl125_planet1:0},{lvl125_planet3:0},{selfScale:0},{lvl125_sun2:0},{lvl126_astreoid_yellow:0},{waveOrder:0},{lvl126_mars:0},{lvl127_handleft:0},{lvl127_handright:0},{lvl127_hole2:0},{lvl127_mole:0},{lvl127_turtle:0},{lvl127_turtle_shadow:0},{lvl128_rope_straight:0},{lvl128_rope_tied:0},{lvl128_wings:0},{lvl129_leakcloud:0},{lvl129_leakcloud_smallpiece:0},{lvl129_leakcloud_smallpiece2:0},{lvl129_pipe:0},{lvl129_pipe2:0},{lvl129_pipe3:0},{lvl129_valve:0},{lvl129_worryMouth:0},{lvl131_flag:0},{lvl131_leftHand:0},{type:0},{lvl131_martianBody:0},{lvl131_martianEyesUp:0},{lvl131_martianGlass:0},{lvl131_martianHeadLine:0},{lvl131_martianHeads:0},{selfFrame:0},{lvl131_martianMouth:0},{lvl131_rightHand:0},{lvl131_whitemelon:0},{lvl131_whitemelon_piece:0},{lvl131_whitemelon_piece_left:0},{lvl131_whitewater:0},{lvl132_bed:0},{lvl132_cloud_big:0},{lvl132_cloud_big2:0},{lvl132_cloud_big3:0},{lvl132_cloud_explode:0},{lvl132_cloud_s:0},{lvl132_cloud_s2:0},{lvl132_cloud_s3:0},{lvl132_lava_explode:0},{lvl132_lava_floating:0},{lvl132_sand_dots:0},{lvl132_sandPatch:0},{lvl132_seePatch:0},{lvl132_sun2:0},{lvl132_sunglasses:0},{lvl132_umbrella:0},{lvl132_volcano:0},{lvl134_big_nonSquarePatch:0},{lvl134_big_SquarePatch:0},{lvl134_medium_nonsquare:0},{isNon:0},{lvl134_mediumSquare:0},{lvl134_small_nonsquare:0},{lvl134_smallSquare:0},{lvl135_rock:0},{touchCount:0},{lvl135_stick:0},{lvl136_bigphone:0},{lvl136_granny_body:0},{lvl136_granny_eyes:0},{lvl136_granny_eyes_lash:0},{lvl136_granny_hair:0},{lvl136_granny_head:0},{lvl136_granny_leftarm:0},{lvl136_granny_leftarmupper:0},{lvl136_granny_muth:0},{lvl136_granny_righthand:0},{lvl136_granny_rightHandUpper:0},{lvl136_granny_rightLeg:0},{lvl136_grannyLeftLeg:0},{lvl136_line:0},{lvl136_tikiavatar:0},{lvl136_vacuumcleaner:0},{lvl136_water:0},{lvl137_rival1_body:0},{lvl137_rival1_head:0},{lvl137_rival1_leftarm:0},{lvl137_rival1_leftarm1:0},{lvl137_rival1_leftLeg:0},{lvl137_rival1_leftLeg1:0},{lvl137_rival1_rightarm:0},{lvl137_rival1_rightarm1:0},{lvl137_rival1_rightLeg:0},{lvl137_rival1_rightLeg1:0},{lvl137_rival2_body:0},{lvl137_rival2_eyesPart:0},{lvl137_rival2_eyesPart1:0},{lvl137_rival2_eyesPart2:0},{lvl137_rival2_eyesPart3:0},{lvl137_rival2_eyesPart4:0},{lvl137_rival2_eyesPart5:0},{lvl137_rival2_eyesPart6:0},{lvl137_rival2_hip:0},{lvl137_rival2_leftarm:0},{lvl137_rival2_leftarm1:0},{lvl137_rival2_leftleg:0},{lvl137_rival2_leftleg1:0},{lvl137_rival2_mouth:0},{lvl137_rival2_mouth1:0},{lvl137_rival2_mouth2:0},{lvl137_rival2_mouth3:0},{lvl137_rival2_mouth4:0},{lvl137_rival2_rightarm:0},{lvl137_rival2_rightarm1:0},{lvl137_rival2_rightleg:0},{lvl137_rival2_rightleg1:0},{lvl138_camera:0},{lvl138_food:0},{lvl138_martian_Statue:0},{isShown:0},{lvl138_photoframe:0},{lvl138_quitar:0},{lvl139_bottle:0},{lvl139_bottleopener:0},{lvl139_closetopen:0},{lvl139_kol:0},{lvl139_laser_explosion:0},{lvl139_laser_laserline:0},{lvl139_remote_body:0},{lvl139_remote_handle:0},{lvl139_robot1_head:0},{lvl139_robot2_head:0},{lvl139_robot_standbig:0},{lvl139_scissors:0},{lvl139_soda_bottle:0},{lvl139_soda_cap:0},{lvl139_soda_gas:0},{lvl140_laptop:0},{lvl140_laptop_Table:0},{lvl140_martianHeadLine:0},{lvl140_photo:0},{lvl140_photo1:0},{lvl140_photo2:0},{lvl140_progressbar_bar:0},{lvl140_progressbar_frame:0},{lvl140_satellite:0},{lvl140_weakwifi:0},{lvl140_wifilinebig:0},{lvl140_wifilinemedium:0},{lvl140_wifilinesmall:0},{lvl156_cat6:0},{lvl156_dog:0},{lvl156_dogear_down:0},{lvl156_dogear_up:0},{lvl156_donkey:0},{lvl156_fly:0},{lvl156_fly_line:0},{lvl158_giraffe:0},{lvl158_happycat_:0},{lvl158_ruler:0},{lvl159_bluebutton:0},{lvl159_greenbutton:0},{lvl159_paint:0},{isFake:0},{lvl159_redbutton:0},{lvl159_water:0},{lvl159_watersplash:0},{lvl162_blackbird:0},{lvl162_bluebird:0},{lvl162_brush:0},{lvl162_grasspiece:0},{lvl162_paintbucket:0},{lvl162_paintonbrush:0},{lvl162_whitebird:0},{lvl163_answerbubble:0},{lvl163_number2:0},{lvl163_number4:0},{lvl163_number7:0},{lvl163_question:0},{lvl163_think:0},{lvl163_think2:0},{lvl165_amy_body:0},{lvl165_bluerabbit:0},{lvl165_button:0},{lvl165_car:0},{lvl165_happygirl:0},{lvl165_helmet:0},{lvl165_man2_happy:0},{lvl165_pinkrabbit:0},{lvl165_slug:0},{lvl165_startText:0},{lvl180_burnt_smoke:0},{lvl180_closet_open:0},{lvl180_flame_big:0},{lvl180_flame_cloud_big:0},{lvl180_flame_cloud_small:0},{lvl180_lid:0},{lvl180_oil:0},{lvl180_pan:0},{lvl180_water:0},{lvl180_waterbottle:0},{lvl180_waterbottle_pouring:0},{lvl205_cips:0},{lvl205_cips2:0},{lvl205_cips3:0},{lvl205_cips4:0},{lvl205_cipspack:0},{lvl205_fork:0},{lvl205_napkin:0},{lvl205_vacuum:0},{lvl205_vacuum_pipebobba:0},{lvl205_vacuumpipe_normal:0},{lvl207_bigplant:0},{lvl207_cheesesouce:0},{lvl207_clock:0},{lvl207_flowers:0},{lvl207_mouseeating:0},{lvl207_reward:0},{lvl207_shelf:0},{lvl207_shelf2:0},{lvl2_bottle:0},{lvl2_cabinet2:0},{lvl2_closeddoor:0},{lvl2_hairpiece_:0},{lvl2_napkinbox:0},{lvl2_opendoor:0},{lvl2_pimple:0},{lvl2_toothbrush:0},{lvl2_toothpaste:0},{Mars_floor:0},{stick_floorline:0},{lvl139_closetopen2:0},{"115_bg":0},{"115_bush":0},{"9patch":0},{"9patch3":0},{"9patch4":0},{bag_layer:0},{block:0},{body2:0},{broken:0},{CharacterNames:0},{Characters:0},{comingsoon:0},{comingsoonText:0},{compressor_pipe:0},{computer_screen:0},{CSV:0},{currency_plus:0},{doorhandles:0},{DrWorry_Mouth:0},{empty_bottle:0},{equal:0},{fakeCol:0},{fakeDrag:0},{fakeLily:0},{floorline3:0},{floorpatternHD:0},{frame_:0},{gamerocket:0},{GrannyAmy_Back_Arm:0},{GrannyAmy_Back_Arm2:0},{GrannyAmy_Back_Leg:0},{GrannyAmy_Eyes:0},{GrannyAmy_Eyes_Inside2:0},{GrannyAmy_Front_Arm:0},{GrannyAmy_Front_Arm2:0},{GrannyAmy_Front_Leg:0},{GrannyAmy_happymouth:0},{GrannyAmy_Mouth:0},{GrannyAmy_Parcali2:0},{GrannyAmy_Parcali3:0},{GrannyAmy_scary_face:0},{grass:0},{grasspiece:0},{green_ground:0},{greenBattery:0},{gun:0},{head:0},{head2:0},{hole:0},{homeIcon:0},{IntroLoadingText:0},{jenny_arm_muscle:0},{jenny_back_arm:0},{jenny_back_arm2:0},{jenny_back_leg:0},{jenny_back_leg2:0},{rivalCount:0},{jenny_body:0},{jenny_brows_normal:0},{jenny_eye_lids2:0},{jenny_eyes:0},{jenny_eyes_inside:0},{jenny_front_arm:0},{jenny_front_arm2:0},{jenny_front_arm_mirrored:0},{jenny_front_leg:0},{jenny_front_leg2:0},{jenny_hair_0:0},{jenny_hand:0},{jenny_hand_ball:0},{jenny_head:0},{jenny_head_empty:0},{jenny_mouth:0},{jenny_racket:0},{jennygloves_back:0},{keyboard2:0},{keyboard_letter:0},{l67jennygloves_front:0},{l77jenny_racket_hand:0},{LanguageOrderDic:0},{larry_arm:0},{larry_arm2:0},{larry_bodyback:0},{larry_cut_body:0},{larry_headback:0},{LazyLarry_back_arm:0},{LazyLarry_back_arm2:0},{LazyLarry_back_foot:0},{LazyLarry_backleg:0},{LazyLarry_body:0},{LazyLarry_brows_normal:0},{LazyLarry_brows_scared:0},{LazyLarry_eyelid_left:0},{LazyLarry_eyelid_right:0},{LazyLarry_eyes:0},{LazyLarry_eyes_left:0},{LazyLarry_eyes_right:0},{LazyLarry_frontarm:0},{LazyLarry_frontarm2:0},{LazyLarry_frontfoot:0},{LazyLarry_frontleg:0},{Levelend_ADS:0},{LevelEnd_CharacterBG:0},{levelsIcon:0},{LevelsLogicHolder:0},{Lily_Back_Arm_5:0},{Lily_Back_Leg_3:0},{Lily_Back_Leg_4:0},{Lily_Body6:0},{Lily_brows_normal:0},{Lily_eyes_closed:0},{Lily_eyes_closed2:0},{Lily_eyes_inside2:0},{Lily_eyes_tired:0},{Lily_finger_point2:0},{Lily_Front_Arm10:0},{Lily_Front_Arm11:0},{Lily_Front_Leg_3:0},{Lily_Front_Leg_4:0},{Lily_Hair_Piece_5:0},{Lily_Hair_Piece_6:0},{Lily_hand_with_comb2:0},{Lily_happy_eyes_lid:0},{Lily_Head4:0},{Lily_mouth:0},{Lily_mouth_little:0},{Lily_mouth_soangry:0},{Lily_mouth_unhappy:0},{Lily_mouth_water:0},{Lily_new_eyes:0},{Lily_phone_arm:0},{Lily_sad_face:0},{Lily_Skirt2:0},{Lily_Smile2:0},{liontail:0},{LittleTiki_back_arm:0},{LittleTiki_back_arm2:0},{LittleTiki_backleg:0},{LittleTiki_body:0},{LittleTiki_brows_tricky:0},{LittleTiki_eyes:0},{LittleTiki_eyes_inside:0},{LittleTiki_front_arm:0},{LittleTiki_front_arm2:0},{LittleTiki_front_leg:0},{LittleTiki_head:0},{LittleTiki_mouth_tricky:0},{LittleTiki_pocket:0},{LittleTiki_skirt:0},{loading_bg:0},{loading_frame:0},{lowbattery:0},{lvl114_obj:0},{lvl115_angrylion:0},{lvl115_babylion:0},{lvl115_grass2:0},{lvl115_grass3:0},{lvl115_lion1_leg:0},{isPlaced:0},{lvl115_lionmane:0},{lvl115_liontail2:0},{"lvl115_Lon":0},{lvl115_motherlion:0},{lvl248_cup_epmty:0},{lvl248_cup_full:0},{lvl79housepatch:0},{lvl79windowPatch:0},{lvl_100_brokenbutton:0},{lvl_100_cglue:0},{lvl_100_No_Text:0},{isClickable:0},{lvl_100_nobutton:0},{lvl_100_tape:0},{lvl_100_Yes_Text:0},{lvl_100_Yes_Text2:0},{lvl_107_hill:0},{lvl_107_hill2:0},{lvl_107_Jump_Text:0},{lvl_11_restart:0},{lvl_11_submit:0},{lvl_11_submitarea:0},{lvl_14_picturefrmae:0},{lvl_14_plant:0},{lvl_14_shelf:0},{lvl_21_bottles:0},{lvl_21_bottles_:0},{lvl_21_bottles_1:0},{lvl_21_drawer:0},{lvl_21_table:0},{lvl_24_wateringcan:0},{lvl_26_barrel:0},{lvl_28_shelf:0},{lvl_29_blood_bottle:0},{lvl_29_robot:0},{lvl_29_robot_bottom:0},{lvl_29_robot_on:0},{lvl_29_robot_plug:0},{lvl_2_fake_drag:0},{inRobot:0},{DestroyOutsideLayout:0},{lvl_30_battery:0},{lvl_30_bucket:0},{lvl_30_curtain_closed:0},{lvl_30_curtain_open:0},{lvl_30_plug:0},{lvl_30_waterlayer:0},{lvl_42_apple:0},{lvl_43_knife:0},{lvl_49_wood:0},{lvl_50_bucket:0},{lvl_50_notes1:0},{lvl_50_notes2:0},{lvl_50_water:0},{lvl_52_pizza:0},{lvl_53_greenapple:0},{lvl_53_redapple:0},{lvl_54_dashed_line:0},{lvl_57_bubble:0},{lvl_57_coke:0},{lvl_57_extinqusher:0},{lvl_57_flame:0},{lvl_57_hotsouce:0},{lvl_57_kitchencounter:0},{lvl_57_milk:0},{lvl_57_milk_spilled:0},{lvl_57_milk_spilled2:0},{lvl_57_pepper:0},{lvl_57_pot:0},{lvl_57_salt:0},{lvl_57_shelf:0},{lvl_57_stove:0},{lvl_57_suce_white:0},{lvl_58_climateremote:0},{lvl_58_climateremoteText:0},{lvl_58_fan:0},{lvl_58_fireplace2:0},{lvl_58_glass_empty:0},{lvl_58_milk:0},{lvl_58_paper:0},{canTurn:0},{lvl_58_paperplane:0},{lvl_58_table3:0},{lvl_58_tablecloth:0},{lvl_58_toy_plane:0},{lvl_58_windlines:0},{lvl_59_arm_left:0},{lvl_59_button:0},{lvl_59_connection:0},{lvl_59_eyes_closed:0},{lvl_59_lamp_off:0},{lvl_59_leg_left:0},{isArmCollided:0},{isLegCollided:0},{lvl_59_robot_body:0},{lvl_59_robot_head:0},{lvl_59_screw:0},{lvl_59_stand:0},{lvl_59_table3:0},{lvl_59_tabletop_9slice:0},{lvl_59_toolbox:0},{lvl_59_wrench:0},{lvl_60_boat_waterlayer:0},{lvl_60_boathook_left:0},{lvl_60_boathook_rigth:0},{lvl_60_fishhook_stick:0},{lvl_60_fishhook_string_left:0},{lvl_60_fishhook_string_right:0},{lvl_60_hookpiece:0},{lvl_60_sea:0},{lvl_60_vesthook_back:0},{lvl_60_wave:0},{lvl_60_wave2:0},{lvl_60_waveline1:0},{lvl_60_waveline2:0},{lvl_60_waveline3:0},{lvl_60_west_bobba:0},{lvl_60_west_lily:0},{lvl_61_banana:0},{lvl_61_banana2:0},{lvl_61_bird:0},{lvl_61_bush:0},{lvl_61_bush1:0},{lvl_61_floorHD:0},{lvl_62_ball2:0},{lvl_62_basket_front:0},{lvl_62_direk:0},{lvl_62_emptybottle:0},{lvl_62_milk:0},{lvl_62_pota:0},{lvl_62_pota_layer:0},{lvl_62_screw:0},{lvl_65_finishline:0},{lvl_65_rabbit:0},{lvl_65_siderobot_arm_left:0},{lvl_65_siderobot_arm_right:0},{lvl_65_siderobot_body:0},{lvl_65_siderobot_body2:0},{lvl_65_siderobot_eyesclosed:0},{lvl_65_siderobot_eyesclosed2:0},{lvl_65_siderobot_head:0},{lvl_65_siderobot_head2:0},{lvl_65_siderobot_leg_left:0},{lvl_65_siderobot_leg_left2:0},{lvl_65_siderobot_leg_left3:0},{lvl_65_siderobot_off:0},{lvl_65_siderobot_off2:0},{lvl_65_turtle:0},{lvl_66_100_Weight_Text:0},{lvl_66_dumbbell:0},{lvl_66_dumbbell_hand:0},{lvl_66_waterbottle:0},{lvl_66_weight:0},{lvl_66_Weight_Text:0},{lvl_66_weights:0},{lvl_67_ring_floor:0},{lvl_67_ring_sides:0},{lvl_67_robot_armbend:0},{lvl_67_robot_armbend2:0},{lvl_67_robot_backclosed:0},{lvl_67_robot_body:0},{lvl_67_robot_head:0},{lvl_67_robotgloves_back:0},{lvl_68_ball:0},{lvl_68_balloon_cat_deflated:0},{lvl_68_balloon_green_deflated:0},{lvl_68_balloon_red_deflated:0},{lvl_68_balloon_yellow_deflated:0},{lvl_68_compressor_pipe:0},{lvl_69_ant:0},{lvl_69_big_rock:0},{leafCount:0},{lvl_69_caterpillar:0},{lvl_69_cocoon:0},{growthRate:0},{lvl_69_cocoon_inside:0},{lvl_69_grass:0},{lvl_69_leaf:0},{lvl_69_small_rock:0},{lvl_69_tree:0},{lvl_70_flower_big:0},{lvl_70_jar:0},{lvl_70_net:0},{lvl_71_lefthand_front:0},{lvl_71_righthand_front:0},{lvl_72_basket_back:0},{lvl_72_donkey:0},{lvl_72_donkey_eyes:0},{lvl_72_donkeymouth_back:0},{lvl_72_donkeymouth_front:0},{lvl_73_hammer:0},{lvl_74_net_back:0},{lvl_74_netbig:0},{lvl_75_gramaphone:0},{lvl_75_movementsign1:0},{lvl_75_movementsign2:0},{lvl_75_sidetable:0},{lvl_76_car_green:0},{lvl_76_car_red:0},{lvl_76_ground:0},{kickCount:0},{lvl_77_tennisball:0},{lvl_78_canopener:0},{lvl_78_full_jar:0},{lvl_78_pickle:0},{lvl_78_picklewater:0},{lvl_79_home_9slice_left:0},{lvl_79_roof:0},{lvl_7_bowl_back:0},{lvl_7_bowl_front:0},{lvl_7_tuna:0},{lvl_80_chair_back:0},{lvl_80_chair_mirrored:0},{lvl_80_chair_side:0},{lvl_80_flash:0},{lvl_81_cliff:0},{lvl_81_grass:0},{lvl_82_clock_bg:0},{lvl_82_coffee:0},{lvl_82_coffee_cup:0},{lvl_82_coffee_hand:0},{lvl_82_coffee_machine:0},{lvl_82_coffee_pot:0},{lvl_82_dots:0},{lvl_82_number_0:0},{lvl_82_number_2:0},{lvl_82_number_8:0},{lvl_82_water:0},{lvl_83_bulb:0},{isGreen:0},{connected:0},{lvl_83_button:0},{lvl_83_cables_left:0},{lvl_83_cables_rigth:0},{lvl_83_connection:0},{lvl_83_shine:0},{lvl_83_Text:0},{lvl_85_battery:0},{lvl_85_car:0},{lvl_85_exhaust:0},{lvl_85_fuel_splash:0},{lvl_85_fuelbottle:0},{lvl_85_lid:0},{lvl_85_lidopen:0},{lvl_85_tool:0},{lvl_85_tool2:0},{lvl86TenpinCount:0},{lvl_86_ball:0},{lvl_86_tenpin:0},{lvl_88_button:0},{lvl_88_game_explode:0},{lvl_88_treadmill:0},{lvl_88_treadmill_movement:0},{lvl_88_treadmill_movement_mask:0},{lvl_89_Letter:0},{lvl_89_submitarea_text:0},{lvl_8_cloud:0},{lvl_8_cloud1:0},{lvl_8_cloud2:0},{lvl_8_cloud3:0},{lvl_8_moon:0},{lvl_90_9patch5:0},{isStriking:0},{strikeCount:0},{isGameOver:0},{lvl_90_ball:0},{waterCount:0},{lvl_90_goalkeeper:0},{lvl_90_goalkeeper_arm_left:0},{lvl_90_goalkeeper_arm_right:0},{lvl_90_goalkeeper_belly:0},{lvl_90_ground:0},{lvl_90_kale:0},{lvl_90_keeper_face:0},{lvl_91_Cracker:0},{lvl_91_wallnut:0},{lvl_91_wallnut_not_dragable:0},{isMarble:0},{lvl_92_blue:0},{lvl_92_green:0},{lvl_92_green2:0},{lvl_92_needle_bottom:0},{lvl_92_orange:0},{lvl_92_pink:0},{lvl_92_purple:0},{lvl_92_purple1:0},{lvl_92_red:0},{lvl_92_yellow:0},{isMirrored:0},{isEmpty:0},{lvl_93_location:0},{isFalling:0},{lvl_93_sky:0},{lvl_93_speedline_:0},{lvl_93_speedline_2:0},{lvl_95_catear:0},{lvl_95_mic:0},{lvl_95_number_bg:0},{lvl_95_NumberTxt:0},{lvl_95_screen_big:0},{lvl_96_cableplugged:0},{lvl_97_banana_peal:0},{lvl_97_face:0},{lvl_97_gunfire:0},{lvl_97_headphones:0},{lvl_97_man_body:0},{lvl_98_speedlines:0},{lvl_99_fingers:0},{lvl_99_ketchupp:0},{lvl_99_ketchupp_pour:0},{lvl_99_ketchupp_splash:0},{lvl_99_mouse:0},{lvl_99_robot_Arm2:0},{m_105_astreoid:0},{m_105_astreoid_flame:0},{m_105_astreoid_flamepiece:0},{m_105_astreoid_flamepiece1:0},{m_105_astreoid_flamepiece3:0},{m_105_background:0},{m_105_planet:0},{m_105_planet1:0},{m_105_stars:0},{m_105_world_whole:0},{weigh:0},{m_106_chicken:0},{m_106_chicken1:0},{m_106_chicken2:0},{m_106_mushroomm:0},{m_106_weighText:0},{m_107_bridge:0},{m_107_jump:0},{m_9patch:0},{m_9patch2:0},{m_9patch3:0},{m_9patch4:0},{m_bag:0},{m_battery:0},{m_bigbutton:0},{mirrored:0},{m_bird_west:0},{m_black:0},{m_blueweight:0},{m_boat:0},{wheelCounter:0},{m_Bobba_Body_Fat_Left:0},{m_Bobba_Body_Fat_Right:0},{m_Bobba_Eating_Mouth_Mirror:0},{m_Bobba_EatingBrows_Mirror:0},{m_Bobba_Eyes_Small_Mirror:0},{m_Bobba_sleep_mouth:0},{m_bush3:0},{m_Butterfly_body:0},{m_Butterfly_left_wing:0},{m_Butterfly_right_wing:0},{m_ButtonText:0},{m_cips:0},{m_cipspack:0},{m_coffe_Steam:0},{m_computer_cable:0},{m_computer_kasa:0},{m_coverSprite:0},{m_DrWorry_Arm_Back_:0},{m_DrWorry_Arm_Back_2:0},{m_DrWorry_Arm_Back_3:0},{m_DrWorry_Arm_Front_:0},{m_DrWorry_Arm_Front_2:0},{m_DrWorry_Back_Leg:0},{m_DrWorry_Body:0},{m_DrWorry_Brows_Angry:0},{m_DrWorry_Eyes_Inside_Normal:0},{m_DrWorry_Front_Leg:0},{m_DrWorry_Glasses:0},{m_DrWorry_Head2:0},{collisionCount:0},{m_fakeCol:0},{cipsCount:0},{m_fakeCol2:0},{m_fakeCol3:0},{m_fakeDragable:0},{m_ground:0},{m_LazyLarry_head:0},{m_LazyLarry_mouth_normal:0},{m_LazyLarry_smart_object_left:0},{m_LazyLarry_smart_object_right:0},{m_Lily_Front_Arm10:0},{m_Lily_Front_Arm11:0},{m_LittleTiki_body:0},{m_LittleTiki_eyes:0},{m_LittleTiki_eyes_inside:0},{m_LittleTiki_mouth_tricky:0},{VerticalMovement:0},{HorizontalMovement:0},{m_movement_Sprite:0},{m_skate:0},{m_tennis_ground:0},{m_wall:0},{m_wallpatternHD:0},{m_weigher:0},{m_white:0},{m_window:0},{m_window_shine:0},{m_x:0},{m_y:0},{mat_backarm2:0},{mat_backarm2_white:0},{mat_backfoot:0},{mat_backleg:0},{mat_body:0},{mat_brows_eaing:0},{mat_drops:0},{mat_eyes:0},{mat_front_foot:0},{mat_frontarm:0},{mat_frontarm2_white:0},{mat_frontleg:0},{mat_head:0},{mat_hip:0},{mat_mouth:0},{mat_pocket:0},{motor:0},{motor2:0},{motor_maskHD:0},{motor_maskHD2:0},{mouse:0},{multply:0},{musicIcon:0},{nb_apple:0},{nb_ball2:0},{nb_barrel:0},{nb_basementwall:0},{nb_batter_dirth:0},{isDirtOff:0},{nb_battery:0},{nb_beans:0},{nb_beans_:0},{nb_bear_angry:0},{nb_bear_angryeyes:0},{nb_bear_angrymouth:0},{nb_bearangry_armback:0},{nb_bearangry_armfront:0},{nb_bearangry_backleg:0},{nb_bearangry_frontleg:0},{nb_big_rock:0},{bagCounter:0},{nb_BigBag:0},{nb_BigBag_Openpiece:0},{noteCounter:0},{nb_bignote:0},{nb_bignote2:0},{nb_bignote3:0},{nb_bigphone:0},{nb_blackboard:0},{nb_Bobba_Arm_Back:0},{nb_Bobba_Arm_Back4:0},{nb_Bobba_Arm_Front:0},{nb_Bobba_Arm_Front5:0},{nb_Bobba_Body_Fat_Left:0},{nb_Bobba_Body_Fat_Right:0},{nb_Bobba_Brows_Angry:0},{nb_Bobba_Eating_Head:0},{nb_Bobba_Eating_Head2:0},{nb_Bobba_Eating_Mouth:0},{nb_Bobba_Eating_Mouth_Mirror:0},{nb_Bobba_EatingBrows:0},{nb_Bobba_EatingBrows3:0},{nb_Bobba_EatingBrows_Mirror:0},{nb_Bobba_Eyelids:0},{nb_Bobba_Eyes_Normal:0},{nb_Bobba_Eyes_Normal3:0},{nb_Bobba_Eyes_Small:0},{nb_Bobba_Eyes_Small2a:0},{nb_Bobba_Eyes_Small_Mirror:0},{nb_Bobba_Hip:0},{nb_Bobba_Leg_Back:0},{nb_Bobba_Leg_Front:0},{nb_Bobba_Mouth_:0},{nb_Bobba_Mouth_Angry:0},{cokeCounter:0},{nb_Bobba_Mouth_Normal_Happy:0},{nb_bones:0},{nb_book:0},{nb_book_:0},{nb_book_2:0},{nb_books:0},{nb_books2:0},{nb_bottle:0},{nb_bottle2:0},{nb_bottles_:0},{nb_bottles_2:0},{FirstX:0},{FirstY:0},{nb_bottles_3:0},{nb_bottles_4:0},{nb_bottles_5:0},{nb_bowl_front:0},{nb_box:0},{nb_box_back:0},{candyCount:0},{allCandiesCount:0},{mouthCandyCount:0},{isGameEnd:0},{nb_box_front:0},{nb_box_lid:0},{nb_boxbroken_lid:0},{nb_boxbroken_piece:0},{nb_boxbroken_piece2:0},{nb_brush:0},{nb_Bubba_Shower_Left_Arm:0},{nb_Bubba_Shower_Right_Arm:0},{nb_Bubba_Shower_Soap:0},{nb_BubbaFootball_Arm_Back:0},{nb_BubbaFootball_Arm_Front:0},{nb_BubbaFootball_Big_Mouth:0},{nb_BubbaFootball_Body_Head:0},{nb_BubbaFootball_Cry_Drops:0},{nb_BubbaFootball_Crying_Eyes:0},{nb_BubbaFootball_Crying_Loud:0},{nb_BubbaFootball_Leg_Back:0},{nb_BubbaFootball_Leg_Front:0},{nb_BubbaShower_Armless:0},{nb_bucket:0},{nb_bump_big:0},{nb_bump_small:0},{nb_bus:0},{nb_cake:0},{nb_candles:0},{nb_candles2:0},{nb_candles3:0},{nb_candles4:0},{nb_candy:0},{nb_candy1_package:0},{nb_candy2:0},{nb_candy2_package:0},{nb_candy3:0},{nb_candy4:0},{nb_carpet2:0},{nb_cartoon_arm:0},{nb_cartoon_boy:0},{nb_cartoon_channel:0},{nb_cat_arms:0},{nb_cat_flame:0},{nb_cat_head:0},{nb_cat_sadface:0},{nb_cat_sleeping:0},{nb_cat_tail2:0},{nb_cateyes_scared:0},{nb_cateyes_sleeping:0},{nb_catmouth_normal:0},{nb_catmouth_scared:0},{nb_catsleeping:0},{nb_chalk:0},{nb_chalk2:0},{nb_cheese:0},{nb_chicken:0},{nb_chicken2:0},{nb_chickenbox_closed:0},{nb_chickenbox_openpiece:0},{nb_chocolate:0},{nb_chocolate_marks:0},{nb_Cips:0},{nb_cleanerspray:0},{nb_climateremote:0},{nb_closed:0},{nb_closet:0},{isOpen:0},{nb_closet_open:0},{nb_clue:0},{nb_coke:0},{nb_control:0},{nb_control4:0},{nb_cow:0},{nb_crack:0},{nb_cup:0},{nb_curtain:0},{nb_curtain_rope:0},{nb_curtain_top:0},{nb_cushion:0},{nb_delete:0},{nb_drawer:0},{nb_drawer_open:0},{nb_drawer_open2:0},{nb_drums:0},{nb_drums_baget:0},{nb_DrWorry_Arm_Back_:0},{nb_DrWorry_Arm_Back_2:0},{nb_DrWorry_Arm_Front_:0},{nb_DrWorry_Arm_Front_2:0},{nb_DrWorry_Back_Leg:0},{nb_DrWorry_Body:0},{nb_DrWorry_Brows_Angry:0},{nb_DrWorry_Eyes_Inside_Big:0},{nb_DrWorry_Eyes_Inside_Normal:0},{nb_DrWorry_Front_Leg:0},{nb_DrWorry_Glasses:0},{nb_DrWorry_Head2:0},{nb_DrWorry_Mouth_Sad_:0},{nb_eggplant:0},{nb_electricHD:0},{nb_empty_bottle:0},{nb_eraser:0},{nb_fancyplate_big:0},{nb_fancyplate_big2:0},{nb_fancyplate_small:0},{nb_fancyplate_small2:0},{nb_fancyplate_small3:0},{nb_Fatrhino_backlegs:0},{nb_Fatrhino_body:0},{nb_Fatrhino_fronlegs:0},{isFatrinhoVisible:0},{nb_Fatrhino_head:0},{nb_fence:0},{nb_fish_red:0},{nb_five:0},{nb_flame:0},{nb_flashlight:0},{nb_floor_right:0},{nb_floorline2:0},{nb_flower:0},{isOnFace:0},{nb_fly:0},{isFilledBlood:0},{isShot:0},{goneToPlace:0},{TouchX:0},{TouchY:0},{nb_fly_normal:0},{nb_flyswatter:0},{nb_frozen:0},{nb_frozen2:0},{nb_frozen3:0},{nb_frozen4:0},{nb_frozenlily:0},{nb_gas_cloud:0},{nb_gas_green:0},{nb_gasmask:0},{nb_gastube:0},{nb_gem:0},{nb_glasses:0},{nb_glasses_empty:0},{nb_glasses_tattoo:0},{nb_glassofwater2:0},{nb_GrannyAmy_Back_Arm:0},{nb_GrannyAmy_Back_Arm2:0},{nb_GrannyAmy_Back_Leg:0},{nb_GrannyAmy_Body:0},{nb_GrannyAmy_Body2:0},{yPOS:0},{nb_GrannyAmy_Eyes:0},{nb_GrannyAmy_Eyes_Inside2:0},{nb_GrannyAmy_Front_Arm:0},{nb_GrannyAmy_Front_Arm2:0},{nb_GrannyAmy_Front_Leg:0},{nb_GrannyAmy_head:0},{nb_GrannyAmy_Mouth:0},{StopCount:0},{nb_GrannyAmy_Sleeping_Body:0},{nb_GrannyAmy_Sleeping_Legs:0},{nb_grapes:0},{nb_greenbottle:0},{nb_hair:0},{nb_halfcake:0},{nb_hammer:0},{nb_hand:0},{nb_hand_back:0},{nb_hand_front:0},{nb_happybear:0},{nb_headphone_half:0},{nb_headphone_whole:0},{nb_horn:0},{nb_hotsouce:0},{nb_icecream:0},{nb_icecream2:0},{nb_idcard_big:0},{nb_idcard_small:0},{nb_keyboard_bg:0},{nb_keyboard_bg2:0},{nb_keyboard_close:0},{nb_KeyboardText:0},{nb_kitchencounter:0},{nb_knife:0},{nb_knight_body:0},{nb_knight_head:0},{nb_knight_shield:0},{nb_Laptop:0},{nb_lava:0},{nb_LazyLarry_Back_Arm_2:0},{nb_LazyLarry_Back_Arm_Comb:0},{nb_LazyLarry_Back_Arm_Comb2:0},{nb_LazyLarry_Back_Foot:0},{nb_LazyLarry_Back_Leg:0},{nb_LazyLarry_Body:0},{nb_LazyLarry_Brows_Normal:0},{nb_LazyLarry_Eyelids:0},{nb_LazyLarry_Eyes:0},{nb_LazyLarry_Eyes_Inside:0},{nb_LazyLarry_Front_Arm_:0},{nb_LazyLarry_Front_Arm_2:0},{nb_LazyLarry_Front_Foot:0},{nb_LazyLarry_Front_Leg:0},{nb_LazyLarry_Head_Bold:0},{nb_LazyLarry_Head_Bold_Mirrored:0},{nb_LazyLarry_Head_Hairy:0},{nb_LazyLarry_Head_Hairy_Mirrored:0},{nb_LazyLarry_Hip:0},{nb_LazyLarry_Mouth_Normal:0},{nb_LazyLarry_Pocket:0},{nb_letterx:0},{nb_lettery:0},{nb_letterz:0},{nb_light:0},{nb_Lily_Angry:0},{nb_Lily_Back_Arm_:0},{nb_Lily_Back_Arm_3:0},{nb_Lily_Back_Arm_5:0},{nb_Lily_Back_Arm_Bottom:0},{nb_Lily_Back_Leg_:0},{nb_Lily_Back_Leg_2:0},{nb_Lily_Back_Leg_3:0},{nb_Lily_Back_Leg_4:0},{nb_Lily_Back_Leg_5:0},{nb_Lily_Back_Leg_6:0},{nb_Lily_Back_Leg_7:0},{nb_Lily_bare_foot:0},{nb_Lily_Body2:0},{nb_Lily_Body4:0},{nb_Lily_Body5:0},{nb_Lily_Body6:0},{nb_Lily_Brows:0},{nb_Lily_Crying:0},{nb_Lily_Curious:0},{nb_Lily_Eyes:0},{nb_Lily_Eyes_Inside:0},{nb_Lily_finger_point2:0},{nb_Lily_Front_Arm:0},{nb_Lily_Front_Arm10:0},{nb_Lily_Front_Arm2:0},{nb_Lily_Front_Arm3:0},{nb_Lily_Front_Arm4:0},{nb_Lily_Front_Arm5:0},{nb_Lily_Front_Arm6:0},{nb_Lily_Front_Arm7:0},{nb_Lily_Front_Arm8:0},{nb_Lily_Front_Arm9:0},{nb_Lily_Front_Leg_:0},{nb_Lily_Front_Leg_2:0},{nb_Lily_Front_Leg_3:0},{nb_Lily_Front_Leg_4:0},{nb_Lily_Front_Leg_5:0},{nb_Lily_hair_electric:0},{nb_Lily_Hair_Piece_:0},{nb_Lily_Hair_Piece_2:0},{nb_Lily_Hair_Piece_3:0},{nb_Lily_Hair_Piece_4:0},{nb_Lily_Hair_Piece_5:0},{nb_Lily_Hair_Piece_6:0},{nb_Lily_Hair_Piece_7:0},{nb_Lily_Hair_Piece_8:0},{nb_Lily_Happy2:0},{nb_Lily_Head2:0},{nb_Lily_Head3:0},{nb_Lily_Head4:0},{nb_Lily_Lids:0},{nb_Lily_mouth_scared:0},{nb_Lily_Normal:0},{nb_Lily_Normal2:0},{nb_Lily_Skirt:0},{nb_Lily_Skirt2:0},{nb_Lily_Skirt3:0},{nb_Lily_Smile:0},{nb_Lily_straight_hair:0},{nb_line2:0},{nb_lines:0},{nb_lines2:0},{nb_lines3:0},{nb_LittleTiki_back_arm:0},{nb_LittleTiki_back_arm2:0},{nb_LittleTiki_back_arm3:0},{nb_LittleTiki_backleg:0},{nb_LittleTiki_body:0},{nb_LittleTiki_brows_tricky:0},{nb_LittleTiki_eyes:0},{nb_LittleTiki_eyes_happy_closed:0},{nb_LittleTiki_eyes_inside:0},{nb_LittleTiki_front_arm:0},{nb_LittleTiki_front_arm2:0},{nb_LittleTiki_front_leg:0},{isSofaGetBigger:0},{nb_LittleTiki_head:0},{nb_LittleTiki_head2:0},{nb_LittleTiki_mouth_tricky:0},{nb_LittleTiki_Parcaliai:0},{nb_LittleTiki_pocket:0},{nb_LittleTiki_skirt:0},{nb_lizard:0},{nb_lizard_stand:0},{nb_lizard_tongue2:0},{nb_lock:0},{nb_lonelycat:0},{nb_lowbattery:0},{nb_lvl_102_txt:0},{nb_lvl_103_screen:0},{nb_lvl_11_keyboard_text:0},{Order:0},{isTyped:0},{nb_lvl_11_password_single_1:0},{nb_lvl_11_password_single_2:0},{nb_lvl_11_password_single_3:0},{nb_lvl_11_password_single_4:0},{nb_lvl_11_password_single_5:0},{nb_lvl_11_password_single_6:0},{nb_lvl_11_password_text_1:0},{nb_lvl_11_password_text_2:0},{nb_lvl_11_password_text_3:0},{nb_lvl_11_password_text_4:0},{nb_lvl_11_password_text_5:0},{nb_lvl_151_carpet:0},{nb_lvl_151_fireplace:0},{nb_lvl_151_sofa:0},{nb_lvl_152_smalltable:0},{nb_lvl_157_chicken:0},{nb_lvl_19_catfood:0},{nb_lvl_19_trumphet:0},{nb_lvl_1_sun:0},{correctAnswer:0},{isDragging:0},{nb_lvl_20_dragabble_text:0},{nb_lvl_20_pay_text:0},{nb_lvl_21_name_text:0},{isTapped:0},{nb_lvl_22_answer_text:0},{nb_lvl_22_new_char_text:0},{nb_lvl_27_fake_gold:0},{nb_lvl_27_gold:0},{nb_lvl_27_package:0},{nb_lvl_29_fake_col:0},{nb_lvl_30_bucket2:0},{nb_lvl_30_curtain_closed:0},{nb_lvl_30_curtain_open:0},{nb_lvl_30_sink2:0},{isSwiped:0},{nb_lvl_31_floor_main:0},{nb_lvl_31_floor_part:0},{nb_lvl_31_floor_part2:0},{isWidthScaled:0},{isHeightScaled:0},{isTikiNearRight:0},{isTikiFarRight:0},{nb_lvl_33_sofa_9patch:0},{nb_lvl_36_candy_inside_1:0},{nb_lvl_36_candy_inside_2:0},{nb_lvl_36_candy_inside_3:0},{nb_lvl_3_cat3:0},{nb_lvl_3_cat7:0},{nb_lvl_3_fish:0},{nb_lvl_3_welcome_text:0},{nb_lvl_44_coil:0},{nb_lvl_44_connection_:0},{nb_lvl_44_connection_2:0},{nb_lvl_44_connection_3:0},{nb_lvl_44_connection_4:0},{nb_lvl_44_powerball:0},{nb_lvl_44_powerlines_:0},{nb_lvl_44_powerlines_2:0},{nb_lvl_44_powerlines_3:0},{nb_lvl_44_powerlines_4:0},{nb_lvl_44_shape_:0},{nb_lvl_44_shape_2:0},{nb_lvl_44_shape_3:0},{nb_lvl_44_switch:0},{nb_lvl_45_bar:0},{nb_lvl_45_barpiece_:0},{nb_lvl_45_barpiece_2:0},{nb_lvl_45_barpiece_3:0},{nb_lvl_45_barpiece_4:0},{nb_lvl_45_barpiece_5:0},{nb_lvl_45_cat_white:0},{isTopLayer:0},{catloveCounter:0},{isCollidedWithControl:0},{nb_lvl_45_cat_yellow:0},{nb_lvl_45_catwalking_white:0},{nb_lvl_45_heart:0},{nb_lvl_45_tail_white:0},{nb_lvl_45_tail_yellow:0},{nb_lvl_47_floorline:0},{nb_lvl_47_floorline1HD:0},{nb_lvl_47_hairpiece:0},{nb_lvl_47_hairpiece2:0},{nb_lvl_47_machine:0},{nb_lvl_47_mirror:0},{nb_lvl_47_mirror_mask:0},{nb_lvl_47_mirror_shine:0},{nb_lvl_47_pipe:0},{nb_lvl_47_sink:0},{nb_lvl_47_sink_bottom:0},{nb_lvl_47_valve:0},{nb_lvl_47_wallline:0},{nb_lvl_48_banana:0},{nb_lvl_48_board:0},{nb_lvl_48_box:0},{nb_lvl_48_donut:0},{nb_lvl_48_equal:0},{nb_lvl_48_number5:0},{nb_lvl_48_number_2:0},{nb_lvl_48_number_4:0},{nb_lvl_48_shelf:0},{nb_lvl_49_cat_scared:0},{nb_lvl_49_cat_wake_up:0},{nb_lvl_49_cathead_red:0},{nb_lvl_49_flame:0},{nb_lvl_49_plate:0},{nb_lvl_49_thermo_text:0},{nb_lvl_49_thermo_text2:0},{nb_lvl_50_drop:0},{isMoved:0},{nb_lvl_50_pipethin_:0},{nb_lvl_50_water:0},{nb_lvl_51_bird:0},{nb_lvl_51_formula:0},{nb_lvl_51_nestfull:0},{nb_lvl_51_paper:0},{nb_lvl_51_picture:0},{nb_lvl_51_tabletop:0},{nb_lvl_51_writing:0},{nb_lvl_52_cucumber:0},{nb_lvl_52_olive_1:0},{nb_lvl_52_olive_2:0},{nb_lvl_52_pizza_1:0},{nb_lvl_52_pizza_2:0},{isTurned:0},{nb_lvl_53_big_greenapple:0},{nb_lvl_53_big_redapple:0},{nb_lvl_54_attention:0},{isLinesChanged:0},{shouldPassLane:0},{nb_lvl_54_car:0},{nb_lvl_54_road:0},{nb_lvl_56_dark_background:0},{nb_lvl_56_draggable_text:0},{nb_lvl_6_smudge:0},{nb_lvl_6_smudge2:0},{nb_lvl_70_flower_big:0},{nb_man_body:0},{nb_man_head:0},{nb_man_sadface:0},{nb_man_wtshirt:0},{nb_massagegun:0},{nb_mat:0},{nb_medicine:0},{nb_milklayer:0},{nb_milksplash:0},{nb_minus:0},{nb_mirror:0},{nb_Monster:0},{nb_Monster_Back_Arm:0},{nb_Monster_Front_Arm:0},{nb_Monster_Live_Face:0},{nb_mop:0},{nb_mouse:0},{nb_mousehole:0},{nb_musiclines_:0},{nb_musiclines_2:0},{nb_musiclines_3:0},{nb_notes:0},{nb_notes2:0},{nb_notes3:0},{nb_notes4:0},{nb_object:0},{nb_object2:0},{nb_object3:0},{nb_offbutton:0},{nb_paper2:0},{nb_pencil:0},{nb_phone:0},{nb_picturefrmae:0},{nb_pipe_piece:0},{nb_pipe_piece2:0},{nb_pipepiece:0},{nb_pipethin_2:0},{nb_plant:0},{nb_plant2:0},{nb_plate2:0},{nb_plate_small:0},{nb_plug:0},{nb_plug_long:0},{nb_plus:0},{nb_pocket:0},{nb_popcorn:0},{nb_power_inside:0},{nb_Princess:0},{nb_Princess_Back_Arm_Bottom:0},{nb_Princess_Back_Arm_Top:0},{nb_Princess_Front_Hand_Hold_Sword:0},{nb_Princess_Front_Hand_Normal:0},{nb_Princess_Front_Hand_Top:0},{nb_question:0},{nb_redbutton:0},{nb_remote:0},{nb_restart:0},{isWorryCollided:0},{nb_robot:0},{nb_robot_bottom:0},{nb_robot_off:0},{nb_robot_on:0},{nb_robot_plug:0},{nb_roboteyes_closed:0},{nb_roboteyes_open:0},{nb_roll:0},{nb_rope:0},{nb_sarkit:0},{nb_sarkit2:0},{nb_scaredboy:0},{nb_scaredgirl:0},{nb_screen_bg:0},{yPos:0},{isOpenVisible:0},{nb_ScrollLayer:0},{isOnHead:0},{nb_Seeds:0},{shadowCounter:0},{nb_shadow:0},{nb_shadow2:0},{nb_shampoo3:0},{nb_shampoo4:0},{nb_shampoo5:0},{nb_shampoo6:0},{nb_shelf:0},{nb_shelf2:0},{nb_shelf3:0},{nb_shelf4:0},{nb_shelf5:0},{nb_shelf6:0},{nb_shelf_long:0},{touchSecondCounter:0},{nb_shower:0},{nb_shower_door:0},{nb_shower_drops:0},{nb_showerflood:0},{nb_showerside_multiple:0},{nb_showerside_single:0},{nb_showerside_single2:0},{nb_sidefloor_line:0},{nb_sink:0},{nb_sink_bottom:0},{nb_SmallBag:0},{nb_smoke:0},{nb_smoke2:0},{nb_smudge5:0},{nb_smudge_:0},{tweenSpeed:0},{nb_Snake:0},{nb_snake_mouth:0},{nb_snake_tongue:0},{nb_snakebowl_back:0},{nb_snakebowl_front:0},{nb_socks:0},{nb_sofa2:0},{nb_sofa3:0},{nb_sofa4:0},{nb_sofa_layer:0},{nb_sofa_layer2:0},{nb_sofa_layer3:0},{nb_souce:0},{nb_speaker:0},{nb_speaker2:0},{nb_splittedscreen:0},{nb_sportschannel:0},{nb_sportsman_:0},{nb_sportsman_2:0},{nb_sportsman_3:0},{nb_Sprite10:0},{nb_Sprite2:0},{nb_stain:0},{nb_straight_line:0},{nb_straight_line2:0},{nb_submitarea:0},{nb_suce_white:0},{nb_sword:0},{nb_syringe:0},{nb_table3:0},{plateCounter:0},{nb_table4:0},{nb_table5:0},{nb_table6:0},{nb_tablecloth:0},{nb_team_red:0},{nb_team_yellow:0},{nb_thinrhino_body:0},{nb_thinrhino_head:0},{nb_thread:0},{nb_topline:0},{nb_towel:0},{nb_toy:0},{nb_tshirt4:0},{nb_tube_empty:0},{nb_tube_full:0},{nb_tv:0},{nb_venom_bottle:0},{nb_venom_drop:0},{nb_venom_drop2:0},{nb_venom_onfloor:0},{nb_water:0},{nb_waterfloor:0},{nb_wateringcan:0},{nb_waterlayer:0},{nb_waterlines:0},{nb_window:0},{nb_window2:0},{nb_wood:0},{faceCounter:0},{nb_yarn:0},{nb_yellowbottle:0},{nb_zero:0},{newLevelsText:0},{number:0},{number2:0},{number3:0},{number4:0},{number5:0},{numbereye:0},{lvl114_obj1:0},{OpenedHints:0},{painlines:0},{takePic:0},{photocamera:0},{Pipe_Nine_Patch:0},{plus:0},{pota_zemin:0},{questionmark:0},{ReadingGameData:0},{ReadingGameData2:0},{redBattery:0},{redbutton:0},{Rival_back_arm:0},{Rival_back_arm2:0},{Rival_back_leg:0},{Rival_back_leg2:0},{Rival_body:0},{Rival_brows_normal:0},{Rival_earphone:0},{Rival_earphone2:0},{Rival_eyes:0},{Rival_eyes_inside:0},{Rival_eyesLids:0},{Rival_front_arm:0},{Rival_front_arm2:0},{Rival_front_leg:0},{Rival_front_leg2:0},{Rival_hat:0},{Rival_head:0},{Rival_hip:0},{Rival_mouth_normal:0},{robot_plug:0},{robotgloves_front:0},{sausage:0},{scared_photo:0},{seat_back:0},{seat_back2:0},{select:0},{settingsIcon:0},{sink:0},{sofa2:0},{sofa3:0},{sofa_layer:0},{soundIcon:0},{Sprite10:0},{Sprite11:0},{lvl156_path:0},{Sprite14:0},{Sprite15:0},{Sprite16:0},{Sprite17:0},{Sprite2:0},{Sprite4:0},{startButton:0},{startText:0},{table3:0},{table_slice:0},{tennisnet:0},{Tiki_Left_Holder:0},{tiki_mic_nb:0},{Tiki_Right_Holder:0},{tire2:0},{treadmill_arm:0},{treadmill_arm2:0},{tree:0},{tshirt:0},{tshirt1_piece:0},{tshirt2:0},{tshirt2_piece:0},{tshirt3:0},{tshirt3_piece:0},{tshirt_rack:0},{"114_toy":0},{"114_socks":0},{lvl205_popcorn:0},{lvl205_coke:0},{lvl205_plate:0},{lvl162_trumphet:0},{nb_GrannyAmy_Front_Arm3:0},{nb_GrannyAmy_Front_Arm4:0},{jenny_front_arm3:0},{jenny_front_leg3:0},{jenny_back_leg3:0},{lvl123_DrWorry_Glasses:0},{lvl127_big_rock:0},{lvl128_jenny_body:0},{lvl128_jenny_head2:0},{lvl128_jenny_front_leg4:0},{lvl128_jenny_back_leg4:0},{lvl128_jenny_back_leg:0},{lvl128_jenny_front_leg:0},{lvl128_jenny_front_arm4:0},{lvl128_jenny_front_arm:0},{lvl128_jenny_back_arm3:0},{lvl128_jenny_back_arm4:0},{lvl128_jenny_eyes_inside:0},{lvl128_jenny_brows_normal:0},{lvl128_jenny_eyes:0},{lvl128_jenny_mouth:0},{lvl128_m_blueweight:0},{lvl139_knife:0},{lvl204_cable:0},{lvl204_cable_electric:0},{lvl204_cable_piece:0},{lvl204_cable_piece2:0},{lvl204_car_blue:0},{lvl204_car_red:0},{lvl204_doner:0},{lvl204_donerstand_bottom:0},{lvl204_donerstand_top:0},{lvl204_door_gymopen:0},{lvl204_ElectricBox:0},{lvl204_gym_glass:0},{lvl204_gymclosed_door:0},{lvl204_gymclosed_door1:0},{lvl204_gymclosed_doorinside:0},{lvl204_gymclosed_sign:0},{lvl204_knife:0},{lvl204_man_body:0},{lvl204_man_handpiece:0},{lvl204_man_head:0},{lvl204_sideWalk:0},{lvl204_silhouttesHD:0},{lvl207_cheese:0},{lvl207_cheesedrop:0},{lvl207_gymmy_arm2:0},{lvl207_gymmy_arm4:0},{lvl207_gymmy_body:0},{lvl207_gymmy_eyesFrame:0},{lvl207_gymmy_eyesInside:0},{lvl207_gymmy_eyeslip:0},{lvl207_gymmy_head:0},{lvl207_gymmy_leftarm:0},{lvl207_gymmy_leftarm1:0},{lvl207_gymmy_leftleg:0},{lvl207_gymmy_leftleg1:0},{lvl207_gymmy_rightarm:0},{lvl207_gymmy_rightleg:0},{lvl207_gymmy_shoes:0},{lvl207_gymmy_shoes1:0},{lvl207_gymmyGlass:0},{lvl207_gymmyMouth:0},{lvl207_juddy_lips:0},{lvl207_juddy_lipss:0},{lvl207_juddybody:0},{lvl207_juddyeyes:0},{lvl207_juddyeyes2:0},{lvl207_juddyeyesframe:0},{lvl207_juddyface:0},{lvl207_juddyhair:0},{lvl207_juddyleftarm:0},{lvl207_juddyleftarm1:0},{lvl207_juddyleftleg:0},{lvl207_juddyleftshoes:0},{lvl207_juddypart1:0},{lvl207_juddypart2:0},{lvl207_juddyrightarm:0},{lvl207_juddyrightarm1:0},{lvl207_juddyrightleg:0},{lvl207_juddyrightshoes:0},{lvl207_juddyskirt:0},{lvl207_leg:0},{lvl207_legcrumbles:0},{lvl207_mouserunning:0},{lvl207_sofa:0},{lvl208_clothespile:0},{lvl208_mirror:0},{lvl208_mirror_shine:0},{lvl208_sock:0},{lvl208_sofa4:0},{lvl208_wardrobe:0},{lvl208_wardrobe_doorpiece:0},{lvl208_wardrobe_open:0},{lvl207_gymmy_body2:0},{lvl207_gymmy_head2:0},{lvl207_gymmy_leftleg2:0},{lvl207_gymmy_rightleg2:0},{lvl207_gymmy_shoes2:0},{lvl207_gymmy_shoes3:0},{lvl207_gymmy_leftleg3:0},{lvl207_gymmy_leftleg4:0},{lvl207_gymmyMouth2:0},{lvl207_gymmyGlass2:0},{lvl207_gymmy_rightarm2:0},{lvl207_gymmy_arm3:0},{lvl207_gymmy_leftarm2:0},{lvl207_gymmy_arm5:0},{m_DrWorry_Body2:0},{m_DrWorry_Head3:0},{m_DrWorry_Glasses2:0},{m_DrWorry_Back_Leg2:0},{m_DrWorry_Front_Leg2:0},{m_DrWorry_Brows_Angry2:0},{selfAngle:0},{lvl_201_siderobot_arm_left2:0},{lvl_65_siderobot_arm_right2:0},{"9patch5":0},{"9patch6":0},{bowlempty_linesbottom:0},{bowlempty_linestop:0},{cateyes_scared:0},{catmouth_scared:0},{chick:0},{Daily_40_arm:0},{Daily_40_arm2:0},{Daily_40_body:0},{Daily_40_eye:0},{Daily_40_eyebrow:0},{Daily_40_head:0},{Daily_40_leg:0},{Daily_40_leg2:0},{dog1_bark:0},{Gimmy_Parcali6:0},{gm:0},{GrannyAmy_Parcali4:0},{greenbutton:0},{gymmy_:0},{jacket_Arm:0},{katman:0},{katman2:0},{leveltext3:0},{leveltext4:0},{leveltext5:0},{lilly_arm_with_finger:0},{Lily_Front_Arm16:0},{isTakeCookie:0},{lvl141_LazyLarry_back_arm:0},{lvl141_LazyLarry_backleg:0},{lvl141_LazyLarry_brows_normal:0},{lvl141_LazyLarry_eyelid_right:0},{lvl141_LazyLarry_eyes_right:0},{lvl141_LazyLarry_frontarm:0},{lvl141_LazyLarry_frontarm2:0},{lvl141_Lily_Back_Arm_5:0},{lvl141_m_LazyLarry_mouth_normal:0},{lvl141_nb_book_:0},{lvl141_nb_book_2:0},{lvl141_nb_LazyLarry_Back_Foot:0},{lvl141_nb_LazyLarry_Body:0},{lvl141_nb_LazyLarry_Eyes:0},{lvl141_nb_LazyLarry_Head_Hairy_Mirrored:0},{lvl141_nb_Lily_Back_Leg_:0},{lvl141_nb_Lily_Body4:0},{lvl141_nb_Lily_Front_Leg_:0},{lvl141_nb_Lily_Skirt:0},{lvl141_nb_line2:0},{lvl141_nb_plant2:0},{lvl141_nb_shelf2:0},{lvl141_nb_table3:0},{lvl141_nb_tablecloth:0},{lvl141_nb_tv:0},{lvl142_jenny_back_arm:0},{lvl142_jenny_back_arm2:0},{lvl142_jenny_back_leg:0},{lvl142_jenny_back_leg2:0},{lvl142_jenny_body:0},{lvl142_jenny_brows_normal:0},{lvl142_jenny_eye_lids2:0},{lvl142_jenny_eyes:0},{lvl142_jenny_eyes_inside:0},{lvl142_jenny_front_arm:0},{lvl142_jenny_front_arm2:0},{lvl142_jenny_front_leg:0},{lvl142_jenny_front_leg2:0},{lvl142_jenny_head:0},{lvl142_jenny_mouth:0},{lvl144_Lily_Front_Arm12:0},{lvl144_Lily_Front_Arm6:0},{lvl144_Lily_whole_face:0},{lvl169_obj:0},{lvl169_obj1:0},{lvl169_obj2:0},{lvl169_obj3:0},{lvl179_car_rope:0},{lvl179_Lily_mouth_soangry:0},{lvl179_m_bush3:0},{lvl179_m_DrWorry_Arm_Front_2:0},{lvl179_mat_backarm2:0},{lvl179_mat_backarm2_white:0},{lvl179_mat_backfoot:0},{lvl179_mat_backleg:0},{lvl179_mat_body:0},{lvl179_mat_brows_eaing:0},{lvl179_mat_eyes:0},{lvl179_mat_front_foot:0},{lvl179_mat_frontarm:0},{lvl179_mat_frontarm2_white:0},{lvl179_mat_frontleg:0},{lvl179_mat_head:0},{lvl179_mat_hip:0},{lvl179_mat_mouth:0},{lvl179_mat_pocket:0},{lvl179_obj:0},{lvl179_pricesign:0},{lvl179_pricesign_leg:0},{lvl179_sign_hotdog:0},{lvl179_stand:0},{lvl179_x_m_DrWorry_Arm_Back_2:0},{lvl181_chair:0},{lvl181_fishbone:0},{lvl181_Lily_Front_Arm13:0},{lvl181_Lily_Front_Arm14:0},{lvl181_m_Bobba_sleep_mouth:0},{lvl181_nb_Bobba_Arm_Back4:0},{lvl181_nb_Bobba_Arm_Front:0},{lvl181_nb_Bobba_Body_Fat_Right:0},{lvl181_nb_Bobba_Eating_Head:0},{lvl181_nb_Bobba_EatingBrows:0},{lvl181_nb_Bobba_Eyes_Normal:0},{lvl181_nb_Bobba_Eyes_Small:0},{lvl181_nb_Bobba_Hip:0},{lvl181_nb_Bobba_Leg_Back:0},{lvl181_nb_Bobba_Leg_Front:0},{lvl181_nb_lily_green_face:0},{lvl181_nb_lily_hair_piece:0},{lvl181_nb_Lily_Happy2:0},{lvl181_nb_lily_mouth_eat:0},{lvl181_nb_remote:0},{lvl181_vnb_table4:0},{lvl187_bush2:0},{lvl187_explosion:0},{lvl187_jenny_body2:0},{lvl187_line:0},{lvl187_m_coffe_Steam:0},{lvl187_main_back_house:0},{lvl187_main_back_house4:0},{lvl187_main_clouds:0},{lvl187_main_tree:0},{lvl187_nb_172_bottle:0},{hasCollided:0},{lvl187_nb_lvl_1_sun:0},{lvl187_nb_lvl_50_water:0},{lvl18_Lily_Back_Arm_3:0},{lvl18_Lily_Body5:0},{lvl18_Lily_Eyes:0},{lvl18_Lily_Eyes_Inside:0},{lvl18_Lily_Front_Arm9:0},{lvl18_Lily_Hair_Piece_:0},{lvl18_Lily_Hair_Piece_2:0},{lvl18_Lily_Happy4:0},{lvl18_nb_LittleTiki_back_arm:0},{lvl18_nb_LittleTiki_back_arm2:0},{lvl18_nb_LittleTiki_backleg:0},{lvl18_nb_LittleTiki_body:0},{lvl18_nb_LittleTiki_brows_tricky:0},{lvl18_nb_LittleTiki_eyes:0},{lvl18_nb_LittleTiki_eyes_inside:0},{lvl18_nb_LittleTiki_front_arm:0},{lvl18_nb_LittleTiki_front_arm2:0},{lvl18_nb_LittleTiki_front_leg:0},{lvl18_nb_LittleTiki_head:0},{lvl18_nb_LittleTiki_mouth_tricky:0},{lvl18_nb_LittleTiki_Parcaliai:0},{lvl18_nb_LittleTiki_pocket:0},{lvl18_nb_LittleTiki_skirt:0},{lvl18_nb_lvl_70_flower_big:0},{lvl18_sink2:0},{lvl18_soap:0},{lvl18_Sprite20:0},{lvl200_lvl_28_shelf:0},{lvl201_barfiks_legs:0},{lvl201_barfiks_legs2:0},{lvl201_bowlingball:0},{lvl201_crash_sign:0},{lvl201_lid:0},{lvl201_lidpiece:0},{lvl201_support:0},{lvl201_worryMouth:0},{lvl202_hotdog:0},{lvl202_rope:0},{lvl202_rope_hanger:0},{lvl202_rope_souce:0},{lvl202_toppiece:0},{lvl203:0},{hasDog:0},{lvl203_capsule_body:0},{lvl203_capsule_wing:0},{lvl203_capsule_wing2:0},{isMin:0},{lvl203_satellite:0},{lvl210_box:0},{lvl210_button:0},{lvl210_cable_side:0},{lvl210_cable_side2:0},{lvl210_cable_straight:0},{lvl210_lamp_broken:0},{lvl210_lamp_off:0},{lvl210_paint_brush:0},{lvl210_paint_bucket:0},{lvl210_paint_stain:0},{lvl211_control:0},{lvl211_floorline:0},{lvl211_girl_head_happy:0},{lvl211_girl_head_sad:0},{lvl211_hair_in_Soup:0},{lvl211_hair_part:0},{lvl211_man_green_head:0},{lvl211_man_head_happy:0},{lvl211_Sprite:0},{lvl211_Sprite11:0},{lvl211_Sprite3:0},{lvl211_Sprite5:0},{lvl211_Sprite7:0},{lvl211_Sprite9:0},{lvl212_bags:0},{lvl212_hat2:0},{lvl212_hat3:0},{lvl212_hat4:0},{lvl212_jacket:0},{lvl212_machine_box:0},{lvl212_machine_handle:0},{lvl212_machine_screen:0},{lvl212_manequin:0},{lvl212_shelves_:0},{lvl212_shirt:0},{firstPosx:0},{lvl212_skirt:0},{lvl212_skirt2:0},{lvl212_skirt3:0},{lvl212_sweat:0},{lvl213_light_small:0},{lvl213_machineBox:0},{lvl213_plug:0},{lvl213_sponge_big:0},{lvl213_sponge_small:0},{lvl213_sponge_water:0},{lvl213_waterbubble_small:0},{lvl213_waterLayer:0},{lvl38_bottles_:0},{lvl38_DrWorry_Mouth:0},{lvl38_m_DrWorry_Back_Leg:0},{lvl38_m_DrWorry_Brows_Angry:0},{lvl38_m_DrWorry_Eyes_Inside_Normal:0},{lvl38_m_DrWorry_Front_Leg:0},{lvl38_m_DrWorry_Glasses:0},{lvl46_Lily_Angry:0},{lvl46_Lily_Back_Leg_:0},{lvl46_Lily_Back_Leg_2:0},{lvl46_Lily_Body2:0},{lvl46_Lily_Front_Arm2:0},{lvl46_Lily_Front_Arm3:0},{lvl46_Lily_Front_Arm4:0},{lvl46_Lily_Front_Leg_:0},{lvl46_Lily_Front_Leg_2:0},{lvl46_Lily_Hair_Piece_4:0},{lvl46_Lily_Head2:0},{lvl46_Lily_Skirt:0},{plateNo:0},{lvl46_lvl46_plate:0},{lvl46_nb_46_cat1_sad:0},{lvl46_nb_lvl_47_wallline:0},{lvl_141_control:0},{lvl_184_glass_empty:0},{lvl_200_ketchupp:0},{lvl_200_Lily_Front_Arm8:0},{lvl_200_Lily_mouth_unhappy:0},{lvl_200_lvl_57_kitchencounter:0},{lvl_200_lvl_57_pepper:0},{lvl_200_lvl_57_salt:0},{lvl_200_lvl_57_suce_white:0},{lvl_200_lvl_66_weights2:0},{lvl_200_lvl_78_full_jar:0},{lvl_200_nb_coke:0},{lvl_200_nb_GrannyAmy_Back_Arm2:0},{lvl_200_nb_GrannyAmy_Back_Leg:0},{lvl_200_nb_GrannyAmy_Body2:0},{lvl_200_nb_GrannyAmy_Eyes_Inside2:0},{lvl_200_nb_GrannyAmy_Front_Arm:0},{lvl_200_nb_GrannyAmy_Front_Arm2:0},{lvl_200_nb_GrannyAmy_Front_Arm3:0},{lvl_200_nb_GrannyAmy_Front_Leg:0},{lvl_200_nb_Lily_Back_Leg_2:0},{lvl_200_nb_Lily_bare_foot:0},{lvl_200_nb_Lily_Front_Arm:0},{lvl_200_nb_Lily_Front_Arm2:0},{lvl_200_nb_Lily_Hair_Piece_:0},{lvl_200_nb_Lily_Hair_Piece_2:0},{lvl_200_nb_Lily_Head2:0},{lvl_200_nb_Lily_Normal:0},{lvl_66_weights2:0},{lvl_78_full_jar2:0},{machine_sign:0},{mn_lvl_189_floor:0},{nb_142_jennyhand_paper:0},{nb_142_jennyhand_paper2:0},{nb_142_jennyhand_scissor:0},{nb_142_lilyhand_paper:0},{nb_142_lilyhand_paper2:0},{nb_142_lilyhand_scissors:0},{nb_142_opt_bg:0},{nb_142_paper_bubble:0},{nb_142_paper_floor:0},{nb_142_paper_opt:0},{nb_142_questionmark:0},{nb_142_rock:0},{nb_142_rock2:0},{nb_142_scissor:0},{nb_142_scissor2:0},{nb_142_scissor_bubble:0},{nb_142_thiinkbaloon:0},{nb_142_Turn_BG:0},{isGymmy:0},{nb_166_bigdumbble:0},{nb_166_bigdumbble2:0},{nb_166_Gimmy:0},{nb_166_Gimmy_arm:0},{nb_166_Gimmy_arm2:0},{nb_167_barfiks_legs:0},{nb_167_barfiks_longbar:0},{nb_167_barfiks_screw:0},{nb_167_barfiks_screw2:0},{nb_167_barfiks_shortbar:0},{nb_167_fingers_holding:0},{nb_167_Gimmy_arm1:0},{nb_167_Gimmy_arm2:0},{nb_167_Gimmy_arm3:0},{nb_167_Gimmy_arm4:0},{NB_167_Gimmy_barfix:0},{nb_167_glasses:0},{nb_172_banana:0},{nb_172_bottle:0},{nb_172_gym_angry_face:0},{nb_172_gym_arm:0},{nb_172_gym_body:0},{nb_172_katman:0},{nb_172_line:0},{nb_172_pinDrag:0},{nb_172_rockhead_arm_:0},{nb_172_rockhead_body:0},{nb_172_rockhead_dumbell:0},{nb_172_rockhead_face_:0},{nb_18_closet:0},{isOnToilet:0},{nb_18_closet_piece:0},{nb_18_lavabo:0},{nb_18_lil_:0},{nb_18_Lily_Head5:0},{nb_18_lilyhead:0},{nb_18_mask_red:0},{nb_18_paperroll:0},{nb_18_toilet_cover:0},{NB_18_toilet_inside:0},{nb_18_wallline:0},{nb_18_window:0},{nb_199_car_blue:0},{nb_199_car_red:0},{nb_199_truck_blue:0},{nb_199_truck_Red:0},{nb_38_blue:0},{nb_38_bluebottle:0},{nb_38_colors:0},{nb_38_colors2:0},{nb_38_emptybottle:0},{nb_38_greenbottle:0},{nb_38_machine:0},{nb_38_machine_closed:0},{nb_38_machine_open:0},{nb_38_purplebottle:0},{nb_38_redbottle:0},{nb_38yellowbottle:0},{nb_39_circle:0},{nb_39_circle2:0},{nb_39_control:0},{nb_39_equal2:0},{nb_39_seven:0},{nb_39_six:0},{nb_39_square:0},{nb_39_triangle:0},{nb_39_wall:0},{nb_39_zero:0},{nb_46_bones:0},{nb_46_bones2:0},{nb_46_bones3:0},{nb_46_box2:0},{nb_46_cat1_sad2:0},{nb_46_chickenbox:0},{nb_46_mouse2:0},{nb_46_shelf:0},{nb_46_smudge_:0},{nb_46_smudge_2:0},{nb_4_brain:0},{nb_4_cheesecake:0},{nb_4_chicken:0},{nb_4_smalltable:0},{isOnPlace:0},{nb_4_thinkcircle_:0},{nb_4_thinkcircle_2:0},{nb_5_Cake:0},{nb_5_cheese:0},{nb_5_cheese_grated:0},{nb_5_crackedegg:0},{nb_5_eggbowl:0},{nb_5_flourspoon:0},{nb_5_milk:0},{nb_5_mixer:0},{nb_5_spilledflour:0},{nb_5_table:0},{nb_7_bowl_back:0},{nb_7_bowl_front:0},{nb_7_cabbage:0},{nb_7_carrot:0},{nb_7_cat_arms:0},{nb_7_cat_head:0},{nb_7_cat_head2:0},{nb_7_cat_head3:0},{nb_7_cat_scared:0},{isweight:0},{nb_7_cat_sleeping:0},{nb_7_cat_tail2:0},{nb_7_cat_tail3:0},{nb_7_cateyes_sleeping:0},{nb_7_catmouth_normal:0},{nb_7_catsleeping:0},{nb_7_chicken:0},{nb_7_closet:0},{nb_7_cushion:0},{nb_7_tuna:0},{nb_7_water:0},{nb_7_weigh_Text:0},{nb_7_weigher:0},{nb_8_bed:0},{nb_8_bedside:0},{nb_8_cloud:0},{nb_8_cloud2:0},{nb_8_cloud3:0},{nb_8_flute:0},{nb_8_hipnoz:0},{nb_8_liliy_sad:0},{nb_8_liliyarm:0},{nb_8_liliyarm2:0},{nb_8_liliyhead:0},{nb_8_lily_awake:0},{nb_8_lily_brows:0},{nb_8_moon:0},{nb_8_poster:0},{nb_8_sheep:0},{nb_8_sheep2:0},{nb_8_tea:0},{nb_8_teapot:0},{nb_8_text:0},{nb_8_window_frame:0},{nb_8_window_inside:0},{nb_Bobba_Arm_Front2:0},{nb_Bobba_Body_Fat_Right2:0},{nb_Bobba_Eyes_Normal2:0},{nb_Bobba_Eyes_Small2:0},{nb_Lily_Normal3:0},{nb_lily_relax:0},{nb_lvl141_dark:0},{nb_lvl142_checkmark:0},{nb_lvl142_checkmark2:0},{nb_lvl142_checkmark3:0},{nb_lvl_141_console_remote:0},{nb_lvl_141_cookie_half:0},{nb_lvl_141_cookie_half2:0},{nb_lvl_141_emptyjar:0},{nb_lvl_141_lamp_off:0},{nb_lvl_141_lamp_on:0},{nb_lvl_141_play_console:0},{nb_lvl_141_rocket:0},{nb_lvl_141_rocket2:0},{nb_lvl_141_rocket_fire:0},{nb_lvl_141_tv_Cable:0},{nb_lvl_144_brush:0},{nb_lvl_144_giraffe:0},{nb_lvl_144_horse:0},{nb_lvl_144_lily_new_arm_left:0},{nb_lvl_144_lily_new_arm_left2:0},{nb_lvl_144_lily_new_arm_left3:0},{nb_lvl_144_lily_new_arm_right:0},{nb_lvl_144_lily_new_body:0},{nb_lvl_144_lily_new_leg:0},{nb_lvl_144_lily_new_skirt:0},{nb_lvl_144_sheep:0},{nb_lvl_144_sheep3:0},{nb_lvl_144_sheep_hair:0},{nb_lvl_145_alien_arm1:0},{nb_lvl_145_alien_arm2:0},{nb_lvl_145_alien_body:0},{nb_lvl_145_alien_body2:0},{nb_lvl_145_alien_eyes:0},{nb_lvl_145_alien_head:0},{nb_lvl_145_alien_mouth:0},{nb_lvl_145_bomb:0},{nb_lvl_145_bomb2:0},{jumpCount:0},{nb_lvl_145_button:0},{nb_lvl_145_control:0},{nb_lvl_145_dark:0},{nb_lvl_145_dog_arm:0},{nb_lvl_145_dog_body:0},{nb_lvl_145_dog_ears:0},{nb_lvl_145_dog_eyes:0},{nb_lvl_145_dog_eyes_inside:0},{nb_lvl_145_dog_head:0},{nb_lvl_145_dog_mouth:0},{nb_lvl_145_hamaknormal_back:0},{nb_lvl_145_hamaknormal_front:0},{nb_lvl_145_hamakstrethed_back:0},{nb_lvl_145_hamakstrethed_front:0},{nb_lvl_145_hill_long:0},{nb_lvl_145_hill_short:0},{nb_lvl_145_Mars_floor:0},{nb_lvl_145_planet:0},{nb_lvl_145_rocket:0},{nb_lvl_145_square:0},{nb_lvl_145_stars:0},{nb_lvl_145_text:0},{nb_lvl_145_world_whole:0},{nb_lvl_147_cat_walking:0},{nb_lvl_147_cateyes_looking:0},{nb_lvl_148_crack_bg:0},{nb_lvl_148_crack_front:0},{nb_lvl_148_crashed_rocket:0},{nb_lvl_148_dog_arm1:0},{nb_lvl_148_dog_arm2:0},{nb_lvl_148_dog_legs:0},{waterCounter:0},{nb_lvl_148_dog_mouth_happy:0},{firCounter:0},{nb_lvl_148_firebig:0},{nb_lvl_148_floorhole:0},{nb_lvl_148_holefrontpiece:0},{nb_lvl_148_moon_bg:0},{nb_lvl_148_newrocket:0},{nb_lvl_148_rocketpiece:0},{nb_lvl_148_rocketpiece2:0},{nb_lvl_148_rocketpiece3:0},{nb_lvl_148_rocketpiece4:0},{nb_lvl_148_rocketpiece5:0},{nb_lvl_148_smoke:0},{nb_lvl_148_smoke_small:0},{nb_lvl_148_smoke_small2:0},{nb_lvl_148_smoke_small3:0},{no:0},{nb_lvl_149_candybar:0},{nb_lvl_149_candybar_shadow:0},{nb_lvl_149_candybar_shadow2:0},{nb_lvl_149_candybar_shadow3:0},{nb_lvl_149_candybar_shadow4:0},{nb_lvl_149_candybar_shadow5:0},{nb_lvl_149_cips:0},{nb_lvl_149_control:0},{nb_lvl_149_dragHolder:0},{nb_lvl_149_grass:0},{nb_lvl_149_mask:0},{isCollided:0},{isTouchingTiki:0},{nb_lvl_149_spider:0},{nb_lvl_168_control:0},{nb_lvl_168_fingerP:0},{nb_lvl_168_formulas_:0},{nb_lvl_168_formulas_2:0},{nb_lvl_168_formulas_3:0},{nb_lvl_168_newhand:0},{nb_lvl_168_whitebox:0},{nb_lvl_169_gymmy_arm:0},{nb_lvl_169_gymmy_arm2:0},{nb_lvl_169_gymmy_arm3:0},{nb_lvl_169_gymmy_arm4:0},{nb_lvl_169_gymmy_arm5:0},{nb_lvl_169_gymmy_arm6:0},{nb_lvl_169_gymmy_arm7:0},{nb_lvl_169_gymmy_arm8:0},{nb_lvl_169_gymmy_arm9:0},{nb_lvl_169_gymmy_body:0},{nb_lvl_169_gymmy_foot:0},{nb_lvl_169_gymmy_head:0},{nb_lvl_169_gymmy_leg:0},{nb_lvl_169_gymmy_leg2:0},{nb_lvl_169_gymmy_leg3:0},{nb_lvl_169_gymmy_leg4:0},{nb_lvl_169_gymmy_mouth:0},{nb_lvl_169_gymmy_mouth2:0},{nb_lvl_169_gymmy_shoe:0},{nb_lvl_169_gymmy_shoe2:0},{nb_lvl_170_baby:0},{nb_lvl_170_baby_cryingface:0},{nb_lvl_170_baby_seat:0},{nb_lvl_170_baby_seat_frontpiece:0},{nb_lvl_170_control:0},{nb_lvl_170_mom:0},{nb_lvl_170_mom_happyface:0},{nb_lvl_170_teardrop:0},{nb_lvl_170_teardrop2:0},{nb_lvl_170_tv:0},{nb_lvl_170_tv_cindy_body:0},{nb_lvl_170_tv_cindy_leg:0},{nb_lvl_171_dark:0},{open:0},{nb_lvl_171_doorclosed:0},{nb_lvl_171_dooropen:0},{nb_lvl_171_dooropen_piece:0},{nb_lvl_171_nb_book:0},{nb_lvl_173_air_lines:0},{nb_lvl_173_bull:0},{nb_lvl_173_bunny:0},{nb_lvl_173_horn:0},{nb_lvl_173_horn_blowing:0},{nb_lvl_173_wool:0},{nb_lvl_173_wool2:0},{nb_lvl_173_wool3:0},{nb_lvl_174_bowl_empty:0},{nb_lvl_174_bowl_empty2:0},{nb_lvl_174_bowl_helmet:0},{nb_lvl_174_brokenhelmet:0},{isFull:0},{nb_lvl_174_empty_glass:0},{nb_lvl_174_fish2:0},{nb_lvl_174_tape:0},{nb_lvl_175_badsmell:0},{nb_lvl_175_badsmell2:0},{nb_lvl_175_bananas:0},{nb_lvl_175_bananatree_leaf:0},{nb_lvl_175_bananatree_long:0},{nb_lvl_175_bananatree_short:0},{nb_lvl_175_floor:0},{nb_lvl_175_gorilla_arm:0},{nb_lvl_175_gorilla_arm2:0},{nb_lvl_175_gorilla_bpdy:0},{nb_lvl_175_gorilla_eyes:0},{nb_lvl_175_gorilla_eyes2:0},{nb_lvl_175_gorilla_head:0},{nb_lvl_175_gorilla_leg:0},{nb_lvl_175_gorilla_leg2:0},{nb_lvl_175_gorilla_mouth:0},{nb_lvl_175_gorilla_mouth2:0},{nb_lvl_175_text:0},{NB_LVL_175_whitebird:0},{nb_lvl_176_batteryslot_back:0},{nb_lvl_176_batteryslot_front:0},{nb_lvl_176_bigbattery:0},{nb_lvl_176_bigbattery2:0},{nb_lvl_176_bigbattery3:0},{nb_lvl_176_button:0},{nb_lvl_176_button_stand:0},{nb_lvl_176_cablepiece:0},{nb_lvl_176_cablepiece2:0},{nb_lvl_176_crash_big:0},{nb_lvl_176_flame:0},{nb_lvl_176_robot_standbig:0},{nb_lvl_177_burnt_smoke:0},{nb_lvl_177_control:0},{nb_lvl_177_remote:0},{nb_lvl_177_shield_back:0},{isWorry:0},{nb_lvl_177_shield_front:0},{nb_lvl_177_sidelines_left:0},{nb_lvl_177_sidelines_right:0},{nb_lvl_178_grannyHolder:0},{nb_lvl_178_holder:0},{nb_lvl_178_lilyHolder:0},{nb_lvl_178_onion:0},{nb_lvl_178_onion_piece:0},{nb_lvl_178_onion_piece2:0},{nb_lvl_178_onion_smell:0},{nb_lvl_178_vase_pieice:0},{nb_lvl_178_vase_pieice2:0},{nb_lvl_178_vase_pieice3:0},{nb_lvl_178_vase_pieice4:0},{nb_lvl_178_vase_pieice5:0},{nb_lvl_179_bobbacarHolder:0},{nb_lvl_179_bobbacarHolder2:0},{nb_lvl_179_car:0},{nb_lvl_179_car_door:0},{nb_lvl_179_car_inside:0},{isOnplace:0},{nb_lvl_179_eater_drag:0},{nb_lvl_179_eater_drag2:0},{nb_lvl_181_closeddoor:0},{nb_lvl_181_control:0},{nb_lvl_181_opendoor:0},{nb_lvl_181_opendoor_door:0},{nb_lvl_181_window:0},{nb_lvl_182_bird:0},{nb_lvl_182_bird2:0},{nb_lvl_182_bird3:0},{nb_lvl_182_crashP:0},{nb_lvl_182_helicopter:0},{nb_lvl_182_helicopter_door:0},{nb_lvl_182_helicopter_kuyruk:0},{nb_lvl_183_brows_scared:0},{nb_lvl_183_cat_angryhead:0},{nb_lvl_183_dog1_angry:0},{nb_lvl_183_dogbody_scared:0},{nb_lvl_183_dogbody_sleeping:0},{nb_lvl_183_dogfood:0},{nb_lvl_183_doghead:0},{nb_lvl_183_doghead2:0},{nb_lvl_183_doghouse:0},{nb_lvl_183_eyes_angry:0},{nb_lvl_183_eyes_angry2:0},{nb_lvl_183_mouth_angry:0},{nb_lvl_184_salad:0},{nb_lvl_184_table:0},{nb_lvl_184_water:0},{nb_lvl_184_wordText:0},{nb_lvl_185_astreoid_big:0},{nb_lvl_185_crashP:0},{crashCount:0},{nb_lvl_185_UFO:0},{nb_lvl_185_waves_backHD:0},{nb_lvl_185_waves_frontHD:0},{nb_lvl_185_waves_middleHD:0},{nb_lvl_186_astrodog_bodypiece:0},{nb_lvl_186_astrodog_bodypiece2:0},{nb_lvl_186_astrodog_bodypiece3:0},{nb_lvl_186_bomb_flame:0},{nb_lvl_186_burger:0},{nb_lvl_186_cable:0},{nb_lvl_186_fries:0},{nb_lvl_186_ketchapp:0},{nb_lvl_186_mayo:0},{nb_lvl_186_smoke:0},{nb_lvl_186_worry_bodypiece:0},{nb_lvl_186_worry_bodypiece2:0},{nb_lvl_187_jennyHolder:0},{nb_lvl_187_raindrops:0},{sunCounter:0},{nb_lvl_187_road:0},{nb_lvl_188_188_verticalpiece:0},{nb_lvl_188_188_weight:0},{nb_lvl_188_coconut:0},{nb_lvl_188_coconut_broken:0},{nb_lvl_188_coconut_broken2:0},{nb_lvl_188_control:0},{nb_lvl_188_handle:0},{nb_lvl_188_horizontalpiece:0},{nb_lvl_188_pivotpoint:0},{nb_lvl_188_rope:0},{nb_lvl_188_shelf:0},{nb_lvl_189_Elephant:0},{nb_lvl_189_home2:0},{nb_lvl_190_big_box:0},{nb_lvl_190_brokenbutton_:0},{nb_lvl_190_brokenbutton_2:0},{nb_lvl_190_jumplines:0},{nb_lvl_190_text:0},{nb_lvl_190_woodpiece:0},{nb_lvl_190_woodpiece2:0},{win:0},{nb_lvl_191_cat:0},{nb_lvl_191_control:0},{nb_lvl_191_drag_places:0},{nb_lvl_191_fish:0},{Physics:0},{Solid:0},{nb_lvl_191_road:0},{nb_lvl_191_road2:0},{nb_lvl_192_rock_gymmy:0},{nb_lvl_192_rock_rockhead:0},{nb_lvl_193_number:0},{nb_lvl_193_number2:0},{nb_lvl_193_number3:0},{nb_lvl_193_number4:0},{nb_lvl_193_number5:0},{nb_lvl_193_question:0},{nb_lvl_193_squareshape:0},{nb_lvl_193_starshape:0},{nb_lvl_193_triangleshape:0},{nb_lvl_194_column:0},{nb_lvl_194_floor_slice:0},{nb_lvl_194_hairdryer:0},{hasWater:0},{nb_lvl_194_ventilator_lid:0},{nb_lvl_194_waterbubble_big:0},{nb_lvl_194_waterbubble_medium:0},{nb_lvl_194_waterbubble_small:0},{nb_lvl_194_window:0},{nb_lvl_195_angryface2:0},{nb_lvl_195_backarm2:0},{nb_lvl_195_bigbattery4:0},{nb_lvl_195_body2:0},{nb_lvl_195_cable:0},{nb_lvl_195_computer:0},{nb_lvl_195_fridge:0},{nb_lvl_195_fridgeopen:0},{nb_lvl_195_frontarm_piece:0},{nb_lvl_195_frontarm_piece2:0},{nb_lvl_195_head:0},{nb_lvl_195_icebag:0},{nb_lvl_195_icecream:0},{nb_lvl_195_keyboard:0},{nb_lvl_195_lighting:0},{nb_lvl_195_lighting2:0},{nb_lvl_195_sidewall:0},{nb_lvl_195_smoke:0},{nb_lvl_195_tableback:0},{nb_lvl_195_tablefront:0},{nb_lvl_196_bobbashadow:0},{nb_lvl_196_chicken:0},{nb_lvl_196_chickenbox_back:0},{nb_lvl_196_chickenbox_front:0},{nb_lvl_196_chickenbox_shadow:0},{nb_lvl_196_grass2:0},{nb_lvl_196_jenny_drag:0},{nb_lvl_196_jenny_holder:0},{nb_lvl_196_lil_drag:0},{nb_lvl_196_lily_holder:0},{nb_lvl_196_seesaw_foot:0},{nb_lvl_196_seesaw_screw:0},{nb_lvl_196_seesaw_seat:0},{nb_lvl_196_seesaw_tikihandle:0},{nb_lvl_196_seewsaw_BobbaHandle:0},{nb_lvl_196_tikiShadow:0},{nb_lvl_196_worry_drag:0},{nb_lvl_196_worry_holder:0},{nb_lvl_197_cat_body:0},{nb_lvl_197_cat_happyface:0},{nb_lvl_197_cat_head:0},{nb_lvl_197_cat_tail:0},{nb_lvl_197_control:0},{nb_lvl_197_hole:0},{isDown:0},{nb_lvl_197_hole2:0},{nb_lvl_197_lilly_holder:0},{nb_lvl_197_longarm:0},{nb_lvl_197_maskpiece:0},{nb_lvl_197_saw:0},{nb_lvl_198_ball:0},{nb_lvl_198_bear:0},{nb_lvl_198_brokentable:0},{nb_lvl_198_control:0},{nb_lvl_198_lamp:0},{nb_lvl_198_trampoline:0},{nb_lvl_199_explosion:0},{nb_lvl_200_control:0},{nb_lvl_200_gymmy_crying_eyes:0},{nb_lvl_200_gymmy_crying_mouth:0},{nb_lvl_200_gymmyHolder:0},{nb_lvl_4_control:0},{nb_lvl_7_fish2:0},{nb_lvl_7_fish3:0},{nb_lvl_7_fish4:0},{nb_lvl_93_circleshape:0},{nb_lvl_93_crossshape:0},{nb_suce_white2:0},{phoneontable:0},{pin:0},{pof:0},{redbutton2:0},{sheep_angryface:0},{sheep_blowmouth:0},{sheep_nowool:0},{Sprite21:0},{switch:0},{table_back:0},{table_front:0},{treebranch:0},{vLazyLarry_back_arm2:0},{vnb_GrannyAmy_Eyes:0},{vnb_GrannyAmy_Mouth:0},{vnb_sofa3:0},{vnb_table4:0},{watersplash:0},{woolclipper:0},{x_formula:0},{x_lvl_21_table:0},{x_lvl_57_shelf:0},{x_m_DrWorry_Arm_Back_:0},{x_m_DrWorry_Arm_Back_2:0},{x_m_DrWorry_Arm_Front_:0},{x_m_DrWorry_Body:0},{x_m_DrWorry_Head2:0},{x_nb_shampoo3:0},{x_nb_shampoo6:0},{m_coverSprite2:0},{fakeDrag2:0},{lvl_8_cloud4:0},{lang:0},{langBgChosen:0},{langClose:0},{langDown:0},{langText:0},{langTextBg:0},{langBg:0},{backBtn:0},{leftBtn:0},{rightBtn:0},{Sprite:0},{SuccessSingleText:0},{clappingHands:0},{SuccessDoubleTextFirst:0},{SuccessDoubleTextSecond:0},{Speechlong_arrow:0},{Speechlong_arrow2:0},{Speechlong_big:0},{Speechlong_big2:0},{SuccessOnlyText:0},{backGround:0},{buttons_bg:0},{buttons_home:0},{Levels_Dot:0},{LevelStartText:0},{konfetti1:0},{konfetti2:0},{konfetti3:0},{konfetti4:0},{konfetti5:0},{SuccessNextText:0},{clap:0},{clap1sign:0},{clap1sign2:0},{clap3:0},{clap4:0},{clap5:0},{clap6:0},{clap8:0},{Levels_Dot2:0},{Levels_Dot3:0},{Levels_Dot4:0},{Levels_Dot5:0},{Levels_Dot6:0},{Levels_Dot7:0},{Levels_Dot8:0},{Levels_Dot9:0},{Bobba_Arm_Back:0},{Bobba_Arm_Front:0},{Bobba_Body_Fat:0},{Bobba_Eating_Head:0},{Bobba_Mouth:0},{Bobba_EatingBrows:0},{Bobba_Eyelids:0},{Bobba_Eyes_Normal:0},{Bobba_Eyes_Small:0},{Bobba_Hip:0},{Bobba_Leg_Back:0},{Bobba_Leg_Front:0},{Bobba_Brows_Angry:0},{Bobba_EyeLids_Angry:0},{Bobba_Mouth_:0},{Bobba_Mouth_Angry:0},{Bobba_Mouth_Normal_Happy:0},{Bobba_Mouth_Normal_Happy2:0},{Bobba_Eyes_Small2:0},{Bobba_Eyes_Normal2:0},{Bobba_Arm_Front2:0},{Bobba_Eating_Head2:0},{Bobba_Eyes_Normal3:0},{Bobba_Eyes_Small3:0},{Bobba_Mouth_Normal:0},{Bobba_Body_Fat4:0},{Bobba_Arm_Front3:0},{Bobba_Arm_Back3:0},{Bobba_EatingBrows4:0},{Bobba_Mouth_2:0},{Bobba_Eyes_Small4:0},{isBended:0},{Bobba_Arm_Back4:0},{Bobba_Arm_Front4:0},{Bobba_Brows_Angry2:0},{Boppa_Eating_Arm:0},{Bobba_Mouth_Normal_Happy4:0},{Bobba_EatingBrows5:0},{Bobba_Eating_Head3:0},{Bobba_Leg_Front2:0},{Bobba_Leg_Front3:0},{Bobba_Leg_Back_right:0},{Bobba_Leg_Front_rigth:0},{Bobba_Mouth_Normal2:0},{lvl111_Bobba_Arm_Back:0},{lvl133_obj:0},{lvl133_obj1:0},{nb_lvl_133_holder1:0},{nb_lvl_133_holder2:0},{nb_lvl_133_holder3:0},{lvl_107_control:0},{langButton:0},{hintButtons:0},{Claps:0},{Level3Donuts:0},{cats:0},{dandrufs:0},{m_Draggables:0},{m_notes:0},{lvl92Balls:0},{Clouds:0},{JennyBody:0},{RivalBody:0},{FancyPlates:0},{passwordtexts:0},{candies:0},{FlamePieces:0},{Chickens:0},{IosText:0},{Level11Text:0},{SettingIcons:0},{ResizeableText:0},{"205_cips":0},{lvl180_smokes:0},{lvl108_souce:0},{lvl122_bigRockPieces:0},{MoveToAstroids:0},{lvl126_astroids:0},{lvl127_molls:0},{lvl129_pieces:0},{lvl130_planets:0},{lvl132_smallClouds:0},{lvl135_parts:0},{lvl137_moveTo:0},{lvl137_body:0},{lvl140_wifiFrame:0},{lvl212_Hats:0},{lvl212_skirts:0},{lvl212_shirts:0},{lvl159_buttons:0},{lvl_5_drags:0},{lvl_7_drags:0},{nb_172_dragObjects:0},{nb_38_drags:0},{nb_lvl_148_rocket_pieces:0},{nb_lvl_174_drags:0},{nb_lvl_175_drags:0},{nb_lvl_199_cars:0},{nb_lvl_149_candybar_shadows:0},{check:0},{check2:0},{counter:0},{counter2:0},{clickable:0},{coins:0},{levelCapSize:0},{levelMaxSize:0},{levelCompletedB:0},{levelCompletedG:0},{paused:0},{videoOfferOpen:0},{gameplayStart:0},{gameplayStop:0},{amonutOfRewarded:0},{CurrentLayout:0},{name:0},{loop:0},{text:0},{rep:0},{visibleCount:0},{language:0},{angleSwipe:0},{noDragable:0},{hasMatSausage:0},{hasBobbaSausage:0},{result:0},{levelSortStart:0},{sort:0},{allDataCompleted:0},{log:0},{requestedLevel:0},{isTextFit:0},{isTextShrink:0},{musicClosed:0},{soundClosed:0},{waitSec:0},{fromHome:0},{loaderComplete:0},{firstOpen:0},{intro:0},{maxLevelCount:0},{maxDataRepeatCount:0},{maxLanguageCount:0},{coinValue:0},{coinArrived:0},{localUppercaseSuccesText:0},{firstText:0},{secondText:0},{allMatch:0},{lvl_109_control:0},{allSame:0},{loser:0},{canTouch:0},{wave:0},{lvl134_touchInFrame:0},{BaslangicEtiketi:0},{BitisEtiketi:0},{TransparanBBCodeBaslangic:0},{TransparanBBCodeBitis:0},{IslemGorecekMetin:0},{SonucMetni:0},{bitisIndex:0},{kelimeBaslangicPozisyonu:0},{kelimeUzunlugu:0},{transparanOlacakKelime:0},{metninBasi:0},{metninSonu:0},{baslangicIndex:0},{firstPosX2:0},{firstPosY2:0},{isLevelCheck:0},{isLevelCheck2:0},{catWeight:0},{lillyOnGymmy:0},{nb_167_screw1:0},{nb_167_screw2:0},{sheepCount:0},{canMove:0},{lvl8end:0},{successCount:0},{nb_39_successCount:0},{nb_46_check:0},{nb_lvl_141_cookieCount:0},{nb_lvl_142_rock:0},{nb_lvl_142_scissors:0},{nb_lvl_142_paper:0},{nb_lvl_142_rock2:0},{nb_lvl_142_scissors2:0},{nb_lvl_142_paper2:0},{isOnFloor:0},{fishCounter:0},{nb_lvl_175_check:0},{nb_lvl_175_check2:0},{nb_lvl_182_gameOver:0},{nb_lvl_183_tapCount:0},{isWeightOnPlace:0},{isWeightOnAir:0},{isCoconutOnPlace:0},{liliseat:0},{worryseat:0},{jennyseat:0},{seatControl:0},{nb_lvl_199_Counter:0},{nb_lvl_199_Counter2:0}],self.InstanceType={AJAX:class extends self.IInstance{},ArrayLevels:class extends self.IArrayInstance{},ArraySkipped:class extends self.IArrayInstance{},Audio:class extends self.IInstance{},background2:class extends self.ISpriteInstance{},box:class extends self.ISpriteInstance{},Browser:class extends self.IInstance{},bubbletext:class extends self.ITextInstance{},bubbletext2:class extends self.ITextInstance{},bubbletext3:class extends self.ITextInstance{},coin_price:class extends self.ISpriteInstance{},coin_price2:class extends self.ISpriteInstance{},coin_price3:class extends self.ISpriteInstance{},coinAmpul3:class extends self.ISpriteInstance{},coinbg:class extends self.ISpriteInstance{},cointext:class extends self.ITextInstance{},control:class extends self.ISpriteInstance{},control4:class extends self.ISpriteInstance{},control5:class extends self.ISpriteInstance{},CorrectIcon:class extends self.ISpriteInstance{},dialog_speech:class extends self.ISpriteInstance{},dialog_speech3:class extends self.ISpriteInstance{},earncoinText:class extends self.ITextInstance{},earncoinText2:class extends self.ITextInstance{},explosion:class extends self.ISpriteInstance{},GameData:class extends self.IDictionaryInstance{},gameplay_hint_cost:class extends self.ISpriteInstance{},gameplay_hint_opened:class extends self.ISpriteInstance{},gameplay_hint_opened2:class extends self.ISpriteInstance{},gameplay_hint_opened3:class extends self.ISpriteInstance{},gameplay_hint_opened4:class extends self.ISpriteInstance{},hint_lock:class extends self.ISpriteInstance{},hint_price:class extends self.ISpriteInstance{},hintBack:class extends self.ISpriteInstance{},hintClose:class extends self.ISpriteInstance{},hintText1:class extends self.ITextInstance{},hintText2:class extends self.ITextInstance{},hintText3:class extends self.ITextInstance{},hintText4:class extends self.ITextInstance{},hintTitle1:class extends self.ITextInstance{},home_levels:class extends self.ISpriteInstance{},JSON:class extends self.IJSONInstance{},levelcompletedtext2:class extends self.ITextInstance{},NextBackground:class extends self.ISpriteInstance{},levelend_next:class extends self.ISpriteInstance{},levelend_restart:class extends self.ISpriteInstance{},levelend_restart_failed:class extends self.ISpriteInstance{},levelnumberText:class extends self.ITextInstance{},levelnumberText2:class extends self.ITextInstance{},levelnumberText3:class extends self.ITextInstance{},levels_bonus_locked:class extends self.ISpriteInstance{},levels_checkmark:class extends self.ISpriteInstance{},levels_checkmark2:class extends self.ISpriteInstance{},levels_checkmark3:class extends self.ISpriteInstance{},levels_gundolf_locked:class extends self.ISpriteInstance{},levels_locked:class extends self.ISpriteInstance{},line:class extends self.ISpriteInstance{},loadText:class extends self.ITextInstance{},LocalStorage:class extends self.IInstance{},PlatformInfo:class extends self.IInstance{},restartText:class extends self.ITextInstance{},settings:class extends self.ISpriteInstance{},settingsText:class extends self.ITextInstance{},settingsTxt:class extends self.ITextInstance{},sureBack:class extends self.ISpriteInstance{},sureBtn:class extends self.ISpriteInstance{},sureBtnText:class extends self.ITextInstance{},sureClose:class extends self.ISpriteInstance{},surePrice:class extends self.ITextInstance{},sureText:class extends self.ITextInstance{},Touch:class extends self.IInstance{},WrongIcon:class extends self.ISpriteInstance{},buttons_back:class extends self.ISpriteInstance{},buttons_music_off:class extends self.ISpriteInstance{},buttons_music_on:class extends self.ISpriteInstance{},buttons_sound_off:class extends self.ISpriteInstance{},buttons_sound_on:class extends self.ISpriteInstance{},levelend_rate_bg:class extends self.ISpriteInstance{},music_On_Off:class extends self.ISpriteInstance{},sound_On_Off:class extends self.ISpriteInstance{},m_white_sprite:class extends self.ISpriteInstance{},CorrectIcon2:class extends self.ISpriteInstance{},coin_price4:class extends self.ISpriteInstance{},splashikon2:class extends self.ISpriteInstance{},sureBtnLevelSelect:class extends self.ISpriteInstance{},hints_global:class extends self.ISpriteInstance{},rewarded_gameplay_global:class extends self.ISpriteInstance{},reward_bulb_global:class extends self.ISpriteInstance{},rewardPriceText_global:class extends self.ITextInstance{},skip_button_global:class extends self.ISpriteInstance{},skipBack:class extends self.ISpriteInstance{},skipBtn:class extends self.ISpriteInstance{},skipBtnText:class extends self.ITextInstance{},skipClose:class extends self.ISpriteInstance{},coinAmpul4:class extends self.ISpriteInstance{},surePrice2:class extends self.ITextInstance{},skipText:class extends self.ITextInstance{},Json_GameData:class extends self.IJSONInstance{},Json_LevelEndCharacterData:class extends self.IJSONInstance{},leveltext:class extends self.ITextInstance{},beaf:class extends self.ISpriteInstance{},burrito:class extends self.ISpriteInstance{},chicken:class extends self.ISpriteInstance{},option_bg:class extends self.ISpriteInstance{},plate:class extends self.ISpriteInstance{},saliva:class extends self.ISpriteInstance{},Table:class extends self.ISpriteInstance{},A:class extends self.ITextInstance{},B:class extends self.ITextInstance{},C:class extends self.ITextInstance{},plate_right:class extends self.ISpriteInstance{},lvl_158_order:class extends self.ITextInstance{},carpet:class extends self.ISpriteInstance{},control_2:class extends self.ISpriteInstance{},donut:class extends self.ISpriteInstance{},donut2:class extends self.ISpriteInstance{},donut3:class extends self.ISpriteInstance{},donut4:class extends self.ISpriteInstance{},donut5:class extends self.ISpriteInstance{},donut6:class extends self.ISpriteInstance{},fireplace:class extends self.ISpriteInstance{},sofa:class extends self.ISpriteInstance{},ball:class extends self.ISpriteInstance{},Bobba_Head_Whole:class extends self.ISpriteInstance{},ors:class extends self.ISpriteInstance{},smalltable:class extends self.ISpriteInstance{},tableback:class extends self.ISpriteInstance{},flower_closed:class extends self.ISpriteInstance{},floweropen_big:class extends self.ISpriteInstance{},floweropen_small:class extends self.ISpriteInstance{},soilwflowers:class extends self.ISpriteInstance{},sun:class extends self.ISpriteInstance{},lvl_160_cookiebig:class extends self.ISpriteInstance{},cookiesmall:class extends self.ISpriteInstance{},cat:class extends self.ISpriteInstance{},cat2:class extends self.ISpriteInstance{},cat3:class extends self.ISpriteInstance{},cat4:class extends self.ISpriteInstance{},cat5:class extends self.ISpriteInstance{},checkmark:class extends self.ISpriteInstance{},fish:class extends self.ISpriteInstance{},plate2:class extends self.ISpriteInstance{},table2:class extends self.ISpriteInstance{},cake_eaten:class extends self.ISpriteInstance{},cat_Tail:class extends self.ISpriteInstance{},cat_tongue:class extends self.ISpriteInstance{},catbig:class extends self.ISpriteInstance{},smudge:class extends self.ISpriteInstance{},smudge2:class extends self.ISpriteInstance{},smudge3:class extends self.ISpriteInstance{},cat_tongue2:class extends self.ISpriteInstance{},smudge4:class extends self.ISpriteInstance{},nb_cat_Tail:class extends self.ISpriteInstance{},bandaid:class extends self.ISpriteInstance{},bandaid2:class extends self.ISpriteInstance{},car_tileless:class extends self.ISpriteInstance{},hiprounded:class extends self.ISpriteInstance{},lever:class extends self.ISpriteInstance{},nail:class extends self.ISpriteInstance{},Sprite5:class extends self.ISpriteInstance{},tire:class extends self.ISpriteInstance{},tirebumped:class extends self.ISpriteInstance{},lvl_68_compressor:class extends self.ISpriteInstance{},bush:class extends self.ISpriteInstance{},bush2:class extends self.ISpriteInstance{},Sprite6:class extends self.ISpriteInstance{},Sprite8:class extends self.ISpriteInstance{},carrot_big:class extends self.ISpriteInstance{},carrot_normal:class extends self.ISpriteInstance{},carrot_small:class extends self.ISpriteInstance{},floorline:class extends self.ISpriteInstance{},holeline:class extends self.ISpriteInstance{},comb:class extends self.ISpriteInstance{},dandruff:class extends self.ISpriteInstance{},dandruff2:class extends self.ISpriteInstance{},dandruff3:class extends self.ISpriteInstance{},dandruff4:class extends self.ISpriteInstance{},dandruff5:class extends self.ISpriteInstance{},dandruff6:class extends self.ISpriteInstance{},dandruff7:class extends self.ISpriteInstance{},shampoo:class extends self.ISpriteInstance{},shampoo2:class extends self.ISpriteInstance{},Lily_Angry:class extends self.ISpriteInstance{},Lily_Back_Arm2:class extends self.ISpriteInstance{},Lily_Back_Leg_:class extends self.ISpriteInstance{},Lily_Back_Leg_2:class extends self.ISpriteInstance{},Lily_Body:class extends self.ISpriteInstance{},Lily_Crying:class extends self.ISpriteInstance{},Lily_Eyes:class extends self.ISpriteInstance{},Lily_Eyes_Inside:class extends self.ISpriteInstance{},Lily_Front_Arm:class extends self.ISpriteInstance{},Lily_Front_Arm2:class extends self.ISpriteInstance{},Lily_Front_Leg_:class extends self.ISpriteInstance{},Lily_Front_Leg_2:class extends self.ISpriteInstance{},Lily_Hair_Piece_:class extends self.ISpriteInstance{},Lily_Hair_Piece_2:class extends self.ISpriteInstance{},Lily_Happy:class extends self.ISpriteInstance{},Lily_Head:class extends self.ISpriteInstance{},Lily_Lids:class extends self.ISpriteInstance{},Lily_whole_face:class extends self.ISpriteInstance{},Lily_Skirt:class extends self.ISpriteInstance{},Lily_Smile:class extends self.ISpriteInstance{},Lily_Body2:class extends self.ISpriteInstance{},Lily_Head2:class extends self.ISpriteInstance{},Lily_Front_Arm3:class extends self.ISpriteInstance{},Lily_Back_Arm_3:class extends self.ISpriteInstance{},Lily_Front_Arm4:class extends self.ISpriteInstance{},Lily_Normal2:class extends self.ISpriteInstance{},Lily_Hair_Piece_3:class extends self.ISpriteInstance{},Lily_Hair_Piece_4:class extends self.ISpriteInstance{},Lily_Happy2:class extends self.ISpriteInstance{},Lily_Body_Main:class extends self.ISpriteInstance{},Lily_Front_Arm7:class extends self.ISpriteInstance{},Lily_Happy4:class extends self.ISpriteInstance{},Lily_Front_Arm8:class extends self.ISpriteInstance{},Lily_Front_Arm9:class extends self.ISpriteInstance{},Lily_whole_face_lvl_14:class extends self.ISpriteInstance{},Lily_Front_Arm12:class extends self.ISpriteInstance{},Lily_Front_Arm112:class extends self.ISpriteInstance{},Lily_Front_Arm13:class extends self.ISpriteInstance{},Lily_Back_Arm3:class extends self.ISpriteInstance{},Lily_Front_Arm14:class extends self.ISpriteInstance{},Lily_Front_Arm15:class extends self.ISpriteInstance{},Lily_Front_Arm113:class extends self.ISpriteInstance{},Lily_Back_Arm4:class extends self.ISpriteInstance{},houses_floorline:class extends self.ISpriteInstance{},main_back_house:class extends self.ISpriteInstance{},main_back_house2:class extends self.ISpriteInstance{},main_back_house4:class extends self.ISpriteInstance{},main_bottommenu_line:class extends self.ISpriteInstance{},main_clouds:class extends self.ISpriteInstance{},main_front_house:class extends self.ISpriteInstance{},main_front_house2:class extends self.ISpriteInstance{},main_grass:class extends self.ISpriteInstance{},main_play:class extends self.ISpriteInstance{},main_tree:class extends self.ISpriteInstance{},Main_MailBox:class extends self.ISpriteInstance{},main_clouds2:class extends self.ISpriteInstance{},lvl124_OBJ:class extends self.ISpriteInstance{},LVL214_obj:class extends self.ISpriteInstance{},amy_head:class extends self.ISpriteInstance{},avatarbg:class extends self.ISpriteInstance{},lvl121_obj1:class extends self.ISpriteInstance{},lvl207_bigdumbble:class extends self.ISpriteInstance{},callbutton:class extends self.ISpriteInstance{},closebuton:class extends self.ISpriteInstance{},lvl137_obj:class extends self.ISpriteInstance{},lvl140_obj:class extends self.ISpriteInstance{},finishline:class extends self.ISpriteInstance{},general_localize_text:class extends self.ITextInstance{},hat:class extends self.ISpriteInstance{},lvl108_chocolatesouce:class extends self.ISpriteInstance{},lvl108_cookie:class extends self.ISpriteInstance{},lvl108_cookie_drop:class extends self.ISpriteInstance{},lvl108_drop:class extends self.ISpriteInstance{},lvl108_minitable:class extends self.ISpriteInstance{},lvl109_bone:class extends self.ISpriteInstance{},lvl109_dog1_angry:class extends self.ISpriteInstance{},lvl109_dog1_bark:class extends self.ISpriteInstance{},lvl109_dog1_calm:class extends self.ISpriteInstance{},lvl109_dog2_angry:class extends self.ISpriteInstance{},lvl109_dog2_bark:class extends self.ISpriteInstance{},lvl109_dog2_calm:class extends self.ISpriteInstance{},lvl109_rope_loose:class extends self.ISpriteInstance{},lvl109_rope_stiff:class extends self.ISpriteInstance{},lvl109_stick_out:class extends self.ISpriteInstance{},lvl109_stick_tided:class extends self.ISpriteInstance{},lvl110_box:class extends self.ISpriteInstance{},lvl110_emptyside:class extends self.ISpriteInstance{},lvl110_submit:class extends self.ISpriteInstance{},lvl111_ghost:class extends self.ISpriteInstance{},lvl111_plate3:class extends self.ISpriteInstance{},lvl111_sugarbig:class extends self.ISpriteInstance{},lvl111_sugargrains:class extends self.ISpriteInstance{},lvl111_sugargrains_single:class extends self.ISpriteInstance{},lvl111_whitedonut:class extends self.ISpriteInstance{},lvl112_dog1_angry:class extends self.ISpriteInstance{},lvl112_dog1_bark:class extends self.ISpriteInstance{},lvl112_dog_moth:class extends self.ISpriteInstance{},lvl112_Fence:class extends self.ISpriteInstance{},lvl112_lilyStick:class extends self.ISpriteInstance{},lvl112_steak:class extends self.ISpriteInstance{},lvl112_stick:class extends self.ISpriteInstance{},lvl112_wall:class extends self.ISpriteInstance{},lvl114_obj11:class extends self.ISpriteInstance{},lvl114_obj2:class extends self.ISpriteInstance{},lvl114_obj3:class extends self.ISpriteInstance{},lvl114_obj4:class extends self.ISpriteInstance{},lvl114_trash:class extends self.ISpriteInstance{},lvl114_trash_front:class extends self.ISpriteInstance{},lvl116_Equal2:class extends self.ISpriteInstance{},lvl116_multiply:class extends self.ISpriteInstance{},lvl116_number10:class extends self.ISpriteInstance{},lvl116_number11:class extends self.ISpriteInstance{},lvl116_number12:class extends self.ISpriteInstance{},lvl116_number13:class extends self.ISpriteInstance{},lvl116_number6:class extends self.ISpriteInstance{},lvl116_number7:class extends self.ISpriteInstance{},lvl116_number8:class extends self.ISpriteInstance{},lvl116_number9:class extends self.ISpriteInstance{},lvl116_plus2:class extends self.ISpriteInstance{},lvl116_Qmark:class extends self.ISpriteInstance{},lvl118_bottle_flushed:class extends self.ISpriteInstance{},lvl118_bottle_splash:class extends self.ISpriteInstance{},lvl118_frog:class extends self.ISpriteInstance{},lvl118_frog_flying:class extends self.ISpriteInstance{},lvl118_hole2:class extends self.ISpriteInstance{},lvl118_jumplines:class extends self.ISpriteInstance{},lvl118_jumplines2:class extends self.ISpriteInstance{},lvl118_lake:class extends self.ISpriteInstance{},lvl118_leafbig:class extends self.ISpriteInstance{},lvl118_leafsmall:class extends self.ISpriteInstance{},lvl119_colorNumberText:class extends self.ITextInstance{},lvl119_greenbutton:class extends self.ISpriteInstance{},lvl119_greencircle:class extends self.ISpriteInstance{},lvl119_greencircle2:class extends self.ISpriteInstance{},lvl119_handle:class extends self.ISpriteInstance{},lvl119_machine:class extends self.ISpriteInstance{},lvl119_redcircle:class extends self.ISpriteInstance{},lvl119_redcircle2:class extends self.ISpriteInstance{},lvl119_Screen_off:class extends self.ISpriteInstance{},lvl120_dog:class extends self.ISpriteInstance{},lvl120_dog1:class extends self.ISpriteInstance{},lvl120_dog10:class extends self.ISpriteInstance{},lvl120_dog11:class extends self.ISpriteInstance{},lvl120_dog12:class extends self.ISpriteInstance{},lvl120_dog2:class extends self.ISpriteInstance{},lvl120_dog3:class extends self.ISpriteInstance{},lvl120_dog4:class extends self.ISpriteInstance{},lvl120_dog5:class extends self.ISpriteInstance{},lvl120_dog6:class extends self.ISpriteInstance{},lvl120_dog7:class extends self.ISpriteInstance{},lvl120_dog8:class extends self.ISpriteInstance{},lvl120_dog9:class extends self.ISpriteInstance{},lvl120_dogHands:class extends self.ISpriteInstance{},lvl120_dogHandsLeft:class extends self.ISpriteInstance{},lvl120_dogHandsLeft2:class extends self.ISpriteInstance{},lvl120_dogLegs:class extends self.ISpriteInstance{},lvl120_dogLegs2:class extends self.ISpriteInstance{},lvl120_dogRightArm:class extends self.ISpriteInstance{},lvl120_martianThirdEye:class extends self.ISpriteInstance{},lvl120_NumberBG:class extends self.ISpriteInstance{},lvl120_road:class extends self.ISpriteInstance{},lvl120_speed:class extends self.ITextInstance{},lvl121_4Text:class extends self.ITextInstance{},lvl121_blackBody:class extends self.ISpriteInstance{},lvl121_greenpiece:class extends self.ISpriteInstance{},lvl121_hotdog:class extends self.ISpriteInstance{},lvl121_number2:class extends self.ISpriteInstance{},lvl121_pricesign:class extends self.ISpriteInstance{},lvl121_pricesign_leg:class extends self.ISpriteInstance{},lvl121_rocket:class extends self.ISpriteInstance{},lvl121_rocket_flame:class extends self.ISpriteInstance{},lvl121_rocketglass:class extends self.ISpriteInstance{},lvl121_stand:class extends self.ISpriteInstance{},lvl121_whiteBody:class extends self.ISpriteInstance{},lvl122_astreoid_big:class extends self.ISpriteInstance{},lvl122_astreoid_crack:class extends self.ISpriteInstance{},lvl122_astreoid_piece:class extends self.ISpriteInstance{},lvl122_astreoid_piece2:class extends self.ISpriteInstance{},lvl122_astreoid_piece3:class extends self.ISpriteInstance{},lvl122_astreoid_small:class extends self.ISpriteInstance{},lvl122_star:class extends self.ISpriteInstance{},lvl122_star2:class extends self.ISpriteInstance{},lvl122_star3:class extends self.ISpriteInstance{},lvl122_star4:class extends self.ISpriteInstance{},lvl123_lily_eyes1:class extends self.ISpriteInstance{},lvl123_lilyEyes:class extends self.ISpriteInstance{},lvl123_lilyMouth:class extends self.ISpriteInstance{},lvl124_juicebox:class extends self.ISpriteInstance{},lvl124_juicepiece:class extends self.ISpriteInstance{},lvl124_tape:class extends self.ISpriteInstance{},lvl124_tapedmouth:class extends self.ISpriteInstance{},lvl124_water:class extends self.ISpriteInstance{},lvl125_astreoid_small:class extends self.ISpriteInstance{},lvl125_planet:class extends self.ISpriteInstance{},lvl125_planet1:class extends self.ISpriteInstance{},lvl125_planet3:class extends self.ISpriteInstance{},lvl125_sun2:class extends self.ISpriteInstance{},lvl126_astreoid_yellow:class extends self.ISpriteInstance{},lvl126_mars:class extends self.ISpriteInstance{},lvl127_handleft:class extends self.ISpriteInstance{},lvl127_handright:class extends self.ISpriteInstance{},lvl127_hole2:class extends self.ISpriteInstance{},lvl127_mole:class extends self.ISpriteInstance{},lvl127_turtle:class extends self.ISpriteInstance{},lvl127_turtle_shadow:class extends self.ISpriteInstance{},lvl128_rope_straight:class extends self.ISpriteInstance{},lvl128_rope_tied:class extends self.ISpriteInstance{},lvl128_wings:class extends self.ISpriteInstance{},lvl129_leakcloud:class extends self.ISpriteInstance{},lvl129_leakcloud_smallpiece:class extends self.ISpriteInstance{},lvl129_leakcloud_smallpiece2:class extends self.ISpriteInstance{},lvl129_pipe:class extends self.ISpriteInstance{},lvl129_pipe2:class extends self.ISpriteInstance{},lvl129_pipe3:class extends self.ISpriteInstance{},lvl129_valve:class extends self.ISpriteInstance{},lvl129_worryMouth:class extends self.ISpriteInstance{},lvl131_flag:class extends self.ISpriteInstance{},lvl131_leftHand:class extends self.ISpriteInstance{},lvl131_martianBody:class extends self.ISpriteInstance{},lvl131_martianEyesUp:class extends self.ISpriteInstance{},lvl131_martianGlass:class extends self.ISpriteInstance{},lvl131_martianHeadLine:class extends self.ISpriteInstance{},lvl131_martianHeads:class extends self.ISpriteInstance{},lvl131_martianMouth:class extends self.ISpriteInstance{},lvl131_rightHand:class extends self.ISpriteInstance{},lvl131_whitemelon:class extends self.ISpriteInstance{},lvl131_whitemelon_piece:class extends self.ISpriteInstance{},lvl131_whitemelon_piece_left:class extends self.ISpriteInstance{},lvl131_whitewater:class extends self.ISpriteInstance{},lvl132_bed:class extends self.ISpriteInstance{},lvl132_cloud_big:class extends self.ISpriteInstance{},lvl132_cloud_big2:class extends self.ISpriteInstance{},lvl132_cloud_big3:class extends self.ISpriteInstance{},lvl132_cloud_explode:class extends self.ISpriteInstance{},lvl132_cloud_s:class extends self.ISpriteInstance{},lvl132_cloud_s2:class extends self.ISpriteInstance{},lvl132_cloud_s3:class extends self.ISpriteInstance{},lvl132_lava_explode:class extends self.ISpriteInstance{},lvl132_lava_floating:class extends self.ISpriteInstance{},lvl132_sand_dots:class extends self.ISpriteInstance{},lvl132_sandPatch:class extends self.IWorldInstance{},lvl132_seePatch:class extends self.IWorldInstance{},lvl132_sun2:class extends self.ISpriteInstance{},lvl132_sunglasses:class extends self.ISpriteInstance{},lvl132_umbrella:class extends self.ISpriteInstance{},lvl132_volcano:class extends self.ISpriteInstance{},lvl134_big_nonSquarePatch:class extends self.IWorldInstance{},lvl134_big_SquarePatch:class extends self.IWorldInstance{},lvl134_medium_nonsquare:class extends self.ISpriteInstance{},lvl134_mediumSquare:class extends self.ISpriteInstance{},lvl134_small_nonsquare:class extends self.ISpriteInstance{},lvl134_smallSquare:class extends self.ISpriteInstance{},lvl135_rock:class extends self.ISpriteInstance{},lvl135_stick:class extends self.ISpriteInstance{},lvl136_bigphone:class extends self.ISpriteInstance{},lvl136_granny_body:class extends self.ISpriteInstance{},lvl136_granny_eyes:class extends self.ISpriteInstance{},lvl136_granny_eyes_lash:class extends self.ISpriteInstance{},lvl136_granny_hair:class extends self.ISpriteInstance{},lvl136_granny_head:class extends self.ISpriteInstance{},lvl136_granny_leftarm:class extends self.ISpriteInstance{},lvl136_granny_leftarmupper:class extends self.ISpriteInstance{},lvl136_granny_muth:class extends self.ISpriteInstance{},lvl136_granny_righthand:class extends self.ISpriteInstance{},lvl136_granny_rightHandUpper:class extends self.ISpriteInstance{},lvl136_granny_rightLeg:class extends self.ISpriteInstance{},lvl136_grannyLeftLeg:class extends self.ISpriteInstance{},lvl136_line:class extends self.ISpriteInstance{},lvl136_tikiavatar:class extends self.ISpriteInstance{},lvl136_vacuumcleaner:class extends self.ISpriteInstance{},lvl136_water:class extends self.ISpriteInstance{},lvl137_rival1_body:class extends self.ISpriteInstance{},lvl137_rival1_head:class extends self.ISpriteInstance{},lvl137_rival1_leftarm:class extends self.ISpriteInstance{},lvl137_rival1_leftarm1:class extends self.ISpriteInstance{},lvl137_rival1_leftLeg:class extends self.ISpriteInstance{},lvl137_rival1_leftLeg1:class extends self.ISpriteInstance{},lvl137_rival1_rightarm:class extends self.ISpriteInstance{},lvl137_rival1_rightarm1:class extends self.ISpriteInstance{},lvl137_rival1_rightLeg:class extends self.ISpriteInstance{},lvl137_rival1_rightLeg1:class extends self.ISpriteInstance{},lvl137_rival2_body:class extends self.ISpriteInstance{},lvl137_rival2_eyesPart:class extends self.ISpriteInstance{},lvl137_rival2_eyesPart1:class extends self.ISpriteInstance{},lvl137_rival2_eyesPart2:class extends self.ISpriteInstance{},lvl137_rival2_eyesPart3:class extends self.ISpriteInstance{},lvl137_rival2_eyesPart4:class extends self.ISpriteInstance{},lvl137_rival2_eyesPart5:class extends self.ISpriteInstance{},lvl137_rival2_eyesPart6:class extends self.ISpriteInstance{},lvl137_rival2_hip:class extends self.ISpriteInstance{},lvl137_rival2_leftarm:class extends self.ISpriteInstance{},lvl137_rival2_leftarm1:class extends self.ISpriteInstance{},lvl137_rival2_leftleg:class extends self.ISpriteInstance{},lvl137_rival2_leftleg1:class extends self.ISpriteInstance{},lvl137_rival2_mouth:class extends self.ISpriteInstance{},lvl137_rival2_mouth1:class extends self.ISpriteInstance{},lvl137_rival2_mouth2:class extends self.ISpriteInstance{},lvl137_rival2_mouth3:class extends self.ISpriteInstance{},lvl137_rival2_mouth4:class extends self.ISpriteInstance{},lvl137_rival2_rightarm:class extends self.ISpriteInstance{},lvl137_rival2_rightarm1:class extends self.ISpriteInstance{},lvl137_rival2_rightleg:class extends self.ISpriteInstance{},lvl137_rival2_rightleg1:class extends self.ISpriteInstance{},lvl138_camera:class extends self.ISpriteInstance{},lvl138_food:class extends self.ISpriteInstance{},lvl138_martian_Statue:class extends self.ISpriteInstance{},lvl138_photoframe:class extends self.ISpriteInstance{},lvl138_quitar:class extends self.ISpriteInstance{},lvl139_bottle:class extends self.ISpriteInstance{},lvl139_bottleopener:class extends self.ISpriteInstance{},lvl139_closetopen:class extends self.ISpriteInstance{},lvl139_kol:class extends self.IWorldInstance{},lvl139_laser_explosion:class extends self.ISpriteInstance{},lvl139_laser_laserline:class extends self.ISpriteInstance{},lvl139_remote_body:class extends self.ISpriteInstance{},lvl139_remote_handle:class extends self.ISpriteInstance{},lvl139_robot1_head:class extends self.ISpriteInstance{},lvl139_robot2_head:class extends self.ISpriteInstance{},lvl139_robot_standbig:class extends self.ISpriteInstance{},lvl139_scissors:class extends self.ISpriteInstance{},lvl139_soda_bottle:class extends self.ISpriteInstance{},lvl139_soda_cap:class extends self.ISpriteInstance{},lvl139_soda_gas:class extends self.ISpriteInstance{},lvl140_laptop:class extends self.ISpriteInstance{},lvl140_laptop_Table:class extends self.ISpriteInstance{},lvl140_martianHeadLine:class extends self.ISpriteInstance{},lvl140_photo:class extends self.ISpriteInstance{},lvl140_photo1:class extends self.ISpriteInstance{},lvl140_photo2:class extends self.ISpriteInstance{},lvl140_progressbar_bar:class extends self.ISpriteInstance{},lvl140_progressbar_frame:class extends self.ISpriteInstance{},lvl140_satellite:class extends self.ISpriteInstance{},lvl140_weakwifi:class extends self.ISpriteInstance{},lvl140_wifilinebig:class extends self.ISpriteInstance{},lvl140_wifilinemedium:class extends self.ISpriteInstance{},lvl140_wifilinesmall:class extends self.ISpriteInstance{},lvl156_cat6:class extends self.ISpriteInstance{},lvl156_dog:class extends self.ISpriteInstance{},lvl156_dogear_down:class extends self.ISpriteInstance{},lvl156_dogear_up:class extends self.ISpriteInstance{},lvl156_donkey:class extends self.ISpriteInstance{},lvl156_fly:class extends self.ISpriteInstance{},lvl156_fly_line:class extends self.ISpriteInstance{},lvl158_giraffe:class extends self.ISpriteInstance{},lvl158_happycat_:class extends self.ISpriteInstance{},lvl158_ruler:class extends self.ISpriteInstance{},lvl159_bluebutton:class extends self.ISpriteInstance{},lvl159_greenbutton:class extends self.ISpriteInstance{},lvl159_paint:class extends self.ISpriteInstance{},lvl159_redbutton:class extends self.ISpriteInstance{},lvl159_water:class extends self.ISpriteInstance{},lvl159_watersplash:class extends self.ISpriteInstance{},lvl162_blackbird:class extends self.ISpriteInstance{},lvl162_bluebird:class extends self.ISpriteInstance{},lvl162_brush:class extends self.ISpriteInstance{},lvl162_grasspiece:class extends self.ISpriteInstance{},lvl162_paintbucket:class extends self.ISpriteInstance{},lvl162_paintonbrush:class extends self.ISpriteInstance{},lvl162_whitebird:class extends self.ISpriteInstance{},lvl163_answerbubble:class extends self.ISpriteInstance{},lvl163_number2:class extends self.ISpriteInstance{},lvl163_number4:class extends self.ISpriteInstance{},lvl163_number7:class extends self.ISpriteInstance{},lvl163_question:class extends self.ISpriteInstance{},lvl163_think:class extends self.ISpriteInstance{},lvl163_think2:class extends self.ISpriteInstance{},lvl165_amy_body:class extends self.ISpriteInstance{},lvl165_bluerabbit:class extends self.ISpriteInstance{},lvl165_button:class extends self.IWorldInstance{},lvl165_car:class extends self.ISpriteInstance{},lvl165_happygirl:class extends self.ISpriteInstance{},lvl165_helmet:class extends self.ISpriteInstance{},lvl165_man2_happy:class extends self.ISpriteInstance{},lvl165_pinkrabbit:class extends self.ISpriteInstance{},lvl165_slug:class extends self.ISpriteInstance{},lvl165_startText:class extends self.ITextInstance{},lvl180_burnt_smoke:class extends self.ISpriteInstance{},lvl180_closet_open:class extends self.ISpriteInstance{},lvl180_flame_big:class extends self.ISpriteInstance{},lvl180_flame_cloud_big:class extends self.ISpriteInstance{},lvl180_flame_cloud_small:class extends self.ISpriteInstance{},lvl180_lid:class extends self.ISpriteInstance{},lvl180_oil:class extends self.ISpriteInstance{},lvl180_pan:class extends self.ISpriteInstance{},lvl180_water:class extends self.ISpriteInstance{},lvl180_waterbottle:class extends self.ISpriteInstance{},lvl180_waterbottle_pouring:class extends self.ISpriteInstance{},lvl205_cips:class extends self.ISpriteInstance{},lvl205_cips2:class extends self.ISpriteInstance{},lvl205_cips3:class extends self.ISpriteInstance{},lvl205_cips4:class extends self.ISpriteInstance{},lvl205_cipspack:class extends self.ISpriteInstance{},lvl205_fork:class extends self.ISpriteInstance{},lvl205_napkin:class extends self.ISpriteInstance{},lvl205_vacuum:class extends self.ISpriteInstance{},lvl205_vacuum_pipebobba:class extends self.ISpriteInstance{},lvl205_vacuumpipe_normal:class extends self.ISpriteInstance{},lvl207_bigplant:class extends self.ISpriteInstance{},lvl207_cheesesouce:class extends self.ISpriteInstance{},lvl207_clock:class extends self.ISpriteInstance{},lvl207_flowers:class extends self.ISpriteInstance{},lvl207_mouseeating:class extends self.ISpriteInstance{},lvl207_reward:class extends self.ISpriteInstance{},lvl207_shelf:class extends self.ISpriteInstance{},lvl207_shelf2:class extends self.ISpriteInstance{},lvl2_bottle:class extends self.ISpriteInstance{},lvl2_cabinet2:class extends self.ISpriteInstance{},lvl2_closeddoor:class extends self.ISpriteInstance{},lvl2_hairpiece_:class extends self.ISpriteInstance{},lvl2_napkinbox:class extends self.ISpriteInstance{},lvl2_opendoor:class extends self.ISpriteInstance{},lvl2_pimple:class extends self.ISpriteInstance{},lvl2_toothbrush:class extends self.ISpriteInstance{},lvl2_toothpaste:class extends self.ISpriteInstance{},Mars_floor:class extends self.ISpriteInstance{},stick_floorline:class extends self.ISpriteInstance{},lvl139_closetopen2:class extends self.ISpriteInstance{},_115_bg:class extends self.ISpriteInstance{},_115_bush:class extends self.ISpriteInstance{},_9patch:class extends self.IWorldInstance{},_9patch3:class extends self.IWorldInstance{},_9patch4:class extends self.IWorldInstance{},bag_layer:class extends self.ISpriteInstance{},block:class extends self.ISpriteInstance{},body2:class extends self.ISpriteInstance{},broken:class extends self.ISpriteInstance{},CharacterNames:class extends self.IArrayInstance{},Characters:class extends self.ISpriteInstance{},comingsoon:class extends self.ISpriteInstance{},comingsoonText:class extends self.ITextInstance{},compressor_pipe:class extends self.ISpriteInstance{},computer_screen:class extends self.ISpriteInstance{},CSV:class extends self.IInstance{},currency_plus:class extends self.ISpriteInstance{},doorhandles:class extends self.ISpriteInstance{},DrWorry_Mouth:class extends self.ISpriteInstance{},empty_bottle:class extends self.ISpriteInstance{},equal:class extends self.ISpriteInstance{},fakeCol:class extends self.ISpriteInstance{},fakeDrag:class extends self.ISpriteInstance{},fakeLily:class extends self.ISpriteInstance{},floorline3:class extends self.ISpriteInstance{},floorpatternHD:class extends self.ISpriteInstance{},frame_:class extends self.ISpriteInstance{},gamerocket:class extends self.ISpriteInstance{},GrannyAmy_Back_Arm:class extends self.ISpriteInstance{},GrannyAmy_Back_Arm2:class extends self.ISpriteInstance{},GrannyAmy_Back_Leg:class extends self.ISpriteInstance{},GrannyAmy_Eyes:class extends self.ISpriteInstance{},GrannyAmy_Eyes_Inside2:class extends self.ISpriteInstance{},GrannyAmy_Front_Arm:class extends self.ISpriteInstance{},GrannyAmy_Front_Arm2:class extends self.ISpriteInstance{},GrannyAmy_Front_Leg:class extends self.ISpriteInstance{},GrannyAmy_happymouth:class extends self.ISpriteInstance{},GrannyAmy_Mouth:class extends self.ISpriteInstance{},GrannyAmy_Parcali2:class extends self.ISpriteInstance{},GrannyAmy_Parcali3:class extends self.ISpriteInstance{},GrannyAmy_scary_face:class extends self.ISpriteInstance{},grass:class extends self.ISpriteInstance{},grasspiece:class extends self.ISpriteInstance{},green_ground:class extends self.ISpriteInstance{},greenBattery:class extends self.IWorldInstance{},gun:class extends self.ISpriteInstance{},head:class extends self.ISpriteInstance{},head2:class extends self.ISpriteInstance{},hole:class extends self.ISpriteInstance{},homeIcon:class extends self.ISpriteInstance{},IntroLoadingText:class extends self.ITextInstance{},jenny_arm_muscle:class extends self.ISpriteInstance{},jenny_back_arm:class extends self.ISpriteInstance{},jenny_back_arm2:class extends self.ISpriteInstance{},jenny_back_leg:class extends self.ISpriteInstance{},jenny_back_leg2:class extends self.ISpriteInstance{},jenny_body:class extends self.ISpriteInstance{},jenny_brows_normal:class extends self.ISpriteInstance{},jenny_eye_lids2:class extends self.ISpriteInstance{},jenny_eyes:class extends self.ISpriteInstance{},jenny_eyes_inside:class extends self.ISpriteInstance{},jenny_front_arm:class extends self.ISpriteInstance{},jenny_front_arm2:class extends self.ISpriteInstance{},jenny_front_arm_mirrored:class extends self.ISpriteInstance{},jenny_front_leg:class extends self.ISpriteInstance{},jenny_front_leg2:class extends self.ISpriteInstance{},jenny_hair_0:class extends self.ISpriteInstance{},jenny_hand:class extends self.ISpriteInstance{},jenny_hand_ball:class extends self.ISpriteInstance{},jenny_head:class extends self.ISpriteInstance{},jenny_head_empty:class extends self.ISpriteInstance{},jenny_mouth:class extends self.ISpriteInstance{},jenny_racket:class extends self.ISpriteInstance{},jennygloves_back:class extends self.ISpriteInstance{},keyboard2:class extends self.ISpriteInstance{},keyboard_letter:class extends self.ISpriteInstance{},l67jennygloves_front:class extends self.ISpriteInstance{},l77jenny_racket_hand:class extends self.ISpriteInstance{},LanguageOrderDic:class extends self.IDictionaryInstance{},larry_arm:class extends self.ISpriteInstance{},larry_arm2:class extends self.ISpriteInstance{},larry_bodyback:class extends self.ISpriteInstance{},larry_cut_body:class extends self.ISpriteInstance{},larry_headback:class extends self.ISpriteInstance{},LazyLarry_back_arm:class extends self.ISpriteInstance{},LazyLarry_back_arm2:class extends self.ISpriteInstance{},LazyLarry_back_foot:class extends self.ISpriteInstance{},LazyLarry_backleg:class extends self.ISpriteInstance{},LazyLarry_body:class extends self.ISpriteInstance{},LazyLarry_brows_normal:class extends self.ISpriteInstance{},LazyLarry_brows_scared:class extends self.ISpriteInstance{},LazyLarry_eyelid_left:class extends self.ISpriteInstance{},LazyLarry_eyelid_right:class extends self.ISpriteInstance{},LazyLarry_eyes:class extends self.ISpriteInstance{},LazyLarry_eyes_left:class extends self.ISpriteInstance{},LazyLarry_eyes_right:class extends self.ISpriteInstance{},LazyLarry_frontarm:class extends self.ISpriteInstance{},LazyLarry_frontarm2:class extends self.ISpriteInstance{},LazyLarry_frontfoot:class extends self.ISpriteInstance{},LazyLarry_frontleg:class extends self.ISpriteInstance{},Levelend_ADS:class extends self.ISpriteInstance{},LevelEnd_CharacterBG:class extends self.ISpriteInstance{},levelsIcon:class extends self.ISpriteInstance{},LevelsLogicHolder:class extends self.IDictionaryInstance{},Lily_Back_Arm_5:class extends self.ISpriteInstance{},Lily_Back_Leg_3:class extends self.ISpriteInstance{},Lily_Back_Leg_4:class extends self.ISpriteInstance{},Lily_Body6:class extends self.ISpriteInstance{},Lily_brows_normal:class extends self.ISpriteInstance{},Lily_eyes_closed:class extends self.ISpriteInstance{},Lily_eyes_closed2:class extends self.ISpriteInstance{},Lily_eyes_inside2:class extends self.ISpriteInstance{},Lily_eyes_tired:class extends self.ISpriteInstance{},Lily_finger_point2:class extends self.ISpriteInstance{},Lily_Front_Arm10:class extends self.ISpriteInstance{},Lily_Front_Arm11:class extends self.ISpriteInstance{},Lily_Front_Leg_3:class extends self.ISpriteInstance{},Lily_Front_Leg_4:class extends self.ISpriteInstance{},Lily_Hair_Piece_5:class extends self.ISpriteInstance{},Lily_Hair_Piece_6:class extends self.ISpriteInstance{},Lily_hand_with_comb2:class extends self.ISpriteInstance{},Lily_happy_eyes_lid:class extends self.ISpriteInstance{},Lily_Head4:class extends self.ISpriteInstance{},Lily_mouth:class extends self.ISpriteInstance{},Lily_mouth_little:class extends self.ISpriteInstance{},Lily_mouth_soangry:class extends self.ISpriteInstance{},Lily_mouth_unhappy:class extends self.ISpriteInstance{},Lily_mouth_water:class extends self.ISpriteInstance{},Lily_new_eyes:class extends self.ISpriteInstance{},Lily_phone_arm:class extends self.ISpriteInstance{},Lily_sad_face:class extends self.ISpriteInstance{},Lily_Skirt2:class extends self.ISpriteInstance{},Lily_Smile2:class extends self.ISpriteInstance{},liontail:class extends self.ISpriteInstance{},LittleTiki_back_arm:class extends self.ISpriteInstance{},LittleTiki_back_arm2:class extends self.ISpriteInstance{},LittleTiki_backleg:class extends self.ISpriteInstance{},LittleTiki_body:class extends self.ISpriteInstance{},LittleTiki_brows_tricky:class extends self.ISpriteInstance{},LittleTiki_eyes:class extends self.ISpriteInstance{},LittleTiki_eyes_inside:class extends self.ISpriteInstance{},LittleTiki_front_arm:class extends self.ISpriteInstance{},LittleTiki_front_arm2:class extends self.ISpriteInstance{},LittleTiki_front_leg:class extends self.ISpriteInstance{},LittleTiki_head:class extends self.ISpriteInstance{},LittleTiki_mouth_tricky:class extends self.ISpriteInstance{},LittleTiki_pocket:class extends self.ISpriteInstance{},LittleTiki_skirt:class extends self.ISpriteInstance{},loading_bg:class extends self.ISpriteInstance{},loading_frame:class extends self.ISpriteInstance{},lowbattery:class extends self.ISpriteInstance{},lvl114_obj:class extends self.ISpriteInstance{},lvl115_angrylion:class extends self.ISpriteInstance{},lvl115_babylion:class extends self.ISpriteInstance{},lvl115_grass2:class extends self.ISpriteInstance{},lvl115_grass3:class extends self.ISpriteInstance{},lvl115_lion1_leg:class extends self.ISpriteInstance{},lvl115_lionmane:class extends self.ISpriteInstance{},lvl115_liontail2:class extends self.ISpriteInstance{},"lvl115_Lon":class extends self.ISpriteInstance{},lvl115_motherlion:class extends self.ISpriteInstance{},lvl248_cup_epmty:class extends self.ISpriteInstance{},lvl248_cup_full:class extends self.ISpriteInstance{},lvl79housepatch:class extends self.IWorldInstance{},lvl79windowPatch:class extends self.IWorldInstance{},lvl_100_brokenbutton:class extends self.ISpriteInstance{},lvl_100_cglue:class extends self.ISpriteInstance{},lvl_100_No_Text:class extends self.ITextInstance{},lvl_100_nobutton:class extends self.ISpriteInstance{},lvl_100_tape:class extends self.ISpriteInstance{},lvl_100_Yes_Text:class extends self.ITextInstance{},lvl_100_Yes_Text2:class extends self.ITextInstance{},lvl_107_hill:class extends self.IWorldInstance{},lvl_107_hill2:class extends self.IWorldInstance{},lvl_107_Jump_Text:class extends self.ITextInstance{},lvl_11_restart:class extends self.ISpriteInstance{},lvl_11_submit:class extends self.ISpriteInstance{},lvl_11_submitarea:class extends self.ISpriteInstance{},lvl_14_picturefrmae:class extends self.ISpriteInstance{},lvl_14_plant:class extends self.ISpriteInstance{},lvl_14_shelf:class extends self.ISpriteInstance{},lvl_21_bottles:class extends self.ISpriteInstance{},lvl_21_bottles_:class extends self.ISpriteInstance{},lvl_21_bottles_1:class extends self.ISpriteInstance{},lvl_21_drawer:class extends self.ISpriteInstance{},lvl_21_table:class extends self.ISpriteInstance{},lvl_24_wateringcan:class extends self.ISpriteInstance{},lvl_26_barrel:class extends self.ISpriteInstance{},lvl_28_shelf:class extends self.ISpriteInstance{},lvl_29_blood_bottle:class extends self.ISpriteInstance{},lvl_29_robot:class extends self.ISpriteInstance{},lvl_29_robot_bottom:class extends self.ISpriteInstance{},lvl_29_robot_on:class extends self.ISpriteInstance{},lvl_29_robot_plug:class extends self.ISpriteInstance{},lvl_2_fake_drag:class extends self.ISpriteInstance{},lvl_30_battery:class extends self.ISpriteInstance{},lvl_30_bucket:class extends self.ISpriteInstance{},lvl_30_curtain_closed:class extends self.ISpriteInstance{},lvl_30_curtain_open:class extends self.ISpriteInstance{},lvl_30_plug:class extends self.ISpriteInstance{},lvl_30_waterlayer:class extends self.ISpriteInstance{},lvl_42_apple:class extends self.ISpriteInstance{},lvl_43_knife:class extends self.ISpriteInstance{},lvl_49_wood:class extends self.ISpriteInstance{},lvl_50_bucket:class extends self.ISpriteInstance{},lvl_50_notes1:class extends self.ISpriteInstance{},lvl_50_notes2:class extends self.ISpriteInstance{},lvl_50_water:class extends self.ISpriteInstance{},lvl_52_pizza:class extends self.ISpriteInstance{},lvl_53_greenapple:class extends self.ISpriteInstance{},lvl_53_redapple:class extends self.ISpriteInstance{},lvl_54_dashed_line:class extends self.ISpriteInstance{},lvl_57_bubble:class extends self.ISpriteInstance{},lvl_57_coke:class extends self.ISpriteInstance{},lvl_57_extinqusher:class extends self.ISpriteInstance{},lvl_57_flame:class extends self.ISpriteInstance{},lvl_57_hotsouce:class extends self.ISpriteInstance{},lvl_57_kitchencounter:class extends self.ISpriteInstance{},lvl_57_milk:class extends self.ISpriteInstance{},lvl_57_milk_spilled:class extends self.ISpriteInstance{},lvl_57_milk_spilled2:class extends self.ISpriteInstance{},lvl_57_pepper:class extends self.ISpriteInstance{},lvl_57_pot:class extends self.ISpriteInstance{},lvl_57_salt:class extends self.ISpriteInstance{},lvl_57_shelf:class extends self.ISpriteInstance{},lvl_57_stove:class extends self.ISpriteInstance{},lvl_57_suce_white:class extends self.ISpriteInstance{},lvl_58_climateremote:class extends self.ISpriteInstance{},lvl_58_climateremoteText:class extends self.ITextInstance{},lvl_58_fan:class extends self.ISpriteInstance{},lvl_58_fireplace2:class extends self.ISpriteInstance{},lvl_58_glass_empty:class extends self.ISpriteInstance{},lvl_58_milk:class extends self.ISpriteInstance{},lvl_58_paper:class extends self.ISpriteInstance{},lvl_58_paperplane:class extends self.ISpriteInstance{},lvl_58_table3:class extends self.ISpriteInstance{},lvl_58_tablecloth:class extends self.ISpriteInstance{},lvl_58_toy_plane:class extends self.ISpriteInstance{},lvl_58_windlines:class extends self.ISpriteInstance{},lvl_59_arm_left:class extends self.ISpriteInstance{},lvl_59_button:class extends self.ISpriteInstance{},lvl_59_connection:class extends self.ISpriteInstance{},lvl_59_eyes_closed:class extends self.ISpriteInstance{},lvl_59_lamp_off:class extends self.ISpriteInstance{},lvl_59_leg_left:class extends self.ISpriteInstance{},lvl_59_robot_body:class extends self.ISpriteInstance{},lvl_59_robot_head:class extends self.ISpriteInstance{},lvl_59_screw:class extends self.ISpriteInstance{},lvl_59_stand:class extends self.ISpriteInstance{},lvl_59_table3:class extends self.ISpriteInstance{},lvl_59_tabletop_9slice:class extends self.ISpriteInstance{},lvl_59_toolbox:class extends self.ISpriteInstance{},lvl_59_wrench:class extends self.ISpriteInstance{},lvl_60_boat_waterlayer:class extends self.ISpriteInstance{},lvl_60_boathook_left:class extends self.ISpriteInstance{},lvl_60_boathook_rigth:class extends self.ISpriteInstance{},lvl_60_fishhook_stick:class extends self.ISpriteInstance{},lvl_60_fishhook_string_left:class extends self.ISpriteInstance{},lvl_60_fishhook_string_right:class extends self.ISpriteInstance{},lvl_60_hookpiece:class extends self.ISpriteInstance{},lvl_60_sea:class extends self.IWorldInstance{},lvl_60_vesthook_back:class extends self.ISpriteInstance{},lvl_60_wave:class extends self.ISpriteInstance{},lvl_60_wave2:class extends self.ISpriteInstance{},lvl_60_waveline1:class extends self.ISpriteInstance{},lvl_60_waveline2:class extends self.ISpriteInstance{},lvl_60_waveline3:class extends self.ISpriteInstance{},lvl_60_west_bobba:class extends self.ISpriteInstance{},lvl_60_west_lily:class extends self.ISpriteInstance{},lvl_61_banana:class extends self.ISpriteInstance{},lvl_61_banana2:class extends self.ISpriteInstance{},lvl_61_bird:class extends self.ISpriteInstance{},lvl_61_bush:class extends self.ISpriteInstance{},lvl_61_bush1:class extends self.ISpriteInstance{},lvl_61_floorHD:class extends self.ISpriteInstance{},lvl_62_ball2:class extends self.ISpriteInstance{},lvl_62_basket_front:class extends self.ISpriteInstance{},lvl_62_direk:class extends self.ISpriteInstance{},lvl_62_emptybottle:class extends self.ISpriteInstance{},lvl_62_milk:class extends self.ISpriteInstance{},lvl_62_pota:class extends self.ISpriteInstance{},lvl_62_pota_layer:class extends self.ISpriteInstance{},lvl_62_screw:class extends self.ISpriteInstance{},lvl_65_finishline:class extends self.ISpriteInstance{},lvl_65_rabbit:class extends self.ISpriteInstance{},lvl_65_siderobot_arm_left:class extends self.ISpriteInstance{},lvl_65_siderobot_arm_right:class extends self.ISpriteInstance{},lvl_65_siderobot_body:class extends self.ISpriteInstance{},lvl_65_siderobot_body2:class extends self.ISpriteInstance{},lvl_65_siderobot_eyesclosed:class extends self.ISpriteInstance{},lvl_65_siderobot_eyesclosed2:class extends self.ISpriteInstance{},lvl_65_siderobot_head:class extends self.ISpriteInstance{},lvl_65_siderobot_head2:class extends self.ISpriteInstance{},lvl_65_siderobot_leg_left:class extends self.ISpriteInstance{},lvl_65_siderobot_leg_left2:class extends self.ISpriteInstance{},lvl_65_siderobot_leg_left3:class extends self.ISpriteInstance{},lvl_65_siderobot_off:class extends self.ISpriteInstance{},lvl_65_siderobot_off2:class extends self.ISpriteInstance{},lvl_65_turtle:class extends self.ISpriteInstance{},lvl_66_100_Weight_Text:class extends self.ITextInstance{},lvl_66_dumbbell:class extends self.ISpriteInstance{},lvl_66_dumbbell_hand:class extends self.ISpriteInstance{},lvl_66_waterbottle:class extends self.ISpriteInstance{},lvl_66_weight:class extends self.ISpriteInstance{},lvl_66_Weight_Text:class extends self.ITextInstance{},lvl_66_weights:class extends self.ISpriteInstance{},lvl_67_ring_floor:class extends self.ISpriteInstance{},lvl_67_ring_sides:class extends self.ISpriteInstance{},lvl_67_robot_armbend:class extends self.ISpriteInstance{},lvl_67_robot_armbend2:class extends self.ISpriteInstance{},lvl_67_robot_backclosed:class extends self.ISpriteInstance{},lvl_67_robot_body:class extends self.ISpriteInstance{},lvl_67_robot_head:class extends self.ISpriteInstance{},lvl_67_robotgloves_back:class extends self.ISpriteInstance{},lvl_68_ball:class extends self.ISpriteInstance{},lvl_68_balloon_cat_deflated:class extends self.ISpriteInstance{},lvl_68_balloon_green_deflated:class extends self.ISpriteInstance{},lvl_68_balloon_red_deflated:class extends self.ISpriteInstance{},lvl_68_balloon_yellow_deflated:class extends self.ISpriteInstance{},lvl_68_compressor_pipe:class extends self.ISpriteInstance{},lvl_69_ant:class extends self.ISpriteInstance{},lvl_69_big_rock:class extends self.ISpriteInstance{},lvl_69_caterpillar:class extends self.ISpriteInstance{},lvl_69_cocoon:class extends self.ISpriteInstance{},lvl_69_cocoon_inside:class extends self.ISpriteInstance{},lvl_69_grass:class extends self.ISpriteInstance{},lvl_69_leaf:class extends self.ISpriteInstance{},lvl_69_small_rock:class extends self.ISpriteInstance{},lvl_69_tree:class extends self.ISpriteInstance{},lvl_70_flower_big:class extends self.ISpriteInstance{},lvl_70_jar:class extends self.ISpriteInstance{},lvl_70_net:class extends self.ISpriteInstance{},lvl_71_lefthand_front:class extends self.ISpriteInstance{},lvl_71_righthand_front:class extends self.ISpriteInstance{},lvl_72_basket_back:class extends self.ISpriteInstance{},lvl_72_donkey:class extends self.ISpriteInstance{},lvl_72_donkey_eyes:class extends self.ISpriteInstance{},lvl_72_donkeymouth_back:class extends self.ISpriteInstance{},lvl_72_donkeymouth_front:class extends self.ISpriteInstance{},lvl_73_hammer:class extends self.ISpriteInstance{},lvl_74_net_back:class extends self.ISpriteInstance{},lvl_74_netbig:class extends self.ISpriteInstance{},lvl_75_gramaphone:class extends self.ISpriteInstance{},lvl_75_movementsign1:class extends self.ISpriteInstance{},lvl_75_movementsign2:class extends self.ISpriteInstance{},lvl_75_sidetable:class extends self.ISpriteInstance{},lvl_76_car_green:class extends self.ISpriteInstance{},lvl_76_car_red:class extends self.ISpriteInstance{},lvl_76_ground:class extends self.ISpriteInstance{},lvl_77_tennisball:class extends self.ISpriteInstance{},lvl_78_canopener:class extends self.ISpriteInstance{},lvl_78_full_jar:class extends self.ISpriteInstance{},lvl_78_pickle:class extends self.ISpriteInstance{},lvl_78_picklewater:class extends self.ISpriteInstance{},lvl_79_home_9slice_left:class extends self.ISpriteInstance{},lvl_79_roof:class extends self.ISpriteInstance{},lvl_7_bowl_back:class extends self.ISpriteInstance{},lvl_7_bowl_front:class extends self.ISpriteInstance{},lvl_7_tuna:class extends self.ISpriteInstance{},lvl_80_chair_back:class extends self.ISpriteInstance{},lvl_80_chair_mirrored:class extends self.ISpriteInstance{},lvl_80_chair_side:class extends self.ISpriteInstance{},lvl_80_flash:class extends self.ISpriteInstance{},lvl_81_cliff:class extends self.ISpriteInstance{},lvl_81_grass:class extends self.ISpriteInstance{},lvl_82_clock_bg:class extends self.ISpriteInstance{},lvl_82_coffee:class extends self.ISpriteInstance{},lvl_82_coffee_cup:class extends self.ISpriteInstance{},lvl_82_coffee_hand:class extends self.ISpriteInstance{},lvl_82_coffee_machine:class extends self.ISpriteInstance{},lvl_82_coffee_pot:class extends self.ISpriteInstance{},lvl_82_dots:class extends self.ISpriteInstance{},lvl_82_number_0:class extends self.ISpriteInstance{},lvl_82_number_2:class extends self.ISpriteInstance{},lvl_82_number_8:class extends self.ISpriteInstance{},lvl_82_water:class extends self.ISpriteInstance{},lvl_83_bulb:class extends self.ISpriteInstance{},lvl_83_button:class extends self.ISpriteInstance{},lvl_83_cables_left:class extends self.ISpriteInstance{},lvl_83_cables_rigth:class extends self.ISpriteInstance{},lvl_83_connection:class extends self.ISpriteInstance{},lvl_83_shine:class extends self.ISpriteInstance{},lvl_83_Text:class extends self.ITextInstance{},lvl_85_battery:class extends self.ISpriteInstance{},lvl_85_car:class extends self.ISpriteInstance{},lvl_85_exhaust:class extends self.ISpriteInstance{},lvl_85_fuel_splash:class extends self.ISpriteInstance{},lvl_85_fuelbottle:class extends self.ISpriteInstance{},lvl_85_lid:class extends self.ISpriteInstance{},lvl_85_lidopen:class extends self.ISpriteInstance{},lvl_85_tool:class extends self.ISpriteInstance{},lvl_85_tool2:class extends self.ISpriteInstance{},lvl_86_ball:class extends self.ISpriteInstance{},lvl_86_tenpin:class extends self.ISpriteInstance{},lvl_88_button:class extends self.ISpriteInstance{},lvl_88_game_explode:class extends self.ISpriteInstance{},lvl_88_treadmill:class extends self.ISpriteInstance{},lvl_88_treadmill_movement:class extends self.ISpriteInstance{},lvl_88_treadmill_movement_mask:class extends self.ISpriteInstance{},lvl_89_Letter:class extends self.ITextInstance{},lvl_89_submitarea_text:class extends self.ITextInstance{},lvl_8_cloud:class extends self.ISpriteInstance{},lvl_8_cloud1:class extends self.ISpriteInstance{},lvl_8_cloud2:class extends self.ISpriteInstance{},lvl_8_cloud3:class extends self.ISpriteInstance{},lvl_8_moon:class extends self.ISpriteInstance{},lvl_90_9patch5:class extends self.IWorldInstance{},lvl_90_ball:class extends self.ISpriteInstance{},lvl_90_goalkeeper:class extends self.ISpriteInstance{},lvl_90_goalkeeper_arm_left:class extends self.ISpriteInstance{},lvl_90_goalkeeper_arm_right:class extends self.ISpriteInstance{},lvl_90_goalkeeper_belly:class extends self.ISpriteInstance{},lvl_90_ground:class extends self.ISpriteInstance{},lvl_90_kale:class extends self.ISpriteInstance{},lvl_90_keeper_face:class extends self.ISpriteInstance{},lvl_91_Cracker:class extends self.ISpriteInstance{},lvl_91_wallnut:class extends self.ISpriteInstance{},lvl_91_wallnut_not_dragable:class extends self.ISpriteInstance{},lvl_92_blue:class extends self.ISpriteInstance{},lvl_92_green:class extends self.ISpriteInstance{},lvl_92_green2:class extends self.ISpriteInstance{},lvl_92_needle_bottom:class extends self.ISpriteInstance{},lvl_92_orange:class extends self.ISpriteInstance{},lvl_92_pink:class extends self.ISpriteInstance{},lvl_92_purple:class extends self.ISpriteInstance{},lvl_92_purple1:class extends self.ISpriteInstance{},lvl_92_red:class extends self.ISpriteInstance{},lvl_92_yellow:class extends self.ISpriteInstance{},lvl_93_location:class extends self.ISpriteInstance{},lvl_93_sky:class extends self.ISpriteInstance{},lvl_93_speedline_:class extends self.ISpriteInstance{},lvl_93_speedline_2:class extends self.ISpriteInstance{},lvl_95_catear:class extends self.ISpriteInstance{},lvl_95_mic:class extends self.ISpriteInstance{},lvl_95_number_bg:class extends self.ISpriteInstance{},lvl_95_NumberTxt:class extends self.ITextInstance{},lvl_95_screen_big:class extends self.ISpriteInstance{},lvl_96_cableplugged:class extends self.ISpriteInstance{},lvl_97_banana_peal:class extends self.ISpriteInstance{},lvl_97_face:class extends self.ISpriteInstance{},lvl_97_gunfire:class extends self.ISpriteInstance{},lvl_97_headphones:class extends self.ISpriteInstance{},lvl_97_man_body:class extends self.ISpriteInstance{},lvl_98_speedlines:class extends self.ISpriteInstance{},lvl_99_fingers:class extends self.ISpriteInstance{},lvl_99_ketchupp:class extends self.ISpriteInstance{},lvl_99_ketchupp_pour:class extends self.ISpriteInstance{},lvl_99_ketchupp_splash:class extends self.ISpriteInstance{},lvl_99_mouse:class extends self.ISpriteInstance{},lvl_99_robot_Arm2:class extends self.ISpriteInstance{},m_105_astreoid:class extends self.ISpriteInstance{},m_105_astreoid_flame:class extends self.ISpriteInstance{},m_105_astreoid_flamepiece:class extends self.ISpriteInstance{},m_105_astreoid_flamepiece1:class extends self.ISpriteInstance{},m_105_astreoid_flamepiece3:class extends self.ISpriteInstance{},m_105_background:class extends self.ISpriteInstance{},m_105_planet:class extends self.ISpriteInstance{},m_105_planet1:class extends self.ISpriteInstance{},m_105_stars:class extends self.IWorldInstance{},m_105_world_whole:class extends self.ISpriteInstance{},m_106_chicken:class extends self.ISpriteInstance{},m_106_chicken1:class extends self.ISpriteInstance{},m_106_chicken2:class extends self.ISpriteInstance{},m_106_mushroomm:class extends self.ISpriteInstance{},m_106_weighText:class extends self.ITextInstance{},m_107_bridge:class extends self.ISpriteInstance{},m_107_jump:class extends self.IWorldInstance{},m_9patch:class extends self.IWorldInstance{},m_9patch2:class extends self.IWorldInstance{},m_9patch3:class extends self.IWorldInstance{},m_9patch4:class extends self.IWorldInstance{},m_bag:class extends self.ISpriteInstance{},m_battery:class extends self.IWorldInstance{},m_bigbutton:class extends self.ISpriteInstance{},m_bird_west:class extends self.ISpriteInstance{},m_black:class extends self.ISpriteInstance{},m_blueweight:class extends self.ISpriteInstance{},m_boat:class extends self.ISpriteInstance{},m_Bobba_Body_Fat_Left:class extends self.ISpriteInstance{},m_Bobba_Body_Fat_Right:class extends self.ISpriteInstance{},m_Bobba_Eating_Mouth_Mirror:class extends self.ISpriteInstance{},m_Bobba_EatingBrows_Mirror:class extends self.ISpriteInstance{},m_Bobba_Eyes_Small_Mirror:class extends self.ISpriteInstance{},m_Bobba_sleep_mouth:class extends self.ISpriteInstance{},m_bush3:class extends self.ISpriteInstance{},m_Butterfly_body:class extends self.ISpriteInstance{},m_Butterfly_left_wing:class extends self.ISpriteInstance{},m_Butterfly_right_wing:class extends self.ISpriteInstance{},m_ButtonText:class extends self.ITextInstance{},m_cips:class extends self.ISpriteInstance{},m_cipspack:class extends self.ISpriteInstance{},m_coffe_Steam:class extends self.ISpriteInstance{},m_computer_cable:class extends self.ISpriteInstance{},m_computer_kasa:class extends self.ISpriteInstance{},m_coverSprite:class extends self.ISpriteInstance{},m_DrWorry_Arm_Back_:class extends self.ISpriteInstance{},m_DrWorry_Arm_Back_2:class extends self.ISpriteInstance{},m_DrWorry_Arm_Back_3:class extends self.ISpriteInstance{},m_DrWorry_Arm_Front_:class extends self.ISpriteInstance{},m_DrWorry_Arm_Front_2:class extends self.ISpriteInstance{},m_DrWorry_Back_Leg:class extends self.ISpriteInstance{},m_DrWorry_Body:class extends self.ISpriteInstance{},m_DrWorry_Brows_Angry:class extends self.ISpriteInstance{},m_DrWorry_Eyes_Inside_Normal:class extends self.ISpriteInstance{},m_DrWorry_Front_Leg:class extends self.ISpriteInstance{},m_DrWorry_Glasses:class extends self.ISpriteInstance{},m_DrWorry_Head2:class extends self.ISpriteInstance{},m_fakeCol:class extends self.ISpriteInstance{},m_fakeCol2:class extends self.ISpriteInstance{},m_fakeCol3:class extends self.ISpriteInstance{},m_fakeDragable:class extends self.ISpriteInstance{},m_ground:class extends self.ISpriteInstance{},m_LazyLarry_head:class extends self.ISpriteInstance{},m_LazyLarry_mouth_normal:class extends self.ISpriteInstance{},m_LazyLarry_smart_object_left:class extends self.ISpriteInstance{},m_LazyLarry_smart_object_right:class extends self.ISpriteInstance{},m_Lily_Front_Arm10:class extends self.ISpriteInstance{},m_Lily_Front_Arm11:class extends self.ISpriteInstance{},m_LittleTiki_body:class extends self.ISpriteInstance{},m_LittleTiki_eyes:class extends self.ISpriteInstance{},m_LittleTiki_eyes_inside:class extends self.ISpriteInstance{},m_LittleTiki_mouth_tricky:class extends self.ISpriteInstance{},m_movement_Sprite:class extends self.ISpriteInstance{},m_skate:class extends self.ISpriteInstance{},m_tennis_ground:class extends self.ISpriteInstance{},m_wall:class extends self.ISpriteInstance{},m_wallpatternHD:class extends self.ISpriteInstance{},m_weigher:class extends self.ISpriteInstance{},m_white:class extends self.ISpriteInstance{},m_window:class extends self.ISpriteInstance{},m_window_shine:class extends self.ISpriteInstance{},m_x:class extends self.ISpriteInstance{},m_y:class extends self.ISpriteInstance{},mat_backarm2:class extends self.ISpriteInstance{},mat_backarm2_white:class extends self.ISpriteInstance{},mat_backfoot:class extends self.ISpriteInstance{},mat_backleg:class extends self.ISpriteInstance{},mat_body:class extends self.ISpriteInstance{},mat_brows_eaing:class extends self.ISpriteInstance{},mat_drops:class extends self.ISpriteInstance{},mat_eyes:class extends self.ISpriteInstance{},mat_front_foot:class extends self.ISpriteInstance{},mat_frontarm:class extends self.ISpriteInstance{},mat_frontarm2_white:class extends self.ISpriteInstance{},mat_frontleg:class extends self.ISpriteInstance{},mat_head:class extends self.ISpriteInstance{},mat_hip:class extends self.ISpriteInstance{},mat_mouth:class extends self.ISpriteInstance{},mat_pocket:class extends self.ISpriteInstance{},motor:class extends self.ISpriteInstance{},motor2:class extends self.ISpriteInstance{},motor_maskHD:class extends self.ISpriteInstance{},motor_maskHD2:class extends self.ISpriteInstance{},mouse:class extends self.ISpriteInstance{},multply:class extends self.ISpriteInstance{},musicIcon:class extends self.ISpriteInstance{},nb_apple:class extends self.ISpriteInstance{},nb_ball2:class extends self.ISpriteInstance{},nb_barrel:class extends self.ISpriteInstance{},nb_basementwall:class extends self.ISpriteInstance{},nb_batter_dirth:class extends self.ISpriteInstance{},nb_battery:class extends self.ISpriteInstance{},nb_beans:class extends self.ISpriteInstance{},nb_beans_:class extends self.ISpriteInstance{},nb_bear_angry:class extends self.ISpriteInstance{},nb_bear_angryeyes:class extends self.ISpriteInstance{},nb_bear_angrymouth:class extends self.ISpriteInstance{},nb_bearangry_armback:class extends self.ISpriteInstance{},nb_bearangry_armfront:class extends self.ISpriteInstance{},nb_bearangry_backleg:class extends self.ISpriteInstance{},nb_bearangry_frontleg:class extends self.ISpriteInstance{},nb_big_rock:class extends self.ISpriteInstance{},nb_BigBag:class extends self.ISpriteInstance{},nb_BigBag_Openpiece:class extends self.ISpriteInstance{},nb_bignote:class extends self.ISpriteInstance{},nb_bignote2:class extends self.ISpriteInstance{},nb_bignote3:class extends self.ISpriteInstance{},nb_bigphone:class extends self.ISpriteInstance{},nb_blackboard:class extends self.ISpriteInstance{},nb_Bobba_Arm_Back:class extends self.ISpriteInstance{},nb_Bobba_Arm_Back4:class extends self.ISpriteInstance{},nb_Bobba_Arm_Front:class extends self.ISpriteInstance{},nb_Bobba_Arm_Front5:class extends self.ISpriteInstance{},nb_Bobba_Body_Fat_Left:class extends self.ISpriteInstance{},nb_Bobba_Body_Fat_Right:class extends self.ISpriteInstance{},nb_Bobba_Brows_Angry:class extends self.ISpriteInstance{},nb_Bobba_Eating_Head:class extends self.ISpriteInstance{},nb_Bobba_Eating_Head2:class extends self.ISpriteInstance{},nb_Bobba_Eating_Mouth:class extends self.ISpriteInstance{},nb_Bobba_Eating_Mouth_Mirror:class extends self.ISpriteInstance{},nb_Bobba_EatingBrows:class extends self.ISpriteInstance{},nb_Bobba_EatingBrows3:class extends self.ISpriteInstance{},nb_Bobba_EatingBrows_Mirror:class extends self.ISpriteInstance{},nb_Bobba_Eyelids:class extends self.ISpriteInstance{},nb_Bobba_Eyes_Normal:class extends self.ISpriteInstance{},nb_Bobba_Eyes_Normal3:class extends self.ISpriteInstance{},nb_Bobba_Eyes_Small:class extends self.ISpriteInstance{},nb_Bobba_Eyes_Small2a:class extends self.ISpriteInstance{},nb_Bobba_Eyes_Small_Mirror:class extends self.ISpriteInstance{},nb_Bobba_Hip:class extends self.ISpriteInstance{},nb_Bobba_Leg_Back:class extends self.ISpriteInstance{},nb_Bobba_Leg_Front:class extends self.ISpriteInstance{},nb_Bobba_Mouth_:class extends self.ISpriteInstance{},nb_Bobba_Mouth_Angry:class extends self.ISpriteInstance{},nb_Bobba_Mouth_Normal_Happy:class extends self.ISpriteInstance{},nb_bones:class extends self.ISpriteInstance{},nb_book:class extends self.ISpriteInstance{},nb_book_:class extends self.ISpriteInstance{},nb_book_2:class extends self.ISpriteInstance{},nb_books:class extends self.ISpriteInstance{},nb_books2:class extends self.ISpriteInstance{},nb_bottle:class extends self.ISpriteInstance{},nb_bottle2:class extends self.ISpriteInstance{},nb_bottles_:class extends self.ISpriteInstance{},nb_bottles_2:class extends self.ISpriteInstance{},nb_bottles_3:class extends self.ISpriteInstance{},nb_bottles_4:class extends self.ISpriteInstance{},nb_bottles_5:class extends self.ISpriteInstance{},nb_bowl_front:class extends self.ISpriteInstance{},nb_box:class extends self.ISpriteInstance{},nb_box_back:class extends self.ISpriteInstance{},nb_box_front:class extends self.ISpriteInstance{},nb_box_lid:class extends self.ISpriteInstance{},nb_boxbroken_lid:class extends self.ISpriteInstance{},nb_boxbroken_piece:class extends self.ISpriteInstance{},nb_boxbroken_piece2:class extends self.ISpriteInstance{},nb_brush:class extends self.ISpriteInstance{},nb_Bubba_Shower_Left_Arm:class extends self.ISpriteInstance{},nb_Bubba_Shower_Right_Arm:class extends self.ISpriteInstance{},nb_Bubba_Shower_Soap:class extends self.ISpriteInstance{},nb_BubbaFootball_Arm_Back:class extends self.ISpriteInstance{},nb_BubbaFootball_Arm_Front:class extends self.ISpriteInstance{},nb_BubbaFootball_Big_Mouth:class extends self.ISpriteInstance{},nb_BubbaFootball_Body_Head:class extends self.ISpriteInstance{},nb_BubbaFootball_Cry_Drops:class extends self.ISpriteInstance{},nb_BubbaFootball_Crying_Eyes:class extends self.ISpriteInstance{},nb_BubbaFootball_Crying_Loud:class extends self.ISpriteInstance{},nb_BubbaFootball_Leg_Back:class extends self.ISpriteInstance{},nb_BubbaFootball_Leg_Front:class extends self.ISpriteInstance{},nb_BubbaShower_Armless:class extends self.ISpriteInstance{},nb_bucket:class extends self.ISpriteInstance{},nb_bump_big:class extends self.ISpriteInstance{},nb_bump_small:class extends self.ISpriteInstance{},nb_bus:class extends self.ISpriteInstance{},nb_cake:class extends self.ISpriteInstance{},nb_candles:class extends self.ISpriteInstance{},nb_candles2:class extends self.ISpriteInstance{},nb_candles3:class extends self.ISpriteInstance{},nb_candles4:class extends self.ISpriteInstance{},nb_candy:class extends self.ISpriteInstance{},nb_candy1_package:class extends self.ISpriteInstance{},nb_candy2:class extends self.ISpriteInstance{},nb_candy2_package:class extends self.ISpriteInstance{},nb_candy3:class extends self.ISpriteInstance{},nb_candy4:class extends self.ISpriteInstance{},nb_carpet2:class extends self.ISpriteInstance{},nb_cartoon_arm:class extends self.ISpriteInstance{},nb_cartoon_boy:class extends self.ISpriteInstance{},nb_cartoon_channel:class extends self.ISpriteInstance{},nb_cat_arms:class extends self.ISpriteInstance{},nb_cat_flame:class extends self.ISpriteInstance{},nb_cat_head:class extends self.ISpriteInstance{},nb_cat_sadface:class extends self.ISpriteInstance{},nb_cat_sleeping:class extends self.ISpriteInstance{},nb_cat_tail2:class extends self.ISpriteInstance{},nb_cateyes_scared:class extends self.ISpriteInstance{},nb_cateyes_sleeping:class extends self.ISpriteInstance{},nb_catmouth_normal:class extends self.ISpriteInstance{},nb_catmouth_scared:class extends self.ISpriteInstance{},nb_catsleeping:class extends self.ISpriteInstance{},nb_chalk:class extends self.ISpriteInstance{},nb_chalk2:class extends self.ISpriteInstance{},nb_cheese:class extends self.ISpriteInstance{},nb_chicken:class extends self.ISpriteInstance{},nb_chicken2:class extends self.ISpriteInstance{},nb_chickenbox_closed:class extends self.ISpriteInstance{},nb_chickenbox_openpiece:class extends self.ISpriteInstance{},nb_chocolate:class extends self.ISpriteInstance{},nb_chocolate_marks:class extends self.ISpriteInstance{},nb_Cips:class extends self.ISpriteInstance{},nb_cleanerspray:class extends self.ISpriteInstance{},nb_climateremote:class extends self.ISpriteInstance{},nb_closed:class extends self.IWorldInstance{},nb_closet:class extends self.ISpriteInstance{},nb_closet_open:class extends self.IWorldInstance{},nb_clue:class extends self.ISpriteInstance{},nb_coke:class extends self.ISpriteInstance{},nb_control:class extends self.ISpriteInstance{},nb_control4:class extends self.ISpriteInstance{},nb_cow:class extends self.ISpriteInstance{},nb_crack:class extends self.ISpriteInstance{},nb_cup:class extends self.ISpriteInstance{},nb_curtain:class extends self.ISpriteInstance{},nb_curtain_rope:class extends self.ISpriteInstance{},nb_curtain_top:class extends self.ISpriteInstance{},nb_cushion:class extends self.ISpriteInstance{},nb_delete:class extends self.ISpriteInstance{},nb_drawer:class extends self.ISpriteInstance{},nb_drawer_open:class extends self.ISpriteInstance{},nb_drawer_open2:class extends self.ISpriteInstance{},nb_drums:class extends self.ISpriteInstance{},nb_drums_baget:class extends self.ISpriteInstance{},nb_DrWorry_Arm_Back_:class extends self.ISpriteInstance{},nb_DrWorry_Arm_Back_2:class extends self.ISpriteInstance{},nb_DrWorry_Arm_Front_:class extends self.ISpriteInstance{},nb_DrWorry_Arm_Front_2:class extends self.ISpriteInstance{},nb_DrWorry_Back_Leg:class extends self.ISpriteInstance{},nb_DrWorry_Body:class extends self.ISpriteInstance{},nb_DrWorry_Brows_Angry:class extends self.ISpriteInstance{},nb_DrWorry_Eyes_Inside_Big:class extends self.ISpriteInstance{},nb_DrWorry_Eyes_Inside_Normal:class extends self.ISpriteInstance{},nb_DrWorry_Front_Leg:class extends self.ISpriteInstance{},nb_DrWorry_Glasses:class extends self.ISpriteInstance{},nb_DrWorry_Head2:class extends self.ISpriteInstance{},nb_DrWorry_Mouth_Sad_:class extends self.ISpriteInstance{},nb_eggplant:class extends self.ISpriteInstance{},nb_electricHD:class extends self.ISpriteInstance{},nb_empty_bottle:class extends self.ISpriteInstance{},nb_eraser:class extends self.ISpriteInstance{},nb_fancyplate_big:class extends self.ISpriteInstance{},nb_fancyplate_big2:class extends self.ISpriteInstance{},nb_fancyplate_small:class extends self.ISpriteInstance{},nb_fancyplate_small2:class extends self.ISpriteInstance{},nb_fancyplate_small3:class extends self.ISpriteInstance{},nb_Fatrhino_backlegs:class extends self.ISpriteInstance{},nb_Fatrhino_body:class extends self.ISpriteInstance{},nb_Fatrhino_fronlegs:class extends self.ISpriteInstance{},nb_Fatrhino_head:class extends self.ISpriteInstance{},nb_fence:class extends self.ISpriteInstance{},nb_fish_red:class extends self.ISpriteInstance{},nb_five:class extends self.ISpriteInstance{},nb_flame:class extends self.ISpriteInstance{},nb_flashlight:class extends self.ISpriteInstance{},nb_floor_right:class extends self.ISpriteInstance{},nb_floorline2:class extends self.ISpriteInstance{},nb_flower:class extends self.ISpriteInstance{},nb_fly:class extends self.ISpriteInstance{},nb_fly_normal:class extends self.ISpriteInstance{},nb_flyswatter:class extends self.ISpriteInstance{},nb_frozen:class extends self.ISpriteInstance{},nb_frozen2:class extends self.ISpriteInstance{},nb_frozen3:class extends self.ISpriteInstance{},nb_frozen4:class extends self.ISpriteInstance{},nb_frozenlily:class extends self.ISpriteInstance{},nb_gas_cloud:class extends self.ISpriteInstance{},nb_gas_green:class extends self.ISpriteInstance{},nb_gasmask:class extends self.ISpriteInstance{},nb_gastube:class extends self.ISpriteInstance{},nb_gem:class extends self.ISpriteInstance{},nb_glasses:class extends self.ISpriteInstance{},nb_glasses_empty:class extends self.ISpriteInstance{},nb_glasses_tattoo:class extends self.ISpriteInstance{},nb_glassofwater2:class extends self.ISpriteInstance{},nb_GrannyAmy_Back_Arm:class extends self.ISpriteInstance{},nb_GrannyAmy_Back_Arm2:class extends self.ISpriteInstance{},nb_GrannyAmy_Back_Leg:class extends self.ISpriteInstance{},nb_GrannyAmy_Body:class extends self.ISpriteInstance{},nb_GrannyAmy_Body2:class extends self.ISpriteInstance{},nb_GrannyAmy_Eyes:class extends self.ISpriteInstance{},nb_GrannyAmy_Eyes_Inside2:class extends self.ISpriteInstance{},nb_GrannyAmy_Front_Arm:class extends self.ISpriteInstance{},nb_GrannyAmy_Front_Arm2:class extends self.ISpriteInstance{},nb_GrannyAmy_Front_Leg:class extends self.ISpriteInstance{},nb_GrannyAmy_head:class extends self.ISpriteInstance{},nb_GrannyAmy_Mouth:class extends self.ISpriteInstance{},nb_GrannyAmy_Sleeping_Body:class extends self.ISpriteInstance{},nb_GrannyAmy_Sleeping_Legs:class extends self.ISpriteInstance{},nb_grapes:class extends self.ISpriteInstance{},nb_greenbottle:class extends self.ISpriteInstance{},nb_hair:class extends self.ISpriteInstance{},nb_halfcake:class extends self.ISpriteInstance{},nb_hammer:class extends self.ISpriteInstance{},nb_hand:class extends self.ISpriteInstance{},nb_hand_back:class extends self.ISpriteInstance{},nb_hand_front:class extends self.ISpriteInstance{},nb_happybear:class extends self.ISpriteInstance{},nb_headphone_half:class extends self.ISpriteInstance{},nb_headphone_whole:class extends self.ISpriteInstance{},nb_horn:class extends self.ISpriteInstance{},nb_hotsouce:class extends self.ISpriteInstance{},nb_icecream:class extends self.ISpriteInstance{},nb_icecream2:class extends self.ISpriteInstance{},nb_idcard_big:class extends self.ISpriteInstance{},nb_idcard_small:class extends self.ISpriteInstance{},nb_keyboard_bg:class extends self.ISpriteInstance{},nb_keyboard_bg2:class extends self.ISpriteInstance{},nb_keyboard_close:class extends self.ISpriteInstance{},nb_KeyboardText:class extends self.ITextInstance{},nb_kitchencounter:class extends self.ISpriteInstance{},nb_knife:class extends self.ISpriteInstance{},nb_knight_body:class extends self.ISpriteInstance{},nb_knight_head:class extends self.ISpriteInstance{},nb_knight_shield:class extends self.ISpriteInstance{},nb_Laptop:class extends self.ISpriteInstance{},nb_lava:class extends self.ISpriteInstance{},nb_LazyLarry_Back_Arm_2:class extends self.ISpriteInstance{},nb_LazyLarry_Back_Arm_Comb:class extends self.ISpriteInstance{},nb_LazyLarry_Back_Arm_Comb2:class extends self.ISpriteInstance{},nb_LazyLarry_Back_Foot:class extends self.ISpriteInstance{},nb_LazyLarry_Back_Leg:class extends self.ISpriteInstance{},nb_LazyLarry_Body:class extends self.ISpriteInstance{},nb_LazyLarry_Brows_Normal:class extends self.ISpriteInstance{},nb_LazyLarry_Eyelids:class extends self.ISpriteInstance{},nb_LazyLarry_Eyes:class extends self.ISpriteInstance{},nb_LazyLarry_Eyes_Inside:class extends self.ISpriteInstance{},nb_LazyLarry_Front_Arm_:class extends self.ISpriteInstance{},nb_LazyLarry_Front_Arm_2:class extends self.ISpriteInstance{},nb_LazyLarry_Front_Foot:class extends self.ISpriteInstance{},nb_LazyLarry_Front_Leg:class extends self.ISpriteInstance{},nb_LazyLarry_Head_Bold:class extends self.ISpriteInstance{},nb_LazyLarry_Head_Bold_Mirrored:class extends self.ISpriteInstance{},nb_LazyLarry_Head_Hairy:class extends self.ISpriteInstance{},nb_LazyLarry_Head_Hairy_Mirrored:class extends self.ISpriteInstance{},nb_LazyLarry_Hip:class extends self.ISpriteInstance{},nb_LazyLarry_Mouth_Normal:class extends self.ISpriteInstance{},nb_LazyLarry_Pocket:class extends self.ISpriteInstance{},nb_letterx:class extends self.ISpriteInstance{},nb_lettery:class extends self.ISpriteInstance{},nb_letterz:class extends self.ISpriteInstance{},nb_light:class extends self.ISpriteInstance{},nb_Lily_Angry:class extends self.ISpriteInstance{},nb_Lily_Back_Arm_:class extends self.ISpriteInstance{},nb_Lily_Back_Arm_3:class extends self.ISpriteInstance{},nb_Lily_Back_Arm_5:class extends self.ISpriteInstance{},nb_Lily_Back_Arm_Bottom:class extends self.ISpriteInstance{},nb_Lily_Back_Leg_:class extends self.ISpriteInstance{},nb_Lily_Back_Leg_2:class extends self.ISpriteInstance{},nb_Lily_Back_Leg_3:class extends self.ISpriteInstance{},nb_Lily_Back_Leg_4:class extends self.ISpriteInstance{},nb_Lily_Back_Leg_5:class extends self.ISpriteInstance{},nb_Lily_Back_Leg_6:class extends self.ISpriteInstance{},nb_Lily_Back_Leg_7:class extends self.ISpriteInstance{},nb_Lily_bare_foot:class extends self.ISpriteInstance{},nb_Lily_Body2:class extends self.ISpriteInstance{},nb_Lily_Body4:class extends self.ISpriteInstance{},nb_Lily_Body5:class extends self.ISpriteInstance{},nb_Lily_Body6:class extends self.ISpriteInstance{},nb_Lily_Brows:class extends self.ISpriteInstance{},nb_Lily_Crying:class extends self.ISpriteInstance{},nb_Lily_Curious:class extends self.ISpriteInstance{},nb_Lily_Eyes:class extends self.ISpriteInstance{},nb_Lily_Eyes_Inside:class extends self.ISpriteInstance{},nb_Lily_finger_point2:class extends self.ISpriteInstance{},nb_Lily_Front_Arm:class extends self.ISpriteInstance{},nb_Lily_Front_Arm10:class extends self.ISpriteInstance{},nb_Lily_Front_Arm2:class extends self.ISpriteInstance{},nb_Lily_Front_Arm3:class extends self.ISpriteInstance{},nb_Lily_Front_Arm4:class extends self.ISpriteInstance{},nb_Lily_Front_Arm5:class extends self.ISpriteInstance{},nb_Lily_Front_Arm6:class extends self.ISpriteInstance{},nb_Lily_Front_Arm7:class extends self.ISpriteInstance{},nb_Lily_Front_Arm8:class extends self.ISpriteInstance{},nb_Lily_Front_Arm9:class extends self.ISpriteInstance{},nb_Lily_Front_Leg_:class extends self.ISpriteInstance{},nb_Lily_Front_Leg_2:class extends self.ISpriteInstance{},nb_Lily_Front_Leg_3:class extends self.ISpriteInstance{},nb_Lily_Front_Leg_4:class extends self.ISpriteInstance{},nb_Lily_Front_Leg_5:class extends self.ISpriteInstance{},nb_Lily_hair_electric:class extends self.ISpriteInstance{},nb_Lily_Hair_Piece_:class extends self.ISpriteInstance{},nb_Lily_Hair_Piece_2:class extends self.ISpriteInstance{},nb_Lily_Hair_Piece_3:class extends self.ISpriteInstance{},nb_Lily_Hair_Piece_4:class extends self.ISpriteInstance{},nb_Lily_Hair_Piece_5:class extends self.ISpriteInstance{},nb_Lily_Hair_Piece_6:class extends self.ISpriteInstance{},nb_Lily_Hair_Piece_7:class extends self.ISpriteInstance{},nb_Lily_Hair_Piece_8:class extends self.ISpriteInstance{},nb_Lily_Happy2:class extends self.ISpriteInstance{},nb_Lily_Head2:class extends self.ISpriteInstance{},nb_Lily_Head3:class extends self.ISpriteInstance{},nb_Lily_Head4:class extends self.ISpriteInstance{},nb_Lily_Lids:class extends self.ISpriteInstance{},nb_Lily_mouth_scared:class extends self.ISpriteInstance{},nb_Lily_Normal:class extends self.ISpriteInstance{},nb_Lily_Normal2:class extends self.ISpriteInstance{},nb_Lily_Skirt:class extends self.ISpriteInstance{},nb_Lily_Skirt2:class extends self.ISpriteInstance{},nb_Lily_Skirt3:class extends self.ISpriteInstance{},nb_Lily_Smile:class extends self.ISpriteInstance{},nb_Lily_straight_hair:class extends self.ISpriteInstance{},nb_line2:class extends self.ISpriteInstance{},nb_lines:class extends self.ISpriteInstance{},nb_lines2:class extends self.ISpriteInstance{},nb_lines3:class extends self.ISpriteInstance{},nb_LittleTiki_back_arm:class extends self.ISpriteInstance{},nb_LittleTiki_back_arm2:class extends self.ISpriteInstance{},nb_LittleTiki_back_arm3:class extends self.ISpriteInstance{},nb_LittleTiki_backleg:class extends self.ISpriteInstance{},nb_LittleTiki_body:class extends self.ISpriteInstance{},nb_LittleTiki_brows_tricky:class extends self.ISpriteInstance{},nb_LittleTiki_eyes:class extends self.ISpriteInstance{},nb_LittleTiki_eyes_happy_closed:class extends self.ISpriteInstance{},nb_LittleTiki_eyes_inside:class extends self.ISpriteInstance{},nb_LittleTiki_front_arm:class extends self.ISpriteInstance{},nb_LittleTiki_front_arm2:class extends self.ISpriteInstance{},nb_LittleTiki_front_leg:class extends self.ISpriteInstance{},nb_LittleTiki_head:class extends self.ISpriteInstance{},nb_LittleTiki_head2:class extends self.ISpriteInstance{},nb_LittleTiki_mouth_tricky:class extends self.ISpriteInstance{},nb_LittleTiki_Parcaliai:class extends self.ISpriteInstance{},nb_LittleTiki_pocket:class extends self.ISpriteInstance{},nb_LittleTiki_skirt:class extends self.ISpriteInstance{},nb_lizard:class extends self.ISpriteInstance{},nb_lizard_stand:class extends self.ISpriteInstance{},nb_lizard_tongue2:class extends self.ISpriteInstance{},nb_lock:class extends self.ISpriteInstance{},nb_lonelycat:class extends self.ISpriteInstance{},nb_lowbattery:class extends self.ISpriteInstance{},nb_lvl_102_txt:class extends self.ITextInstance{},nb_lvl_103_screen:class extends self.ISpriteInstance{},nb_lvl_11_keyboard_text:class extends self.ITextInstance{},nb_lvl_11_password_single_1:class extends self.ISpriteInstance{},nb_lvl_11_password_single_2:class extends self.ISpriteInstance{},nb_lvl_11_password_single_3:class extends self.ISpriteInstance{},nb_lvl_11_password_single_4:class extends self.ISpriteInstance{},nb_lvl_11_password_single_5:class extends self.ISpriteInstance{},nb_lvl_11_password_single_6:class extends self.ISpriteInstance{},nb_lvl_11_password_text_1:class extends self.ITextInstance{},nb_lvl_11_password_text_2:class extends self.ITextInstance{},nb_lvl_11_password_text_3:class extends self.ITextInstance{},nb_lvl_11_password_text_4:class extends self.ITextInstance{},nb_lvl_11_password_text_5:class extends self.ITextInstance{},nb_lvl_151_carpet:class extends self.ISpriteInstance{},nb_lvl_151_fireplace:class extends self.ISpriteInstance{},nb_lvl_151_sofa:class extends self.ISpriteInstance{},nb_lvl_152_smalltable:class extends self.ISpriteInstance{},nb_lvl_157_chicken:class extends self.ISpriteInstance{},nb_lvl_19_catfood:class extends self.ISpriteInstance{},nb_lvl_19_trumphet:class extends self.ISpriteInstance{},nb_lvl_1_sun:class extends self.ISpriteInstance{},nb_lvl_20_dragabble_text:class extends self.ITextInstance{},nb_lvl_20_pay_text:class extends self.ITextInstance{},nb_lvl_21_name_text:class extends self.ITextInstance{},nb_lvl_22_answer_text:class extends self.ITextInstance{},nb_lvl_22_new_char_text:class extends self.ITextInstance{},nb_lvl_27_fake_gold:class extends self.ISpriteInstance{},nb_lvl_27_gold:class extends self.ISpriteInstance{},nb_lvl_27_package:class extends self.ISpriteInstance{},nb_lvl_29_fake_col:class extends self.ISpriteInstance{},nb_lvl_30_bucket2:class extends self.ISpriteInstance{},nb_lvl_30_curtain_closed:class extends self.ISpriteInstance{},nb_lvl_30_curtain_open:class extends self.ISpriteInstance{},nb_lvl_30_sink2:class extends self.ISpriteInstance{},nb_lvl_31_floor_main:class extends self.ISpriteInstance{},nb_lvl_31_floor_part:class extends self.ISpriteInstance{},nb_lvl_31_floor_part2:class extends self.ISpriteInstance{},nb_lvl_33_sofa_9patch:class extends self.IWorldInstance{},nb_lvl_36_candy_inside_1:class extends self.ISpriteInstance{},nb_lvl_36_candy_inside_2:class extends self.ISpriteInstance{},nb_lvl_36_candy_inside_3:class extends self.ISpriteInstance{},nb_lvl_3_cat3:class extends self.ISpriteInstance{},nb_lvl_3_cat7:class extends self.ISpriteInstance{},nb_lvl_3_fish:class extends self.ISpriteInstance{},nb_lvl_3_welcome_text:class extends self.ITextInstance{},nb_lvl_44_coil:class extends self.ISpriteInstance{},nb_lvl_44_connection_:class extends self.ISpriteInstance{},nb_lvl_44_connection_2:class extends self.ISpriteInstance{},nb_lvl_44_connection_3:class extends self.ISpriteInstance{},nb_lvl_44_connection_4:class extends self.ISpriteInstance{},nb_lvl_44_powerball:class extends self.ISpriteInstance{},nb_lvl_44_powerlines_:class extends self.ISpriteInstance{},nb_lvl_44_powerlines_2:class extends self.ISpriteInstance{},nb_lvl_44_powerlines_3:class extends self.ISpriteInstance{},nb_lvl_44_powerlines_4:class extends self.ISpriteInstance{},nb_lvl_44_shape_:class extends self.ISpriteInstance{},nb_lvl_44_shape_2:class extends self.ISpriteInstance{},nb_lvl_44_shape_3:class extends self.ISpriteInstance{},nb_lvl_44_switch:class extends self.ISpriteInstance{},nb_lvl_45_bar:class extends self.ISpriteInstance{},nb_lvl_45_barpiece_:class extends self.ISpriteInstance{},nb_lvl_45_barpiece_2:class extends self.ISpriteInstance{},nb_lvl_45_barpiece_3:class extends self.ISpriteInstance{},nb_lvl_45_barpiece_4:class extends self.ISpriteInstance{},nb_lvl_45_barpiece_5:class extends self.ISpriteInstance{},nb_lvl_45_cat_white:class extends self.ISpriteInstance{},nb_lvl_45_cat_yellow:class extends self.ISpriteInstance{},nb_lvl_45_catwalking_white:class extends self.ISpriteInstance{},nb_lvl_45_heart:class extends self.ISpriteInstance{},nb_lvl_45_tail_white:class extends self.ISpriteInstance{},nb_lvl_45_tail_yellow:class extends self.ISpriteInstance{},nb_lvl_47_floorline:class extends self.ISpriteInstance{},nb_lvl_47_floorline1HD:class extends self.ISpriteInstance{},nb_lvl_47_hairpiece:class extends self.ISpriteInstance{},nb_lvl_47_hairpiece2:class extends self.ISpriteInstance{},nb_lvl_47_machine:class extends self.ISpriteInstance{},nb_lvl_47_mirror:class extends self.ISpriteInstance{},nb_lvl_47_mirror_mask:class extends self.ISpriteInstance{},nb_lvl_47_mirror_shine:class extends self.ISpriteInstance{},nb_lvl_47_pipe:class extends self.ISpriteInstance{},nb_lvl_47_sink:class extends self.ISpriteInstance{},nb_lvl_47_sink_bottom:class extends self.ISpriteInstance{},nb_lvl_47_valve:class extends self.ISpriteInstance{},nb_lvl_47_wallline:class extends self.ISpriteInstance{},nb_lvl_48_banana:class extends self.ISpriteInstance{},nb_lvl_48_board:class extends self.IWorldInstance{},nb_lvl_48_box:class extends self.ISpriteInstance{},nb_lvl_48_donut:class extends self.ISpriteInstance{},nb_lvl_48_equal:class extends self.ISpriteInstance{},nb_lvl_48_number5:class extends self.ISpriteInstance{},nb_lvl_48_number_2:class extends self.ISpriteInstance{},nb_lvl_48_number_4:class extends self.ISpriteInstance{},nb_lvl_48_shelf:class extends self.ISpriteInstance{},nb_lvl_49_cat_scared:class extends self.ISpriteInstance{},nb_lvl_49_cat_wake_up:class extends self.ISpriteInstance{},nb_lvl_49_cathead_red:class extends self.ISpriteInstance{},nb_lvl_49_flame:class extends self.ISpriteInstance{},nb_lvl_49_plate:class extends self.ISpriteInstance{},nb_lvl_49_thermo_text:class extends self.ITextInstance{},nb_lvl_49_thermo_text2:class extends self.ITextInstance{},nb_lvl_50_drop:class extends self.ISpriteInstance{},nb_lvl_50_pipethin_:class extends self.ISpriteInstance{},nb_lvl_50_water:class extends self.ISpriteInstance{},nb_lvl_51_bird:class extends self.ISpriteInstance{},nb_lvl_51_formula:class extends self.ISpriteInstance{},nb_lvl_51_nestfull:class extends self.ISpriteInstance{},nb_lvl_51_paper:class extends self.ISpriteInstance{},nb_lvl_51_picture:class extends self.ISpriteInstance{},nb_lvl_51_tabletop:class extends self.ISpriteInstance{},nb_lvl_51_writing:class extends self.ISpriteInstance{},nb_lvl_52_cucumber:class extends self.ISpriteInstance{},nb_lvl_52_olive_1:class extends self.ISpriteInstance{},nb_lvl_52_olive_2:class extends self.ISpriteInstance{},nb_lvl_52_pizza_1:class extends self.ISpriteInstance{},nb_lvl_52_pizza_2:class extends self.ISpriteInstance{},nb_lvl_53_big_greenapple:class extends self.ISpriteInstance{},nb_lvl_53_big_redapple:class extends self.ISpriteInstance{},nb_lvl_54_attention:class extends self.ISpriteInstance{},nb_lvl_54_car:class extends self.ISpriteInstance{},nb_lvl_54_road:class extends self.ISpriteInstance{},nb_lvl_56_dark_background:class extends self.ISpriteInstance{},nb_lvl_56_draggable_text:class extends self.ITextInstance{},nb_lvl_6_smudge:class extends self.ISpriteInstance{},nb_lvl_6_smudge2:class extends self.ISpriteInstance{},nb_lvl_70_flower_big:class extends self.ISpriteInstance{},nb_man_body:class extends self.ISpriteInstance{},nb_man_head:class extends self.ISpriteInstance{},nb_man_sadface:class extends self.ISpriteInstance{},nb_man_wtshirt:class extends self.ISpriteInstance{},nb_massagegun:class extends self.ISpriteInstance{},nb_mat:class extends self.ISpriteInstance{},nb_medicine:class extends self.ISpriteInstance{},nb_milklayer:class extends self.ISpriteInstance{},nb_milksplash:class extends self.ISpriteInstance{},nb_minus:class extends self.ISpriteInstance{},nb_mirror:class extends self.ISpriteInstance{},nb_Monster:class extends self.ISpriteInstance{},nb_Monster_Back_Arm:class extends self.ISpriteInstance{},nb_Monster_Front_Arm:class extends self.ISpriteInstance{},nb_Monster_Live_Face:class extends self.ISpriteInstance{},nb_mop:class extends self.ISpriteInstance{},nb_mouse:class extends self.ISpriteInstance{},nb_mousehole:class extends self.ISpriteInstance{},nb_musiclines_:class extends self.ISpriteInstance{},nb_musiclines_2:class extends self.ISpriteInstance{},nb_musiclines_3:class extends self.ISpriteInstance{},nb_notes:class extends self.ISpriteInstance{},nb_notes2:class extends self.ISpriteInstance{},nb_notes3:class extends self.ISpriteInstance{},nb_notes4:class extends self.ISpriteInstance{},nb_object:class extends self.ISpriteInstance{},nb_object2:class extends self.ISpriteInstance{},nb_object3:class extends self.ISpriteInstance{},nb_offbutton:class extends self.ISpriteInstance{},nb_paper2:class extends self.ISpriteInstance{},nb_pencil:class extends self.ISpriteInstance{},nb_phone:class extends self.ISpriteInstance{},nb_picturefrmae:class extends self.ISpriteInstance{},nb_pipe_piece:class extends self.ISpriteInstance{},nb_pipe_piece2:class extends self.ISpriteInstance{},nb_pipepiece:class extends self.ISpriteInstance{},nb_pipethin_2:class extends self.ISpriteInstance{},nb_plant:class extends self.ISpriteInstance{},nb_plant2:class extends self.ISpriteInstance{},nb_plate2:class extends self.ISpriteInstance{},nb_plate_small:class extends self.ISpriteInstance{},nb_plug:class extends self.ISpriteInstance{},nb_plug_long:class extends self.ISpriteInstance{},nb_plus:class extends self.ISpriteInstance{},nb_pocket:class extends self.ISpriteInstance{},nb_popcorn:class extends self.ISpriteInstance{},nb_power_inside:class extends self.ISpriteInstance{},nb_Princess:class extends self.ISpriteInstance{},nb_Princess_Back_Arm_Bottom:class extends self.ISpriteInstance{},nb_Princess_Back_Arm_Top:class extends self.ISpriteInstance{},nb_Princess_Front_Hand_Hold_Sword:class extends self.ISpriteInstance{},nb_Princess_Front_Hand_Normal:class extends self.ISpriteInstance{},nb_Princess_Front_Hand_Top:class extends self.ISpriteInstance{},nb_question:class extends self.ISpriteInstance{},nb_redbutton:class extends self.ISpriteInstance{},nb_remote:class extends self.ISpriteInstance{},nb_restart:class extends self.ISpriteInstance{},nb_robot:class extends self.ISpriteInstance{},nb_robot_bottom:class extends self.ISpriteInstance{},nb_robot_off:class extends self.ISpriteInstance{},nb_robot_on:class extends self.ISpriteInstance{},nb_robot_plug:class extends self.ISpriteInstance{},nb_roboteyes_closed:class extends self.ISpriteInstance{},nb_roboteyes_open:class extends self.ISpriteInstance{},nb_roll:class extends self.ISpriteInstance{},nb_rope:class extends self.ISpriteInstance{},nb_sarkit:class extends self.ISpriteInstance{},nb_sarkit2:class extends self.ISpriteInstance{},nb_scaredboy:class extends self.ISpriteInstance{},nb_scaredgirl:class extends self.ISpriteInstance{},nb_screen_bg:class extends self.ISpriteInstance{},nb_ScrollLayer:class extends self.ISpriteInstance{},nb_Seeds:class extends self.ISpriteInstance{},nb_shadow:class extends self.ISpriteInstance{},nb_shadow2:class extends self.ISpriteInstance{},nb_shampoo3:class extends self.ISpriteInstance{},nb_shampoo4:class extends self.ISpriteInstance{},nb_shampoo5:class extends self.ISpriteInstance{},nb_shampoo6:class extends self.ISpriteInstance{},nb_shelf:class extends self.ISpriteInstance{},nb_shelf2:class extends self.ISpriteInstance{},nb_shelf3:class extends self.ISpriteInstance{},nb_shelf4:class extends self.ISpriteInstance{},nb_shelf5:class extends self.ISpriteInstance{},nb_shelf6:class extends self.ISpriteInstance{},nb_shelf_long:class extends self.ISpriteInstance{},nb_shower:class extends self.ISpriteInstance{},nb_shower_door:class extends self.ISpriteInstance{},nb_shower_drops:class extends self.ISpriteInstance{},nb_showerflood:class extends self.ISpriteInstance{},nb_showerside_multiple:class extends self.ISpriteInstance{},nb_showerside_single:class extends self.ISpriteInstance{},nb_showerside_single2:class extends self.ISpriteInstance{},nb_sidefloor_line:class extends self.ISpriteInstance{},nb_sink:class extends self.ISpriteInstance{},nb_sink_bottom:class extends self.ISpriteInstance{},nb_SmallBag:class extends self.ISpriteInstance{},nb_smoke:class extends self.ISpriteInstance{},nb_smoke2:class extends self.ISpriteInstance{},nb_smudge5:class extends self.ISpriteInstance{},nb_smudge_:class extends self.ISpriteInstance{},nb_Snake:class extends self.ISpriteInstance{},nb_snake_mouth:class extends self.ISpriteInstance{},nb_snake_tongue:class extends self.ISpriteInstance{},nb_snakebowl_back:class extends self.ISpriteInstance{},nb_snakebowl_front:class extends self.ISpriteInstance{},nb_socks:class extends self.ISpriteInstance{},nb_sofa2:class extends self.ISpriteInstance{},nb_sofa3:class extends self.ISpriteInstance{},nb_sofa4:class extends self.ISpriteInstance{},nb_sofa_layer:class extends self.ISpriteInstance{},nb_sofa_layer2:class extends self.ISpriteInstance{},nb_sofa_layer3:class extends self.ISpriteInstance{},nb_souce:class extends self.ISpriteInstance{},nb_speaker:class extends self.ISpriteInstance{},nb_speaker2:class extends self.ISpriteInstance{},nb_splittedscreen:class extends self.ISpriteInstance{},nb_sportschannel:class extends self.ISpriteInstance{},nb_sportsman_:class extends self.ISpriteInstance{},nb_sportsman_2:class extends self.ISpriteInstance{},nb_sportsman_3:class extends self.ISpriteInstance{},nb_Sprite10:class extends self.ISpriteInstance{},nb_Sprite2:class extends self.ISpriteInstance{},nb_stain:class extends self.ISpriteInstance{},nb_straight_line:class extends self.ISpriteInstance{},nb_straight_line2:class extends self.ISpriteInstance{},nb_submitarea:class extends self.ISpriteInstance{},nb_suce_white:class extends self.ISpriteInstance{},nb_sword:class extends self.ISpriteInstance{},nb_syringe:class extends self.ISpriteInstance{},nb_table3:class extends self.ISpriteInstance{},nb_table4:class extends self.ISpriteInstance{},nb_table5:class extends self.ISpriteInstance{},nb_table6:class extends self.ISpriteInstance{},nb_tablecloth:class extends self.ISpriteInstance{},nb_team_red:class extends self.ISpriteInstance{},nb_team_yellow:class extends self.ISpriteInstance{},nb_thinrhino_body:class extends self.ISpriteInstance{},nb_thinrhino_head:class extends self.ISpriteInstance{},nb_thread:class extends self.ISpriteInstance{},nb_topline:class extends self.ISpriteInstance{},nb_towel:class extends self.ISpriteInstance{},nb_toy:class extends self.ISpriteInstance{},nb_tshirt4:class extends self.ISpriteInstance{},nb_tube_empty:class extends self.ISpriteInstance{},nb_tube_full:class extends self.ISpriteInstance{},nb_tv:class extends self.ISpriteInstance{},nb_venom_bottle:class extends self.ISpriteInstance{},nb_venom_drop:class extends self.ISpriteInstance{},nb_venom_drop2:class extends self.ISpriteInstance{},nb_venom_onfloor:class extends self.ISpriteInstance{},nb_water:class extends self.ISpriteInstance{},nb_waterfloor:class extends self.ISpriteInstance{},nb_wateringcan:class extends self.ISpriteInstance{},nb_waterlayer:class extends self.ISpriteInstance{},nb_waterlines:class extends self.ISpriteInstance{},nb_window:class extends self.ISpriteInstance{},nb_window2:class extends self.ISpriteInstance{},nb_wood:class extends self.ISpriteInstance{},nb_yarn:class extends self.ISpriteInstance{},nb_yellowbottle:class extends self.ISpriteInstance{},nb_zero:class extends self.ISpriteInstance{},newLevelsText:class extends self.ITextInstance{},number:class extends self.ISpriteInstance{},number2:class extends self.ISpriteInstance{},number3:class extends self.ISpriteInstance{},number4:class extends self.ISpriteInstance{},number5:class extends self.ISpriteInstance{},numbereye:class extends self.ISpriteInstance{},lvl114_obj1:class extends self.ISpriteInstance{},OpenedHints:class extends self.IDictionaryInstance{},painlines:class extends self.ISpriteInstance{},photocamera:class extends self.ISpriteInstance{},Pipe_Nine_Patch:class extends self.IWorldInstance{},plus:class extends self.ISpriteInstance{},pota_zemin:class extends self.ISpriteInstance{},questionmark:class extends self.ISpriteInstance{},ReadingGameData:class extends self.IArrayInstance{},ReadingGameData2:class extends self.IArrayInstance{},redBattery:class extends self.IWorldInstance{},redbutton:class extends self.ISpriteInstance{},Rival_back_arm:class extends self.ISpriteInstance{},Rival_back_arm2:class extends self.ISpriteInstance{},Rival_back_leg:class extends self.ISpriteInstance{},Rival_back_leg2:class extends self.ISpriteInstance{},Rival_body:class extends self.ISpriteInstance{},Rival_brows_normal:class extends self.ISpriteInstance{},Rival_earphone:class extends self.ISpriteInstance{},Rival_earphone2:class extends self.ISpriteInstance{},Rival_eyes:class extends self.ISpriteInstance{},Rival_eyes_inside:class extends self.ISpriteInstance{},Rival_eyesLids:class extends self.ISpriteInstance{},Rival_front_arm:class extends self.ISpriteInstance{},Rival_front_arm2:class extends self.ISpriteInstance{},Rival_front_leg:class extends self.ISpriteInstance{},Rival_front_leg2:class extends self.ISpriteInstance{},Rival_hat:class extends self.ISpriteInstance{},Rival_head:class extends self.ISpriteInstance{},Rival_hip:class extends self.ISpriteInstance{},Rival_mouth_normal:class extends self.ISpriteInstance{},robot_plug:class extends self.ISpriteInstance{},robotgloves_front:class extends self.ISpriteInstance{},sausage:class extends self.ISpriteInstance{},scared_photo:class extends self.ISpriteInstance{},seat_back:class extends self.ISpriteInstance{},seat_back2:class extends self.ISpriteInstance{},select:class extends self.ISpriteInstance{},settingsIcon:class extends self.ISpriteInstance{},sink:class extends self.ISpriteInstance{},sofa2:class extends self.ISpriteInstance{},sofa3:class extends self.ISpriteInstance{},sofa_layer:class extends self.ISpriteInstance{},soundIcon:class extends self.ISpriteInstance{},Sprite10:class extends self.ISpriteInstance{},Sprite11:class extends self.ISpriteInstance{},lvl156_path:class extends self.ISpriteInstance{},Sprite14:class extends self.ISpriteInstance{},Sprite15:class extends self.ISpriteInstance{},Sprite16:class extends self.ISpriteInstance{},Sprite17:class extends self.ISpriteInstance{},Sprite2:class extends self.ISpriteInstance{},Sprite4:class extends self.ISpriteInstance{},startButton:class extends self.ISpriteInstance{},startText:class extends self.ITextInstance{},table3:class extends self.ISpriteInstance{},table_slice:class extends self.IWorldInstance{},tennisnet:class extends self.ISpriteInstance{},Tiki_Left_Holder:class extends self.ISpriteInstance{},tiki_mic_nb:class extends self.ISpriteInstance{},Tiki_Right_Holder:class extends self.ISpriteInstance{},tire2:class extends self.ISpriteInstance{},treadmill_arm:class extends self.ISpriteInstance{},treadmill_arm2:class extends self.ISpriteInstance{},tree:class extends self.ISpriteInstance{},tshirt:class extends self.ISpriteInstance{},tshirt1_piece:class extends self.ISpriteInstance{},tshirt2:class extends self.ISpriteInstance{},tshirt2_piece:class extends self.ISpriteInstance{},tshirt3:class extends self.ISpriteInstance{},tshirt3_piece:class extends self.ISpriteInstance{},tshirt_rack:class extends self.ISpriteInstance{},_114_toy:class extends self.ISpriteInstance{},_114_socks:class extends self.ISpriteInstance{},lvl205_popcorn:class extends self.ISpriteInstance{},lvl205_coke:class extends self.ISpriteInstance{},lvl205_plate:class extends self.ISpriteInstance{},lvl162_trumphet:class extends self.ISpriteInstance{},nb_GrannyAmy_Front_Arm3:class extends self.ISpriteInstance{},nb_GrannyAmy_Front_Arm4:class extends self.ISpriteInstance{},jenny_front_arm3:class extends self.ISpriteInstance{},jenny_front_leg3:class extends self.ISpriteInstance{},jenny_back_leg3:class extends self.ISpriteInstance{},lvl123_DrWorry_Glasses:class extends self.ISpriteInstance{},lvl127_big_rock:class extends self.ISpriteInstance{},lvl128_jenny_body:class extends self.ISpriteInstance{},lvl128_jenny_head2:class extends self.ISpriteInstance{},lvl128_jenny_front_leg4:class extends self.ISpriteInstance{},lvl128_jenny_back_leg4:class extends self.ISpriteInstance{},lvl128_jenny_back_leg:class extends self.ISpriteInstance{},lvl128_jenny_front_leg:class extends self.ISpriteInstance{},lvl128_jenny_front_arm4:class extends self.ISpriteInstance{},lvl128_jenny_front_arm:class extends self.ISpriteInstance{},lvl128_jenny_back_arm3:class extends self.ISpriteInstance{},lvl128_jenny_back_arm4:class extends self.ISpriteInstance{},lvl128_jenny_eyes_inside:class extends self.ISpriteInstance{},lvl128_jenny_brows_normal:class extends self.ISpriteInstance{},lvl128_jenny_eyes:class extends self.ISpriteInstance{},lvl128_jenny_mouth:class extends self.ISpriteInstance{},lvl128_m_blueweight:class extends self.ISpriteInstance{},lvl139_knife:class extends self.ISpriteInstance{},lvl204_cable:class extends self.ISpriteInstance{},lvl204_cable_electric:class extends self.ISpriteInstance{},lvl204_cable_piece:class extends self.ISpriteInstance{},lvl204_cable_piece2:class extends self.ISpriteInstance{},lvl204_car_blue:class extends self.ISpriteInstance{},lvl204_car_red:class extends self.ISpriteInstance{},lvl204_doner:class extends self.ISpriteInstance{},lvl204_donerstand_bottom:class extends self.ISpriteInstance{},lvl204_donerstand_top:class extends self.ISpriteInstance{},lvl204_door_gymopen:class extends self.ISpriteInstance{},lvl204_ElectricBox:class extends self.ISpriteInstance{},lvl204_gym_glass:class extends self.ISpriteInstance{},lvl204_gymclosed_door:class extends self.ISpriteInstance{},lvl204_gymclosed_door1:class extends self.ISpriteInstance{},lvl204_gymclosed_doorinside:class extends self.ISpriteInstance{},lvl204_gymclosed_sign:class extends self.ISpriteInstance{},lvl204_knife:class extends self.ISpriteInstance{},lvl204_man_body:class extends self.ISpriteInstance{},lvl204_man_handpiece:class extends self.ISpriteInstance{},lvl204_man_head:class extends self.ISpriteInstance{},lvl204_sideWalk:class extends self.IWorldInstance{},lvl204_silhouttesHD:class extends self.ISpriteInstance{},lvl207_cheese:class extends self.ISpriteInstance{},lvl207_cheesedrop:class extends self.ISpriteInstance{},lvl207_gymmy_arm2:class extends self.ISpriteInstance{},lvl207_gymmy_arm4:class extends self.ISpriteInstance{},lvl207_gymmy_body:class extends self.ISpriteInstance{},lvl207_gymmy_eyesFrame:class extends self.ISpriteInstance{},lvl207_gymmy_eyesInside:class extends self.ISpriteInstance{},lvl207_gymmy_eyeslip:class extends self.ISpriteInstance{},lvl207_gymmy_head:class extends self.ISpriteInstance{},lvl207_gymmy_leftarm:class extends self.ISpriteInstance{},lvl207_gymmy_leftarm1:class extends self.ISpriteInstance{},lvl207_gymmy_leftleg:class extends self.ISpriteInstance{},lvl207_gymmy_leftleg1:class extends self.ISpriteInstance{},lvl207_gymmy_rightarm:class extends self.ISpriteInstance{},lvl207_gymmy_rightleg:class extends self.ISpriteInstance{},lvl207_gymmy_shoes:class extends self.ISpriteInstance{},lvl207_gymmy_shoes1:class extends self.ISpriteInstance{},lvl207_gymmyGlass:class extends self.ISpriteInstance{},lvl207_gymmyMouth:class extends self.ISpriteInstance{},lvl207_juddy_lips:class extends self.ISpriteInstance{},lvl207_juddy_lipss:class extends self.ISpriteInstance{},lvl207_juddybody:class extends self.ISpriteInstance{},lvl207_juddyeyes:class extends self.ISpriteInstance{},lvl207_juddyeyes2:class extends self.ISpriteInstance{},lvl207_juddyeyesframe:class extends self.ISpriteInstance{},lvl207_juddyface:class extends self.ISpriteInstance{},lvl207_juddyhair:class extends self.ISpriteInstance{},lvl207_juddyleftarm:class extends self.ISpriteInstance{},lvl207_juddyleftarm1:class extends self.ISpriteInstance{},lvl207_juddyleftleg:class extends self.ISpriteInstance{},lvl207_juddyleftshoes:class extends self.ISpriteInstance{},lvl207_juddypart1:class extends self.ISpriteInstance{},lvl207_juddypart2:class extends self.ISpriteInstance{},lvl207_juddyrightarm:class extends self.ISpriteInstance{},lvl207_juddyrightarm1:class extends self.ISpriteInstance{},lvl207_juddyrightleg:class extends self.ISpriteInstance{},lvl207_juddyrightshoes:class extends self.ISpriteInstance{},lvl207_juddyskirt:class extends self.ISpriteInstance{},lvl207_leg:class extends self.ISpriteInstance{},lvl207_legcrumbles:class extends self.ISpriteInstance{},lvl207_mouserunning:class extends self.ISpriteInstance{},lvl207_sofa:class extends self.ISpriteInstance{},lvl208_clothespile:class extends self.ISpriteInstance{},lvl208_mirror:class extends self.ISpriteInstance{},lvl208_mirror_shine:class extends self.ISpriteInstance{},lvl208_sock:class extends self.ISpriteInstance{},lvl208_sofa4:class extends self.ISpriteInstance{},lvl208_wardrobe:class extends self.ISpriteInstance{},lvl208_wardrobe_doorpiece:class extends self.ISpriteInstance{},lvl208_wardrobe_open:class extends self.ISpriteInstance{},lvl207_gymmy_body2:class extends self.ISpriteInstance{},lvl207_gymmy_head2:class extends self.ISpriteInstance{},lvl207_gymmy_leftleg2:class extends self.ISpriteInstance{},lvl207_gymmy_rightleg2:class extends self.ISpriteInstance{},lvl207_gymmy_shoes2:class extends self.ISpriteInstance{},lvl207_gymmy_shoes3:class extends self.ISpriteInstance{},lvl207_gymmy_leftleg3:class extends self.ISpriteInstance{},lvl207_gymmy_leftleg4:class extends self.ISpriteInstance{},lvl207_gymmyMouth2:class extends self.ISpriteInstance{},lvl207_gymmyGlass2:class extends self.ISpriteInstance{},lvl207_gymmy_rightarm2:class extends self.ISpriteInstance{},lvl207_gymmy_arm3:class extends self.ISpriteInstance{},lvl207_gymmy_leftarm2:class extends self.ISpriteInstance{},lvl207_gymmy_arm5:class extends self.ISpriteInstance{},m_DrWorry_Body2:class extends self.ISpriteInstance{},m_DrWorry_Head3:class extends self.ISpriteInstance{},m_DrWorry_Glasses2:class extends self.ISpriteInstance{},m_DrWorry_Back_Leg2:class extends self.ISpriteInstance{},m_DrWorry_Front_Leg2:class extends self.ISpriteInstance{},m_DrWorry_Brows_Angry2:class extends self.ISpriteInstance{},lvl_201_siderobot_arm_left2:class extends self.ISpriteInstance{},lvl_65_siderobot_arm_right2:class extends self.ISpriteInstance{},_9patch5:class extends self.IWorldInstance{},_9patch6:class extends self.IWorldInstance{},bowlempty_linesbottom:class extends self.ISpriteInstance{},bowlempty_linestop:class extends self.ISpriteInstance{},cateyes_scared:class extends self.ISpriteInstance{},catmouth_scared:class extends self.ISpriteInstance{},chick:class extends self.ISpriteInstance{},Daily_40_arm:class extends self.ISpriteInstance{},Daily_40_arm2:class extends self.ISpriteInstance{},Daily_40_body:class extends self.ISpriteInstance{},Daily_40_eye:class extends self.ISpriteInstance{},Daily_40_eyebrow:class extends self.ISpriteInstance{},Daily_40_head:class extends self.ISpriteInstance{},Daily_40_leg:class extends self.ISpriteInstance{},Daily_40_leg2:class extends self.ISpriteInstance{},dog1_bark:class extends self.ISpriteInstance{},Gimmy_Parcali6:class extends self.ISpriteInstance{},gm:class extends self.ISpriteInstance{},GrannyAmy_Parcali4:class extends self.ISpriteInstance{},greenbutton:class extends self.ISpriteInstance{},gymmy_:class extends self.ISpriteInstance{},jacket_Arm:class extends self.ISpriteInstance{},katman:class extends self.ISpriteInstance{},katman2:class extends self.ISpriteInstance{},leveltext3:class extends self.ITextInstance{},leveltext4:class extends self.ITextInstance{},leveltext5:class extends self.ITextInstance{},lilly_arm_with_finger:class extends self.ISpriteInstance{},Lily_Front_Arm16:class extends self.ISpriteInstance{},lvl141_LazyLarry_back_arm:class extends self.ISpriteInstance{},lvl141_LazyLarry_backleg:class extends self.ISpriteInstance{},lvl141_LazyLarry_brows_normal:class extends self.ISpriteInstance{},lvl141_LazyLarry_eyelid_right:class extends self.ISpriteInstance{},lvl141_LazyLarry_eyes_right:class extends self.ISpriteInstance{},lvl141_LazyLarry_frontarm:class extends self.ISpriteInstance{},lvl141_LazyLarry_frontarm2:class extends self.ISpriteInstance{},lvl141_Lily_Back_Arm_5:class extends self.ISpriteInstance{},lvl141_m_LazyLarry_mouth_normal:class extends self.ISpriteInstance{},lvl141_nb_book_:class extends self.ISpriteInstance{},lvl141_nb_book_2:class extends self.ISpriteInstance{},lvl141_nb_LazyLarry_Back_Foot:class extends self.ISpriteInstance{},lvl141_nb_LazyLarry_Body:class extends self.ISpriteInstance{},lvl141_nb_LazyLarry_Eyes:class extends self.ISpriteInstance{},lvl141_nb_LazyLarry_Head_Hairy_Mirrored:class extends self.ISpriteInstance{},lvl141_nb_Lily_Back_Leg_:class extends self.ISpriteInstance{},lvl141_nb_Lily_Body4:class extends self.ISpriteInstance{},lvl141_nb_Lily_Front_Leg_:class extends self.ISpriteInstance{},lvl141_nb_Lily_Skirt:class extends self.ISpriteInstance{},lvl141_nb_line2:class extends self.ISpriteInstance{},lvl141_nb_plant2:class extends self.ISpriteInstance{},lvl141_nb_shelf2:class extends self.ISpriteInstance{},lvl141_nb_table3:class extends self.ISpriteInstance{},lvl141_nb_tablecloth:class extends self.ISpriteInstance{},lvl141_nb_tv:class extends self.ISpriteInstance{},lvl142_jenny_back_arm:class extends self.ISpriteInstance{},lvl142_jenny_back_arm2:class extends self.ISpriteInstance{},lvl142_jenny_back_leg:class extends self.ISpriteInstance{},lvl142_jenny_back_leg2:class extends self.ISpriteInstance{},lvl142_jenny_body:class extends self.ISpriteInstance{},lvl142_jenny_brows_normal:class extends self.ISpriteInstance{},lvl142_jenny_eye_lids2:class extends self.ISpriteInstance{},lvl142_jenny_eyes:class extends self.ISpriteInstance{},lvl142_jenny_eyes_inside:class extends self.ISpriteInstance{},lvl142_jenny_front_arm:class extends self.ISpriteInstance{},lvl142_jenny_front_arm2:class extends self.ISpriteInstance{},lvl142_jenny_front_leg:class extends self.ISpriteInstance{},lvl142_jenny_front_leg2:class extends self.ISpriteInstance{},lvl142_jenny_head:class extends self.ISpriteInstance{},lvl142_jenny_mouth:class extends self.ISpriteInstance{},lvl144_Lily_Front_Arm12:class extends self.ISpriteInstance{},lvl144_Lily_Front_Arm6:class extends self.ISpriteInstance{},lvl144_Lily_whole_face:class extends self.ISpriteInstance{},lvl169_obj:class extends self.ISpriteInstance{},lvl169_obj1:class extends self.ISpriteInstance{},lvl169_obj2:class extends self.ISpriteInstance{},lvl169_obj3:class extends self.ISpriteInstance{},lvl179_car_rope:class extends self.ISpriteInstance{},lvl179_Lily_mouth_soangry:class extends self.ISpriteInstance{},lvl179_m_bush3:class extends self.ISpriteInstance{},lvl179_m_DrWorry_Arm_Front_2:class extends self.ISpriteInstance{},lvl179_mat_backarm2:class extends self.ISpriteInstance{},lvl179_mat_backarm2_white:class extends self.ISpriteInstance{},lvl179_mat_backfoot:class extends self.ISpriteInstance{},lvl179_mat_backleg:class extends self.ISpriteInstance{},lvl179_mat_body:class extends self.ISpriteInstance{},lvl179_mat_brows_eaing:class extends self.ISpriteInstance{},lvl179_mat_eyes:class extends self.ISpriteInstance{},lvl179_mat_front_foot:class extends self.ISpriteInstance{},lvl179_mat_frontarm:class extends self.ISpriteInstance{},lvl179_mat_frontarm2_white:class extends self.ISpriteInstance{},lvl179_mat_frontleg:class extends self.ISpriteInstance{},lvl179_mat_head:class extends self.ISpriteInstance{},lvl179_mat_hip:class extends self.ISpriteInstance{},lvl179_mat_mouth:class extends self.ISpriteInstance{},lvl179_mat_pocket:class extends self.ISpriteInstance{},lvl179_obj:class extends self.ISpriteInstance{},lvl179_pricesign:class extends self.ISpriteInstance{},lvl179_pricesign_leg:class extends self.ISpriteInstance{},lvl179_sign_hotdog:class extends self.ISpriteInstance{},lvl179_stand:class extends self.ISpriteInstance{},lvl179_x_m_DrWorry_Arm_Back_2:class extends self.ISpriteInstance{},lvl181_chair:class extends self.ISpriteInstance{},lvl181_fishbone:class extends self.ISpriteInstance{},lvl181_Lily_Front_Arm13:class extends self.ISpriteInstance{},lvl181_Lily_Front_Arm14:class extends self.ISpriteInstance{},lvl181_m_Bobba_sleep_mouth:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Arm_Back4:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Arm_Front:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Body_Fat_Right:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Eating_Head:class extends self.ISpriteInstance{},lvl181_nb_Bobba_EatingBrows:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Eyes_Normal:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Eyes_Small:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Hip:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Leg_Back:class extends self.ISpriteInstance{},lvl181_nb_Bobba_Leg_Front:class extends self.ISpriteInstance{},lvl181_nb_lily_green_face:class extends self.ISpriteInstance{},lvl181_nb_lily_hair_piece:class extends self.ISpriteInstance{},lvl181_nb_Lily_Happy2:class extends self.ISpriteInstance{},lvl181_nb_lily_mouth_eat:class extends self.ISpriteInstance{},lvl181_nb_remote:class extends self.ISpriteInstance{},lvl181_vnb_table4:class extends self.ISpriteInstance{},lvl187_bush2:class extends self.ISpriteInstance{},lvl187_explosion:class extends self.ISpriteInstance{},lvl187_jenny_body2:class extends self.ISpriteInstance{},lvl187_line:class extends self.ISpriteInstance{},lvl187_m_coffe_Steam:class extends self.ISpriteInstance{},lvl187_main_back_house:class extends self.ISpriteInstance{},lvl187_main_back_house4:class extends self.ISpriteInstance{},lvl187_main_clouds:class extends self.ISpriteInstance{},lvl187_main_tree:class extends self.ISpriteInstance{},lvl187_nb_172_bottle:class extends self.ISpriteInstance{},lvl187_nb_lvl_1_sun:class extends self.ISpriteInstance{},lvl187_nb_lvl_50_water:class extends self.ISpriteInstance{},lvl18_Lily_Back_Arm_3:class extends self.ISpriteInstance{},lvl18_Lily_Body5:class extends self.ISpriteInstance{},lvl18_Lily_Eyes:class extends self.ISpriteInstance{},lvl18_Lily_Eyes_Inside:class extends self.ISpriteInstance{},lvl18_Lily_Front_Arm9:class extends self.ISpriteInstance{},lvl18_Lily_Hair_Piece_:class extends self.ISpriteInstance{},lvl18_Lily_Hair_Piece_2:class extends self.ISpriteInstance{},lvl18_Lily_Happy4:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_back_arm:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_back_arm2:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_backleg:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_body:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_brows_tricky:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_eyes:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_eyes_inside:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_front_arm:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_front_arm2:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_front_leg:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_head:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_mouth_tricky:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_Parcaliai:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_pocket:class extends self.ISpriteInstance{},lvl18_nb_LittleTiki_skirt:class extends self.ISpriteInstance{},lvl18_nb_lvl_70_flower_big:class extends self.ISpriteInstance{},lvl18_sink2:class extends self.ISpriteInstance{},lvl18_soap:class extends self.ISpriteInstance{},lvl18_Sprite20:class extends self.ISpriteInstance{},lvl200_lvl_28_shelf:class extends self.ISpriteInstance{},lvl201_barfiks_legs:class extends self.ISpriteInstance{},lvl201_barfiks_legs2:class extends self.ISpriteInstance{},lvl201_bowlingball:class extends self.ISpriteInstance{},lvl201_crash_sign:class extends self.ISpriteInstance{},lvl201_lid:class extends self.IWorldInstance{},lvl201_lidpiece:class extends self.ISpriteInstance{},lvl201_support:class extends self.IWorldInstance{},lvl201_worryMouth:class extends self.ISpriteInstance{},lvl202_hotdog:class extends self.ISpriteInstance{},lvl202_rope:class extends self.ISpriteInstance{},lvl202_rope_hanger:class extends self.ISpriteInstance{},lvl202_rope_souce:class extends self.ISpriteInstance{},lvl202_toppiece:class extends self.IWorldInstance{},lvl203:class extends self.ITextInstance{},lvl203_capsule_body:class extends self.ISpriteInstance{},lvl203_capsule_wing:class extends self.ISpriteInstance{},lvl203_capsule_wing2:class extends self.ISpriteInstance{},lvl203_satellite:class extends self.ISpriteInstance{},lvl210_box:class extends self.ISpriteInstance{},lvl210_button:class extends self.ISpriteInstance{},lvl210_cable_side:class extends self.ISpriteInstance{},lvl210_cable_side2:class extends self.ISpriteInstance{},lvl210_cable_straight:class extends self.ISpriteInstance{},lvl210_lamp_broken:class extends self.ISpriteInstance{},lvl210_lamp_off:class extends self.ISpriteInstance{},lvl210_paint_brush:class extends self.ISpriteInstance{},lvl210_paint_bucket:class extends self.ISpriteInstance{},lvl210_paint_stain:class extends self.ISpriteInstance{},lvl211_control:class extends self.ISpriteInstance{},lvl211_floorline:class extends self.ISpriteInstance{},lvl211_girl_head_happy:class extends self.ISpriteInstance{},lvl211_girl_head_sad:class extends self.ISpriteInstance{},lvl211_hair_in_Soup:class extends self.ISpriteInstance{},lvl211_hair_part:class extends self.ISpriteInstance{},lvl211_man_green_head:class extends self.ISpriteInstance{},lvl211_man_head_happy:class extends self.ISpriteInstance{},lvl211_Sprite:class extends self.ISpriteInstance{},lvl211_Sprite11:class extends self.ISpriteInstance{},lvl211_Sprite3:class extends self.ISpriteInstance{},lvl211_Sprite5:class extends self.ISpriteInstance{},lvl211_Sprite7:class extends self.ISpriteInstance{},lvl211_Sprite9:class extends self.ISpriteInstance{},lvl212_bags:class extends self.ISpriteInstance{},lvl212_hat2:class extends self.ISpriteInstance{},lvl212_hat3:class extends self.ISpriteInstance{},lvl212_hat4:class extends self.ISpriteInstance{},lvl212_jacket:class extends self.ISpriteInstance{},lvl212_machine_box:class extends self.ISpriteInstance{},lvl212_machine_handle:class extends self.ISpriteInstance{},lvl212_machine_screen:class extends self.ISpriteInstance{},lvl212_manequin:class extends self.ISpriteInstance{},lvl212_shelves_:class extends self.ISpriteInstance{},lvl212_shirt:class extends self.ISpriteInstance{},lvl212_skirt:class extends self.ISpriteInstance{},lvl212_skirt2:class extends self.ISpriteInstance{},lvl212_skirt3:class extends self.ISpriteInstance{},lvl212_sweat:class extends self.ISpriteInstance{},lvl213_light_small:class extends self.ISpriteInstance{},lvl213_machineBox:class extends self.IWorldInstance{},lvl213_plug:class extends self.ISpriteInstance{},lvl213_sponge_big:class extends self.ISpriteInstance{},lvl213_sponge_small:class extends self.ISpriteInstance{},lvl213_sponge_water:class extends self.ISpriteInstance{},lvl213_waterbubble_small:class extends self.IParticlesInstance{},lvl213_waterLayer:class extends self.IWorldInstance{},lvl38_bottles_:class extends self.ISpriteInstance{},lvl38_DrWorry_Mouth:class extends self.ISpriteInstance{},lvl38_m_DrWorry_Back_Leg:class extends self.ISpriteInstance{},lvl38_m_DrWorry_Brows_Angry:class extends self.ISpriteInstance{},lvl38_m_DrWorry_Eyes_Inside_Normal:class extends self.ISpriteInstance{},lvl38_m_DrWorry_Front_Leg:class extends self.ISpriteInstance{},lvl38_m_DrWorry_Glasses:class extends self.ISpriteInstance{},lvl46_Lily_Angry:class extends self.ISpriteInstance{},lvl46_Lily_Back_Leg_:class extends self.ISpriteInstance{},lvl46_Lily_Back_Leg_2:class extends self.ISpriteInstance{},lvl46_Lily_Body2:class extends self.ISpriteInstance{},lvl46_Lily_Front_Arm2:class extends self.ISpriteInstance{},lvl46_Lily_Front_Arm3:class extends self.ISpriteInstance{},lvl46_Lily_Front_Arm4:class extends self.ISpriteInstance{},lvl46_Lily_Front_Leg_:class extends self.ISpriteInstance{},lvl46_Lily_Front_Leg_2:class extends self.ISpriteInstance{},lvl46_Lily_Hair_Piece_4:class extends self.ISpriteInstance{},lvl46_Lily_Head2:class extends self.ISpriteInstance{},lvl46_Lily_Skirt:class extends self.ISpriteInstance{},lvl46_lvl46_plate:class extends self.ISpriteInstance{},lvl46_nb_46_cat1_sad:class extends self.ISpriteInstance{},lvl46_nb_lvl_47_wallline:class extends self.ISpriteInstance{},lvl_141_control:class extends self.ISpriteInstance{},lvl_184_glass_empty:class extends self.ISpriteInstance{},lvl_200_ketchupp:class extends self.ISpriteInstance{},lvl_200_Lily_Front_Arm8:class extends self.ISpriteInstance{},lvl_200_Lily_mouth_unhappy:class extends self.ISpriteInstance{},lvl_200_lvl_57_kitchencounter:class extends self.ISpriteInstance{},lvl_200_lvl_57_pepper:class extends self.ISpriteInstance{},lvl_200_lvl_57_salt:class extends self.ISpriteInstance{},lvl_200_lvl_57_suce_white:class extends self.ISpriteInstance{},lvl_200_lvl_66_weights2:class extends self.ISpriteInstance{},lvl_200_lvl_78_full_jar:class extends self.ISpriteInstance{},lvl_200_nb_coke:class extends self.ISpriteInstance{},lvl_200_nb_GrannyAmy_Back_Arm2:class extends self.ISpriteInstance{},lvl_200_nb_GrannyAmy_Back_Leg:class extends self.ISpriteInstance{},lvl_200_nb_GrannyAmy_Body2:class extends self.ISpriteInstance{},lvl_200_nb_GrannyAmy_Eyes_Inside2:class extends self.ISpriteInstance{},lvl_200_nb_GrannyAmy_Front_Arm:class extends self.ISpriteInstance{},lvl_200_nb_GrannyAmy_Front_Arm2:class extends self.ISpriteInstance{},lvl_200_nb_GrannyAmy_Front_Arm3:class extends self.ISpriteInstance{},lvl_200_nb_GrannyAmy_Front_Leg:class extends self.ISpriteInstance{},lvl_200_nb_Lily_Back_Leg_2:class extends self.ISpriteInstance{},lvl_200_nb_Lily_bare_foot:class extends self.ISpriteInstance{},lvl_200_nb_Lily_Front_Arm:class extends self.ISpriteInstance{},lvl_200_nb_Lily_Front_Arm2:class extends self.ISpriteInstance{},lvl_200_nb_Lily_Hair_Piece_:class extends self.ISpriteInstance{},lvl_200_nb_Lily_Hair_Piece_2:class extends self.ISpriteInstance{},lvl_200_nb_Lily_Head2:class extends self.ISpriteInstance{},lvl_200_nb_Lily_Normal:class extends self.ISpriteInstance{},lvl_66_weights2:class extends self.ISpriteInstance{},lvl_78_full_jar2:class extends self.ISpriteInstance{},machine_sign:class extends self.ISpriteInstance{},mn_lvl_189_floor:class extends self.IWorldInstance{},nb_142_jennyhand_paper:class extends self.ISpriteInstance{},nb_142_jennyhand_paper2:class extends self.ISpriteInstance{},nb_142_jennyhand_scissor:class extends self.ISpriteInstance{},nb_142_lilyhand_paper:class extends self.ISpriteInstance{},nb_142_lilyhand_paper2:class extends self.ISpriteInstance{},nb_142_lilyhand_scissors:class extends self.ISpriteInstance{},nb_142_opt_bg:class extends self.ISpriteInstance{},nb_142_paper_bubble:class extends self.ISpriteInstance{},nb_142_paper_floor:class extends self.ISpriteInstance{},nb_142_paper_opt:class extends self.ISpriteInstance{},nb_142_questionmark:class extends self.ISpriteInstance{},nb_142_rock:class extends self.ISpriteInstance{},nb_142_rock2:class extends self.ISpriteInstance{},nb_142_scissor:class extends self.ISpriteInstance{},nb_142_scissor2:class extends self.ISpriteInstance{},nb_142_scissor_bubble:class extends self.ISpriteInstance{},nb_142_thiinkbaloon:class extends self.ISpriteInstance{},nb_142_Turn_BG:class extends self.ISpriteInstance{},nb_166_bigdumbble:class extends self.ISpriteInstance{},nb_166_bigdumbble2:class extends self.ISpriteInstance{},nb_166_Gimmy:class extends self.ISpriteInstance{},nb_166_Gimmy_arm:class extends self.ISpriteInstance{},nb_166_Gimmy_arm2:class extends self.ISpriteInstance{},nb_167_barfiks_legs:class extends self.ISpriteInstance{},nb_167_barfiks_longbar:class extends self.ISpriteInstance{},nb_167_barfiks_screw:class extends self.ISpriteInstance{},nb_167_barfiks_screw2:class extends self.ISpriteInstance{},nb_167_barfiks_shortbar:class extends self.ISpriteInstance{},nb_167_fingers_holding:class extends self.ISpriteInstance{},nb_167_Gimmy_arm1:class extends self.ISpriteInstance{},nb_167_Gimmy_arm2:class extends self.ISpriteInstance{},nb_167_Gimmy_arm3:class extends self.ISpriteInstance{},nb_167_Gimmy_arm4:class extends self.ISpriteInstance{},NB_167_Gimmy_barfix:class extends self.ISpriteInstance{},nb_167_glasses:class extends self.ISpriteInstance{},nb_172_banana:class extends self.ISpriteInstance{},nb_172_bottle:class extends self.ISpriteInstance{},nb_172_gym_angry_face:class extends self.ISpriteInstance{},nb_172_gym_arm:class extends self.ISpriteInstance{},nb_172_gym_body:class extends self.ISpriteInstance{},nb_172_katman:class extends self.ISpriteInstance{},nb_172_line:class extends self.ISpriteInstance{},nb_172_pinDrag:class extends self.ISpriteInstance{},nb_172_rockhead_arm_:class extends self.ISpriteInstance{},nb_172_rockhead_body:class extends self.ISpriteInstance{},nb_172_rockhead_dumbell:class extends self.ISpriteInstance{},nb_172_rockhead_face_:class extends self.ISpriteInstance{},nb_18_closet:class extends self.ISpriteInstance{},nb_18_closet_piece:class extends self.ISpriteInstance{},nb_18_lavabo:class extends self.IWorldInstance{},nb_18_lil_:class extends self.ISpriteInstance{},nb_18_Lily_Head5:class extends self.ISpriteInstance{},nb_18_lilyhead:class extends self.ISpriteInstance{},nb_18_mask_red:class extends self.ISpriteInstance{},nb_18_paperroll:class extends self.ISpriteInstance{},nb_18_toilet_cover:class extends self.ISpriteInstance{},NB_18_toilet_inside:class extends self.ISpriteInstance{},nb_18_wallline:class extends self.ISpriteInstance{},nb_18_window:class extends self.ISpriteInstance{},nb_199_car_blue:class extends self.ISpriteInstance{},nb_199_car_red:class extends self.ISpriteInstance{},nb_199_truck_blue:class extends self.ISpriteInstance{},nb_199_truck_Red:class extends self.ISpriteInstance{},nb_38_blue:class extends self.ISpriteInstance{},nb_38_bluebottle:class extends self.ISpriteInstance{},nb_38_colors:class extends self.ISpriteInstance{},nb_38_colors2:class extends self.ISpriteInstance{},nb_38_emptybottle:class extends self.ISpriteInstance{},nb_38_greenbottle:class extends self.ISpriteInstance{},nb_38_machine:class extends self.ISpriteInstance{},nb_38_machine_closed:class extends self.ISpriteInstance{},nb_38_machine_open:class extends self.ISpriteInstance{},nb_38_purplebottle:class extends self.ISpriteInstance{},nb_38_redbottle:class extends self.ISpriteInstance{},nb_38yellowbottle:class extends self.ISpriteInstance{},nb_39_circle:class extends self.ISpriteInstance{},nb_39_circle2:class extends self.ISpriteInstance{},nb_39_control:class extends self.ISpriteInstance{},nb_39_equal2:class extends self.ISpriteInstance{},nb_39_seven:class extends self.ISpriteInstance{},nb_39_six:class extends self.ISpriteInstance{},nb_39_square:class extends self.ISpriteInstance{},nb_39_triangle:class extends self.ISpriteInstance{},nb_39_wall:class extends self.IWorldInstance{},nb_39_zero:class extends self.ISpriteInstance{},nb_46_bones:class extends self.ISpriteInstance{},nb_46_bones2:class extends self.ISpriteInstance{},nb_46_bones3:class extends self.ISpriteInstance{},nb_46_box2:class extends self.ISpriteInstance{},nb_46_cat1_sad2:class extends self.ISpriteInstance{},nb_46_chickenbox:class extends self.ISpriteInstance{},nb_46_mouse2:class extends self.ISpriteInstance{},nb_46_shelf:class extends self.ISpriteInstance{},nb_46_smudge_:class extends self.ISpriteInstance{},nb_46_smudge_2:class extends self.ISpriteInstance{},nb_4_brain:class extends self.ISpriteInstance{},nb_4_cheesecake:class extends self.ISpriteInstance{},nb_4_chicken:class extends self.ISpriteInstance{},nb_4_smalltable:class extends self.ISpriteInstance{},nb_4_thinkcircle_:class extends self.ISpriteInstance{},nb_4_thinkcircle_2:class extends self.ISpriteInstance{},nb_5_Cake:class extends self.ISpriteInstance{},nb_5_cheese:class extends self.ISpriteInstance{},nb_5_cheese_grated:class extends self.ISpriteInstance{},nb_5_crackedegg:class extends self.ISpriteInstance{},nb_5_eggbowl:class extends self.ISpriteInstance{},nb_5_flourspoon:class extends self.ISpriteInstance{},nb_5_milk:class extends self.ISpriteInstance{},nb_5_mixer:class extends self.ISpriteInstance{},nb_5_spilledflour:class extends self.ISpriteInstance{},nb_5_table:class extends self.ISpriteInstance{},nb_7_bowl_back:class extends self.ISpriteInstance{},nb_7_bowl_front:class extends self.ISpriteInstance{},nb_7_cabbage:class extends self.ISpriteInstance{},nb_7_carrot:class extends self.ISpriteInstance{},nb_7_cat_arms:class extends self.ISpriteInstance{},nb_7_cat_head:class extends self.ISpriteInstance{},nb_7_cat_head2:class extends self.ISpriteInstance{},nb_7_cat_head3:class extends self.ISpriteInstance{},nb_7_cat_scared:class extends self.ISpriteInstance{},nb_7_cat_sleeping:class extends self.ISpriteInstance{},nb_7_cat_tail2:class extends self.ISpriteInstance{},nb_7_cat_tail3:class extends self.ISpriteInstance{},nb_7_cateyes_sleeping:class extends self.ISpriteInstance{},nb_7_catmouth_normal:class extends self.ISpriteInstance{},nb_7_catsleeping:class extends self.ISpriteInstance{},nb_7_chicken:class extends self.ISpriteInstance{},nb_7_closet:class extends self.ISpriteInstance{},nb_7_cushion:class extends self.ISpriteInstance{},nb_7_tuna:class extends self.ISpriteInstance{},nb_7_water:class extends self.ISpriteInstance{},nb_7_weigh_Text:class extends self.ITextInstance{},nb_7_weigher:class extends self.ISpriteInstance{},nb_8_bed:class extends self.ISpriteInstance{},nb_8_bedside:class extends self.ISpriteInstance{},nb_8_cloud:class extends self.ISpriteInstance{},nb_8_cloud2:class extends self.ISpriteInstance{},nb_8_cloud3:class extends self.ISpriteInstance{},nb_8_flute:class extends self.ISpriteInstance{},nb_8_hipnoz:class extends self.ISpriteInstance{},nb_8_liliy_sad:class extends self.ISpriteInstance{},nb_8_liliyarm:class extends self.ISpriteInstance{},nb_8_liliyarm2:class extends self.ISpriteInstance{},nb_8_liliyhead:class extends self.ISpriteInstance{},nb_8_lily_awake:class extends self.ISpriteInstance{},nb_8_lily_brows:class extends self.ISpriteInstance{},nb_8_moon:class extends self.ISpriteInstance{},nb_8_poster:class extends self.ISpriteInstance{},nb_8_sheep:class extends self.ISpriteInstance{},nb_8_sheep2:class extends self.ISpriteInstance{},nb_8_tea:class extends self.ISpriteInstance{},nb_8_teapot:class extends self.ISpriteInstance{},nb_8_text:class extends self.ITextInstance{},nb_8_window_frame:class extends self.ISpriteInstance{},nb_8_window_inside:class extends self.ISpriteInstance{},nb_Bobba_Arm_Front2:class extends self.ISpriteInstance{},nb_Bobba_Body_Fat_Right2:class extends self.ISpriteInstance{},nb_Bobba_Eyes_Normal2:class extends self.ISpriteInstance{},nb_Bobba_Eyes_Small2:class extends self.ISpriteInstance{},nb_Lily_Normal3:class extends self.ISpriteInstance{},nb_lily_relax:class extends self.ISpriteInstance{},nb_lvl141_dark:class extends self.ISpriteInstance{},nb_lvl142_checkmark:class extends self.ISpriteInstance{},nb_lvl142_checkmark2:class extends self.ISpriteInstance{},nb_lvl142_checkmark3:class extends self.ISpriteInstance{},nb_lvl_141_console_remote:class extends self.ISpriteInstance{},nb_lvl_141_cookie_half:class extends self.ISpriteInstance{},nb_lvl_141_cookie_half2:class extends self.ISpriteInstance{},nb_lvl_141_emptyjar:class extends self.ISpriteInstance{},nb_lvl_141_lamp_off:class extends self.ISpriteInstance{},nb_lvl_141_lamp_on:class extends self.ISpriteInstance{},nb_lvl_141_play_console:class extends self.ISpriteInstance{},nb_lvl_141_rocket:class extends self.ISpriteInstance{},nb_lvl_141_rocket2:class extends self.ISpriteInstance{},nb_lvl_141_rocket_fire:class extends self.ISpriteInstance{},nb_lvl_141_tv_Cable:class extends self.ISpriteInstance{},nb_lvl_144_brush:class extends self.ISpriteInstance{},nb_lvl_144_giraffe:class extends self.ISpriteInstance{},nb_lvl_144_horse:class extends self.ISpriteInstance{},nb_lvl_144_lily_new_arm_left:class extends self.ISpriteInstance{},nb_lvl_144_lily_new_arm_left2:class extends self.ISpriteInstance{},nb_lvl_144_lily_new_arm_left3:class extends self.ISpriteInstance{},nb_lvl_144_lily_new_arm_right:class extends self.ISpriteInstance{},nb_lvl_144_lily_new_body:class extends self.ISpriteInstance{},nb_lvl_144_lily_new_leg:class extends self.ISpriteInstance{},nb_lvl_144_lily_new_skirt:class extends self.ISpriteInstance{},nb_lvl_144_sheep:class extends self.ISpriteInstance{},nb_lvl_144_sheep3:class extends self.ISpriteInstance{},nb_lvl_144_sheep_hair:class extends self.ISpriteInstance{},nb_lvl_145_alien_arm1:class extends self.ISpriteInstance{},nb_lvl_145_alien_arm2:class extends self.ISpriteInstance{},nb_lvl_145_alien_body:class extends self.ISpriteInstance{},nb_lvl_145_alien_body2:class extends self.ISpriteInstance{},nb_lvl_145_alien_eyes:class extends self.ISpriteInstance{},nb_lvl_145_alien_head:class extends self.ISpriteInstance{},nb_lvl_145_alien_mouth:class extends self.ISpriteInstance{},nb_lvl_145_bomb:class extends self.ISpriteInstance{},nb_lvl_145_bomb2:class extends self.ISpriteInstance{},nb_lvl_145_button:class extends self.ISpriteInstance{},nb_lvl_145_control:class extends self.ISpriteInstance{},nb_lvl_145_dark:class extends self.ISpriteInstance{},nb_lvl_145_dog_arm:class extends self.ISpriteInstance{},nb_lvl_145_dog_body:class extends self.ISpriteInstance{},nb_lvl_145_dog_ears:class extends self.ISpriteInstance{},nb_lvl_145_dog_eyes:class extends self.ISpriteInstance{},nb_lvl_145_dog_eyes_inside:class extends self.ISpriteInstance{},nb_lvl_145_dog_head:class extends self.ISpriteInstance{},nb_lvl_145_dog_mouth:class extends self.ISpriteInstance{},nb_lvl_145_hamaknormal_back:class extends self.ISpriteInstance{},nb_lvl_145_hamaknormal_front:class extends self.ISpriteInstance{},nb_lvl_145_hamakstrethed_back:class extends self.ISpriteInstance{},nb_lvl_145_hamakstrethed_front:class extends self.ISpriteInstance{},nb_lvl_145_hill_long:class extends self.ISpriteInstance{},nb_lvl_145_hill_short:class extends self.ISpriteInstance{},nb_lvl_145_Mars_floor:class extends self.ISpriteInstance{},nb_lvl_145_planet:class extends self.ISpriteInstance{},nb_lvl_145_rocket:class extends self.ISpriteInstance{},nb_lvl_145_square:class extends self.ISpriteInstance{},nb_lvl_145_stars:class extends self.ISpriteInstance{},nb_lvl_145_text:class extends self.ITextInstance{},nb_lvl_145_world_whole:class extends self.ISpriteInstance{},nb_lvl_147_cat_walking:class extends self.ISpriteInstance{},nb_lvl_147_cateyes_looking:class extends self.ISpriteInstance{},nb_lvl_148_crack_bg:class extends self.ISpriteInstance{},nb_lvl_148_crack_front:class extends self.ISpriteInstance{},nb_lvl_148_crashed_rocket:class extends self.ISpriteInstance{},nb_lvl_148_dog_arm1:class extends self.ISpriteInstance{},nb_lvl_148_dog_arm2:class extends self.ISpriteInstance{},nb_lvl_148_dog_legs:class extends self.ISpriteInstance{},nb_lvl_148_dog_mouth_happy:class extends self.ISpriteInstance{},nb_lvl_148_firebig:class extends self.ISpriteInstance{},nb_lvl_148_floorhole:class extends self.ISpriteInstance{},nb_lvl_148_holefrontpiece:class extends self.ISpriteInstance{},nb_lvl_148_moon_bg:class extends self.ISpriteInstance{},nb_lvl_148_newrocket:class extends self.ISpriteInstance{},nb_lvl_148_rocketpiece:class extends self.ISpriteInstance{},nb_lvl_148_rocketpiece2:class extends self.ISpriteInstance{},nb_lvl_148_rocketpiece3:class extends self.ISpriteInstance{},nb_lvl_148_rocketpiece4:class extends self.ISpriteInstance{},nb_lvl_148_rocketpiece5:class extends self.ISpriteInstance{},nb_lvl_148_smoke:class extends self.ISpriteInstance{},nb_lvl_148_smoke_small:class extends self.ISpriteInstance{},nb_lvl_148_smoke_small2:class extends self.ISpriteInstance{},nb_lvl_148_smoke_small3:class extends self.ISpriteInstance{},nb_lvl_149_candybar:class extends self.ISpriteInstance{},nb_lvl_149_candybar_shadow:class extends self.ISpriteInstance{},nb_lvl_149_candybar_shadow2:class extends self.ISpriteInstance{},nb_lvl_149_candybar_shadow3:class extends self.ISpriteInstance{},nb_lvl_149_candybar_shadow4:class extends self.ISpriteInstance{},nb_lvl_149_candybar_shadow5:class extends self.ISpriteInstance{},nb_lvl_149_cips:class extends self.ISpriteInstance{},nb_lvl_149_control:class extends self.ISpriteInstance{},nb_lvl_149_dragHolder:class extends self.ISpriteInstance{},nb_lvl_149_grass:class extends self.IWorldInstance{},nb_lvl_149_mask:class extends self.ISpriteInstance{},nb_lvl_149_spider:class extends self.ISpriteInstance{},nb_lvl_168_control:class extends self.ISpriteInstance{},nb_lvl_168_fingerP:class extends self.ISpriteInstance{},nb_lvl_168_formulas_:class extends self.ISpriteInstance{},nb_lvl_168_formulas_2:class extends self.ISpriteInstance{},nb_lvl_168_formulas_3:class extends self.ISpriteInstance{},nb_lvl_168_newhand:class extends self.ISpriteInstance{},nb_lvl_168_whitebox:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm2:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm3:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm4:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm5:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm6:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm7:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm8:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_arm9:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_body:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_foot:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_head:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_leg:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_leg2:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_leg3:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_leg4:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_mouth:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_mouth2:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_shoe:class extends self.ISpriteInstance{},nb_lvl_169_gymmy_shoe2:class extends self.ISpriteInstance{},nb_lvl_170_baby:class extends self.ISpriteInstance{},nb_lvl_170_baby_cryingface:class extends self.ISpriteInstance{},nb_lvl_170_baby_seat:class extends self.ISpriteInstance{},nb_lvl_170_baby_seat_frontpiece:class extends self.ISpriteInstance{},nb_lvl_170_control:class extends self.ISpriteInstance{},nb_lvl_170_mom:class extends self.ISpriteInstance{},nb_lvl_170_mom_happyface:class extends self.ISpriteInstance{},nb_lvl_170_teardrop:class extends self.ISpriteInstance{},nb_lvl_170_teardrop2:class extends self.ISpriteInstance{},nb_lvl_170_tv:class extends self.ISpriteInstance{},nb_lvl_170_tv_cindy_body:class extends self.ISpriteInstance{},nb_lvl_170_tv_cindy_leg:class extends self.ISpriteInstance{},nb_lvl_171_dark:class extends self.ISpriteInstance{},nb_lvl_171_doorclosed:class extends self.ISpriteInstance{},nb_lvl_171_dooropen:class extends self.ISpriteInstance{},nb_lvl_171_dooropen_piece:class extends self.ISpriteInstance{},nb_lvl_171_nb_book:class extends self.ISpriteInstance{},nb_lvl_173_air_lines:class extends self.ISpriteInstance{},nb_lvl_173_bull:class extends self.ISpriteInstance{},nb_lvl_173_bunny:class extends self.ISpriteInstance{},nb_lvl_173_horn:class extends self.ISpriteInstance{},nb_lvl_173_horn_blowing:class extends self.ISpriteInstance{},nb_lvl_173_wool:class extends self.ISpriteInstance{},nb_lvl_173_wool2:class extends self.ISpriteInstance{},nb_lvl_173_wool3:class extends self.ISpriteInstance{},nb_lvl_174_bowl_empty:class extends self.ISpriteInstance{},nb_lvl_174_bowl_empty2:class extends self.ISpriteInstance{},nb_lvl_174_bowl_helmet:class extends self.ISpriteInstance{},nb_lvl_174_brokenhelmet:class extends self.ISpriteInstance{},nb_lvl_174_empty_glass:class extends self.ISpriteInstance{},nb_lvl_174_fish2:class extends self.ISpriteInstance{},nb_lvl_174_tape:class extends self.ISpriteInstance{},nb_lvl_175_badsmell:class extends self.ISpriteInstance{},nb_lvl_175_badsmell2:class extends self.ISpriteInstance{},nb_lvl_175_bananas:class extends self.ISpriteInstance{},nb_lvl_175_bananatree_leaf:class extends self.ISpriteInstance{},nb_lvl_175_bananatree_long:class extends self.ISpriteInstance{},nb_lvl_175_bananatree_short:class extends self.ISpriteInstance{},nb_lvl_175_floor:class extends self.IWorldInstance{},nb_lvl_175_gorilla_arm:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_arm2:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_bpdy:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_eyes:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_eyes2:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_head:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_leg:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_leg2:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_mouth:class extends self.ISpriteInstance{},nb_lvl_175_gorilla_mouth2:class extends self.ISpriteInstance{},nb_lvl_175_text:class extends self.ITextInstance{},NB_LVL_175_whitebird:class extends self.ISpriteInstance{},nb_lvl_176_batteryslot_back:class extends self.ISpriteInstance{},nb_lvl_176_batteryslot_front:class extends self.ISpriteInstance{},nb_lvl_176_bigbattery:class extends self.ISpriteInstance{},nb_lvl_176_bigbattery2:class extends self.ISpriteInstance{},nb_lvl_176_bigbattery3:class extends self.ISpriteInstance{},nb_lvl_176_button:class extends self.ISpriteInstance{},nb_lvl_176_button_stand:class extends self.ISpriteInstance{},nb_lvl_176_cablepiece:class extends self.ISpriteInstance{},nb_lvl_176_cablepiece2:class extends self.ISpriteInstance{},nb_lvl_176_crash_big:class extends self.ISpriteInstance{},nb_lvl_176_flame:class extends self.ISpriteInstance{},nb_lvl_176_robot_standbig:class extends self.ISpriteInstance{},nb_lvl_177_burnt_smoke:class extends self.ISpriteInstance{},nb_lvl_177_control:class extends self.ISpriteInstance{},nb_lvl_177_remote:class extends self.ISpriteInstance{},nb_lvl_177_shield_back:class extends self.ISpriteInstance{},nb_lvl_177_shield_front:class extends self.ISpriteInstance{},nb_lvl_177_sidelines_left:class extends self.ISpriteInstance{},nb_lvl_177_sidelines_right:class extends self.ISpriteInstance{},nb_lvl_178_grannyHolder:class extends self.ISpriteInstance{},nb_lvl_178_holder:class extends self.ISpriteInstance{},nb_lvl_178_lilyHolder:class extends self.ISpriteInstance{},nb_lvl_178_onion:class extends self.ISpriteInstance{},nb_lvl_178_onion_piece:class extends self.ISpriteInstance{},nb_lvl_178_onion_piece2:class extends self.ISpriteInstance{},nb_lvl_178_onion_smell:class extends self.ISpriteInstance{},nb_lvl_178_vase_pieice:class extends self.ISpriteInstance{},nb_lvl_178_vase_pieice2:class extends self.ISpriteInstance{},nb_lvl_178_vase_pieice3:class extends self.ISpriteInstance{},nb_lvl_178_vase_pieice4:class extends self.ISpriteInstance{},nb_lvl_178_vase_pieice5:class extends self.ISpriteInstance{},nb_lvl_179_bobbacarHolder:class extends self.ISpriteInstance{},nb_lvl_179_bobbacarHolder2:class extends self.ISpriteInstance{},nb_lvl_179_car:class extends self.ISpriteInstance{},nb_lvl_179_car_door:class extends self.ISpriteInstance{},nb_lvl_179_car_inside:class extends self.ISpriteInstance{},nb_lvl_179_eater_drag:class extends self.ISpriteInstance{},nb_lvl_179_eater_drag2:class extends self.ISpriteInstance{},nb_lvl_181_closeddoor:class extends self.ISpriteInstance{},nb_lvl_181_control:class extends self.ISpriteInstance{},nb_lvl_181_opendoor:class extends self.ISpriteInstance{},nb_lvl_181_opendoor_door:class extends self.ISpriteInstance{},nb_lvl_181_window:class extends self.ISpriteInstance{},nb_lvl_182_bird:class extends self.ISpriteInstance{},nb_lvl_182_bird2:class extends self.ISpriteInstance{},nb_lvl_182_bird3:class extends self.ISpriteInstance{},nb_lvl_182_crashP:class extends self.ISpriteInstance{},nb_lvl_182_helicopter:class extends self.ISpriteInstance{},nb_lvl_182_helicopter_door:class extends self.ISpriteInstance{},nb_lvl_182_helicopter_kuyruk:class extends self.ISpriteInstance{},nb_lvl_183_brows_scared:class extends self.ISpriteInstance{},nb_lvl_183_cat_angryhead:class extends self.ISpriteInstance{},nb_lvl_183_dog1_angry:class extends self.ISpriteInstance{},nb_lvl_183_dogbody_scared:class extends self.ISpriteInstance{},nb_lvl_183_dogbody_sleeping:class extends self.ISpriteInstance{},nb_lvl_183_dogfood:class extends self.ISpriteInstance{},nb_lvl_183_doghead:class extends self.ISpriteInstance{},nb_lvl_183_doghead2:class extends self.ISpriteInstance{},nb_lvl_183_doghouse:class extends self.ISpriteInstance{},nb_lvl_183_eyes_angry:class extends self.ISpriteInstance{},nb_lvl_183_eyes_angry2:class extends self.ISpriteInstance{},nb_lvl_183_mouth_angry:class extends self.ISpriteInstance{},nb_lvl_184_salad:class extends self.ISpriteInstance{},nb_lvl_184_table:class extends self.ISpriteInstance{},nb_lvl_184_water:class extends self.ISpriteInstance{},nb_lvl_184_wordText:class extends self.ITextInstance{},nb_lvl_185_astreoid_big:class extends self.ISpriteInstance{},nb_lvl_185_crashP:class extends self.ISpriteInstance{},nb_lvl_185_UFO:class extends self.ISpriteInstance{},nb_lvl_185_waves_backHD:class extends self.ISpriteInstance{},nb_lvl_185_waves_frontHD:class extends self.ISpriteInstance{},nb_lvl_185_waves_middleHD:class extends self.ISpriteInstance{},nb_lvl_186_astrodog_bodypiece:class extends self.ISpriteInstance{},nb_lvl_186_astrodog_bodypiece2:class extends self.ISpriteInstance{},nb_lvl_186_astrodog_bodypiece3:class extends self.ISpriteInstance{},nb_lvl_186_bomb_flame:class extends self.ISpriteInstance{},nb_lvl_186_burger:class extends self.ISpriteInstance{},nb_lvl_186_cable:class extends self.ISpriteInstance{},nb_lvl_186_fries:class extends self.ISpriteInstance{},nb_lvl_186_ketchapp:class extends self.ISpriteInstance{},nb_lvl_186_mayo:class extends self.ISpriteInstance{},nb_lvl_186_smoke:class extends self.ISpriteInstance{},nb_lvl_186_worry_bodypiece:class extends self.ISpriteInstance{},nb_lvl_186_worry_bodypiece2:class extends self.ISpriteInstance{},nb_lvl_187_jennyHolder:class extends self.ISpriteInstance{},nb_lvl_187_raindrops:class extends self.ISpriteInstance{},nb_lvl_187_road:class extends self.ISpriteInstance{},nb_lvl_188_188_verticalpiece:class extends self.ISpriteInstance{},nb_lvl_188_188_weight:class extends self.ISpriteInstance{},nb_lvl_188_coconut:class extends self.ISpriteInstance{},nb_lvl_188_coconut_broken:class extends self.ISpriteInstance{},nb_lvl_188_coconut_broken2:class extends self.ISpriteInstance{},nb_lvl_188_control:class extends self.ISpriteInstance{},nb_lvl_188_handle:class extends self.ISpriteInstance{},nb_lvl_188_horizontalpiece:class extends self.ISpriteInstance{},nb_lvl_188_pivotpoint:class extends self.ISpriteInstance{},nb_lvl_188_rope:class extends self.ISpriteInstance{},nb_lvl_188_shelf:class extends self.ISpriteInstance{},nb_lvl_189_Elephant:class extends self.ISpriteInstance{},nb_lvl_189_home2:class extends self.ISpriteInstance{},nb_lvl_190_big_box:class extends self.ISpriteInstance{},nb_lvl_190_brokenbutton_:class extends self.ISpriteInstance{},nb_lvl_190_brokenbutton_2:class extends self.ISpriteInstance{},nb_lvl_190_jumplines:class extends self.ISpriteInstance{},nb_lvl_190_text:class extends self.ITextInstance{},nb_lvl_190_woodpiece:class extends self.ISpriteInstance{},nb_lvl_190_woodpiece2:class extends self.ISpriteInstance{},nb_lvl_191_cat:class extends self.ISpriteInstance{},nb_lvl_191_control:class extends self.ISpriteInstance{},nb_lvl_191_drag_places:class extends self.ISpriteInstance{},nb_lvl_191_fish:class extends self.ISpriteInstance{},nb_lvl_191_road:class extends self.ISpriteInstance{},nb_lvl_191_road2:class extends self.ISpriteInstance{},nb_lvl_192_rock_gymmy:class extends self.ISpriteInstance{},nb_lvl_192_rock_rockhead:class extends self.ISpriteInstance{},nb_lvl_193_number:class extends self.ISpriteInstance{},nb_lvl_193_number2:class extends self.ISpriteInstance{},nb_lvl_193_number3:class extends self.ISpriteInstance{},nb_lvl_193_number4:class extends self.ISpriteInstance{},nb_lvl_193_number5:class extends self.ISpriteInstance{},nb_lvl_193_question:class extends self.ISpriteInstance{},nb_lvl_193_squareshape:class extends self.ISpriteInstance{},nb_lvl_193_starshape:class extends self.ISpriteInstance{},nb_lvl_193_triangleshape:class extends self.ISpriteInstance{},nb_lvl_194_column:class extends self.IWorldInstance{},nb_lvl_194_floor_slice:class extends self.IWorldInstance{},nb_lvl_194_hairdryer:class extends self.ISpriteInstance{},nb_lvl_194_ventilator_lid:class extends self.ISpriteInstance{},nb_lvl_194_waterbubble_big:class extends self.ISpriteInstance{},nb_lvl_194_waterbubble_medium:class extends self.ISpriteInstance{},nb_lvl_194_waterbubble_small:class extends self.ISpriteInstance{},nb_lvl_194_window:class extends self.ISpriteInstance{},nb_lvl_195_angryface2:class extends self.ISpriteInstance{},nb_lvl_195_backarm2:class extends self.ISpriteInstance{},nb_lvl_195_bigbattery4:class extends self.ISpriteInstance{},nb_lvl_195_body2:class extends self.ISpriteInstance{},nb_lvl_195_cable:class extends self.ISpriteInstance{},nb_lvl_195_computer:class extends self.ISpriteInstance{},nb_lvl_195_fridge:class extends self.ISpriteInstance{},nb_lvl_195_fridgeopen:class extends self.ISpriteInstance{},nb_lvl_195_frontarm_piece:class extends self.ISpriteInstance{},nb_lvl_195_frontarm_piece2:class extends self.ISpriteInstance{},nb_lvl_195_head:class extends self.ISpriteInstance{},nb_lvl_195_icebag:class extends self.ISpriteInstance{},nb_lvl_195_icecream:class extends self.ISpriteInstance{},nb_lvl_195_keyboard:class extends self.ISpriteInstance{},nb_lvl_195_lighting:class extends self.ISpriteInstance{},nb_lvl_195_lighting2:class extends self.ISpriteInstance{},nb_lvl_195_sidewall:class extends self.ISpriteInstance{},nb_lvl_195_smoke:class extends self.ISpriteInstance{},nb_lvl_195_tableback:class extends self.ISpriteInstance{},nb_lvl_195_tablefront:class extends self.ISpriteInstance{},nb_lvl_196_bobbashadow:class extends self.ISpriteInstance{},nb_lvl_196_chicken:class extends self.ISpriteInstance{},nb_lvl_196_chickenbox_back:class extends self.ISpriteInstance{},nb_lvl_196_chickenbox_front:class extends self.ISpriteInstance{},nb_lvl_196_chickenbox_shadow:class extends self.ISpriteInstance{},nb_lvl_196_grass2:class extends self.IWorldInstance{},nb_lvl_196_jenny_drag:class extends self.ISpriteInstance{},nb_lvl_196_jenny_holder:class extends self.ISpriteInstance{},nb_lvl_196_lil_drag:class extends self.ISpriteInstance{},nb_lvl_196_lily_holder:class extends self.ISpriteInstance{},nb_lvl_196_seesaw_foot:class extends self.ISpriteInstance{},nb_lvl_196_seesaw_screw:class extends self.ISpriteInstance{},nb_lvl_196_seesaw_seat:class extends self.ISpriteInstance{},nb_lvl_196_seesaw_tikihandle:class extends self.ISpriteInstance{},nb_lvl_196_seewsaw_BobbaHandle:class extends self.ISpriteInstance{},nb_lvl_196_tikiShadow:class extends self.ISpriteInstance{},nb_lvl_196_worry_drag:class extends self.ISpriteInstance{},nb_lvl_196_worry_holder:class extends self.ISpriteInstance{},nb_lvl_197_cat_body:class extends self.ISpriteInstance{},nb_lvl_197_cat_happyface:class extends self.ISpriteInstance{},nb_lvl_197_cat_head:class extends self.ISpriteInstance{},nb_lvl_197_cat_tail:class extends self.ISpriteInstance{},nb_lvl_197_control:class extends self.ISpriteInstance{},nb_lvl_197_hole:class extends self.ISpriteInstance{},nb_lvl_197_hole2:class extends self.ISpriteInstance{},nb_lvl_197_lilly_holder:class extends self.ISpriteInstance{},nb_lvl_197_longarm:class extends self.ISpriteInstance{},nb_lvl_197_maskpiece:class extends self.ISpriteInstance{},nb_lvl_197_saw:class extends self.ISpriteInstance{},nb_lvl_198_ball:class extends self.ISpriteInstance{},nb_lvl_198_bear:class extends self.ISpriteInstance{},nb_lvl_198_brokentable:class extends self.ISpriteInstance{},nb_lvl_198_control:class extends self.ISpriteInstance{},nb_lvl_198_lamp:class extends self.ISpriteInstance{},nb_lvl_198_trampoline:class extends self.ISpriteInstance{},nb_lvl_199_explosion:class extends self.ISpriteInstance{},nb_lvl_200_control:class extends self.ISpriteInstance{},nb_lvl_200_gymmy_crying_eyes:class extends self.ISpriteInstance{},nb_lvl_200_gymmy_crying_mouth:class extends self.ISpriteInstance{},nb_lvl_200_gymmyHolder:class extends self.ISpriteInstance{},nb_lvl_4_control:class extends self.ISpriteInstance{},nb_lvl_7_fish2:class extends self.ISpriteInstance{},nb_lvl_7_fish3:class extends self.ISpriteInstance{},nb_lvl_7_fish4:class extends self.ISpriteInstance{},nb_lvl_93_circleshape:class extends self.ISpriteInstance{},nb_lvl_93_crossshape:class extends self.ISpriteInstance{},nb_suce_white2:class extends self.ISpriteInstance{},phoneontable:class extends self.ISpriteInstance{},pin:class extends self.ISpriteInstance{},pof:class extends self.ISpriteInstance{},redbutton2:class extends self.ISpriteInstance{},sheep_angryface:class extends self.ISpriteInstance{},sheep_blowmouth:class extends self.ISpriteInstance{},sheep_nowool:class extends self.ISpriteInstance{},Sprite21:class extends self.ISpriteInstance{},switch:class extends self.ISpriteInstance{},table_back:class extends self.ISpriteInstance{},table_front:class extends self.ISpriteInstance{},treebranch:class extends self.ISpriteInstance{},vLazyLarry_back_arm2:class extends self.ISpriteInstance{},vnb_GrannyAmy_Eyes:class extends self.ISpriteInstance{},vnb_GrannyAmy_Mouth:class extends self.ISpriteInstance{},vnb_sofa3:class extends self.ISpriteInstance{},vnb_table4:class extends self.ISpriteInstance{},watersplash:class extends self.ISpriteInstance{},woolclipper:class extends self.ISpriteInstance{},x_formula:class extends self.ISpriteInstance{},x_lvl_21_table:class extends self.ISpriteInstance{},x_lvl_57_shelf:class extends self.ISpriteInstance{},x_m_DrWorry_Arm_Back_:class extends self.ISpriteInstance{},x_m_DrWorry_Arm_Back_2:class extends self.ISpriteInstance{},x_m_DrWorry_Arm_Front_:class extends self.ISpriteInstance{},x_m_DrWorry_Body:class extends self.ISpriteInstance{},x_m_DrWorry_Head2:class extends self.ISpriteInstance{},x_nb_shampoo3:class extends self.ISpriteInstance{},x_nb_shampoo6:class extends self.ISpriteInstance{},m_coverSprite2:class extends self.ISpriteInstance{},fakeDrag2:class extends self.ISpriteInstance{},lvl_8_cloud4:class extends self.ISpriteInstance{},langBgChosen:class extends self.ISpriteInstance{},langClose:class extends self.ISpriteInstance{},langDown:class extends self.ISpriteInstance{},langText:class extends self.ITextInstance{},langTextBg:class extends self.ITextInstance{},langBg:class extends self.ISpriteInstance{},backBtn:class extends self.ISpriteInstance{},leftBtn:class extends self.ISpriteInstance{},rightBtn:class extends self.ISpriteInstance{},Sprite:class extends self.ISpriteInstance{},SuccessSingleText:class extends self.ITextInstance{},clappingHands:class extends self.ISpriteInstance{},SuccessDoubleTextFirst:class extends self.ITextInstance{},SuccessDoubleTextSecond:class extends self.ITextInstance{},Speechlong_arrow:class extends self.ISpriteInstance{},Speechlong_arrow2:class extends self.ISpriteInstance{},Speechlong_big:class extends self.ISpriteInstance{},Speechlong_big2:class extends self.ISpriteInstance{},SuccessOnlyText:class extends self.ITextInstance{},backGround:class extends self.ISpriteInstance{},buttons_bg:class extends self.ISpriteInstance{},buttons_home:class extends self.ISpriteInstance{},Levels_Dot:class extends self.ISpriteInstance{},LevelStartText:class extends self.ITextInstance{},konfetti1:class extends self.IParticlesInstance{},konfetti2:class extends self.IParticlesInstance{},konfetti3:class extends self.IParticlesInstance{},konfetti4:class extends self.IParticlesInstance{},konfetti5:class extends self.IParticlesInstance{},SuccessNextText:class extends self.ITextInstance{},clap:class extends self.ISpriteInstance{},clap1sign:class extends self.ISpriteInstance{},clap1sign2:class extends self.ISpriteInstance{},clap3:class extends self.ISpriteInstance{},clap4:class extends self.ISpriteInstance{},clap5:class extends self.ISpriteInstance{},clap6:class extends self.ISpriteInstance{},clap8:class extends self.ISpriteInstance{},Levels_Dot2:class extends self.ISpriteInstance{},Levels_Dot3:class extends self.ISpriteInstance{},Levels_Dot4:class extends self.ISpriteInstance{},Levels_Dot5:class extends self.ISpriteInstance{},Levels_Dot6:class extends self.ISpriteInstance{},Levels_Dot7:class extends self.ISpriteInstance{},Levels_Dot8:class extends self.ISpriteInstance{},Levels_Dot9:class extends self.ISpriteInstance{},Bobba_Arm_Back:class extends self.ISpriteInstance{},Bobba_Arm_Front:class extends self.ISpriteInstance{},Bobba_Body_Fat:class extends self.ISpriteInstance{},Bobba_Eating_Head:class extends self.ISpriteInstance{},Bobba_Mouth:class extends self.ISpriteInstance{},Bobba_EatingBrows:class extends self.ISpriteInstance{},Bobba_Eyelids:class extends self.ISpriteInstance{},Bobba_Eyes_Normal:class extends self.ISpriteInstance{},Bobba_Eyes_Small:class extends self.ISpriteInstance{},Bobba_Hip:class extends self.ISpriteInstance{},Bobba_Leg_Back:class extends self.ISpriteInstance{},Bobba_Leg_Front:class extends self.ISpriteInstance{},Bobba_Brows_Angry:class extends self.ISpriteInstance{},Bobba_EyeLids_Angry:class extends self.ISpriteInstance{},Bobba_Mouth_:class extends self.ISpriteInstance{},Bobba_Mouth_Angry:class extends self.ISpriteInstance{},Bobba_Mouth_Normal_Happy:class extends self.ISpriteInstance{},Bobba_Mouth_Normal_Happy2:class extends self.ISpriteInstance{},Bobba_Eyes_Small2:class extends self.ISpriteInstance{},Bobba_Eyes_Normal2:class extends self.ISpriteInstance{},Bobba_Arm_Front2:class extends self.ISpriteInstance{},Bobba_Eating_Head2:class extends self.ISpriteInstance{},Bobba_Eyes_Normal3:class extends self.ISpriteInstance{},Bobba_Eyes_Small3:class extends self.ISpriteInstance{},Bobba_Mouth_Normal:class extends self.ISpriteInstance{},Bobba_Body_Fat4:class extends self.ISpriteInstance{},Bobba_Arm_Front3:class extends self.ISpriteInstance{},Bobba_Arm_Back3:class extends self.ISpriteInstance{},Bobba_EatingBrows4:class extends self.ISpriteInstance{},Bobba_Mouth_2:class extends self.ISpriteInstance{},Bobba_Eyes_Small4:class extends self.ISpriteInstance{},Bobba_Arm_Back4:class extends self.ISpriteInstance{},Bobba_Arm_Front4:class extends self.ISpriteInstance{},Bobba_Brows_Angry2:class extends self.ISpriteInstance{},Boppa_Eating_Arm:class extends self.ISpriteInstance{},Bobba_Mouth_Normal_Happy4:class extends self.ISpriteInstance{},Bobba_EatingBrows5:class extends self.ISpriteInstance{},Bobba_Eating_Head3:class extends self.ISpriteInstance{},Bobba_Leg_Front2:class extends self.ISpriteInstance{},Bobba_Leg_Front3:class extends self.ISpriteInstance{},Bobba_Leg_Back_right:class extends self.ISpriteInstance{},Bobba_Leg_Front_rigth:class extends self.ISpriteInstance{},Bobba_Mouth_Normal2:class extends self.ISpriteInstance{},lvl111_Bobba_Arm_Back:class extends self.ISpriteInstance{},lvl133_obj:class extends self.ISpriteInstance{},lvl133_obj1:class extends self.ISpriteInstance{},nb_lvl_133_holder1:class extends self.ISpriteInstance{},nb_lvl_133_holder2:class extends self.ISpriteInstance{},nb_lvl_133_holder3:class extends self.ISpriteInstance{},lvl_107_control:class extends self.ISpriteInstance{},langButton:class extends self.ISpriteInstance{},hintButtons:class extends self.ISpriteInstance{},Claps:class extends self.ISpriteInstance{},Level3Donuts:class extends self.ISpriteInstance{},cats:class extends self.ISpriteInstance{},dandrufs:class extends self.ISpriteInstance{},m_Draggables:class extends self.ISpriteInstance{},m_notes:class extends self.ISpriteInstance{},lvl92Balls:class extends self.ISpriteInstance{},Clouds:class extends self.ISpriteInstance{},JennyBody:class extends self.ISpriteInstance{},RivalBody:class extends self.ISpriteInstance{},FancyPlates:class extends self.ISpriteInstance{},passwordtexts:class extends self.ISpriteInstance{},candies:class extends self.ISpriteInstance{},FlamePieces:class extends self.ISpriteInstance{},Chickens:class extends self.ISpriteInstance{},IosText:class extends self.ITextInstance{},Level11Text:class extends self.ITextInstance{},SettingIcons:class extends self.ISpriteInstance{},ResizeableText:class extends self.ITextInstance{},_205_cips:class extends self.ISpriteInstance{},lvl180_smokes:class extends self.ISpriteInstance{},lvl108_souce:class extends self.ISpriteInstance{},lvl122_bigRockPieces:class extends self.ISpriteInstance{},lvl126_astroids:class extends self.ISpriteInstance{},lvl127_molls:class extends self.ISpriteInstance{},lvl129_pieces:class extends self.ISpriteInstance{},lvl130_planets:class extends self.ISpriteInstance{},lvl132_smallClouds:class extends self.ISpriteInstance{},lvl135_parts:class extends self.ISpriteInstance{},lvl137_moveTo:class extends self.ISpriteInstance{},lvl137_body:class extends self.ISpriteInstance{},lvl140_wifiFrame:class extends self.ISpriteInstance{},lvl212_Hats:class extends self.ISpriteInstance{},lvl212_skirts:class extends self.ISpriteInstance{},lvl212_shirts:class extends self.ISpriteInstance{},lvl159_buttons:class extends self.ISpriteInstance{},lvl_5_drags:class extends self.ISpriteInstance{},lvl_7_drags:class extends self.ISpriteInstance{},nb_172_dragObjects:class extends self.ISpriteInstance{},nb_38_drags:class extends self.ISpriteInstance{},nb_lvl_148_rocket_pieces:class extends self.ISpriteInstance{},nb_lvl_174_drags:class extends self.ISpriteInstance{},nb_lvl_175_drags:class extends self.ISpriteInstance{},nb_lvl_199_cars:class extends self.ISpriteInstance{},nb_lvl_149_candybar_shadows:class extends self.ISpriteInstance{}},runOnStartup((async e=>{var t=document.createElement("style");t.textContent="canvas {-webkit-tap-highlight-color: transparent; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none;-moz-user-select: none; -ms-user-select: none;user-select: none;}",document.head.appendChild(t);var s=document.createElement("script");s.src="./patch/poki-sdk.js",document.body.appendChild(s),e.addEventListener("beforeprojectstart",(()=>OnBeforeProjectStart(e)))}));var ad1=null;window.showAd1=function(){destroyAd1(),(ad1=document.createElement("div")).style.position="absolute",ad1.setAttribute("id","q7"),ad1.style.left="50%",ad1.style.bottom="2%",ad1.style.paddingBottom="2px",ad1.style.transform="translate(-50%, -50%)",document.body.appendChild(ad1),PokiSDK.displayAd(ad1,"728x90")},window.showAd2=function(){destroyAd1(),(ad1=document.createElement("div")).style.position="absolute",ad1.setAttribute("id","q7"),ad1.style.left="50%",ad1.style.bottom="33%",ad1.style.marginTop="0",ad1.style.paddingBottom="2px",ad1.style.transform="translate(-50%, -50%)",document.body.appendChild(ad1),PokiSDK.displayAd(ad1,"320x50")},window.showAd3=function(){destroyAd1(),(ad1=document.createElement("div")).style.position="absolute",ad1.setAttribute("id","q7"),ad1.style.left="50%",ad1.style.bottom="0",ad1.style.marginTop="-20%",ad1.style.paddingBottom="2px",ad1.style.transform="translate(-50%, -50%)",document.body.appendChild(ad1),PokiSDK.displayAd(ad1,"320x50")},window.setPositionLandscape=function(){ad1&&(ad1.style.bottom="0",ad1.style.marginTop="-20%")},window.setPositionPortrait=function(){ad1&&(ad1.style.bottom="15%",ad1.style.marginTop="0")},window.destroyAd1=function(){ad1&&(PokiSDK.destroyAd(ad1),ad1=null)};var scriptsInEvents={async Faile_Event1_Act3(e,t){PokiSDK.commercialBreak().then((()=>{e.callFunction("gotorestartlevel"),e.callFunction("unpauseGame"),PokiSDK.gameplayStart()}))},async Faile_Event2_Act1(e,t){PokiSDK.gameplayStop()},async Faile_Event3_Act1(e,t){window.showAd3()},async Faile_Event4_Act1(e,t){window.showAd1()},async Faile_Event8_Act1(e,t){window.destroyAd1()},async Homee_Event5_Act1(e,t){PokiSDK.gameLoadingFinished()},async Homee_Event5_Act2(e,t){PokiSDK.init()},async Homee_Event9_Act1(e,t){PokiSDK.gameplayStart()},async Homee_Event9_Act4(e,t){PokiSDK.measure("level","start",e.globalVars.level)},async Homee_Event10_Act2(e,t){PokiSDK.measure("button","click","settings")},async Homee_Event11_Act2(e,t){PokiSDK.measure("button","click","levelselect")},async Homee_Event14_Act3(e,t){PokiSDK.measure("button","click","rewarded")},async Homee_Event14_Act4(e,t){PokiSDK.rewardedBreak().then((t=>{t?e.callFunction("rewardedSuccessful"):e.callFunction("unpauseGame")}))},async Homee_Event17_Act3(e,t){PokiSDK.measure("button","click","coinframe")},async Globale_Event12_Act2(e,t){PokiSDK.measure("level","start",e.globalVars.level)},async Globale_Event18_Act5(e,t){PokiSDK.measure("level","start",e.globalVars.level)},async Globale_Event61_Act1(e,t){PokiSDK.measure("button","click","hint_"+t.id)},async Globale_Event75_Act3(e,t){PokiSDK.measure("button","click","rewarded")},async Globale_Event75_Act4(e,t){PokiSDK.gameplayStop()},async Globale_Event75_Act5(e,t){PokiSDK.rewardedBreak().then((t=>{t?(e.callFunction("rewardedSuccessful"),PokiSDK.gameplayStart()):(e.callFunction("unpauseGame"),PokiSDK.gameplayStart())}))},async Globale_Event77_Act1(e,t){PokiSDK.gameplayStop()},async Globale_Event78_Act1(e,t){PokiSDK.gameplayStart()},async Globale_Event80_Act1(e,t){PokiSDK.gameplayStart()},async Globale_Event82_Act1(e,t){PokiSDK.gameplayStart()},async Globale_Event83_Act3(e,t){},async Globale_Event83_Act4(e,t){},async Globale_Event92_Act4(e,t){PokiSDK.measure("button","click","rewarded")},async Globale_Event93_Act1(e,t){PokiSDK.rewardedBreak().then((t=>{t?(e.callFunction("rewardedSuccessful"),PokiSDK.gameplayStart()):(e.callFunction("unpauseGame"),PokiSDK.gameplayStart())}))},async Globale_Event94_Act1(e,t){PokiSDK.rewardedBreak().then((t=>{t?e.callFunction("rewardedSuccessful"):e.callFunction("unpauseGame")}))},async Globale_Event97_Act1(e,t){PokiSDK.gameplayStart()},async Globale_Event98_Act2(e,t){PokiSDK.measure("button","click","coinframe")},async Globale_Event100_Act1(e,t){PokiSDK.gameplayStop()},async Levelglobale_Event17_Act2(e,t){PokiSDK.measure("button","click","home")},async Levelglobale_Event17_Act3(e,t){PokiSDK.gameplayStop()},async Levelglobale_Event18_Act1(e,t){PokiSDK.gameplayStop()},async Levelglobale_Event18_Act2(e,t){PokiSDK.measure("button","click","levelselect")},async Levelglobale_Event31_Act2(e,t){PokiSDK.gameplayStop()},async Levelglobale_Event32_Act6(e,t){PokiSDK.gameplayStart()},async Levelglobale_Event34_Act4(e,t){PokiSDK.measure("button","click","skip")},async Levelglobale_Event34_Act6(e,t){PokiSDK.gameplayStart()},async Levelglobale_Event36_Act2(e,t){PokiSDK.gameplayStart()},async Levelselecte_Event33_Act1(e,t){PokiSDK.gameplayStart()},async Levelselecte_Event33_Act6(e,t){PokiSDK.measure("level","start",e.globalVars.level)},async Levelselecte_Event34_Act1(e,t){PokiSDK.gameplayStart()},async Levelselecte_Event34_Act5(e,t){PokiSDK.measure("level","start",e.globalVars.level)},async Levelselecte_Event35_Act1(e,t){PokiSDK.gameplayStart()},async Levelselecte_Event35_Act5(e,t){PokiSDK.measure("level","start",e.globalVars.level)},async Levelselecte_Event36_Act1(e,t){PokiSDK.gameplayStart()},async Levelselecte_Event36_Act4(e,t){PokiSDK.measure("level","start",e.globalVars.level)},async Levelselecte_Event40_Act3(e,t){PokiSDK.rewardedBreak().then((t=>{t?e.callFunction("rewardedSuccessful"):e.callFunction("unpauseGame")}))},async Levelselecte_Event42_Act1(e,t){PokiSDK.measure("button","click","coinframe")},async Settingse_Event29_Act2(e,t){PokiSDK.measure("button","click","home")},async Settingse_Event33_Act2(e,t){PokiSDK.measure("button","click","language_"+t.lang)},async Settingse_Event72_Act1(e,t){PokiSDK.measure("button","click","coinframe")},async Successe_Event1_Act12(e,t){PokiSDK.gameplayStop()},async Successe_Event1_Act16(e,t){PokiSDK.measure("level","end",e.globalVars.level)},async Successe_Event3_Act1(e,t){window.showAd2()},async Successe_Event4_Act1(e,t){window.showAd3()},async Successe_Event6_Act1(e,t){window.showAd3()},async Successe_Event7_Act1(e,t){window.showAd1()},async Successe_Event22_Act2(e,t){PokiSDK.measure("level","start",e.globalVars.level)},async Successe_Event25_Act1(e,t){PokiSDK.commercialBreak().then((()=>{e.callFunction("pokiCommercial"),e.callFunction("unpauseGame"),PokiSDK.gameplayStart()}))},async Successe_Event27_Act1(e,t){window.destroyAd1()},async Successe_Event36_Act1(e,t){const s=e.globalVars.level;e.objects.ArrayLevels.getFirstInstance().getAt(s,0,0);e.objects.SuccessDoubleTextFirst.getFirstInstance().text=t.firstText.toLocaleUpperCase("TR")},async Successe_Event37_Act1(e,t){const s=e.globalVars.level;e.objects.ArrayLevels.getFirstInstance().getAt(s,0,0);e.objects.SuccessDoubleTextSecond.getFirstInstance().text=t.secondText.toLocaleUpperCase("TR")},async Successe_Event41_Act1(e,t){e.objects.SuccessSingleText.getFirstInstance().text=t.firstText.toLocaleUpperCase("TR"),console.log("localUpperCase: ",t.firstText.toLocaleUpperCase("TR"))},async Successe_Event44_Act1(e,t){e.objects.SuccessOnlyText.getFirstInstance().text=t.firstText.toLocaleUpperCase("TR")},async Successe_Event47_Act1(e,t){PokiSDK.rewardedBreak().then((t=>{t?(e.callFunction("rewardedSuccessful"),PokiSDK.gameplayStart(),e.callFunction("unpauseGame"),e.callFunction("pokiCommercial")):(e.callFunction("unpauseGame"),PokiSDK.gameplayStart(),e.callFunction("pokiCommercial"))}))}};globalThis.C3.JavaScriptInEvents=scriptsInEvents;
/*!
@fileoverview gl-matrix - High performance matrix and vector operations
@author Brandon Jones
@author Colin MacKenzie IV
@version 3.4.1

Copyright (c) 2015-2021, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
//!RadiusClear
//!PosClear